<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd">
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  
  
  <title>  Ustc-Hackergam2018 |   Xiaoyifeng&#39;s blog </title>

 
  
    <link rel="icon" href="/images/favicon.png">
  


  <link rel="stylesheet" href="/nayo.min.css"> 
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>  
  <body>   
    
      <header class="header">
	
  <nav class="header-inner">        

    <span class="iconfont icon-menu mobile-toggle"></span>   	

    <div class="header-logo">
      <a href="/">
        <img class="header-logo-img" src="/images/logo.png">
      </a>
    </div>

    <div class="header-menu">          
              
          
            <a class="header-menu-link" id="header-menu-home" href="/">
              <i class="iconfont icon-home">  
            </i></a>     
          
              
          
            <a class="header-menu-link" id="header-menu-archives" href="/archives">
              <i class="iconfont icon-archives">  
            </i></a>     
          
              
          
            <a class="header-menu-link" id="header-menu-tags" href="/tags">
              <i class="iconfont icon-tags">  
            </i></a>     
          
              
          
            <a class="header-menu-link" id="header-menu-about" href="/about">
              <i class="iconfont icon-about">  
            </i></a>     
          
              
          
              <a class="header-menu-link" id="header-menu-search">
                <i class="iconfont icon-search">  
              </i></a>
          
                  
    </div>  
    
  </nav>
</header>

   

      <div class="container">       
          
          
            <div class="container-inner">  
          

          <article class="post">
  
	
<div class="post-header">
	<div class="post-header-inner">
		<p class="post-title">	
			ustc-Hackergam2018
		</p>
		<div class="post-info">	
			<span class="post-info-entry">
				10月 16, 2018
			</span>

			
			
				<i class="iconfont icon-words"></i>
				<span class="post-info-entry">7898
				</span>
			
		</div>
	</div>
</div> 
	
 

	  <div class="typo post-content slideDownMin">

		

			
					<p>……</p>
<a id="more"></a>
<h1 id="中科大-Hackergame2018-write-up"><a href="#中科大-Hackergame2018-write-up" class="headerlink" title="中科大-Hackergame2018 write-up"></a>中科大-Hackergame2018 write-up</h1><blockquote>
<pre><code>这个比赛主要面向新生，较为友好，链接：https://hack.lug.ustc.edu.cn/

官方writeup:&lt;https://github.com/ustclug/hackergame2018-writeups&gt;

此场比赛充满了猫咪与flxg（废理兴工），虽然作为一个老腊肉去做小鲜肉的题很不好意思，但该做的还是要做啦。
</code></pre></blockquote>
<h2 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h2><blockquote>
<p>打开<a href="http://202.38.95.46:12002/" target="_blank" rel="noopener">题目链接</a>之后，题面如下图：</p>
</blockquote>
<p>  <img src="https://i.loli.net/2018/10/12/5bc02b2fdc456.png" alt=""></p>
<blockquote>
<pre><code>Key的输入框限制了长度，通过开发者工具修改页面源码，或者抓包发送 hackergame2018获取 flag:

The flag is: flag{Hackergame2018_Have_Fun!}
</code></pre></blockquote>
<p>  <img src="https://i.loli.net/2018/10/12/5bc02bfb8a96d.png" alt="">  </p>
<h2 id="猫咪问答"><a href="#猫咪问答" class="headerlink" title="猫咪问答"></a>猫咪问答</h2><blockquote>
<p>这一题虽然表面上是对中科大新生有优势，但是实际上是个社工题。考验学生的搜索能力，信息收集能力。毕竟信安肯定是要跟这个打交道的啦。简单搜索（百度，必应，谷歌）一下，提交得到flag：</p>
<p>flag{G00G1E-is-always-YOUR-FRIEND} </p>
</blockquote>
<p>  <img src="https://i.loli.net/2018/10/12/5bc02da7e38a4.png" alt=""></p>
<h2 id="游园会的集章卡片"><a href="#游园会的集章卡片" class="headerlink" title="游园会的集章卡片"></a>游园会的集章卡片</h2><blockquote>
<pre><code>这一题实际上考验学生的拼图能力，只不过是花的实时间长短而已，需要注意的就是字母和数字的分辨，可能有的其他题目会需要一个前面的过程来获取到零碎的图片，再到这一步拼图。拼完图可以得到flag：

    flag{H4PPY_1M4GE_PR0CE551NG}
</code></pre></blockquote>
<p>  <img src="https://i.loli.net/2018/10/12/5bc02e508ccdd.png" alt=""></p>
<h2 id="猫咪和键盘"><a href="#猫咪和键盘" class="headerlink" title="猫咪和键盘"></a>猫咪和键盘</h2><blockquote>
<pre><code>题目是一份经过了乱序处理的代码，虽然说是乱序，但还是有一定规律的，比如说可以看出跟列有关系，某列整体移到另一个位置之类的。
</code></pre><p>简单来说，要还原整个项目是不太可能实现的，所以我们需要根据出题人给我们的路，认真抉择，然后行动。比如源码首部的author，name，url等信息，可以谷歌得到项目的一部分源码，再还原一部分关键性的代码，理解逻辑即可。</p>
</blockquote>
<p>  <img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0378f2d30c.png" class="lazyload"></p>
<p>  <img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0317a3d624.png" class="lazyload"></p>
<blockquote>
<pre><code>根据name，author可以在搜到位于github的项目源码，前一部分自定义函数是相同的，主函数不同，我们还原一下ABC，BAC，CAB：

ABC：FfQ47if9Zxw9jXE68VtGA

BAC：JDk6Y6Xc88UrUtpK3iF8p

CAB：7BMs4y2gzdG8Ao2gv6aiJ

根据主函数逻辑可以得到flag是像下面这样拼接的：

printf(&quot;%s%s%s%s %s%s%s%s%s%s%d %s%d%s&quot;，&quot;f&quot;,&quot;l&quot;,&quot;a&quot;,&quot;g&quot;,ABC,&quot;&quot;,BAC,&quot;&quot;,CAB,&quot;}&quot;,&quot;type_printf&quot;,&quot;_&quot;,&quot;}&quot;)

flag{FfQ47if9Zxw9jXE68VtGAJDk6Y6Xc88UrUtpK3iF8p7BMs4y2gzdG8Ao2gv6aiJ125type_printf92}
</code></pre></blockquote>
<h2 id="Word-文档"><a href="#Word-文档" class="headerlink" title="Word 文档"></a>Word 文档</h2><blockquote>
<pre><code>这题的话主要是给新生扩充一个知识点：office套件实际上都属于zip压缩包，将后缀改为zip就能以压缩包的形式打开office文档，然后看见其文件结构。
</code></pre></blockquote>
<p>  <img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc03a0493152.png" class="lazyload"></p>
<h2 id="猫咪银行"><a href="#猫咪银行" class="headerlink" title="猫咪银行"></a>猫咪银行</h2><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc03afaf3184.png" class="lazyload"></p>
<blockquote>
<pre><code>又是一通过非法获取钱财买flag的题目呢，经过简单的尝试输入后发现没什么特殊的漏洞，不能以科学计数（如 0e516516）的方式作为切入点，改cookie只能重置账户，买1/4个flag跟没买似的。
</code></pre><p>​    仔细看可以发现，理财时间有下限，但是没有上限，先兑换TDSU，输一个大数试试看，oh一不小心就溢出了：</p>
</blockquote>
<p>  <img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc03c707e924.png" class="lazyload"></p>
<blockquote>
<pre><code>但是我们需要控制溢出的收益，不然收益为负，够你受的了。通过控制输入的大数的大小来调节：922337203685477500
</code></pre></blockquote>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc03da7f11cd.png" class="lazyload"></p>
<blockquote>
<p>The flag is: <code>flag{Evil_Integer._Evil_Overflow.}</code> </p>
<p>护网杯中那个辣条之王溢出的题比较精妙，需要通过条件竞争的手法（即多线程同时购买，同一时间多次购买只需要一次付钱），再判断溢出点，从而getflag：题解 <a href="https://qingchenldl.github.io/2018/10/13/%E6%8A%A4%E7%BD%91%E6%9D%AFWP-BitPwn/?tdsourcetag=s_pcqq_aiomsg" target="_blank" rel="noopener">https://qingchenldl.github.io/2018/10/13/%E6%8A%A4%E7%BD%91%E6%9D%AFWP-BitPwn/?tdsourcetag=s_pcqq_aiomsg</a></p>
</blockquote>
<h2 id="黑曜石浏览器"><a href="#黑曜石浏览器" class="headerlink" title="黑曜石浏览器"></a>黑曜石浏览器</h2><blockquote>
<p>这就是那个坑到无数老少爷们，一时风头无俩的黑曜石浏览器(HeiCore)，确实出题人比较良心，为这个题目甚至专门写了一个前端页面来迷惑各位CTFer，这个黑曜石浏览器主页是在百度上不能搜索到的，在必应和谷歌上可以查到，很明显这个页面很不正经，简直是在嘲笑各位CTFer的智商嘛是不是？</p>
<p>好回到题目，实际上我们也做了比较久，尝试过各种方法之后回到了原点：黑曜石浏览器主页，这个主页除了假正经之外还有就是，不能查看源码，用谷歌的开发者工具看主页时会返回404。那么问题已经比较明显了，这里就是出题人的阻碍，为啥要阻碍，因为关键在这里，拿到关键的东西之后我们就可以去题目那里获取flag了。</p>
<p>谷歌用不了我们用火狐嘛，来看看network，看看源码：</p>
</blockquote>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0424f6bfaf.png" class="lazyload"></p>
<blockquote>
<pre><code>哦嚯，获得了一个user-agent，题目页面不是需要通过黑曜石浏览器访问吗，既然我们没有黑曜石浏览器这个东西，当然也可以通过user-agent来代表我们是黑曜石浏览器的身份咯，构造请求，加上user-agnet，getflag。
</code></pre><p>The flag is: <code>flag{H3ic0re_49.1.2623.213_sai_kou}</code> </p>
</blockquote>
<h2 id="回到过去"><a href="#回到过去" class="headerlink" title="回到过去"></a>回到过去</h2><pre class=" language-shell"><code class="language-shell">#input_sequence
q
ed
a
flag{
.
a
44a2b8
a3d9b2c               #关键在这一行最后的c是保留不保留
c44039
f93345
}
.
2m3                    #开始换行
2m5
2m1
2                    #切换到第二行
s/4/t                #将当前行的第一个4替换为t
q
q
</code></pre>
<blockquote>
<pre><code>这一题介绍了一下ed编辑器的使用，给出了一个文件如上，里面有键盘记录，实际上根据键盘记录，利用ed编辑器重写一遍就可获得flag，但是这个还是有一个坑点，那就是那个多出来的 ESC特殊符，刚开始在MobaXterm上面自带的ed做题，发现 2m3之类的换行命令无法实现，后来使用云服务器进行一波操作得到flag：
</code></pre><p>flag{t4a2b8c44039f93345a3d9b2}</p>
</blockquote>
<h2 id="我是谁"><a href="#我是谁" class="headerlink" title="我是谁"></a>我是谁</h2><blockquote>
<pre><code>这一题有两个小题，充满哲学。考察的是客户端错误相应代码和 “递茶”协议。。。
</code></pre><p>第一题通过查看network，可以看到status code里面有 <code>418 I AM A TEAPOT</code>，正好问我是谁嘛，把TEAPOT填进去，getflag1:<br>flag{i_canN0t_BReW_c0ffEE!} </p>
</blockquote>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0460ef19b2.png" class="lazyload"></p>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0464a1b3a2.png" class="lazyload"></p>
<blockquote>
<pre><code>然后可以获取第二小题的链接，简单查看一下，响应如下：
</code></pre></blockquote>
<pre class=" language-shell"><code class="language-shell">#这年头给大佬递茶都不简单了
Brewing tea is not so easy.
Try using other methods to request this page.
#试试post请求，响应如下：
The method "POST" is deprecated.
See RFC-7168 for more information.
#试试brew请求，响应如下：
Please check if there is anything missing in your header.
</code></pre>
<blockquote>
<p>结合两题的信息 I AM A TEAPOT  + brew tea + RFC-7168搜索一下，可以得到说明文档：</p>
<pre><code>https://tools.ietf.org/html/rfc7168
</code></pre><p>根据文档构造请求header里面的Content-Type: message/teapot，发送过去得到如下信息:</p>
</blockquote>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc04932d86c3.png" class="lazyload"></p>
<blockquote>
<p>根据返回的信息，我们需要将构造的请求发送到另一个url,即在原url后面加上递茶类型black_tea:</p>
<p>/the_super_great_hidden_url_for_brewing_tea/black_tea</p>
<p>getflag:</p>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc049bab0ba3.png" class="lazyload"></p>
</blockquote>
<h2 id="家里有矿"><a href="#家里有矿" class="headerlink" title="家里有矿"></a>家里有矿</h2><blockquote>
<p>提示：</p>
<ol>
<li>本题的浏览器“挖矿”只为演示性目的，几乎不占资源。我们不会以任何形式盗取或浪费大家电脑的算力。</li>
<li>本题如果使用程序求解，对于普通配置的个人电脑，在解法正确且最优的情况下，求解程序的期望运行时间不会超过几分钟。</li>
</ol>
<p>该题并不是常规的web 题，解题过程不涉及注入、XSS、敏感文件泄露、弱类型等安全问题。 </p>
<p>但是我暂时不会，所以待更新。</p>
</blockquote>
<h2 id="秘籍残篇"><a href="#秘籍残篇" class="headerlink" title="秘籍残篇"></a>秘籍残篇</h2><blockquote>
<pre><code>从这题就开始涉及古文化，玄学知识了。这题也是一个两小题的题目，第一题给出了一段malbolge语言的代码在文件中。一个骚操作。。直接用火狐浏览器打开文件，然后调整页面大小(%30)，宽度得到以下嘲讽CTFer的图案:
</code></pre><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc052d4be6b1.png" class="lazyload"><br>   ​<br>flxg{University_Ridiculous}<br>   ​<br>第二题待更新。</p>
</blockquote>
<h2 id="猫咪遥控器"><a href="#猫咪遥控器" class="headerlink" title="猫咪遥控器"></a>猫咪遥控器</h2><blockquote>
<p>为了报复猫咪把自己的代码打乱（见：猫咪与键盘），D 同学把猫咪遥控器绑在可以上（UP）下（DOWN）左（LEFT）右（RIGHT）移动的三轴机械臂上，开始使用树莓派（一款基于 Linux 的单片机计算机）控制三轴机械臂，进而控制猫咪在草地上跑来跑去。 </p>
<p>此题给出的txt文件中有 U(UP),D(DOWN),L(LEFT),R(RIGHT)，即上下左右咯，既然是让猫咪按这个跑，很简单就是画出路线图嘛，写一个简单的python脚本，利用tutle海龟库写，getflag：</p>
<p>flag{MeowMeow}</p>
</blockquote>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding=utf-8</span>

<span class="token keyword">import</span> turtle <span class="token keyword">as</span> T
<span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'seq.txt'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    strings <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span>
T<span class="token punctuation">.</span>speed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> strings<span class="token punctuation">:</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token string">'U'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        T<span class="token punctuation">.</span>seth<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span>
        T<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token string">"D"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        T<span class="token punctuation">.</span>seth<span class="token punctuation">(</span><span class="token number">270</span><span class="token punctuation">)</span>
        T<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        T<span class="token punctuation">.</span>seth<span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">)</span>
        T<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token string">"R"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        T<span class="token punctuation">.</span>seth<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        T<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>


</code></pre>
<blockquote>
<p>运行结果:</p>
</blockquote>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0561d47cad.png" class="lazyload"></p>
<h2 id="她的诗"><a href="#她的诗" class="headerlink" title="她的诗"></a>她的诗</h2><blockquote>
<p>题目给了一个poem.zip，包含一个python解密脚本和一个包含加密后诗的文件。根据解密脚本可以知道是uuencode，开始过于相信这个解密脚本，没想到出题人在这儿动手脚</p>
<pre class=" language-python"><code class="language-python">   <span class="token comment" spellcheck="true">#!/usr/bin/env python3</span>
   <span class="token comment" spellcheck="true"># This script helps you decode "her poem"</span>

   <span class="token keyword">from</span> codecs <span class="token keyword">import</span> decode

   fin <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">"poem.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>
   fout <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">"poem.out"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>

   <span class="token keyword">for</span> i <span class="token keyword">in</span> fin<span class="token punctuation">:</span>
      data <span class="token operator">=</span> <span class="token string">"begin 666 &lt;data>\n"</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">" \nend\n"</span>
      decode_data <span class="token operator">=</span> decode<span class="token punctuation">(</span>data<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"ascii"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"uu"</span><span class="token punctuation">)</span>
      <span class="token keyword">print</span><span class="token punctuation">(</span>decode_data<span class="token punctuation">)</span>
      fout<span class="token punctuation">.</span>write<span class="token punctuation">(</span>decode_data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"ascii"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>

   fin<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
   fout<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>   <strong>重点！在线解密密文即可得到真正的flag</strong>，flag分散藏在每行的头部，但是flag少了一个n需要自行添加在最后面补全为一个单词fun。</p>
</blockquote>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc057e2cd0ed.png" class="lazyload"></p>
<h2 id="猫咪克星"><a href="#猫咪克星" class="headerlink" title="猫咪克星"></a>猫咪克星</h2><blockquote>
<p>nc 202.38.95.46 12009 </p>
<p>蟒蛇是一种非常容易使用的编程语言，考验你像不像蟒蛇的标准就是给你一些 Python 3 表达式。如果你能正确计算出来，你就通过了验证。 </p>
<p>简单来说就是要在30秒内完成指定次数表达式的计算，然后可以得到服务器给出的flag，但是坑爹的是表达式中有一些特殊函数，类似于目录遍历 find ~,sleep(100),exit()，所以这种东西我采取了替换的方法。<br>​<br>因为print函数在python3和python2中不同，而我需要使用python2中的pwntools库（python3的socket不知为何无用），同时拥有python3的print函数特性，这时候就需要:</p>
<p>from _ _ future _ _ import print_function</p>
<p>引入python3 print函数。</p>
<p>最终脚本如下(脚本比较简陋，可能需要多跑几次才能出flag)：</p>
</blockquote>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function
<span class="token comment" spellcheck="true">#coding:utf-8</span>
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>


sh <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"202.38.95.46"</span><span class="token punctuation">,</span><span class="token number">12009</span><span class="token punctuation">)</span>
getit <span class="token operator">=</span> sh<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>

    strings <span class="token operator">=</span> sh<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
    strings <span class="token operator">=</span> strings<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'sleep(100)'</span><span class="token punctuation">,</span><span class="token string">'int(1)'</span><span class="token punctuation">)</span>
    strings <span class="token operator">=</span> strings<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'exit()'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span>
    strings <span class="token operator">=</span> strings<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'find ~'</span><span class="token punctuation">,</span><span class="token string">'echo 1'</span><span class="token punctuation">)</span>
    strings <span class="token operator">=</span> strings<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"__import__('time')."</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span>
    key <span class="token operator">=</span> eval<span class="token punctuation">(</span>strings<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> strings<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span>
        exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre>
<blockquote>
<p>脚本运行结果如下：</p>
</blockquote>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc05b09d0ecf.png" class="lazyload"></p>
<h2 id="猫咪电路"><a href="#猫咪电路" class="headerlink" title="猫咪电路"></a>猫咪电路</h2><blockquote>
<p>当年玩的minercraft被做成了题目，好吧，红石电路，这是一个存档，需要我们按规律输入信号，然后直到光柱亮起，正确的信号即为flag:</p>
<p>flag{0110101000111100101111111111111111111010} </p>
</blockquote>
<h2 id="FLXG-的秘密"><a href="#FLXG-的秘密" class="headerlink" title="FLXG 的秘密"></a>FLXG 的秘密</h2><blockquote>
<p>题目有点长，我总结一下，给出的文件中是伏羲六十四卦的卦象，简单搜索一下可以知道，伏羲六十四卦可以跟二进制扯上关系，六十四卦分别对应二进制000000-111111，对应关系如下:</p>
</blockquote>
<pre class=" language-shell"><code class="language-shell">'坤': '000000', '剥': '000001', '比': '000010', '观': '000011', '豫': '000100', '晋': '000101', '萃': '000110', '否': '000111', '谦': '001000', '艮': '001001', '蹇': '001010', '渐': '001011', '小过': '001100', '旅': '001101', '咸': '001110', '遁': '001111', '师': '010000', '蒙': '010001', '坎': '010010', '涣': '010011', '解': '010100', '未济': '010101', '困': '010110', '讼': '010111', '升': '011000', '蛊': '011001', '井': '011010', '巽': '011011', '恒': '011100', '鼎': '011101', '大过': '011110', '姤': '011111', '复': '100000', '颐': '100001', '屯': '100010', '益': '100011', '震': '100100', '噬嗑': '100101', '随': '100110', '无妄': '100111', '明夷': '101000', '贲': '101001', '既济': '101010', '家人': '101011', '丰': '101100', '离': '101101', '革': '101110', '同人': '101111', '临': '110000', '损': '110001', '节': '110010', '中孚': '110011', '归妹': '110100', '睽': '110101', '兑': '110110', '履': '110111', '泰': '111000', '大畜': '111001', '需': '111010', '小畜': '111011', '大壮': '111100', '大有': '111101', '夬': '111110', '乾': '111111'
</code></pre>
<blockquote>
<p>写一个python脚本将那个文件中的卦象分别解成二进制，可以发现bit数正好是4039032，可以整除8（8bit为1byte）。到这基本上可以判断思路正确。</p>
<p>脚本如下:</p>
</blockquote>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> re

special <span class="token operator">=</span> <span class="token triple-quoted-string string">'''乾﹑坤﹑屯﹑蒙﹑需﹑讼﹑师﹑比﹑小畜﹑履﹑泰﹑否﹑同人﹑大有﹑谦﹑豫﹑随﹑蛊﹑临﹑观﹑噬嗑﹑贲﹑剥﹑复﹑无妄﹑大畜﹑颐﹑大过﹑坎﹑离﹑咸﹑恒﹑遁﹑大壮﹑晋﹑明夷﹑家人﹑睽﹑蹇﹑解﹑损﹑益﹑夬﹑姤﹑萃﹑升﹑困﹑井﹑革﹑鼎﹑震﹑艮﹑渐﹑归妹﹑丰﹑旅﹑巽﹑兑﹑涣﹑节﹑中孚﹑小过﹑既济﹑未济'''</span>
<span class="token comment" spellcheck="true">#二进制顺序的卦象</span>
guashu <span class="token operator">=</span> <span class="token triple-quoted-string string">'''坤、剥、比、观、豫、晋、萃、否、谦、艮、蹇、渐、小过、旅、咸、遁、师、蒙、坎、涣、解、未济、困、讼、升、蛊、井、巽、恒、鼎、大过、姤、复、颐、屯、益、震、噬嗑、随、无妄、明夷、贲、既济、家人、丰、离、革、同人、临、损、节、中孚、归妹、睽、兑、履、泰、大畜、需、小畜、大壮、大有、夬、乾'''</span>


<span class="token keyword">def</span> <span class="token function">Getword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    strings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    s<span class="token operator">=</span>special<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'﹑'</span><span class="token punctuation">)</span>
    s2 <span class="token operator">=</span> guashu<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"、"</span><span class="token punctuation">)</span>
    diction <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'G://数据//ctf赛题//中科大ctf//flxg的秘密.txt'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        strings2 <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> strings2<span class="token punctuation">:</span>
            strings<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    strings <span class="token operator">=</span> set<span class="token punctuation">(</span>strings<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true">#因为卦象中存在一个字或者两个字的卦象，jieba分词库不准确，就用/来区别</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>
        diction<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>strings2<span class="token punctuation">.</span>count<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        strings2 <span class="token operator">=</span> strings2<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token string">'/'</span><span class="token operator">+</span>i<span class="token operator">+</span><span class="token string">'/'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> diction<span class="token punctuation">,</span>strings2<span class="token punctuation">,</span>s2

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    diction<span class="token punctuation">,</span>strings2<span class="token punctuation">,</span>s2 <span class="token operator">=</span> Getword<span class="token punctuation">(</span><span class="token punctuation">)</span>
    finalbin <span class="token operator">=</span><span class="token string">''</span>
    finaldiclist<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    dicts<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    n<span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> diction<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        n<span class="token operator">+=</span>i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">6</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'bits='</span><span class="token operator">+</span>str<span class="token punctuation">(</span>n<span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    finalstrings <span class="token operator">=</span> strings2<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> a <span class="token keyword">in</span> finalstrings<span class="token punctuation">:</span>
        <span class="token keyword">if</span> a <span class="token keyword">in</span> s2<span class="token punctuation">:</span>
            finaldiclist<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true">#建立卦象与二进制的关系字典</span>
    nice <span class="token operator">=</span><span class="token number">0</span>
    n<span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> s2<span class="token punctuation">:</span>
        dicts<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> format<span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
        n<span class="token operator">=</span>n<span class="token operator">+</span><span class="token number">1</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>dicts<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>finaldiclist<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">6</span><span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true">#按字典解密写入文件</span>
    <span class="token keyword">for</span> b <span class="token keyword">in</span> finaldiclist<span class="token punctuation">:</span>
        finalbin<span class="token operator">+=</span>dicts<span class="token punctuation">[</span>b<span class="token punctuation">]</span>
    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'finalbin.txt'</span><span class="token punctuation">,</span><span class="token string">'w+'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> ff<span class="token punctuation">:</span>
        ff<span class="token punctuation">.</span>write<span class="token punctuation">(</span>finalbin<span class="token punctuation">)</span>

</code></pre>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc07be42ac0e.png" class="lazyload"></p>
<blockquote>
<p>接下来利用python的libnum库，将二进制转换为字符串得到第一个flag：</p>
</blockquote>
<p>  <img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0611d2a07a.png" class="lazyload"></p>
<blockquote>
<p>用binwalk分析一下内容，发现里面有一个压缩包，进行提取得到以下文件：一个flag elf程序 ，passkey.txt，简单看一下，接下来的第二题应该是逆向了。。待更新。。。</p>
<p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc061b548e19.png" class="lazyload"></p>
</blockquote>
<p>先到这 。</p>
  	
					
	  </div>     
	  

	<div class="post-footer">


  <div class="post-footer-other">
    
      <span class="post-footer-item">
        


<span class="donate-btn">
	<span class="iconfont icon-donate"></span>
</span>

<div id="donate-box" class="sildeUpMin">

	<span class="donate-cancel iconfont icon-cancel"></span>

	<div class="donate-img-box">
		<img id="donate-qr-wechat" class="noLazyLoad donate-img lazyload" src="/images/placeholder.png" alt="No Donate Image!" data-src="/images/donate1.png">	
		<img id="donate-qr-alipay" class="noLazyLoad donate-img lazyload" src="/images/placeholder.png" alt="No Donate Image!" data-src="/images/donate2.png">	
	</div>

	<span class="donate-word">不负自己，不负青天</span>

	<div class="donate-list">
		<span class="iconfont icon-donate-wechat"></span>
		<span class="iconfont icon-donate-alipay"></span>
	</div>

</div>
 
      </span>        
       
    
      <span class="post-footer-item">
        <span class="share-btn">
	<span class="iconfont icon-share"></span>
</span>
<div class="-mob-share sildeUpMin">
	<ul class="-mob-inner">
	   			             
        <li class="iconfont 
		icon-share-qq 
		-mob-share-qq 
		-mob-share-link"></li>		
   	   			             
        <li class="iconfont 
		icon-share-weixin 
		-mob-share-weixin 
		-mob-share-link"></li>		
   	   			             
        <li class="iconfont 
		icon-share-weibo 
		-mob-share-weibo 
		-mob-share-link"></li>		
   	   			             
        <li class="iconfont 
		icon-share-douban 
		-mob-share-douban 
		-mob-share-link"></li>		
   	   			             
        <li class="iconfont 
		icon-share-facebook 
		-mob-share-facebook 
		-mob-share-link"></li>		
   	   			             
        <li class="iconfont 
		icon-share-twitter 
		-mob-share-twitter 
		-mob-share-link"></li>		
   	   			             
        <li class="iconfont 
		icon-share-google 
		-mob-share-google 
		-mob-share-link"></li>		
   	   
	</ul>
</div>	


<script id="-mob-share" src="https://f1.webshare.mob.com/code/mob-share.js?appkey=21d601593a1de"></script>
      </span>  
               
  </div>  
    


  <div class="post-footer-meta">
        
          <i class="iconfont icon-category"></i>       
          <a class="category-link" href="/categories/CTF/">CTF</a> 	
      
        	

        
          <i class="iconfont icon-tag"></i>     
            <a class="tag-link" href="/tags/CTF/">CTF</a> <a class="tag-link" href="/tags/ustc/">ustc</a> <a class="tag-link" href="/tags/writeup/">writeup</a>    
        	
  </div>

</div>


<nav class="post-footer-nav">
  <div class="post-footer-link">
  
      <a href="/2018/10/16/Pwn-10月16-Codegate2018-melong/" id="post-nav-older" class="post-nav-link-wrap">
        <strong class="post-nav-caption">older</strong>
        
          <span class="post-nav-title">
            Pwn-10月16-Codegate2018
          </span>
      </a>
  
  </div>
  <div class="post-footer-link">
    
        <a href="/2018/10/17/遗传算法/" id="post-nav-newer" class="post-nav-link-wrap">
          <strong class="post-nav-caption">newer</strong>
             
            <span class="post-nav-title">
              遗传算法
            </span>
        </a>
    
  </div>

</nav>
 
	
	
</article>

	<div class="toc-container">
			<div class="toc-sidebar">
			<p class="toc-title">
				CONTENT
			</p>
			<div class="toc-list">
				<ol class="toc-inner"><li class="toc-inner-item toc-inner-level-1"><a class="toc-inner-link" href="#中科大-Hackergame2018-write-up"><span class="toc-inner-text">中科大-Hackergame2018 write-up</span></a><ol class="toc-inner-child"><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#签到题"><span class="toc-inner-text">签到题</span></a></li><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#猫咪问答"><span class="toc-inner-text">猫咪问答</span></a></li><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#游园会的集章卡片"><span class="toc-inner-text">游园会的集章卡片</span></a></li><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#猫咪和键盘"><span class="toc-inner-text">猫咪和键盘</span></a></li><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#Word-文档"><span class="toc-inner-text">Word 文档</span></a></li><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#猫咪银行"><span class="toc-inner-text">猫咪银行</span></a></li><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#黑曜石浏览器"><span class="toc-inner-text">黑曜石浏览器</span></a></li><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#回到过去"><span class="toc-inner-text">回到过去</span></a></li><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#我是谁"><span class="toc-inner-text">我是谁</span></a></li><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#家里有矿"><span class="toc-inner-text">家里有矿</span></a></li><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#秘籍残篇"><span class="toc-inner-text">秘籍残篇</span></a></li><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#猫咪遥控器"><span class="toc-inner-text">猫咪遥控器</span></a></li><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#她的诗"><span class="toc-inner-text">她的诗</span></a></li><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#猫咪克星"><span class="toc-inner-text">猫咪克星</span></a></li><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#猫咪电路"><span class="toc-inner-text">猫咪电路</span></a></li><li class="toc-inner-item toc-inner-level-2"><a class="toc-inner-link" href="#FLXG-的秘密"><span class="toc-inner-text">FLXG 的秘密</span></a></li></ol></li></ol>
			</div>
		</div>
	</div>

          </div> 
      </div>            
    
    <a id="page-backTop">
      <span>
        <i class="iconfont icon-backtotop"></i>
      </span>
    </a> 

  
    
    <div class="search-container sildeUpMin">
        <div class="search-header">
            <input type="text" placeholder="输入你想搜索的" id="search-input" class="search-input">
            <span class="search-cancel">
                <i class="iconfont icon-cancel">
            </i></span>
        </div>
        <div id="search-result" class="search-result"></div>
    </div>
 
     <div class="mobile-menu">      

      
      <img class="mobile-menu-icon lazyload" src="/images/placeholder.png" data-src="/images/favicon.png">  
      

         
            

            <a class="mobile-menu-link" href="/">首页
            </a>
            
         
            

            <a class="mobile-menu-link" href="/archives">归档
            </a>
            
         
            

            <a class="mobile-menu-link" href="/tags">标签
            </a>
            
         
            

            <a class="mobile-menu-link" href="/about">关于
            </a>
            
         
                          

            <a class="mobile-menu-link mobile-menu-search" href="#">搜索 </a>                 
            
         
      
</div>
        
    



     
    




<footer id="footer">	    

		
		<div class="footer-copyright">
		&copy;
				
		2018-
		
		2019		
	
		xiaoyifeng
		<br>

		Theme  <a href="https://github.com/Lemonreds/hexo-theme-Nayo" target="_blank">Nayo</a>
		</div>			
	 
</footer>   

    <script src="/nayo.bundle.js"></script>           
  <script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":100,"height":170},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>        
</html>